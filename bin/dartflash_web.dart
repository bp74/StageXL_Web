import "dart:html" as XB;import "dart:async" as VB;import "dart:web_audio" as sF;import "dart:json" as rF;import "dart:math" as gB;class rI{static const String sI="Chrome";static const String tI="Firefox";static const String uI="Internet Explorer";static const String vI="Safari";final String yH;final String XI;const rI(this.yH,[this.XI]);}class wI{final String name;const wI(this.name);}class xI extends WB{final List yJ=[{'name':'DropShadowFilter (black)','filter':new PJ(10,gB.PI/4,AC.zC,0.8,8,8)},{'name':'GlowFilter (red)','filter':new LJ(AC.QF,1.0,20,20)},{'name':'ColorMatrixFilter (grayscale)','filter':new MJ.rJ()},{'name':'ColorMatrixFilter (invert)','filter':new MJ.sJ()},{'name':'BlurFilter (radius 1)','filter':new KJ(1,1)},{'name':'BlurFilter (radius 5)','filter':new KJ(5,5)},{'name':'BlurFilter (radius 10)','filter':new KJ(10,10)},{'name':'BlurFilter (radius 20)','filter':new KJ(20,20)}];xI(){var m=new GB(940,500,true,0x000000);var k=RB.MC('king');var o=new GB(230,245,true,0xFFF0F0F0);var p=new xC(m);BB(p);for(int h=0;h<yJ.length;h++ ){var i=235*(h%4);var j=250*(h~/4);var q=yJ[h]['filter'] as WC;var t=yJ[h]['name'] as String;var u=new DB(0,0,k.width,k.height);var n=new JB(i+40,j+45);m.wH(k,u,n,q);var l=new xC(o);l.x=i;l.y=j;BE(l,0);var g=new OJ();g.TC=new jE('Helvetica Neue, Helvetica, Arial',14,AC.zC);g.x=i+5;g.y=j+5;g.width=200;g.text=t;BB(g);}}}class yI extends WB{final gB.Random xJ=new gB.Random();yI(){var g=new eE();g.lB=470;g.sB=250;g.x=470;g.y=250;BB(g);for(int h=0;h<150;h++ ){var v=1+xJ.nextInt(3);var p=RB.MC('flower${v}');var i=new xC(p);i.lB=64;i.sB=64;i.x=64+xJ.nextInt(940-128);i.y=64+xJ.nextInt(500-128);i.vH(g);var o=new AH(i,600,s.YC);o.kB('rotation',gB.PI*60.0);OB.add(o);}var k=new List<JB>();for(int h=0;h<6;h++ ){num n=(h*60)*gB.PI/180;num m=(h*60+30)*gB.PI/180;k.add(new JB(470+200*gB.cos(n),250+200*gB.sin(n)));k.add(new JB(470+100*gB.cos(m),250+100*gB.sin(m)));}var t=new SD.mJ(100,100,740,300);var u=new SD.pJ(470,250,200);var q=new SD.qJ(k);XB.query('#mask-none').onClick.listen((j)=>g.mask=null);XB.query('#mask-rectangle').onClick.listen((j)=>g.mask=t);XB.query('#mask-circle').onClick.listen((j)=>g.mask=u);XB.query('#mask-custom').onClick.listen((j)=>g.mask=q);XB.query('#mask-spin').onClick.listen((j){var l=new AH(g,2.0,s.RF);l.kB('rotation',gB.PI*4.0);l.onComplete=()=>g.nC=0.0;OB.add(l);});}}class zI extends WB{gB.Random xJ=new gB.Random();CC zJ;List AK;zI(){zJ=RB.KE('walkTextureAtlas');AK=zJ.LI('walk');DK();}DK(){var h=xJ.nextDouble();var g=new EG(AK,30);g.x=-128;g.y=20.0+180.0*h;g.mB=g.nB=0.5+0.5*h;g.play();BB(g);mI((k,j)=>(k.y-j.y).toInt());var i=new AH(g,5.0+(1.0-h)*5.0,s.YC);i.kB('x',940.0);i.onComplete=(){OB.remove(g);iF(g);};OB.add(g);OB.add(i);OB.UF(DK,0.2);}}class FJ extends xC implements hB{num ND,OD;FJ(GB g,this.ND,this.OD):super(g){this.lB=g.width/2;this.sB=g.height/2;}bool qB(num i){var g=x+ND*i;var h=y+OD*i;if(g>910||g<30)ND=-ND;else x=g;if(h>470||h<30)OD=-OD;else y=h;return true;}}class AJ extends WB{final List wJ=['C4','A3','A3','C4','D4','G3','G3','A3','A3#','F4','F4','E4','C4','D4','C4','A3#','A3','C4','D4','D4','D4','G4','F4','E4','F4','D4','C4','F3','G3','A3','D4','C4','C4','A3#','A3','E3','F3'];final List CK=['Hey ','Jude, ',"don't ",'make ','it ','bad.<br>','Take ','a ','sad ','song ','and ','make ','it ','better.<br>','','','','Remember ','','','to ','let ','her ','into ','','your ','heart.<br>','Than ','you ','can ','start ','','to ','make ','things ','better.','',' '];AJ(){var h=new xC(RB.MC('Background'));BB(h);var g=new tF(wJ,CK);g.x=120;g.y=30;BB(g);XB.query('#startOver').onClick.listen((i)=>g.iI());}}class BJ extends WB{final String lI='''
Filet mignon leberkas pig pork chop biltong, short loin strip steak turkey brisket 
venison. Pastrami venison pancetta, leberkas pork chop chicken prosciutto beef ribs 
bresaola kielbasa swine biltong capicola. Hamburger beef ribs ball tip drumstick salami 
pig. Capicola pork loin shank, salami chicken hamburger tail. Sirloin spare ribs
ground round cow strip steak prosciutto swine bacon corned beef.''';BJ(){var k=lI.replaceAll('\r','').replaceAll('\n','');var j=new OJ();j.TC=new jE('Helvetica,Arial',14,AC.TH,ED:true,ME:true);j.text=k;j.x=10;j.y=10;j.width=920;j.height=20;BB(j);var h=new OJ();h.TC=new jE('Helvetica,Arial',16,AC.QF);h.text=k;h.x=10;h.y=50;h.width=200;h.height=300;h.wordWrap=true;BB(h);var g=new OJ();g.TC=new jE('Helvetica,Arial',16,AC.qG,align:PC.BF);g.text=k;g.x=300;g.y=50;g.width=200;g.height=300;g.wordWrap=true;BB(g);var i=new OJ();i.TC=new jE('Caesar Dressing',30,AC.zC,align:PC.WD);i.text=k;i.x=590;i.y=50;i.width=340;i.height=300;i.wordWrap=true;BB(i);}}class EJ extends WB{EJ(){var g=new OJ();g.TC=new jE('Helvetica,Arial',14,AC.IH,ED:true);g.text='ToDo: show a cool demo ...';g.x=10;g.y=10;g.width=920;g.height=20;BB(g);}}class CJ extends WB{CJ(){var k=RB.MI('flump');var i=new QJ(k,'idle');i.x=500;i.y=200;BB(i);var j=new QJ(k,'walk');j.x=150;j.y=460;BB(j);var g=new QJ(k,'attack');g.x=450;g.y=460;BB(g);var h=new QJ(k,'defeat');h.x=720;h.y=460;BB(h);OB.add(i);OB.add(j);OB.add(g);OB.add(h);GB.lD('images/flumpLibraryAtlas0.png').then((m){xC l=new xC(m);l.x=40;l.y=40;BB(l);});}}class DJ extends WB{CC zJ;DJ(){zJ=RB.KE('levelUp');BK();GB.lD('images/LevelupTextureAtlas.png').then((h){xC g=new xC(h);g.x=70;g.y=40;BB(g);});}BK(){num l=330;for(int j=0;j<7;j++ ){var h=zJ.MC('LevelUp${j}');var g=new xC(h);g.lB=h.width/2;g.sB=h.height/2;g.x=l+h.width/2;g.y=150;g.mB=0.0;g.nB=0.0;BB(g);var k=new AH(g,2.0,s.BD);k.kB('scaleX',1.0);k.kB('scaleY',1.0);k.TF=j*0.05;var i=new AH(g,0.4,s.YC);i.kB('scaleX',0.0);i.kB('scaleY',0.0);i.TF=2.0;i.onComplete=()=>g.PE();OB.add(k);OB.add(i);l=l+5+h.width;}OB.UF(()=>BK(),3.0);}}class GJ{final List vJ=[{"name":"linear","transition":s.YC},{"name":"sine","transition":s.KF},{"name":"cosine","transition":s.DH},{"name":"random","transition":s.GH},{"name":"easeInQuadratic","transition":s.fD},{"name":"easeOutQuadratic","transition":s.gD},{"name":"easeInOutQuadratic","transition":s.JH},{"name":"easeOutInQuadratic","transition":s.KH},{"name":"easeInCubic","transition":s.hD},{"name":"easeOutCubic","transition":s.iD},{"name":"easeInOutCubic","transition":s.PF},{"name":"easeOutInCubic","transition":s.QH},{"name":"easeInQuartic","transition":s.jD},{"name":"easeOutQuartic","transition":s.kD},{"name":"easeInOutQuartic","transition":s.UH},{"name":"easeOutInQuartic","transition":s.VH},{"name":"easeInQuintic","transition":s.mD},{"name":"easeOutQuintic","transition":s.nD},{"name":"easeInOutQuintic","transition":s.XH},{"name":"easeOutInQuintic","transition":s.YH},{"name":"easeInCircular","transition":s.oD},{"name":"easeOutCircular","transition":s.qD},{"name":"easeInOutCircular","transition":s.ZH},{"name":"easeOutInCircular","transition":s.aH},{"name":"easeInSine","transition":s.rD},{"name":"easeOutSine","transition":s.sD},{"name":"easeInOutSine","transition":s.cH},{"name":"easeOutInSine","transition":s.gH},{"name":"easeInExponential","transition":s.tD},{"name":"easeOutExponential","transition":s.uD},{"name":"easeInOutExponential","transition":s.hH},{"name":"easeOutInExponential","transition":s.iH},{"name":"easeInBack","transition":s.vD},{"name":"easeOutBack","transition":s.wD},{"name":"easeInOutBack","transition":s.RF},{"name":"easeOutInBack","transition":s.lH},{"name":"easeInElastic","transition":s.xD},{"name":"easeOutElastic","transition":s.BD},{"name":"easeInOutElastic","transition":s.mH},{"name":"easeOutInElastic","transition":s.oH},{"name":"easeInBounce","transition":s.yD},{"name":"easeOutBounce","transition":s.CD},{"name":"easeInOutBounce","transition":s.pH},{"name":"easeOutInBounce","transition":s.qH}];XB.DivElement QI(){var j=new XB.DivElement();for(int h=0;h<vJ.length/4;h++ ){var i=new XB.DivElement();i.classes.add("row");j.children.add(i);for(int g=0;g<4;g++ ){var m=vJ[h*4+g]["name"];var l=vJ[h*4+g]["transition"];var k=PK(m,l);k.id="cell";i.children.add(k);}}return j;}XB.DivElement PK(String o,num q(num ratio)){var h=new XB.DivElement();h.classes.add("span3");h.style.height="130px";var j=new XB.CanvasElement(width:200,height:140);j.style.position="absolute";j.style.zIndex="1";h.children.add(j);var i=new XB.DivElement();i.text=o;i.style.position="relative";i.style.zIndex="2";i.style.top="6px";h.children.add(i);var l=new jC("stage",j);var n=new JJ();var g=n.RI;g.beginPath();g.moveTo(0.5,30.5);g.lineTo(199.5,30.5);g.lineTo(199.5,109.5);g.lineTo(0.5,109.5);g.closePath();g.nF(0xFF000000);g.EI(0xFFDFDFDF);g.beginPath();g.moveTo(0.5,109.5);for(int k=0;k<=199;k++ ){var m=k/199.0;var p=0.5+m*199.0;var t=109.5-79.0*q(m);g.lineTo(p,t);}g.nF(0xFF0000FF,2);l.BB(n);l.ZF();return h;}}jC oB;xF PD;TD OB;rE RB;class HJ extends WB{HJ(){EK(250);XB.query('#minus10').onClick.listen((g)=>FK(10));XB.query('#minus50').onClick.listen((g)=>FK(50));XB.query('#plus50').onClick.listen((g)=>EK(50));XB.query('#plus10').onClick.listen((g)=>EK(10));this.YI.listen(GK);}num KK=null;GK(gC g){if(KK==null){KK=1.00/g.fF;}else{KK=0.05/g.fF+0.95*KK;}XB.query('#fpsMeter').innerHtml='fps: ${KK.round()}';}EK(int l){var g=new gB.Random();var i=RB.KE('flags');var j=i.HI;while ( --l>=0){var k=j[g.nextInt(j.length)];var m=i.MC(k);var h=new FJ(m,g.nextInt(200)-100,g.nextInt(200)-100);h.x=30+g.nextInt(940-60);h.y=30+g.nextInt(500-60);BB(h);OB.add(h);}XB.query('#flagCounter').innerHtml='Flags: ${ID}';}FK(int h){while ( --h>=0&&ID>0){var g=WF(0);g.PE();OB.remove(g);}XB.query('#flagCounter').innerHtml='Flags: ${ID}';}}void main(){var l=XB.window.location.pathname;var m=new RegExp(r"([A-Za-z0-9-]+)\.html",multiLine:false,caseSensitive:false);var g=m.firstMatch(l);if(g!=null&&g.groupCount==1){var h=g.group(1);print("current page: ${h}");var i=XB.query("#stage");if(i!=null){oB=new jC('stage',i);PD=new xF();PD.uH(oB);OB=PD.VI;RB=new rE();}switch (h){case "filter":RB..pB('king','images/king.png')..load().then((LK)=>oB.BB(new xI()));break;case "masking":RB..pB('flower1','images/Flower1.png')..pB('flower2','images/Flower2.png')..pB('flower3','images/Flower3.png')..load().then((LK)=>oB.BB(new yI()));break;case "movieclip":RB..CE('walkTextureAtlas','images/walk.json',cC.yC)..load().then((LK)=>oB.BB(new zI()));break;case "performance":RB..CE('flags','images/flags.json',cC.yC)..load().then((LK)=>oB.BB(new HJ()));break;case "sound":RB..pB('KeyBlack','images/piano/KeyBlack.png')..pB('KeyWhite0','images/piano/KeyWhite0.png')..pB('KeyWhite1','images/piano/KeyWhite1.png')..pB('KeyWhite2','images/piano/KeyWhite2.png')..pB('KeyWhite3','images/piano/KeyWhite3.png')..pB('Finger','images/piano/Finger.png')..pB('Background','images/piano/Background.jpg')..HB('Cheer','sounds/Cheer.mp3')..HB('Note1','sounds/piano/Note1.mp3')..HB('Note2','sounds/piano/Note2.mp3')..HB('Note3','sounds/piano/Note3.mp3')..HB('Note4','sounds/piano/Note4.mp3')..HB('Note5','sounds/piano/Note5.mp3')..HB('Note6','sounds/piano/Note6.mp3')..HB('Note7','sounds/piano/Note7.mp3')..HB('Note8','sounds/piano/Note8.mp3')..HB('Note9','sounds/piano/Note9.mp3')..HB('Note10','sounds/piano/Note10.mp3')..HB('Note11','sounds/piano/Note11.mp3')..HB('Note12','sounds/piano/Note12.mp3')..HB('Note13','sounds/piano/Note13.mp3')..HB('Note14','sounds/piano/Note14.mp3')..HB('Note15','sounds/piano/Note15.mp3')..HB('Note16','sounds/piano/Note16.mp3')..HB('Note17','sounds/piano/Note17.mp3')..HB('Note18','sounds/piano/Note18.mp3')..HB('Note19','sounds/piano/Note19.mp3')..HB('Note20','sounds/piano/Note20.mp3')..HB('Note21','sounds/piano/Note21.mp3')..HB('Note22','sounds/piano/Note22.mp3')..HB('Note23','sounds/piano/Note23.mp3')..HB('Note24','sounds/piano/Note24.mp3')..HB('Note25','sounds/piano/Note25.mp3')..load().then((LK)=>oB.BB(new AJ()));break;case "text":oB.BB(new BJ());break;case "tweener":oB.BB(new EJ());break;case "flump":RB..tH('flump','images/flumpLibrary.json')..load().then((LK)=>oB.BB(new CJ()));break;case "texturepacker":RB..CE('levelUp','images/LevelupTextureAtlas.json',cC.yC)..load().then((LK)=>oB.BB(new DJ()));break;case "transitions":var k=new GJ();var j=k.QI();XB.query("#transitions").children.add(j);break;}}}class tF extends WB{final List HK;final List IK;final List JK=['C3','C3#','D3','D3#','E3','F3','F3#','G3','G3#','A3','A3#','B3','C4','C4#','D4','D4#','E4','F4','F4#','G4','G4#','A4','A4#','B4','C5'];int MK;xC NK;tF(this.HK,this.IK){for(int h=0,i=0;h<JK.length;h++ ){var j=RB.XF('Note${h+1}');var g=new uF(this,JK[h],j);if(JK[h].endsWith('#')){g.x=i-16;g.y=35;BB(g);}else{g.x=i;g.y=35;BE(g,0);i=i+47;}}MK=0;NK=new xC(RB.MC('Finger'));NK.lB=20;BB(NK);OK();}zH(String g){if(MK<HK.length&&HK[MK]==g){if(MK==HK.length-1)RB.XF('Cheer').play();MK++ ;OK();}}iI(){MK=0;NK.alpha=1;OK();}OK(){var j=XB.query('#lyrics');var m=-1;j.innerHtml='';for(int g=0,l=0;g<IK.length;g++ ){if(IK[g]!='')l=g;if(g==this.MK)m=l;}for(int g=0;g<IK.length;g++ ){if(g==m){j.appendHtml('<span id="word">${IK[g]}</span>');}else{j.appendHtml(IK[g]);}}if(MK<HK.length){for(int k=0;k<this.ID;k++ ){var i=this.WF(k);if(i is uF){if(i.cB==HK[MK]){NK.y=0;var n=new AH(this.NK,0.4,s.PF);n.kB('x',i.x+i.width/2);var h=new AH(this.NK,0.4,s.KF);h.kB('y',-10);OB.hI(NK);OB.add(n);OB.add(h);}}}}else{var h=new AH(NK,0.4,s.YC);h.kB('alpha',0);OB.add(h);}}}class uF extends eE{final tF gF;final String cB;final iB mF;uF(this.gF,this.cB,this.mF){String h;if(cB.endsWith('#')){h='KeyBlack';}else if(cB.startsWith('C5')){h='KeyWhite0';}else if(cB.startsWith('C')||cB.startsWith('F')){h='KeyWhite1';}else if(cB.startsWith('D')||cB.startsWith('G')||cB.startsWith('A')){h='KeyWhite2';}else if(cB.startsWith('E')||cB.startsWith('B')){h='KeyWhite3';}var i=RB.MC(h);var l=new xC(i);this.BB(l);var j=cB.endsWith('#')?AC.nH:AC.zC;var k=new jE('Helvetica,Arial',10,j,align:PC.WD);var g=new OJ();g.TC=k;g.text=cB;g.width=i.width;g.height=20;g.dF=false;g.y=i.height-20;BB(g);this.VE=true;this.onMouseDown.listen(QK);this.onMouseOver.listen(QK);this.onMouseUp.listen(RK);this.onMouseOut.listen(RK);}QK(w g){if(g.JC){this.mF.play();this.alpha=0.7;this.gF.zH(this.cB);}}RK(w g){this.alpha=1.0;}}class fC{static const String VD="auto";static const String QG="stop";static const String uE="once";}class vC{String bK;String YK;String zK;VB.Future LL;dynamic VL;dynamic fL;vC(String g,String h,String i){bK=g;YK=h;zK=i;VL=null;fL=null;}String get kind=>bK;String get name=>YK;dynamic get mC=>fL;dynamic get error=>VL;CN(VB.Future i){LL=i.then((g){fL=g;VL=null;},onError:(VB.AsyncError h){fL=null;VL=h.error;});}}class CC{final XB.ImageElement eK=new XB.ImageElement();final List<gE> YL=new List<gE>();static VB.Future<CC> lD(String m,String u){VB.Completer<CC> l=new VB.Completer<CC>();CC j=new CC();switch (u){case cC.JG:case cC.yC:void n(String k,Map g){var q=BH(k);var h=new gE(q,j);h.EL=g["frame"]["x"].toInt();h.OL=g["frame"]["y"].toInt();h.UL=g["frame"]["w"].toInt();h.eL=g["frame"]["h"].toInt();h.pL=g["spriteSourceSize"]["x"].toInt();h.uL=g["spriteSourceSize"]["y"].toInt();h.zL=g["sourceSize"]["w"].toInt();h.IM=g["sourceSize"]["h"].toInt();h.PM=g["rotated"] as bool;j.YL.add(h);}XB.HttpRequest.getString(m).then((t){var o=rF.parse(t);var i=o["frames"];var p=o["meta"];if(i is List)for(var g in i)n(g["filename"],g);if(i is Map)for(String k in i.keys)n(k,i[k]);j.eK..onLoad.listen((v)=>l.complete(j))..onError.listen((v)=>l.completeError(new StateError("Failed to load image.")))..src=NF(m,p["image"]);}).catchError((CB){l.completeError(new StateError("Failed to load json file."));});break;}return l.future;}XB.ImageElement get HD=>eK;GB MC(String i){GB h;for(int g=0;g<YL.length&&h==null;g++ )if(YL[g].name==i)h=new GB.uJ(YL[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;}List<GB> LI(String i){var h=new List<GB>();for(int g=0;g<YL.length;g++ )if(YL[g].name.indexOf(i)==0)h.add(new GB.uJ(YL[g]));return h;}List<String> get HI{return YL.map((g)=>g.name).toList();}}class cC{static const String JG="json";static const String yC="jsonarray";}class mE{static const String TG="none";static const String YG="touchPoint";}class iE implements hB{final Function rK;num CL=0.0;num QL=0.0;int dL=1;iE(Function g,num h):rK=g{QL=gB.max(h,0.0001);}bool qB(num h){num g=CL+h;while (g>=QL&&dL>0){CL=QL;dL-- ;rK();g-= QL;}CL=g;return (dL>0);}num get currentTime=>CL;}abstract class hB{bool qB(num g);}class TD implements hB{final List<hB> vK=new List<hB>();int XL=0;num kL=0.0;void add(hB g){if(g==null)return;if(XL==vK.length){vK.add(g);}else{vK[XL]=g;}XL++ ;}void remove(hB h){if(h==null)return;for(int g=0;g<XL;g++ ){if(vK[g]==h){vK[g]=null;break;}}}void hI(AB i){if(i==null)return;for(int g=0;g<XL;g++ ){var h=vK[g];if(h!=null&&h is AH){if(h.BI==i){vK[g]=null;}}}}iE UF(Function h,num i){iE g=new iE(h,i);add(g);return g;}bool qB(num k){kL+= k;int j=XL;int h=0;for(int g=0;g<j;g++ ){var i=vK[g];if(i==null)continue;if(i.qB(k)==false){vK[g]=null;continue;}if(h!=g){vK[h]=i;vK[g]=null;}h++ ;}if(h!=j){for(int g=j;g<XL;g++ ){vK[h++ ]=vK[g];vK[g]=null;}XL=h;}return true;}}class AC{static const int zC=0xFF000000;static const int qG=0xFF0000FF;static const int IH=0xFFA9A9A9;static const int TH=0xFF008000;static const int QF=0xFFFF0000;static const int nH=0xFFFFFFFF;}class vF{String name;num tB;num oF;vF(this.name,this.tB,this.oF);}class zF{static const String NG="round";}class JB{num x;num y;JB(this.x,this.y);JB.lJ():this(0,0);num get length=>gB.sqrt(this.x*this.x+this.y*this.y);JB add(JB g)=>new JB(this.x+g.x,this.y+g.y);void FE(JB g){this.x=g.x;this.y=g.y;}bool equals(JB g)=>this.x==g.x&&this.y==g.y;}class DB{num x;num y;num width;num height;DB(this.x,this.y,this.width,this.height);DB.lJ():this(0,0,0,0);num get left=>this.x;num get top=>this.y;num get right=>this.x+this.width;num get bottom=>this.y+this.height;JB get size=>new JB(this.width,this.height);void set top(num g){this.y=g;}bool contains(num g,num h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h);bool equals(DB g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height);bool get isEmpty=>(this.width==0&&this.height==0);void FE(DB g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;}DB qF(DB g){num i=gB.min(this.left,g.left);num j=gB.min(this.top,g.top);num h=gB.max(this.right,g.right);num k=gB.max(this.bottom,g.bottom);return new DB(i,h,h-i,k-j);}}class BG{num x;num y;num hF;BG(this.x,this.y,this.hF);}class PB{num TK,UK,WK,XK,ZK,cK;num mK;PB.oJ():TK=1.0,UK=0.0,WK=0.0,XK=1.0,ZK=0.0,cK=0.0,mK=1.0;num get a=>TK;num get b=>UK;num get c=>WK;num get d=>XK;num get eB=>ZK;num get fB=>cK;num get ZC=>mK;JB oI(JB g){return new JB(g.x*TK+g.y*WK+ZK,g.x*UK+g.y*XK+cK);}void concat(PB g){num m=TK;num p=UK;num q=WK;num o=XK;num l=ZK;num n=cK;num u=mK;num j=g.a;num k=g.b;num i=g.c;num h=g.d;num v=g.eB;num t=g.fB;num CB=g.ZC;TK=(m*j+p*i);UK=(m*k+p*h);WK=(q*j+o*i);XK=(q*k+o*h);ZK=(l*j+n*i+v);cK=(l*k+n*h+t);mK=(u*CB);}void TI(){TK=1.0;UK=0.0;WK=0.0;XK=1.0;ZK=0.0;cK=0.0;mK=1.0;}void YF(){num j=TK;num m=UK;num l=WK;num k=XK;num h=ZK;num i=cK;num g=mK;TK=(k/g);UK=-(m/g);WK=-(l/g);XK=(j/g);ZK=-(TK*h+WK*i);cK=-(UK*h+XK*i);mK=(1.0/g);}void QE(num h,num i,num g,num j,num k,num l){TK=h;UK=i;WK=g;XK=j;ZK=k;cK=l;mK=(h*j-i*g);}void FE(PB g){TK=g.a;UK=g.b;WK=g.c;XK=g.d;ZK=g.eB;cK=g.fB;mK=g.ZC;}void SF(PB h,PB g){num n=h.a;num q=h.b;num t=h.c;num p=h.d;num m=h.eB;num o=h.fB;num v=h.ZC;num k=g.a;num l=g.b;num j=g.c;num i=g.d;num CB=g.eB;num u=g.fB;num FB=g.ZC;TK=(n*k+q*j);UK=(n*l+q*i);WK=(t*k+p*j);XK=(t*l+p*i);ZK=(m*k+o*j+CB);cK=(m*l+o*i+u);mK=(v*FB);}}class xF{TD VK;List<jC> jK;num wK;uC RL;gC iL;xF(){VK=new TD();jK=new List<jC>();wK=double.NAN;RL=uC.FF;iL=new gC(0);XB.window.requestAnimationFrame(iM);}TD get VI=>VK;void iM(num g){XB.window.requestAnimationFrame(iM);if(wK.isNaN)wK=g;if(wK>g)wK=g;num j=g-wK;num i=j/1000.0;if(j>=1){wK=g;iL.dK=i;RL.YN(iL);VK.qB(i);for(int h=0;h<jK.length;h++ ){var k=jK[h];k.ZF();}}}void uH(jC g){jK.add(g);}}class YB{final XB.CanvasRenderingContext2D lK;final List<PB> HL=new List<PB>(100);final List<double> jL=new List<double>(100);int yL=0;YB.nJ(XB.CanvasRenderingContext2D j,[PB matrix]):lK=j{for(int h=0;h<100;h++ ){HL[h]=new PB.oJ();jL[h]=1.0;}if(matrix!=null)HL[0].FE(matrix);var g=HL[0];var i=jL[0];lK.setTransform(g.a,g.b,g.c,g.d,g.eB,g.fB);lK.globalAlpha=i;}XB.CanvasRenderingContext2D get context=>lK;void reset(){yL=0;var g=HL[0];var h=jL[0];lK.setTransform(g.a,g.b,g.c,g.d,g.eB,g.fB);lK.globalAlpha=h;lK.clearRect(0,0,lK.canvas.width,lK.canvas.height);}void kF(AB h){var i=yL;var j=yL+1;var l=HL[i];var g=HL[j];var m=jL[i];var k=jL[j]=h.QM*m;g.SF(h.xN,l);lK.setTransform(g.a,g.b,g.c,g.d,g.eB,g.fB);lK.globalAlpha=k;yL=j;if(h.mask==null){h.QB(this);}else{lK.save();h.mask.QB(this);h.QB(this);lK.restore();}yL=i;}}class XC{static const int HG=0;static const int MG=1;static const int BF=2;static const int ZG=3;static const int yE=4;}class EB{static const String LG="added";static const String VG="addedToStage";static const String aD="enterFrame";static const String dG="removed";static const String hG="removedFromStage";static const String yG="complete";static const String LF="progress";String SK;bool WN;int ZN;IC FL;IC gN;bool iN;bool kN;EB(String g,[bool bubbles=false]){AN(g,bubbles);}void AN(String g,[bool bubbles=false]){SK=g;WN=bubbles;ZN=zB.QC;FL=null;gN=null;iN=false;kN=false;}bool get RE=>iN;String get type=>SK;bool get bubbles=>WN;bool get DE=>true;IC get target=>FL;}class zB{static const int oE=1;static const int QC=2;static const int WG=3;}class IC{Map<String,eC> hK;bool SI(String g){if(hK!=null)return hK.containsKey(g)||hK.containsKey("${g}_CAPTURE");else return false;}void dispatchEvent(EB g){mN(g,this,this,zB.QC);}void mN(EB g,IC k,IC l,int i){if(hK!=null){var j=(i==zB.oE)?"${g.type}_CAPTURE":g.type;var h=hK[j];if(h!=null){g.FL=k;g.gN=l;g.ZN=i;g.iN=false;g.kN=false;h.YN(g);}}}eC KM(String g,bool j){if(hK==null)hK=new Map<String,eC>();var i=j?"${g}_CAPTURE":g;var h=hK[i];if(h==null)h=hK[i]=new eC(this,g,j);return h;}}class uC<hC extends EB>{final List<eC> hK;int NL=0;uC():hK=new List<eC>();static uC<gC> FF=new uC<gC>();void tM(eC g){for(int h=0;h<NL;h++ )if(hK[h]==g)return;if(NL==hK.length)hK.add(g);else hK[NL]=g;NL++ ;}void YN(EB j){j.ZN=zB.QC;j.iN=false;j.kN=false;int k=NL;int i=0;for(int g=0;g<k;g++ ){var h=hK[g];if(h==null)continue;if(h.RM==0){hK[g]=null;continue;}j.FL=h.FL;j.gN=h.FL;h.YN(j);if(i!=g){hK[i]=h;hK[g]=null;}i++ ;}if(i!=k){for(int g=k;g<NL;g++ ){hK[i++ ]=hK[g];hK[g]=null;}NL=i;}}}class eC<hC extends EB> extends VB.Stream<hC>{final IC FL;final String tK;final bool hL;final List<KG> AM=new List<KG>();int RM=0;eC(this.FL,this.tK,this.hL);bool get isBroadcast=>true;VB.Stream<hC> asBroadcastStream()=>this;VB.StreamSubscription<hC> listen(void h(hC event),{void onError(VB.AsyncError error),void onDone(),bool unsubscribeOnError}){var g=new KG<hC>(this,h);if(RM==AM.length)AM.add(g);else AM[RM]=g;RM++ ;if(tK==EB.aD&&hL==false)uC.FF.tM(this);return g;}void vM(VB.StreamSubscription h){for(int g=0;g<RM;g++ ){if(AM[g]==h){AM[g]=null;break;}}}void YN(hC k){int j=RM;int h=0;for(int g=0;g<j;g++ ){var i=AM[g];if(i==null)continue;i.CM(k);if(h!=g){AM[h]=i;AM[g]=null;}h++ ;}if(h!=j){for(int g=j;g<RM;g++ ){AM[h++ ]=AM[g];AM[g]=null;}RM=h;}}}class dB<hC extends EB>{final String tK;const dB(this.tK);VB.Stream<hC> forTarget(IC g,{bool useCapture: false}){return g.KM(tK,useCapture);}}class kE{num xH;num AI;num height;num OE;num width;num x;kE(this.x,this.width,this.height,this.xH,this.AI,this.OE);}class gC extends EB{num dK;gC(num g):super(EB.aD,false){dK=g;}num get fF=>dK;bool get DE=>false;}class w extends EB{static const String pE="click";static const String UG="doubleClick";static const String vE="mouseDown";static const String AF="mouseUp";static const String DF="mouseMove";static const String EF="mouseOut";static const String GF="mouseOver";static const String nG="mouseWheel";static const String IF="middleClick";static const String sG="middleMouseDown";static const String uG="middleMouseUp";static const String JF="rightClick";static const String zG="rightMouseDown";static const String EH="rightMouseUp";num JN,KN;num MN,NN;bool rN;bool ZM;bool mM;bool cM;bool eM;int tN;int uN;int vN;w(String g,[bool bubbles=false]):super(g,bubbles){AN(g,bubbles);}void AN(String g,[bool bubbles=false]){super.AN(g,bubbles);JN=KN=0;MN=NN=0;rN=false;ZM=false;mM=false;cM=false;eM=false;tN=0;uN=0;vN=0;}set wN(JB g){JN=g.x;KN=g.y;}set zN(JB g){MN=g.x;NN=g.y;}bool get JC=>rN;bool get altKey=>ZM;bool get ctrlKey=>cM;bool get shiftKey=>eM;int get kC=>tN;}class BC extends EB{static const String XD="keyDown";static const String sE="keyUp";bool ZM;bool cM;bool eM;bool gM;bool mM;int oM;int qM;int sM;BC(String g,[bool bubbles=false]):super(g,bubbles){AN(g,bubbles);}void AN(String g,[bool bubbles=false]){super.AN(g,bubbles);ZM=false;cM=false;eM=false;gM=false;mM=false;oM=0;qM=0;sM=0;}bool get altKey=>ZM;bool get ctrlKey=>cM;bool get shiftKey=>eM;int get charCode=>oM;int get keyCode=>qM;int get keyLocation=>sM;}class dE extends EB{static const String SG="textInput";String pK="";dE(String g,[bool bubbles=false]):super(g,bubbles){}}class SB extends EB{static const String qE="touchBegin";static const String tE="touchEnd";static const String wE="touchCancel";static const String CF="touchMove";static const String iG="touchOver";static const String jG="touchOut";int GN;bool IN;num JN,KN;num MN,NN;bool ZM;bool mM;bool cM;bool eM;num RN;int UN;int VN;SB(String g,[bool bubbles=false]):super(g,bubbles){AN(g,bubbles);}void AN(String g,[bool bubbles=false]){super.AN(g,bubbles);GN=0;IN=false;JN=KN=0;MN=NN=0;ZM=false;mM=false;cM=false;eM=false;RN=1.00;UN=0;VN=0;}set wN(JB g){JN=g.x;KN=g.y;}set zN(JB g){MN=g.x;NN=g.y;}int get MD=>GN;bool get altKey=>ZM;bool get ctrlKey=>cM;bool get shiftKey=>eM;}abstract class WC{void apply(GB h,DB i,GB j,JB g);}class KJ extends WC{int KB;int LB;KJ([this.KB=4,this.LB=4]){if(KB<1||LB<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(KB>128||LB>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");}void apply(GB KC,DB q,GB LC,JB uB){var GC=KC.lN();var MB=GC.getImageData(q.x,q.y,q.width,q.height);var vB=MB.data;int v=MB.width;int wB=MB.height;int ZB=KB*KB;int xB=LB*LB;int l=KB;int yB=KB*2;int u=LB;int aB=LB*2;int NB=v+yB;int CB=wB+aB;int HC=v*4;int FB=NB*4;var TB=LC.lN();var UB=TB.createImageData(NB,CB);var t=UB.data;var j=new List<int>(1024);PH(vB);for(int i=0;i<4;i++ ){for(int h=0;h<v;h++ ){int k=0,n=xB>>1;int m=h*4+i;int o=(h+l)*4+i;for(int g=0;g<CB;g++ ){t[o]=n~/xB;o+= FB;if(g>=aB){k-= 2*j[g&1023]-j[(g-u)&1023];}else if(g>=u){k-= 2*j[g&1023];}int p=(g<wB)?vB[m]:0;j[(g+u)&1023]=p;n+= k+= p;m+= HC;}}}for(int i=0;i<4;i++ ){for(int g=0;g<CB;g++ ){int k=0,n=ZB>>1;int m=g*FB+l*4+i;int o=g*FB+i;for(int h=0;h<NB;h++ ){t[o]=n~/ZB;o+= 4;if(h>=yB){k-= 2*j[h&1023]-j[(h-l)&1023];}else if(h>=l){k-= 2*j[h&1023];}int p=(h<v)?t[m]:0;j[(h+l)&1023]=p;n+= k+= p;m+= 4;}}}WH(t);TB.putImageData(UB,uB.x-l,uB.y-u);}}class MJ extends WC{final List<num> uK;MJ.rJ():uK=[0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0,0,0,1,0];MJ.sJ():uK=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0];void apply(GB KC,DB m,GB LC,JB GC){var q=KC.lN().getImageData(m.x,m.y,m.width,m.height);var h=q.data;int uB=(uK[00]*65536).toInt();int UB=(uK[01]*65536).toInt();int HC=(uK[02]*65536).toInt();int p=(uK[03]*65536).toInt();int xB=(uK[04]*65536).toInt();int vB=(uK[05]*65536).toInt();int TB=(uK[06]*65536).toInt();int wB=(uK[07]*65536).toInt();int v=(uK[08]*65536).toInt();int n=(uK[09]*65536).toInt();int t=(uK[10]*65536).toInt();int u=(uK[11]*65536).toInt();int aB=(uK[12]*65536).toInt();int yB=(uK[13]*65536).toInt();int FB=(uK[14]*65536).toInt();int CB=(uK[15]*65536).toInt();int ZB=(uK[16]*65536).toInt();int MB=(uK[17]*65536).toInt();int o=(uK[18]*65536).toInt();int NB=(uK[19]*65536).toInt();if(RC){for(int g=0;g<=h.length-4;g+= 4){int k=h[g+0];int l=h[g+1];int j=h[g+2];int i=h[g+3];h[g+0]=((uB*k)+(UB*l)+(HC*j)+(p*i)+xB)~/65536;h[g+1]=((vB*k)+(TB*l)+(wB*j)+(v*i)+n)~/65536;h[g+2]=((t*k)+(u*l)+(aB*j)+(yB*i)+FB)~/65536;h[g+3]=((CB*k)+(ZB*l)+(MB*j)+(o*i)+NB)~/65536;}}else{for(int g=0;g<=h.length-4;g+= 4){int i=h[g+0];int j=h[g+1];int l=h[g+2];int k=h[g+3];h[g+0]=((CB*k)+(ZB*l)+(MB*j)+(o*i)+NB)~/65536;h[g+1]=((t*k)+(u*l)+(aB*j)+(yB*i)+FB)~/65536;h[g+2]=((vB*k)+(TB*l)+(wB*j)+(v*i)+n)~/65536;h[g+3]=((uB*k)+(UB*l)+(HC*j)+(p*i)+xB)~/65536;}}LC.lN().putImageData(q,GC.x,GC.y);}}class PJ extends WC{num GE;num angle;int color;num alpha;int KB;int LB;num SE;bool LE;bool NE;bool lC;PJ([this.GE=4.0,this.angle=gB.PI/4,this.color=0,this.alpha=1.0,this.KB=4,this.LB=4,this.SE=1.0,this.LE=false,this.NE=false,this.lC=false]){if(KB<1||LB<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(KB>128||LB>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");}void apply(GB WE,DB n,GB XE,JB TB){var pC=WE.lN();var YE=pC.getImageData(n.x,n.y,n.width,n.height);var ZE=YE.data;int p=n.width;int aB=n.height;int uB=KB*KB;int xB=LB*LB;int o=KB;int qC=KB*2;int UB=LB;int LC=LB*2;int MB=p+qC;int FB=aB+LC;int aE=p*4;int ZB=MB*4;int CB=RC?3:0;var q=XE.lN();var rC=q.createImageData(MB,FB);var h=rC.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){int m=0,u=xB>>1;int t=j*4+CB;int v=(j+o)*4+CB;for(int i=0;i<FB;i++ ){h[v]=u~/xB;v+= ZB;if(i>=LC){m-= 2*l[i&1023]-l[(i-UB)&1023];}else if(i>=UB){m-= 2*l[i&1023];}int k=(i<aB)?ZE[t]:0;l[(i+UB)&1023]=k;u+= m+= k;t+= aE;}}for(int i=0;i<FB;i++ ){int m=0,u=uB>>1;int t=i*ZB+o*4+CB;int v=i*ZB+CB;for(int j=0;j<MB;j++ ){h[v]=u~/uB;v+= 4;if(j>=qC){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}int k=(j<p)?h[t]:0;l[(j+o)&1023]=k;u+= m+= k;t+= 4;}}int yB=(alpha*256).toInt();int vB=(color>>16)&0xFF;int wB=(color>>8)&0xFF;int sC=(color>>0)&0xFF;if(RC){for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=vB;h[g+1]=wB;h[g+2]=sC;h[g+3]=(h[g+3]*yB)~/256;}}}else{for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=(h[g+0]*yB)~/256;h[g+1]=sC;h[g+2]=wB;h[g+3]=vB;}}}var KC=TB.x;var HC=TB.y;var GC=TB.x-o+(this.GE*gB.cos(this.angle)).round().toInt();var tC=TB.y-UB+(this.GE*gB.sin(this.angle)).round().toInt();var bE=new DB(KC,HC,p,aB);var cE=new DB(GC,tC,MB,FB);var NB=bE.qF(cE);q.setTransform(1,0,0,1,0,0);q.clearRect(NB.x,NB.y,NB.width,NB.height);q.putImageData(rC,GC,tC);if(this.lC==false)q.drawImage(pC.canvas,KC,HC);}}class LJ extends WC{int color;num alpha;int KB;int LB;num SE;bool LE;bool NE;bool lC;LJ([this.color=0,this.alpha=1.0,this.KB=4,this.LB=4,this.SE=2.0,this.LE=false,this.NE=false,this.lC=false]){if(KB<1||LB<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(KB>128||LB>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");}void apply(GB WE,DB n,GB XE,JB TB){var pC=WE.lN();var YE=pC.getImageData(n.x,n.y,n.width,n.height);var ZE=YE.data;int p=n.width;int aB=n.height;int uB=KB*KB;int xB=LB*LB;int o=KB;int qC=KB*2;int UB=LB;int LC=LB*2;int MB=p+qC;int FB=aB+LC;int aE=p*4;int ZB=MB*4;int CB=RC?3:0;var q=XE.lN();var rC=q.createImageData(MB,FB);var h=rC.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){int m=0,u=xB>>1;int t=j*4+CB;int v=(j+o)*4+CB;for(int i=0;i<FB;i++ ){h[v]=u~/xB;v+= ZB;if(i>=LC){m-= 2*l[i&1023]-l[(i-UB)&1023];}else if(i>=UB){m-= 2*l[i&1023];}int k=(i<aB)?ZE[t]:0;l[(i+UB)&1023]=k;u+= m+= k;t+= aE;}}for(int i=0;i<FB;i++ ){int m=0,u=uB>>1;int t=i*ZB+o*4+CB;int v=i*ZB+CB;for(int j=0;j<MB;j++ ){h[v]=u~/uB;v+= 4;if(j>=qC){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}int k=(j<p)?h[t]:0;l[(j+o)&1023]=k;u+= m+= k;t+= 4;}}int yB=(alpha*256).toInt();int vB=(color>>16)&0xFF;int wB=(color>>8)&0xFF;int sC=(color>>0)&0xFF;if(RC){for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=vB;h[g+1]=wB;h[g+2]=sC;h[g+3]=(h[g+3]*yB)~/256;}}}else{for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=(h[g+0]*yB)~/256;h[g+1]=sC;h[g+2]=wB;h[g+3]=vB;}}}var KC=TB.x;var HC=TB.y;var GC=TB.x-o;var tC=TB.y-UB;var bE=new DB(KC,HC,p,aB);var cE=new DB(GC,tC,MB,FB);var NB=bE.qF(cE);q.setTransform(1,0,0,1,0,0);q.clearRect(NB.x,NB.y,NB.width,NB.height);q.putImageData(rC,GC,tC);if(this.lC==false)q.drawImage(pC.canvas,KC,HC);}}abstract class AB extends IC implements VC{num ML=0.0;num TL=0.0;num aL=0.0;num lL=0.0;num tL=1.0;num BM=1.0;num JM=0.0;num QM=1.0;bool SM=true;SD UM=null;String YK="";WB bM=null;final PB fM=new PB.oJ();final PB lM=new PB.oJ();final PB rM=new PB.oJ();bool xM=true;static const dB<gC> NH=const dB<gC>(EB.aD);VB.Stream<gC> get YI=>AB.NH.forTarget(this);num get x=>ML;num get y=>TL;num get lB=>aL;num get sB=>lL;num get mB=>tL;num get nB=>BM;num get nC=>JM;num get alpha=>QM;bool get visible=>SM;SD get mask=>UM;String get name=>YK;WB get parent=>bM;AB get root{AB g=this;while (g.bM!=null)g=g.bM;return g;}jC get LD{AB g=this.root;if(g is jC)return g;return null;}set x(num g){ML=g;xM=true;}set y(num g){TL=g;xM=true;}set lB(num g){aL=g;xM=true;}set sB(num g){lL=g;xM=true;}set mB(num g){tL=g;xM=true;}set nB(num g){BM=g;xM=true;}set nC(num g){JM=g;xM=true;}set alpha(num g){QM=g;xM=true;}set visible(bool g){SM=g;xM=true;}set mask(SD g){UM=g;}num get width=>FC(xN).width;num get height=>FC(xN).height;void set width(num h){this.mB=1;num g=this.width;this.mB=(g!=0.0)?h/g:1.0;}void set height(num h){this.nB=1;num g=this.height;this.nB=(g!=0.0)?h/g:1.0;}void vH(WB g){g.BB(this);}void PE(){if(bM!=null)bM.iF(this);}PB get xN{if(xM){xM=false;if(JM==0.0){rM.QE(tL,0.0,0.0,BM,ML-aL*tL,TL-lL*BM);}else{double g=gB.cos(JM);double h=gB.sin(JM);double i=tL*g;double l=tL*h;double k=-BM*h;double j=BM*g;double m=ML-aL*i-lL*k;double n=TL-aL*l-lL*j;rM.QE(i,l,k,j,m,n);}}return rM;}DB FC(PB g,[DB returnRectangle]){if(returnRectangle==null)returnRectangle=new DB.lJ();returnRectangle.x=g.eB;returnRectangle.y=g.fB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;}AB NC(num g,num h){if(FC(lM).contains(g,h))return this;return null;}JB bC(JB h){fM.TI();for(AB g=this;g!=null;g=g.bM)fM.concat(g.xN);fM.YF();return fM.oI(h);}void dispatchEvent(EB h){List<AB> g=null;if(h.DE||h.bubbles)for(AB j=bM;j!=null;j=j.bM)if(j.SI(h.type)){if(g==null)g=new List<AB>();g.add(j);}if(h.DE&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.RE==false)g[i].mN(h,this,g[i],zB.oE);if(h.RE==false)mN(h,this,this,zB.QC);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.RE==false)g[i].mN(h,this,g[i],zB.WG);}void AO(WB h){for(var g=h;g!=null;g=g.bM)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");bM=h;}void QB(YB g);}abstract class IB extends AB{bool CI=false;bool dF=true;bool kJ=true;int tabIndex=0;static const dB<w> gG=const dB<w>(w.EF);static const dB<w> mG=const dB<w>(w.GF);static const dB<w> tG=const dB<w>(w.DF);static const dB<w> wG=const dB<w>(w.vE);static const dB<w> FH=const dB<w>(w.AF);static const dB<w> SH=const dB<w>(w.nG);VB.Stream<w> get onMouseOut=>IB.gG.forTarget(this);VB.Stream<w> get onMouseOver=>IB.mG.forTarget(this);VB.Stream<w> get onMouseMove=>IB.tG.forTarget(this);VB.Stream<w> get onMouseDown=>IB.wG.forTarget(this);VB.Stream<w> get onMouseUp=>IB.FH.forTarget(this);VB.Stream<w> get onMouseWheel=>IB.SH.forTarget(this);static const dB<SB> bH=const dB<SB>(SB.CF);static const dB<SB> dH=const dB<SB>(SB.tE);static const dB<SB> fH=const dB<SB>(SB.wE);VB.Stream<SB> get onTouchMove=>IB.bH.forTarget(this);VB.Stream<SB> get onTouchEnd=>IB.dH.forTarget(this);VB.Stream<SB> get onTouchCancel=>IB.fH.forTarget(this);static const dB<BC> jH=const dB<BC>(BC.sE);static const dB<BC> kH=const dB<BC>(BC.XD);VB.Stream<BC> get onKeyUp=>IB.jH.forTarget(this);VB.Stream<BC> get onKeyDown=>IB.kH.forTarget(this);}abstract class WB extends IB{final List<AB> PL=new List<AB>();bool mL=true;bool xL=true;int get ID=>PL.length;void BB(AB g){if(g.parent==this){int h=PL.indexOf(g);PL.removeAt(h);PL.add(g);}else{BE(g,PL.length);}}void BE(AB g,int h){if(h<0&&h>PL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){PL.removeAt(PL.indexOf(g));if(h>PL.length)h-- ;PL.insertRange(h,1,g);}else{g.PE();g.AO(this);PL.insertRange(h,1,g);g.dispatchEvent(new EB(EB.LG,true));if(this.LD!=null)CO(g,new EB(EB.VG));}}void iF(AB h){int g=PL.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");gI(g);}void gI(int g){if(g<0&&g>=PL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");AB h=PL[g];h.dispatchEvent(new EB(EB.dG,true));if(this.LD!=null)CO(h,new EB(EB.hG));h.AO(null);PL.removeAt(g);}dynamic WF(int g){if(g<0&&g>=PL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return PL[g];}void mI(Function g){PL.sort(g);}bool contains(AB g){for(;g!=null;g=g.bM)if(g==this)return true;return false;}DB FC(PB n,[DB returnRectangle]){if(returnRectangle==null)returnRectangle=new DB.lJ();if(PL.length==0)return super.FC(n,returnRectangle);num h=double.INFINITY;num i=double.INFINITY;num k=double.NEGATIVE_INFINITY;num j=double.NEGATIVE_INFINITY;int o=PL.length;for(int l=0;l<PL.length;l++ ){AB m=PL[l];fM.SF(m.xN,n);DB g=m.FC(fM,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;}AB NC(num o,num p){AB l=null;for(int j=PL.length-1;j>=0;j-- ){AB i=PL[j];if(i.visible){PB g=i.xN;double m=o-g.eB;double k=p-g.fB;double q=(g.d*m-g.c*k)/g.ZC;double n=(g.a*k-g.b*m)/g.ZC;var h=i.NC(q,n);if(h!=null){if(h is IB)if(h.dF)return mL?h:this;l=this;}}}return l;}void QB(YB i){for(int g=0;g<PL.length;g++ ){AB h=PL[g];if(h.visible)i.kF(h);}}void CO(AB g,EB j){g.dispatchEvent(j);if(g is WB){List<AB> i=new List<AB>.from(g.PL);for(int h=0;h<i.length;h++ )CO(i[h],j);}}}class fE{IB target=null;bool JC=false;int EE=0;int kC=0;String cF,eF;String aF,bF;fE(this.cF,this.eF,this.aF,this.bF);}class FG{static const String TG="none";}class jE{String font;int size;int color;bool ED;bool ME;bool pI;String align;int WI;int jI;int UI;int OE;int letterSpacing=0;int SJ=0;bool TJ=false;bool eJ=false;jE(this.font,this.size,this.color,{this.ED: false,this.ME: false,this.pI: false,this.align: "left",this.WI: 0,this.jI: 0,this.UI: 0,this.OE: 0});}class eE extends WB{bool UJ=false;bool VE=false;}class xC extends AB{GB rB;String fI;DB SC;xC([this.rB=null,this.fI="auto"]){SC=null;}DB FC(PB h,[DB returnRectangle]){int g=(rB!=null)?rB.width:0;int i=(rB!=null)?rB.height:0;return pD(h,g,i,returnRectangle);}AB NC(num g,num h){if(rB!=null&&g>=0.0&&h>=0.0&&g<rB.width&&h<rB.height)return this;return null;}void QB(YB g){if(rB!=null){if(SC==null)rB.QB(g);else rB.jF(g,SC);}}}class wF{static const String IG="dynamic";}abstract class VC{void QB(YB g);}class EG extends IB implements hB{List<GB> JL;int SL;int cL;double oL;bool vL;bool kK;EB GM;EB NM;DB SC;EG(List<GB> g,[int frameRate=30,bool loop=true]){JL=g;SL=frameRate;cL=0;oL=null;vL=false;kK=loop;GM=new EB(EB.LF);NM=new EB(EB.yG);SC=null;}static const dB<EB> HH=const dB<EB>(EB.LF);VB.Stream<EB> get onProgress=>EG.HH.forTarget(this);int get UE=>JL.length;void set loop(bool g){kK=g;}void play(){vL=true;oL=null;}void stop(){vL=false;oL=null;}bool qB(num j){if(vL==false)return true;if(oL==null){oL=0.0;mN(GM,this,this,zB.QC);}else{oL+= j;num i=1.0/SL;while (vL&&oL>=i){var h=cL;var g=kK?(h+1)%UE:gB.min(h+1,UE-1);cL=g;oL-= i;if(h!=g){mN(GM,this,this,zB.QC);if(cL!=g)return true;}if(h!=g&&g==UE-1&&kK==false){mN(NM,this,this,zB.QC);if(cL!=g)return true;}}}return true;}DB FC(PB h,[DB returnRectangle]){GB g=JL[cL];return pD(h,g.width,g.height,returnRectangle);}AB NC(num g,num h){GB i=JL[cL];if(g>=0&&h>=0&&g<i.width&&h<i.height)return this;return null;}void QB(YB g){GB h=JL[cL];if(SC==null)h.QB(g);else h.jF(g,SC);}}class gE{String YK;CC qK;int EL;int OL;int UL;int eL;int pL;int uL;int zL;int IM;bool PM;gE(String g,CC h){YK=g;qK=h;}CC get nI=>qK;String get name=>YK;int get JI=>EL;int get KI=>OL;int get II=>UL;int get GI=>eL;int get offsetX=>pL;int get offsetY=>uL;int get cI=>zL;int get bI=>IM;bool get kI=>PM;}class jB{static const String VD="auto";static const String YD="arrow";static const String ZD="button";static const String bG="hand";static const String cG="ibeam";static const String fG="wait";}class PC{static const String WD="center";static const String RG="end";static const String XG="justify";static const String BF="right";}class JJ extends AB{lE fK;JJ(){fK=new lE();}lE get RI=>fK;DB FC(PB g,[DB returnRectangle]){if(returnRectangle==null)returnRectangle=new DB.lJ();returnRectangle.x=g.eB;returnRectangle.y=g.fB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;}AB NC(num g,num h){return null;}void QB(YB g){fK.QB(g);}}class lE{final List<AG> gK=new List<AG>();clear()=>gK.clear();beginPath()=>gK.add(new AG("beginPath"));closePath()=>gK.add(new AG("closePath"));moveTo(num h,num g)=>gK.add(new AG("moveTo",[h,g]));lineTo(num h,num g)=>gK.add(new AG("lineTo",[h,g]));arcTo(num k,num i,num g,num h,num j)=>gK.add(new AG("arcTo",[k,i,g,h,j]));quadraticCurveTo(num j,num i,num g,num h)=>gK.add(new AG("quadraticCurveTo",[j,i,g,h]));bezierCurveTo(num h,num k,num l,num i,num g,num j)=>gK.add(new AG("bezierCurveTo",[h,k,l,i,g,j]));arc(num l,num g,num j,num i,num h,bool k)=>gK.add(new AG("arc",[l,g,j,i,h,k]));rect(num i,num g,num h,num j)=>gK.add(new AG("rect",[i,g,h,j]));nF(int g,[int width=1,String joints=zF.NG,String caps=yF.NG])=>gK.add(new AG("strokeColor",[dD(g),width,joints,caps]));EI(int g)=>gK.add(new AG("fillColor",[dD(g)]));void QB(YB k){var h=k.context;h.save();for(var j in gK){List g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].QO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].RO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];PB i=g[0].uK;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.eB,i.fB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].bJ(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].cJ(h);PB i=g[0].uK;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.eB,i.fB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}class OJ extends IB{String pK="";int AL=0x000000;jE WL=null;String nL=FG.TG;String EM=DG.PG;String SK=wF.IG;bool TM=false;bool XM=false;int YM=0x000000;bool dM=false;int hM=0x000000;num kM=0;num nM=0;List<String> pM;List<kE> uM;bool wM=true;num yM=100;num zM=100;XB.CanvasElement BN=null;XB.CanvasRenderingContext2D lK=null;OJ(){WL=new jE("Arial",12,0x000000);pM=new List<String>();uM=new List<kE>();}String get type=>SK;num get width=>yM;num get height=>zM;void set text(String g){pK=g;wM=true;}void set TC(jE g){WL=g;AL=WL.color;wM=true;}void set wordWrap(bool g){TM=g;wM=true;}void set width(num g){yM=g;wM=true;}void set height(num g){zM=g;wM=true;}DB FC(PB g,[DB returnRectangle]){return pD(g,yM,zM,returnRectangle);}AB NC(num g,num h){if(g>=0&&h>=0&&g<yM&&h<zM)return this;return null;}void QB(YB g){OO();g.lK.drawImage(BN,0.0,0.0);}void PO(){pM.clear();uM.clear();if(TM==false){pM.add(pK);}else{for(String n in pK.replaceAll('\r','').split('\n')){var h=new StringBuffer();var i=0;var g="";for(String j in n.split(' ')){i=h.length;h.write((i>0)?" ${j}":j);g=h.toString();if(lK.measureText(g).width>yM){if(i>0){g=g.substring(0,i);}else{j="";}pM.add(g);h=new StringBuffer();h.write(j);}}if(h.isEmpty==false){pM.add(h.toString());}}}kM=0;nM=0;for(String g in pM){var l=lK.measureText(g);var m=0;if(WL.align==PC.WD||WL.align==PC.XG)m=(yM-l.width)/2;if(WL.align==PC.BF||WL.align==PC.RG)m=yM-l.width;kE k=new kE(m,l.width,WL.size,0,0,0);uM.add(k);kM=gB.max(kM,k.width);nM=nM+k.height;}}void OO(){if(wM){wM=false;int j=yM.ceil().toInt();int i=zM.ceil().toInt();if(BN==null){BN=new XB.CanvasElement(width:j,height:i);lK=BN.context2d;}if(BN.width!=j)BN.width=j;if(BN.height!=i)BN.height=i;StringBuffer g=new StringBuffer();g.write(WL.ME?"italic ":"normal ");g.write("normal ");g.write(WL.ED?"bold ":"normal ");g.write("${WL.size}px ");g.write("${WL.font},sans-serif");lK.font=g.toString();lK.textAlign="start";lK.textBaseline="top";lK.fillStyle=iC(AL);PO();if(XM){lK.fillStyle=iC(YM);lK.fillRect(0,0,yM,zM);}else{lK.clearRect(0,0,yM,zM);}int k=0;for(int h=0;h<pM.length;h++ ){var l=uM[h];lK.fillStyle=iC(AL);lK.fillText(pM[h],l.x,k);k+= l.height;}if(dM){lK.strokeStyle=iC(hM);lK.lineWidth=1;lK.strokeRect(0,0,yM,zM);}}}}class AG{String name;List arguments;AG(this.name,[this.arguments]);}class DG{static const String PG="pixel";}class dC{static String kG=CH();static sF.AudioContext AD=MH();static List<String> HF=OH();static String CH(){var h=(AD!=null)?"WebAudioApi":"AudioElement";var g=XB.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(HF.length==0)h="Mock";print("dartflash: supported audio engine is: ${h}");return h;}static sF.AudioContext MH(){try {return new sF.AudioContext();}catch (g){return null;}}static List<String> OH(){var g=new List<String>();var h=new XB.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("dartflash: supported audio types are: ${g}");return g;}}class NJ extends OC{bool kK;bB DL;NJ(hE i,bool h,bB g){kK=h;DL=g;}set KD(bB g){DL=g;}void stop(){}}class SD{int SK;DB aK;BG sK;List<JB> GL;SD.mJ(num i,num g,num h,num j){SK=0;aK=new DB(i,g,h,j);}SD.pJ(num i,num g,num h){SK=1;sK=new BG(i,g,h);}SD.qJ(List<JB> g){SK=2;GL=g;if(GL.length<3)throw new ArgumentError("A custom mask needs at least 3 points.");}void QB(YB i){var g=i.context;g.beginPath();switch (SK){case 0:g.rect(aK.x,aK.y,aK.width,aK.height);break;case 1:g.arc(sK.x,sK.y,sK.hF,0,gB.PI*2.0,false);break;case 2:g.moveTo(GL[0].x,GL[0].y);for(int h=1;h<GL.length;h++ )g.lineTo(GL[h].x,GL[h].y);break;}g.clip();}}class UD{static String nE=jB.VD;static bool OG=false;static VB.StreamController<String> aG=new VB.StreamController<String>();static VB.Stream<String> eG=aG.stream.asBroadcastStream();static String OF(String i){String h=i;String g="auto";if(nE!=jB.VD)h=nE;switch (h){case jB.VD:g="auto";break;case jB.YD:g="default";break;case jB.ZD:g="pointer";break;case jB.bG:g="move";break;case jB.cG:g="text";break;case jB.fG:g="wait";break;}if(OG)g="none";return g;}}class hE extends iB{hE(){}static VB.Future<iB> lD(String g){return new VB.Future<iB>.of(()=>new hE());}num get length{return double.NAN;}OC play([bool loop=false,bB soundTransform]){if(soundTransform==null){soundTransform=new bB();}return new NJ(this,loop,soundTransform);}}class IJ extends OC{QD yK;bB DL;bool kK;sF.GainNode qL;sF.AudioBufferSourceNode DM;IJ(QD j,bool h,bB i){yK=j;kK=h;DL=i;var g=dC.AD;qL=g.createGain();qL.connect(g.destination,0,0);qL.gain.value=(DL!=null)?gB.pow(DL.volume,2):1;DM=g.createBufferSource();DM.buffer=yK.iK;DM.loop=h;DM.connect(qL,0,0);DM.start(0);}void set KD(bB g){DL=g;qL.gain.value=(DL!=null)?gB.pow(DL.volume,2):1;}void stop(){DM.stop(0);}}class QD extends iB{sF.AudioBuffer iK;QD(){if(dC.AD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static VB.Future<iB> lD(String n){var h=new QD();var k=iB.MF(n);var g=new VB.Completer<iB>();XB.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var m=dC.AD;m.decodeAudioData(j,(sF.AudioBuffer l){h.iK=l;g.complete(h);},(o){g.completeError(new StateError("Failed to decode audio."));});}).catchError((o){g.completeError(new StateError("Failed to load audio."));});return g.future;}num get length{return iK.duration;}OC play([bool loop=false,bB soundTransform]){if(soundTransform==null)soundTransform=new bB();return new IJ(this,loop,soundTransform);}}class yF{static const String NG="round";}class wC extends OC{RD BL;XB.AudioElement oK;bool kK;bB DL;wC(RD g,bool i,bB h){BL=g;kK=i;DL=h;oK=g.jM(this);oK.loop=kK;this.KD=h;oK.play();}void set KD(bB g){DL=g;if(oK!=null)oK.volume=(DL!=null)?DL.volume:1;}void stop(){if(oK!=null){if(oK.ended==false)oK.pause();BL.sN(this);oK=null;}}}class bB{num volume;num dI;num fJ=1;num gJ=0;num jJ=1;num iJ=0;bB([this.volume=1,this.dI=0]);}abstract class OC extends IC{void set KD(bB g);void stop();}abstract class iB{static VB.Future<iB> lD(String g){var h=dC.kG;if(h=="WebAudioApi")return QD.lD(g);if(h=="AudioElement")return RD.lD(g);return hE.lD(g);}num get length;OC play([bool loop=false,bB soundTransform]);static String MF(String g){var m=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var i=m.firstMatch(g);var h=dC.HF;if(i==null)throw new ArgumentError("Unsupported file extension.");if(h.length==0)throw new UnsupportedError("This browser supports no known audio codec.");var j=i.group(1).toLowerCase();if(h.indexOf(j)==-1){var l=g.substring(0,g.length-j.length);var k=h[0];g="${l}${k}";}return g;}}class CG extends IB{CG();}class RD extends iB{XB.AudioElement oK;List<XB.AudioElement> IL;List<wC> gL;RD(){gL=new List<wC>();oK=new XB.AudioElement();oK.onEnded.listen(VM);IL=new List<XB.AudioElement>();IL.add(oK);XB.document.body.children.add(oK);}static VB.Future<iB> lD(String o){var k=new RD();var g=k.oK;var i=new VB.Completer<iB>();VB.StreamSubscription h;VB.StreamSubscription j;n(m){h.cancel();j.cancel();i.complete(k);}l(m){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(n);j=g.onError.listen(l);g.src=iB.MF(o);g.load();return i.future;}num get length{return oK.duration;}OC play([bool loop=false,bB soundTransform]){if(soundTransform==null)soundTransform=new bB();return new wC(this,loop,soundTransform);}XB.AudioElement jM(wC h){XB.AudioElement g;if(IL.length==0){g=oK.clone(true);g.onEnded.listen(VM);}else{g=IL.removeAt(0);}gL.add(h);return g;}void sN(wC g){XB.AudioElement h=g.oK;int i=gL.indexOf(g);gL.removeAt(i);IL.add(h);if(oK.currentTime>0&&oK.ended==false)oK.currentTime=0;}void VM(j){XB.AudioElement i=j.target;wC g=null;for(int h=0;h<gL.length&&g==null;h++ )if(gL[h].oK==i)g=gL[h];if(g!=null)g.stop();}}class GB implements VC{int nK;int xK;bool KL;XB.Element ZL;XB.CanvasRenderingContext2D lK;int wL;double FM;double MM;double EL;double OL;double UL;double eL;GB(int g,int h,[bool transparent=true,int fillColor=0xFFFFFFFF]){nK=g;xK=h;KL=transparent;var i=new XB.CanvasElement(width:nK,height:xK);lK=i.context2d;lK.fillStyle=KL?dD(fillColor):iC(fillColor);lK.fillRect(0,0,g,h);ZL=i;wL=0;}GB.tJ(XB.ImageElement g){nK=g.naturalWidth;xK=g.naturalHeight;KL=true;ZL=g;wL=0;}GB.uJ(gE g){nK=g.cI;xK=g.bI;KL=true;ZL=g.nI.HD;wL=g.kI?2:1;FM=g.offsetX.toDouble();MM=g.offsetY.toDouble();EL=g.JI.toDouble();OL=g.KI.toDouble();UL=g.II.toDouble();eL=g.GI.toDouble();}static VB.Future<GB> lD(String i){VB.Completer<GB> h=new VB.Completer<GB>();var g=new XB.ImageElement();g.onLoad.listen((j)=>h.complete(new GB.tJ(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;}int get width=>nK;int get height=>xK;void wH(GB i,DB j,JB g,WC h){h.apply(i,j,this,g);}void QB(YB g){switch (wL){case 0:g.context.drawImage(ZL,0.0,0.0);break;case 1:g.context.drawImage(ZL,EL,OL,UL,eL,FM,MM,UL,eL);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,FM,MM+eL);g.context.drawImage(ZL,EL,OL,eL,UL,0.0,0.0,eL,UL);break;}}void jF(YB v,DB g){if(g.width<=0.0||g.height<=0.0)return;switch (wL){case 0:v.context.drawImage(ZL,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=EL;double h=OL;double p=j+UL;double q=h+eL;double l=EL-FM+g.x;double m=OL-MM+g.y;double u=l+g.width;double t=m+g.height;double o=(j>l)?j:l;double n=(h>m)?h:m;double CB=(p<u)?p:u;double NB=(q<t)?q:t;double MB=FM-j+o;double FB=MM-h+n;double k=CB-o;double i=NB-n;if(k>0.0&&i>0.0){v.context.drawImage(ZL,o,n,k,i,MB,FB,k,i);}break;case 2:double j=EL;double h=OL;double p=j+eL;double q=h+UL;double l=EL+MM-g.y+eL-g.height;double m=OL-FM+g.x;double u=l+g.height;double t=m+g.width;double o=(j>l)?j:l;double n=(h>m)?h:m;double CB=(p<u)?p:u;double NB=(q<t)?q:t;double MB=FM-h+n;double FB=MM+p-CB;double k=NB-n;double i=CB-o;if(k>0.0&&i>0.0){v.context.transform(0.0,-1.0,1.0,0.0,MB,FB+i);v.context.drawImage(ZL,o,n,i,k,0.0,0.0,i,k);}break;}}XB.CanvasRenderingContext2D lN(){if(lK==null){var g=new XB.CanvasElement(width:nK,height:xK);lK=g.context2d;switch (wL){case 0:lK.drawImage(ZL,0,0);break;case 1:lK.drawImage(ZL,EL,OL,UL,eL,FM,MM,UL,eL);break;case 2:lK.setTransform(0.0,-1.0,1.0,0.0,FM,MM+eL);lK.drawImage(ZL,EL,OL,eL,UL,0.0,0.0,eL,UL);lK.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}ZL=g;wL=0;}return lK;}}typedef void GG<hC extends EB>(hC event);class KG<hC extends EB> extends VB.StreamSubscription<hC>{eC rL;GG<hC> CM;int HM;bool OM;KG(this.rL,this.CM){HM=0;OM=false;}void cancel(){if(OM==false){rL.vM(this);OM=true;CM=null;}}void onError(void g(VB.AsyncError error)){}bool get eN=>HM>0;void pause([VB.Future resumeSignal]){HM++ ;if(resumeSignal!=null)resumeSignal.whenComplete(resume);}void resume(){if(eN==false)throw new StateError("Subscription is not paused.");HM-- ;}}class rE{Map<String,vC> bL;rE(){bL=new Map<String,vC>();}void aM(vC g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(bL.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");bL[i]=g;}dynamic DN(String i,String g){var h="${i}.${g}";if(bL.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return bL[h];}void pB(String i,String h){var g=new vC("BitmapData",i,h);g.CN(GB.lD(h));aM(g);}void HB(String i,String h){var g=new vC("Sound",i,h);g.CN(iB.lD(h));aM(g);}void CE(String j,String h,String i){var g=new vC("TextureAtlas",j,h);g.CN(CC.lD(h,i));aM(g);}void tH(String i,String h){var g=new vC("FlumpLibrary",i,h);g.CN(DC.lD(h));aM(g);}VB.Future<rE> load(){var h=this.eI.map((i)=>i.LL);return VB.Future.wait(h).then((j){var g=this.DI;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});}List<vC> get eI{return bL.values.where((g)=>g.mC==null).toList();}List<vC> get DI{return bL.values.where((g)=>g.error!=null).toList();}GB MC(String g){return DN("BitmapData",g).mC;}iB XF(String g){return DN("Sound",g).mC;}CC KE(String g){return DN("TextureAtlas",g).mC;}DC MI(String g){return DN("FlumpLibrary",g).mC;}}String iC(int g){int h=(g>>16)&0xFF;int i=(g>>8)&0xFF;int j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class DC{String zK;String sL;int SL;final List<zD> LM=new List<zD>();final List<rH> WM=new List<rH>();static VB.Future<DC> lD(String l){var i=new VB.Completer<DC>();XB.HttpRequest.getString(l).then((p){var h=rF.parse(p) as Map;var j=new List();var g=new DC();g.zK=l;g.sL=h["md5"];g.SL=h["frameRate"].toInt();for(var m in h["movies"] as List){var n=new zD(m,g);g.LM.add(n);}for(var o in h["textureGroups"] as List){var k=new rH(o,g);g.WM.add(k);j.add(k.FD.future);}VB.Future.wait(j).then((t){i.complete(g);}).catchError((q){i.completeError(new StateError("Failed to load image."));});}).catchError((q){i.completeError(new StateError("Failed to load json file."));});return i.future;}zD yN(String h){for(var g in LM)if(g.id==h)return g;throw new ArgumentError("The movie '${h}' is not available.");}VC BO(String g){for(var h in WM){if(h.GD.containsKey(g)){return h.GD[g];}}for(var i in LM){if(i.id==g){return new QJ(this,g);}}throw new ArgumentError("The symbol '${g}' is not available.");}}class xE{static bool zE=false;static bool bD=false;static int cD=0;static String pG=mE.TG;static VB.StreamController<String> rG=new VB.StreamController<String>();static VB.Stream<String> vG=rG.stream.asBroadcastStream();static xG(){if(zE==false){zE=true;var g=XB.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){bD=true;cD=10;}if(g.contains("Android")){bD=true;cD=10;}if(g.contains("IEMobile")){bD=true;cD=10;}}}static String get RH{xG();return pG;}}class lG{static int oG=0;int MD=oG++ ;IB target=null;bool JD=false;lG(this.target,this.JD);}String dD(int g){int h=(g>>24)&0xFF;int i=(g>>16)&0xFF;int j=(g>>8)&0xFF;int k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class s{static gB.Random eD;static num YC(num g){return g;}static num KF(num g){return 0.5-0.5*gB.cos(g*2.0*gB.PI);}static num DH(num g){return 0.5+0.5*gB.cos(g*2.0*gB.PI);}static num GH(num g){if(eD==null)eD=new gB.Random();if(g==0.0||g==1.0)return g;return eD.nextDouble();}static num fD(num g){return g*g;}static num gD(num g){g=1.0-g;return 1.0-g*g;}static num JH(num g){g=g*2.0;return (g<1.0)?0.5*fD(g):0.5*gD(g-1.0)+0.5;}static num KH(num g){g=g*2.0;return (g<1.0)?0.5*gD(g):0.5*fD(g-1.0)+0.5;}static num hD(num g){return g*g*g;}static num iD(num g){g=1.0-g;return 1.0-g*g*g;}static num PF(num g){g=g*2.0;return (g<1.0)?0.5*hD(g):0.5*iD(g-1.0)+0.5;}static num QH(num g){g=g*2.0;return (g<1.0)?0.5*iD(g):0.5*hD(g-1.0)+0.5;}static num jD(num g){return g*g*g*g;}static num kD(num g){g=1.0-g;return 1.0-g*g*g*g;}static num UH(num g){g=g*2.0;return (g<1.0)?0.5*jD(g):0.5*kD(g-1.0)+0.5;}static num VH(num g){g=g*2.0;return (g<1.0)?0.5*kD(g):0.5*jD(g-1.0)+0.5;}static num mD(num g){return g*g*g*g*g;}static num nD(num g){g=1.0-g;return 1.0-g*g*g*g*g;}static num XH(num g){g=g*2.0;return (g<1.0)?0.5*mD(g):0.5*nD(g-1.0)+0.5;}static num YH(num g){g=g*2.0;return (g<1.0)?0.5*nD(g):0.5*mD(g-1.0)+0.5;}static num oD(num g){return 1.0-gB.sqrt(1.0-g*g);}static num qD(num g){g=1.0-g;return gB.sqrt(1.0-g*g);}static num ZH(num g){g=g*2.0;return (g<1.0)?0.5*oD(g):0.5*qD(g-1.0)+0.5;}static num aH(num g){g=g*2.0;return (g<1.0)?0.5*qD(g):0.5*oD(g-1.0)+0.5;}static num rD(num g){return 1.0-gB.cos(g*(gB.PI/2.0));}static num sD(num g){return gB.sin(g*(gB.PI/2.0));}static num cH(num g){g=g*2.0;return (g<1.0)?0.5*rD(g):0.5*sD(g-1.0)+0.5;}static num gH(num g){g=g*2.0;return (g<1.0)?0.5*sD(g):0.5*rD(g-1.0)+0.5;}static num tD(num g){if(g==0.0)return 0.0;return gB.pow(2.0,10.0*(g-1.0));}static num uD(num g){if(g==1.0)return 1.0;return 1.0-gB.pow(2.0,-10.0*g);}static num hH(num g){g=g*2.0;return (g<1.0)?0.5*tD(g):0.5*uD(g-1.0)+0.5;}static num iH(num g){g=g*2.0;return (g<1.0)?0.5*uD(g):0.5*tD(g-1.0)+0.5;}static num vD(num g){num h=1.70158;return g*g*((h+1.0)*g-h);}static num wD(num g){num h=1.70158;g=g-1.0;return g*g*((h+1.0)*g+h)+1.0;}static num RF(num g){g=g*2.0;return (g<1.0)?0.5*vD(g):0.5*wD(g-1.0)+0.5;}static num lH(num g){g=g*2.0;return (g<1.0)?0.5*wD(g):0.5*vD(g-1.0)+0.5;}static num xD(num g){if(g==0.0||g==1.0)return g;g=g-1.0;return -gB.pow(2.0,10.0*g)*gB.sin((g-0.3/4.0)*(2.0*gB.PI)/0.3);}static num BD(num g){if(g==0.0||g==1.0)return g;return gB.pow(2.0,-10.0*g)*gB.sin((g-0.3/4.0)*(2.0*gB.PI)/0.3)+1;}static num mH(num g){g=g*2.0;return (g<1.0)?0.5*xD(g):0.5*BD(g-1.0)+0.5;}static num oH(num g){g=g*2.0;return (g<1.0)?0.5*BD(g):0.5*xD(g-1.0)+0.5;}static num yD(num g){return 1.0-CD(1.0-g);}static num CD(num g){if(g<1/2.75){return 7.5625*g*g;}else if(g<2/2.75){g=g-1.5/2.75;return 7.5625*g*g+0.75;}else if(g<2.5/2.75){g=g-2.25/2.75;return 7.5625*g*g+0.9375;}else{g=g-2.625/2.75;return 7.5625*g*g+0.984375;}}static num pH(num g){g=g*2.0;return (g<1.0)?0.5*yD(g):0.5*CD(g-1.0)+0.5;}static num qH(num g){g=g*2.0;return (g<1.0)?0.5*CD(g):0.5*yD(g-1.0)+0.5;}}class AH implements hB{final AB EN;final Function HN;final List<vF> LN=new List<vF>();Function ON;Function PN;Function SN;num QL;num CL;num bN;bool cN;bool fN;AH(AB g,num h,[num transitionFunction(num ratio)]):EN=g,HN=(transitionFunction!=null)?transitionFunction:s.YC{CL=0.0;QL=gB.max(0.0001,h);bN=0.0;cN=false;fN=false;}void kB(String g,num h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(EN!=null&&fN==false)LN.add(new vF(g,0.0,h));}void moveTo(num h,num g){kB('x',h);kB('y',g);}bool qB(num l){if(CL<QL||fN==false){CL=CL+l;if(CL>QL)CL=QL;if(CL>=0.0){if(fN==false){fN=true;for(int i=0;i<LN.length;i++ ){var g=LN[i];switch (g.name){case 'x':g.tB=EN.x;break;case 'y':g.tB=EN.y;break;case 'pivotX':g.tB=EN.lB;break;case 'pivotY':g.tB=EN.sB;break;case 'scaleX':g.tB=EN.mB;break;case 'scaleY':g.tB=EN.nB;break;case 'rotation':g.tB=EN.nC;break;case 'alpha':g.tB=EN.alpha;break;}}if(ON!=null)ON();}num j=CL/QL;num k=HN(j);for(int i=0;i<LN.length;i++ ){var g=LN[i];var h=g.tB+k*(g.oF-g.tB);h=cN?h.round():h;switch (g.name){case 'x':EN.x=h;break;case 'y':EN.y=h;break;case 'pivotX':EN.lB=h;break;case 'pivotY':EN.sB=h;break;case 'scaleX':EN.mB=h;break;case 'scaleY':EN.nB=h;break;case 'rotation':EN.nC=h;break;case 'alpha':EN.alpha=h;break;}}if(PN!=null)PN();if(SN!=null&&CL==QL)SN();}}return CL<QL;}AB get BI=>EN;num get currentTime=>CL;set TF(num g){if(fN==false)CL=CL+bN-g;bN=g;}void set onComplete(void g()){SN=g;}}String BH(String g){RegExp h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);Match i=h.firstMatch(g);return i.group(1);}class jC extends WB{XB.CanvasElement BN;XB.CanvasRenderingContext2D lK;IB QN;YB TN;String XN;String aN;JB dN;IB hN;List<fE> jN;Map<int,lG> nN;w oN;BC pN;SB qN;jC(String h,XB.CanvasElement g){YK=h;BN=g;BN.focus();lK=g.context2d;TN=new YB.nJ(lK);XN=fC.VD;aN=jB.YD;UD.eG.listen(eG);jN=[new fE(w.vE,w.AF,w.pE,w.UG),new fE(w.sG,w.uG,w.IF,w.IF),new fE(w.zG,w.EH,w.JF,w.JF)];hN=null;dN=new JB(0,0);oN=new w(w.pE,true);BN.onMouseDown.listen(DO);BN.onMouseUp.listen(DO);BN.onMouseMove.listen(DO);BN.onMouseOut.listen(DO);BN.onMouseWheel.listen(DO);nN=new Map<int,lG>();qN=new SB(SB.qE,true);xE.vG.listen(HO);HO(null);pN=new BC(BC.XD,true);BN.onKeyDown.listen(LO);BN.onKeyUp.listen(LO);BN.onKeyPress.listen(MO);}IB get focus=>QN;void NO(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}void set x(num g){NO();}void set y(num g){NO();}void set lB(num g){NO();}void set sB(num g){NO();}void set mB(num g){NO();}void set nB(num g){NO();}void set nC(num g){NO();}void set alpha(num g){NO();}void set width(num g){NO();}void set height(num g){NO();}void ZF(){if(XN==fC.VD||XN==fC.uE){TN.reset();QB(TN);if(XN==fC.uE)XN=fC.QG;}}void eG(String g){BN.style.cursor=UD.OF(aN);}void DO(XB.MouseEvent j){j.preventDefault();var q=BN.getBoundingClientRect();var n=new DateTime.now().millisecondsSinceEpoch;var p=j.button;IB h=null;JB i=new JB(j.clientX-q.left,j.clientY-q.top);JB m=null;if(p<0||p>2)return;if(j.type=="mousemove"&&dN.equals(i))return;fE g=jN[p];dN=i;if(j.type!="mouseout")h=NC(i.x,i.y) as IB;var l=jB.YD;if(h is eE)if(h.VE)l=jB.ZD;if(h is CG)if(h.VE)l=jB.ZD;if(aN!=l){aN=l;BN.style.cursor=UD.OF(l);}if(hN!=null&&hN!=h){hN.dispatchEvent(oN..AN(w.EF,true)..wN=(hN.LD!=null)?hN.bC(i):new JB.lJ()..zN=i..rN=g.JC);hN=null;}if(h!=null&&h!=hN){h.dispatchEvent(oN..AN(w.GF,true)..wN=h.bC(i)..zN=i..rN=g.JC);hN=h;}String k=null;bool o=false;bool t=false;if(j.type=="mousedown"){k=g.cF;if(h!=g.target||n>g.EE+500)g.kC=0;g.JC=true;g.target=h;g.EE=n;g.kC++ ;}if(j.type=="mouseup"){k=g.eF;g.JC=false;o=(g.target==h);t=o&&g.kC.isEven&&(n<g.EE+500);}if(j.type=="mousemove"){k=w.DF;}if(k!=null&&h!=null){m=h.bC(i);h.dispatchEvent(oN..AN(k,true)..wN=m..zN=i..rN=g.JC..tN=g.kC);if(o){if(t&&h.CI){h.dispatchEvent(oN..AN(g.bF,true)..wN=m..zN=i..rN=g.JC);}else{h.dispatchEvent(oN..AN(g.aF,true)..wN=m..zN=i..rN=g.JC);}}}}List<VB.StreamSubscription<SB>> SO=[] ;void HO(String h){SO.forEach((g)=>g.cancel());if(xE.RH==mE.YG){SO=[BN.onTouchStart.listen(TO),BN.onTouchEnd.listen(TO),BN.onTouchMove.listen(TO),BN.onTouchEnter.listen(TO),BN.onTouchLeave.listen(TO),BN.onTouchCancel.listen(TO)];}}void TO(XB.TouchEvent j){j.preventDefault();var n=BN.getBoundingClientRect();for(var m in j.changedTouches){var l=m.identifier;var i=new JB(m.clientX-n.left,m.clientY-n.top);var h=NC(i.x,i.y) as IB;var g=nN.containsKey(l)?nN[l]:new lG(h,nN.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(qN..AN(SB.jG,true)..wN=(g.target.LD!=null)?g.target.bC(i):new JB.lJ()..zN=i..GN=g.MD..IN=g.JD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(qN..AN(SB.iG,true)..wN=h.bC(i)..zN=i..GN=g.MD..IN=g.JD);g.target=h;}String k=null;if(j.type=="touchstart"){nN[l]=g;k=SB.qE;}if(j.type=="touchend"){nN.remove(l);k=SB.tE;}if(j.type=="touchcancel"){nN.remove(l);k=SB.wE;}if(j.type=="touchmove"){k=SB.CF;}if(k!=null&&h!=null){h.dispatchEvent(qN..AN(k,true)..wN=h.bC(i)..zN=i..GN=g.MD..IN=g.JD);}}}void LO(XB.KeyboardEvent g){g.preventDefault();String h=null;if(g.type=="keyup")h=BC.sE;if(g.type=="keydown")h=BC.XD;pN..AN(h,true)..ZM=g.altKey..cM=g.ctrlKey..eM=g.shiftKey..oM=g.charCode..qM=g.keyCode..sM=XC.HG;if(g.keyLocation==XB.KeyLocation.LEFT)pN.sM=XC.MG;if(g.keyLocation==XB.KeyLocation.RIGHT)pN.sM=XC.BF;if(g.keyLocation==XB.KeyLocation.NUMPAD)pN.sM=XC.ZG;if(g.keyLocation==XB.KeyLocation.JOYSTICK)pN.sM=XC.yE;if(g.keyLocation==XB.KeyLocation.MOBILE)pN.sM=XC.yE;if(QN!=null)QN.dispatchEvent(pN);}void MO(XB.KeyboardEvent g){int i=(g.charCode!=0)?g.charCode:g.keyCode;dE h=new dE(dE.SG,true);h.pK=new String.fromCharCodes([i]);if(QN!=null)QN.dispatchEvent(h);}}String NF(String j,String g){RegExp i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);Match k=i.firstMatch(j);String h=k.group(1);return (h==null)?g:"${h}${g}";}bool LH(){var g=new XB.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;}void PH(List<int> h){if(RC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];h[g+0]=(h[g+0]*i)~/255;h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;h[g+3]=(h[g+3]*i)~/255;}}}void WH(List<int> h){if(RC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];if(i>0){h[g+0]=(h[g+0]*255)~/i;h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;}}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];if(i>0){h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;h[g+3]=(h[g+3]*255)~/i;}}}}class QJ extends AB implements hB{final DC EO;final zD FO;final List<eH> GO=new List<eH>();num IO=0.0;num JO=0.0;int KO=0;int YL=0;QJ(DC g,String j):EO=g,FO=g.yN(j){for(var h in FO.IE){var i=new eH(EO,h);GO.add(i);}YL=FO.JE;JO=YL/EO.SL;}bool qB(num h){IO+= h;var i=IO%JO;KO=gB.min((YL*i/JO).toInt(),YL-1);for(var g in GO){g.qB(h);g.lF(KO);}return true;}void QB(YB h){for(var g in GO){if(g.visible){h.kF(g);}}}}DB pD(PB g,num m,num q,DB j){num FB=0.0;num CB=0.0;num p=m*g.a;num v=m*g.b;num t=m*g.a+q*g.c;num o=m*g.b+q*g.d;num u=q*g.c;num n=q*g.d;num h=FB;if(h>p)h=p;if(h>t)h=t;if(h>u)h=u;num i=CB;if(i>v)i=v;if(i>o)i=o;if(i>n)i=n;num l=FB;if(l<p)l=p;if(l<t)l=t;if(l<u)l=u;num k=CB;if(k<v)k=v;if(k<o)k=o;if(k<n)k=n;if(j==null)j=new DB.lJ();j.x=g.eB+h;j.y=g.fB+i;j.width=l-h;j.height=k-i;return j;}bool RC=LH();class eH extends AB implements hB{final DC aC;final AE HE;final Map<String,VC> TE=new Map<String,VC>();VC oC;eH(DC i,AE h):this.aC=i,this.HE=h{for(var g in h.EC){if(g.UC!=null&&TE.containsKey(g.UC)==false){TE[g.UC]=i.BO(g.UC);}}lF(0);}bool qB(num g){if(oC is hB){var h=oC as hB;h.qB(g);}}void lF(int t){var g=HE.OI(t);num o=g.x,p=g.y;num n=g.mB,k=g.nB;num m=g.skewX,l=g.skewY;num v=g.lB,UB=g.sB;num q=g.alpha;if(g.index!=t&&g.pF){var i=HE.NI(g);if(i!=null){var h=(t-g.index)/g.duration;var j=g.VF;if(j!=0){var u=0.0;if(j<0){var FB=1-h;u=1-FB*FB;j=0-j;}else{u=h*h;}h=j*u+(1-j)*h;}o=o+(i.x-o)*h;p=p+(i.y-p)*h;n=n+(i.mB-n)*h;k=k+(i.nB-k)*h;m=m+(i.skewX-m)*h;l=l+(i.skewY-l)*h;q=q+(i.alpha-q)*h;}}num CB=n*gB.cos(l);num TB=n*gB.sin(l);num MB=-k*gB.sin(m);num NB=k*gB.cos(m);num ZB=o-(v*CB+UB*MB);num aB=p-(v*TB+UB*NB);xM=false;rM.QE(CB,TB,MB,NB,ZB,aB);QM=q;SM=g.visible;oC=(g.UC!=null)?TE[g.UC]:null;}void QB(YB g){if(oC!=null){oC.QB(g);}}}class zD{final String id;final DC aC;final List<AE> IE=new List<AE>();zD(Map g,DC j):aC=j,id=g["id"]{for(var h in g["layers"]){var i=new AE(h);this.IE.add(i);}}int get JE{var g=0;for(var h in IE)g=gB.max(g,h.JE);return g;}}class AE{final String name;final bool FI;final List<DD> EC=new List<DD>();AE(Map g):this.name=g["name"],this.FI=g.containsKey("flipbook")?g["flipbook"]:false{for(var i in g["keyframes"]){var h=new DD(i);this.EC.add(h);}}int get JE{var g=EC[EC.length-1];return g.index+g.duration;}DD OI(int h){var g=1;while (g<EC.length&&EC[g].index<=h)g++ ;return EC[g-1];}DD NI(DD h){for(int g=0;g<EC.length-1;g++ )if(identical(EC[g],h))return EC[g+1];return null;}}class DD{int index;int duration;String UC;String label;num x,y;num mB,nB;num skewX,skewY;num lB,sB;bool visible;num alpha;bool pF;num VF;DD(Map g){this.index=g["index"];this.duration=g["duration"];this.UC=g.containsKey("ref")?g["ref"]:null;this.label=g.containsKey("label")?g["label"]:null;this.x=g.containsKey("loc")?g["loc"][0]:0.0;this.y=g.containsKey("loc")?g["loc"][1]:0.0;this.mB=g.containsKey("scale")?g["scale"][0]:1.0;this.nB=g.containsKey("scale")?g["scale"][1]:1.0;this.skewX=g.containsKey("skew")?g["skew"][0]:0.0;this.skewY=g.containsKey("skew")?g["skew"][1]:0.0;this.lB=g.containsKey("pivot")?g["pivot"][0]:0.0;this.sB=g.containsKey("pivot")?g["pivot"][1]:0.0;this.visible=g.containsKey("visible")?g["visible"]:true;this.alpha=g.containsKey("alpha")?g["alpha"]:1.0;this.pF=g.containsKey("tweened")?g["tweened"]:true;this.VF=g.containsKey("ease")?g["ease"]:0.0;}}class rH{DC aC;Map<String,sH> GD;VB.Completer FD;rH(Map p,this.aC){this.GD=new Map<String,sH>();this.FD=new VB.Completer();var k=0;for(var j in p["atlases"] as List){var n=j["file"] as String;var q=NF(aC.zK,n);k++ ;var g=new XB.ImageElement();g.onLoad.listen((o){if( --k==0)this.FD.complete(this);});g.onError.listen((o){this.FD.completeError(new StateError("Failed to load image."));});g.src=q;for(var i in j["textures"] as List){var m=i["symbol"] as String;var h=i["rect"] as List;var l=i["origin"] as List;var t=new sH(h[0],h[1],h[2],h[3],l[0],l[1],g);this.GD[m]=t;}}}}class sH implements VC{num x,y,width,height;num ZI,aI;XB.ImageElement HD;sH(this.x,this.y,this.width,this.height,this.ZI,this.aI,this.HD);void QB(YB g){g.context.drawImage(HD,x,y,width,height,0,0,width,height);}}//@ sourceMappingURL=dartflash_web.dart.map
