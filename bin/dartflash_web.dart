import "dart:json" as sF;import "dart:math" as gB;import "dart:html" as XB;import "dart:web_audio" as tF;import "dart:async" as VB;class rI{static const  sI="Chrome";static const  tI="Firefox";static const  uI="Internet Explorer";static const  vI="Safari";final  xH;final  XI;const rI(this.xH,[this.XI]);}class wI{final  name;const wI(this.name);}class FJ extends WB{final  xJ=[{'name':'DropShadowFilter (black)','filter':new KJ(10,gB.PI/4,BC.BD,0.8,8,8)},{'name':'GlowFilter (red)','filter':new JJ(BC.TF,1.0,20,20)},{'name':'ColorMatrixFilter (grayscale)','filter':new MJ.rJ()},{'name':'ColorMatrixFilter (invert)','filter':new MJ.sJ()},{'name':'BlurFilter (radius 1)','filter':new PJ(1,1)},{'name':'BlurFilter (radius 5)','filter':new PJ(5,5)},{'name':'BlurFilter (radius 10)','filter':new PJ(10,10)},{'name':'BlurFilter (radius 20)','filter':new PJ(20,20)}];FJ(){var m=new GB(940,500,true,0x000000);var k=RB.NC('king');var o=new GB(230,245,true,0xFFF0F0F0);var p=new wC(m);BB(p);for(int h=0;h<xJ.length;h++ ){var i=235*(h%4);var j=250*(h~/4);var q=xJ[h]['filter'] as XC;var t=xJ[h]['name'] as String;var u=new EB(0,0,k.width,k.height);var n=new JB(i+40,j+45);m.vH(k,u,n,q);var l=new wC(o);l.x=i;l.y=j;DE(l,0);var g=new LJ();g.TC=new gE('Helvetica Neue, Helvetica, Arial',14,BC.BD);g.x=i+5;g.y=j+5;g.width=200;g.text=t;BB(g);}}}class yI extends WB{final  wJ=new gB.Random();yI(){var g=new iE();g.lB=470;g.sB=250;g.x=470;g.y=250;BB(g);for(int h=0;h<150;h++ ){var v=1+wJ.nextInt(3);var p=RB.NC('flower${v}');var i=new wC(p);i.lB=64;i.sB=64;i.x=64+wJ.nextInt(940-128);i.y=64+wJ.nextInt(500-128);g.BB(i);var o=new AH(i,600,s.ZC);o.kB('rotation',gB.PI*60.0);OB.add(o);}var k=new List<JB>();for(int h=0;h<6;h++ ){var n=(h*60)*gB.PI/180;var m=(h*60+30)*gB.PI/180;k.add(new JB(470+200*gB.cos(n),250+200*gB.sin(n)));k.add(new JB(470+100*gB.cos(m),250+100*gB.sin(m)));}var t=new VD.mJ(100,100,740,300);var u=new VD.pJ(470,250,200);var q=new VD.qJ(k);XB.query('#mask-none').onClick.listen((j)=>g.mask=null);XB.query('#mask-rectangle').onClick.listen((j)=>g.mask=t);XB.query('#mask-circle').onClick.listen((j)=>g.mask=u);XB.query('#mask-custom').onClick.listen((j)=>g.mask=q);XB.query('#mask-spin').onClick.listen((j){var l=new AH(g,2.0,s.UF);l.kB('rotation',gB.PI*4.0);l.onComplete=()=>g.pC=0.0;OB.add(l);});}}class xI extends WB{var wJ=new gB.Random();var zJ;var AK;xI(){zJ=RB.ME('walkTextureAtlas');AK=zJ.KI('walk');DK();}DK(){var h=wJ.nextDouble();var g=new DG(AK,30);g.x=-128;g.y=20.0+180.0*h;g.mB=g.nB=0.5+0.5*h;g.play();BB(g);mI((k,j)=>(k.y-j.y).toInt());var i=new AH(g,5.0+(1.0-h)*5.0,s.ZC);i.kB('x',940.0);i.onComplete=(){OB.remove(g);kF(g);};OB.add(g);OB.add(i);OB.XF(DK,0.2);}}class zI extends wC implements jB{var PD,QD;zI( g,this.PD,this.QD):super(g){this.lB=g.width/2;this.sB=g.height/2;} qB( i){var g=x+PD*i;var h=y+QD*i;if(g>910||g<30)PD=-PD;else x=g;if(h>470||h<30)QD=-QD;else y=h;return true;}}class AJ extends WB{final  yJ=['C4','A3','A3','C4','D4','G3','G3','A3','A3#','F4','F4','E4','C4','D4','C4','A3#','A3','C4','D4','D4','D4','G4','F4','E4','F4','D4','C4','F3','G3','A3','D4','C4','C4','A3#','A3','E3','F3'];final  CK=['Hey ','Jude, ',"don't ",'make ','it ','bad.<br>','Take ','a ','sad ','song ','and ','make ','it ','better.<br>','','','','Remember ','','','to ','let ','her ','into ','','your ','heart.<br>','Than ','you ','can ','start ','','to ','make ','things ','better.','',' '];AJ(){var h=new wC(RB.NC('Background'));BB(h);var g=new uF(yJ,CK);g.x=120;g.y=30;BB(g);XB.query('#startOver').onClick.listen((i)=>g.iI());}}class DJ extends WB{final  lI='''
Filet mignon leberkas pig pork chop biltong, short loin strip steak turkey brisket 
venison. Pastrami venison pancetta, leberkas pork chop chicken prosciutto beef ribs 
bresaola kielbasa swine biltong capicola. Hamburger beef ribs ball tip drumstick salami 
pig. Capicola pork loin shank, salami chicken hamburger tail. Sirloin spare ribs
ground round cow strip steak prosciutto swine bacon corned beef.''';DJ(){var k=lI.replaceAll('\r','').replaceAll('\n','');var j=new LJ();j.TC=new gE('Helvetica,Arial',14,BC.TH,GD:true,OE:true);j.text=k;j.x=10;j.y=10;j.width=920;j.height=20;BB(j);var h=new LJ();h.TC=new gE('Helvetica,Arial',16,BC.TF);h.text=k;h.x=10;h.y=50;h.width=200;h.height=300;h.wordWrap=true;BB(h);var g=new LJ();g.TC=new gE('Helvetica,Arial',16,BC.qG,align:PC.EF);g.text=k;g.x=300;g.y=50;g.width=200;g.height=300;g.wordWrap=true;BB(g);var i=new LJ();i.TC=new gE('Caesar Dressing',30,BC.BD,align:PC.YD);i.text=k;i.x=590;i.y=50;i.width=340;i.height=300;i.wordWrap=true;BB(i);}}class BJ extends WB{BJ(){var g=new LJ();g.TC=new gE('Helvetica,Arial',14,BC.IH,GD:true);g.text='ToDo: show a cool demo ...';g.x=10;g.y=10;g.width=920;g.height=20;BB(g);}}class CJ extends WB{CJ(){var k=RB.MI('flump');var i=new QJ(k,'idle');i.x=500;i.y=200;BB(i);var j=new QJ(k,'walk');j.x=150;j.y=460;BB(j);var g=new QJ(k,'attack');g.x=450;g.y=460;BB(g);var h=new QJ(k,'defeat');h.x=720;h.y=460;BB(h);OB.add(i);OB.add(j);OB.add(g);OB.add(h);GB.nD('images/flumpLibraryAtlas0.png').then((m){var l=new wC(m);l.x=40;l.y=40;BB(l);});}}class EJ extends WB{var zJ;EJ(){zJ=RB.ME('levelUp');BK();GB.nD('images/LevelupTextureAtlas.png').then((h){var g=new wC(h);g.x=70;g.y=40;BB(g);});}BK(){var l=330;for(int j=0;j<7;j++ ){var h=zJ.NC('LevelUp${j}');var g=new wC(h);g.lB=h.width/2;g.sB=h.height/2;g.x=l+h.width/2;g.y=150;g.mB=0.0;g.nB=0.0;BB(g);var k=new AH(g,2.0,s.DD);k.kB('scaleX',1.0);k.kB('scaleY',1.0);k.WF=j*0.05;var i=new AH(g,0.4,s.ZC);i.kB('scaleX',0.0);i.kB('scaleY',0.0);i.WF=2.0;i.onComplete=()=>g.SE();OB.add(k);OB.add(i);l=l+5+h.width;}OB.XF(()=>BK(),3.0);}}class GJ{final  vJ=[{"name":"linear","transition":s.ZC},{"name":"sine","transition":s.NF},{"name":"cosine","transition":s.DH},{"name":"random","transition":s.GH},{"name":"easeInQuadratic","transition":s.hD},{"name":"easeOutQuadratic","transition":s.iD},{"name":"easeInOutQuadratic","transition":s.JH},{"name":"easeOutInQuadratic","transition":s.KH},{"name":"easeInCubic","transition":s.jD},{"name":"easeOutCubic","transition":s.kD},{"name":"easeInOutCubic","transition":s.SF},{"name":"easeOutInCubic","transition":s.QH},{"name":"easeInQuartic","transition":s.lD},{"name":"easeOutQuartic","transition":s.mD},{"name":"easeInOutQuartic","transition":s.UH},{"name":"easeOutInQuartic","transition":s.VH},{"name":"easeInQuintic","transition":s.oD},{"name":"easeOutQuintic","transition":s.pD},{"name":"easeInOutQuintic","transition":s.XH},{"name":"easeOutInQuintic","transition":s.YH},{"name":"easeInCircular","transition":s.qD},{"name":"easeOutCircular","transition":s.sD},{"name":"easeInOutCircular","transition":s.ZH},{"name":"easeOutInCircular","transition":s.aH},{"name":"easeInSine","transition":s.tD},{"name":"easeOutSine","transition":s.uD},{"name":"easeInOutSine","transition":s.cH},{"name":"easeOutInSine","transition":s.gH},{"name":"easeInExponential","transition":s.vD},{"name":"easeOutExponential","transition":s.wD},{"name":"easeInOutExponential","transition":s.hH},{"name":"easeOutInExponential","transition":s.iH},{"name":"easeInBack","transition":s.xD},{"name":"easeOutBack","transition":s.yD},{"name":"easeInOutBack","transition":s.UF},{"name":"easeOutInBack","transition":s.lH},{"name":"easeInElastic","transition":s.zD},{"name":"easeOutElastic","transition":s.DD},{"name":"easeInOutElastic","transition":s.mH},{"name":"easeOutInElastic","transition":s.oH},{"name":"easeInBounce","transition":s.AE},{"name":"easeOutBounce","transition":s.ED},{"name":"easeInOutBounce","transition":s.pH},{"name":"easeOutInBounce","transition":s.qH}]; QI(){var j=new XB.DivElement();for(int h=0;h<vJ.length/4;h++ ){var i=new XB.DivElement();i.classes.add("row");j.children.add(i);for(int g=0;g<4;g++ ){var m=vJ[h*4+g]["name"];var l=vJ[h*4+g]["transition"];var k=OK(m,l);k.id="cell";i.children.add(k);}}return j;} OK( o, q( ratio)){var h=new XB.DivElement();h.classes.add("span3");h.style.height="130px";var j=new XB.CanvasElement(width:200,height:140);j.style.position="absolute";j.style.zIndex="1";h.children.add(j);var i=new XB.DivElement();i.text=o;i.style.position="relative";i.style.zIndex="2";i.style.top="6px";h.children.add(i);var l=new lC("stage",j);var n=new OJ();var g=n.RI;g.beginPath();g.moveTo(0.5,30.5);g.lineTo(199.5,30.5);g.lineTo(199.5,109.5);g.lineTo(0.5,109.5);g.closePath();g.pF(0xFF000000);g.DI(0xFFDFDFDF);g.beginPath();g.moveTo(0.5,109.5);for(int k=0;k<=199;k++ ){var m=k/199.0;var p=0.5+m*199.0;var t=109.5-79.0*q(m);g.lineTo(p,t);}g.pF(0xFF0000FF,2);l.BB(n);l.bF();return h;}}var oB;var RD;var OB;var RB;class HJ extends WB{HJ(){EK(250);XB.query('#minus10').onClick.listen((g)=>FK(10));XB.query('#minus50').onClick.listen((g)=>FK(50));XB.query('#plus50').onClick.listen((g)=>EK(50));XB.query('#plus10').onClick.listen((g)=>EK(10));this.YI.listen(GK);}var HK=null;GK( g){if(HK==null){HK=1.00/g.hF;}else{HK=0.05/g.hF+0.95*HK;}XB.query('#fpsMeter').innerHtml='fps: ${HK.round()}';}EK( l){var g=new gB.Random();var i=RB.ME('flags');var j=i.GI;while ( --l>=0){var k=j[g.nextInt(j.length)];var m=i.NC(k);var h=new zI(m,g.nextInt(200)-100,g.nextInt(200)-100);h.x=30+g.nextInt(940-60);h.y=30+g.nextInt(500-60);BB(h);OB.add(h);}XB.query('#flagCounter').innerHtml='Flags: ${RE}';}FK( h){while ( --h>=0&&RE>0){var g=LI(0);g.SE();OB.remove(g);}XB.query('#flagCounter').innerHtml='Flags: ${RE}';}} main(){var l=XB.window.location.pathname;var m=new RegExp(r"([A-Za-z0-9-]+)\.html",multiLine:false,caseSensitive:false);var g=m.firstMatch(l);if(g!=null&&g.groupCount==1){var h=g.group(1);print("current page: ${h}");var i=XB.query("#stage");if(i!=null){oB=new lC('stage',i);RD=new yF();RD.uH(oB);OB=RD.VI;RB=new tE();}switch (h){case "filter":RB..pB('king','images/king.png')..load().then((JK)=>oB.BB(new FJ()));break;case "masking":RB..pB('flower1','images/Flower1.png')..pB('flower2','images/Flower2.png')..pB('flower3','images/Flower3.png')..load().then((JK)=>oB.BB(new yI()));break;case "movieclip":RB..EE('walkTextureAtlas','images/walk.json',iC.AD)..load().then((JK)=>oB.BB(new xI()));break;case "performance":RB..EE('flags','images/flags.json',iC.AD)..load().then((JK)=>oB.BB(new HJ()));break;case "sound":RB..pB('KeyBlack','images/piano/KeyBlack.png')..pB('KeyWhite0','images/piano/KeyWhite0.png')..pB('KeyWhite1','images/piano/KeyWhite1.png')..pB('KeyWhite2','images/piano/KeyWhite2.png')..pB('KeyWhite3','images/piano/KeyWhite3.png')..pB('Finger','images/piano/Finger.png')..pB('Background','images/piano/Background.jpg')..HB('Cheer','sounds/Cheer.mp3')..HB('Note1','sounds/piano/Note1.mp3')..HB('Note2','sounds/piano/Note2.mp3')..HB('Note3','sounds/piano/Note3.mp3')..HB('Note4','sounds/piano/Note4.mp3')..HB('Note5','sounds/piano/Note5.mp3')..HB('Note6','sounds/piano/Note6.mp3')..HB('Note7','sounds/piano/Note7.mp3')..HB('Note8','sounds/piano/Note8.mp3')..HB('Note9','sounds/piano/Note9.mp3')..HB('Note10','sounds/piano/Note10.mp3')..HB('Note11','sounds/piano/Note11.mp3')..HB('Note12','sounds/piano/Note12.mp3')..HB('Note13','sounds/piano/Note13.mp3')..HB('Note14','sounds/piano/Note14.mp3')..HB('Note15','sounds/piano/Note15.mp3')..HB('Note16','sounds/piano/Note16.mp3')..HB('Note17','sounds/piano/Note17.mp3')..HB('Note18','sounds/piano/Note18.mp3')..HB('Note19','sounds/piano/Note19.mp3')..HB('Note20','sounds/piano/Note20.mp3')..HB('Note21','sounds/piano/Note21.mp3')..HB('Note22','sounds/piano/Note22.mp3')..HB('Note23','sounds/piano/Note23.mp3')..HB('Note24','sounds/piano/Note24.mp3')..HB('Note25','sounds/piano/Note25.mp3')..load().then((JK)=>oB.BB(new AJ()));break;case "text":oB.BB(new DJ());break;case "tweener":oB.BB(new BJ());break;case "flump":RB..tH('flump','images/flumpLibrary.json')..load().then((JK)=>oB.BB(new CJ()));break;case "texturepacker":RB..EE('levelUp','images/LevelupTextureAtlas.json',iC.AD)..load().then((JK)=>oB.BB(new EJ()));break;case "transitions":var k=new GJ();var j=k.QI();XB.query("#transitions").children.add(j);break;}}}class uF extends WB{final  dC;final  cC;final  IK=['C3','C3#','D3','D3#','E3','F3','F3#','G3','G3#','A3','A3#','B3','C4','C4#','D4','D4#','E4','F4','F4#','G4','G4#','A4','A4#','B4','C5'];var KK=new Map<String,vF>();var LK;var MK=0;uF(this.dC,this.cC){for(int h=0,i=0;h<IK.length;h++ ){var k=RB.ZF('Note${h+1}');var j=IK[h];var g=KK[j]=new vF(this,j,k);if(j.endsWith('#')){g.x=i-16;g.y=35;BB(g);}else{g.x=i;g.y=35;DE(g,0);i=i+47;}}LK=new wC(RB.NC('Finger'));LK.lB=20;BB(LK);NK();}yH( g){if(MK<dC.length&&dC[MK]==g){if(MK==dC.length-1)RB.ZF('Cheer').play();MK++ ;NK();}}iI(){MK=0;LK.alpha=1;NK();}NK(){var h=XB.query('#lyrics');var m=-1;h.innerHtml='';for(int g=0,j=0;g<cC.length;g++ ){if(cC[g]!='')j=g;if(g==this.MK)m=j;}for(int g=0;g<cC.length;g++ ){if(g==m){h.appendHtml('<span id="word">${cC[g]}</span>');}else{h.appendHtml(cC[g]);}}if(MK<dC.length){var k=dC[MK];if(KK.containsKey(k)){var i=KK[k];OB.hI(LK);LK.y=0;var n=new AH(this.LK,0.4,s.SF);var l=new AH(this.LK,0.4,s.NF);n.kB('x',i.x+i.width/2);l.kB('y',-10);OB.add(n);OB.add(l);}}else{var o=new AH(LK,0.4,s.ZC);o.kB('alpha',0);OB.add(o);}}}class vF extends iE{final  iF;final  dB;final  oF;vF(this.iF,this.dB,this.oF){var h;if(dB.endsWith('#')){h='KeyBlack';}else if(dB.startsWith('C5')){h='KeyWhite0';}else if(dB.startsWith('C')||dB.startsWith('F')){h='KeyWhite1';}else if(dB.startsWith('D')||dB.startsWith('G')||dB.startsWith('A')){h='KeyWhite2';}else if(dB.startsWith('E')||dB.startsWith('B')){h='KeyWhite3';}var i=RB.NC(h);var l=new wC(i);this.BB(l);var j=dB.endsWith('#')?BC.nH:BC.BD;var k=new gE('Helvetica,Arial',10,j,align:PC.YD);var g=new LJ();g.TC=k;g.text=dB;g.width=i.width;g.height=20;g.fF=false;g.y=i.height-20;BB(g);this.XE=true;this.onMouseDown.listen(PK);this.onMouseOver.listen(PK);this.onMouseUp.listen(QK);this.onMouseOut.listen(QK);}PK( g){if(g.JC){this.oF.play();this.alpha=0.7;this.iF.yH(this.dB);}}QK( g){this.alpha=1.0;}}abstract class jB{ qB( g);}class CG{static const  JG="dynamic";}class gE{var font;var size;var color;var GD;var OE;var pI;var align;var WI;var jI;var UI;var QE;var letterSpacing=0;var SJ=0;var TJ=false;var eJ=false;gE(this.font,this.size,this.color,{this.GD: false,this.OE: false,this.pI: false,this.align: "left",this.WI: 0,this.jI: 0,this.UI: 0,this.QE: 0});}class PC{static const  YD="center";static const  SG="end";static const  YG="justify";static const  EF="right";}class kE{var wH;var zH;var height;var QE;var width;var x;kE(this.x,this.width,this.height,this.wH,this.zH,this.QE);}class YC{static const  IG=0;static const  NG=1;static const  EF=2;static const  aG=3;static const  AF=4;}class AG{static const  OG="round";}class BG{static const  OG="round";}class BC{static const  BD=0xFF000000;static const  qG=0xFF0000FF;static const  IH=0xFFA9A9A9;static const  TH=0xFF008000;static const  TF=0xFFFF0000;static const  nH=0xFFFFFFFF;}class fE{static const  UG="none";static const  ZG="touchPoint";}class xF extends IB{xF();}class NJ extends OC{var lK;var CL;NJ( i, h, g){lK=h;CL=g;}set LD( g){CL=g;} stop(){}}class lE extends hB{lE(){}static  nD( g){return new VB.Future<hB>.of(()=>new lE());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new bB();}return new NJ(this,loop,soundTransform);}}class yC{var aK;var XK;var yK;var KL;var UL;var eL;yC( g, h, i){aK=g;XK=h;yK=i;UL=null;eL=null;} get kind=>aK; get name=>XK; get oC=>eL; get error=>UL;BN( i){KL=i.then((g){eL=g;UL=null;},onError:( h){eL=null;UL=h.error;});}}class IJ extends OC{var xK;var CL;var lK;var pL;var BM;IJ( j, h, i){xK=j;lK=h;CL=i;var g=fC.CD;pL=g.createGain();pL.connect(g.destination,0,0);pL.gain.value=(CL!=null)?gB.pow(CL.volume,2):1;BM=g.createBufferSource();BM.buffer=xK.hK;BM.loop=h;BM.connect(pL,0,0);BM.start(0);} set LD( g){CL=g;pL.gain.value=(CL!=null)?gB.pow(CL.volume,2):1;} stop(){BM.stop(0);}}class UD extends hB{var hK;UD(){if(fC.CD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  nD( n){var h=new UD();var k=hB.PF(n);var g=new VB.Completer<hB>();XB.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var m=fC.CD;m.decodeAudioData(j,( l){h.hK=l;g.complete(h);},(o){g.completeError(new StateError("Failed to decode audio."));});}).catchError((o){g.completeError(new StateError("Failed to load audio."));});return g.future;} get length{return hK.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new bB();return new IJ(this,loop,soundTransform);}}class nE implements jB{final  qK;var BL=0.0;var OL=0.0;var cL=1;nE( g, h):qK=g{OL=gB.max(h,0.0001);} qB( h){var g=BL+h;while (g>=OL&&cL>0){BL=OL;cL-- ;qK();g-= OL;}BL=g;return (cL>0);} get currentTime=>BL;}class FG{static const  UG="none";}class TD implements jB{final  uK=new List<jB>();var VL=0;var jL=0.0; add( g){if(g==null)return;if(VL==uK.length){uK.add(g);}else{uK[VL]=g;}VL++ ;} remove( h){if(h==null)return;for(int g=0;g<VL;g++ ){if(uK[g]==h){uK[g]=null;break;}}} hI( i){if(i==null)return;for(int g=0;g<VL;g++ ){var h=uK[g];if(h!=null&&h is AH){if(h.AI==i){uK[g]=null;}}}} XF( h, i){var g=new nE(h,i);add(g);return g;} qB( k){jL+= k;var j=VL;var h=0;for(int g=0;g<j;g++ ){var i=uK[g];if(i==null)continue;if(i.qB(k)==false){uK[g]=null;continue;}if(h!=g){uK[h]=i;uK[g]=null;}h++ ;}if(h!=j){for(int g=j;g<VL;g++ ){uK[h++ ]=uK[g];uK[g]=null;}VL=h;}return true;}}class zC extends OC{var AL;var nK;var lK;var CL;zC( g, i, h){AL=g;lK=i;CL=h;nK=g.jM(this);nK.loop=lK;this.LD=h;nK.play();} set LD( g){CL=g;if(nK!=null)nK.volume=(CL!=null)?CL.volume:1;} stop(){if(nK!=null){if(nK.ended==false)nK.pause();AL.rN(this);nK=null;}}}class GG{var name;var tB;var qF;GG(this.name,this.tB,this.qF);}class SD extends hB{var nK;var HL;var fL;SD(){fL=new List<zC>();nK=new XB.AudioElement();nK.onEnded.listen(UM);HL=new List<XB.AudioElement>();HL.add(nK);XB.document.body.children.add(nK);}static  nD( o){var k=new SD();var g=k.nK;var i=new VB.Completer<hB>();var h;var j;n(m){h.cancel();j.cancel();i.complete(k);}l(m){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(n);j=g.onError.listen(l);g.src=hB.PF(o);g.load();return i.future;} get length{return nK.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new bB();return new zC(this,loop,soundTransform);} jM( h){var g;if(HL.length==0){g=nK.clone(true);g.onEnded.listen(UM);}else{g=HL.removeAt(0);}fL.add(h);return g;} rN( g){var h=g.nK;var i=fL.indexOf(g);fL.removeAt(i);HL.add(h);if(nK.currentTime>0&&nK.ended==false)nK.currentTime=0;} UM(j){var i=j.target;var g=null;for(int h=0;h<fL.length&&g==null;h++ )if(fL[h].nK==i)g=fL[h];if(g!=null)g.stop();}}class JB{var x;var y;JB(this.x,this.y);JB.lJ():this(0,0); get length=>gB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new JB(this.x+g.x,this.y+g.y); HE( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class EB{var x;var y;var width;var height;EB(this.x,this.y,this.width,this.height);EB.lJ():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new JB(this.width,this.height); set top( g){this.y=g;} contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); HE( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;} union( g){var i=gB.min(this.left,g.left);var j=gB.min(this.top,g.top);var h=gB.max(this.right,g.right);var k=gB.max(this.bottom,g.bottom);return new EB(i,h,h-i,k-j);}}class wF{var x;var y;var jF;wF(this.x,this.y,this.jF);}class PB{var SK,TK,UK,WK,YK,bK;var kK;PB.oJ():SK=1.0,TK=0.0,UK=0.0,WK=1.0,YK=0.0,bK=0.0,kK=1.0; get a=>SK; get b=>TK; get c=>UK; get d=>WK; get eB=>YK; get fB=>bK; get aC=>kK; oI( g){return new JB(g.x*SK+g.y*UK+YK,g.x*TK+g.y*WK+bK);} concat( g){var m=SK;var p=TK;var q=UK;var o=WK;var l=YK;var n=bK;var u=kK;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var v=g.eB;var t=g.fB;var CB=g.aC;SK=(m*j+p*i);TK=(m*k+p*h);UK=(q*j+o*i);WK=(q*k+o*h);YK=(l*j+n*i+v);bK=(l*k+n*h+t);kK=(u*CB);} TI(){SK=1.0;TK=0.0;UK=0.0;WK=1.0;YK=0.0;bK=0.0;kK=1.0;} aF(){var j=SK;var m=TK;var l=UK;var k=WK;var h=YK;var i=bK;var g=kK;SK=(k/g);TK=-(m/g);UK=-(l/g);WK=(j/g);YK=-(SK*h+UK*i);bK=-(TK*h+WK*i);kK=(1.0/g);} TE( h, i, g, j, k, l){SK=h;TK=i;UK=g;WK=j;YK=k;bK=l;kK=(h*j-i*g);} HE( g){SK=g.a;TK=g.b;UK=g.c;WK=g.d;YK=g.eB;bK=g.fB;kK=g.aC;} VF( h, g){var n=h.a;var q=h.b;var t=h.c;var p=h.d;var m=h.eB;var o=h.fB;var v=h.aC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var CB=g.eB;var u=g.fB;var FB=g.aC;SK=(n*k+q*j);TK=(n*l+q*i);UK=(t*k+p*j);WK=(t*l+p*i);YK=(m*k+o*j+CB);bK=(m*l+o*i+u);kK=(v*FB);}}class yF{var VK;var iK;var vK;var PL;var hL;yF(){VK=new TD();iK=new List<lC>();vK=double.NAN;PL=xC.BF;hL=new hC(0);XB.window.requestAnimationFrame(iM);} get VI=>VK; iM( g){XB.window.requestAnimationFrame(iM);if(vK.isNaN)vK=g;if(vK>g)vK=g;var j=g-vK;var i=j/1000.0;if(j>=1){vK=g;hL.cK=i;PL.LN(hL);VK.qB(i);for(int h=0;h<iK.length;h++ ){var k=iK[h];k.bF();}}} uH( g){iK.add(g);}}class YB{final  jK;final  GL=new List<PB>(100);final  iL=new List<double>(100);var xL=0;YB.nJ( j,[ matrix]):jK=j{for(int h=0;h<100;h++ ){GL[h]=new PB.oJ();iL[h]=1.0;}if(matrix!=null)GL[0].HE(matrix);var g=GL[0];var i=iL[0];jK.setTransform(g.a,g.b,g.c,g.d,g.eB,g.fB);jK.globalAlpha=i;} get context=>jK; reset(){xL=0;var g=GL[0];var h=iL[0];jK.setTransform(g.a,g.b,g.c,g.d,g.eB,g.fB);jK.globalAlpha=h;jK.clearRect(0,0,jK.canvas.width,jK.canvas.height);} mF( h){var i=xL;var j=xL+1;var l=GL[i];var g=GL[j];var m=iL[i];var k=iL[j]=h.PM*m;g.VF(h.wN,l);jK.setTransform(g.a,g.b,g.c,g.d,g.eB,g.fB);jK.globalAlpha=k;xL=j;if(h.mask==null){h.QB(this);}else{jK.save();h.mask.QB(this);h.QB(this);jK.restore();}xL=i;}}class gC{static const  XD="auto";static const  RG="stop";static const  wE="once";}class DB{static const  MG="added";static const  WG="addedToStage";static const  cD="enterFrame";static const  eG="removed";static const  iG="removedFromStage";static const  yG="complete";static const  OF="progress";var RK;var ZN;var ON;var EL;var hN;var RN;var XN;DB( g,[ bubbles=false]){zM(g,bubbles);} zM( g,[ bubbles=false]){RK=g;ZN=bubbles;ON=AC.QC;EL=null;hN=null;RN=false;XN=false;} get ND=>RN; get type=>RK; get bubbles=>ZN; get FE=>true; get target=>EL;}class AC{static const  qE=1;static const  QC=2;static const  XG=3;}class IC{var gK; SI( g){if(gK!=null)return gK.containsKey(g)||gK.containsKey("${g}_CAPTURE");else return false;} dispatchEvent( g){lN(g,this,this,AC.QC);} lN( g, k, l, i){if(gK!=null){var j=(i==AC.qE)?"${g.type}_CAPTURE":g.type;var h=gK[j];if(h!=null){g.EL=k;g.hN=l;g.ON=i;g.RN=false;g.XN=false;h.LN(g);}}} JM( g, j){if(gK==null)gK=new Map<String,eC>();var i=j?"${g}_CAPTURE":g;var h=gK[i];if(h==null)h=gK[i]=new eC(this,g,j);return h;}}class xC<jC extends DB>{final  gK=new List<eC>();var YL=0;static var BF=new xC<hC>(); cM( g){for(int h=0;h<YL;h++ )if(gK[h]==g)return;if(YL==gK.length)gK.add(g);else gK[YL]=g;YL++ ;} LN( j){j.ON=AC.QC;j.RN=false;j.XN=false;var k=YL;var i=0;for(int g=0;g<k;g++ ){var h=gK[g];if(h==null)continue;if(h.QM==0){gK[g]=null;continue;}j.EL=h.EL;j.hN=h.EL;h.LN(j);if(i!=g){gK[i]=h;gK[g]=null;}i++ ;}if(i!=k){for(int g=k;g<YL;g++ ){gK[i++ ]=gK[g];gK[g]=null;}YL=i;}}}class eC<jC extends DB> extends VB.Stream<jC>{final  EL;final  sK;final  gL;final  zL=new List<LG>();var QM=0;eC(this.EL,this.sK,this.gL); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new LG<jC>(this,h);if(QM==zL.length)zL.add(g);else zL[QM]=g;QM++ ;if(sK==DB.cD&&gL==false)xC.BF.cM(this);return g;} uM( h){for(int g=0;g<QM;g++ ){if(zL[g]==h){zL[g]=null;break;}}} LN( k){var j=QM;var h=0;for(int g=0;g<j;g++ ){var i=zL[g];if(i==null)continue;i.CM(k);if(h!=g){zL[h]=i;zL[g]=null;}h++ ;}if(h!=j){for(int g=j;g<QM;g++ ){zL[h++ ]=zL[g];zL[g]=null;}QM=h;}}}class cB<jC extends DB>{final  sK;const cB(this.sK); forTarget( g,{ useCapture: false}){return g.JM(sK,useCapture);}}class bB{var volume;var dI;var fJ=1;var gJ=0;var jJ=1;var iJ=0;bB([this.volume=1,this.dI=0]);}class hC extends DB{var cK;hC( g):super(DB.cD,false){cK=g;} get hF=>cK; get FE=>false;}class w extends DB{static const  rE="click";static const  VG="doubleClick";static const  xE="mouseDown";static const  DF="mouseUp";static const  GF="mouseMove";static const  HF="mouseOut";static const  IF="mouseOver";static const  JF="mouseWheel";static const  LF="middleClick";static const  sG="middleMouseDown";static const  uG="middleMouseUp";static const  MF="rightClick";static const  zG="rightMouseDown";static const  EH="rightMouseUp";var IN,JN;var MN,NN;var qN;var YM;var lM;var bM;var eM;var sN;var tN;var uN;w( g,[ bubbles=false]):super(g,bubbles){zM(g,bubbles);} zM( g,[ bubbles=false]){super.zM(g,bubbles);IN=JN=0;MN=NN=0;qN=false;YM=false;lM=false;bM=false;eM=false;sN=0;tN=0;uN=0;}set vN( g){IN=g.x;JN=g.y;}set yN( g){MN=g.x;NN=g.y;} get JC=>qN; get altKey=>YM; get ctrlKey=>bM; get shiftKey=>eM; get mC=>sN; get deltaX=>tN; get deltaY=>uN;}class zB extends DB{static const  ZD="keyDown";static const  uE="keyUp";var YM;var bM;var eM;var gM;var lM;var oM;var qM;var sM;zB( g,[ bubbles=false]):super(g,bubbles){zM(g,bubbles);} zM( g,[ bubbles=false]){super.zM(g,bubbles);YM=false;bM=false;eM=false;gM=false;lM=false;oM=0;qM=0;sM=0;} get altKey=>YM; get ctrlKey=>bM; get shiftKey=>eM; get charCode=>oM; get keyCode=>qM; get keyLocation=>sM;}class oE extends DB{static const  TG="textInput";var oK="";oE( g,[ bubbles=false]):super(g,bubbles){}}class SB extends DB{static const  sE="touchBegin";static const  vE="touchEnd";static const  yE="touchCancel";static const  FF="touchMove";static const  jG="touchOver";static const  kG="touchOut";var EN;var GN;var IN,JN;var MN,NN;var YM;var lM;var bM;var eM;var TN;var WN;var YN;SB( g,[ bubbles=false]):super(g,bubbles){zM(g,bubbles);} zM( g,[ bubbles=false]){super.zM(g,bubbles);EN=0;GN=false;IN=JN=0;MN=NN=0;YM=false;lM=false;bM=false;eM=false;TN=1.00;WN=0;YN=0;}set vN( g){IN=g.x;JN=g.y;}set yN( g){MN=g.x;NN=g.y;} get OD=>EN; get altKey=>YM; get ctrlKey=>bM; get shiftKey=>eM;}abstract class XC{ apply( h, i, j, g);}class PJ extends XC{var KB;var LB;PJ([this.KB=4,this.LB=4]){if(KB<1||LB<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(KB>128||LB>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} apply( LC, q, MC, uB){var GC=LC.kN();var MB=GC.getImageData(q.x,q.y,q.width,q.height);var vB=MB.data;var v=MB.width;var wB=MB.height;var ZB=KB*KB;var xB=LB*LB;var l=KB;var yB=KB*2;var u=LB;var aB=LB*2;var NB=v+yB;var CB=wB+aB;var HC=v*4;var FB=NB*4;var TB=MC.kN();var UB=TB.createImageData(NB,CB);var t=UB.data;var j=new List<int>(1024);PH(vB);for(int i=0;i<4;i++ ){for(int h=0;h<v;h++ ){var k=0,n=xB>>1;var m=h*4+i;var o=(h+l)*4+i;for(int g=0;g<CB;g++ ){t[o]=n~/xB;o+= FB;if(g>=aB){k-= 2*j[g&1023]-j[(g-u)&1023];}else if(g>=u){k-= 2*j[g&1023];}var p=(g<wB)?vB[m]:0;j[(g+u)&1023]=p;n+= k+= p;m+= HC;}}}for(int i=0;i<4;i++ ){for(int g=0;g<CB;g++ ){var k=0,n=ZB>>1;var m=g*FB+l*4+i;var o=g*FB+i;for(int h=0;h<NB;h++ ){t[o]=n~/ZB;o+= 4;if(h>=yB){k-= 2*j[h&1023]-j[(h-l)&1023];}else if(h>=l){k-= 2*j[h&1023];}var p=(h<v)?t[m]:0;j[(h+l)&1023]=p;n+= k+= p;m+= 4;}}}WH(t);TB.putImageData(UB,uB.x-l,uB.y-u);}}class MJ extends XC{final  tK;MJ.rJ():tK=[0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0,0,0,1,0];MJ.sJ():tK=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]; apply( LC, m, MC, GC){var q=LC.kN().getImageData(m.x,m.y,m.width,m.height);var h=q.data;var uB=(tK[00]*65536).toInt();var UB=(tK[01]*65536).toInt();var HC=(tK[02]*65536).toInt();var p=(tK[03]*65536).toInt();var xB=(tK[04]*65536).toInt();var vB=(tK[05]*65536).toInt();var TB=(tK[06]*65536).toInt();var wB=(tK[07]*65536).toInt();var v=(tK[08]*65536).toInt();var n=(tK[09]*65536).toInt();var t=(tK[10]*65536).toInt();var u=(tK[11]*65536).toInt();var aB=(tK[12]*65536).toInt();var yB=(tK[13]*65536).toInt();var FB=(tK[14]*65536).toInt();var CB=(tK[15]*65536).toInt();var ZB=(tK[16]*65536).toInt();var MB=(tK[17]*65536).toInt();var o=(tK[18]*65536).toInt();var NB=(tK[19]*65536).toInt();if(RC){for(int g=0;g<=h.length-4;g+= 4){var k=h[g+0];var l=h[g+1];var j=h[g+2];var i=h[g+3];h[g+0]=((uB*k)+(UB*l)+(HC*j)+(p*i)+xB)~/65536;h[g+1]=((vB*k)+(TB*l)+(wB*j)+(v*i)+n)~/65536;h[g+2]=((t*k)+(u*l)+(aB*j)+(yB*i)+FB)~/65536;h[g+3]=((CB*k)+(ZB*l)+(MB*j)+(o*i)+NB)~/65536;}}else{for(int g=0;g<=h.length-4;g+= 4){var i=h[g+0];var j=h[g+1];var l=h[g+2];var k=h[g+3];h[g+0]=((CB*k)+(ZB*l)+(MB*j)+(o*i)+NB)~/65536;h[g+1]=((t*k)+(u*l)+(aB*j)+(yB*i)+FB)~/65536;h[g+2]=((vB*k)+(TB*l)+(wB*j)+(v*i)+n)~/65536;h[g+3]=((uB*k)+(UB*l)+(HC*j)+(p*i)+xB)~/65536;}}MC.kN().putImageData(q,GC.x,GC.y);}}class KJ extends XC{var IE;var angle;var color;var alpha;var KB;var LB;var UE;var NE;var PE;var nC;KJ([this.IE=4.0,this.angle=gB.PI/4,this.color=0,this.alpha=1.0,this.KB=4,this.LB=4,this.UE=1.0,this.NE=false,this.PE=false,this.nC=false]){if(KB<1||LB<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(KB>128||LB>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} apply( YE, n, ZE, TB){var rC=YE.kN();var aE=rC.getImageData(n.x,n.y,n.width,n.height);var bE=aE.data;var p=n.width;var aB=n.height;var uB=KB*KB;var xB=LB*LB;var o=KB;var sC=KB*2;var UB=LB;var MC=LB*2;var MB=p+sC;var FB=aB+MC;var cE=p*4;var ZB=MB*4;var CB=RC?3:0;var q=ZE.kN();var tC=q.createImageData(MB,FB);var h=tC.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){var m=0,u=xB>>1;var t=j*4+CB;var v=(j+o)*4+CB;for(int i=0;i<FB;i++ ){h[v]=u~/xB;v+= ZB;if(i>=MC){m-= 2*l[i&1023]-l[(i-UB)&1023];}else if(i>=UB){m-= 2*l[i&1023];}var k=(i<aB)?bE[t]:0;l[(i+UB)&1023]=k;u+= m+= k;t+= cE;}}for(int i=0;i<FB;i++ ){var m=0,u=uB>>1;var t=i*ZB+o*4+CB;var v=i*ZB+CB;for(int j=0;j<MB;j++ ){h[v]=u~/uB;v+= 4;if(j>=sC){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}var k=(j<p)?h[t]:0;l[(j+o)&1023]=k;u+= m+= k;t+= 4;}}var yB=(alpha*256).toInt();var vB=(color>>16)&0xFF;var wB=(color>>8)&0xFF;var uC=(color>>0)&0xFF;if(RC){for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=vB;h[g+1]=wB;h[g+2]=uC;h[g+3]=(h[g+3]*yB)~/256;}}}else{for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=(h[g+0]*yB)~/256;h[g+1]=uC;h[g+2]=wB;h[g+3]=vB;}}}var LC=TB.x;var HC=TB.y;var GC=TB.x-o+(this.IE*gB.cos(this.angle)).round().toInt();var vC=TB.y-UB+(this.IE*gB.sin(this.angle)).round().toInt();var dE=new EB(LC,HC,p,aB);var eE=new EB(GC,vC,MB,FB);var NB=dE.union(eE);q.setTransform(1,0,0,1,0,0);q.clearRect(NB.x,NB.y,NB.width,NB.height);q.putImageData(tC,GC,vC);if(this.nC==false)q.drawImage(rC.canvas,LC,HC);}}class JJ extends XC{var color;var alpha;var KB;var LB;var UE;var NE;var PE;var nC;JJ([this.color=0,this.alpha=1.0,this.KB=4,this.LB=4,this.UE=2.0,this.NE=false,this.PE=false,this.nC=false]){if(KB<1||LB<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(KB>128||LB>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} apply( YE, n, ZE, TB){var rC=YE.kN();var aE=rC.getImageData(n.x,n.y,n.width,n.height);var bE=aE.data;var p=n.width;var aB=n.height;var uB=KB*KB;var xB=LB*LB;var o=KB;var sC=KB*2;var UB=LB;var MC=LB*2;var MB=p+sC;var FB=aB+MC;var cE=p*4;var ZB=MB*4;var CB=RC?3:0;var q=ZE.kN();var tC=q.createImageData(MB,FB);var h=tC.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){var m=0,u=xB>>1;var t=j*4+CB;var v=(j+o)*4+CB;for(int i=0;i<FB;i++ ){h[v]=u~/xB;v+= ZB;if(i>=MC){m-= 2*l[i&1023]-l[(i-UB)&1023];}else if(i>=UB){m-= 2*l[i&1023];}var k=(i<aB)?bE[t]:0;l[(i+UB)&1023]=k;u+= m+= k;t+= cE;}}for(int i=0;i<FB;i++ ){var m=0,u=uB>>1;var t=i*ZB+o*4+CB;var v=i*ZB+CB;for(int j=0;j<MB;j++ ){h[v]=u~/uB;v+= 4;if(j>=sC){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}var k=(j<p)?h[t]:0;l[(j+o)&1023]=k;u+= m+= k;t+= 4;}}var yB=(alpha*256).toInt();var vB=(color>>16)&0xFF;var wB=(color>>8)&0xFF;var uC=(color>>0)&0xFF;if(RC){for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=vB;h[g+1]=wB;h[g+2]=uC;h[g+3]=(h[g+3]*yB)~/256;}}}else{for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=(h[g+0]*yB)~/256;h[g+1]=uC;h[g+2]=wB;h[g+3]=vB;}}}var LC=TB.x;var HC=TB.y;var GC=TB.x-o;var vC=TB.y-UB;var dE=new EB(LC,HC,p,aB);var eE=new EB(GC,vC,MB,FB);var NB=dE.union(eE);q.setTransform(1,0,0,1,0,0);q.clearRect(NB.x,NB.y,NB.width,NB.height);q.putImageData(tC,GC,vC);if(this.nC==false)q.drawImage(rC.canvas,LC,HC);}}abstract class AB extends IC implements WC{var LL=0.0;var QL=0.0;var ZL=0.0;var kL=0.0;var sL=1.0;var AM=1.0;var IM=0.0;var PM=1.0;var RM=true;var TM=null;var XK="";var aM=null;final  fM=new PB.oJ();final  mM=new PB.oJ();final  rM=new PB.oJ();var wM=true;static const  NH=const cB<hC>(DB.cD); get YI=>AB.NH.forTarget(this); get x=>LL; get y=>QL; get lB=>ZL; get sB=>kL; get mB=>sL; get nB=>AM; get pC=>IM; get alpha=>PM; get visible=>RM; get mask=>TM; get name=>XK; get parent=>aM; get root{var g=this;while (g.aM!=null)g=g.aM;return g;} get MD{var g=this.root;if(g is lC)return g;return null;}set x( g){LL=g;wM=true;}set y( g){QL=g;wM=true;}set lB( g){ZL=g;wM=true;}set sB( g){kL=g;wM=true;}set mB( g){sL=g;wM=true;}set nB( g){AM=g;wM=true;}set pC( g){IM=g;wM=true;}set alpha( g){PM=g;wM=true;}set visible( g){RM=g;wM=true;}set mask( g){TM=g;} get width=>FC(wN).width; get height=>FC(wN).height; set width( h){this.mB=1;var g=this.width;this.mB=(g!=0.0)?h/g:1.0;} set height( h){this.nB=1;var g=this.height;this.nB=(g!=0.0)?h/g:1.0;} SE(){if(aM!=null)aM.kF(this);} get wN{if(wM){wM=false;if(IM==0.0){rM.TE(sL,0.0,0.0,AM,LL-ZL*sL,QL-kL*AM);}else{var g=gB.cos(IM);var h=gB.sin(IM);var i=sL*g;var l=sL*h;var k=-AM*h;var j=AM*g;var m=LL-ZL*i-kL*k;var n=QL-ZL*l-kL*j;rM.TE(i,l,k,j,m,n);}}return rM;} FC( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new EB.lJ();returnRectangle.x=g.eB;returnRectangle.y=g.fB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} KC( g, h){if(FC(mM).contains(g,h))return this;return null;} UC( h){fM.TI();for(AB g=this;g!=null;g=g.aM)fM.concat(g.wN);fM.aF();return fM.oI(h);} dispatchEvent( h){var g=null;if(h.FE||h.bubbles)for(AB j=aM;j!=null;j=j.aM)if(j.SI(h.type)){if(g==null)g=new List<AB>();g.add(j);}if(h.FE&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.ND==false)g[i].lN(h,this,g[i],AC.qE);if(h.ND==false)lN(h,this,this,AC.QC);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.ND==false)g[i].lN(h,this,g[i],AC.XG);} zN( h){for(var g=h;g!=null;g=g.aM)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");aM=h;} QB( g);}abstract class IB extends AB{var BI=false;var fF=true;var kJ=true;var tabIndex=0;static const  hG=const cB<w>(w.HF);static const  nG=const cB<w>(w.IF);static const  tG=const cB<w>(w.GF);static const  wG=const cB<w>(w.xE);static const  FH=const cB<w>(w.DF);static const  SH=const cB<w>(w.JF); get onMouseOut=>IB.hG.forTarget(this); get onMouseOver=>IB.nG.forTarget(this); get onMouseMove=>IB.tG.forTarget(this); get onMouseDown=>IB.wG.forTarget(this); get onMouseUp=>IB.FH.forTarget(this); get onMouseWheel=>IB.SH.forTarget(this);static const  bH=const cB<SB>(SB.FF);static const  dH=const cB<SB>(SB.vE);static const  fH=const cB<SB>(SB.yE); get onTouchMove=>IB.bH.forTarget(this); get onTouchEnd=>IB.dH.forTarget(this); get onTouchCancel=>IB.fH.forTarget(this);static const  jH=const cB<zB>(zB.uE);static const  kH=const cB<zB>(zB.ZD); get onKeyUp=>IB.jH.forTarget(this); get onKeyDown=>IB.kH.forTarget(this);}abstract class WB extends IB{final  NL=new List<AB>();var lL=true;var wL=true; get RE=>NL.length; BB( g){if(g.parent==this){var h=NL.indexOf(g);NL.removeAt(h);NL.add(g);}else{DE(g,NL.length);}} DE( g, h){if(h<0&&h>NL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){NL.removeAt(NL.indexOf(g));if(h>NL.length)h-- ;NL.insertRange(h,1,g);}else{g.SE();g.zN(this);NL.insertRange(h,1,g);g.dispatchEvent(new DB(DB.MG,true));if(this.MD!=null)BO(g,new DB(DB.WG));}} kF( h){var g=NL.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");gI(g);} gI( g){if(g<0&&g>=NL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=NL[g];h.dispatchEvent(new DB(DB.eG,true));if(this.MD!=null)BO(h,new DB(DB.iG));h.zN(null);NL.removeAt(g);} LI( g){if(g<0&&g>=NL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return NL[g];} mI( g){NL.sort(g);} contains( g){for(;g!=null;g=g.aM)if(g==this)return true;return false;} FC( n,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new EB.lJ();if(NL.length==0)return super.FC(n,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var o=NL.length;for(int l=0;l<NL.length;l++ ){var m=NL[l];fM.VF(m.wN,n);var g=m.FC(fM,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} KC( o, p){var l=null;for(int j=NL.length-1;j>=0;j-- ){var i=NL[j];if(i.visible){var g=i.wN;var m=o-g.eB;var k=p-g.fB;var q=(g.d*m-g.c*k)/g.aC;var n=(g.a*k-g.b*m)/g.aC;var h=i.KC(q,n);if(h!=null){if(h is IB)if(h.fF)return lL?h:this;l=this;}}}return l;} QB( i){for(int g=0;g<NL.length;g++ ){var h=NL[g];if(h.visible)i.mF(h);}} BO( g, j){g.dispatchEvent(j);if(g is WB){var i=new List<AB>.from(g.NL,growable:false);for(int h=0;h<i.length;h++ )BO(i[h],j);}}}class jE{var target=null;var JC=false;var GE=0;var mC=0;var eF,gF;var cF,dF;jE(this.eF,this.gF,this.cF,this.dF);}abstract class OC extends IC{ set LD( g); stop();}abstract class hB{static  nD( g){var h=fC.lG;if(h=="WebAudioApi")return UD.nD(g);if(h=="AudioElement")return SD.nD(g);return lE.nD(g);} get length; play([ loop=false, soundTransform]);static  PF( g){var m=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var i=m.firstMatch(g);var h=fC.KF;if(i==null)throw new ArgumentError("Unsupported file extension.");if(h.length==0)throw new UnsupportedError("This browser supports no known audio codec.");var j=i.group(1).toLowerCase();if(h.indexOf(j)==-1){var l=g.substring(0,g.length-j.length);var k=h[0];g="${l}${k}";}return g;}}class iE extends WB{var UJ=false;var XE=false;}class wC extends AB{var rB;var fI;var SC;wC([this.rB=null,this.fI="auto"]){SC=null;} FC( h,[ returnRectangle]){var g=(rB!=null)?rB.width:0;var i=(rB!=null)?rB.height:0;return rD(h,g,i,returnRectangle);} KC( g, h){if(rB!=null&&g>=0.0&&h>=0.0&&g<rB.width&&h<rB.height)return this;return null;} QB( g){if(rB!=null){if(SC==null)rB.QB(g);else rB.lF(g,SC);}}}class CC{final  dK=new XB.ImageElement();final  WL=new List<hE>();static  nD( m, u){var l=new VB.Completer<CC>();var j=new CC();switch (u){case iC.KG:case iC.AD: n( k, g){var q=BH(k);var h=new hE(q,j);h.DL=g["frame"]["x"].toInt();h.ML=g["frame"]["y"].toInt();h.SL=g["frame"]["w"].toInt();h.dL=g["frame"]["h"].toInt();h.oL=g["spriteSourceSize"]["x"].toInt();h.tL=g["spriteSourceSize"]["y"].toInt();h.yL=g["sourceSize"]["w"].toInt();h.HM=g["sourceSize"]["h"].toInt();h.OM=g["rotated"] as bool;j.WL.add(h);}XB.HttpRequest.getString(m).then((t){var o=sF.parse(t);var i=o["frames"];var p=o["meta"];if(i is List)for(var g in i)n(g["filename"],g);if(i is Map)for(String k in i.keys)n(k,i[k]);j.dK..onLoad.listen((v)=>l.complete(j))..onError.listen((v)=>l.completeError(new StateError("Failed to load image.")))..src=QF(m,p["image"]);}).catchError((CB){l.completeError(new StateError("Failed to load json file."));});break;}return l.future;} get JD=>dK; NC( i){var h;for(int g=0;g<WL.length&&h==null;g++ )if(WL[g].name==i)h=new GB.uJ(WL[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;} KI( i){var h=new List<GB>();for(int g=0;g<WL.length;g++ )if(WL[g].name.indexOf(i)==0)h.add(new GB.uJ(WL[g]));return h;} get GI{return WL.map((g)=>g.name).toList();}}class LJ extends IB{var oK="";var zK=0x000000;var TL=null;var mL=FG.UG;var DM=EG.QG;var RK=CG.JG;var SM=false;var WM=false;var XM=0x000000;var dM=false;var hM=0x000000;var kM=0;var nM=0;var pM;var tM;var vM=true;var xM=100;var yM=100;var AN=null;var jK=null;LJ(){TL=new gE("Arial",12,0x000000);pM=new List<String>();tM=new List<kE>();} get type=>RK; get width=>xM; get height=>yM; set text( g){oK=g;vM=true;} set TC( g){TL=g;zK=TL.color;vM=true;} set wordWrap( g){SM=g;vM=true;} set width( g){xM=g;vM=true;} set height( g){yM=g;vM=true;} FC( g,[ returnRectangle]){return rD(g,xM,yM,returnRectangle);} KC( g, h){if(g>=0&&h>=0&&g<xM&&h<yM)return this;return null;} QB( g){OO();g.jK.drawImage(AN,0.0,0.0);} PO(){pM.clear();tM.clear();if(SM==false){pM.add(oK);}else{for(String n in oK.replaceAll('\r','').split('\n')){var h=new StringBuffer();var i=0;var g="";for(String j in n.split(' ')){i=h.length;h.write((i>0)?" ${j}":j);g=h.toString();if(jK.measureText(g).width>xM){if(i>0){g=g.substring(0,i);}else{j="";}pM.add(g);h=new StringBuffer();h.write(j);}}if(h.isEmpty==false){pM.add(h.toString());}}}kM=0;nM=0;for(String g in pM){var l=jK.measureText(g);var m=0;if(TL.align==PC.YD||TL.align==PC.YG)m=(xM-l.width)/2;if(TL.align==PC.EF||TL.align==PC.SG)m=xM-l.width;var k=new kE(m,l.width,TL.size,0,0,0);tM.add(k);kM=gB.max(kM,k.width);nM=nM+k.height;}} OO(){if(vM){vM=false;var j=xM.ceil().toInt();var i=yM.ceil().toInt();if(AN==null){AN=new XB.CanvasElement(width:j,height:i);jK=AN.context2d;}if(AN.width!=j)AN.width=j;if(AN.height!=i)AN.height=i;var g=new StringBuffer();g.write(TL.OE?"italic ":"normal ");g.write("normal ");g.write(TL.GD?"bold ":"normal ");g.write("${TL.size}px ");g.write("${TL.font},sans-serif");jK.font=g.toString();jK.textAlign="start";jK.textBaseline="top";jK.fillStyle=kC(zK);PO();if(WM){jK.fillStyle=kC(XM);jK.fillRect(0,0,xM,yM);}else{jK.clearRect(0,0,xM,yM);}var k=0;for(int h=0;h<pM.length;h++ ){var l=tM[h];jK.fillStyle=kC(zK);jK.fillText(pM[h],l.x,k);k+= l.height;}if(dM){jK.strokeStyle=kC(hM);jK.lineWidth=1;jK.strokeRect(0,0,xM,yM);}}}}class iC{static const  KG="json";static const  AD="jsonarray";}class hE{var XK;var pK;var DL;var ML;var SL;var dL;var oL;var tL;var yL;var HM;var OM;hE( g, h){XK=g;pK=h;} get nI=>pK; get name=>XK; get II=>DL; get JI=>ML; get HI=>SL; get FI=>dL; get offsetX=>oL; get offsetY=>tL; get cI=>yL; get bI=>HM; get kI=>OM;}class OJ extends AB{var eK;OJ(){eK=new mE();} get RI=>eK; FC( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new EB.lJ();returnRectangle.x=g.eB;returnRectangle.y=g.fB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} KC( g, h){return null;} QB( g){eK.QB(g);}}class DG extends IB implements jB{var IL;var RL;var bL;var nL;var uL;var lK;var FM;var MM;var SC;DG( g,[ frameRate=30, loop=true]){IL=g;RL=frameRate;bL=0;nL=null;uL=false;lK=loop;FM=new DB(DB.OF);MM=new DB(DB.yG);SC=null;}static const  HH=const cB<DB>(DB.OF); get onProgress=>DG.HH.forTarget(this); get WE=>IL.length; set loop( g){lK=g;} play(){uL=true;nL=null;} stop(){uL=false;nL=null;} qB( j){if(uL==false)return true;if(nL==null){nL=0.0;lN(FM,this,this,AC.QC);}else{nL+= j;var i=1.0/RL;while (uL&&nL>=i){var h=bL;var g=lK?(h+1)%WE:gB.min(h+1,WE-1);bL=g;nL-= i;if(h!=g){lN(FM,this,this,AC.QC);if(bL!=g)return true;}if(h!=g&&g==WE-1&&lK==false){lN(MM,this,this,AC.QC);if(bL!=g)return true;}}}return true;} FC( h,[ returnRectangle]){var g=IL[bL];return rD(h,g.width,g.height,returnRectangle);} KC( g, h){var i=IL[bL];if(g>=0&&h>=0&&g<i.width&&h<i.height)return this;return null;} QB( g){var h=IL[bL];if(SC==null)h.QB(g);else h.lF(g,SC);}}class iB{static const  XD="auto";static const  aD="arrow";static const  bD="button";static const  cG="hand";static const  dG="ibeam";static const  gG="wait";}class mE{final  fK=new List<zF>();clear()=>fK.clear();beginPath()=>fK.add(new zF("beginPath"));closePath()=>fK.add(new zF("closePath"));moveTo( h, g)=>fK.add(new zF("moveTo",[h,g]));lineTo( h, g)=>fK.add(new zF("lineTo",[h,g]));arcTo( k, i, g, h, j)=>fK.add(new zF("arcTo",[k,i,g,h,j]));quadraticCurveTo( j, i, g, h)=>fK.add(new zF("quadraticCurveTo",[j,i,g,h]));bezierCurveTo( h, k, l, i, g, j)=>fK.add(new zF("bezierCurveTo",[h,k,l,i,g,j]));arc( l, g, j, i, h, k)=>fK.add(new zF("arc",[l,g,j,i,h,k]));rect( i, g, h, j)=>fK.add(new zF("rect",[i,g,h,j]));pF( g,[ width=1, joints=BG.OG, caps=AG.OG])=>fK.add(new zF("strokeColor",[fD(g),width,joints,caps]));DI( g)=>fK.add(new zF("fillColor",[fD(g)])); QB( k){var h=k.context;h.save();for(var j in fK){var g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].QO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].RO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];PB i=g[0].tK;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.eB,i.fB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].bJ(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].cJ(h);PB i=g[0].tK;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.eB,i.fB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}class EG{static const  QG="pixel";}class zF{var name;var arguments;zF(this.name,[this.arguments]);}class WD{static var pE=iB.XD;static var PG=false;static var bG=new VB.StreamController<String>();static var fG=bG.stream.asBroadcastStream();static  RF( i){var h=i;var g="auto";if(pE!=iB.XD)h=pE;switch (h){case iB.XD:g="auto";break;case iB.aD:g="default";break;case iB.bD:g="pointer";break;case iB.cG:g="move";break;case iB.dG:g="text";break;case iB.gG:g="wait";break;}if(PG)g="none";return g;}}class fC{static var lG=CH();static var CD=MH();static var KF=OH();static  CH(){var h=(CD!=null)?"WebAudioApi":"AudioElement";var g=XB.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(KF.length==0)h="Mock";print("dartflash: supported audio engine is: ${h}");return h;}static  MH(){try {return new tF.AudioContext();}catch (g){return null;}}static  OH(){var g=new List<String>();var h=new XB.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("dartflash: supported audio types are: ${g}");return g;}}class VD{var RK;var ZK;var rK;var FL;VD.mJ( i, g, h, j){RK=0;ZK=new EB(i,g,h,j);}VD.pJ( i, g, h){RK=1;rK=new wF(i,g,h);}VD.qJ( g){RK=2;FL=g;if(FL.length<3)throw new ArgumentError("A custom mask needs at least 3 points.");} QB( i){var g=i.context;g.beginPath();switch (RK){case 0:g.rect(ZK.x,ZK.y,ZK.width,ZK.height);break;case 1:g.arc(rK.x,rK.y,rK.jF,0,gB.PI*2.0,false);break;case 2:g.moveTo(FL[0].x,FL[0].y);for(int h=1;h<FL.length;h++ )g.lineTo(FL[h].x,FL[h].y);break;}g.clip();}}abstract class WC{ QB( g);}class GB implements WC{var mK;var wK;var JL;var XL;var jK;var vL;var EM;var LM;var DL;var ML;var SL;var dL;GB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){mK=g;wK=h;JL=transparent;var i=new XB.CanvasElement(width:mK,height:wK);jK=i.context2d;jK.fillStyle=JL?fD(fillColor):kC(fillColor);jK.fillRect(0,0,g,h);XL=i;vL=0;}GB.tJ( g){mK=g.naturalWidth;wK=g.naturalHeight;JL=true;XL=g;vL=0;}GB.uJ( g){mK=g.cI;wK=g.bI;JL=true;XL=g.nI.JD;vL=g.kI?2:1;EM=g.offsetX.toDouble();LM=g.offsetY.toDouble();DL=g.II.toDouble();ML=g.JI.toDouble();SL=g.HI.toDouble();dL=g.FI.toDouble();}static  nD( i){var h=new VB.Completer<GB>();var g=new XB.ImageElement();g.onLoad.listen((j)=>h.complete(new GB.tJ(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>mK; get height=>wK; vH( i, j, g, h){h.apply(i,j,this,g);} QB( g){switch (vL){case 0:g.context.drawImage(XL,0.0,0.0);break;case 1:g.context.drawImage(XL,DL,ML,SL,dL,EM,LM,SL,dL);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,EM,LM+dL);g.context.drawImage(XL,DL,ML,dL,SL,0.0,0.0,dL,SL);break;}} lF( v, g){if(g.width<=0.0||g.height<=0.0)return;switch (vL){case 0:v.context.drawImage(XL,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=DL;double h=ML;double p=j+SL;double q=h+dL;double l=DL-EM+g.x;double m=ML-LM+g.y;double u=l+g.width;double t=m+g.height;double o=(j>l)?j:l;double n=(h>m)?h:m;double CB=(p<u)?p:u;double NB=(q<t)?q:t;double MB=EM-j+o;double FB=LM-h+n;double k=CB-o;double i=NB-n;if(k>0.0&&i>0.0){v.context.drawImage(XL,o,n,k,i,MB,FB,k,i);}break;case 2:double j=DL;double h=ML;double p=j+dL;double q=h+SL;double l=DL+LM-g.y+dL-g.height;double m=ML-EM+g.x;double u=l+g.height;double t=m+g.width;double o=(j>l)?j:l;double n=(h>m)?h:m;double CB=(p<u)?p:u;double NB=(q<t)?q:t;double MB=EM-h+n;double FB=LM+p-CB;double k=NB-n;double i=CB-o;if(k>0.0&&i>0.0){v.context.transform(0.0,-1.0,1.0,0.0,MB,FB+i);v.context.drawImage(XL,o,n,i,k,0.0,0.0,i,k);}break;}} kN(){if(jK==null){var g=new XB.CanvasElement(width:mK,height:wK);jK=g.context2d;switch (vL){case 0:jK.drawImage(XL,0,0);break;case 1:jK.drawImage(XL,DL,ML,SL,dL,EM,LM,SL,dL);break;case 2:jK.setTransform(0.0,-1.0,1.0,0.0,EM,LM+dL);jK.drawImage(XL,DL,ML,dL,SL,0.0,0.0,dL,SL);jK.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}XL=g;vL=0;}return jK;}}typedef  HG<jC extends DB>( event);class LG<jC extends DB> extends VB.StreamSubscription<jC>{var qL;var CM;var GM;var NM;LG(this.qL,this.CM){GM=0;NM=false;} cancel(){if(NM==false){qL.uM(this);NM=true;CM=null;}} onError( g( error)){} get fN=>GM>0; pause([ resumeSignal]){GM++ ;if(resumeSignal!=null)resumeSignal.whenComplete(resume);} resume(){if(fN==false)throw new StateError("Subscription is not paused.");GM-- ;}}class tE{var aL;tE(){aL=new Map<String,yC>();} ZM( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(aL.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");aL[i]=g;} CN( i, g){var h="${i}.${g}";if(aL.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return aL[h];} pB( i, h){var g=new yC("BitmapData",i,h);g.BN(GB.nD(h));ZM(g);} HB( i, h){var g=new yC("Sound",i,h);g.BN(hB.nD(h));ZM(g);} EE( j, h, i){var g=new yC("TextureAtlas",j,h);g.BN(CC.nD(h,i));ZM(g);} tH( i, h){var g=new yC("FlumpLibrary",i,h);g.BN(DC.nD(h));ZM(g);} load(){var h=this.eI.map((i)=>i.KL);return VB.Future.wait(h).then((j){var g=this.CI;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get eI{return aL.values.where((g)=>g.oC==null).toList();} get CI{return aL.values.where((g)=>g.error!=null).toList();} NC( g){return CN("BitmapData",g).oC;} ZF( g){return CN("Sound",g).oC;} ME( g){return CN("TextureAtlas",g).oC;} MI( g){return CN("FlumpLibrary",g).oC;}} kC( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class DC{var yK;var rL;var RL;final  KM=new List<BE>();final  VM=new List<rH>();static  nD( l){var i=new VB.Completer<DC>();XB.HttpRequest.getString(l).then((p){var h=sF.parse(p) as Map;var j=new List();var g=new DC();g.yK=l;g.rL=h["md5"];g.RL=h["frameRate"].toInt();for(var m in h["movies"] as List){var n=new BE(m,g);g.KM.add(n);}for(var o in h["textureGroups"] as List){var k=new rH(o,g);g.VM.add(k);j.add(k.HD.future);}VB.Future.wait(j).then((t){i.complete(g);}).catchError((q){i.completeError(new StateError("Failed to load image."));});}).catchError((q){i.completeError(new StateError("Failed to load json file."));});return i.future;} xN( h){for(var g in KM)if(g.id==h)return g;throw new ArgumentError("The movie '${h}' is not available.");} AO( g){for(var h in VM){if(h.ID.containsKey(g)){return h.ID[g];}}for(var i in KM){if(i.id==g){return new QJ(this,g);}}throw new ArgumentError("The symbol '${g}' is not available.");}}class zE{static var CF=false;static var dD=false;static var eD=0;static var pG=fE.UG;static var rG=new VB.StreamController<String>();static var vG=rG.stream.asBroadcastStream();static xG(){if(CF==false){CF=true;var g=XB.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){dD=true;eD=10;}if(g.contains("Android")){dD=true;eD=10;}if(g.contains("IEMobile")){dD=true;eD=10;}}}static  get RH{xG();return pG;}}class mG{static var oG=0;var OD=oG++ ;var target=null;var KD=false;mG(this.target,this.KD);} fD( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class s{static var gD;static  ZC( g){return g;}static  NF( g){return 0.5-0.5*gB.cos(g*2.0*gB.PI);}static  DH( g){return 0.5+0.5*gB.cos(g*2.0*gB.PI);}static  GH( g){if(gD==null)gD=new gB.Random();if(g==0.0||g==1.0)return g;return gD.nextDouble();}static  hD( g){return g*g;}static  iD( g){g=1.0-g;return 1.0-g*g;}static  JH( g){g=g*2.0;return (g<1.0)?0.5*hD(g):0.5*iD(g-1.0)+0.5;}static  KH( g){g=g*2.0;return (g<1.0)?0.5*iD(g):0.5*hD(g-1.0)+0.5;}static  jD( g){return g*g*g;}static  kD( g){g=1.0-g;return 1.0-g*g*g;}static  SF( g){g=g*2.0;return (g<1.0)?0.5*jD(g):0.5*kD(g-1.0)+0.5;}static  QH( g){g=g*2.0;return (g<1.0)?0.5*kD(g):0.5*jD(g-1.0)+0.5;}static  lD( g){return g*g*g*g;}static  mD( g){g=1.0-g;return 1.0-g*g*g*g;}static  UH( g){g=g*2.0;return (g<1.0)?0.5*lD(g):0.5*mD(g-1.0)+0.5;}static  VH( g){g=g*2.0;return (g<1.0)?0.5*mD(g):0.5*lD(g-1.0)+0.5;}static  oD( g){return g*g*g*g*g;}static  pD( g){g=1.0-g;return 1.0-g*g*g*g*g;}static  XH( g){g=g*2.0;return (g<1.0)?0.5*oD(g):0.5*pD(g-1.0)+0.5;}static  YH( g){g=g*2.0;return (g<1.0)?0.5*pD(g):0.5*oD(g-1.0)+0.5;}static  qD( g){return 1.0-gB.sqrt(1.0-g*g);}static  sD( g){g=1.0-g;return gB.sqrt(1.0-g*g);}static  ZH( g){g=g*2.0;return (g<1.0)?0.5*qD(g):0.5*sD(g-1.0)+0.5;}static  aH( g){g=g*2.0;return (g<1.0)?0.5*sD(g):0.5*qD(g-1.0)+0.5;}static  tD( g){return 1.0-gB.cos(g*(gB.PI/2.0));}static  uD( g){return gB.sin(g*(gB.PI/2.0));}static  cH( g){g=g*2.0;return (g<1.0)?0.5*tD(g):0.5*uD(g-1.0)+0.5;}static  gH( g){g=g*2.0;return (g<1.0)?0.5*uD(g):0.5*tD(g-1.0)+0.5;}static  vD( g){if(g==0.0)return 0.0;return gB.pow(2.0,10.0*(g-1.0));}static  wD( g){if(g==1.0)return 1.0;return 1.0-gB.pow(2.0,-10.0*g);}static  hH( g){g=g*2.0;return (g<1.0)?0.5*vD(g):0.5*wD(g-1.0)+0.5;}static  iH( g){g=g*2.0;return (g<1.0)?0.5*wD(g):0.5*vD(g-1.0)+0.5;}static  xD( g){var h=1.70158;return g*g*((h+1.0)*g-h);}static  yD( g){var h=1.70158;g=g-1.0;return g*g*((h+1.0)*g+h)+1.0;}static  UF( g){g=g*2.0;return (g<1.0)?0.5*xD(g):0.5*yD(g-1.0)+0.5;}static  lH( g){g=g*2.0;return (g<1.0)?0.5*yD(g):0.5*xD(g-1.0)+0.5;}static  zD( g){if(g==0.0||g==1.0)return g;g=g-1.0;return -gB.pow(2.0,10.0*g)*gB.sin((g-0.3/4.0)*(2.0*gB.PI)/0.3);}static  DD( g){if(g==0.0||g==1.0)return g;return gB.pow(2.0,-10.0*g)*gB.sin((g-0.3/4.0)*(2.0*gB.PI)/0.3)+1;}static  mH( g){g=g*2.0;return (g<1.0)?0.5*zD(g):0.5*DD(g-1.0)+0.5;}static  oH( g){g=g*2.0;return (g<1.0)?0.5*DD(g):0.5*zD(g-1.0)+0.5;}static  AE( g){return 1.0-ED(1.0-g);}static  ED( g){if(g<1/2.75){return 7.5625*g*g;}else if(g<2/2.75){g=g-1.5/2.75;return 7.5625*g*g+0.75;}else if(g<2.5/2.75){g=g-2.25/2.75;return 7.5625*g*g+0.9375;}else{g=g-2.625/2.75;return 7.5625*g*g+0.984375;}}static  pH( g){g=g*2.0;return (g<1.0)?0.5*AE(g):0.5*ED(g-1.0)+0.5;}static  qH( g){g=g*2.0;return (g<1.0)?0.5*ED(g):0.5*AE(g-1.0)+0.5;}}class AH implements jB{final  DN;final  HN;final  KN=new List<GG>();var PN;var QN;var UN;var OL;var BL;var bN;var dN;var gN;AH( g, h,[ transitionFunction( ratio)]):DN=g,HN=(transitionFunction!=null)?transitionFunction:s.ZC{BL=0.0;OL=gB.max(0.0001,h);bN=0.0;dN=false;gN=false;} kB( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(DN!=null&&gN==false)KN.add(new GG(g,0.0,h));} moveTo( h, g){kB('x',h);kB('y',g);} qB( l){if(BL<OL||gN==false){BL=BL+l;if(BL>OL)BL=OL;if(BL>=0.0){if(gN==false){gN=true;for(int i=0;i<KN.length;i++ ){var g=KN[i];switch (g.name){case 'x':g.tB=DN.x;break;case 'y':g.tB=DN.y;break;case 'pivotX':g.tB=DN.lB;break;case 'pivotY':g.tB=DN.sB;break;case 'scaleX':g.tB=DN.mB;break;case 'scaleY':g.tB=DN.nB;break;case 'rotation':g.tB=DN.pC;break;case 'alpha':g.tB=DN.alpha;break;}}if(PN!=null)PN();}var j=BL/OL;var k=HN(j);for(int i=0;i<KN.length;i++ ){var g=KN[i];var h=g.tB+k*(g.qF-g.tB);h=dN?h.round():h;switch (g.name){case 'x':DN.x=h;break;case 'y':DN.y=h;break;case 'pivotX':DN.lB=h;break;case 'pivotY':DN.sB=h;break;case 'scaleX':DN.mB=h;break;case 'scaleY':DN.nB=h;break;case 'rotation':DN.pC=h;break;case 'alpha':DN.alpha=h;break;}}if(QN!=null)QN();if(UN!=null&&BL==OL)UN();}}return BL<OL;} get AI=>DN; get currentTime=>BL;set WF( g){if(gN==false)BL=BL+bN-g;bN=g;} set onComplete( g()){UN=g;}} BH( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class lC extends WB{var AN;var jK;var SN;var VN;var aN;var cN;var eN;var iN;var jN;var mN;var nN;var oN;var pN;lC( h, g){XK=h;AN=g;AN.focus();jK=g.context2d;VN=new YB.nJ(jK);aN=gC.XD;cN=iB.aD;WD.fG.listen(fG);jN=[new jE(w.xE,w.DF,w.rE,w.VG),new jE(w.sG,w.uG,w.LF,w.LF),new jE(w.zG,w.EH,w.MF,w.MF)];iN=null;eN=new JB(0,0);nN=new w(w.rE,true);AN.onMouseDown.listen(CO);AN.onMouseUp.listen(CO);AN.onMouseMove.listen(CO);AN.onMouseOut.listen(CO);AN.onMouseWheel.listen(DO);mN=new Map<int,mG>();pN=new SB(SB.sE,true);zE.vG.listen(IO);IO(null);oN=new zB(zB.ZD,true);AN.onKeyDown.listen(LO);AN.onKeyUp.listen(LO);AN.onKeyPress.listen(MO);} get focus=>SN;NO(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){NO();} set y( g){NO();} set lB( g){NO();} set sB( g){NO();} set mB( g){NO();} set nB( g){NO();} set pC( g){NO();} set alpha( g){NO();} set width( g){NO();} set height( g){NO();}bF(){if(aN==gC.XD||aN==gC.wE){VN.reset();QB(VN);if(aN==gC.wE)aN=gC.RG;}}fG( g){AN.style.cursor=WD.RF(cN);}CO( j){j.preventDefault();var q=AN.getBoundingClientRect();var n=new DateTime.now().millisecondsSinceEpoch;var p=j.button;var h=null;var i=new JB(j.client.x-q.left,j.client.y-q.top);var m=null;if(p<0||p>2)return;if(j.type=="mousemove"&&eN.equals(i))return;var g=jN[p];eN=i;if(j.type!="mouseout")h=KC(i.x,i.y) as IB;var l=iB.aD;if(h is iE)if(h.XE)l=iB.bD;if(h is xF)if(h.XE)l=iB.bD;if(cN!=l){cN=l;AN.style.cursor=WD.RF(l);}if(iN!=null&&iN!=h){iN.dispatchEvent(nN..zM(w.HF,true)..vN=(iN.MD!=null)?iN.UC(i):new JB.lJ()..yN=i..qN=g.JC);iN=null;}if(h!=null&&h!=iN){h.dispatchEvent(nN..zM(w.IF,true)..vN=h.UC(i)..yN=i..qN=g.JC);iN=h;}var k=null;var o=false;var t=false;if(j.type=="mousedown"){k=g.eF;if(h!=g.target||n>g.GE+500)g.mC=0;g.JC=true;g.target=h;g.GE=n;g.mC++ ;}if(j.type=="mouseup"){k=g.gF;g.JC=false;o=(g.target==h);t=o&&g.mC.isEven&&(n<g.GE+500);}if(j.type=="mousemove"){k=w.GF;}if(k!=null&&h!=null){m=h.UC(i);h.dispatchEvent(nN..zM(k,true)..vN=m..yN=i..qN=g.JC..sN=g.mC);if(o){if(t&&h.BI){h.dispatchEvent(nN..zM(g.dF,true)..vN=m..yN=i..qN=g.JC);}else{h.dispatchEvent(nN..zM(g.cF,true)..vN=m..yN=i..qN=g.JC);}}}}DO( g){var j=AN.getBoundingClientRect();var h=new JB(g.client.x-j.left,g.client.y-j.top);var i=KC(h.x,h.y) as IB;if(i!=null){i.dispatchEvent(nN..zM(w.JF,true)..vN=i.UC(h)..yN=h..tN=g.deltaX..uN=g.deltaY);if(nN.ND)g.preventDefault();}}var SO=[] ;IO( h){SO.forEach((g)=>g.cancel());if(zE.RH==fE.ZG){SO=[AN.onTouchStart.listen(TO),AN.onTouchEnd.listen(TO),AN.onTouchMove.listen(TO),AN.onTouchEnter.listen(TO),AN.onTouchLeave.listen(TO),AN.onTouchCancel.listen(TO)];}}TO( j){j.preventDefault();var n=AN.getBoundingClientRect();for(var m in j.changedTouches){var l=m.identifier;var i=new JB(m.client.x-n.left,m.client.y-n.top);var h=KC(i.x,i.y) as IB;var g=mN.containsKey(l)?mN[l]:new mG(h,mN.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(pN..zM(SB.kG,true)..vN=(g.target.MD!=null)?g.target.UC(i):new JB.lJ()..yN=i..EN=g.OD..GN=g.KD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(pN..zM(SB.jG,true)..vN=h.UC(i)..yN=i..EN=g.OD..GN=g.KD);g.target=h;}var k=null;if(j.type=="touchstart"){mN[l]=g;k=SB.sE;}if(j.type=="touchend"){mN.remove(l);k=SB.vE;}if(j.type=="touchcancel"){mN.remove(l);k=SB.yE;}if(j.type=="touchmove"){k=SB.FF;}if(k!=null&&h!=null){h.dispatchEvent(pN..zM(k,true)..vN=h.UC(i)..yN=i..EN=g.OD..GN=g.KD);}}}LO( g){g.preventDefault();var h=null;if(g.type=="keyup")h=zB.uE;if(g.type=="keydown")h=zB.ZD;oN..zM(h,true)..YM=g.altKey..bM=g.ctrlKey..eM=g.shiftKey..oM=g.charCode..qM=g.keyCode..sM=YC.IG;if(g.keyLocation==XB.KeyLocation.LEFT)oN.sM=YC.NG;if(g.keyLocation==XB.KeyLocation.RIGHT)oN.sM=YC.EF;if(g.keyLocation==XB.KeyLocation.NUMPAD)oN.sM=YC.aG;if(g.keyLocation==XB.KeyLocation.JOYSTICK)oN.sM=YC.AF;if(g.keyLocation==XB.KeyLocation.MOBILE)oN.sM=YC.AF;if(SN!=null)SN.dispatchEvent(oN);}MO( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new oE(oE.TG,true);h.oK=new String.fromCharCodes([i]);if(SN!=null)SN.dispatchEvent(h);}} QF( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} LH(){var g=new XB.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} PH( h){if(RC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];h[g+0]=(h[g+0]*i)~/255;h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;h[g+3]=(h[g+3]*i)~/255;}}} WH( h){if(RC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];if(i>0){h[g+0]=(h[g+0]*255)~/i;h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;}}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];if(i>0){h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;h[g+3]=(h[g+3]*255)~/i;}}}}class QJ extends AB implements jB{final  EO;final  FO;final  GO=new List<eH>();var HO=0.0;var JO=0.0;var KO=0;var WL=0;QJ( g, j):EO=g,FO=g.xN(j){for(var h in FO.KE){var i=new eH(EO,h);GO.add(i);}WL=FO.LE;JO=WL/EO.RL;} qB( h){HO+= h;var i=HO%JO;KO=gB.min((WL*i/JO).toInt(),WL-1);for(var g in GO){g.qB(h);g.nF(KO);}return true;} QB( h){for(var g in GO){if(g.visible){h.mF(g);}}}} rD( g, m, q, j){var FB=0.0;var CB=0.0;var p=m*g.a;var v=m*g.b;var t=m*g.a+q*g.c;var o=m*g.b+q*g.d;var u=q*g.c;var n=q*g.d;var h=FB;if(h>p)h=p;if(h>t)h=t;if(h>u)h=u;var i=CB;if(i>v)i=v;if(i>o)i=o;if(i>n)i=n;var l=FB;if(l<p)l=p;if(l<t)l=t;if(l<u)l=u;var k=CB;if(k<v)k=v;if(k<o)k=o;if(k<n)k=n;if(j==null)j=new EB.lJ();j.x=g.eB+h;j.y=g.fB+i;j.width=l-h;j.height=k-i;return j;}var RC=LH();class eH extends AB implements jB{final  bC;final  JE;final  VE=new Map<String,WC>();var qC;eH( i, h):this.bC=i,this.JE=h{for(var g in h.EC){if(g.VC!=null&&VE.containsKey(g.VC)==false){VE[g.VC]=i.AO(g.VC);}}nF(0);} qB( g){if(qC is jB){var h=qC as jB;h.qB(g);}} nF( t){var g=JE.OI(t);var o=g.x,p=g.y;var n=g.mB,k=g.nB;var m=g.skewX,l=g.skewY;var v=g.lB,UB=g.sB;var q=g.alpha;if(g.index!=t&&g.rF){var i=JE.NI(g);if(i!=null){var h=(t-g.index)/g.duration;var j=g.YF;if(j!=0){var u=0.0;if(j<0){var FB=1-h;u=1-FB*FB;j=0-j;}else{u=h*h;}h=j*u+(1-j)*h;}o=o+(i.x-o)*h;p=p+(i.y-p)*h;n=n+(i.mB-n)*h;k=k+(i.nB-k)*h;m=m+(i.skewX-m)*h;l=l+(i.skewY-l)*h;q=q+(i.alpha-q)*h;}}var CB=n*gB.cos(l);var TB=n*gB.sin(l);var MB=-k*gB.sin(m);var NB=k*gB.cos(m);var ZB=o-(v*CB+UB*MB);var aB=p-(v*TB+UB*NB);wM=false;rM.TE(CB,TB,MB,NB,ZB,aB);PM=q;RM=g.visible;qC=(g.VC!=null)?VE[g.VC]:null;} QB( g){if(qC!=null){qC.QB(g);}}}class BE{final  id;final  bC;final  KE=new List<CE>();BE( g, j):bC=j,id=g["id"]{for(var h in g["layers"]){var i=new CE(h);this.KE.add(i);}} get LE{var g=0;for(var h in KE)g=gB.max(g,h.LE);return g;}}class CE{final  name;final  EI;final  EC=new List<FD>();CE( g):this.name=g["name"],this.EI=g.containsKey("flipbook")?g["flipbook"]:false{for(var i in g["keyframes"]){var h=new FD(i);this.EC.add(h);}} get LE{var g=EC[EC.length-1];return g.index+g.duration;} OI( h){var g=1;while (g<EC.length&&EC[g].index<=h)g++ ;return EC[g-1];} NI( h){for(int g=0;g<EC.length-1;g++ )if(identical(EC[g],h))return EC[g+1];return null;}}class FD{var index;var duration;var VC;var label;var x,y;var mB,nB;var skewX,skewY;var lB,sB;var visible;var alpha;var rF;var YF;FD( g){this.index=g["index"];this.duration=g["duration"];this.VC=g.containsKey("ref")?g["ref"]:null;this.label=g.containsKey("label")?g["label"]:null;this.x=g.containsKey("loc")?g["loc"][0]:0.0;this.y=g.containsKey("loc")?g["loc"][1]:0.0;this.mB=g.containsKey("scale")?g["scale"][0]:1.0;this.nB=g.containsKey("scale")?g["scale"][1]:1.0;this.skewX=g.containsKey("skew")?g["skew"][0]:0.0;this.skewY=g.containsKey("skew")?g["skew"][1]:0.0;this.lB=g.containsKey("pivot")?g["pivot"][0]:0.0;this.sB=g.containsKey("pivot")?g["pivot"][1]:0.0;this.visible=g.containsKey("visible")?g["visible"]:true;this.alpha=g.containsKey("alpha")?g["alpha"]:1.0;this.rF=g.containsKey("tweened")?g["tweened"]:true;this.YF=g.containsKey("ease")?g["ease"]:0.0;}}class rH{var bC;var ID;var HD;rH( p,this.bC){this.ID=new Map<String,sH>();this.HD=new VB.Completer();var k=0;for(var j in p["atlases"] as List){var n=j["file"] as String;var q=QF(bC.yK,n);k++ ;var g=new XB.ImageElement();g.onLoad.listen((o){if( --k==0)this.HD.complete(this);});g.onError.listen((o){this.HD.completeError(new StateError("Failed to load image."));});g.src=q;for(var i in j["textures"] as List){var m=i["symbol"] as String;var h=i["rect"] as List;var l=i["origin"] as List;var t=new sH(h[0],h[1],h[2],h[3],l[0],l[1],g);this.ID[m]=t;}}}}class sH implements WC{var x,y,width,height;var ZI,aI;var JD;sH(this.x,this.y,this.width,this.height,this.ZI,this.aI,this.JD); QB( g){g.context.drawImage(JD,x,y,width,height,0,0,width,height);}}//@ sourceMappingURL=dartflash_web.dart.map
