import "dart:async" as VB;import "dart:web_audio" as tF;import "dart:math" as gB;import "dart:html" as XB;import "dart:json" as sF;class sI{static const  tI="Chrome";static const  uI="Firefox";static const  vI="Internet Explorer";static const  wI="Safari";final  yH;final  YI;const sI(this.yH,[this.YI]);}class xI{final  name;const xI(this.name);}class yI extends WB{final  yJ=[{'name':'DropShadowFilter (black)','filter':new LJ(10,gB.PI/4,AC.BD,0.8,8,8)},{'name':'GlowFilter (red)','filter':new NJ(AC.SF,1.0,20,20)},{'name':'ColorMatrixFilter (grayscale)','filter':new QJ.sJ()},{'name':'ColorMatrixFilter (invert)','filter':new QJ.tJ()},{'name':'BlurFilter (radius 1)','filter':new KJ(1,1)},{'name':'BlurFilter (radius 5)','filter':new KJ(5,5)},{'name':'BlurFilter (radius 10)','filter':new KJ(10,10)},{'name':'BlurFilter (radius 20)','filter':new KJ(20,20)}];yI(){var m=new GB(940,500,true,0x000000);var k=RB.MC('king');var o=new GB(230,245,true,0xFFF0F0F0);var p=new zC(m);BB(p);for(int h=0;h<yJ.length;h++ ){var i=235*(h%4);var j=250*(h~/4);var q=yJ[h]['filter'] as WC;var t=yJ[h]['name'] as String;var u=new DB(0,0,k.width,k.height);var n=new IB(i+40,j+45);m.wH(k,u,n,q);var l=new zC(o);l.x=i;l.y=j;CE(l,0);var g=new JJ();g.TC=new kE('Helvetica Neue, Helvetica, Arial',14,AC.BD);g.x=i+5;g.y=j+5;g.width=200;g.text=t;BB(g);}}}class zI extends WB{final  xJ=new gB.Random();zI(){var g=new lE();g.lB=470;g.sB=250;g.x=470;g.y=250;BB(g);for(int h=0;h<150;h++ ){var v=1+xJ.nextInt(3);var p=RB.MC('flower${v}');var i=new zC(p);i.lB=64;i.sB=64;i.x=64+xJ.nextInt(940-128);i.y=64+xJ.nextInt(500-128);g.BB(i);var o=new BH(i,600,s.YC);o.kB('rotation',gB.PI*60.0);OB.add(o);}var k=new List<IB>();for(int h=0;h<6;h++ ){var n=(h*60)*gB.PI/180;var m=(h*60+30)*gB.PI/180;k.add(new IB(470+200*gB.cos(n),250+200*gB.sin(n)));k.add(new IB(470+100*gB.cos(m),250+100*gB.sin(m)));}var t=new VD.nJ(100,100,740,300);var u=new VD.qJ(470,250,200);var q=new VD.rJ(k);XB.query('#mask-none').onClick.listen((j)=>g.mask=null);XB.query('#mask-rectangle').onClick.listen((j)=>g.mask=t);XB.query('#mask-circle').onClick.listen((j)=>g.mask=u);XB.query('#mask-custom').onClick.listen((j)=>g.mask=q);XB.query('#mask-spin').onClick.listen((j){var l=new BH(g,2.0,s.TF);l.kB('rotation',gB.PI*4.0);l.onComplete=()=>g.pC=0.0;OB.add(l);});}}class CJ extends WB{var xJ=new gB.Random();var AK;var BK;CJ(){AK=RB.LE('walkTextureAtlas');BK=AK.LI('walk');EK();}EK(){var h=xJ.nextDouble();var g=new FG(BK,30);g.x=-128;g.y=20.0+180.0*h;g.mB=g.nB=0.5+0.5*h;g.play();BB(g);nI((k,j)=>(k.y-j.y).toInt());var i=new BH(g,5.0+(1.0-h)*5.0,s.YC);i.kB('x',940.0);i.onComplete=(){OB.remove(g);jF(g);};OB.add(g);OB.add(i);OB.WF(EK,0.2);}}class DJ extends zC implements iB{var OD,PD;DJ( g,this.OD,this.PD):super(g){this.lB=g.width/2;this.sB=g.height/2;} qB( i){var g=x+OD*i;var h=y+PD*i;if(g>910||g<30)OD=-OD;else x=g;if(h>470||h<30)PD=-PD;else y=h;return true;}}class GJ extends WB{final  zJ=['C4','A3','A3','C4','D4','G3','G3','A3','A3#','F4','F4','E4','C4','D4','C4','A3#','A3','C4','D4','D4','D4','G4','F4','E4','F4','D4','C4','F3','G3','A3','D4','C4','C4','A3#','A3','E3','F3'];final  DK=['Hey ','Jude, ',"don't ",'make ','it ','bad.<br>','Take ','a ','sad ','song ','and ','make ','it ','better.<br>','','','','Remember ','','','to ','let ','her ','into ','','your ','heart.<br>','Than ','you ','can ','start ','','to ','make ','things ','better.','',' '];GJ(){var h=new zC(RB.MC('Background'));BB(h);var g=new uF(zJ,DK);g.x=120;g.y=30;BB(g);XB.query('#startOver').onClick.listen((i)=>g.jI());}}class AJ extends WB{final  mI='''
Filet mignon leberkas pig pork chop biltong, short loin strip steak turkey brisket 
venison. Pastrami venison pancetta, leberkas pork chop chicken prosciutto beef ribs 
bresaola kielbasa swine biltong capicola. Hamburger beef ribs ball tip drumstick salami 
pig. Capicola pork loin shank, salami chicken hamburger tail. Sirloin spare ribs
ground round cow strip steak prosciutto swine bacon corned beef.''';AJ(){var k=mI.replaceAll('\r','').replaceAll('\n','');var j=new JJ();j.TC=new kE('Helvetica,Arial',14,AC.UH,GD:true,NE:true);j.text=k;j.x=10;j.y=10;j.width=920;j.height=20;BB(j);var h=new JJ();h.TC=new kE('Helvetica,Arial',16,AC.SF);h.text=k;h.x=10;h.y=50;h.width=200;h.height=300;h.wordWrap=true;BB(h);var g=new JJ();g.TC=new kE('Helvetica,Arial',16,AC.rG,align:PC.DF);g.text=k;g.x=300;g.y=50;g.width=200;g.height=300;g.wordWrap=true;BB(g);var i=new JJ();i.TC=new kE('Caesar Dressing',30,AC.BD,align:PC.XD);i.text=k;i.x=590;i.y=50;i.width=340;i.height=300;i.wordWrap=true;BB(i);}}class BJ extends WB{BJ(){var g=new JJ();g.TC=new kE('Helvetica,Arial',14,AC.JH,GD:true);g.text='ToDo: show a cool demo ...';g.x=10;g.y=10;g.width=920;g.height=20;BB(g);}}class EJ extends WB{EJ(){var k=RB.NI('flump');var i=new RJ(k,'idle');i.x=500;i.y=200;BB(i);var j=new RJ(k,'walk');j.x=150;j.y=460;BB(j);var g=new RJ(k,'attack');g.x=450;g.y=460;BB(g);var h=new RJ(k,'defeat');h.x=720;h.y=460;BB(h);OB.add(i);OB.add(j);OB.add(g);OB.add(h);GB.mD('images/flumpLibraryAtlas0.png').then((m){var l=new zC(m);l.x=40;l.y=40;BB(l);});}}class FJ extends WB{var AK;FJ(){AK=RB.LE('levelUp');CK();GB.mD('images/LevelupTextureAtlas.png').then((h){var g=new zC(h);g.x=70;g.y=40;BB(g);});}CK(){var l=330;for(int j=0;j<7;j++ ){var h=AK.MC('LevelUp${j}');var g=new zC(h);g.lB=h.width/2;g.sB=h.height/2;g.x=l+h.width/2;g.y=150;g.mB=0.0;g.nB=0.0;BB(g);var k=new BH(g,2.0,s.DD);k.kB('scaleX',1.0);k.kB('scaleY',1.0);k.VF=j*0.05;var i=new BH(g,0.4,s.YC);i.kB('scaleX',0.0);i.kB('scaleY',0.0);i.VF=2.0;i.onComplete=()=>g.RE();OB.add(k);OB.add(i);l=l+5+h.width;}OB.WF(()=>CK(),3.0);}}class HJ{final  wJ=[{"name":"linear","transition":s.YC},{"name":"sine","transition":s.MF},{"name":"cosine","transition":s.EH},{"name":"random","transition":s.HH},{"name":"easeInQuadratic","transition":s.gD},{"name":"easeOutQuadratic","transition":s.hD},{"name":"easeInOutQuadratic","transition":s.KH},{"name":"easeOutInQuadratic","transition":s.LH},{"name":"easeInCubic","transition":s.iD},{"name":"easeOutCubic","transition":s.jD},{"name":"easeInOutCubic","transition":s.RF},{"name":"easeOutInCubic","transition":s.RH},{"name":"easeInQuartic","transition":s.kD},{"name":"easeOutQuartic","transition":s.lD},{"name":"easeInOutQuartic","transition":s.VH},{"name":"easeOutInQuartic","transition":s.WH},{"name":"easeInQuintic","transition":s.nD},{"name":"easeOutQuintic","transition":s.oD},{"name":"easeInOutQuintic","transition":s.YH},{"name":"easeOutInQuintic","transition":s.ZH},{"name":"easeInCircular","transition":s.pD},{"name":"easeOutCircular","transition":s.rD},{"name":"easeInOutCircular","transition":s.aH},{"name":"easeOutInCircular","transition":s.bH},{"name":"easeInSine","transition":s.sD},{"name":"easeOutSine","transition":s.tD},{"name":"easeInOutSine","transition":s.dH},{"name":"easeOutInSine","transition":s.hH},{"name":"easeInExponential","transition":s.uD},{"name":"easeOutExponential","transition":s.vD},{"name":"easeInOutExponential","transition":s.iH},{"name":"easeOutInExponential","transition":s.jH},{"name":"easeInBack","transition":s.wD},{"name":"easeOutBack","transition":s.xD},{"name":"easeInOutBack","transition":s.TF},{"name":"easeOutInBack","transition":s.mH},{"name":"easeInElastic","transition":s.yD},{"name":"easeOutElastic","transition":s.DD},{"name":"easeInOutElastic","transition":s.nH},{"name":"easeOutInElastic","transition":s.pH},{"name":"easeInBounce","transition":s.zD},{"name":"easeOutBounce","transition":s.ED},{"name":"easeInOutBounce","transition":s.qH},{"name":"easeOutInBounce","transition":s.rH}]; RI(){var j=new XB.DivElement();for(int h=0;h<wJ.length/4;h++ ){var i=new XB.DivElement();i.classes.add("row");j.children.add(i);for(int g=0;g<4;g++ ){var m=wJ[h*4+g]["name"];var l=wJ[h*4+g]["transition"];var k=PK(m,l);k.id="cell";i.children.add(k);}}return j;} PK( o, q( ratio)){var h=new XB.DivElement();h.classes.add("span3");h.style.height="130px";var j=new XB.CanvasElement(width:200,height:140);j.style.position="absolute";j.style.zIndex="1";h.children.add(j);var i=new XB.DivElement();i.text=o;i.style.position="relative";i.style.zIndex="2";i.style.top="6px";h.children.add(i);var l=new lC("stage",j);var n=new OJ();var g=n.SI;g.beginPath();g.moveTo(0.5,30.5);g.lineTo(199.5,30.5);g.lineTo(199.5,109.5);g.lineTo(0.5,109.5);g.closePath();g.oF(0xFF000000);g.EI(0xFFDFDFDF);g.beginPath();g.moveTo(0.5,109.5);for(int k=0;k<=199;k++ ){var m=k/199.0;var p=0.5+m*199.0;var t=109.5-79.0*q(m);g.lineTo(p,t);}g.oF(0xFF0000FF,2);l.BB(n);l.aF();return h;}}var oB;var QD;var OB;var RB;class IJ extends WB{IJ(){FK(250);XB.query('#minus10').onClick.listen((g)=>GK(10));XB.query('#minus50').onClick.listen((g)=>GK(50));XB.query('#plus50').onClick.listen((g)=>FK(50));XB.query('#plus10').onClick.listen((g)=>FK(10));this.ZI.listen(HK);}var IK=null;HK( g){if(IK==null){IK=1.00/g.gF;}else{IK=0.05/g.gF+0.95*IK;}XB.query('#fpsMeter').innerHtml='fps: ${IK.round()}';}FK( l){var g=new gB.Random();var i=RB.LE('flags');var j=i.HI;while ( --l>=0){var k=j[g.nextInt(j.length)];var m=i.MC(k);var h=new DJ(m,g.nextInt(200)-100,g.nextInt(200)-100);h.x=30+g.nextInt(940-60);h.y=30+g.nextInt(500-60);BB(h);OB.add(h);}XB.query('#flagCounter').innerHtml='Flags: ${QE}';}GK( h){while ( --h>=0&&QE>0){var g=MI(0);g.RE();OB.remove(g);}XB.query('#flagCounter').innerHtml='Flags: ${QE}';}} main(){var l=XB.window.location.pathname;var m=new RegExp(r"([A-Za-z0-9-]+)\.html",multiLine:false,caseSensitive:false);var g=m.firstMatch(l);if(g!=null&&g.groupCount==1){var h=g.group(1);print("current page: ${h}");var i=XB.query("#stage");if(i!=null){oB=new lC('stage',i);QD=new CG();QD.vH(oB);OB=QD.WI;RB=new tE();}switch (h){case "filter":RB..pB('king','images/king.png')..load().then((KK)=>oB.BB(new yI()));break;case "masking":RB..pB('flower1','images/Flower1.png')..pB('flower2','images/Flower2.png')..pB('flower3','images/Flower3.png')..load().then((KK)=>oB.BB(new zI()));break;case "movieclip":RB..DE('walkTextureAtlas','images/walk.json',hC.AD)..load().then((KK)=>oB.BB(new CJ()));break;case "performance":RB..DE('flags','images/flags.json',hC.AD)..load().then((KK)=>oB.BB(new IJ()));break;case "sound":RB..pB('KeyBlack','images/piano/KeyBlack.png')..pB('KeyWhite0','images/piano/KeyWhite0.png')..pB('KeyWhite1','images/piano/KeyWhite1.png')..pB('KeyWhite2','images/piano/KeyWhite2.png')..pB('KeyWhite3','images/piano/KeyWhite3.png')..pB('Finger','images/piano/Finger.png')..pB('Background','images/piano/Background.jpg')..HB('Cheer','sounds/Cheer.mp3')..HB('Note1','sounds/piano/Note1.mp3')..HB('Note2','sounds/piano/Note2.mp3')..HB('Note3','sounds/piano/Note3.mp3')..HB('Note4','sounds/piano/Note4.mp3')..HB('Note5','sounds/piano/Note5.mp3')..HB('Note6','sounds/piano/Note6.mp3')..HB('Note7','sounds/piano/Note7.mp3')..HB('Note8','sounds/piano/Note8.mp3')..HB('Note9','sounds/piano/Note9.mp3')..HB('Note10','sounds/piano/Note10.mp3')..HB('Note11','sounds/piano/Note11.mp3')..HB('Note12','sounds/piano/Note12.mp3')..HB('Note13','sounds/piano/Note13.mp3')..HB('Note14','sounds/piano/Note14.mp3')..HB('Note15','sounds/piano/Note15.mp3')..HB('Note16','sounds/piano/Note16.mp3')..HB('Note17','sounds/piano/Note17.mp3')..HB('Note18','sounds/piano/Note18.mp3')..HB('Note19','sounds/piano/Note19.mp3')..HB('Note20','sounds/piano/Note20.mp3')..HB('Note21','sounds/piano/Note21.mp3')..HB('Note22','sounds/piano/Note22.mp3')..HB('Note23','sounds/piano/Note23.mp3')..HB('Note24','sounds/piano/Note24.mp3')..HB('Note25','sounds/piano/Note25.mp3')..load().then((KK)=>oB.BB(new GJ()));break;case "text":oB.BB(new AJ());break;case "tweener":oB.BB(new BJ());break;case "flump":RB..uH('flump','images/flumpLibrary.json')..load().then((KK)=>oB.BB(new EJ()));break;case "texturepacker":RB..DE('levelUp','images/LevelupTextureAtlas.json',hC.AD)..load().then((KK)=>oB.BB(new FJ()));break;case "transitions":var k=new HJ();var j=k.RI();XB.query("#transitions").children.add(j);break;}}}class uF extends WB{final  dC;final  cC;final  JK=['C3','C3#','D3','D3#','E3','F3','F3#','G3','G3#','A3','A3#','B3','C4','C4#','D4','D4#','E4','F4','F4#','G4','G4#','A4','A4#','B4','C5'];var LK=new Map<String,vF>();var MK;var NK=0;uF(this.dC,this.cC){for(int h=0,i=0;h<JK.length;h++ ){var k=RB.YF('Note${h+1}');var j=JK[h];var g=LK[j]=new vF(this,j,k);if(j.endsWith('#')){g.x=i-16;g.y=35;BB(g);}else{g.x=i;g.y=35;CE(g,0);i=i+47;}}MK=new zC(RB.MC('Finger'));MK.lB=20;BB(MK);OK();}zH( g){if(NK<dC.length&&dC[NK]==g){if(NK==dC.length-1)RB.YF('Cheer').play();NK++ ;OK();}}jI(){NK=0;MK.alpha=1;OK();}OK(){var h=XB.query('#lyrics');var m=-1;h.innerHtml='';for(int g=0,j=0;g<cC.length;g++ ){if(cC[g]!='')j=g;if(g==this.NK)m=j;}for(int g=0;g<cC.length;g++ ){if(g==m){h.appendHtml('<span id="word">${cC[g]}</span>');}else{h.appendHtml(cC[g]);}}if(NK<dC.length){var k=dC[NK];if(LK.containsKey(k)){var i=LK[k];OB.iI(MK);MK.y=0;var n=new BH(this.MK,0.4,s.RF);var l=new BH(this.MK,0.4,s.MF);n.kB('x',i.x+i.width/2);l.kB('y',-10);OB.add(n);OB.add(l);}}else{var o=new BH(MK,0.4,s.YC);o.kB('alpha',0);OB.add(o);}}}class vF extends lE{final  hF;final  dB;final  nF;vF(this.hF,this.dB,this.nF){var h;if(dB.endsWith('#')){h='KeyBlack';}else if(dB.startsWith('C5')){h='KeyWhite0';}else if(dB.startsWith('C')||dB.startsWith('F')){h='KeyWhite1';}else if(dB.startsWith('D')||dB.startsWith('G')||dB.startsWith('A')){h='KeyWhite2';}else if(dB.startsWith('E')||dB.startsWith('B')){h='KeyWhite3';}var i=RB.MC(h);var l=new zC(i);this.BB(l);var j=dB.endsWith('#')?AC.oH:AC.BD;var k=new kE('Helvetica,Arial',10,j,align:PC.XD);var g=new JJ();g.TC=k;g.text=dB;g.width=i.width;g.height=20;g.eF=false;g.y=i.height-20;BB(g);this.XE=true;this.onMouseDown.listen(QK);this.onMouseOver.listen(QK);this.onMouseUp.listen(RK);this.onMouseOut.listen(RK);}QK( g){if(g.JC){this.nF.play();this.alpha=0.7;this.hF.zH(this.dB);}}RK( g){this.alpha=1.0;}}class IC{var hK; TI( g){if(hK!=null)return hK.containsKey(g)||hK.containsKey("${g}_CAPTURE");else return false;} dispatchEvent( g){mN(g,this,this,zB.QC);} mN( g, k, l, i){if(hK!=null){var j=(i==zB.qE)?"${g.type}_CAPTURE":g.type;var h=hK[j];if(h!=null){g.FL=k;g.gN=l;g.ZN=i;g.iN=false;g.kN=false;h.YN(g);}}} KM( g, j){if(hK==null)hK=new Map<String,eC>();var i=j?"${g}_CAPTURE":g;var h=hK[i];if(h==null)h=hK[i]=new eC(this,g,j);return h;}}class RD{static var pE=hB.WD;static var PG=false;static var bG=new VB.StreamController<String>();static var fG=bG.stream.asBroadcastStream();static  QF( i){var h=i;var g="auto";if(pE!=hB.WD)h=pE;switch (h){case hB.WD:g="auto";break;case hB.ZD:g="default";break;case hB.aD:g="pointer";break;case hB.cG:g="move";break;case hB.dG:g="text";break;case hB.gG:g="wait";break;}if(PG)g="none";return g;}}class BG{static const  OG="round";}class GG extends JB{GG();}class zF{static const  JG="dynamic";}class VC{static const  IG=0;static const  NG=1;static const  DF=2;static const  aG=3;static const  AF=4;}class mE{var xH;var AI;var height;var PE;var width;var x;mE(this.x,this.width,this.height,this.xH,this.AI,this.PE);}class nE implements iB{final  rK;var CL=0.0;var QL=0.0;var dL=1;nE( g, h):rK=g{QL=gB.max(h,0.0001);} qB( h){var g=CL+h;while (g>=QL&&dL>0){CL=QL;dL-- ;rK();g-= QL;}CL=g;return (dL>0);} get currentTime=>CL;}abstract class iB{ qB( g);}class UD implements iB{final  vK=new List<iB>();var XL=0;var jL=0.0; add( g){if(g==null)return;if(XL==vK.length){vK.add(g);}else{vK[XL]=g;}XL++ ;} remove( h){if(h==null)return;for(int g=0;g<XL;g++ ){if(vK[g]==h){vK[g]=null;break;}}} iI( i){if(i==null)return;for(int g=0;g<XL;g++ ){var h=vK[g];if(h!=null&&h is BH){if(h.BI==i){vK[g]=null;}}}} WF( h, i){var g=new nE(h,i);add(g);return g;} qB( k){jL+= k;var j=XL;var h=0;for(int g=0;g<j;g++ ){var i=vK[g];if(i==null)continue;if(i.qB(k)==false){vK[g]=null;continue;}if(h!=g){vK[h]=i;vK[g]=null;}h++ ;}if(h!=j){for(int g=j;g<XL;g++ ){vK[h++ ]=vK[g];vK[g]=null;}XL=h;}return true;}}class xF{static const  UG="none";}class yF{var name;var tB;var pF;yF(this.name,this.tB,this.pF);}class kE{var font;var size;var color;var GD;var NE;var qI;var align;var XI;var kI;var VI;var PE;var letterSpacing=0;var TJ=0;var UJ=false;var fJ=false;kE(this.font,this.size,this.color,{this.GD: false,this.NE: false,this.qI: false,this.align: "left",this.XI: 0,this.kI: 0,this.VI: 0,this.PE: 0});}class IB{var x;var y;IB(this.x,this.y);IB.mJ():this(0,0); get length=>gB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new IB(this.x+g.x,this.y+g.y); GE( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class DB{var x;var y;var width;var height;DB(this.x,this.y,this.width,this.height);DB.mJ():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new IB(this.width,this.height); set top( g){this.y=g;} contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); GE( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;} rF( g){var i=gB.min(this.left,g.left);var j=gB.min(this.top,g.top);var h=gB.max(this.right,g.right);var k=gB.max(this.bottom,g.bottom);return new DB(i,h,h-i,k-j);}}class EG{var x;var y;var iF;EG(this.x,this.y,this.iF);}class PB{var TK,UK,VK,XK,ZK,cK;var jK;PB.pJ():TK=1.0,UK=0.0,VK=0.0,XK=1.0,ZK=0.0,cK=0.0,jK=1.0; get a=>TK; get b=>UK; get c=>VK; get d=>XK; get eB=>ZK; get fB=>cK; get ZC=>jK; pI( g){return new IB(g.x*TK+g.y*VK+ZK,g.x*UK+g.y*XK+cK);} concat( g){var m=TK;var p=UK;var q=VK;var o=XK;var l=ZK;var n=cK;var u=jK;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var v=g.eB;var t=g.fB;var CB=g.ZC;TK=(m*j+p*i);UK=(m*k+p*h);VK=(q*j+o*i);XK=(q*k+o*h);ZK=(l*j+n*i+v);cK=(l*k+n*h+t);jK=(u*CB);} UI(){TK=1.0;UK=0.0;VK=0.0;XK=1.0;ZK=0.0;cK=0.0;jK=1.0;} ZF(){var j=TK;var m=UK;var l=VK;var k=XK;var h=ZK;var i=cK;var g=jK;TK=(k/g);UK=-(m/g);VK=-(l/g);XK=(j/g);ZK=-(TK*h+VK*i);cK=-(UK*h+XK*i);jK=(1.0/g);} SE( h, i, g, j, k, l){TK=h;UK=i;VK=g;XK=j;ZK=k;cK=l;jK=(h*j-i*g);} GE( g){TK=g.a;UK=g.b;VK=g.c;XK=g.d;ZK=g.eB;cK=g.fB;jK=g.ZC;} UF( h, g){var n=h.a;var q=h.b;var t=h.c;var p=h.d;var m=h.eB;var o=h.fB;var v=h.ZC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var CB=g.eB;var u=g.fB;var FB=g.ZC;TK=(n*k+q*j);UK=(n*l+q*i);VK=(t*k+p*j);XK=(t*l+p*i);ZK=(m*k+o*j+CB);cK=(m*l+o*i+u);jK=(v*FB);}}class oE{static const  UG="none";static const  ZG="touchPoint";}class YB{final  iK;final  IL=new List<PB>(100);final  kL=new List<double>(100);var yL=0;YB.oJ( j,[ matrix]):iK=j{for(int h=0;h<100;h++ ){IL[h]=new PB.pJ();kL[h]=1.0;}if(matrix!=null)IL[0].GE(matrix);var g=IL[0];var i=kL[0];iK.setTransform(g.a,g.b,g.c,g.d,g.eB,g.fB);iK.globalAlpha=i;} get context=>iK; reset(){yL=0;var g=IL[0];var h=kL[0];iK.setTransform(g.a,g.b,g.c,g.d,g.eB,g.fB);iK.globalAlpha=h;iK.clearRect(0,0,iK.canvas.width,iK.canvas.height);} lF( h){var i=yL;var j=yL+1;var l=IL[i];var g=IL[j];var m=kL[i];var k=kL[j]=h.QM*m;g.UF(h.xN,l);iK.setTransform(g.a,g.b,g.c,g.d,g.eB,g.fB);iK.globalAlpha=k;yL=j;if(h.mask==null){h.QB(this);}else{iK.save();h.mask.QB(this);h.QB(this);iK.restore();}yL=i;}}class iC{static const  WD="auto";static const  RG="stop";static const  wE="once";}class EB{static const  MG="added";static const  WG="addedToStage";static const  bD="enterFrame";static const  eG="removed";static const  iG="removedFromStage";static const  zG="complete";static const  NF="progress";var SK;var WN;var ZN;var FL;var gN;var iN;var kN;EB( g,[ bubbles=false]){AN(g,bubbles);} AN( g,[ bubbles=false]){SK=g;WN=bubbles;ZN=zB.QC;FL=null;gN=null;iN=false;kN=false;} get TE=>iN; get type=>SK; get bubbles=>WN; get EE=>true; get target=>FL;}class zB{static const  qE=1;static const  QC=2;static const  XG=3;}class gC{static var lG=DH();static var CD=NH();static var JF=PH();static  DH(){var h=(CD!=null)?"WebAudioApi":"AudioElement";var g=XB.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(JF.length==0)h="Mock";print("dartflash: supported audio engine is: ${h}");return h;}static  NH(){try {return new tF.AudioContext();}catch (g){return null;}}static  PH(){var g=new List<String>();var h=new XB.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("dartflash: supported audio types are: ${g}");return g;}}class xC<jC extends EB>{final  hK;var NL=0;xC():hK=new List<eC>();static var IF=new xC<fC>(); tM( g){for(int h=0;h<NL;h++ )if(hK[h]==g)return;if(NL==hK.length)hK.add(g);else hK[NL]=g;NL++ ;} YN( j){j.ZN=zB.QC;j.iN=false;j.kN=false;var k=NL;var i=0;for(int g=0;g<k;g++ ){var h=hK[g];if(h==null)continue;if(h.RM==0){hK[g]=null;continue;}j.FL=h.FL;j.gN=h.FL;h.YN(j);if(i!=g){hK[i]=h;hK[g]=null;}i++ ;}if(i!=k){for(int g=k;g<NL;g++ ){hK[i++ ]=hK[g];hK[g]=null;}NL=i;}}}class eC<jC extends EB> extends VB.Stream<jC>{final  FL;final  tK;final  hL;final  AM=new List<LG>();var RM=0;eC(this.FL,this.tK,this.hL); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new LG<jC>(this,h);if(RM==AM.length)AM.add(g);else AM[RM]=g;RM++ ;if(tK==EB.bD&&hL==false)xC.IF.tM(this);return g;} vM( h){for(int g=0;g<RM;g++ ){if(AM[g]==h){AM[g]=null;break;}}} YN( k){var j=RM;var h=0;for(int g=0;g<j;g++ ){var i=AM[g];if(i==null)continue;i.DM(k);if(h!=g){AM[h]=i;AM[g]=null;}h++ ;}if(h!=j){for(int g=j;g<RM;g++ ){AM[h++ ]=AM[g];AM[g]=null;}RM=h;}}}class cB<jC extends EB>{final  tK;const cB(this.tK); forTarget( g,{ useCapture: false}){return g.KM(tK,useCapture);}}class JJ extends JB{var pK="";var AL=0x000000;var VL=null;var nL=xF.UG;var EM=AG.QG;var SK=zF.JG;var TM=false;var XM=false;var YM=0x000000;var dM=false;var hM=0x000000;var kM=0;var nM=0;var pM;var uM;var wM=true;var yM=100;var zM=100;var BN=null;var iK=null;JJ(){VL=new kE("Arial",12,0x000000);pM=new List<String>();uM=new List<mE>();} get type=>SK; get width=>yM; get height=>zM; set text( g){pK=g;wM=true;} set TC( g){VL=g;AL=VL.color;wM=true;} set wordWrap( g){TM=g;wM=true;} set width( g){yM=g;wM=true;} set height( g){zM=g;wM=true;} FC( g,[ returnRectangle]){return qD(g,yM,zM,returnRectangle);} NC( g, h){if(g>=0&&h>=0&&g<yM&&h<zM)return this;return null;} QB( g){OO();g.iK.drawImage(BN,0.0,0.0);} PO(){pM.clear();uM.clear();if(TM==false){pM.add(pK);}else{for(String n in pK.replaceAll('\r','').split('\n')){var h=new StringBuffer();var i=0;var g="";for(String j in n.split(' ')){i=h.length;h.write((i>0)?" ${j}":j);g=h.toString();if(iK.measureText(g).width>yM){if(i>0){g=g.substring(0,i);}else{j="";}pM.add(g);h=new StringBuffer();h.write(j);}}if(h.isEmpty==false){pM.add(h.toString());}}}kM=0;nM=0;for(String g in pM){var l=iK.measureText(g);var m=0;if(VL.align==PC.XD||VL.align==PC.YG)m=(yM-l.width)/2;if(VL.align==PC.DF||VL.align==PC.SG)m=yM-l.width;var k=new mE(m,l.width,VL.size,0,0,0);uM.add(k);kM=gB.max(kM,k.width);nM=nM+k.height;}} OO(){if(wM){wM=false;var j=yM.ceil().toInt();var i=zM.ceil().toInt();if(BN==null){BN=new XB.CanvasElement(width:j,height:i);iK=BN.context2d;}if(BN.width!=j)BN.width=j;if(BN.height!=i)BN.height=i;var g=new StringBuffer();g.write(VL.NE?"italic ":"normal ");g.write("normal ");g.write(VL.GD?"bold ":"normal ");g.write("${VL.size}px ");g.write("${VL.font},sans-serif");iK.font=g.toString();iK.textAlign="start";iK.textBaseline="top";iK.fillStyle=kC(AL);PO();if(XM){iK.fillStyle=kC(YM);iK.fillRect(0,0,yM,zM);}else{iK.clearRect(0,0,yM,zM);}var k=0;for(int h=0;h<pM.length;h++ ){var l=uM[h];iK.fillStyle=kC(AL);iK.fillText(pM[h],l.x,k);k+= l.height;}if(dM){iK.strokeStyle=kC(hM);iK.lineWidth=1;iK.strokeRect(0,0,yM,zM);}}}}class fC extends EB{var dK;fC( g):super(EB.bD,false){dK=g;} get gF=>dK; get EE=>false;}class w extends EB{static const  sE="click";static const  VG="doubleClick";static const  xE="mouseDown";static const  CF="mouseUp";static const  FF="mouseMove";static const  GF="mouseOut";static const  HF="mouseOver";static const  oG="mouseWheel";static const  KF="middleClick";static const  tG="middleMouseDown";static const  vG="middleMouseUp";static const  LF="rightClick";static const  AH="rightMouseDown";static const  FH="rightMouseUp";var JN,KN;var MN,NN;var rN;var ZM;var mM;var cM;var eM;var tN;var uN;var vN;w( g,[ bubbles=false]):super(g,bubbles){AN(g,bubbles);} AN( g,[ bubbles=false]){super.AN(g,bubbles);JN=KN=0;MN=NN=0;rN=false;ZM=false;mM=false;cM=false;eM=false;tN=0;uN=0;vN=0;}set wN( g){JN=g.x;KN=g.y;}set zN( g){MN=g.x;NN=g.y;} get JC=>rN; get altKey=>ZM; get ctrlKey=>cM; get shiftKey=>eM; get mC=>tN;}class BC extends EB{static const  YD="keyDown";static const  uE="keyUp";var ZM;var cM;var eM;var gM;var mM;var oM;var qM;var sM;BC( g,[ bubbles=false]):super(g,bubbles){AN(g,bubbles);} AN( g,[ bubbles=false]){super.AN(g,bubbles);ZM=false;cM=false;eM=false;gM=false;mM=false;oM=0;qM=0;sM=0;} get altKey=>ZM; get ctrlKey=>cM; get shiftKey=>eM; get charCode=>oM; get keyCode=>qM; get keyLocation=>sM;}class jE extends EB{static const  TG="textInput";var pK="";jE( g,[ bubbles=false]):super(g,bubbles){}}class SB extends EB{static const  rE="touchBegin";static const  vE="touchEnd";static const  yE="touchCancel";static const  EF="touchMove";static const  jG="touchOver";static const  kG="touchOut";var GN;var HN;var JN,KN;var MN,NN;var ZM;var mM;var cM;var eM;var RN;var UN;var VN;SB( g,[ bubbles=false]):super(g,bubbles){AN(g,bubbles);} AN( g,[ bubbles=false]){super.AN(g,bubbles);GN=0;HN=false;JN=KN=0;MN=NN=0;ZM=false;mM=false;cM=false;eM=false;RN=1.00;UN=0;VN=0;}set wN( g){JN=g.x;KN=g.y;}set zN( g){MN=g.x;NN=g.y;} get ND=>GN; get altKey=>ZM; get ctrlKey=>cM; get shiftKey=>eM;}abstract class WC{ apply( h, i, j, g);}class KJ extends WC{var KB;var LB;KJ([this.KB=4,this.LB=4]){if(KB<1||LB<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(KB>128||LB>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} apply( KC, q, LC, uB){var GC=KC.lN();var MB=GC.getImageData(q.x,q.y,q.width,q.height);var vB=MB.data;var v=MB.width;var wB=MB.height;var ZB=KB*KB;var xB=LB*LB;var l=KB;var yB=KB*2;var u=LB;var aB=LB*2;var NB=v+yB;var CB=wB+aB;var HC=v*4;var FB=NB*4;var TB=LC.lN();var UB=TB.createImageData(NB,CB);var t=UB.data;var j=new List<int>(1024);QH(vB);for(int i=0;i<4;i++ ){for(int h=0;h<v;h++ ){var k=0,n=xB>>1;var m=h*4+i;var o=(h+l)*4+i;for(int g=0;g<CB;g++ ){t[o]=n~/xB;o+= FB;if(g>=aB){k-= 2*j[g&1023]-j[(g-u)&1023];}else if(g>=u){k-= 2*j[g&1023];}var p=(g<wB)?vB[m]:0;j[(g+u)&1023]=p;n+= k+= p;m+= HC;}}}for(int i=0;i<4;i++ ){for(int g=0;g<CB;g++ ){var k=0,n=ZB>>1;var m=g*FB+l*4+i;var o=g*FB+i;for(int h=0;h<NB;h++ ){t[o]=n~/ZB;o+= 4;if(h>=yB){k-= 2*j[h&1023]-j[(h-l)&1023];}else if(h>=l){k-= 2*j[h&1023];}var p=(h<v)?t[m]:0;j[(h+l)&1023]=p;n+= k+= p;m+= 4;}}}XH(t);TB.putImageData(UB,uB.x-l,uB.y-u);}}class QJ extends WC{final  uK;QJ.sJ():uK=[0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0,0,0,1,0];QJ.tJ():uK=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]; apply( KC, m, LC, GC){var q=KC.lN().getImageData(m.x,m.y,m.width,m.height);var h=q.data;var uB=(uK[00]*65536).toInt();var UB=(uK[01]*65536).toInt();var HC=(uK[02]*65536).toInt();var p=(uK[03]*65536).toInt();var xB=(uK[04]*65536).toInt();var vB=(uK[05]*65536).toInt();var TB=(uK[06]*65536).toInt();var wB=(uK[07]*65536).toInt();var v=(uK[08]*65536).toInt();var n=(uK[09]*65536).toInt();var t=(uK[10]*65536).toInt();var u=(uK[11]*65536).toInt();var aB=(uK[12]*65536).toInt();var yB=(uK[13]*65536).toInt();var FB=(uK[14]*65536).toInt();var CB=(uK[15]*65536).toInt();var ZB=(uK[16]*65536).toInt();var MB=(uK[17]*65536).toInt();var o=(uK[18]*65536).toInt();var NB=(uK[19]*65536).toInt();if(RC){for(int g=0;g<=h.length-4;g+= 4){var k=h[g+0];var l=h[g+1];var j=h[g+2];var i=h[g+3];h[g+0]=((uB*k)+(UB*l)+(HC*j)+(p*i)+xB)~/65536;h[g+1]=((vB*k)+(TB*l)+(wB*j)+(v*i)+n)~/65536;h[g+2]=((t*k)+(u*l)+(aB*j)+(yB*i)+FB)~/65536;h[g+3]=((CB*k)+(ZB*l)+(MB*j)+(o*i)+NB)~/65536;}}else{for(int g=0;g<=h.length-4;g+= 4){var i=h[g+0];var j=h[g+1];var l=h[g+2];var k=h[g+3];h[g+0]=((CB*k)+(ZB*l)+(MB*j)+(o*i)+NB)~/65536;h[g+1]=((t*k)+(u*l)+(aB*j)+(yB*i)+FB)~/65536;h[g+2]=((vB*k)+(TB*l)+(wB*j)+(v*i)+n)~/65536;h[g+3]=((uB*k)+(UB*l)+(HC*j)+(p*i)+xB)~/65536;}}LC.lN().putImageData(q,GC.x,GC.y);}}class LJ extends WC{var HE;var angle;var color;var alpha;var KB;var LB;var UE;var ME;var OE;var nC;LJ([this.HE=4.0,this.angle=gB.PI/4,this.color=0,this.alpha=1.0,this.KB=4,this.LB=4,this.UE=1.0,this.ME=false,this.OE=false,this.nC=false]){if(KB<1||LB<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(KB>128||LB>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} apply( YE, n, ZE, TB){var rC=YE.lN();var aE=rC.getImageData(n.x,n.y,n.width,n.height);var bE=aE.data;var p=n.width;var aB=n.height;var uB=KB*KB;var xB=LB*LB;var o=KB;var sC=KB*2;var UB=LB;var LC=LB*2;var MB=p+sC;var FB=aB+LC;var cE=p*4;var ZB=MB*4;var CB=RC?3:0;var q=ZE.lN();var tC=q.createImageData(MB,FB);var h=tC.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){var m=0,u=xB>>1;var t=j*4+CB;var v=(j+o)*4+CB;for(int i=0;i<FB;i++ ){h[v]=u~/xB;v+= ZB;if(i>=LC){m-= 2*l[i&1023]-l[(i-UB)&1023];}else if(i>=UB){m-= 2*l[i&1023];}var k=(i<aB)?bE[t]:0;l[(i+UB)&1023]=k;u+= m+= k;t+= cE;}}for(int i=0;i<FB;i++ ){var m=0,u=uB>>1;var t=i*ZB+o*4+CB;var v=i*ZB+CB;for(int j=0;j<MB;j++ ){h[v]=u~/uB;v+= 4;if(j>=sC){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}var k=(j<p)?h[t]:0;l[(j+o)&1023]=k;u+= m+= k;t+= 4;}}var yB=(alpha*256).toInt();var vB=(color>>16)&0xFF;var wB=(color>>8)&0xFF;var uC=(color>>0)&0xFF;if(RC){for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=vB;h[g+1]=wB;h[g+2]=uC;h[g+3]=(h[g+3]*yB)~/256;}}}else{for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=(h[g+0]*yB)~/256;h[g+1]=uC;h[g+2]=wB;h[g+3]=vB;}}}var KC=TB.x;var HC=TB.y;var GC=TB.x-o+(this.HE*gB.cos(this.angle)).round().toInt();var vC=TB.y-UB+(this.HE*gB.sin(this.angle)).round().toInt();var dE=new DB(KC,HC,p,aB);var eE=new DB(GC,vC,MB,FB);var NB=dE.rF(eE);q.setTransform(1,0,0,1,0,0);q.clearRect(NB.x,NB.y,NB.width,NB.height);q.putImageData(tC,GC,vC);if(this.nC==false)q.drawImage(rC.canvas,KC,HC);}}class CG{var WK;var lK;var wK;var RL;var iL;CG(){WK=new UD();lK=new List<lC>();wK=double.NAN;RL=xC.IF;iL=new fC(0);XB.window.requestAnimationFrame(jM);} get WI=>WK; jM( g){XB.window.requestAnimationFrame(jM);if(wK.isNaN)wK=g;if(wK>g)wK=g;var j=g-wK;var i=j/1000.0;if(j>=1){wK=g;iL.dK=i;RL.YN(iL);WK.qB(i);for(int h=0;h<lK.length;h++ ){var k=lK[h];k.aF();}}} vH( g){lK.add(g);}}abstract class AB extends IC implements XC{var ML=0.0;var TL=0.0;var aL=0.0;var mL=0.0;var tL=1.0;var BM=1.0;var JM=0.0;var QM=1.0;var SM=true;var UM=null;var YK="";var bM=null;final  fM=new PB.pJ();final  lM=new PB.pJ();final  rM=new PB.pJ();var xM=true;static const  OH=const cB<fC>(EB.bD); get ZI=>AB.OH.forTarget(this); get x=>ML; get y=>TL; get lB=>aL; get sB=>mL; get mB=>tL; get nB=>BM; get pC=>JM; get alpha=>QM; get visible=>SM; get mask=>UM; get name=>YK; get parent=>bM; get root{var g=this;while (g.bM!=null)g=g.bM;return g;} get MD{var g=this.root;if(g is lC)return g;return null;}set x( g){ML=g;xM=true;}set y( g){TL=g;xM=true;}set lB( g){aL=g;xM=true;}set sB( g){mL=g;xM=true;}set mB( g){tL=g;xM=true;}set nB( g){BM=g;xM=true;}set pC( g){JM=g;xM=true;}set alpha( g){QM=g;xM=true;}set visible( g){SM=g;xM=true;}set mask( g){UM=g;} get width=>FC(xN).width; get height=>FC(xN).height; set width( h){this.mB=1;var g=this.width;this.mB=(g!=0.0)?h/g:1.0;} set height( h){this.nB=1;var g=this.height;this.nB=(g!=0.0)?h/g:1.0;} RE(){if(bM!=null)bM.jF(this);} get xN{if(xM){xM=false;if(JM==0.0){rM.SE(tL,0.0,0.0,BM,ML-aL*tL,TL-mL*BM);}else{var g=gB.cos(JM);var h=gB.sin(JM);var i=tL*g;var l=tL*h;var k=-BM*h;var j=BM*g;var m=ML-aL*i-mL*k;var n=TL-aL*l-mL*j;rM.SE(i,l,k,j,m,n);}}return rM;} FC( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new DB.mJ();returnRectangle.x=g.eB;returnRectangle.y=g.fB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} NC( g, h){if(FC(lM).contains(g,h))return this;return null;} bC( h){fM.UI();for(AB g=this;g!=null;g=g.bM)fM.concat(g.xN);fM.ZF();return fM.pI(h);} dispatchEvent( h){var g=null;if(h.EE||h.bubbles)for(AB j=bM;j!=null;j=j.bM)if(j.TI(h.type)){if(g==null)g=new List<AB>();g.add(j);}if(h.EE&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.TE==false)g[i].mN(h,this,g[i],zB.qE);if(h.TE==false)mN(h,this,this,zB.QC);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.TE==false)g[i].mN(h,this,g[i],zB.XG);} AO( h){for(var g=h;g!=null;g=g.bM)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");bM=h;} QB( g);}abstract class JB extends AB{var CI=false;var eF=true;var lJ=true;var tabIndex=0;static const  hG=const cB<w>(w.GF);static const  nG=const cB<w>(w.HF);static const  uG=const cB<w>(w.FF);static const  xG=const cB<w>(w.xE);static const  GH=const cB<w>(w.CF);static const  TH=const cB<w>(w.oG); get onMouseOut=>JB.hG.forTarget(this); get onMouseOver=>JB.nG.forTarget(this); get onMouseMove=>JB.uG.forTarget(this); get onMouseDown=>JB.xG.forTarget(this); get onMouseUp=>JB.GH.forTarget(this); get onMouseWheel=>JB.TH.forTarget(this);static const  cH=const cB<SB>(SB.EF);static const  eH=const cB<SB>(SB.vE);static const  gH=const cB<SB>(SB.yE); get onTouchMove=>JB.cH.forTarget(this); get onTouchEnd=>JB.eH.forTarget(this); get onTouchCancel=>JB.gH.forTarget(this);static const  kH=const cB<BC>(BC.uE);static const  lH=const cB<BC>(BC.YD); get onKeyUp=>JB.kH.forTarget(this); get onKeyDown=>JB.lH.forTarget(this);}abstract class WB extends JB{final  PL=new List<AB>();var lL=true;var xL=true; get QE=>PL.length; BB( g){if(g.parent==this){var h=PL.indexOf(g);PL.removeAt(h);PL.add(g);}else{CE(g,PL.length);}} CE( g, h){if(h<0&&h>PL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){PL.removeAt(PL.indexOf(g));if(h>PL.length)h-- ;PL.insertRange(h,1,g);}else{g.RE();g.AO(this);PL.insertRange(h,1,g);g.dispatchEvent(new EB(EB.MG,true));if(this.MD!=null)CO(g,new EB(EB.WG));}} jF( h){var g=PL.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");hI(g);} hI( g){if(g<0&&g>=PL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=PL[g];h.dispatchEvent(new EB(EB.eG,true));if(this.MD!=null)CO(h,new EB(EB.iG));h.AO(null);PL.removeAt(g);} MI( g){if(g<0&&g>=PL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return PL[g];} nI( g){PL.sort(g);} contains( g){for(;g!=null;g=g.bM)if(g==this)return true;return false;} FC( n,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new DB.mJ();if(PL.length==0)return super.FC(n,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var o=PL.length;for(int l=0;l<PL.length;l++ ){var m=PL[l];fM.UF(m.xN,n);var g=m.FC(fM,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} NC( o, p){var l=null;for(int j=PL.length-1;j>=0;j-- ){var i=PL[j];if(i.visible){var g=i.xN;var m=o-g.eB;var k=p-g.fB;var q=(g.d*m-g.c*k)/g.ZC;var n=(g.a*k-g.b*m)/g.ZC;var h=i.NC(q,n);if(h!=null){if(h is JB)if(h.eF)return lL?h:this;l=this;}}}return l;} QB( i){for(int g=0;g<PL.length;g++ ){var h=PL[g];if(h.visible)i.lF(h);}} CO( g, j){g.dispatchEvent(j);if(g is WB){var i=new List<AB>.from(g.PL);for(int h=0;h<i.length;h++ )CO(i[h],j);}}}class fE{var target=null;var JC=false;var FE=0;var mC=0;var dF,fF;var bF,cF;fE(this.dF,this.fF,this.bF,this.cF);}class AG{static const  QG="pixel";}class MJ extends OC{var kK;var DL;MJ( i, h, g){kK=h;DL=g;}set LD( g){DL=g;} stop(){}}class lE extends WB{var VJ=false;var XE=false;}class hB{static const  WD="auto";static const  ZD="arrow";static const  aD="button";static const  cG="hand";static const  dG="ibeam";static const  gG="wait";}class hE extends jB{hE(){}static  mD( g){return new VB.Future<jB>.of(()=>new hE());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new bB();}return new MJ(this,loop,soundTransform);}}abstract class XC{ QB( g);}class FG extends JB implements iB{var JL;var SL;var cL;var oL;var vL;var kK;var GM;var OM;var SC;FG( g,[ frameRate=30, loop=true]){JL=g;SL=frameRate;cL=0;oL=null;vL=false;kK=loop;GM=new EB(EB.NF);OM=new EB(EB.zG);SC=null;}static const  IH=const cB<EB>(EB.NF); get onProgress=>FG.IH.forTarget(this); get WE=>JL.length; set loop( g){kK=g;} play(){vL=true;oL=null;} stop(){vL=false;oL=null;} qB( j){if(vL==false)return true;if(oL==null){oL=0.0;mN(GM,this,this,zB.QC);}else{oL+= j;var i=1.0/SL;while (vL&&oL>=i){var h=cL;var g=kK?(h+1)%WE:gB.min(h+1,WE-1);cL=g;oL-= i;if(h!=g){mN(GM,this,this,zB.QC);if(cL!=g)return true;}if(h!=g&&g==WE-1&&kK==false){mN(OM,this,this,zB.QC);if(cL!=g)return true;}}}return true;} FC( h,[ returnRectangle]){var g=JL[cL];return qD(h,g.width,g.height,returnRectangle);} NC( g, h){var i=JL[cL];if(g>=0&&h>=0&&g<i.width&&h<i.height)return this;return null;} QB( g){var h=JL[cL];if(SC==null)h.QB(g);else h.kF(g,SC);}}class PC{static const  XD="center";static const  SG="end";static const  YG="justify";static const  DF="right";}class wC{var bK;var YK;var zK;var LL;var WL;var fL;wC( g, h, i){bK=g;YK=h;zK=i;WL=null;fL=null;} get kind=>bK; get name=>YK; get oC=>fL; get error=>WL;CN( i){LL=i.then((g){fL=g;WL=null;},onError:( h){fL=null;WL=h.error;});}}class CC{final  eK=new XB.ImageElement();final  YL=new List<iE>();static  mD( m, u){var l=new VB.Completer<CC>();var j=new CC();switch (u){case hC.KG:case hC.AD: n( k, g){var q=CH(k);var h=new iE(q,j);h.EL=g["frame"]["x"].toInt();h.OL=g["frame"]["y"].toInt();h.UL=g["frame"]["w"].toInt();h.eL=g["frame"]["h"].toInt();h.pL=g["spriteSourceSize"]["x"].toInt();h.uL=g["spriteSourceSize"]["y"].toInt();h.zL=g["sourceSize"]["w"].toInt();h.IM=g["sourceSize"]["h"].toInt();h.PM=g["rotated"] as bool;j.YL.add(h);}XB.HttpRequest.getString(m).then((t){var o=sF.parse(t);var i=o["frames"];var p=o["meta"];if(i is List)for(var g in i)n(g["filename"],g);if(i is Map)for(String k in i.keys)n(k,i[k]);j.eK..onLoad.listen((v)=>l.complete(j))..onError.listen((v)=>l.completeError(new StateError("Failed to load image.")))..src=PF(m,p["image"]);}).catchError((CB){l.completeError(new StateError("Failed to load json file."));});break;}return l.future;} get JD=>eK; MC( i){var h;for(int g=0;g<YL.length&&h==null;g++ )if(YL[g].name==i)h=new GB.vJ(YL[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;} LI( i){var h=new List<GB>();for(int g=0;g<YL.length;g++ )if(YL[g].name.indexOf(i)==0)h.add(new GB.vJ(YL[g]));return h;} get HI{return YL.map((g)=>g.name).toList();}}class OJ extends AB{var fK;OJ(){fK=new gE();} get SI=>fK; FC( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new DB.mJ();returnRectangle.x=g.eB;returnRectangle.y=g.fB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} NC( g, h){return null;} QB( g){fK.QB(g);}}class gE{final  gK=new List<DG>();clear()=>gK.clear();beginPath()=>gK.add(new DG("beginPath"));closePath()=>gK.add(new DG("closePath"));moveTo( h, g)=>gK.add(new DG("moveTo",[h,g]));lineTo( h, g)=>gK.add(new DG("lineTo",[h,g]));arcTo( k, i, g, h, j)=>gK.add(new DG("arcTo",[k,i,g,h,j]));quadraticCurveTo( j, i, g, h)=>gK.add(new DG("quadraticCurveTo",[j,i,g,h]));bezierCurveTo( h, k, l, i, g, j)=>gK.add(new DG("bezierCurveTo",[h,k,l,i,g,j]));arc( l, g, j, i, h, k)=>gK.add(new DG("arc",[l,g,j,i,h,k]));rect( i, g, h, j)=>gK.add(new DG("rect",[i,g,h,j]));oF( g,[ width=1, joints=wF.OG, caps=BG.OG])=>gK.add(new DG("strokeColor",[eD(g),width,joints,caps]));EI( g)=>gK.add(new DG("fillColor",[eD(g)])); QB( k){var h=k.context;h.save();for(var j in gK){var g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].QO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].RO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];PB i=g[0].uK;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.eB,i.fB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].cJ(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].dJ(h);PB i=g[0].uK;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.eB,i.fB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}class PJ extends OC{var yK;var DL;var kK;var qL;var CM;PJ( j, h, i){yK=j;kK=h;DL=i;var g=gC.CD;qL=g.createGain();qL.connect(g.destination,0,0);qL.gain.value=(DL!=null)?gB.pow(DL.volume,2):1;CM=g.createBufferSource();CM.buffer=yK.mK;CM.loop=h;CM.connect(qL,0,0);CM.start(0);} set LD( g){DL=g;qL.gain.value=(DL!=null)?gB.pow(DL.volume,2):1;} stop(){CM.stop(0);}}class DG{var name;var arguments;DG(this.name,[this.arguments]);}class AC{static const  BD=0xFF000000;static const  rG=0xFF0000FF;static const  JH=0xFFA9A9A9;static const  UH=0xFF008000;static const  SF=0xFFFF0000;static const  oH=0xFFFFFFFF;}class TD extends jB{var mK;TD(){if(gC.CD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  mD( n){var h=new TD();var k=jB.OF(n);var g=new VB.Completer<jB>();XB.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var m=gC.CD;m.decodeAudioData(j,( l){h.mK=l;g.complete(h);},(o){g.completeError(new StateError("Failed to decode audio."));});}).catchError((o){g.completeError(new StateError("Failed to load audio."));});return g.future;} get length{return mK.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new bB();return new PJ(this,loop,soundTransform);}}class VD{var SK;var aK;var sK;var GL;VD.nJ( i, g, h, j){SK=0;aK=new DB(i,g,h,j);}VD.qJ( i, g, h){SK=1;sK=new EG(i,g,h);}VD.rJ( g){SK=2;GL=g;if(GL.length<3)throw new ArgumentError("A custom mask needs at least 3 points.");} QB( i){var g=i.context;g.beginPath();switch (SK){case 0:g.rect(aK.x,aK.y,aK.width,aK.height);break;case 1:g.arc(sK.x,sK.y,sK.iF,0,gB.PI*2.0,false);break;case 2:g.moveTo(GL[0].x,GL[0].y);for(int h=1;h<GL.length;h++ )g.lineTo(GL[h].x,GL[h].y);break;}g.clip();}}class yC extends OC{var BL;var oK;var kK;var DL;yC( g, i, h){BL=g;kK=i;DL=h;oK=g.iM(this);oK.loop=kK;this.LD=h;oK.play();} set LD( g){DL=g;if(oK!=null)oK.volume=(DL!=null)?DL.volume:1;} stop(){if(oK!=null){if(oK.ended==false)oK.pause();BL.sN(this);oK=null;}}}class hC{static const  KG="json";static const  AD="jsonarray";}class SD extends jB{var oK;var HL;var gL;SD(){gL=new List<yC>();oK=new XB.AudioElement();oK.onEnded.listen(VM);HL=new List<XB.AudioElement>();HL.add(oK);XB.document.body.children.add(oK);}static  mD( o){var k=new SD();var g=k.oK;var i=new VB.Completer<jB>();var h;var j;n(m){h.cancel();j.cancel();i.complete(k);}l(m){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(n);j=g.onError.listen(l);g.src=jB.OF(o);g.load();return i.future;} get length{return oK.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new bB();return new yC(this,loop,soundTransform);} iM( h){var g;if(HL.length==0){g=oK.clone(true);g.onEnded.listen(VM);}else{g=HL.removeAt(0);}gL.add(h);return g;} sN( g){var h=g.oK;var i=gL.indexOf(g);gL.removeAt(i);HL.add(h);if(oK.currentTime>0&&oK.ended==false)oK.currentTime=0;} VM(j){var i=j.target;var g=null;for(int h=0;h<gL.length&&g==null;h++ )if(gL[h].oK==i)g=gL[h];if(g!=null)g.stop();}}class bB{var volume;var eI;var gJ=1;var hJ=0;var kJ=1;var jJ=0;bB([this.volume=1,this.eI=0]);}class wF{static const  OG="round";}class iE{var YK;var qK;var EL;var OL;var UL;var eL;var pL;var uL;var zL;var IM;var PM;iE( g, h){YK=g;qK=h;} get oI=>qK; get name=>YK; get JI=>EL; get KI=>OL; get II=>UL; get GI=>eL; get offsetX=>pL; get offsetY=>uL; get dI=>zL; get cI=>IM; get lI=>PM;}abstract class OC extends IC{ set LD( g); stop();}abstract class jB{static  mD( g){var h=gC.lG;if(h=="WebAudioApi")return TD.mD(g);if(h=="AudioElement")return SD.mD(g);return hE.mD(g);} get length; play([ loop=false, soundTransform]);static  OF( g){var m=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var i=m.firstMatch(g);var h=gC.JF;if(i==null)throw new ArgumentError("Unsupported file extension.");if(h.length==0)throw new UnsupportedError("This browser supports no known audio codec.");var j=i.group(1).toLowerCase();if(h.indexOf(j)==-1){var l=g.substring(0,g.length-j.length);var k=h[0];g="${l}${k}";}return g;}}class zC extends AB{var rB;var gI;var SC;zC([this.rB=null,this.gI="auto"]){SC=null;} FC( h,[ returnRectangle]){var g=(rB!=null)?rB.width:0;var i=(rB!=null)?rB.height:0;return qD(h,g,i,returnRectangle);} NC( g, h){if(rB!=null&&g>=0.0&&h>=0.0&&g<rB.width&&h<rB.height)return this;return null;} QB( g){if(rB!=null){if(SC==null)rB.QB(g);else rB.kF(g,SC);}}}class NJ extends WC{var color;var alpha;var KB;var LB;var UE;var ME;var OE;var nC;NJ([this.color=0,this.alpha=1.0,this.KB=4,this.LB=4,this.UE=2.0,this.ME=false,this.OE=false,this.nC=false]){if(KB<1||LB<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(KB>128||LB>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} apply( YE, n, ZE, TB){var rC=YE.lN();var aE=rC.getImageData(n.x,n.y,n.width,n.height);var bE=aE.data;var p=n.width;var aB=n.height;var uB=KB*KB;var xB=LB*LB;var o=KB;var sC=KB*2;var UB=LB;var LC=LB*2;var MB=p+sC;var FB=aB+LC;var cE=p*4;var ZB=MB*4;var CB=RC?3:0;var q=ZE.lN();var tC=q.createImageData(MB,FB);var h=tC.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){var m=0,u=xB>>1;var t=j*4+CB;var v=(j+o)*4+CB;for(int i=0;i<FB;i++ ){h[v]=u~/xB;v+= ZB;if(i>=LC){m-= 2*l[i&1023]-l[(i-UB)&1023];}else if(i>=UB){m-= 2*l[i&1023];}var k=(i<aB)?bE[t]:0;l[(i+UB)&1023]=k;u+= m+= k;t+= cE;}}for(int i=0;i<FB;i++ ){var m=0,u=uB>>1;var t=i*ZB+o*4+CB;var v=i*ZB+CB;for(int j=0;j<MB;j++ ){h[v]=u~/uB;v+= 4;if(j>=sC){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}var k=(j<p)?h[t]:0;l[(j+o)&1023]=k;u+= m+= k;t+= 4;}}var yB=(alpha*256).toInt();var vB=(color>>16)&0xFF;var wB=(color>>8)&0xFF;var uC=(color>>0)&0xFF;if(RC){for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=vB;h[g+1]=wB;h[g+2]=uC;h[g+3]=(h[g+3]*yB)~/256;}}}else{for(var g=0;g<=h.length-4;g+= 4){var k=h[g+3];if(k>0){h[g+0]=(h[g+0]*yB)~/256;h[g+1]=uC;h[g+2]=wB;h[g+3]=vB;}}}var KC=TB.x;var HC=TB.y;var GC=TB.x-o;var vC=TB.y-UB;var dE=new DB(KC,HC,p,aB);var eE=new DB(GC,vC,MB,FB);var NB=dE.rF(eE);q.setTransform(1,0,0,1,0,0);q.clearRect(NB.x,NB.y,NB.width,NB.height);q.putImageData(tC,GC,vC);if(this.nC==false)q.drawImage(rC.canvas,KC,HC);}}class GB implements XC{var nK;var xK;var KL;var ZL;var iK;var wL;var FM;var MM;var EL;var OL;var UL;var eL;GB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){nK=g;xK=h;KL=transparent;var i=new XB.CanvasElement(width:nK,height:xK);iK=i.context2d;iK.fillStyle=KL?eD(fillColor):kC(fillColor);iK.fillRect(0,0,g,h);ZL=i;wL=0;}GB.uJ( g){nK=g.naturalWidth;xK=g.naturalHeight;KL=true;ZL=g;wL=0;}GB.vJ( g){nK=g.dI;xK=g.cI;KL=true;ZL=g.oI.JD;wL=g.lI?2:1;FM=g.offsetX.toDouble();MM=g.offsetY.toDouble();EL=g.JI.toDouble();OL=g.KI.toDouble();UL=g.II.toDouble();eL=g.GI.toDouble();}static  mD( i){var h=new VB.Completer<GB>();var g=new XB.ImageElement();g.onLoad.listen((j)=>h.complete(new GB.uJ(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>nK; get height=>xK; wH( i, j, g, h){h.apply(i,j,this,g);} QB( g){switch (wL){case 0:g.context.drawImage(ZL,0.0,0.0);break;case 1:g.context.drawImage(ZL,EL,OL,UL,eL,FM,MM,UL,eL);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,FM,MM+eL);g.context.drawImage(ZL,EL,OL,eL,UL,0.0,0.0,eL,UL);break;}} kF( v, g){if(g.width<=0.0||g.height<=0.0)return;switch (wL){case 0:v.context.drawImage(ZL,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=EL;double h=OL;double p=j+UL;double q=h+eL;double l=EL-FM+g.x;double m=OL-MM+g.y;double u=l+g.width;double t=m+g.height;double o=(j>l)?j:l;double n=(h>m)?h:m;double CB=(p<u)?p:u;double NB=(q<t)?q:t;double MB=FM-j+o;double FB=MM-h+n;double k=CB-o;double i=NB-n;if(k>0.0&&i>0.0){v.context.drawImage(ZL,o,n,k,i,MB,FB,k,i);}break;case 2:double j=EL;double h=OL;double p=j+eL;double q=h+UL;double l=EL+MM-g.y+eL-g.height;double m=OL-FM+g.x;double u=l+g.height;double t=m+g.width;double o=(j>l)?j:l;double n=(h>m)?h:m;double CB=(p<u)?p:u;double NB=(q<t)?q:t;double MB=FM-h+n;double FB=MM+p-CB;double k=NB-n;double i=CB-o;if(k>0.0&&i>0.0){v.context.transform(0.0,-1.0,1.0,0.0,MB,FB+i);v.context.drawImage(ZL,o,n,i,k,0.0,0.0,i,k);}break;}} lN(){if(iK==null){var g=new XB.CanvasElement(width:nK,height:xK);iK=g.context2d;switch (wL){case 0:iK.drawImage(ZL,0,0);break;case 1:iK.drawImage(ZL,EL,OL,UL,eL,FM,MM,UL,eL);break;case 2:iK.setTransform(0.0,-1.0,1.0,0.0,FM,MM+eL);iK.drawImage(ZL,EL,OL,eL,UL,0.0,0.0,eL,UL);iK.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}ZL=g;wL=0;}return iK;}}typedef  HG<jC extends EB>( event);class LG<jC extends EB> extends VB.StreamSubscription<jC>{var rL;var DM;var HM;var NM;LG(this.rL,this.DM){HM=0;NM=false;} cancel(){if(NM==false){rL.vM(this);NM=true;DM=null;}} onError( g( error)){} get eN=>HM>0; pause([ resumeSignal]){HM++ ;if(resumeSignal!=null)resumeSignal.whenComplete(resume);} resume(){if(eN==false)throw new StateError("Subscription is not paused.");HM-- ;}}class tE{var bL;tE(){bL=new Map<String,wC>();} aM( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(bL.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");bL[i]=g;} DN( i, g){var h="${i}.${g}";if(bL.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return bL[h];} pB( i, h){var g=new wC("BitmapData",i,h);g.CN(GB.mD(h));aM(g);} HB( i, h){var g=new wC("Sound",i,h);g.CN(jB.mD(h));aM(g);} DE( j, h, i){var g=new wC("TextureAtlas",j,h);g.CN(CC.mD(h,i));aM(g);} uH( i, h){var g=new wC("FlumpLibrary",i,h);g.CN(DC.mD(h));aM(g);} load(){var h=this.fI.map((i)=>i.LL);return VB.Future.wait(h).then((j){var g=this.DI;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get fI{return bL.values.where((g)=>g.oC==null).toList();} get DI{return bL.values.where((g)=>g.error!=null).toList();} MC( g){return DN("BitmapData",g).oC;} YF( g){return DN("Sound",g).oC;} LE( g){return DN("TextureAtlas",g).oC;} NI( g){return DN("FlumpLibrary",g).oC;}} kC( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class DC{var zK;var sL;var SL;final  LM=new List<AE>();final  WM=new List<sH>();static  mD( l){var i=new VB.Completer<DC>();XB.HttpRequest.getString(l).then((p){var h=sF.parse(p) as Map;var j=new List();var g=new DC();g.zK=l;g.sL=h["md5"];g.SL=h["frameRate"].toInt();for(var m in h["movies"] as List){var n=new AE(m,g);g.LM.add(n);}for(var o in h["textureGroups"] as List){var k=new sH(o,g);g.WM.add(k);j.add(k.HD.future);}VB.Future.wait(j).then((t){i.complete(g);}).catchError((q){i.completeError(new StateError("Failed to load image."));});}).catchError((q){i.completeError(new StateError("Failed to load json file."));});return i.future;} yN( h){for(var g in LM)if(g.id==h)return g;throw new ArgumentError("The movie '${h}' is not available.");} BO( g){for(var h in WM){if(h.ID.containsKey(g)){return h.ID[g];}}for(var i in LM){if(i.id==g){return new RJ(this,g);}}throw new ArgumentError("The symbol '${g}' is not available.");}}class zE{static var BF=false;static var cD=false;static var dD=0;static var qG=oE.UG;static var sG=new VB.StreamController<String>();static var wG=sG.stream.asBroadcastStream();static yG(){if(BF==false){BF=true;var g=XB.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){cD=true;dD=10;}if(g.contains("Android")){cD=true;dD=10;}if(g.contains("IEMobile")){cD=true;dD=10;}}}static  get SH{yG();return qG;}}class mG{static var pG=0;var ND=pG++ ;var target=null;var KD=false;mG(this.target,this.KD);} eD( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class s{static var fD;static  YC( g){return g;}static  MF( g){return 0.5-0.5*gB.cos(g*2.0*gB.PI);}static  EH( g){return 0.5+0.5*gB.cos(g*2.0*gB.PI);}static  HH( g){if(fD==null)fD=new gB.Random();if(g==0.0||g==1.0)return g;return fD.nextDouble();}static  gD( g){return g*g;}static  hD( g){g=1.0-g;return 1.0-g*g;}static  KH( g){g=g*2.0;return (g<1.0)?0.5*gD(g):0.5*hD(g-1.0)+0.5;}static  LH( g){g=g*2.0;return (g<1.0)?0.5*hD(g):0.5*gD(g-1.0)+0.5;}static  iD( g){return g*g*g;}static  jD( g){g=1.0-g;return 1.0-g*g*g;}static  RF( g){g=g*2.0;return (g<1.0)?0.5*iD(g):0.5*jD(g-1.0)+0.5;}static  RH( g){g=g*2.0;return (g<1.0)?0.5*jD(g):0.5*iD(g-1.0)+0.5;}static  kD( g){return g*g*g*g;}static  lD( g){g=1.0-g;return 1.0-g*g*g*g;}static  VH( g){g=g*2.0;return (g<1.0)?0.5*kD(g):0.5*lD(g-1.0)+0.5;}static  WH( g){g=g*2.0;return (g<1.0)?0.5*lD(g):0.5*kD(g-1.0)+0.5;}static  nD( g){return g*g*g*g*g;}static  oD( g){g=1.0-g;return 1.0-g*g*g*g*g;}static  YH( g){g=g*2.0;return (g<1.0)?0.5*nD(g):0.5*oD(g-1.0)+0.5;}static  ZH( g){g=g*2.0;return (g<1.0)?0.5*oD(g):0.5*nD(g-1.0)+0.5;}static  pD( g){return 1.0-gB.sqrt(1.0-g*g);}static  rD( g){g=1.0-g;return gB.sqrt(1.0-g*g);}static  aH( g){g=g*2.0;return (g<1.0)?0.5*pD(g):0.5*rD(g-1.0)+0.5;}static  bH( g){g=g*2.0;return (g<1.0)?0.5*rD(g):0.5*pD(g-1.0)+0.5;}static  sD( g){return 1.0-gB.cos(g*(gB.PI/2.0));}static  tD( g){return gB.sin(g*(gB.PI/2.0));}static  dH( g){g=g*2.0;return (g<1.0)?0.5*sD(g):0.5*tD(g-1.0)+0.5;}static  hH( g){g=g*2.0;return (g<1.0)?0.5*tD(g):0.5*sD(g-1.0)+0.5;}static  uD( g){if(g==0.0)return 0.0;return gB.pow(2.0,10.0*(g-1.0));}static  vD( g){if(g==1.0)return 1.0;return 1.0-gB.pow(2.0,-10.0*g);}static  iH( g){g=g*2.0;return (g<1.0)?0.5*uD(g):0.5*vD(g-1.0)+0.5;}static  jH( g){g=g*2.0;return (g<1.0)?0.5*vD(g):0.5*uD(g-1.0)+0.5;}static  wD( g){var h=1.70158;return g*g*((h+1.0)*g-h);}static  xD( g){var h=1.70158;g=g-1.0;return g*g*((h+1.0)*g+h)+1.0;}static  TF( g){g=g*2.0;return (g<1.0)?0.5*wD(g):0.5*xD(g-1.0)+0.5;}static  mH( g){g=g*2.0;return (g<1.0)?0.5*xD(g):0.5*wD(g-1.0)+0.5;}static  yD( g){if(g==0.0||g==1.0)return g;g=g-1.0;return -gB.pow(2.0,10.0*g)*gB.sin((g-0.3/4.0)*(2.0*gB.PI)/0.3);}static  DD( g){if(g==0.0||g==1.0)return g;return gB.pow(2.0,-10.0*g)*gB.sin((g-0.3/4.0)*(2.0*gB.PI)/0.3)+1;}static  nH( g){g=g*2.0;return (g<1.0)?0.5*yD(g):0.5*DD(g-1.0)+0.5;}static  pH( g){g=g*2.0;return (g<1.0)?0.5*DD(g):0.5*yD(g-1.0)+0.5;}static  zD( g){return 1.0-ED(1.0-g);}static  ED( g){if(g<1/2.75){return 7.5625*g*g;}else if(g<2/2.75){g=g-1.5/2.75;return 7.5625*g*g+0.75;}else if(g<2.5/2.75){g=g-2.25/2.75;return 7.5625*g*g+0.9375;}else{g=g-2.625/2.75;return 7.5625*g*g+0.984375;}}static  qH( g){g=g*2.0;return (g<1.0)?0.5*zD(g):0.5*ED(g-1.0)+0.5;}static  rH( g){g=g*2.0;return (g<1.0)?0.5*ED(g):0.5*zD(g-1.0)+0.5;}}class BH implements iB{final  EN;final  IN;final  LN=new List<yF>();var ON;var PN;var SN;var QL;var CL;var bN;var cN;var fN;BH( g, h,[ transitionFunction( ratio)]):EN=g,IN=(transitionFunction!=null)?transitionFunction:s.YC{CL=0.0;QL=gB.max(0.0001,h);bN=0.0;cN=false;fN=false;} kB( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(EN!=null&&fN==false)LN.add(new yF(g,0.0,h));} moveTo( h, g){kB('x',h);kB('y',g);} qB( l){if(CL<QL||fN==false){CL=CL+l;if(CL>QL)CL=QL;if(CL>=0.0){if(fN==false){fN=true;for(int i=0;i<LN.length;i++ ){var g=LN[i];switch (g.name){case 'x':g.tB=EN.x;break;case 'y':g.tB=EN.y;break;case 'pivotX':g.tB=EN.lB;break;case 'pivotY':g.tB=EN.sB;break;case 'scaleX':g.tB=EN.mB;break;case 'scaleY':g.tB=EN.nB;break;case 'rotation':g.tB=EN.pC;break;case 'alpha':g.tB=EN.alpha;break;}}if(ON!=null)ON();}var j=CL/QL;var k=IN(j);for(int i=0;i<LN.length;i++ ){var g=LN[i];var h=g.tB+k*(g.pF-g.tB);h=cN?h.round():h;switch (g.name){case 'x':EN.x=h;break;case 'y':EN.y=h;break;case 'pivotX':EN.lB=h;break;case 'pivotY':EN.sB=h;break;case 'scaleX':EN.mB=h;break;case 'scaleY':EN.nB=h;break;case 'rotation':EN.pC=h;break;case 'alpha':EN.alpha=h;break;}}if(PN!=null)PN();if(SN!=null&&CL==QL)SN();}}return CL<QL;} get BI=>EN; get currentTime=>CL;set VF( g){if(fN==false)CL=CL+bN-g;bN=g;} set onComplete( g()){SN=g;}} CH( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class lC extends WB{var BN;var iK;var QN;var TN;var XN;var aN;var dN;var hN;var jN;var nN;var oN;var pN;var qN;lC( h, g){YK=h;BN=g;BN.focus();iK=g.context2d;TN=new YB.oJ(iK);XN=iC.WD;aN=hB.ZD;RD.fG.listen(fG);jN=[new fE(w.xE,w.CF,w.sE,w.VG),new fE(w.tG,w.vG,w.KF,w.KF),new fE(w.AH,w.FH,w.LF,w.LF)];hN=null;dN=new IB(0,0);oN=new w(w.sE,true);BN.onMouseDown.listen(DO);BN.onMouseUp.listen(DO);BN.onMouseMove.listen(DO);BN.onMouseOut.listen(DO);BN.onMouseWheel.listen(DO);nN=new Map<int,mG>();qN=new SB(SB.rE,true);zE.wG.listen(HO);HO(null);pN=new BC(BC.YD,true);BN.onKeyDown.listen(LO);BN.onKeyUp.listen(LO);BN.onKeyPress.listen(MO);} get focus=>QN; NO(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){NO();} set y( g){NO();} set lB( g){NO();} set sB( g){NO();} set mB( g){NO();} set nB( g){NO();} set pC( g){NO();} set alpha( g){NO();} set width( g){NO();} set height( g){NO();} aF(){if(XN==iC.WD||XN==iC.wE){TN.reset();QB(TN);if(XN==iC.wE)XN=iC.RG;}} fG( g){BN.style.cursor=RD.QF(aN);} DO( j){j.preventDefault();var q=BN.getBoundingClientRect();var n=new DateTime.now().millisecondsSinceEpoch;var p=j.button;var h=null;var i=new IB(j.clientX-q.left,j.clientY-q.top);var m=null;if(p<0||p>2)return;if(j.type=="mousemove"&&dN.equals(i))return;var g=jN[p];dN=i;if(j.type!="mouseout")h=NC(i.x,i.y) as JB;var l=hB.ZD;if(h is lE)if(h.XE)l=hB.aD;if(h is GG)if(h.XE)l=hB.aD;if(aN!=l){aN=l;BN.style.cursor=RD.QF(l);}if(hN!=null&&hN!=h){hN.dispatchEvent(oN..AN(w.GF,true)..wN=(hN.MD!=null)?hN.bC(i):new IB.mJ()..zN=i..rN=g.JC);hN=null;}if(h!=null&&h!=hN){h.dispatchEvent(oN..AN(w.HF,true)..wN=h.bC(i)..zN=i..rN=g.JC);hN=h;}var k=null;var o=false;var t=false;if(j.type=="mousedown"){k=g.dF;if(h!=g.target||n>g.FE+500)g.mC=0;g.JC=true;g.target=h;g.FE=n;g.mC++ ;}if(j.type=="mouseup"){k=g.fF;g.JC=false;o=(g.target==h);t=o&&g.mC.isEven&&(n<g.FE+500);}if(j.type=="mousemove"){k=w.FF;}if(k!=null&&h!=null){m=h.bC(i);h.dispatchEvent(oN..AN(k,true)..wN=m..zN=i..rN=g.JC..tN=g.mC);if(o){if(t&&h.CI){h.dispatchEvent(oN..AN(g.cF,true)..wN=m..zN=i..rN=g.JC);}else{h.dispatchEvent(oN..AN(g.bF,true)..wN=m..zN=i..rN=g.JC);}}}}var SO=[] ; HO( h){SO.forEach((g)=>g.cancel());if(zE.SH==oE.ZG){SO=[BN.onTouchStart.listen(TO),BN.onTouchEnd.listen(TO),BN.onTouchMove.listen(TO),BN.onTouchEnter.listen(TO),BN.onTouchLeave.listen(TO),BN.onTouchCancel.listen(TO)];}} TO( j){j.preventDefault();var n=BN.getBoundingClientRect();for(var m in j.changedTouches){var l=m.identifier;var i=new IB(m.clientX-n.left,m.clientY-n.top);var h=NC(i.x,i.y) as JB;var g=nN.containsKey(l)?nN[l]:new mG(h,nN.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(qN..AN(SB.kG,true)..wN=(g.target.MD!=null)?g.target.bC(i):new IB.mJ()..zN=i..GN=g.ND..HN=g.KD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(qN..AN(SB.jG,true)..wN=h.bC(i)..zN=i..GN=g.ND..HN=g.KD);g.target=h;}var k=null;if(j.type=="touchstart"){nN[l]=g;k=SB.rE;}if(j.type=="touchend"){nN.remove(l);k=SB.vE;}if(j.type=="touchcancel"){nN.remove(l);k=SB.yE;}if(j.type=="touchmove"){k=SB.EF;}if(k!=null&&h!=null){h.dispatchEvent(qN..AN(k,true)..wN=h.bC(i)..zN=i..GN=g.ND..HN=g.KD);}}} LO( g){g.preventDefault();var h=null;if(g.type=="keyup")h=BC.uE;if(g.type=="keydown")h=BC.YD;pN..AN(h,true)..ZM=g.altKey..cM=g.ctrlKey..eM=g.shiftKey..oM=g.charCode..qM=g.keyCode..sM=VC.IG;if(g.keyLocation==XB.KeyLocation.LEFT)pN.sM=VC.NG;if(g.keyLocation==XB.KeyLocation.RIGHT)pN.sM=VC.DF;if(g.keyLocation==XB.KeyLocation.NUMPAD)pN.sM=VC.aG;if(g.keyLocation==XB.KeyLocation.JOYSTICK)pN.sM=VC.AF;if(g.keyLocation==XB.KeyLocation.MOBILE)pN.sM=VC.AF;if(QN!=null)QN.dispatchEvent(pN);} MO( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new jE(jE.TG,true);h.pK=new String.fromCharCodes([i]);if(QN!=null)QN.dispatchEvent(h);}} PF( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} MH(){var g=new XB.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} QH( h){if(RC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];h[g+0]=(h[g+0]*i)~/255;h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;h[g+3]=(h[g+3]*i)~/255;}}} XH( h){if(RC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];if(i>0){h[g+0]=(h[g+0]*255)~/i;h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;}}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];if(i>0){h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;h[g+3]=(h[g+3]*255)~/i;}}}}class RJ extends AB implements iB{final  EO;final  FO;final  GO=new List<fH>();var IO=0.0;var JO=0.0;var KO=0;var YL=0;RJ( g, j):EO=g,FO=g.yN(j){for(var h in FO.JE){var i=new fH(EO,h);GO.add(i);}YL=FO.KE;JO=YL/EO.SL;} qB( h){IO+= h;var i=IO%JO;KO=gB.min((YL*i/JO).toInt(),YL-1);for(var g in GO){g.qB(h);g.mF(KO);}return true;} QB( h){for(var g in GO){if(g.visible){h.lF(g);}}}} qD( g, m, q, j){var FB=0.0;var CB=0.0;var p=m*g.a;var v=m*g.b;var t=m*g.a+q*g.c;var o=m*g.b+q*g.d;var u=q*g.c;var n=q*g.d;var h=FB;if(h>p)h=p;if(h>t)h=t;if(h>u)h=u;var i=CB;if(i>v)i=v;if(i>o)i=o;if(i>n)i=n;var l=FB;if(l<p)l=p;if(l<t)l=t;if(l<u)l=u;var k=CB;if(k<v)k=v;if(k<o)k=o;if(k<n)k=n;if(j==null)j=new DB.mJ();j.x=g.eB+h;j.y=g.fB+i;j.width=l-h;j.height=k-i;return j;}var RC=MH();class fH extends AB implements iB{final  aC;final  IE;final  VE=new Map<String,XC>();var qC;fH( i, h):this.aC=i,this.IE=h{for(var g in h.EC){if(g.UC!=null&&VE.containsKey(g.UC)==false){VE[g.UC]=i.BO(g.UC);}}mF(0);} qB( g){if(qC is iB){var h=qC as iB;h.qB(g);}} mF( t){var g=IE.QI(t);var o=g.x,p=g.y;var n=g.mB,k=g.nB;var m=g.skewX,l=g.skewY;var v=g.lB,UB=g.sB;var q=g.alpha;if(g.index!=t&&g.qF){var i=IE.OI(g);if(i!=null){var h=(t-g.index)/g.duration;var j=g.XF;if(j!=0){var u=0.0;if(j<0){var FB=1-h;u=1-FB*FB;j=0-j;}else{u=h*h;}h=j*u+(1-j)*h;}o=o+(i.x-o)*h;p=p+(i.y-p)*h;n=n+(i.mB-n)*h;k=k+(i.nB-k)*h;m=m+(i.skewX-m)*h;l=l+(i.skewY-l)*h;q=q+(i.alpha-q)*h;}}var CB=n*gB.cos(l);var TB=n*gB.sin(l);var MB=-k*gB.sin(m);var NB=k*gB.cos(m);var ZB=o-(v*CB+UB*MB);var aB=p-(v*TB+UB*NB);xM=false;rM.SE(CB,TB,MB,NB,ZB,aB);QM=q;SM=g.visible;qC=(g.UC!=null)?VE[g.UC]:null;} QB( g){if(qC!=null){qC.QB(g);}}}class AE{final  id;final  aC;final  JE=new List<BE>();AE( g, j):aC=j,id=g["id"]{for(var h in g["layers"]){var i=new BE(h);this.JE.add(i);}} get KE{var g=0;for(var h in JE)g=gB.max(g,h.KE);return g;}}class BE{final  name;final  FI;final  EC=new List<FD>();BE( g):this.name=g["name"],this.FI=g.containsKey("flipbook")?g["flipbook"]:false{for(var i in g["keyframes"]){var h=new FD(i);this.EC.add(h);}} get KE{var g=EC[EC.length-1];return g.index+g.duration;} QI( h){var g=1;while (g<EC.length&&EC[g].index<=h)g++ ;return EC[g-1];} OI( h){for(int g=0;g<EC.length-1;g++ )if(identical(EC[g],h))return EC[g+1];return null;}}class FD{var index;var duration;var UC;var label;var x,y;var mB,nB;var skewX,skewY;var lB,sB;var visible;var alpha;var qF;var XF;FD( g){this.index=g["index"];this.duration=g["duration"];this.UC=g.containsKey("ref")?g["ref"]:null;this.label=g.containsKey("label")?g["label"]:null;this.x=g.containsKey("loc")?g["loc"][0]:0.0;this.y=g.containsKey("loc")?g["loc"][1]:0.0;this.mB=g.containsKey("scale")?g["scale"][0]:1.0;this.nB=g.containsKey("scale")?g["scale"][1]:1.0;this.skewX=g.containsKey("skew")?g["skew"][0]:0.0;this.skewY=g.containsKey("skew")?g["skew"][1]:0.0;this.lB=g.containsKey("pivot")?g["pivot"][0]:0.0;this.sB=g.containsKey("pivot")?g["pivot"][1]:0.0;this.visible=g.containsKey("visible")?g["visible"]:true;this.alpha=g.containsKey("alpha")?g["alpha"]:1.0;this.qF=g.containsKey("tweened")?g["tweened"]:true;this.XF=g.containsKey("ease")?g["ease"]:0.0;}}class sH{var aC;var ID;var HD;sH( p,this.aC){this.ID=new Map<String,tH>();this.HD=new VB.Completer();var k=0;for(var j in p["atlases"] as List){var n=j["file"] as String;var q=PF(aC.zK,n);k++ ;var g=new XB.ImageElement();g.onLoad.listen((o){if( --k==0)this.HD.complete(this);});g.onError.listen((o){this.HD.completeError(new StateError("Failed to load image."));});g.src=q;for(var i in j["textures"] as List){var m=i["symbol"] as String;var h=i["rect"] as List;var l=i["origin"] as List;var t=new tH(h[0],h[1],h[2],h[3],l[0],l[1],g);this.ID[m]=t;}}}}class tH implements XC{var x,y,width,height;var aI,bI;var JD;tH(this.x,this.y,this.width,this.height,this.aI,this.bI,this.JD); QB( g){g.context.drawImage(JD,x,y,width,height,0,0,width,height);}}//@ sourceMappingURL=dartflash_web.dart.map
