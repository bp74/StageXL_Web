import "dart:html" as WB;import "dart:math" as MC;import "dart:json" as BI;import "dart:web_audio" as NE;import "dart:async" as OB;class CI{static const  DI="Chrome";static const  EI="Firefox";static const  FI="Internet Explorer";static const  GI="Safari";final  XH;final  minimumVersion;const CI(this.XH,[this.minimumVersion]);}class HI{final  name;const HI(this.name);}class OI extends RB{final  JJ=[{'name':'DropShadowFilter (black)','filter':new TI(10,MC.PI/4,pB.GD,0.8,8,8)},{'name':'GlowFilter (red)','filter':new UI(pB.CF,1.0,20,20)},{'name':'ColorMatrixFilter (grayscale)','filter':new XI.DJ()},{'name':'ColorMatrixFilter (invert)','filter':new XI.FJ()},{'name':'BlurFilter (radius 1)','filter':new WI(1,1)},{'name':'BlurFilter (radius 5)','filter':new WI(5,5)},{'name':'BlurFilter (radius 10)','filter':new WI(10,10)},{'name':'BlurFilter (radius 20)','filter':new WI(20,20)}];OI(){var m=new CB(940,500,true,0x000000);var k=QB.WC('king');var o=new CB(230,245,true,0xFFF0F0F0);var p=new UE(m);JB(p);for(int h=0;h<JJ.length;h++ ){var i=235*(h%4);var j=250*(h~/4);var q=JJ[h]['filter'] as hB;var t=JJ[h]['name'] as String;var u=new BB(0,0,k.width,k.height);var n=new AB(i+40,j+45);m.WH(k,u,n,q);var l=new UE(o);l.x=i;l.y=j;sD(l,0);var g=new YI();g.FC=new ZD('Helvetica Neue, Helvetica, Arial',14,pB.GD);g.x=i+5;g.y=j+5;g.width=200;g.text=t;JB(g);}}}class NI extends RB{final  IJ=new MC.Random();NI(){var g=new pC();g.AC=470;g.HC=250;g.x=470;g.y=250;JB(g);for(int h=0;h<150;h++ ){var w=1+IJ.nextInt(3);var p=QB.WC('flower${w}');var i=new UE(p);i.AC=64;i.HC=64;i.x=64+IJ.nextInt(940-128);i.y=64+IJ.nextInt(500-128);g.JB(i);var o=new JD(i,600,TC.ID);o.gC.IC.YC(MC.PI*60.0);ZB.add(o);}var k=new List<AB>();for(int h=0;h<6;h++ ){var n=(h*60)*MC.PI/180;var m=(h*60+30)*MC.PI/180;k.add(new AB(470+200*MC.cos(n),250+200*MC.sin(n)));k.add(new AB(470+100*MC.cos(m),250+100*MC.sin(m)));}var t=new nC.xI(100,100,740,300);var u=new nC.zI(470,250,200);var q=new nC.AJ(k);WB.query('#mask-none').onClick.listen((j)=>g.mask=null);WB.query('#mask-rectangle').onClick.listen((j)=>g.mask=t);WB.query('#mask-circle').onClick.listen((j)=>g.mask=u);WB.query('#mask-custom').onClick.listen((j)=>g.mask=q);WB.query('#mask-spin').onClick.listen((j){var l=new JD(g,2.0,TC.TH);l.gC.IC.YC(MC.PI*4.0);l.onComplete=()=>g.IC=0.0;ZB.add(l);});}}class LI extends RB{var IJ=new MC.Random();var LJ;var MJ;LI(){LJ=QB.LF('walkTextureAtlas');MJ=LJ.hH('walk');OJ();}OJ(){var h=IJ.nextDouble();var g=new cF(MJ,30);g.x=-128;g.y=20.0+180.0*h;g.JC=g.KC=0.5+0.5*h;g.play();JB(g);yH((k,j)=>(k.y-j.y).toInt());var i=new JD(g,5.0+(1.0-h)*5.0,TC.ID);i.gC.x.YC(940.0);i.onComplete=(){ZB.remove(g);WF(g);};ZB.add(g);ZB.add(i);ZB.ZH(OJ,0.2);}}class KI extends UE implements yB{var WD,XD;KI( g,this.WD,this.XD):super(g){this.AC=g.width/2;this.HC=g.height/2;} EC( i){var g=x+WD*i;var h=y+XD*i;if(g>910||g<30)WD=-WD;else x=g;if(h>470||h<30)XD=-XD;else y=h;return true;}}class II extends RB{final  KJ=['C4','A3','A3','C4','D4','G3','G3','A3','A3#','F4','F4','E4','C4','D4','C4','A3#','A3','C4','D4','D4','D4','G4','F4','E4','F4','D4','C4','F3','G3','A3','D4','C4','C4','A3#','A3','E3','F3'];final  NJ=['Hey ','Jude, ',"don't ",'make ','it ','bad.<br>','Take ','a ','sad ','song ','and ','make ','it ','better.<br>','','','','Remember ','','','to ','let ','her ','into ','','your ','heart.<br>','Than ','you ','can ','start ','','to ','make ','things ','better.','',' '];II(){var h=new UE(QB.WC('Background'));JB(h);var g=new aF(KJ,NJ);g.x=120;g.y=30;JB(g);WB.query('#startOver').onClick.listen((i)=>g.wH());}}class MI extends RB{final  text='Filet mignon leberkas pig pork chop biltong, short loin strip steak turkey brisket ' 'venison. Pastrami venison pancetta, leberkas pork chop chicken prosciutto beef ribs ' 'bresaola kielbasa swine biltong capicola. Hamburger beef ribs ball tip drumstick salami ' 'pig. Capicola pork loin shank, salami chicken hamburger tail. Sirloin spare ribs ' 'ground round cow strip steak prosciutto swine bacon corned beef.';MI(){var j=new YI();j.FC=new ZD('Helvetica,Arial',14,pB.GH,bold:true,italic:true);j.text=text;j.x=10;j.y=10;j.width=920;j.height=20;JB(j);var h=new YI();h.FC=new ZD('Helvetica,Arial',16,pB.CF);h.text=text;h.x=10;h.y=50;h.width=200;h.height=300;h.wordWrap=true;JB(h);var g=new YI();g.FC=new ZD('Helvetica,Arial',16,pB.aG,align:OC.kE);g.text=text;g.x=300;g.y=50;g.width=200;g.height=300;g.wordWrap=true;JB(g);var i=new YI();i.FC=new ZD('Caesar Dressing',30,pB.GD,align:OC.iD);i.text=text;i.x=590;i.y=50;i.width=340;i.height=300;i.wordWrap=true;JB(i);}}class JI extends RB{JI(){var g=new YI();g.FC=new ZD('Helvetica,Arial',14,pB.uG,bold:true);g.text='ToDo: show a cool demo ...';g.x=10;g.y=10;g.width=920;g.height=20;JB(g);}}var vB;var YD;var ZB;var QB; main(){CB.qE.webp=true;var k=WB.window.location.pathname;var j=new RegExp(r"([A-Za-z0-9-]+)\.html",multiLine:false,caseSensitive:false);var g=j.firstMatch(k);if(g!=null&&g.groupCount==1){var h=g.group(1);print("current page: ${h}");var i=WB.query("#stage");if(i!=null){vB=new fC('stage',i);YD=new aD();YD.VH(vB);ZB=YD.wD;QB=new SE();}switch (h){case "filter":QB..jB('king','images/king.png')..load().then((UJ)=>vB.JB(new OI()));break;case "masking":QB..jB('flower1','images/Flower1.png')..jB('flower2','images/Flower2.png')..jB('flower3','images/Flower3.png')..load().then((UJ)=>vB.JB(new NI()));break;case "flipbook":QB..DF('walkTextureAtlas','images/walk.json',CD.lD)..load().then((UJ)=>vB.JB(new LI()));break;case "performance":QB..DF('flags','images/flags.json',CD.lD)..load().then((UJ)=>vB.JB(new QI()));break;case "sound":QB..jB('KeyBlack','images/piano/KeyBlack.png')..jB('KeyWhite0','images/piano/KeyWhite0.png')..jB('KeyWhite1','images/piano/KeyWhite1.png')..jB('KeyWhite2','images/piano/KeyWhite2.png')..jB('KeyWhite3','images/piano/KeyWhite3.png')..jB('Finger','images/piano/Finger.png')..jB('Background','images/piano/Background.jpg')..HB('Cheer','sounds/Cheer.mp3')..HB('Note1','sounds/piano/Note1.mp3')..HB('Note2','sounds/piano/Note2.mp3')..HB('Note3','sounds/piano/Note3.mp3')..HB('Note4','sounds/piano/Note4.mp3')..HB('Note5','sounds/piano/Note5.mp3')..HB('Note6','sounds/piano/Note6.mp3')..HB('Note7','sounds/piano/Note7.mp3')..HB('Note8','sounds/piano/Note8.mp3')..HB('Note9','sounds/piano/Note9.mp3')..HB('Note10','sounds/piano/Note10.mp3')..HB('Note11','sounds/piano/Note11.mp3')..HB('Note12','sounds/piano/Note12.mp3')..HB('Note13','sounds/piano/Note13.mp3')..HB('Note14','sounds/piano/Note14.mp3')..HB('Note15','sounds/piano/Note15.mp3')..HB('Note16','sounds/piano/Note16.mp3')..HB('Note17','sounds/piano/Note17.mp3')..HB('Note18','sounds/piano/Note18.mp3')..HB('Note19','sounds/piano/Note19.mp3')..HB('Note20','sounds/piano/Note20.mp3')..HB('Note21','sounds/piano/Note21.mp3')..HB('Note22','sounds/piano/Note22.mp3')..HB('Note23','sounds/piano/Note23.mp3')..HB('Note24','sounds/piano/Note24.mp3')..HB('Note25','sounds/piano/Note25.mp3')..load().then((UJ)=>vB.JB(new II()));break;case "text":vB.JB(new MI());break;case "tweener":vB.JB(new JI());break;}}}class QI extends RB{QI(){PJ(250);WB.query('#minus10').onClick.listen((g)=>QJ(10));WB.query('#minus50').onClick.listen((g)=>QJ(50));WB.query('#plus50').onClick.listen((g)=>PJ(50));WB.query('#plus10').onClick.listen((g)=>PJ(10));this.oH.listen(RJ);}var SJ=null;RJ( g){if(SJ==null){SJ=1.00/g.RF;}else{SJ=0.05/g.RF+0.95*SJ;}WB.query('#fpsMeter').innerHtml='fps: ${SJ.round()}';}PJ( l){var g=new MC.Random();var i=QB.LF('flags');var j=i.eH;while ( --l>=0){var k=j[g.nextInt(j.length)];var m=i.WC(k);var h=new KI(m,g.nextInt(200)-100,g.nextInt(200)-100);h.x=30+g.nextInt(940-60);h.y=30+g.nextInt(500-60);JB(h);ZB.add(h);}WB.query('#flagCounter').innerHtml='Flags: ${xD}';}QJ( h){while ( --h>=0&&xD>0){var g=iH(0);g.XF();ZB.remove(g);}WB.query('#flagCounter').innerHtml='Flags: ${xD}';}}class aF extends RB{final  jC;final  iC;final  TJ=['C3','C3#','D3','D3#','E3','F3','F3#','G3','G3#','A3','A3#','B3','C4','C4#','D4','D4#','E4','F4','F4#','G4','G4#','A4','A4#','B4','C5'];var VJ=new Map<String,bF>();var WJ;var XJ=0;aF(this.jC,this.iC){for(int h=0,i=0;h<TJ.length;h++ ){var k=QB.KF('Note${h+1}');var j=TJ[h];var g=VJ[j]=new bF(this,j,k);if(j.endsWith('#')){g.x=i-16;g.y=35;JB(g);}else{g.x=i;g.y=35;sD(g,0);i=i+47;}}WJ=new UE(QB.WC('Finger'));WJ.AC=20;JB(WJ);YJ();}YH( g){if(XJ<jC.length&&jC[XJ]==g){if(XJ==jC.length-1)QB.KF('Cheer').play();XJ++ ;YJ();}}wH(){XJ=0;WJ.alpha=1;YJ();}YJ(){var h=WB.query('#lyrics');var m=-1;h.innerHtml='';for(int g=0,j=0;g<iC.length;g++ ){if(iC[g]!='')j=g;if(g==this.XJ)m=j;}for(int g=0;g<iC.length;g++ ){if(g==m){h.appendHtml('<span id="word">${iC[g]}</span>');}else{h.appendHtml(iC[g]);}}if(XJ<jC.length){var k=jC[XJ];if(VJ.containsKey(k)){var i=VJ[k];ZB.uH(WJ);WJ.y=0;var n=new JD(this.WJ,0.4,TC.EH);var l=new JD(this.WJ,0.4,TC.nG);n.gC.x.YC(i.x+i.width/2);l.gC.y.YC(-10);ZB.add(n);ZB.add(l);}}else{var o=new JD(WJ,0.4,TC.ID);o.gC.alpha.YC(0);ZB.add(o);}}}class bF extends pC{final  SF;final  cB;final  ZF;bF(this.SF,this.cB,this.ZF){var h;if(cB.endsWith('#')){h='KeyBlack';}else if(cB.startsWith('C5')){h='KeyWhite0';}else if(cB.startsWith('C')||cB.startsWith('F')){h='KeyWhite1';}else if(cB.startsWith('D')||cB.startsWith('G')||cB.startsWith('A')){h='KeyWhite2';}else if(cB.startsWith('E')||cB.startsWith('B')){h='KeyWhite3';}var i=QB.WC(h);var l=new UE(i);this.JB(l);var j=cB.endsWith('#')?pB.UH:pB.GD;var k=new ZD('Helvetica,Arial',10,j,align:OC.iD);var g=new YI();g.FC=k;g.text=cB;g.width=i.width;g.height=20;g.PF=false;g.y=i.height-20;JB(g);this.FE=true;this.onMouseDown.listen(ZJ);this.onMouseOver.listen(ZJ);this.onMouseUp.listen(aJ);this.onMouseOut.listen(aJ);}ZJ( g){if(g.zB){this.ZF.play();this.alpha=0.7;this.SF.YH(this.cB);}}aJ( g){this.alpha=1.0;}}const RI=const SI();class SI{const SI();}class FB{static const  rF="added";static const  zF="addedToStage";static const  qD="enterFrame";static const  KG="removed";static const  OG="removedFromStage";static const  UG="resize";static const  qG="complete";static const  xE="progress";var OL;var pM;var fM;var MK;var rM;var jM;var nM;FB( g,[ bubbles=false]){MM(g,bubbles);} MM( g,[ bubbles=false]){OL=g;pM=bubbles;fM=qB.SC;MK=null;rM=null;jM=false;nM=false;} get TD=>jM; get type=>OL; get bubbles=>pM; get KD=>true; get target=>MK;}class CD{static const  pF="json";static const  lD="jsonarray";}class cC{static var VG=pG();static var HD=yG();static var rE=zG();static  pG(){var h=(HD!=null)?"WebAudioApi":"AudioElement";var g=WB.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(rE.length==0)h="Mock";print("StageXL: supported audio engine is: ${h}");return h;}static  yG(){if(NE.AudioContext.supported)return new NE.AudioContext();return null;}static  zG(){var g=new List<String>();var h=new WB.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/mp4",""))!=-1)g.add("mp4");if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("StageXL: supported audio types are: ${g}");return g;}static  BF( i, h){var l=new RegExp(r"(mp3|mp4|ogg|wav)$",multiLine:false,caseSensitive:true);var g=rE.toList();var k=l.firstMatch(i);var j=new List<String>();if(k==null){throw new ArgumentError("Unsupported file extension.");}if(g.length==0){throw new UnsupportedError("This browser supports no known audio codec.");}if(!h.mp3)g.remove("mp3");if(!h.mp4)g.remove("mp4");if(!h.ogg)g.remove("ogg");if(!h.wav)g.remove("wav");var m=k.group(1);if(g.contains(m)){j.add(i);g.remove(m);}for(var n in g){j.add(i.replaceAll(l,n));}return j;}}class cD extends gB{var vJ;var OK;var iK;cD(){iK=new List<ED>();vJ=new WB.AudioElement();vJ.onEnded.listen(ZL);OK=new List<WB.AudioElement>();OK.add(vJ);WB.document.body.children.add(vJ);}static  eC( k,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=gB.qE;var m=new cD();var g=m.vJ;var h=cC.BF(k,soundLoadOptions);var i=new OB.Completer<gB>();if(h.length==0){return PC.eC(k,soundLoadOptions);}var j;var l;q(o){j.cancel();l.cancel();i.complete(m);}n(o){if(h.length>0){g.src=h.removeAt(0);g.load();}else{j.cancel();l.cancel();if(soundLoadOptions.ignoreErrors){PC.eC(k,soundLoadOptions).then((p)=>i.complete(p));}else{i.completeError(new StateError("Failed to load audio."));}}}j=g.onCanPlayThrough.listen(q);l=g.onError.listen(n);g.src=h.removeAt(0);g.load();return i.future;} get length{return vJ.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new XB();return new ED(this,loop,soundTransform);} sL( h){var g;if(OK.length==0){g=vJ.clone(true);g.onEnded.listen(ZL);}else{g=OK.removeAt(0);}iK.add(h);return g;} wM( g){var h=g.vJ;var i=iK.indexOf(g);iK.removeAt(i);OK.add(h);if(vJ.currentTime>0&&vJ.ended==false)vJ.currentTime=0;} ZL( j){var i=j.target;var g=null;for(int h=0;h<iK.length&&g==null;h++ )if(iK[h].vJ==i)g=iK[h];if(g!=null)g.stop();}}class ED extends RC{var JK;var vJ;var tJ;var KK;ED( g, i, h){JK=g;tJ=i;KK=h;vJ=g.sL(this);vJ.loop=tJ;this.SD=h;vJ.play();} set SD( g){KK=g;if(vJ!=null)vJ.volume=(KK!=null)?KK.volume:1;} stop(){if(vJ!=null){if(vJ.ended==false)vJ.pause();JK.wM(this);vJ=null;}}}class dD extends gB{var sJ;dD(){if(cC.HD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  eC( h,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=gB.qE;var l=new dD();var g=new OB.Completer<gB>();var i=cC.BF(h,soundLoadOptions);var p=cC.HD;if(i.length==0){return PC.eC(h,soundLoadOptions);}q(m){p.decodeAudioData(m.response,( o){l.sJ=o;g.complete(l);},(n){if(soundLoadOptions.ignoreErrors){PC.eC(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to decode audio."));}});}k(n){if(i.length>0){WB.HttpRequest.request(i.removeAt(0),responseType:'arraybuffer').then(q).catchError(k);}else{if(soundLoadOptions.ignoreErrors){PC.eC(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to load audio."));}}}k(null);return g.future;} get length{return sJ.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new XB();return new VI(this,loop,soundTransform);}}class VI extends RC{var GK;var KK;var tJ;var tK;var DL;VI( j, h, i){GK=j;tJ=h;KK=i;var g=cC.HD;tK=g.createGain();tK.connect(g.destination,0,0);tK.gain.value=(KK!=null)?MC.pow(KK.volume,2):1;DL=g.createBufferSource();DL.buffer=GK.sJ;DL.loop=h;DL.connect(tK,0,0);DL.start(0);} set SD( g){KK=g;tK.gain.value=(KK!=null)?MC.pow(KK.volume,2):1;} stop(){DL.stop(0);}}class PC extends gB{PC(){}static  eC( g,[ soundLoadOptions=null]){return new OB.Future<gB>.value(new PC());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new XB();}return new ZI(this,loop,soundTransform);}}class ZI extends RC{var tJ;var KK;ZI( i, h, g){tJ=h;KK=g;}set SD( g){KK=g;} stop(){}}class qB{static const  XE=1;static const  SC=2;static const  AG=3;}class jF{static const  uF="pixel";}class YI extends IB{var rJ="";var FK=0x000000;var YK=null;var pK=eF.uE;var EL=jF.uF;var OL=gF.oF;var UL=false;var aL=false;var eL=0x000000;var jL=false;var mL=0x000000;var tL=0;var wL=0;var zL;var EM;var HM=true;var KM=100;var LM=100;var PM=null;var VL=null;YI([ text, textFormat]){if(text!=null)rJ=text;if(textFormat!=null)FC=textFormat;else YK=new ZD("Arial",12,0x000000);zL=new List<String>();EM=new List<kF>();} get text=>rJ; get type=>OL; get width=>KM; get height=>LM; set text( g){rJ=g;HM=true;} set FC( g){YK=g;FK=YK.color;HM=true;} set wordWrap( g){UL=g;HM=true;} set width( g){KM=g;HM=true;} set height( g){LM=g;HM=true;} kB( g,[ returnRectangle]){return rD(g,KM,LM,returnRectangle);} iB( g, h){if(g>=0&&h>=0&&g<KM&&h<LM)return this;return null;} KB( g){xN();g.VL.drawImage(PM,0.0,0.0);} zN( o){var n=BG(o);zL.clear();EM.clear();if(UL==false){for(String h in rJ.replaceAll('\r','').split('\n'))zL.add(h);}else{for(String h in rJ.replaceAll('\r','').split('\n')){var g='';for(String j in h.split(' ')){var m=g;g=(g.length==0)?j:g+' '+j;if(VL.measureText(g).width>KM){if(m.length==0){zL.add(g);g='';}else{zL.add(m);g=j;}}}if(g.isEmpty==false){zL.add(g);}}}tL=0;wL=0;for(String g in zL){var k=VL.measureText(g);var l=0.0;if(YK.align==OC.iD||YK.align==OC.CG)l=(KM-k.width)/2;if(YK.align==OC.kE||YK.align==OC.vF)l=KM-k.width;var i=new kF(l,k.width,YK.size,n.tC,n.ND,0);EM.add(i);tL=MC.max(tL,i.width);wL=wL+i.height;}} xN(){if(HM){HM=false;var h=KM.ceil().toInt();var i=LM.ceil().toInt();if(PM==null){PM=new WB.CanvasElement(width:h,height:i);VL=PM.context2D;}if(PM.width!=h)PM.width=h;if(PM.height!=i)PM.height=i;var m=new StringBuffer()..write(YK.italic?"italic ":"normal ")..write("normal ")..write(YK.bold?"bold ":"normal ")..write("${YK.size}px ")..write("${YK.font},sans-serif");var j=m.toString();VL.font=j;VL.textAlign="start";VL.textBaseline="alphabetic";VL.fillStyle=rC(FK);zN(j);if(aL){VL.fillStyle=rC(eL);VL.fillRect(0,0,KM,LM);}else{VL.clearRect(0,0,KM,LM);}var k=YK.size;for(int g=0;g<zL.length;g++ ){var l=EM[g];VL.fillStyle=rC(FK);VL.fillText(zL[g],l.x,k);k+= l.height;}if(jL){VL.strokeStyle=rC(mL);VL.lineWidth=1;VL.strokeRect(0,0,KM,LM);}}}}class eF{static const  uE="none";}class gF{static const  oF="dynamic";}class ZD{var font;var size;var color;var bold;var italic;var underline;var align;var leftMargin;var rightMargin;var indent;var leading;var letterSpacing=0;var eI=0;var fI=false;var qI=false;ZD(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.leftMargin: 0,this.rightMargin: 0,this.indent: 0,this.leading: 0});}class OC{static const  iD="center";static const  vF="end";static const  CG="justify";static const  kE="right";}class kF{var tC;var ND;var height;var leading;var width;var x;kF(this.x,this.width,this.height,this.tC,this.ND,this.leading);}class dC{static const  mF=0;static const  sF=1;static const  kE=2;static const  EG=3;static const  gE=4;}class NC{static var WE=fB.hD;static var tF=false;static var cE=null;static var GG=null;static var JG=null;static var QG=new OB.StreamController<String>();static var XG=QG.stream.asBroadcastStream();static  zE( i){var h=i;var g="auto";if(WE!=fB.hD){h=WE;}switch (h){case fB.hD:g="auto";break;case fB.kD:g="default";break;case fB.nD:g="pointer";break;case fB.HG:g="move";break;case fB.IG:g="text";break;case fB.LG:g="wait";break;}if(tF){g="none";}return g;}}class fB{static const  hD="auto";static const  kD="arrow";static const  nD="button";static const  HG="hand";static const  IG="ibeam";static const  LG="wait";}class pB{static const  GD=0xFF000000;static const  aG=0xFF0000FF;static const  uG=0xFFA9A9A9;static const  GH=0xFF008000;static const  CF=0xFFFF0000;static const  UH=0xFFFFFFFF;}class TE{static const  uE="none";static const  DG="touchPoint";}class nC{var LC=null;nC();factory nC.xI( i, g, h, j){return new aI(i,g,h,j);}factory nC.zI( i, g, h){return new bI(i,g,h);}factory nC.AJ( g){return new cI(g);} KB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.SB,g.TB);}}class SE{var BK;SE(){BK=new Map<String,DD>();} WL( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(BK.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");BK[i]=g;} OM( i, g){var h="${i}.${g}";if(BK.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return BK[h];} jB( i, h,[ bitmapDataLoadOptions=null]){var g=new DD("BitmapData",i,h);g.SM(CB.eC(h,bitmapDataLoadOptions));WL(g);} HB( i, h,[ soundFileSupport=null]){var g=new DD("Sound",i,h);g.SM(gB.eC(h,soundFileSupport));WL(g);} DF( j, h, i){var g=new DD("TextureAtlas",j,h);g.SM(xB.eC(h,i));WL(g);} load(){var h=this.rH.map((i)=>i.QK);return OB.Future.wait(h).then((j){var g=this.dH;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get rH{return BK.values.where((g)=>g.QD==null).toList();} get dH{return BK.values.where((g)=>g.error!=null).toList();} WC( g){return OM("BitmapData",g).QD;} KF( g){return OM("Sound",g).QD;} LF( g){return OM("TextureAtlas",g).QD;}}class DD{var kJ;var xJ;var IK;var QK;var cK;var hK;DD( g, h, i){kJ=g;xJ=h;IK=i;cK=null;hK=null;} get kind=>kJ; get name=>xJ; get QD=>hK; get error=>cK;SM( i){QK=i.then((g){hK=g;cK=null;},onError:(h){hK=null;cK=h;});}}class xB{final  uJ=new List<QE>();var ZK;static  eC( n, w){var k=new OB.Completer<xB>();var g=new xB();switch (w){case CD.pF:case CD.lD:WB.HttpRequest.getString(n).then((t){var o=BI.parse(t);var h=o["frames"];var p=o["meta"];var GB=FH(n,p["image"]);if(h is List){for(var q in h){var j=q as Map;var i=j["filename"] as String;var l=AF(i);var m=new QE.BJ(g,l,j);g.uJ.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=AF(i);var m=new QE.BJ(g,l,j);g.uJ.add(m);}}CB.eC(GB).then(( DB){g.ZK=DB;k.complete(g);}).catchError((u){k.completeError(new StateError("Failed to load image."));});}).catchError((u){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} WC( h){for(int g=0;g<uJ.length;g++ )if(uJ[g].name==h)return new CB.HJ(uJ[g]);throw new ArgumentError("TextureAtlasFrame not found: '${h}'");} hH( i){var h=new List<CB>();for(int g=0;g<uJ.length;g++ )if(uJ[g].name.startsWith(i))h.add(new CB.HJ(uJ[g]));return h;} get eH{return uJ.map((g)=>g.name).toList(growable:false);}}class WI extends hB{var blurX;var blurY;WI([this.blurX=4,this.blurY=4]){if(blurX<1||blurY<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(blurX>128||blurY>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} clone(){return new WI(blurX,blurY);} apply( ZC, q, BC, lB){var CC=ZC.sM();var LB=CC.getImageData(q.x,q.y,q.width,q.height);var mB=LB.data;var w=LB.width;var dB=LB.height;var UB=blurX*blurX;var nB=blurY*blurY;var tB=(1<<22)~/UB;var aC=(1<<22)~/nB;var l=blurX;var oB=blurX*2;var u=blurY;var eB=blurY*2;var MB=w+oB;var DB=dB+eB;var uB=w*4;var GB=MB*4;var VB=BC.sM();var PB=VB.createImageData(MB,DB);var t=PB.data;var j=new List<int>(1024);JH(mB);for(int i=0;i<4;i++ ){for(int h=0;h<w;h++ ){var k=0,m=nB>>1;var n=h*4+i;var o=(h+l)*4+i;for(int g=0;g<DB;g++ ){t[o]=(m*aC)>>22;o+= GB;if(g>=eB){k-= 2*j[g&1023]-j[(g-u)&1023];}else if(g>=u){k-= 2*j[g&1023];}var p=(g<dB)?mB[n]:0;j[(g+u)&1023]=p;m+= k+= p;n+= uB;}}}for(int i=0;i<4;i++ ){for(int g=0;g<DB;g++ ){var k=0,m=UB>>1;var n=g*GB+l*4+i;var o=g*GB+i;for(int h=0;h<MB;h++ ){t[o]=(m*tB)>>22;o+= 4;if(h>=oB){k-= 2*j[h&1023]-j[(h-l)&1023];}else if(h>=l){k-= 2*j[h&1023];}var p=(h<w)?t[n]:0;j[(h+l)&1023]=p;m+= k+= p;n+= 4;}}}NH(t);VB.putImageData(PB,lB.x-l,lB.y-u);}}class QE{final  nJ;final  xJ;final  TK;final  eK;final  sK;final  zK;final  HL;final  ML;final  RL;final  TL;final  YL;QE.BJ( i, h, g):nJ=i,xJ=h,TK=oG(g["rotated"]),eK=DC(g["sourceSize"]["w"]),sK=DC(g["sourceSize"]["h"]),zK=DC(g["spriteSourceSize"]["x"]),HL=DC(g["spriteSourceSize"]["y"]),ML=DC(g["frame"]["x"]),RL=DC(g["frame"]["y"]),TL=DC(g["frame"]["w"]),YL=DC(g["frame"]["h"]); get zH=>nJ; get name=>xJ; get xH=>TK; get fH=>ML; get gH=>RL; get JF=>TL; get IF=>YL; get offsetX=>zK; get offsetY=>HL; get qH=>eK; get pH=>sK;}class fF<qC>{final  iJ=new List<qC>();final  LK;var WK=0;fF( g()):LK=g; TF(){if(WK==0){return LK();}else{WK-- ;return iJ[WK];}}UF( g){if(WK==iJ.length){iJ.add(g);}else{iJ[WK]=g;}WK++ ;}reset(){iJ.clear();WK=0;}}class cF extends IB implements yB{var NK;var XK;var gK;var rK;var wK;var tJ;var FL;var KL;var VC;cF( g,[ frameRate=30, loop=true]){NK=g;XK=frameRate;gK=0;rK=null;wK=false;tJ=loop;FL=new FB(FB.xE);KL=new FB(FB.qG);VC=null;}static const  tG=const aB<FB>(FB.xE); get onProgress=>cF.tG.forTarget(this); get CE=>NK.length; set loop( g){tJ=g;} play(){wK=true;rK=null;} stop(){wK=false;rK=null;} EC( j){if(wK==false)return true;if(rK==null){rK=0.0;UM(FL,this,this,qB.SC);}else{rK+= j;var i=1.0/XK;while (wK&&rK>=i){var h=gK;var g=tJ?(h+1)%CE:MC.min(h+1,CE-1);gK=g;rK-= i;if(h!=g){UM(FL,this,this,qB.SC);if(gK!=g)return true;}if(h!=g&&g==CE-1&&tJ==false){UM(KL,this,this,qB.SC);if(gK!=g)return true;}}}return true;} kB( h,[ returnRectangle]){var g=NK[gK];return rD(h,g.width,g.height,returnRectangle);} iB( g, h){var i=NK[gK];if(g>=0&&h>=0&&g<i.width&&h<i.height)return this;return null;} KB( g){var h=NK[gK];if(VC==null)h.KB(g);else h.YF(g,VC);}}final  gD=new Map<String,tE>();abstract class hB{ clone(); apply( h, i, j, g);}class NB extends FB{static const  ZE="touchBegin";static const  bE="touchEnd";static const  eE="touchCancel";static const  lE="touchMove";static const  PG="touchOver";static const  TG="touchOut";var WM;var XM;var aM,bM;var cM,eM;var fL;var uL;var gL;var kL;var kM;var lM;var mM;NB( g,[ bubbles=false]):super(g,bubbles){MM(g,bubbles);} MM( g,[ bubbles=false]){super.MM(g,bubbles);WM=0;XM=false;aM=bM=0;cM=eM=0;fL=false;uL=false;gL=false;kL=false;kM=1.00;lM=0;mM=0;}set GN( g){aM=g.x;bM=g.y;}set JN( g){cM=g.x;eM=g.y;} get UD=>WM; get altKey=>fL; get ctrlKey=>gL; get shiftKey=>kL;}class kC{static const  nF="exactFit";static const  wF="noBorder";static const  FG="noScale";static const  hE="showAll";}class PE extends FB{static const  xF="textInput";var rJ="";PE( g,[ bubbles=false]):super(g,bubbles); get text=>rJ;}final  FD=new fF<List<s>>(()=>new List<s>());class RE extends IB{RE();}abstract class eD{ KB( g);}class bD{var png;var jpg;var webp;bD({this.png: true,this.jpg: true,this.webp: false});}class rB extends FB{static const  jD="keyDown";static const  aE="keyUp";var fL;var gL;var kL;var nL;var uL;var yL;var BM;var DM;rB( g,[ bubbles=false]):super(g,bubbles){MM(g,bubbles);} MM( g,[ bubbles=false]){super.MM(g,bubbles);fL=false;gL=false;kL=false;nL=false;uL=false;yL=0;BM=0;DM=0;} get altKey=>fL; get ctrlKey=>gL; get shiftKey=>kL; get charCode=>yL; get keyCode=>BM; get keyLocation=>DM;}class UE extends s{var bitmapData;var pixelSnapping;var VC;UE([this.bitmapData=null,this.pixelSnapping="auto"]){VC=null;} kB( h,[ returnRectangle]){var g=(bitmapData!=null)?bitmapData.width:0;var i=(bitmapData!=null)?bitmapData.height:0;return rD(h,g,i,returnRectangle);} iB( g, h){if(bitmapData!=null&&g>=0.0&&h>=0.0&&g<bitmapData.width&&h<bitmapData.height)return this;return null;} KB( g){if(bitmapData==null)return;if(VC==null){bitmapData.KB(g);}else{bitmapData.YF(g,VC);}}}class pC extends RB{var gI=false;var FE=false;var uD=null;var oK=null;var yK=null;tM(){var i=this.OD;var j=this.XC;var m=this.visible;if(i!=null&&this.XC!=null){var h=NC.JG;if(h!=null){var g=CN.VD(i);if(g.x<h.left)g.x=h.left;if(g.x>h.right)g.x=h.right;if(g.y<h.top)g.y=h.top;if(g.y>h.bottom)g.y=h.bottom;i=CN.EF().VD(g);}var l=new AB(lL,oL).add(i).subtract(NC.GG);var k=CN.VD(l);this.visible=false;yK=j.iB(j.mH,j.nH);this.x=k.x;this.y=k.y;this.visible=m;}} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new BB.yI();super.kB(g,returnRectangle);if(oK!=null){returnRectangle=oK.hN(g).union(returnRectangle);}return returnRectangle;} iB( i, j){var h=null;if(this.uD!=null){var g=this.DE(this.uD);if(g!=null){var k=i*g.a+j*g.c+g.SB;var l=i*g.b+j*g.d+g.TB;if(this.uD.iB(k,l)!=null){h=this;}}}else{h=super.iB(i,j);if(h==null&&oK!=null){if(oK.sN(i,j)){h=this;}}}return h;}KB( g){if(oK!=null)oK.KB(g);super.KB(g);}}class XB{var volume;var pan;var rI=1;var sI=0;var vI=1;var uI=0;XB([this.volume=1,this.pan=0]);}class iF{iF();}abstract class gB{static  eC( g,[ soundLoadOptions=null]){switch (cC.VG){case "WebAudioApi":return dD.eC(g,soundLoadOptions);case "AudioElement":return cD.eC(g,soundLoadOptions);default:return PC.eC(g,soundLoadOptions);}}static var qE=new QC(mp3:true,mp4:true,ogg:true,wav:true); get length; play([ loop=false, soundTransform]);}abstract class RB extends IB{final  RK=new List<s>();var nK=true;var xK=true; get xD=>RK.length; JB( g){if(g.parent==this){var h=RK.indexOf(g);RK.removeAt(h);RK.add(g);}else{sD(g,RK.length);}} sD( g, h){if(h<0||h>RK.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){RK.removeAt(RK.indexOf(g));if(h>RK.length)h-- ;RK.insert(h,g);}else{g.XF();g.LN(this);RK.insert(h,g);g.dispatchEvent(new FB(FB.rF,true));if(this.XC!=null)SN(g,new FB(FB.zF));}} WF( h){var g=RK.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");sH(g);} sH( g){if(g<0||g>=RK.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=RK[g];h.dispatchEvent(new FB(FB.KG,true));if(this.XC!=null)SN(h,new FB(FB.OG));h.LN(null);RK.removeAt(g);} iH( g){if(g<0||g>=RK.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return RK[g];} yH( g){RK.sort(g);} contains( g){for(;g!=null;g=g.gM)if(g==this)return true;return false;} kB( n,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new BB.yI();if(RK.length==0)return super.kB(n,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var o=RK.length;for(int l=0;l<RK.length;l++ ){var m=RK[l];hM.FF(m.CN,n);var g=m.kB(hM,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} iB( o, p){var l=null;for(int j=RK.length-1;j>=0;j-- ){var i=RK[j];if(i.visible){var g=i.CN;var m=o-g.SB;var k=p-g.TB;var q=(g.d*m-g.c*k)/g.hC;var n=(g.a*k-g.b*m)/g.hC;var h=i.iB(q,n);if(h!=null){if(h is IB)if(h.PF)return nK?h:this;l=this;}}}return l;} KB( i){for(int h=0;h<RK.length;h++ ){var g=RK[h];if(!g.JM&&g.visible)i.vH(g);}}CO( g, i){i.add(g);if(g is RB){var k=g as RB;var j=k.RK;for(int h=0;h<j.length;h++ ){CO(j[h],i);}}}SN( i, j){var g=FD.TF() as List<s>;CO(i,g);for(int h=0;h<g.length;h++ ){g[h].dispatchEvent(j);}g.clear();FD.UF(g);}}class v extends FB{static const  YE="click";static const  yF="doubleClick";static const  dE="mouseDown";static const  jE="mouseUp";static const  mE="mouseMove";static const  nE="mouseOut";static const  oE="mouseOver";static const  pE="mouseWheel";static const  sE="middleClick";static const  eG="middleMouseDown";static const  iG="middleMouseUp";static const  vE="rightClick";static const  mG="rightMouseDown";static const  rG="rightMouseUp";var aM,bM;var cM,eM;var uM;var fL;var uL;var gL;var kL;var yM;var zM;var AN;v( g,[ bubbles=false]):super(g,bubbles){MM(g,bubbles);} MM( g,[ bubbles=false]){super.MM(g,bubbles);aM=bM=0;cM=eM=0;uM=false;fL=false;uL=false;gL=false;kL=false;yM=0;zM=0;AN=0;}set GN( g){aM=g.x;bM=g.y;}set JN( g){cM=g.x;eM=g.y;} get zB=>uM; get altKey=>fL; get ctrlKey=>gL; get shiftKey=>kL; get uC=>yM; get deltaX=>zM; get deltaY=>AN;}class mC extends FB{var mJ;mC( g):super(FB.qD,false){mJ=g;} get RF=>mJ; get KD=>false;}class OE implements yB{final  wJ;var HK=0.0;var UK=0.0;var fK=1;OE( g, h):wJ=g{UK=MC.max(h,0.0001);} EC( h){var g=HK+h;while (g>=UK&&fK>0){HK=UK;fK-- ;wJ();g-= UK;}HK=g;return (fK>0);} get currentTime=>HK;}abstract class yB{ EC( g);}class XI extends hB{final  DK;XI( h):DK=new List<num>(20){if(h.length!=20)throw new ArgumentError("The supplied matrix needs to be a 4 x 5 matrix.");for(int g=0;g<h.length;g++ )DK[g]=h[g];}XI.DJ():DK=[0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0,0,0,1,0];XI.FJ():DK=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]; clone(){return new XI(DK);} apply( BC, m, CC, tB){var q=BC.sM().getImageData(m.x,m.y,m.width,m.height);var h=q.data;var lB=(DK[00]*65536).toInt();var PB=(DK[01]*65536).toInt();var uB=(DK[02]*65536).toInt();var p=(DK[03]*65536).toInt();var mB=(DK[04]*65536).toInt();var oB=(DK[05]*65536).toInt();var VB=(DK[06]*65536).toInt();var eB=(DK[07]*65536).toInt();var w=(DK[08]*65536).toInt();var n=(DK[09]*65536).toInt();var t=(DK[10]*65536).toInt();var u=(DK[11]*65536).toInt();var dB=(DK[12]*65536).toInt();var nB=(DK[13]*65536).toInt();var GB=(DK[14]*65536).toInt();var DB=(DK[15]*65536).toInt();var UB=(DK[16]*65536).toInt();var LB=(DK[17]*65536).toInt();var o=(DK[18]*65536).toInt();var MB=(DK[19]*65536).toInt();if(UC){for(int g=0;g<=h.length-4;g+= 4){var k=h[g+0];var l=h[g+1];var j=h[g+2];var i=h[g+3];h[g+0]=((lB*k)+(PB*l)+(uB*j)+(p*i)+mB)>>16;h[g+1]=((oB*k)+(VB*l)+(eB*j)+(w*i)+n)>>16;h[g+2]=((t*k)+(u*l)+(dB*j)+(nB*i)+GB)>>16;h[g+3]=((DB*k)+(UB*l)+(LB*j)+(o*i)+MB)>>16;}}else{for(int g=0;g<=h.length-4;g+= 4){var i=h[g+0];var j=h[g+1];var l=h[g+2];var k=h[g+3];h[g+0]=((DB*k)+(UB*l)+(LB*j)+(o*i)+MB)>>16;h[g+1]=((t*k)+(u*l)+(dB*j)+(nB*i)+GB)>>16;h[g+2]=((oB*k)+(VB*l)+(eB*j)+(w*i)+n)>>16;h[g+3]=((lB*k)+(PB*l)+(uB*j)+(p*i)+mB)>>16;}}CC.sM().putImageData(q,tB.x,tB.y);}}abstract class IB extends s{var bH=false;var PF=true;var wI=true;var tabIndex=0;static const  MG=const aB<v>(v.nE);static const  YG=const aB<v>(v.oE);static const  fG=const aB<v>(v.mE);static const  jG=const aB<v>(v.dE);static const  sG=const aB<v>(v.jE);static const  CH=const aB<v>(v.pE); get onMouseOut=>IB.MG.forTarget(this); get onMouseOver=>IB.YG.forTarget(this); get onMouseMove=>IB.fG.forTarget(this); get onMouseDown=>IB.jG.forTarget(this); get onMouseUp=>IB.sG.forTarget(this); get onMouseWheel=>IB.CH.forTarget(this);static const  KH=const aB<NB>(NB.lE);static const  LH=const aB<NB>(NB.bE);static const  MH=const aB<NB>(NB.eE); get onTouchMove=>IB.KH.forTarget(this); get onTouchEnd=>IB.LH.forTarget(this); get onTouchCancel=>IB.MH.forTarget(this);static const  PH=const aB<rB>(rB.aE);static const  QH=const aB<rB>(rB.jD); get onKeyUp=>IB.PH.forTarget(this); get onKeyDown=>IB.QH.forTarget(this);}class VE{final  EE;VE(this.EE);call( h, g){qK(h).YC(g);} get x=>qK("x"); get y=>qK("y"); get JC=>qK("scaleX"); get KC=>qK("scaleY"); get skewX=>qK("skewX"); get skewY=>qK("skewY"); get AC=>qK("pivotX"); get HC=>qK("pivotY"); get IC=>qK("rotation"); get alpha=>qK("alpha"); qK( h){var g=new bB(h);this.EE.qK(g);return g;}}class UI extends hB{var color;var alpha;var blurX;var blurY;var strength;var inner;var knockout;var hideObject;UI([this.color=0,this.alpha=1.0,this.blurX=4,this.blurY=4,this.strength=2.0,this.inner=false,this.knockout=false,this.hideObject=false]){if(blurX<1||blurY<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(blurX>128||blurY>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} clone(){return new UI(color,alpha,blurX,blurY,strength,inner,knockout,hideObject);} apply( n, k, vC, GB){if(n==vC&&!hideObject){var lB=new CB(k.width,k.height);lB.GF(n,k,new AB.yI());n=lB;k=new BB(0,0,n.width,n.height);}var mB=n.sM();var GE=mB.getImageData(k.x,k.y,k.width,k.height);var HE=GE.data;var p=k.width;var dB=k.height;var oB=blurX*blurX;var CC=blurY*blurY;var IE=(1<<22)~/oB;var JE=(1<<22)~/CC;var o=blurX;var wC=blurX*2;var PB=blurY;var aC=blurY*2;var VB=p+wC;var MB=dB+aC;var KE=p*4;var eB=VB*4;var LB=UC?3:0;var q=vC.sM();var uB=q.createImageData(VB,MB);var g=uB.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){var m=0,u=CC>>1;var t=j*4+LB;var w=(j+o)*4+LB;for(int i=0;i<MB;i++ ){g[w]=(u*JE)>>22;w+= eB;if(i>=aC){m-= 2*l[i&1023]-l[(i-PB)&1023];}else if(i>=PB){m-= 2*l[i&1023];}var DB=(i<dB)?HE[t]:0;l[(i+PB)&1023]=DB;u+= m+= DB;t+= KE;}}for(int i=0;i<MB;i++ ){var m=0,u=oB>>1;var t=i*eB+o*4+LB;var w=i*eB+LB;for(int j=0;j<VB;j++ ){g[w]=(u*IE)>>22;w+= 4;if(j>=wC){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}var DB=(j<p)?g[t]:0;l[(j+o)&1023]=DB;u+= m+= DB;t+= 4;}}var tB=(alpha*256).toInt();var ZC=(color>>16)&0xFF;var xC=(color>>8)&0xFF;var nB=(color>>0)&0xFF;if(UC){for(var h=0;h<=g.length-4;h+= 4){g[h+0]=ZC;g[h+1]=xC;g[h+2]=nB;g[h+3]=(g[h+3]*tB)>>8;}}else{for(var h=0;h<=g.length-4;h+= 4){g[h+0]=(g[h+0]*tB)>>8;g[h+1]=nB;g[h+2]=xC;g[h+3]=ZC;}}var yC=GB.x;var BC=GB.y;var zC=GB.x-o;var AD=GB.y-PB;var LE=new BB(yC,BC,p,dB);var ME=new BB(zC,AD,VB,MB);var UB=LE.union(ME);q.setTransform(1,0,0,1,0,0);q.clearRect(UB.x,UB.y,UB.width,UB.height);q.putImageData(uB,zC,AD);if(this.hideObject==false)q.drawImage(mB.canvas,yC,BC);}}class TI extends hB{var distance;var angle;var color;var alpha;var blurX;var blurY;var strength;var inner;var knockout;var hideObject;TI([this.distance=4.0,this.angle=MC.PI/4,this.color=0,this.alpha=1.0,this.blurX=4,this.blurY=4,this.strength=1.0,this.inner=false,this.knockout=false,this.hideObject=false]){if(blurX<1||blurY<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(blurX>128||blurY>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} clone(){return new TI(distance,angle,color,alpha,blurX,blurY,strength,inner,knockout,hideObject);} apply( n, k, vC, GB){if(n==vC&&!hideObject){var lB=new CB(k.width,k.height);lB.GF(n,k,new AB.yI());n=lB;k=new BB(0,0,n.width,n.height);}var mB=n.sM();var GE=mB.getImageData(k.x,k.y,k.width,k.height);var HE=GE.data;var p=k.width;var dB=k.height;var oB=blurX*blurX;var CC=blurY*blurY;var IE=(1<<22)~/oB;var JE=(1<<22)~/CC;var o=blurX;var wC=blurX*2;var PB=blurY;var aC=blurY*2;var VB=p+wC;var MB=dB+aC;var KE=p*4;var eB=VB*4;var LB=UC?3:0;var q=vC.sM();var uB=q.createImageData(VB,MB);var g=uB.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){var m=0,u=CC>>1;var t=j*4+LB;var w=(j+o)*4+LB;for(int i=0;i<MB;i++ ){g[w]=(u*JE)>>22;w+= eB;if(i>=aC){m-= 2*l[i&1023]-l[(i-PB)&1023];}else if(i>=PB){m-= 2*l[i&1023];}var DB=(i<dB)?HE[t]:0;l[(i+PB)&1023]=DB;u+= m+= DB;t+= KE;}}for(int i=0;i<MB;i++ ){var m=0,u=oB>>1;var t=i*eB+o*4+LB;var w=i*eB+LB;for(int j=0;j<VB;j++ ){g[w]=(u*IE)>>22;w+= 4;if(j>=wC){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}var DB=(j<p)?g[t]:0;l[(j+o)&1023]=DB;u+= m+= DB;t+= 4;}}var tB=(alpha*256).toInt();var ZC=(color>>16)&0xFF;var xC=(color>>8)&0xFF;var nB=(color>>0)&0xFF;if(UC){for(var h=0;h<=g.length-4;h+= 4){g[h+0]=ZC;g[h+1]=xC;g[h+2]=nB;g[h+3]=(g[h+3]*tB)>>8;}}else{for(var h=0;h<=g.length-4;h+= 4){g[h+0]=(g[h+0]*tB)>>8;g[h+1]=nB;g[h+2]=xC;g[h+3]=ZC;}}var yC=GB.x;var BC=GB.y;var zC=GB.x-o+(this.distance*MC.cos(this.angle)).round().toInt();var AD=GB.y-PB+(this.distance*MC.sin(this.angle)).round().toInt();var LE=new BB(yC,BC,p,dB);var ME=new BB(zC,AD,VB,MB);var UB=LE.union(ME);q.setTransform(1,0,0,1,0,0);q.clearRect(UB.x,UB.y,UB.width,UB.height);q.putImageData(uB,zC,AD);if(this.hideObject==false)q.drawImage(mB.canvas,yC,BC);}}class AB{var bJ;var fJ;AB( h, g):bJ=h,fJ=g;AB.yI():this(0,0); clone()=>new AB(bJ,fJ); toString()=>"Point [x=${bJ}, y=${fJ}]"; get x=>bJ; get y=>fJ; get length=>MC.sqrt(bJ*bJ+fJ*fJ);set x( g){bJ=g;}set y( g){fJ=g;} add( g){return new AB(bJ+g.x,fJ+g.y);} subtract( g){return new AB(bJ-g.x,fJ-g.y);}MD( g){bJ=g.x;fJ=g.y;} HF( g){return bJ==g.x&&fJ==g.y;}}class BB{var bJ;var fJ;var lJ;var yJ;BB( i, g, h, j):bJ=i,fJ=g,lJ=h,yJ=j;BB.yI():this(0,0,0,0); clone()=>new BB(bJ,fJ,lJ,yJ); toString()=>"Rectangle [x=${bJ}, y=${fJ}, width=${lJ}, height=${yJ}]"; get x=>bJ; get y=>fJ; get width=>lJ; get height=>yJ; get left=>bJ; get top=>fJ; get right=>bJ+lJ; get bottom=>fJ+yJ; get size=>new AB(lJ,yJ);set x( g){bJ=g;}set y( g){fJ=g;}set width( g){lJ=g;}set height( g){yJ=g;} contains( g, h){return bJ<=g&&fJ<=h&&bJ+lJ>=g&&fJ+yJ>=h;} HF( g){return bJ==g.x&&fJ==g.y&&lJ==g.width&&yJ==g.height;} get isEmpty{return lJ==0&&yJ==0;}MD( g){bJ=g.x;fJ=g.y;lJ=g.width;yJ=g.height;} union( g){var i=MC.min(this.left,g.left);var h=MC.min(this.top,g.top);var j=MC.max(this.right,g.right);var k=MC.max(this.bottom,g.bottom);return new BB(i,h,j-i,k-h);} align(){var h=this.left.floor();var g=this.top.floor();var i=this.right.ceil();var j=this.bottom.ceil();return new BB(h,g,i-h,j-g);}}class dF{var x;var y;var VF;dF(this.x,this.y,this.VF);}class EB{var cJ,dJ,gJ,hJ,jJ,oJ;var zJ;EB( h, i, g, j, k, l):cJ=h.toDouble(),dJ=i.toDouble(),gJ=g.toDouble(),hJ=j.toDouble(),jJ=k.toDouble(),oJ=l.toDouble(),zJ=(h*j-i*g).toDouble();EB.CJ():cJ=1.0,dJ=0.0,gJ=0.0,hJ=1.0,jJ=0.0,oJ=0.0,zJ=1.0; clone(){return new EB(cJ,dJ,gJ,hJ,jJ,oJ);} EF(){var h=(hJ/zJ);var i=-(dJ/zJ);var g=-(gJ/zJ);var j=(cJ/zJ);var k=-(h*jJ+g*oJ);var l=-(i*jJ+j*oJ);return new EB(h,i,g,j,k,l);} get a=>cJ; get b=>dJ; get c=>gJ; get d=>hJ; get SB=>jJ; get TB=>oJ; get hC=>zJ; VD( h){var i=h.x.toDouble();var g=h.y.toDouble();return new AB(i*cJ+g*gJ+jJ,i*dJ+g*hJ+oJ);} ON( h){var i=h.x.toDouble();var g=h.y.toDouble();return new AB(i*cJ+g*gJ+jJ,i*dJ+g*hJ+oJ);} concat( g){var m=cJ;var p=dJ;var q=gJ;var o=hJ;var l=jJ;var n=oJ;var u=zJ;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var w=g.SB;var t=g.TB;var DB=g.hC;cJ=(m*j+p*i).toDouble();dJ=(m*k+p*h).toDouble();gJ=(q*j+o*i).toDouble();hJ=(q*k+o*h).toDouble();jJ=(l*j+n*i+w).toDouble();oJ=(l*k+n*h+t).toDouble();zJ=(u*DB).toDouble();} jH(){cJ=1.0;dJ=0.0;gJ=0.0;hJ=1.0;jJ=0.0;oJ=0.0;zJ=1.0;} vD(){var j=cJ;var m=dJ;var l=gJ;var k=hJ;var h=jJ;var i=oJ;var g=zJ;cJ=(k/g).toDouble();dJ=-(m/g).toDouble();gJ=-(l/g).toDouble();hJ=(j/g).toDouble();jJ=-(cJ*h+gJ*i).toDouble();oJ=-(dJ*h+hJ*i).toDouble();zJ=(1.0/g).toDouble();} RD( h, i, g, k, j, l){cJ=h.toDouble();dJ=i.toDouble();gJ=g.toDouble();hJ=k.toDouble();jJ=j.toDouble();oJ=l.toDouble();zJ=(cJ*hJ-dJ*gJ).toDouble();} MD( g){cJ=g.a.toDouble();dJ=g.b.toDouble();gJ=g.c.toDouble();hJ=g.d.toDouble();jJ=g.SB.toDouble();oJ=g.TB.toDouble();zJ=g.hC.toDouble();} FF( h, g){var n=h.a;var q=h.b;var t=h.c;var p=h.d;var m=h.SB;var o=h.TB;var w=h.hC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var DB=g.SB;var u=g.TB;var GB=g.hC;cJ=(n*k+q*j).toDouble();dJ=(n*l+q*i).toDouble();gJ=(t*k+p*j).toDouble();hJ=(t*l+p*i).toDouble();jJ=(m*k+o*j+DB).toDouble();oJ=(m*l+o*i+u).toDouble();zJ=(w*GB).toDouble();}}class aD{var eJ;var qJ;var EK;var VK;var mK;aD(){eJ=new lC();qJ=new List<fC>();EK=double.NAN;VK=BD.iE;mK=new mC(0);WB.window.requestAnimationFrame(rL);} get wD=>eJ; rL( g){WB.window.requestAnimationFrame(rL);if(EK.isNaN)EK=g;if(EK>g)EK=g;var k=g-EK;var h=k/1000.0;var l=g/1000.0;if(k>=1){EK=g;mK.mJ=h;VK.dM(mK);eJ.EC(h);for(int i=0;i<qJ.length;i++ ){var j=qJ[i];j.wD.EC(h);j.lH(l,h);}}} VH( g){if(g.zD!=null){g.zD.tH(g);}qJ.add(g);g.QN=this;} tH( g){if(g.zD==this){qJ.remove(g);g.QN=null;}}}abstract class RC extends wB{ set SD( g); stop();}class QC{var mp3;var mp4;var ogg;var wav;var ignoreErrors;QC({this.mp3: false,this.mp4: false,this.ogg: false,this.wav: false,this.ignoreErrors: true});}class hF{}class oC{final  matrix=new EB.CJ();final  next;var alpha=1.0;var LD=mD.oD;oC(this.next);}class wB{var pJ;var SK;dispatchEvent( g){UM(g,this,this,qB.SC);} vM( h, j, i){if(j&&SK!=null){var g=SK[h];if(g!=null&&g.DN)return true;}if(i&&pJ!=null){var g=pJ[h];if(g!=null&&g.DN)return true;}return false;} JL( h, g){if(g){if(SK==null)SK=new Map<String,bC>();}else{if(pJ==null)pJ=new Map<String,bC>();}var i=g?SK:pJ;return i.putIfAbsent(h,(){return new bC(this,h,g);});}UM( g, k, l, j){var h=(j==qB.XE)?SK:pJ;if(h==null)return;var i=h[g.type];if(i==null)return;g.MK=k;g.rM=l;g.fM=j;g.jM=false;g.nM=false;i.dM(g);}}class BD<qC extends FB>{final  pJ=new List<bC>();var dK=0;static var iE=new BD<mC>(); iL( g){for(int h=0;h<dK;h++ ){if(pJ[h]==g)return;}if(dK==pJ.length){pJ.add(g);}else{pJ[dK]=g;}dK++ ;} dM( j){j.fM=qB.SC;j.jM=false;j.nM=false;var k=dK;var i=0;for(int g=0;g<k;g++ ){var h=pJ[g];if(h==null)continue;if(h.QL==0){pJ[g]=null;continue;}j.MK=h.MK;j.rM=h.MK;h.dM(j);if(i!=g){pJ[i]=h;pJ[g]=null;}i++ ;}if(i!=k){for(int g=k;g<dK;g++ ){pJ[i++ ]=pJ[g];pJ[g]=null;}dK=i;}}}class bC<qC extends FB> extends OB.Stream<qC>{final  MK;final  AK;final  jK;final  AL=new List<qF>();var QL=0;bC(this.MK,this.AK,this.jK); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError(error), onDone(), cancelOnError: false}){var g=new qF<qC>(this,h);if(QL==AL.length){AL.add(g);}else{AL[QL]=g;}QL++ ;if(AK==FB.qD&&jK==false)BD.iE.iL(this);return g;} GM( h){for(int g=0;g<QL;g++ ){if(identical(AL[g],h)){AL[g]=null;break;}}} get DN{for(var g=0;g<QL;g++ )if(AL[g]!=null)return true;return false;} dM( k){var j=QL;var h=0;for(int g=0;g<j;g++ ){var i=AL[g];if(i==null)continue;i.CL(k);if(h!=g){AL[h]=i;AL[g]=null;}h++ ;}if(h!=j){for(int g=j;g<QL;g++ ){AL[h++ ]=AL[g];AL[g]=null;}QL=h;}}}class lC implements yB{final  CK=new List<yB>();var aK=0;var lK=0.0; add( g){if(g==null)return;if(this.contains(g))return;if(aK==CK.length){CK.add(g);}else{CK[aK]=g;}aK++ ;} remove( h){if(h==null)return;for(int g=0;g<aK;g++ ){if(identical(CK[g],h)){CK[g]=null;break;}}} contains( h){if(h==null)return false;for(int g=0;g<aK;g++ ){if(identical(CK[g],h)){return true;}}return false;} uH( i){if(i==null)return;for(int g=0;g<aK;g++ ){var h=CK[g];if(h!=null&&h is JD){if(identical(h.aH,i)){CK[g]=null;}}}} EE( h, i,[ transitionFunction]){var g=new JD(h,i,transitionFunction);add(g);return g;} ZH( h, i){var g=new OE(h,i);add(g);return g;} EC( k){lK+= k;var j=aK;var h=0;for(int g=0;g<j;g++ ){var i=CK[g];if(i==null)continue;if(i.EC(k)==false){CK[g]=null;continue;}if(h!=g){CK[h]=i;CK[g]=null;}h++ ;}if(h!=j){for(int g=j;g<aK;g++ ){CK[h++ ]=CK[g];CK[g]=null;}aK=h;}return true;}}class aB<qC extends FB>{final  AK;const aB(this.AK); forTarget( g,{ useCapture: false}){return g.JL(AK,useCapture);}}class CB implements eD{var lJ;var yJ;var PK;var bK;var kK;var vK;var BL;var IL;var NL;var PL;var SL;var XL;var dL;var VL;static var qE=new bD(png:true,jpg:true,webp:false);CB( h, i,[ transparent=true, fillColor=0xFFFFFFFF]){lJ=h.toInt();yJ=i.toInt();PK=transparent;bK=0;BL=NL=0;IL=PL=0;kK=SL=lJ;vK=XL=yJ;var g=new WB.CanvasElement(width:lJ,height:yJ);VL=g.context2D;VL.fillStyle=PK?ZG(fillColor):rC(fillColor);VL.fillRect(0,0,lJ,yJ);dL=g;}CB.GJ( g){if(g==null)throw new ArgumentError();lJ=g.naturalWidth.toInt();yJ=g.naturalHeight.toInt();PK=true;bK=0;BL=NL=0;IL=PL=0;kK=SL=lJ;vK=XL=yJ;dL=g;}CB.HJ( g){lJ=g.qH.toInt();yJ=g.pH.toInt();PK=true;bK=g.xH?2:1;BL=g.offsetX;IL=g.offsetY;kK=g.JF;vK=g.IF;NL=g.fH;PL=g.gH;SL=g.JF;XL=g.IF;dL=g.zH.ZK.dL;}static  eC( h,[ bitmapDataLoadOptions=null]){if(bitmapDataLoadOptions==null)bitmapDataLoadOptions=CB.qE;var i=new OB.Completer<CB>();var g=new WB.ImageElement();var j;var k;j=g.onLoad.listen((m){j.cancel();k.cancel();i.complete(new CB.GJ(g));});k=g.onError.listen((m){j.cancel();k.cancel();i.completeError(new StateError("Error loading image."));});if(bitmapDataLoadOptions.webp==false){g.src=h;return i.future;}OH.then(( o){var n=new RegExp(r"(png|jpg|jpeg)$",multiLine:false,caseSensitive:true);var l=n.firstMatch(h);if(o==false||l==null){g.src=h;}else{g.src=h.substring(0,h.length-l.group(1).length)+"webp";}});return i.future;} get width=>lJ; get height=>yJ; clone(){var g=new CB(lJ,yJ,true,0);g.cH(this);return g;} WH( i, j, g, h){h.apply(i,j,this,g);} GF( j, g, h,[ alphaBitmapData=null, alphaPoint=null, mergeAlpha=false]){var i=j.sM().getImageData(g.x,g.y,g.width,g.height);sM().putImageData(i,h.x,h.y);} cH( h,[ matrix=null]){var g=sM();var i=new YB.EJ(g,matrix);h.KB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} clear(){var g=sM();g.clearRect(0,0,lJ,yJ);} KB( h){var g=h.context;switch (bK){case 0:g.drawImage(dL,BL,IL);break;case 1:g.drawImageScaledFromSource(dL,NL,PL,SL,XL,BL,IL,kK,vK);break;case 2:g.transform(0.0,-1.0,1.0,0.0,BL,IL+vK);g.drawImageScaledFromSource(dL,NL,PL,XL,SL,0.0,0.0,vK,kK);break;}} YF( PB, g){var w=PB.context;if(g.width<=0.0||g.height<=0.0)return;switch (bK){case 0:w.drawImageScaledFromSource(dL,g.x-BL,g.y-IL,g.width,g.height,g.x+BL,g.y+IL,g.width,g.height);break;case 1:var j=NL;var h=PL;var p=j+SL;var q=h+XL;var l=NL-BL+g.x;var m=PL-IL+g.y;var u=l+g.width;var t=m+g.height;var o=(j>l)?j:l;var n=(h>m)?h:m;var DB=(p<u)?p:u;var MB=(q<t)?q:t;var k=DB-o;var i=MB-n;var LB=BL-j+o;var GB=IL-h+n;if(k>0.0&&i>0.0){w.drawImageScaledFromSource(dL,o,n,k,i,LB,GB,k,i);}break;case 2:var j=NL;var h=PL;var p=j+XL;var q=h+SL;var l=NL+IL-g.y+vK-g.height;var m=PL-BL+g.x;var u=l+g.height;var t=m+g.width;var o=(j>l)?j:l;var n=(h>m)?h:m;var DB=(p<u)?p:u;var MB=(q<t)?q:t;var k=MB-n;var i=DB-o;var LB=BL-h+n;var GB=IL+p-DB;if(k>0.0&&i>0.0){w.transform(0.0,-1.0,1.0,0.0,LB,GB+i);w.drawImageScaledFromSource(dL,o,n,i,k,0,0,i,k);}break;}} sM(){if(VL==null){var g=new WB.CanvasElement(width:lJ,height:yJ);VL=g.context2D;switch (bK){case 0:VL.drawImage(dL,BL,IL);break;case 1:VL.drawImageScaledFromSource(dL,NL,PL,SL,XL,BL,IL,kK,vK);break;case 2:VL.transform(0.0,-1.0,1.0,0.0,BL,IL+vK);VL.drawImageScaledFromSource(dL,NL,PL,XL,SL,0.0,0.0,vK,kK);VL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}bK=0;BL=NL=0;IL=PL=0;kK=SL=lJ;vK=XL=yJ;dL=g;}return VL;}}typedef  fD( ratio);typedef  lF<qC extends FB>( event);class qF<qC extends FB> extends OB.StreamSubscription<qC>{var uK;var CL;var GL;var LL;qF(this.uK,this.CL){GL=0;LL=false;} cancel(){if(LL==false){uK.GM(this);LL=true;CL=null;}} onError( g(error)){} get BN=>GL>0; pause([ resumeSignal]){GL++ ;if(resumeSignal!=null){resumeSignal.whenComplete(resume);}} resume(){if(BN==false){throw new StateError("Subscription is not paused.");}GL-- ;}}class mD{static const  oD="source-over";} rC( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";} BG( g){if(gD.containsKey(g)==false){gD[g]=new tE(g);}return gD[g];}final  pD=new EB.CJ();class fE{static var cG=TE.uE;static var hG=new OB.StreamController<String>();static var kG=hG.stream.asBroadcastStream();static  get vG=>cG;}abstract class s extends wB implements eD{static var SG=0;var bL=SG++ ;var bJ=0.0;var fJ=0.0;var lL=0.0;var oL=0.0;var qL=1.0;var vL=1.0;var xL=0.0;var AM=0.0;var CM=0.0;var FM=1.0;var IM=true;var JM=false;var NM=null;var QM=null;var RM=null;var TM=false;var VM=null;var YM=null;var ZM=null;var xJ="";var gM=null;final  hM=new EB.CJ();final  oM=new EB.CJ();var qM=true;static const  DH=const aB<mC>(FB.qD); get oH=>s.DH.forTarget(this); get x=>bJ; get y=>fJ; get AC=>lL; get HC=>oL; get JC=>qL; get KC=>vL; get skewX=>xL; get skewY=>AM; get IC=>CM; get visible=>IM; get alpha=>FM; get LD=>ZM; get name=>xJ; get parent=>gM; get OD{var g=this.XC;return (g!=null)?this.GC(g.aN):null;} get mH{var g=this.OD;return (g!=null)?g.x:0.0;} get nH{var g=this.OD;return (g!=null)?g.y:0.0;} get root{var g=this;while (g.gM!=null)g=g.gM;return g;} get XC{var g=this.root;if(g is fC)return g;return null;}set x( g){bJ=g.toDouble();qM=true;}set y( g){fJ=g.toDouble();qM=true;}set AC( g){lL=g.toDouble();qM=true;}set HC( g){oL=g.toDouble();qM=true;}set JC( g){qL=g.toDouble();qM=true;}set KC( g){vL=g.toDouble();qM=true;}set skewX( g){xL=g.toDouble();qM=true;}set skewY( g){AM=g.toDouble();qM=true;}set IC( g){CM=g.toDouble();qM=true;}set visible( g){IM=g;}set alpha( g){FM=g.toDouble();}set mask( g){NM=g;}set LD( g){ZM=g;} setTransform( h, g,[ scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY]){qM=true;bJ=h.toDouble();fJ=g.toDouble();if(scaleX!=null){qL=scaleX.toDouble();if(scaleY!=null){vL=scaleY.toDouble();if(rotation!=null){CM=rotation.toDouble();if(skewX!=null){xL=skewX.toDouble();if(skewY!=null){AM=skewY.toDouble();if(pivotX!=null){lL=pivotX.toDouble();if(pivotY!=null)oL=pivotY.toDouble();}}}}}}} get width=>kB(CN).width; get height=>kB(CN).height; set width( h){this.JC=1;var g=this.width;this.JC=(g!=0.0)?h/g:1.0;} set height( h){this.KC=1;var g=this.height;this.KC=(g!=0.0)?h/g:1.0;} XF(){if(gM!=null)gM.WF(this);} get CN{if(qM){qM=false;var j=xL+CM;var i=AM+CM;if(j==0.0&&i==0.0){oM.RD(qL,0.0,0.0,vL,bJ-lL*qL,fJ-oL*vL);}else{var g,l,k,h;var m=MC.cos(j);var n=MC.sin(j);if(j==i){g=qL*m;l=qL*n;k=-vL*n;h=vL*m;}else{g=qL*MC.cos(i);l=qL*MC.sin(i);k=-vL*n;h=vL*m;}var p=bJ-(lL*g+oL*k);var o=fJ-(lL*l+oL*h);oM.RD(g,l,k,h,p,o);}}return oM;} DE( h){if(h==gM)return CN.clone();if(h.gM==this)return h.CN.EF();var j=new EB.CJ();var g=this;while (g!=h&&g.gM!=null){j.concat(g.CN);g=g.gM;}if(h==null&&g!=null){j.concat(g.CN);g=null;}if(g==h)return j;var k=new EB.CJ();var i=h;while (i!=this&&i.gM!=null){k.concat(i.CN);i=i.gM;}k.vD();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new BB.yI();returnRectangle.x=g.SB;returnRectangle.y=g.TB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} iB( g, h){if(kB(pD).contains(g,h))return this;return null;} GC( h){hM.jH();for(s g=this;g!=null;g=g.gM)hM.concat(g.CN);hM.vD();return hM.VD(h);} dispatchEvent( h){var g=null;if(h.KD||h.bubbles){for(s j=gM;j!=null;j=j.gM){if(j.vM(h.type,h.KD,h.bubbles)){if(g==null)g=FD.TF() as List<s>;g.add(j);}}}if(h.KD&&g!=null){for(int i=g.length-1;i>=0&&h.TD==false;i-- ){g[i].UM(h,this,g[i],qB.XE);}}if(h.TD==false){UM(h,this,this,qB.SC);}if(h.bubbles&&g!=null){for(int i=0;i<g.length&&h.TD==false;i++ ){g[i].UM(h,this,g[i],qB.AG);}}if(g!=null){g.clear();FD.UF(g);}} LN( h){for(var g=h;g!=null;g=g.gM)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");gM=h;} KB( g);}class sB{static const  NG="B";static const  RG="BL";static const  WG="BR";static const  sF="L";static const  kE="R";static const  bG="T";static const  dG="TL";static const  gG="TR";static const  uE="";}class YB{final  VL;var HK=0.0;var cL=0.0;var hL;var pL;YB.EJ( i,[ matrix]):VL=i{pL=null;for(int h=0;h<100;h++ ){pL=new oC(pL);}hL=pL;if(matrix!=null){hL.matrix.MD(matrix);}var g=hL.matrix;VL.setTransform(g.a,g.b,g.c,g.d,g.SB,g.TB);VL.globalAlpha=1.0;VL.globalCompositeOperation=mD.oD;} get context=>VL; get currentTime=>HK; reset([ matrix, currentTime, deltaTime]){HK=?currentTime?currentTime:0.0;cL=?deltaTime?deltaTime:0.0;hL=pL;if(matrix!=null){hL.matrix.MD(matrix);}var g=hL.matrix;VL.setTransform(g.a,g.b,g.c,g.d,g.SB,g.TB);VL.globalAlpha=1.0;VL.globalCompositeOperation=mD.oD;VL.clearRect(0,0,VL.canvas.width,VL.canvas.height);} vH( h){var g=h.CN;var u=h.FM;var j=h.NM;var k=h.YM;var n=h.ZM;var t=h.QM;var l=hL as oC;var i=hL.next as oC;hL=i;var p=i.matrix;var o=l.alpha*u;var q=(n!=null)?n:l.LD;p.FF(g,l.matrix);i.alpha=o;i.LD=q;if(j!=null||k!=null){VL.save();if(j!=null){if(j.LC==null){g=i.matrix;}else if(identical(j.LC,h)){g=i.matrix;}else if(identical(j.LC,h.parent)){g=l.matrix;}else{g=j.LC.DE(h);if(g==null)g=pD;else g.concat(i.matrix);}j.KB(this,g);}if(k!=null){if(k.LC==null){g=i.matrix;}else if(identical(k.LC,h)){g=i.matrix;}else if(identical(k.LC,h.parent)){g=l.matrix;}else{g=k.LC.DE(h);if(g==null)g=pD;else g.concat(i.matrix);}k.KB(this,g);}}var m=p;VL.setTransform(m.a,m.b,m.c,m.d,m.SB,m.TB);VL.globalCompositeOperation=q;VL.globalAlpha=o;if(t!=null){t.KB(this);}else{h.KB(this);}if(j!=null||k!=null){VL.restore();}hL=l;}} ZG( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class tE{var fontStyle;var tC=0;var ND=0;var height=0;tE( j){this.fontStyle=j;var h=new WB.Element.tag("span");h.style.font=this.fontStyle;h.text="Hg";var g=new WB.Element.tag("div");g.style.display="inline-block";g.style.width="1px";g.style.height="0px";var i=new WB.Element.tag("div");i.append(g);i.append(h);WB.document.body.append(i);try {g.style.verticalAlign="baseline";this.tC=g.offsetTop-h.offsetTop;g.style.verticalAlign="bottom";this.height=g.offsetTop-h.offsetTop;this.ND=height-tC;}catch (k){}finally {i.remove();}}}class TC{static  ID( g){return g;}static  nG( g){return 0.5-0.5*MC.cos(g*2.0*MC.PI);}static  AH( g){return g*g*g;}static  BH( g){g=1.0-g;return 1.0-g*g*g;}static  EH( g){g=g*2.0;return (g<1.0)?0.5*AH(g):0.5*BH(g-1.0)+0.5;}static  RH( g){var h=1.70158;return g*g*((h+1.0)*g-h);}static  SH( g){var h=1.70158;g=g-1.0;return g*g*((h+1.0)*g+h)+1.0;}static  TH( g){g=g*2.0;return (g<1.0)?0.5*RH(g):0.5*SH(g-1.0)+0.5;}}class sC{static const  hD="auto";static const  lG="stop";static const  wE="once";} oG( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}class yE{var target=null;var zB=false;var tD=0;var uC=0;var OF,QF;var MF,NF;yE(this.OF,this.QF,this.MF,this.NF);}class aI extends nC{final  iM;aI( i, g, h, j):iM=new BB(i,g,h,j); KB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.SB,g.TB);h.beginPath();h.rect(iM.x,iM.y,iM.width,iM.height);h.clip();}} DC( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class bB{final  yD;var AE=double.NAN;var BE=double.NAN;bB(this.yD); YC( g){this.BE=g.toDouble();} get kH=>!AE.isNaN&&!BE.isNaN; xM( g){switch (yD){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.AC;case 'pivotY':return g.HC;case 'scaleX':return g.JC;case 'scaleY':return g.KC;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.IC;case 'alpha':return g.alpha;default:return 0.0;}} RN( g, h){switch (yD){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.AC=h;break;case 'pivotY':g.HC=h;break;case 'scaleX':g.JC=h;break;case 'scaleY':g.KC=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.IC=h;break;case 'alpha':g.alpha=h;break;}}}class wG{static var xG=0;var UD=xG++ ;var target=null;var PD=false;wG(this.target,this.PD);}class bI extends nC{final  EN;bI( i, g, h):EN=new dF(i,g,h); KB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.SB,g.TB);h.beginPath();h.arc(EN.x,EN.y,EN.VF,0,MC.PI*2.0,false);h.clip();}}class fC extends RB{var PM;var VL;var HN,IN;var KM,LM;var KN,MN;var NN;var PN;var QN;var eJ;var jI=30;var TN;var UN;var VN;var WN;var XN;var YN;var aN;var bN;var cN;var dN;var eN;var fN;var gN;fC( h, g){xJ=h;PM=g;PM.focus();VL=g.context2D;KM=HN=g.width;LM=IN=g.height;KN=g.clientWidth;MN=g.clientHeight;NN=new EB.CJ();PN=new EB.CJ();QN=null;eJ=new lC();UN=new YB.EJ(VL);VN=sC.hD;WN=kC.hE;XN=sB.uE;cN=[new yE(v.dE,v.jE,v.YE,v.yF),new yE(v.eG,v.iG,v.sE,v.sE),new yE(v.mG,v.rG,v.vE,v.vE)];YN=fB.kD;bN=null;aN=new AB(0,0);eN=new v(v.YE,true);NC.XG.listen(XG);PM.onMouseDown.listen(tN);PM.onMouseUp.listen(tN);PM.onMouseMove.listen(tN);PM.onMouseOut.listen(tN);PM.onMouseWheel.listen(uN);dN=new Map<int,wG>();gN=new NB(NB.ZE,true);fE.kG.listen(vN);vN(null);fN=new rB(rB.jD,true);PM.onKeyDown.listen(wN);PM.onKeyUp.listen(wN);PM.onKeyPress.listen(yN);} get zD=>QN; get wD=>eJ; get OD=>aN; get focus=>TN; get align=>XN;AO(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){AO();}set y( g){AO();}set AC( g){AO();}set HC( g){AO();}set JC( g){AO();}set KC( g){AO();}set skewX( g){AO();}set skewY( g){AO();}set IC( g){AO();}set alpha( g){AO();}set width( g){AO();}set height( g){AO();}lH( g, h){if(VN==sC.hD||VN==sC.wE){BO();UN.reset(PN,g,h);KB(UN);if(VN==sC.wE)VN=sC.lG;}}BO(){var m=PM.getBoundingClientRect();var n=PM.clientLeft+m.left;var o=PM.clientTop+m.top;var k=PM.clientWidth;var l=PM.clientHeight;if(k==0||l==0)return;var g=HN;var h=IN;var i=0;var j=0;switch (WN){case kC.nF:g=HN;h=IN;break;case kC.wF:if(k*IN>l*HN){h=(HN*l)~/k;}else{g=(IN*k)~/l;}break;case kC.FG:g=k;h=l;break;case kC.hE:if(k*IN>l*HN){g=(IN*k)~/l;}else{h=(HN*l)~/k;}break;}switch (XN){case sB.NG:i=(HN-g+1)~/2;j=(IN-h);break;case sB.RG:i=0;j=(IN-h);break;case sB.WG:i=(HN-g);j=(IN-h);break;case sB.sF:i=0;j=(IN-h+1)~/2;break;case sB.kE:i=(HN-g);j=(IN-h+1)~/2;break;case sB.bG:i=(HN-g+1)~/2;j=0;break;case sB.dG:i=0;j=0;break;case sB.gG:i=(HN-g+1);j=0;break;case sB.uE:i=(HN-g+1)~/2;j=(IN-h+1)~/2;break;}PN.RD(1.0,0.0,0.0,1.0,0-i,0-j);NN.RD(g/k,0.0,0.0,h/l,i-n,j-o);if(KM!=g||LM!=h){PM.width=KM=g;PM.height=LM=h;}if(KN!=k||MN!=l){KN=k;MN=l;dispatchEvent(new FB(FB.UG));}}XG( g){PM.style.cursor=NC.zE(YN);}tN( j){j.preventDefault();var n=new DateTime.now().millisecondsSinceEpoch;var p=j.button;var h=null;var i=NN.ON(j.client);var m=null;if(p<0||p>2)return;if(j.type=="mousemove"&&aN.HF(i))return;var g=cN[p];aN=i;if(NC.cE!=null)NC.cE.tM();if(j.type!="mouseout")h=iB(i.x,i.y) as IB;var l=fB.kD;if(h is pC&&(h as pC).FE){l=fB.nD;}if(h is RE&&(h as RE).FE){l=fB.nD;}if(YN!=l){YN=l;PM.style.cursor=NC.zE(l);}if(bN!=null&&bN!=h){bN.dispatchEvent(eN..MM(v.nE,true)..GN=(bN.XC!=null)?bN.GC(i):new AB.yI()..JN=i..uM=g.zB);bN=null;}if(h!=null&&h!=bN){h.dispatchEvent(eN..MM(v.oE,true)..GN=h.GC(i)..JN=i..uM=g.zB);bN=h;}var k=null;var o=false;var q=false;if(j.type=="mousedown"){k=g.OF;if(h!=g.target||n>g.tD+500)g.uC=0;g.zB=true;g.target=h;g.tD=n;g.uC++ ;}if(j.type=="mouseup"){k=g.QF;g.zB=false;o=(g.target==h);q=o&&g.uC.isEven&&(n<g.tD+500);}if(j.type=="mousemove"){k=v.mE;}if(k!=null&&h!=null){m=h.GC(i);h.dispatchEvent(eN..MM(k,true)..GN=m..JN=i..uM=g.zB..yM=g.uC);if(o){if(q&&h.bH){h.dispatchEvent(eN..MM(g.NF,true)..GN=m..JN=i..uM=g.zB);}else{h.dispatchEvent(eN..MM(g.MF,true)..GN=m..JN=i..uM=g.zB);}}}}uN( h){var g=NN.ON(h.client);var i=iB(g.x,g.y) as IB;if(i!=null){i.dispatchEvent(eN..MM(v.pE,true)..GN=i.GC(g)..JN=g..zM=h.deltaX..AN=h.deltaY);if(eN.TD)h.preventDefault();}}var DO=[] ;vN( h){DO.forEach((g)=>g.cancel());if(fE.vG==TE.DG){DO=[PM.onTouchStart.listen(EO),PM.onTouchEnd.listen(EO),PM.onTouchMove.listen(EO),PM.onTouchEnter.listen(EO),PM.onTouchLeave.listen(EO),PM.onTouchCancel.listen(EO)];}}EO( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=NN.ON(m.client);var h=iB(i.x,i.y) as IB;var g=dN.containsKey(l)?dN[l]:new wG(h,dN.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(gN..MM(NB.TG,true)..GN=(g.target.XC!=null)?g.target.GC(i):new AB.yI()..JN=i..WM=g.UD..XM=g.PD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(gN..MM(NB.PG,true)..GN=h.GC(i)..JN=i..WM=g.UD..XM=g.PD);g.target=h;}var k=null;if(j.type=="touchstart"){dN[l]=g;k=NB.ZE;}if(j.type=="touchend"){dN.remove(l);k=NB.bE;}if(j.type=="touchcancel"){dN.remove(l);k=NB.eE;}if(j.type=="touchmove"){k=NB.lE;}if(k!=null&&h!=null){h.dispatchEvent(gN..MM(k,true)..GN=h.GC(i)..JN=i..WM=g.UD..XM=g.PD);}}}wN( g){g.preventDefault();var h=null;if(g.type=="keyup")h=rB.aE;if(g.type=="keydown")h=rB.jD;fN..MM(h,true)..fL=g.altKey..gL=g.ctrlKey..kL=g.shiftKey..yL=g.charCode..BM=g.keyCode..DM=dC.mF;if(g.keyLocation==WB.KeyLocation.LEFT)fN.DM=dC.sF;if(g.keyLocation==WB.KeyLocation.RIGHT)fN.DM=dC.kE;if(g.keyLocation==WB.KeyLocation.NUMPAD)fN.DM=dC.EG;if(g.keyLocation==WB.KeyLocation.JOYSTICK)fN.DM=dC.gE;if(g.keyLocation==WB.KeyLocation.MOBILE)fN.DM=dC.gE;if(TN!=null)TN.dispatchEvent(fN);}yN( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new PE(PE.xF,true);h.rJ=new String.fromCharCodes([i]);if(TN!=null)TN.dispatchEvent(h);}} AF( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class cI extends nC{final  ZN;cI( g):ZN=g.toList(growable:false){if(g.length<3)throw new ArgumentError("A custom mask needs at least 3 points.");} KB( j, g){var h=j.context;h.setTransform(g.a,g.b,g.c,g.d,g.SB,g.TB);h.beginPath();for(int i=0;i<ZN.length;i++ )h.lineTo(ZN[i].x,ZN[i].y);h.clip();}} FH( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} HH(){var g=new WB.CanvasElement(width:1,height:1);g.context2D.fillStyle="#000000";g.context2D.fillRect(0,0,1,1);var i=g.context2D.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} IH(){var i=new OB.Completer<bool>();var g=new WB.ImageElement(); h(){i.complete(g.width==2&&g.height==2);}g.onLoad.listen((j)=>h());g.onError.listen((j)=>h());g.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";return i.future;}class JD implements yB{final  iN;final  jN;final  kN=new List<bB>();var lN;var mN;var nN;var oN;var UK;var HK;var pN;var qN;var rN;JD( g, h,[ transitionFunction]):iN=g,jN=(?transitionFunction)?transitionFunction:TC.ID{oN=new VE(this);HK=0.0;UK=MC.max(0.0001,h);pN=0.0;qN=false;rN=false;} get gC=>oN; qK( g){if(iN!=null&&rN==false){kN.add(g);}} EC( m){if(HK<UK||rN==false){HK=HK+m;if(HK>UK){HK=UK;}if(HK>=0.0){if(rN==false){rN=true;for(int h=0;h<kN.length;h++ ){var g=kN[h];g.AE=g.xM(iN);}if(lN!=null){lN();}}var k=HK/UK;var l=jN(k).toDouble();for(int h=0;h<kN.length;h++ ){var g=kN[h];if(g.kH){var i=g.AE.toDouble();var n=g.BE.toDouble();var j=i+l*(n-i);g.RN(iN,qN?j.round():j);}}if(mN!=null){mN();}if(nN!=null&&HK==UK){nN();}}}return HK<UK;} get aH=>iN; get currentTime=>HK; set onComplete( g()){nN=g;}} JH( h){if(UC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];h[g+0]=(h[g+0]*i)~/255;h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;h[g+3]=(h[g+3]*i)~/255;}}} NH( h){if(UC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];if(i>0){h[g+0]=(h[g+0]*255)~/i;h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;}}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];if(i>0){h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;h[g+3]=(h[g+3]*255)~/i;}}}}var UC=HH();var OH=IH(); rD( g, m, n, j){m=m.toDouble();n=n.toDouble();var GB=0.0;var DB=0.0;var q=m*g.a;var w=m*g.b;var t=m*g.a+n*g.c;var p=m*g.b+n*g.d;var u=n*g.c;var o=n*g.d;var h=GB;if(h>q)h=q;if(h>t)h=t;if(h>u)h=u;var i=DB;if(i>w)i=w;if(i>p)i=p;if(i>o)i=o;var l=GB;if(l<q)l=q;if(l<t)l=t;if(l<u)l=u;var k=DB;if(k<w)k=w;if(k<p)k=p;if(k<o)k=o;if(j==null)j=new BB.yI();j.x=g.SB+h;j.y=g.TB+i;j.width=l-h;j.height=k-i;return j;}//@ sourceMappingURL=stagexl_demos.dart.map
