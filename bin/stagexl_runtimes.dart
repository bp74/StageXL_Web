import "dart:json" as OE;import "dart:math" as JC;import "dart:html" as wB;import "dart:async" as JB;class SG{static const  TG="Chrome";static const  UG="Firefox";static const  VG="Internet Explorer";static const  WG="Safari";final  lF;final  minimumVersion;const SG(this.lF,[this.minimumVersion]);}class XG{final  name;const XG(this.name);}class YG extends aB{var rG;YG(){rG=xB.xF('levelUp');sG();HB.pC('images/LevelupTextureAtlas.png').then((h){var g=new MD(h);g.x=70;g.y=40;bB(g);});}sG(){var l=330;for(int j=0;j<7;j++ ){var h=rG.zD('LevelUp${j}');var g=new MD(h);g.cB=h.width/2;g.dB=h.height/2;g.x=l+h.width/2;g.y=150;g.KB=0.0;g.LB=0.0;bB(g);var k=new qC(g,2.0,oC.eF);k.QC.KB.IC(1.0);k.QC.LB.IC(1.0);k.uD=j*0.05;var i=new qC(g,0.4,oC.mD);i.QC.KB.IC(0.0);i.QC.LB.IC(0.0);i.uD=2.0;i.onComplete=()=>g.IE();eB.add(k);eB.add(i);l=l+5+h.width;}eB.nF(()=>sG(),3.0);}}class ZG extends aB{ZG(){var k=xB.uF('flump');var i=new cG(k,'idle');i.x=500;i.y=200;bB(i);var j=new cG(k,'walk');j.x=150;j.y=460;bB(j);var g=new cG(k,'attack');g.x=450;g.y=460;bB(g);var h=new cG(k,'defeat');h.x=720;h.y=460;bB(h);eB.add(i);eB.add(j);eB.add(g);eB.add(h);HB.pC('images/flumpLibraryAtlas0.png').then((m){var l=new MD(m);l.x=40;l.y=40;bB(l);});}}var KC;var cC;var eB;var xB; main(){HB.jD.webp=true;var k=wB.window.location.pathname;var j=new RegExp(r"([A-Za-z0-9-]+)\.html",multiLine:false,caseSensitive:false);var g=j.firstMatch(k);if(g!=null&&g.groupCount==1){var h=g.group(1);print("current page: ${h}");var i=wB.query("#stage");if(i!=null){KC=new qB('stage',i);cC=new fC();cC.jF(KC);eB=cC.yC;xB=new GD();}switch (h){case "flump":xB..iF('flump','images/flumpLibrary.json')..load().then((tG)=>KC.bB(new ZG()));break;case "texturepacker":xB..kF('levelUp','images/LevelupTextureAtlas.json',eC.TD)..load().then((tG)=>KC.bB(new YG()));break;}}}const aG=const bG();class bG{const bG();}class zB{static const  VE="exactFit";static const  bE="noBorder";static const  kE="noScale";static const  cD="showAll";}class ID{final  HH;final  LH;final  bH;final  kH;final  tH;final  zH;final  EI;final  JI;final  NI;final  QI;final  VI;ID.mG( i, h, g):HH=i,LH=h,bH=OF(g["rotated"]),kH=gB(g["sourceSize"]["w"]),tH=gB(g["sourceSize"]["h"]),zH=gB(g["spriteSourceSize"]["x"]),EI=gB(g["spriteSourceSize"]["y"]),JI=gB(g["frame"]["x"]),NI=gB(g["frame"]["y"]),QI=gB(g["frame"]["w"]),VI=gB(g["frame"]["h"]); get MG=>HH; get name=>LH; get LG=>bH; get sF=>JI; get tF=>NI; get yD=>QI; get xD=>VI; get offsetX=>zH; get offsetY=>EI; get FG=>kH; get EG=>tH;}class dC extends aB{}class SE{SE();}abstract class aB extends w{final  ZH=new List<q>();var rH=true;var xH=true; bB( g){if(g.parent==this){var h=ZH.indexOf(g);ZH.removeAt(h);ZH.add(g);}else{hF(g,ZH.length);}} hF( g, h){if(h<0||h>ZH.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){ZH.removeAt(ZH.indexOf(g));if(h>ZH.length)h-- ;ZH.insert(h,g);}else{g.IE();g.sJ(this);ZH.insert(h,g);g.dispatchEvent(new AB(AB.YE,true));if(this.YC!=null)AK(g,new AB(AB.eE));}} HG( h){var g=ZH.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");IG(g);} IG( g){if(g<0||g>=ZH.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=ZH[g];h.dispatchEvent(new AB(AB.nE,true));if(this.YC!=null)AK(h,new AB(AB.rE));h.sJ(null);ZH.removeAt(g);} contains( g){for(;g!=null;g=g.QJ)if(g==this)return true;return false;} kB( n,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new GB.lG();if(ZH.length==0)return super.kB(n,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var o=ZH.length;for(int l=0;l<ZH.length;l++ ){var m=ZH[l];RJ.tD(m.NK,n);var g=m.kB(RJ,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} tB( o, p){var l=null;for(int j=ZH.length-1;j>=0;j-- ){var i=ZH[j];if(i.visible){var g=i.NK;var m=o-g.XB;var k=p-g.YB;var s=(g.d*m-g.c*k)/g.rB;var n=(g.a*k-g.b*m)/g.rB;var h=i.tB(s,n);if(h!=null){if(h is w)if(h.BG)return rH?h:this;l=this;}}}return l;} IB( i){for(int h=0;h<ZH.length;h++ ){var g=ZH[h];if(!g.wI&&g.visible)i.JE(g);}}nK( g, i){i.add(g);if(g is aB){var k=g as aB;var j=k.ZH;for(int h=0;h<j.length;h++ ){nK(j[h],i);}}}AK( i, j){var g=NC.GE() as List<q>;nK(i,g);for(int h=0;h<g.length;h++ ){g[h].dispatchEvent(j);}g.clear();NC.HE(g);}}class pB{static const  UE=0;static const  ZE=1;static const  fE=2;static const  jE=3;static const  bD=4;}class AC{static var PD=OB.hC;static var aE=false;static var WD=null;static var tE=new JB.StreamController<String>();static var AF=tE.stream.asBroadcastStream();static  qD( i){var h=i;var g="auto";if(PD!=OB.hC){h=PD;}switch (h){case OB.hC:g="auto";break;case OB.jC:g="default";break;case OB.lC:g="pointer";break;case OB.lE:g="move";break;case OB.mE:g="text";break;case OB.oE:g="wait";break;}if(aE){g="none";}return g;}}class OB{static const  hC="auto";static const  jC="arrow";static const  lC="button";static const  lE="hand";static const  mE="ibeam";static const  oE="wait";}class OD{static const  lD="none";static const  iE="touchPoint";}class HD implements PB{final  MH;var TH=0.0;var cH=0.0;var lH=1;HD( g, h):MH=g{cH=JC.max(h,0.0001);} VB( h){var g=TH+h;while (g>=cH&&lH>0){TH=cH;lH-- ;MH();g-= cH;}TH=g;return (lH>0);}}abstract class PB{ VB( g);}class GD{var RH;GD(){RH=new Map<String,MC>();} SI( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(RH.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");RH[i]=g;} zI( i, g){var h="${i}.${g}";if(RH.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return RH[h];} kF( j, h, i){var g=new MC("TextureAtlas",j,h);g.CJ(ZB.pC(h,i));SI(g);} iF( i, h){var g=new MC("FlumpLibrary",i,h);g.CJ(SB.pC(h));SI(g);} load(){var h=this.GG.map((i)=>i.YH);return JB.Future.wait(h).then((j){var g=this.qF;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get GG{return RH.values.where((g)=>g.XC==null).toList();} get qF{return RH.values.where((g)=>g.error!=null).toList();} zD( g){return zI("BitmapData",g).XC;} xF( g){return zI("TextureAtlas",g).XC;} uF( g){return zI("FlumpLibrary",g).XC;}}class MC{var DH;var LH;var UH;var YH;var hH;var mH;MC( g, h, i){DH=g;LH=h;UH=i;hH=null;mH=null;} get kind=>DH; get name=>LH; get XC=>mH; get error=>hH;CJ( i){YH=i.then((g){mH=g;hH=null;},onError:(h){mH=null;hH=h;});}}class ZB{final  KH=new List<ID>();var fH;static  pC( n, DB){var k=new JB.Completer<ZB>();var g=new ZB();switch (DB){case eC.WE:case eC.TD:wB.HttpRequest.getString(n).then((u){var o=OE.parse(u);var h=o["frames"];var p=o["meta"];var NB=sD(n,p["image"]);if(h is List){for(var s in h){var j=s as Map;var i=j["filename"] as String;var l=rD(i);var m=new ID.mG(g,l,j);g.KH.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=rD(i);var m=new ID.mG(g,l,j);g.KH.add(m);}}HB.pC(NB).then(( FB){g.fH=FB;k.complete(g);}).catchError((BB){k.completeError(new StateError("Failed to load image."));});}).catchError((BB){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} zD( h){for(int g=0;g<KH.length;g++ )if(KH[g].name==h)return new HB.qG(KH[g]);throw new ArgumentError("TextureAtlasFrame not found: '${h}'");}}abstract class jB{ IB( g);}class eC{static const  WE="json";static const  TD="jsonarray";}class KD{final  ED;KD(this.ED);call( h, g){sH(h).IC(g);} get x=>sH("x"); get y=>sH("y"); get KB=>sH("scaleX"); get LB=>sH("scaleY"); get skewX=>sH("skewX"); get skewY=>sH("skewY"); get cB=>sH("pivotX"); get dB=>sH("pivotY"); get FC=>sH("rotation"); get alpha=>sH("alpha"); sH( h){var g=new MB(h);this.ED.sH(g);return g;}}class ND extends w{ND();}class JD{var png;var jpg;var webp;JD({this.png: true,this.jpg: true,this.webp: false});}class RB<CC extends AB>{final  PH;const RB(this.PH); forTarget( g,{ useCapture: false}){return g.GI(PH,useCapture);}}class v{var vG,wG,zG,AH,CH,GH;var OH;v( h, i, g, j, k, l):vG=h.toDouble(),wG=i.toDouble(),zG=g.toDouble(),AH=j.toDouble(),CH=k.toDouble(),GH=l.toDouble(),OH=(h*j-i*g).toDouble();v.nG():vG=1.0,wG=0.0,zG=0.0,AH=1.0,CH=0.0,GH=0.0,OH=1.0; clone(){return new v(vG,wG,zG,AH,CH,GH);} mF(){var h=(AH/OH);var i=-(wG/OH);var g=-(zG/OH);var j=(vG/OH);var k=-(h*CH+g*GH);var l=-(i*CH+j*GH);return new v(h,i,g,j,k,l);} get a=>vG; get b=>wG; get c=>zG; get d=>AH; get XB=>CH; get YB=>GH; get rB=>OH; NG( h){var i=h.x.toDouble();var g=h.y.toDouble();return new EB(i*vG+g*zG+CH,i*wG+g*AH+GH);} vJ( h){var i=h.x.toDouble();var g=h.y.toDouble();return new EB(i*vG+g*zG+CH,i*wG+g*AH+GH);} concat( g){var m=vG;var p=wG;var s=zG;var o=AH;var l=CH;var n=GH;var BB=OH;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var DB=g.XB;var u=g.YB;var FB=g.rB;vG=(m*j+p*i).toDouble();wG=(m*k+p*h).toDouble();zG=(s*j+o*i).toDouble();AH=(s*k+o*h).toDouble();CH=(l*j+n*i+DB).toDouble();GH=(l*k+n*h+u).toDouble();OH=(BB*FB).toDouble();} yF(){vG=1.0;wG=0.0;zG=0.0;AH=1.0;CH=0.0;GH=0.0;OH=1.0;} BE(){var j=vG;var m=wG;var l=zG;var k=AH;var h=CH;var i=GH;var g=OH;vG=(k/g).toDouble();wG=-(m/g).toDouble();zG=-(l/g).toDouble();AH=(j/g).toDouble();CH=-(vG*h+zG*i).toDouble();GH=-(wG*h+AH*i).toDouble();OH=(1.0/g).toDouble();} GC( h, i, g, k, j, l){vG=h.toDouble();wG=i.toDouble();zG=g.toDouble();AH=k.toDouble();CH=j.toDouble();GH=l.toDouble();OH=(vG*AH-wG*zG).toDouble();} UC( g){vG=g.a.toDouble();wG=g.b.toDouble();zG=g.c.toDouble();AH=g.d.toDouble();CH=g.XB.toDouble();GH=g.YB.toDouble();OH=g.rB.toDouble();} tD( h, g){var n=h.a;var s=h.b;var u=h.c;var p=h.d;var m=h.XB;var o=h.YB;var DB=h.rB;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var FB=g.XB;var BB=g.YB;var NB=g.rB;vG=(n*k+s*j).toDouble();wG=(n*l+s*i).toDouble();zG=(u*k+p*j).toDouble();AH=(u*l+p*i).toDouble();CH=(m*k+o*j+FB).toDouble();GH=(m*l+o*i+BB).toDouble();OH=(DB*NB).toDouble();}}class QE<CC>{final  BH=new List<CC>();final  VH;var dH=0;QE( g()):VH=g; GE(){if(dH==0){return VH();}else{dH-- ;return BH[dH];}}HE( g){if(dH==BH.length){BH.add(g);}else{BH[dH]=g;}dH++ ;}reset(){BH.clear();dH=0;}}class MD extends q{var bitmapData;var pixelSnapping;var uC;MD([this.bitmapData=null,this.pixelSnapping="auto"]){uC=null;} kB( h,[ returnRectangle]){var g=(bitmapData!=null)?bitmapData.width:0;var i=(bitmapData!=null)?bitmapData.height:0;return cF(h,g,i,returnRectangle);} tB( g, h){if(bitmapData!=null&&g>=0.0&&h>=0.0&&g<bitmapData.width&&h<bitmapData.height)return this;return null;} IB( g){if(bitmapData==null)return;if(uC==null){bitmapData.IB(g);}else{bitmapData.KG(g,uC);}}}class fC{var xG;var JH;var SH;var eH;var qH;fC(){xG=new BC();JH=new List<qB>();SH=double.NAN;eH=LC.dD;qH=new FD(0);wB.window.requestAnimationFrame(kI);} get yC=>xG; kI( g){wB.window.requestAnimationFrame(kI);if(SH.isNaN)SH=g;if(SH>g)SH=g;var k=g-SH;var h=k/1000.0;var l=g/1000.0;if(k>=1){SH=g;qH.FH=h;eH.NJ(qH);xG.VB(h);for(int i=0;i<JH.length;i++ ){var j=JH[i];j.yC.VB(h);j.AG(l,h);}}} jF( g){if(g.AD!=null){g.AD.JG(g);}JH.add(g);g.xJ=this;} JG( g){if(g.AD==this){JH.remove(g);g.xJ=null;}}}class iB{static const  QD=1;static const  OC=2;static const  hE=3;}class PE{PE();}class AB{static const  YE="added";static const  eE="addedToStage";static const  ZD="enterFrame";static const  nE="removed";static const  rE="removedFromStage";static const  xE="resize";var YJ;var ZJ;var PJ;var WH;var bJ;var SJ;var WJ;AB( g,[ bubbles=false]){xI(g,bubbles);} xI( g,[ bubbles=false]){YJ=g;ZJ=bubbles;PJ=iB.OC;WH=null;bJ=null;SJ=false;WJ=false;} get ZC=>SJ; get type=>YJ; get bubbles=>ZJ; get RC=>true; get target=>WH;}class EB{var uG;var yG;EB( h, g):uG=h,yG=g;EB.lG():this(0,0); clone()=>new EB(uG,yG); toString()=>"Point [x=${uG}, y=${yG}]"; get x=>uG; get y=>yG; get length=>JC.sqrt(uG*uG+yG*yG);set x( g){uG=g;}set y( g){yG=g;} add( g){return new EB(uG+g.x,yG+g.y);}UC( g){uG=g.x;yG=g.y;} wD( g){return uG==g.x&&yG==g.y;}}class fB{var IH;var aH;dispatchEvent( g){EJ(g,this,this,iB.OC);} dJ( h, j, i){if(j&&aH!=null){var g=aH[h];if(g!=null&&g.iJ)return true;}if(i&&IH!=null){var g=IH[h];if(g!=null&&g.iJ)return true;}return false;} GI( h, g){if(g){if(aH==null)aH=new Map<String,oB>();}else{if(IH==null)IH=new Map<String,oB>();}var i=g?aH:IH;return i.putIfAbsent(h,(){return new oB(this,h,g);});}EJ( g, k, l, j){var h=(j==iB.QD)?aH:IH;if(h==null)return;var i=h[g.type];if(i==null)return;g.WH=k;g.bJ=l;g.PJ=j;g.SJ=false;g.WJ=false;i.NJ(g);}}abstract class w extends q{var oF=false;var BG=true;var kG=true;var tabIndex=0;static const  pE=const RB<t>(t.hD);static const  GF=const RB<t>(t.gD);static const  KF=const RB<t>(t.XD);static const  QF=const RB<t>(t.eD);static const  UF=const RB<t>(t.iD); get onMouseOut=>w.pE.forTarget(this); get onMouseMove=>w.GF.forTarget(this); get onMouseDown=>w.KF.forTarget(this); get onMouseUp=>w.QF.forTarget(this); get onMouseWheel=>w.UF.forTarget(this);static const  WF=const RB<CB>(CB.fD);static const  XF=const RB<CB>(CB.VD);static const  ZF=const RB<CB>(CB.YD); get onTouchMove=>w.WF.forTarget(this); get onTouchEnd=>w.XF.forTarget(this); get onTouchCancel=>w.ZF.forTarget(this);static const  bF=const RB<QB>(QB.UD);static const  dF=const RB<QB>(QB.iC); get onKeyUp=>w.bF.forTarget(this); get onKeyDown=>w.dF.forTarget(this);}class oB<CC extends AB> extends JB.Stream<CC>{final  WH;final  PH;final  nH;final  AI=new List<XE>();var MI=0;oB(this.WH,this.PH,this.nH); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError(error), onDone(), cancelOnError: false}){var g=new XE<CC>(this,h);if(MI==AI.length){AI.add(g);}else{AI[MI]=g;}MI++ ;if(PH==AB.ZD&&nH==false)LC.dD.dI(this);return g;} uI( h){for(int g=0;g<MI;g++ ){if(identical(AI[g],h)){AI[g]=null;break;}}} get iJ{for(var g=0;g<MI;g++ )if(AI[g]!=null)return true;return false;} NJ( k){var j=MI;var h=0;for(int g=0;g<j;g++ ){var i=AI[g];if(i==null)continue;i.CI(k);if(h!=g){AI[h]=i;AI[g]=null;}h++ ;}if(h!=j){for(int g=j;g<MI;g++ ){AI[h++ ]=AI[g];AI[g]=null;}MI=h;}}}class yB{final  matrix=new v.nG();final  next;var alpha=1.0;var TC=kC.mC;yB(this.next);}class GB{var uG;var yG;var EH;var NH;GB( i, g, h, j):uG=i,yG=g,EH=h,NH=j;GB.lG():this(0,0,0,0); clone()=>new GB(uG,yG,EH,NH); toString()=>"Rectangle [x=${uG}, y=${yG}, width=${EH}, height=${NH}]"; get x=>uG; get y=>yG; get width=>EH; get height=>NH; get left=>uG; get top=>yG; get right=>uG+EH; get bottom=>yG+NH;set x( g){uG=g;}set y( g){yG=g;}set width( g){EH=g;}set height( g){NH=g;} contains( g, h){return uG<=g&&yG<=h&&uG+EH>=g&&yG+NH>=h;} wD( g){return uG==g.x&&yG==g.y&&EH==g.width&&NH==g.height;} get isEmpty{return EH==0&&NH==0;}UC( g){uG=g.x;yG=g.y;EH=g.width;NH=g.height;}}class FD extends AB{var FH;FD( g):super(AB.ZD,false){FH=g;} get RC=>false;}class t extends AB{static const  RD="click";static const  dE="doubleClick";static const  XD="mouseDown";static const  eD="mouseUp";static const  gD="mouseMove";static const  hD="mouseOut";static const  zE="mouseOver";static const  iD="mouseWheel";static const  kD="middleClick";static const  FF="middleMouseDown";static const  JF="middleMouseUp";static const  nD="rightClick";static const  NF="rightMouseDown";static const  PF="rightMouseUp";var KJ,LJ;var MJ,OJ;var cJ;var aI;var lI;var bI;var eI;var fJ;var gJ;var hJ;t( g,[ bubbles=false]):super(g,bubbles){xI(g,bubbles);} xI( g,[ bubbles=false]){super.xI(g,bubbles);KJ=LJ=0;MJ=OJ=0;cJ=false;aI=false;lI=false;bI=false;eI=false;fJ=0;gJ=0;hJ=0;}set jJ( g){KJ=g.x;LJ=g.y;}set oJ( g){MJ=g.x;OJ=g.y;} get hB=>cJ; get altKey=>aI; get ctrlKey=>bI; get shiftKey=>eI; get EC=>fJ; get deltaX=>gJ; get deltaY=>hJ;}class QB extends AB{static const  iC="keyDown";static const  UD="keyUp";var aI;var bI;var eI;var gI;var lI;var oI;var qI;var sI;QB( g,[ bubbles=false]):super(g,bubbles){xI(g,bubbles);} xI( g,[ bubbles=false]){super.xI(g,bubbles);aI=false;bI=false;eI=false;gI=false;lI=false;oI=0;qI=0;sI=0;} get altKey=>aI; get ctrlKey=>bI; get shiftKey=>eI; get charCode=>oI; get keyCode=>qI; get keyLocation=>sI;}class LD extends AB{static const  cE="textInput";var ZI="";LD( g,[ bubbles=false]):super(g,bubbles);}class CB extends AB{static const  SD="touchBegin";static const  VD="touchEnd";static const  YD="touchCancel";static const  fD="touchMove";static const  sE="touchOver";static const  wE="touchOut";var GJ;var HJ;var KJ,LJ;var MJ,OJ;var aI;var lI;var bI;var eI;var TJ;var UJ;var VJ;CB( g,[ bubbles=false]):super(g,bubbles){xI(g,bubbles);} xI( g,[ bubbles=false]){super.xI(g,bubbles);GJ=0;HJ=false;KJ=LJ=0;MJ=OJ=0;aI=false;lI=false;bI=false;eI=false;TJ=1.00;UJ=0;VJ=0;}set jJ( g){KJ=g.x;LJ=g.y;}set oJ( g){MJ=g.x;OJ=g.y;} get aC=>GJ; get altKey=>aI; get ctrlKey=>bI; get shiftKey=>eI;}abstract class RE{}class BC implements PB{final  QH=new List<PB>();var gH=0;var pH=0.0; add( g){if(g==null)return;if(this.contains(g))return;if(gH==QH.length){QH.add(g);}else{QH[gH]=g;}gH++ ;} remove( h){if(h==null)return;for(int g=0;g<gH;g++ ){if(identical(QH[g],h)){QH[g]=null;break;}}} contains( h){if(h==null)return false;for(int g=0;g<gH;g++ ){if(identical(QH[g],h)){return true;}}return false;} ED( h, i,[ transitionFunction]){var g=new qC(h,i,transitionFunction);add(g);return g;} nF( h, i){var g=new HD(h,i);add(g);return g;} VB( k){pH+= k;var j=gH;var h=0;for(int g=0;g<j;g++ ){var i=QH[g];if(i==null)continue;if(i.VB(k)==false){QH[g]=null;continue;}if(h!=g){QH[h]=i;QH[g]=null;}h++ ;}if(h!=j){for(int g=j;g<gH;g++ ){QH[h++ ]=QH[g];QH[g]=null;}gH=h;}return true;}}final  NC=new QE<List<q>>(()=>new List<q>());class LC<CC extends AB>{final  IH=new List<oB>();var jH=0;static var dD=new LC<FD>(); dI( g){for(int h=0;h<jH;h++ ){if(IH[h]==g)return;}if(jH==IH.length){IH.add(g);}else{IH[jH]=g;}jH++ ;} NJ( j){j.PJ=iB.OC;j.SJ=false;j.WJ=false;var k=jH;var i=0;for(int g=0;g<k;g++ ){var h=IH[g];if(h==null)continue;if(h.MI==0){IH[g]=null;continue;}j.WH=h.WH;j.bJ=h.WH;h.NJ(j);if(i!=g){IH[i]=h;IH[g]=null;}i++ ;}if(i!=k){for(int g=k;g<jH;g++ ){IH[i++ ]=IH[g];IH[g]=null;}jH=i;}}}class HB implements jB{var EH;var NH;var XH;var iH;var oH;var vH;var BI;var FI;var KI;var LI;var OI;var TI;var YI;var RI;static var jD=new JD(png:true,jpg:true,webp:false);HB( h, i,[ transparent=true, fillColor=0xFFFFFFFF]){EH=h.toInt();NH=i.toInt();XH=transparent;iH=0;BI=KI=0;FI=LI=0;oH=OI=EH;vH=TI=NH;var g=new wB.CanvasElement(width:EH,height:NH);RI=g.context2D;RI.fillStyle=XH?BF(fillColor):gE(fillColor);RI.fillRect(0,0,EH,NH);YI=g;}HB.pG( g){if(g==null)throw new ArgumentError();EH=g.naturalWidth.toInt();NH=g.naturalHeight.toInt();XH=true;iH=0;BI=KI=0;FI=LI=0;oH=OI=EH;vH=TI=NH;YI=g;}HB.qG( g){EH=g.FG.toInt();NH=g.EG.toInt();XH=true;iH=g.LG?2:1;BI=g.offsetX;FI=g.offsetY;oH=g.yD;vH=g.xD;KI=g.sF;LI=g.tF;OI=g.yD;TI=g.xD;YI=g.MG.fH.YI;}static  pC( h,[ bitmapDataLoadOptions=null]){if(bitmapDataLoadOptions==null)bitmapDataLoadOptions=HB.jD;var i=new JB.Completer<HB>();var g=new wB.ImageElement();var j;var k;j=g.onLoad.listen((m){j.cancel();k.cancel();i.complete(new HB.pG(g));});k=g.onError.listen((m){j.cancel();k.cancel();i.completeError(new StateError("Error loading image."));});if(bitmapDataLoadOptions.webp==false){g.src=h;return i.future;}aF.then(( o){var n=new RegExp(r"(png|jpg|jpeg)$",multiLine:false,caseSensitive:true);var l=n.firstMatch(h);if(o==false||l==null){g.src=h;}else{g.src=h.substring(0,h.length-l.group(1).length)+"webp";}});return i.future;} get width=>EH; get height=>NH; clone(){var g=new HB(EH,NH,true,0);g.pF(this);return g;} pF( h,[ matrix=null]){var g=mK();var i=new UB.oG(g,matrix);h.IB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} clear(){var g=mK();g.clearRect(0,0,EH,NH);} IB( h){var g=h.context;switch (iH){case 0:g.drawImage(YI,BI,FI);break;case 1:g.drawImageScaledFromSource(YI,KI,LI,OI,TI,BI,FI,oH,vH);break;case 2:g.transform(0.0,-1.0,1.0,0.0,BI,FI+vH);g.drawImageScaledFromSource(YI,KI,LI,TI,OI,0.0,0.0,vH,oH);break;}} KG( bC, g){var DB=bC.context;if(g.width<=0.0||g.height<=0.0)return;switch (iH){case 0:DB.drawImageScaledFromSource(YI,g.x-BI,g.y-FI,g.width,g.height,g.x+BI,g.y+FI,g.width,g.height);break;case 1:var j=KI;var h=LI;var p=j+OI;var s=h+TI;var l=KI-BI+g.x;var m=LI-FI+g.y;var BB=l+g.width;var u=m+g.height;var o=(j>l)?j:l;var n=(h>m)?h:m;var FB=(p<BB)?p:BB;var vB=(s<u)?s:u;var k=FB-o;var i=vB-n;var uB=BI-j+o;var NB=FI-h+n;if(k>0.0&&i>0.0){DB.drawImageScaledFromSource(YI,o,n,k,i,uB,NB,k,i);}break;case 2:var j=KI;var h=LI;var p=j+TI;var s=h+OI;var l=KI+FI-g.y+vH-g.height;var m=LI-BI+g.x;var BB=l+g.height;var u=m+g.width;var o=(j>l)?j:l;var n=(h>m)?h:m;var FB=(p<BB)?p:BB;var vB=(s<u)?s:u;var k=vB-n;var i=FB-o;var uB=BI-h+n;var NB=FI+p-FB;if(k>0.0&&i>0.0){DB.transform(0.0,-1.0,1.0,0.0,uB,NB+i);DB.drawImageScaledFromSource(YI,o,n,i,k,0,0,i,k);}break;}} mK(){if(RI==null){var g=new wB.CanvasElement(width:EH,height:NH);RI=g.context2D;switch (iH){case 0:RI.drawImage(YI,BI,FI);break;case 1:RI.drawImageScaledFromSource(YI,KI,LI,OI,TI,BI,FI,oH,vH);break;case 2:RI.transform(0.0,-1.0,1.0,0.0,BI,FI+vH);RI.drawImageScaledFromSource(YI,KI,LI,TI,OI,0.0,0.0,vH,oH);RI.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}iH=0;BI=KI=0;FI=LI=0;oH=OI=EH;vH=TI=NH;YI=g;}return RI;}}typedef  gC( ratio);typedef  TE<CC extends AB>( event);class XE<CC extends AB> extends JB.StreamSubscription<CC>{var uH;var CI;var DI;var II;XE(this.uH,this.CI){DI=0;II=false;} cancel(){if(II==false){uH.uI(this);II=true;CI=null;}} onError( g(error)){}}class kC{static const  mC="source-over";} gE( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class SB{var UH;var wH;var yH;final  HI=new List<rC>();final  UI=new List<fF>();static  pC( l){var i=new JB.Completer<SB>();wB.HttpRequest.getString(l).then((p){var h=OE.parse(p) as Map;var j=new List();var g=new SB();g.UH=l;g.wH=h["md5"];g.yH=h["frameRate"].toInt();for(var m in h["movies"] as List){var n=new rC(m,g);g.HI.add(n);}for(var o in h["textureGroups"] as List){var k=new fF(o,g);g.UI.add(k);j.add(k.SC.future);}JB.Future.wait(j).then((u){i.complete(g);}).catchError((s){i.completeError(new StateError("Failed to load image."));});}).catchError((s){i.completeError(new StateError("Failed to load json file."));});return i.future;} lJ( h){for(var g in HI)if(g.id==h)return g;throw new ArgumentError("The movie '${h}' is not available.");} yJ( g){for(var h in UI){if(h.VC.containsKey(g)){return h.VC[g];}}for(var i in HI){if(i.id==g){return new cG(this,g);}}throw new ArgumentError("The symbol '${g}' is not available.");}}final  nC=new v.nG();class aD{static var DF=OD.lD;static var IF=new JB.StreamController<String>();static var LF=IF.stream.asBroadcastStream();static  get RF=>DF;}abstract class q extends fB implements jB{static var vE=0;var WI=vE++ ;var uG=0.0;var yG=0.0;var fI=0.0;var hI=0.0;var jI=1.0;var mI=1.0;var nI=0.0;var pI=0.0;var rI=0.0;var tI=1.0;var vI=true;var wI=false;var yI=null;var AJ=null;var BJ=null;var DJ=false;var FJ=null;var IJ=null;var JJ=null;var LH="";var QJ=null;final  RJ=new v.nG();final  XJ=new v.nG();var aJ=true; get x=>uG; get y=>yG; get cB=>fI; get dB=>hI; get KB=>jI; get LB=>mI; get skewX=>nI; get skewY=>pI; get FC=>rI; get visible=>vI; get alpha=>tI; get TC=>JJ; get name=>LH; get parent=>QJ; get root{var g=this;while (g.QJ!=null)g=g.QJ;return g;} get YC{var g=this.root;if(g is qB)return g;return null;}set x( g){uG=g.toDouble();aJ=true;}set y( g){yG=g.toDouble();aJ=true;}set cB( g){fI=g.toDouble();aJ=true;}set dB( g){hI=g.toDouble();aJ=true;}set KB( g){jI=g.toDouble();aJ=true;}set LB( g){mI=g.toDouble();aJ=true;}set skewX( g){nI=g.toDouble();aJ=true;}set skewY( g){pI=g.toDouble();aJ=true;}set FC( g){rI=g.toDouble();aJ=true;}set visible( g){vI=g;}set alpha( g){tI=g.toDouble();}set TC( g){JJ=g;} setTransform( h, g,[ scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY]){aJ=true;uG=h.toDouble();yG=g.toDouble();if(scaleX!=null){jI=scaleX.toDouble();if(scaleY!=null){mI=scaleY.toDouble();if(rotation!=null){rI=rotation.toDouble();if(skewX!=null){nI=skewX.toDouble();if(skewY!=null){pI=skewY.toDouble();if(pivotX!=null){fI=pivotX.toDouble();if(pivotY!=null)hI=pivotY.toDouble();}}}}}}} get width=>kB(NK).width; get height=>kB(NK).height; set width( h){this.KB=1;var g=this.width;this.KB=(g!=0.0)?h/g:1.0;} set height( h){this.LB=1;var g=this.height;this.LB=(g!=0.0)?h/g:1.0;} IE(){if(QJ!=null)QJ.HG(this);} get NK{if(aJ){aJ=false;var j=nI+rI;var i=pI+rI;if(j==0.0&&i==0.0){XJ.GC(jI,0.0,0.0,mI,uG-fI*jI,yG-hI*mI);}else{var g,l,k,h;var m=JC.cos(j);var n=JC.sin(j);if(j==i){g=jI*m;l=jI*n;k=-mI*n;h=mI*m;}else{g=jI*JC.cos(i);l=jI*JC.sin(i);k=-mI*n;h=mI*m;}var p=uG-(fI*g+hI*k);var o=yG-(fI*l+hI*h);XJ.GC(g,l,k,h,p,o);}}return XJ;} LE( h){if(h==QJ)return NK.clone();if(h.QJ==this)return h.NK.mF();var j=new v.nG();var g=this;while (g!=h&&g.QJ!=null){j.concat(g.NK);g=g.QJ;}if(h==null&&g!=null){j.concat(g.NK);g=null;}if(g==h)return j;var k=new v.nG();var i=h;while (i!=this&&i.QJ!=null){k.concat(i.NK);i=i.QJ;}k.BE();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new GB.lG();returnRectangle.x=g.XB;returnRectangle.y=g.YB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} tB( g, h){if(kB(nC).contains(g,h))return this;return null;} lB( h){RJ.yF();for(q g=this;g!=null;g=g.QJ)RJ.concat(g.NK);RJ.BE();return RJ.NG(h);} dispatchEvent( h){var g=null;if(h.RC||h.bubbles){for(q j=QJ;j!=null;j=j.QJ){if(j.dJ(h.type,h.RC,h.bubbles)){if(g==null)g=NC.GE() as List<q>;g.add(j);}}}if(h.RC&&g!=null){for(int i=g.length-1;i>=0&&h.ZC==false;i-- ){g[i].EJ(h,this,g[i],iB.QD);}}if(h.ZC==false){EJ(h,this,this,iB.OC);}if(h.bubbles&&g!=null){for(int i=0;i<g.length&&h.ZC==false;i++ ){g[i].EJ(h,this,g[i],iB.hE);}}if(g!=null){g.clear();NC.HE(g);}} sJ( h){for(var g=h;g!=null;g=g.QJ)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");QJ=h;} IB( g);}class TB{static const  qE="B";static const  uE="BL";static const  yE="BR";static const  ZE="L";static const  fE="R";static const  CF="T";static const  EF="TL";static const  HF="TR";static const  lD="";}class UB{final  RI;var TH=0.0;var XI=0.0;var cI;var iI;UB.oG( i,[ matrix]):RI=i{iI=null;for(int h=0;h<100;h++ ){iI=new yB(iI);}cI=iI;if(matrix!=null){cI.matrix.UC(matrix);}var g=cI.matrix;RI.setTransform(g.a,g.b,g.c,g.d,g.XB,g.YB);RI.globalAlpha=1.0;RI.globalCompositeOperation=kC.mC;} get context=>RI; reset([ matrix, currentTime, deltaTime]){TH=?currentTime?currentTime:0.0;XI=?deltaTime?deltaTime:0.0;cI=iI;if(matrix!=null){cI.matrix.UC(matrix);}var g=cI.matrix;RI.setTransform(g.a,g.b,g.c,g.d,g.XB,g.YB);RI.globalAlpha=1.0;RI.globalCompositeOperation=kC.mC;RI.clearRect(0,0,RI.canvas.width,RI.canvas.height);} JE( h){var g=h.NK;var BB=h.tI;var j=h.yI;var k=h.IJ;var n=h.JJ;var u=h.AJ;var l=cI as yB;var i=cI.next as yB;cI=i;var p=i.matrix;var o=l.alpha*BB;var s=(n!=null)?n:l.TC;p.tD(g,l.matrix);i.alpha=o;i.TC=s;if(j!=null||k!=null){RI.save();if(j!=null){if(j.nB==null){g=i.matrix;}else if(identical(j.nB,h)){g=i.matrix;}else if(identical(j.nB,h.parent)){g=l.matrix;}else{g=j.nB.LE(h);if(g==null)g=nC;else g.concat(i.matrix);}j.IB(this,g);}if(k!=null){if(k.nB==null){g=i.matrix;}else if(identical(k.nB,h)){g=i.matrix;}else if(identical(k.nB,h.parent)){g=l.matrix;}else{g=k.nB.LE(h);if(g==null)g=nC;else g.concat(i.matrix);}k.IB(this,g);}}var m=p;RI.setTransform(m.a,m.b,m.c,m.d,m.XB,m.YB);RI.globalCompositeOperation=s;RI.globalAlpha=o;if(u!=null){u.IB(this);}else{h.IB(this);}if(j!=null||k!=null){RI.restore();}cI=l;}} BF( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class oC{static  mD( g){return g;}static  eF( g){if(g==0.0||g==1.0)return g;return JC.pow(2.0,-10.0*g)*JC.sin((g-0.3/4.0)*(2.0*JC.PI)/0.3)+1;}}class DC{static const  hC="auto";static const  MF="stop";static const  oD="once";} OF( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}class pD{var target=null;var hB=false;var tC=0;var EC=0;var EE,FE;var CE,DE;pD(this.EE,this.FE,this.CE,this.DE);} gB( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class MB{final  zC;var BD=double.NAN;var DD=double.NAN;MB(this.zC); IC( g){this.DD=g.toDouble();} get zF=>!BD.isNaN&&!DD.isNaN; eJ( g){switch (zC){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.cB;case 'pivotY':return g.dB;case 'scaleX':return g.KB;case 'scaleY':return g.LB;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.FC;case 'alpha':return g.alpha;default:return 0.0;}} zJ( g, h){switch (zC){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.cB=h;break;case 'pivotY':g.dB=h;break;case 'scaleX':g.KB=h;break;case 'scaleY':g.LB=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.FC=h;break;case 'alpha':g.alpha=h;break;}}}class SF{static var TF=0;var aC=TF++ ;var target=null;var WC=false;SF(this.target,this.WC);}class qB extends aB{var kJ;var RI;var mJ,nJ;var pJ,qJ;var rJ,tJ;var uJ;var wJ;var xJ;var xG;var eG=30;var BK;var CK;var DK;var EK;var FK;var GK;var HK;var IK;var JK;var KK;var LK;var MK;var OK;qB( h, g){LH=h;kJ=g;kJ.focus();RI=g.context2D;pJ=mJ=g.width;qJ=nJ=g.height;rJ=g.clientWidth;tJ=g.clientHeight;uJ=new v.nG();wJ=new v.nG();xJ=null;xG=new BC();CK=new UB.oG(RI);DK=DC.hC;EK=zB.cD;FK=TB.lD;JK=[new pD(t.XD,t.eD,t.RD,t.dE),new pD(t.FF,t.JF,t.kD,t.kD),new pD(t.NF,t.PF,t.nD,t.nD)];GK=OB.jC;IK=null;HK=new EB(0,0);LK=new t(t.RD,true);AC.AF.listen(AF);kJ.onMouseDown.listen(fK);kJ.onMouseUp.listen(fK);kJ.onMouseMove.listen(fK);kJ.onMouseOut.listen(fK);kJ.onMouseWheel.listen(gK);KK=new Map<int,SF>();OK=new CB(CB.SD,true);aD.LF.listen(hK);hK(null);MK=new QB(QB.iC,true);kJ.onKeyDown.listen(iK);kJ.onKeyUp.listen(iK);kJ.onKeyPress.listen(jK);} get AD=>xJ; get yC=>xG; get focus=>BK;kK(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){kK();}set y( g){kK();}set cB( g){kK();}set dB( g){kK();}set KB( g){kK();}set LB( g){kK();}set skewX( g){kK();}set skewY( g){kK();}set FC( g){kK();}set alpha( g){kK();}set width( g){kK();}set height( g){kK();}AG( g, h){if(DK==DC.hC||DK==DC.oD){lK();CK.reset(wJ,g,h);IB(CK);if(DK==DC.oD)DK=DC.MF;}}lK(){var m=kJ.getBoundingClientRect();var n=kJ.clientLeft+m.left;var o=kJ.clientTop+m.top;var k=kJ.clientWidth;var l=kJ.clientHeight;if(k==0||l==0)return;var g=mJ;var h=nJ;var i=0;var j=0;switch (EK){case zB.VE:g=mJ;h=nJ;break;case zB.bE:if(k*nJ>l*mJ){h=(mJ*l)~/k;}else{g=(nJ*k)~/l;}break;case zB.kE:g=k;h=l;break;case zB.cD:if(k*nJ>l*mJ){g=(nJ*k)~/l;}else{h=(mJ*l)~/k;}break;}switch (FK){case TB.qE:i=(mJ-g+1)~/2;j=(nJ-h);break;case TB.uE:i=0;j=(nJ-h);break;case TB.yE:i=(mJ-g);j=(nJ-h);break;case TB.ZE:i=0;j=(nJ-h+1)~/2;break;case TB.fE:i=(mJ-g);j=(nJ-h+1)~/2;break;case TB.CF:i=(mJ-g+1)~/2;j=0;break;case TB.EF:i=0;j=0;break;case TB.HF:i=(mJ-g+1);j=0;break;case TB.lD:i=(mJ-g+1)~/2;j=(nJ-h+1)~/2;break;}wJ.GC(1.0,0.0,0.0,1.0,0-i,0-j);uJ.GC(g/k,0.0,0.0,h/l,i-n,j-o);if(pJ!=g||qJ!=h){kJ.width=pJ=g;kJ.height=qJ=h;}if(rJ!=k||tJ!=l){rJ=k;tJ=l;dispatchEvent(new AB(AB.xE));}}AF( g){kJ.style.cursor=AC.qD(GK);}fK( j){j.preventDefault();var n=new DateTime.now().millisecondsSinceEpoch;var p=j.button;var h=null;var i=uJ.vJ(j.client);var m=null;if(p<0||p>2)return;if(j.type=="mousemove"&&HK.wD(i))return;var g=JK[p];HK=i;if(AC.WD!=null)AC.WD.oK();if(j.type!="mouseout")h=tB(i.x,i.y) as w;var l=OB.jC;if(h is dC&&(h as dC).OG){l=OB.lC;}if(h is ND&&(h as ND).OG){l=OB.lC;}if(GK!=l){GK=l;kJ.style.cursor=AC.qD(l);}if(IK!=null&&IK!=h){IK.dispatchEvent(LK..xI(t.hD,true)..jJ=(IK.YC!=null)?IK.lB(i):new EB.lG()..oJ=i..cJ=g.hB);IK=null;}if(h!=null&&h!=IK){h.dispatchEvent(LK..xI(t.zE,true)..jJ=h.lB(i)..oJ=i..cJ=g.hB);IK=h;}var k=null;var o=false;var s=false;if(j.type=="mousedown"){k=g.EE;if(h!=g.target||n>g.tC+500)g.EC=0;g.hB=true;g.target=h;g.tC=n;g.EC++ ;}if(j.type=="mouseup"){k=g.FE;g.hB=false;o=(g.target==h);s=o&&g.EC.isEven&&(n<g.tC+500);}if(j.type=="mousemove"){k=t.gD;}if(k!=null&&h!=null){m=h.lB(i);h.dispatchEvent(LK..xI(k,true)..jJ=m..oJ=i..cJ=g.hB..fJ=g.EC);if(o){if(s&&h.oF){h.dispatchEvent(LK..xI(g.DE,true)..jJ=m..oJ=i..cJ=g.hB);}else{h.dispatchEvent(LK..xI(g.CE,true)..jJ=m..oJ=i..cJ=g.hB);}}}}gK( h){var g=uJ.vJ(h.client);var i=tB(g.x,g.y) as w;if(i!=null){i.dispatchEvent(LK..xI(t.iD,true)..jJ=i.lB(g)..oJ=g..gJ=h.deltaX..hJ=h.deltaY);if(LK.ZC)h.preventDefault();}}var rK=[] ;hK( h){rK.forEach((g)=>g.cancel());if(aD.RF==OD.iE){rK=[kJ.onTouchStart.listen(sK),kJ.onTouchEnd.listen(sK),kJ.onTouchMove.listen(sK),kJ.onTouchEnter.listen(sK),kJ.onTouchLeave.listen(sK),kJ.onTouchCancel.listen(sK)];}}sK( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=uJ.vJ(m.client);var h=tB(i.x,i.y) as w;var g=KK.containsKey(l)?KK[l]:new SF(h,KK.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(OK..xI(CB.wE,true)..jJ=(g.target.YC!=null)?g.target.lB(i):new EB.lG()..oJ=i..GJ=g.aC..HJ=g.WC);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(OK..xI(CB.sE,true)..jJ=h.lB(i)..oJ=i..GJ=g.aC..HJ=g.WC);g.target=h;}var k=null;if(j.type=="touchstart"){KK[l]=g;k=CB.SD;}if(j.type=="touchend"){KK.remove(l);k=CB.VD;}if(j.type=="touchcancel"){KK.remove(l);k=CB.YD;}if(j.type=="touchmove"){k=CB.fD;}if(k!=null&&h!=null){h.dispatchEvent(OK..xI(k,true)..jJ=h.lB(i)..oJ=i..GJ=g.aC..HJ=g.WC);}}}iK( g){g.preventDefault();var h=null;if(g.type=="keyup")h=QB.UD;if(g.type=="keydown")h=QB.iC;MK..xI(h,true)..aI=g.altKey..bI=g.ctrlKey..eI=g.shiftKey..oI=g.charCode..qI=g.keyCode..sI=pB.UE;if(g.keyLocation==wB.KeyLocation.LEFT)MK.sI=pB.ZE;if(g.keyLocation==wB.KeyLocation.RIGHT)MK.sI=pB.fE;if(g.keyLocation==wB.KeyLocation.NUMPAD)MK.sI=pB.jE;if(g.keyLocation==wB.KeyLocation.JOYSTICK)MK.sI=pB.bD;if(g.keyLocation==wB.KeyLocation.MOBILE)MK.sI=pB.bD;if(BK!=null)BK.dispatchEvent(MK);}jK( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new LD(LD.cE,true);h.ZI=new String.fromCharCodes([i]);if(BK!=null)BK.dispatchEvent(h);}} rD( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);} sD( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";}class cG extends q implements PB{final  PK;final  QK;final  RK=new List<YF>();var SK=0.0;var TK=0.0;var UK=0;var KH=0;cG( g, j):PK=g,QK=g.lJ(j){for(var h in QK.wC){var i=new YF(PK,h);RK.add(i);}KH=QK.xC;TK=KH/PK.yH;} VB( h){SK+= h;var i=SK%TK;UK=JC.min((KH*i/TK).toInt(),KH-1);for(var g in RK){g.VB(h);g.KE(UK);}return true;} IB( h){for(var g in RK){if(g.visible){h.JE(g);}}}} VF(){var i=new JB.Completer<bool>();var g=new wB.ImageElement(); h(){i.complete(g.width==2&&g.height==2);}g.onLoad.listen((j)=>h());g.onError.listen((j)=>h());g.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";return i.future;}class qC implements PB{final  VK;final  WK;final  XK=new List<MB>();var YK;var ZK;var aK;var bK;var cH;var TH;var cK;var dK;var eK;qC( g, h,[ transitionFunction]):VK=g,WK=(?transitionFunction)?transitionFunction:oC.mD{bK=new KD(this);TH=0.0;cH=JC.max(0.0001,h);cK=0.0;dK=false;eK=false;} get QC=>bK; sH( g){if(VK!=null&&eK==false){XK.add(g);}} VB( m){if(TH<cH||eK==false){TH=TH+m;if(TH>cH){TH=cH;}if(TH>=0.0){if(eK==false){eK=true;for(int h=0;h<XK.length;h++ ){var g=XK[h];g.BD=g.eJ(VK);}if(YK!=null){YK();}}var k=TH/cH;var l=WK(k).toDouble();for(int h=0;h<XK.length;h++ ){var g=XK[h];if(g.zF){var i=g.BD.toDouble();var n=g.DD.toDouble();var j=i+l*(n-i);g.zJ(VK,dK?j.round():j);}}if(ZK!=null){ZK();}if(aK!=null&&TH==cH){aK();}}}return TH<cH;}set uD( g){if(eK==false)TH=TH+cK-g;cK=g;} set onComplete( g()){aK=g;}}class YF extends q implements PB{final  sB;final  vC;final  CD=new Map<String,jB>();var HC;YF( i, h):this.sB=i,this.vC=h{for(var g in h.WB){if(g.mB!=null&&CD.containsKey(g.mB)==false){CD[g.mB]=i.yJ(g.mB);}}KE(0);} VB( g){if(HC is PB){var h=HC as PB;h.VB(g);}} KE( u){var g=vC.wF(u);var o=g.x,p=g.y;var n=g.KB,k=g.LB;var m=g.skewX,l=g.skewY;var DB=g.cB,bC=g.dB;var s=g.alpha;if(g.index!=u&&g.ME){var i=vC.vF(g);if(i!=null){var h=(u-g.index)/g.duration;var j=g.vD;if(j!=0){var BB=0.0;if(j<0){var NB=1-h;BB=1-NB*NB;j=0-j;}else{BB=h*h;}h=j*BB+(1-j)*h;}o=o+(i.x-o)*h;p=p+(i.y-p)*h;n=n+(i.KB-n)*h;k=k+(i.LB-k)*h;m=m+(i.skewX-m)*h;l=l+(i.skewY-l)*h;s=s+(i.alpha-s)*h;}}var FB=n*JC.cos(l);var NE=n*JC.sin(l);var uB=-k*JC.sin(m);var vB=k*JC.cos(m);var QG=o-(DB*FB+bC*uB);var RG=p-(DB*NE+bC*vB);aJ=false;XJ.GC(FB,NE,uB,vB,QG,RG);tI=s;vI=g.visible;HC=(g.mB!=null)?CD[g.mB]:null;} IB( g){if(HC!=null){HC.IB(g);}}}var aF=VF(); cF( g, m, n, j){m=m.toDouble();n=n.toDouble();var NB=0.0;var FB=0.0;var s=m*g.a;var DB=m*g.b;var u=m*g.a+n*g.c;var p=m*g.b+n*g.d;var BB=n*g.c;var o=n*g.d;var h=NB;if(h>s)h=s;if(h>u)h=u;if(h>BB)h=BB;var i=FB;if(i>DB)i=DB;if(i>p)i=p;if(i>o)i=o;var l=NB;if(l<s)l=s;if(l<u)l=u;if(l<BB)l=BB;var k=FB;if(k<DB)k=DB;if(k<p)k=p;if(k<o)k=o;if(j==null)j=new GB.lG();j.x=g.XB+h;j.y=g.YB+i;j.width=l-h;j.height=k-i;return j;}class rC{final  id;final  sB;final  wC=new List<sC>();rC( g, j):sB=j,id=g["id"]{for(var h in g["layers"]){var i=new sC(h);this.wC.add(i);}} get xC{var g=0;for(var h in wC)g=JC.max(g,h.xC);return g;}}class sC{final  name;final  rF;final  WB=new List<PC>();sC( g):this.name=g["name"],this.rF=g.containsKey("flipbook")?g["flipbook"]:false{for(var i in g["keyframes"]){var h=new PC(i);this.WB.add(h);}} get xC{var g=WB[WB.length-1];return g.index+g.duration;} wF( h){var g=1;while (g<WB.length&&WB[g].index<=h)g++ ;return WB[g-1];} vF( h){for(int g=0;g<WB.length-1;g++ )if(identical(WB[g],h))return WB[g+1];return null;}}class PC{var index;var duration;var mB;var label;var x,y;var KB,LB;var skewX,skewY;var cB,dB;var visible;var alpha;var ME;var vD;PC( g){this.index=g["index"];this.duration=g["duration"];this.mB=g.containsKey("ref")?g["ref"]:null;this.label=g.containsKey("label")?g["label"]:null;this.x=g.containsKey("loc")?g["loc"][0]:0.0;this.y=g.containsKey("loc")?g["loc"][1]:0.0;this.KB=g.containsKey("scale")?g["scale"][0]:1.0;this.LB=g.containsKey("scale")?g["scale"][1]:1.0;this.skewX=g.containsKey("skew")?g["skew"][0]:0.0;this.skewY=g.containsKey("skew")?g["skew"][1]:0.0;this.cB=g.containsKey("pivot")?g["pivot"][0]:0.0;this.dB=g.containsKey("pivot")?g["pivot"][1]:0.0;this.visible=g.containsKey("visible")?g["visible"]:true;this.alpha=g.containsKey("alpha")?g["alpha"]:1.0;this.ME=g.containsKey("tweened")?g["tweened"]:true;this.vD=g.containsKey("ease")?g["ease"]:0.0;}}class fF{var sB;var VC;var SC;fF( p,this.sB){this.VC=new Map<String,gF>();this.SC=new JB.Completer();var k=0;for(var j in p["atlases"] as List){var n=j["file"] as String;var s=sD(sB.UH,n);k++ ;var g=new wB.ImageElement();g.onLoad.listen((o){if( --k==0)this.SC.complete(this);});g.onError.listen((o){this.SC.completeError(new StateError("Failed to load image."));});g.src=s;for(var i in j["textures"] as List){var m=i["symbol"] as String;var h=i["rect"] as List;var l=i["origin"] as List;var u=new gF(h[0],h[1],h[2],h[3],l[0],l[1],g);this.VC[m]=u;}}}}class gF implements jB{var x,y,width,height;var CG,DG;var AE;var pK;var qK;gF(this.x,this.y,this.width,this.height,this.CG,this.DG,this.AE); IB( g){g.context.drawImageScaledFromSource(AE,x,y,width,height,0,0,width,height);}}//@ sourceMappingURL=stagexl_runtimes.dart.map
