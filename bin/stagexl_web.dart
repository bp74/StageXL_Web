import "dart:json" as nG;import "dart:html" as QB;import "dart:async" as VB;import "dart:math" as bB;import "dart:web_audio" as PF;class tJ{static const  uJ="Chrome";static const  vJ="Firefox";static const  wJ="Internet Explorer";static const  xJ="Safari";final  HJ;final  minimumVersion;const tJ(this.HJ,[this.minimumVersion]);}class yJ{final  name;const yJ(this.name);}class FK extends WB{final  NL=[{'name':'DropShadowFilter (black)','filter':new QK(10,bB.PI/4,DC.hD,0.8,8,8)},{'name':'GlowFilter (red)','filter':new OK(DC.GG,1.0,20,20)},{'name':'ColorMatrixFilter (grayscale)','filter':new NK.HL()},{'name':'ColorMatrixFilter (invert)','filter':new NK.IL()},{'name':'BlurFilter (radius 1)','filter':new MK(1,1)},{'name':'BlurFilter (radius 5)','filter':new MK(5,5)},{'name':'BlurFilter (radius 10)','filter':new MK(10,10)},{'name':'BlurFilter (radius 20)','filter':new MK(20,20)}];FK(){var m=new DB(940,500,true,0x000000);var k=RB.SC('king');var o=new DB(230,245,true,0xFFF0F0F0);var p=new eD(m);HB(p);for(int h=0;h<NL.length;h++ ){var i=235*(h%4);var j=250*(h~/4);var q=NL[h]['filter'] as qB;var t=NL[h]['name'] as String;var v=new AB(0,0,k.width,k.height);var n=new GB(i+40,j+45);m.GJ(k,v,n,q);var l=new eD(o);l.x=i;l.y=j;mE(l,0);var g=new TK();g.RC=new CE('Helvetica Neue, Helvetica, Arial',14,DC.hD);g.x=i+5;g.y=j+5;g.width=200;g.text=t;HB(g);}}}class AK extends WB{final  ML=new bB.Random();AK(){var g=new ID();g.mB=470;g.sB=250;g.x=470;g.y=250;HB(g);for(int h=0;h<150;h++ ){var w=1+ML.nextInt(3);var p=RB.SC('flower${w}');var i=new eD(p);i.mB=64;i.sB=64;i.x=64+ML.nextInt(940-128);i.y=64+ML.nextInt(500-128);g.HB(i);var o=new jD(i,600,s.uC);o.HC.UC.vB(bB.PI*60.0);OB.add(o);}var k=new List<GB>();for(int h=0;h<6;h++ ){var n=(h*60)*bB.PI/180;var m=(h*60+30)*bB.PI/180;k.add(new GB(470+200*bB.cos(n),250+200*bB.sin(n)));k.add(new GB(470+100*bB.cos(m),250+100*bB.sin(m)));}var t=new FD.AL(100,100,740,300);var v=new FD.CL(470,250,200);var q=new FD.EL(k);QB.query('#mask-none').onClick.listen((j)=>g.mask=null);QB.query('#mask-rectangle').onClick.listen((j)=>g.mask=t);QB.query('#mask-circle').onClick.listen((j)=>g.mask=v);QB.query('#mask-custom').onClick.listen((j)=>g.mask=q);QB.query('#mask-spin').onClick.listen((j){var l=new jD(g,2.0,s.HG);l.HC.UC.vB(bB.PI*4.0);l.onComplete=()=>g.UC=0.0;OB.add(l);});}}class zJ extends WB{var ML=new bB.Random();var PL;var QL;zJ(){PL=RB.sE('walkTextureAtlas');QL=PL.SJ('walk');TL();}TL(){var h=ML.nextDouble();var g=new uG(QL,30);g.x=-128;g.y=20.0+180.0*h;g.cB=g.dB=0.5+0.5*h;g.play();HB(g);qJ((k,j)=>(k.y-j.y).toInt());var i=new jD(g,5.0+(1.0-h)*5.0,s.uC);i.HC.x.vB(940.0);i.onComplete=(){OB.remove(g);gG(g);};OB.add(g);OB.add(i);OB.MG(TL,0.2);}}class IK extends WB{final  OL=['C4','A3','A3','C4','D4','G3','G3','A3','A3#','F4','F4','E4','C4','D4','C4','A3#','A3','C4','D4','D4','D4','G4','F4','E4','F4','D4','C4','F3','G3','A3','D4','C4','C4','A3#','A3','E3','F3'];final  SL=['Hey ','Jude, ',"don't ",'make ','it ','bad.<br>','Take ','a ','sad ','song ','and ','make ','it ','better.<br>','','','','Remember ','','','to ','let ','her ','into ','','your ','heart.<br>','Than ','you ','can ','start ','','to ','make ','things ','better.','',' '];IK(){var h=new eD(RB.SC('Background'));HB(h);var g=new oG(OL,SL);g.x=120;g.y=30;HB(g);QB.query('#startOver').onClick.listen((i)=>g.oJ());}}class HK extends WB{final  text='Filet mignon leberkas pig pork chop biltong, short loin strip steak turkey brisket ' 'venison. Pastrami venison pancetta, leberkas pork chop chicken prosciutto beef ribs ' 'bresaola kielbasa swine biltong capicola. Hamburger beef ribs ball tip drumstick salami ' 'pig. Capicola pork loin shank, salami chicken hamburger tail. Sirloin spare ribs ' 'ground round cow strip steak prosciutto swine bacon corned beef.';HK(){var j=new TK();j.RC=new CE('Helvetica,Arial',14,DC.YI,bold:true,italic:true);j.text=text;j.x=10;j.y=10;j.width=920;j.height=20;HB(j);var h=new TK();h.RC=new CE('Helvetica,Arial',16,DC.GG);h.text=text;h.x=10;h.y=50;h.width=200;h.height=300;h.wordWrap=true;HB(h);var g=new TK();g.RC=new CE('Helvetica,Arial',16,DC.pH,align:aC.lF);g.text=text;g.x=300;g.y=50;g.width=200;g.height=300;g.wordWrap=true;HB(g);var i=new TK();i.RC=new CE('Caesar Dressing',30,DC.hD,align:aC.JE);i.text=text;i.x=590;i.y=50;i.width=340;i.height=300;i.wordWrap=true;HB(i);}}class CK extends WB{CK(){var g=new TK();g.RC=new CE('Helvetica,Arial',14,DC.MI,bold:true);g.text='ToDo: show a cool demo ...';g.x=10;g.y=10;g.width=920;g.height=20;HB(g);}}class DK extends WB{DK(){var k=RB.UJ('flump');var i=new XK(k,'idle');i.x=500;i.y=200;HB(i);var j=new XK(k,'walk');j.x=150;j.y=460;HB(j);var g=new XK(k,'attack');g.x=450;g.y=460;HB(g);var h=new XK(k,'defeat');h.x=720;h.y=460;HB(h);OB.add(i);OB.add(j);OB.add(g);OB.add(h);DB.tC('images/flumpLibraryAtlas0.png').then((m){var l=new eD(m);l.x=40;l.y=40;HB(l);});}}class EK extends WB{var PL;EK(){PL=RB.sE('levelUp');RL();DB.tC('images/LevelupTextureAtlas.png').then((h){var g=new eD(h);g.x=70;g.y=40;HB(g);});}RL(){var l=330;for(int j=0;j<7;j++ ){var h=PL.SC('LevelUp${j}');var g=new eD(h);g.mB=h.width/2;g.sB=h.height/2;g.x=l+h.width/2;g.y=150;g.cB=0.0;g.dB=0.0;HB(g);var k=new jD(g,2.0,s.kD);k.HC.cB.vB(1.0);k.HC.dB.vB(1.0);k.LG=j*0.05;var i=new jD(g,0.4,s.uC);i.HC.cB.vB(0.0);i.HC.dB.vB(0.0);i.LG=2.0;i.onComplete=()=>g.zE();OB.add(k);OB.add(i);l=l+5+h.width;}OB.MG(()=>RL(),3.0);}}class GK{final  LL=[{"name":"linear","transition":s.uC},{"name":"sine","transition":s.xF},{"name":"cosine","transition":s.II},{"name":"random","transition":s.KI},{"name":"easeInQuadratic","transition":s.RE},{"name":"easeOutQuadratic","transition":s.SE},{"name":"easeInOutQuadratic","transition":s.SI},{"name":"easeOutInQuadratic","transition":s.UI},{"name":"easeInCubic","transition":s.TE},{"name":"easeOutCubic","transition":s.UE},{"name":"easeInOutCubic","transition":s.DG},{"name":"easeOutInCubic","transition":s.XI},{"name":"easeInQuartic","transition":s.VE},{"name":"easeOutQuartic","transition":s.WE},{"name":"easeInOutQuartic","transition":s.aI},{"name":"easeOutInQuartic","transition":s.bI},{"name":"easeInQuintic","transition":s.XE},{"name":"easeOutQuintic","transition":s.YE},{"name":"easeInOutQuintic","transition":s.dI},{"name":"easeOutInQuintic","transition":s.eI},{"name":"easeInCircular","transition":s.ZE},{"name":"easeOutCircular","transition":s.aE},{"name":"easeInOutCircular","transition":s.hI},{"name":"easeOutInCircular","transition":s.iI},{"name":"easeInSine","transition":s.bE},{"name":"easeOutSine","transition":s.cE},{"name":"easeInOutSine","transition":s.oI},{"name":"easeOutInSine","transition":s.pI},{"name":"easeInExponential","transition":s.dE},{"name":"easeOutExponential","transition":s.eE},{"name":"easeInOutExponential","transition":s.rI},{"name":"easeOutInExponential","transition":s.tI},{"name":"easeInBack","transition":s.gE},{"name":"easeOutBack","transition":s.hE},{"name":"easeInOutBack","transition":s.HG},{"name":"easeOutInBack","transition":s.uI},{"name":"easeInElastic","transition":s.iE},{"name":"easeOutElastic","transition":s.kD},{"name":"easeInOutElastic","transition":s.wI},{"name":"easeOutInElastic","transition":s.xI},{"name":"easeInBounce","transition":s.jE},{"name":"easeOutBounce","transition":s.lD},{"name":"easeInOutBounce","transition":s.yI},{"name":"easeOutInBounce","transition":s.zI}]; YJ(){var j=new QB.DivElement();for(int h=0;h<LL.length/4;h++ ){var i=new QB.DivElement();i.classes.add("row");j.children.add(i);for(int g=0;g<4;g++ ){var m=LL[h*4+g]["name"];var l=LL[h*4+g]["transition"];var k=eL(m,l);k.id="cell";i.children.add(k);}}return j;} eL( o, q( ratio)){var h=new QB.DivElement();h.classes.add("span3");h.style.height="130px";var j=new QB.CanvasElement(width:200,height:140);j.style.position="absolute";j.style.zIndex="1";h.children.add(j);var i=new QB.DivElement();i.text=o;i.style.position="relative";i.style.zIndex="2";i.style.top="6px";h.children.add(i);var l=new vC("stage",j);var n=new RK();var g=n.SG;g.beginPath();g.moveTo(0.5,30.5);g.lineTo(199.5,30.5);g.lineTo(199.5,109.5);g.lineTo(0.5,109.5);g.closePath();g.lG(0xFF000000);g.NJ(0xFFDFDFDF);g.beginPath();g.moveTo(0.5,109.5);for(int k=0;k<=199;k++ ){var m=k/199.0;var p=0.5+m*199.0;var t=109.5-79.0*q(m);g.lineTo(p,t);}g.lG(0xFF0000FF,2);l.HB(n);l.VG(0,0);return h;}}class BK extends eD implements gB{var yD,zD;BK( g,this.yD,this.zD):super(g){this.mB=g.width/2;this.sB=g.height/2;} rB( i){var g=x+yD*i;var h=y+zD*i;if(g>910||g<30)yD=-yD;else x=g;if(h>470||h<30)zD=-zD;else y=h;return true;}}var tB;var AE;var OB;var RB;class JK extends WB{JK(){UL(250);QB.query('#minus10').onClick.listen((g)=>VL(10));QB.query('#minus50').onClick.listen((g)=>VL(50));QB.query('#plus50').onClick.listen((g)=>UL(50));QB.query('#plus10').onClick.listen((g)=>UL(10));this.eJ.listen(WL);}var XL=null;WL( g){if(XL==null){XL=1.00/g.bG;}else{XL=0.05/g.bG+0.95*XL;}QB.query('#fpsMeter').innerHtml='fps: ${XL.round()}';}UL( l){var g=new bB.Random();var i=RB.sE('flags');var j=i.PJ;while ( --l>=0){var k=j[g.nextInt(j.length)];var m=i.SC(k);var h=new BK(m,g.nextInt(200)-100,g.nextInt(200)-100);h.x=30+g.nextInt(940-60);h.y=30+g.nextInt(500-60);HB(h);OB.add(h);}QB.query('#flagCounter').innerHtml='Flags: ${xE}';}VL( h){while ( --h>=0&&xE>0){var g=TJ(0);g.zE();OB.remove(g);}QB.query('#flagCounter').innerHtml='Flags: ${xE}';}} main(){DB.rF=new FE(png:true,jpg:true,webp:true);var l=QB.window.location.pathname;var m=new RegExp(r"([A-Za-z0-9-]+)\.html",multiLine:false,caseSensitive:false);var g=m.firstMatch(l);if(g!=null&&g.groupCount==1){var h=g.group(1);print("current page: ${h}");var i=QB.query("#stage");if(i!=null){tB=new vC('stage',i);AE=new EE();AE.FJ(tB);OB=AE.wE;RB=new QF();}switch (h){case "filter":RB..uB('king','images/king.png')..load().then((ZL)=>tB.HB(new FK()));break;case "masking":RB..uB('flower1','images/Flower1.png')..uB('flower2','images/Flower2.png')..uB('flower3','images/Flower3.png')..load().then((ZL)=>tB.HB(new AK()));break;case "flipbook":RB..nE('walkTextureAtlas','images/walk.json',KD.gD)..load().then((ZL)=>tB.HB(new zJ()));break;case "performance":RB..nE('flags','images/flags.json',KD.gD)..load().then((ZL)=>tB.HB(new JK()));break;case "sound":RB..uB('KeyBlack','images/piano/KeyBlack.png')..uB('KeyWhite0','images/piano/KeyWhite0.png')..uB('KeyWhite1','images/piano/KeyWhite1.png')..uB('KeyWhite2','images/piano/KeyWhite2.png')..uB('KeyWhite3','images/piano/KeyWhite3.png')..uB('Finger','images/piano/Finger.png')..uB('Background','images/piano/Background.jpg')..KB('Cheer','sounds/Cheer.mp3')..KB('Note1','sounds/piano/Note1.mp3')..KB('Note2','sounds/piano/Note2.mp3')..KB('Note3','sounds/piano/Note3.mp3')..KB('Note4','sounds/piano/Note4.mp3')..KB('Note5','sounds/piano/Note5.mp3')..KB('Note6','sounds/piano/Note6.mp3')..KB('Note7','sounds/piano/Note7.mp3')..KB('Note8','sounds/piano/Note8.mp3')..KB('Note9','sounds/piano/Note9.mp3')..KB('Note10','sounds/piano/Note10.mp3')..KB('Note11','sounds/piano/Note11.mp3')..KB('Note12','sounds/piano/Note12.mp3')..KB('Note13','sounds/piano/Note13.mp3')..KB('Note14','sounds/piano/Note14.mp3')..KB('Note15','sounds/piano/Note15.mp3')..KB('Note16','sounds/piano/Note16.mp3')..KB('Note17','sounds/piano/Note17.mp3')..KB('Note18','sounds/piano/Note18.mp3')..KB('Note19','sounds/piano/Note19.mp3')..KB('Note20','sounds/piano/Note20.mp3')..KB('Note21','sounds/piano/Note21.mp3')..KB('Note22','sounds/piano/Note22.mp3')..KB('Note23','sounds/piano/Note23.mp3')..KB('Note24','sounds/piano/Note24.mp3')..KB('Note25','sounds/piano/Note25.mp3')..load().then((ZL)=>tB.HB(new IK()));break;case "text":tB.HB(new HK());break;case "tweener":tB.HB(new CK());break;case "flump":RB..EJ('flump','images/flumpLibrary.json')..load().then((ZL)=>tB.HB(new DK()));break;case "texturepacker":RB..nE('levelUp','images/LevelupTextureAtlas.json',KD.gD)..load().then((ZL)=>tB.HB(new EK()));break;case "transitions":var k=new GK();var j=k.YJ();QB.query("#transitions").children.add(j);break;}}}class oG extends WB{final  CD;final  BD;final  YL=['C3','C3#','D3','D3#','E3','F3','F3#','G3','G3#','A3','A3#','B3','C4','C4#','D4','D4#','E4','F4','F4#','G4','G4#','A4','A4#','B4','C5'];var aL=new Map<String,pG>();var bL;var cL=0;oG(this.CD,this.BD){for(int h=0,i=0;h<YL.length;h++ ){var k=RB.RG('Note${h+1}');var j=YL[h];var g=aL[j]=new pG(this,j,k);if(j.endsWith('#')){g.x=i-16;g.y=35;HB(g);}else{g.x=i;g.y=35;mE(g,0);i=i+47;}}bL=new eD(RB.SC('Finger'));bL.mB=20;HB(bL);dL();}IJ( g){if(cL<CD.length&&CD[cL]==g){if(cL==CD.length-1)RB.RG('Cheer').play();cL++ ;dL();}}oJ(){cL=0;bL.alpha=1;dL();}dL(){var h=QB.query('#lyrics');var m=-1;h.innerHtml='';for(int g=0,j=0;g<BD.length;g++ ){if(BD[g]!='')j=g;if(g==this.cL)m=j;}for(int g=0;g<BD.length;g++ ){if(g==m){h.appendHtml('<span id="word">${BD[g]}</span>');}else{h.appendHtml(BD[g]);}}if(cL<CD.length){var k=CD[cL];if(aL.containsKey(k)){var i=aL[k];OB.mJ(bL);bL.y=0;var n=new jD(this.bL,0.4,s.DG);var l=new jD(this.bL,0.4,s.xF);n.HC.x.vB(i.x+i.width/2);l.HC.y.vB(-10);OB.add(n);OB.add(l);}}else{var o=new jD(bL,0.4,s.uC);o.HC.alpha.vB(0);OB.add(o);}}}class pG extends ID{final  cG;final  lB;final  kG;pG(this.cG,this.lB,this.kG){var h;if(lB.endsWith('#')){h='KeyBlack';}else if(lB.startsWith('C5')){h='KeyWhite0';}else if(lB.startsWith('C')||lB.startsWith('F')){h='KeyWhite1';}else if(lB.startsWith('D')||lB.startsWith('G')||lB.startsWith('A')){h='KeyWhite2';}else if(lB.startsWith('E')||lB.startsWith('B')){h='KeyWhite3';}var i=RB.SC(h);var l=new eD(i);this.HB(l);var j=lB.endsWith('#')?DC.vI:DC.hD;var k=new CE('Helvetica,Arial',10,j,align:aC.JE);var g=new TK();g.RC=k;g.text=lB;g.width=i.width;g.height=20;g.ZG=false;g.y=i.height-20;HB(g);this.HF=true;this.onMouseDown.listen(fL);this.onMouseOver.listen(fL);this.onMouseUp.listen(gL);this.onMouseOut.listen(gL);}fL( g){if(g.MC){this.kG.play();this.alpha=0.7;this.cG.IJ(this.lB);}}gL( g){this.alpha=1.0;}}const KK=const LK();class LK{const LK();}class DE extends oB{var DM;var XM;var sM;DE(){sM=new List<bD>();DM=new QB.AudioElement();DM.onEnded.listen(nN);XM=new List<QB.AudioElement>();XM.add(DM);QB.document.body.children.add(DM);}static  tC( k,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=oB.rF;var m=new DE();var g=m.DM;var h=sC.FG(k,soundLoadOptions);var i=new VB.Completer<oB>();if(h.length==0){return YC.tC(k,soundLoadOptions);}var j;var l;q(o){j.cancel();l.cancel();i.complete(m);}n(o){if(h.length>0){g.src=h.removeAt(0);g.load();}else{j.cancel();l.cancel();if(soundLoadOptions.ignoreErrors){YC.tC(k,soundLoadOptions).then((p)=>i.complete(p));}else{i.completeError(new StateError("Failed to load audio."));}}}j=g.onCanPlayThrough.listen(q);l=g.onError.listen(n);g.src=h.removeAt(0);g.load();return i.future;} get length{return DM.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new fB();return new bD(this,loop,soundTransform);} CO( h){var g;if(XM.length==0){g=DM.clone(true);g.onEnded.listen(nN);}else{g=XM.removeAt(0);}sM.add(h);return g;} NP( g){var h=g.DM;var i=sM.indexOf(g);sM.removeAt(i);XM.add(h);if(DM.currentTime>0&&DM.ended==false)DM.currentTime=0;} nN( j){var i=j.target;var g=null;for(int h=0;h<sM.length&&g==null;h++ )if(sM[h].DM==i)g=sM[h];if(g!=null)g.stop();}}class wG{static const  IH="round";}class GD{static const  CH="exactFit";static const  MH="noBorder";static const  VH="noScale";static const  iF="showAll";}class FD{var VC=null;FD();factory FD.AL( i, g, h, j){return new UK(i,g,h,j);}factory FD.CL( i, g, h){return new VK(i,g,h);}factory FD.EL( g){return new WK(g);} BB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.ZB,g.aB);}}class CC{static const  YF=1;static const  eC=2;static const  RH=3;}abstract class cC{ BB( g);}class ID extends WB{var jK=false;var HF=false;var uE=null;var vL=null;var JN=null; get SG{return (vL!=null)?vL:vL=new JD();}KP(){var i=this.sD;var j=this.nC;var m=this.visible;if(i!=null&&this.nC!=null){var h=dC.ZH;if(h!=null){var g=SP.xD(i);if(g.x<h.left)g.x=h.left;if(g.x>h.right)g.x=h.right;if(g.y<h.top)g.y=h.top;if(g.y>h.bottom)g.y=h.bottom;i=SP.IG().xD(g);}var l=new GB(xN,AO).add(i).subtract(dC.WH);var k=SP.xD(l);this.visible=false;JN=j.XB(j.cJ,j.dJ);this.x=k.x;this.y=k.y;this.visible=m;}} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new AB.BL();super.kB(g,returnRectangle);if(vL!=null){returnRectangle=vL.MO(g).union(returnRectangle);}return returnRectangle;} XB( i, j){var h=null;if(this.uE!=null){var g=this.FF(this.uE);if(g!=null){var k=i*g.a+j*g.c+g.ZB;var l=i*g.b+j*g.d+g.aB;if(this.uE.XB(k,l)!=null){h=this;}}}else{h=super.XB(i,j);if(h==null&&vL!=null){if(vL.mO(i,j)){h=this;}}}return h;}BB( g){if(vL!=null)vL.BB(g);super.BB(g);}}class TK extends LB{var CM="";var NM=0x000000;var hM=null;var yM=qG.vF;var QN=xG.KH;var cN=sG.DH;var iN=false;var oN=false;var rN=0x000000;var vN=false;var zN=0x000000;var EO=0;var HO=0;var KO;var QO;var TO=true;var WO=100;var XO=100;var bO=null;var zL=null;TK([ text, textFormat]){if(text!=null)CM=text;if(textFormat!=null)RC=textFormat;else hM=new CE("Arial",12,0x000000);KO=new List<String>();QO=new List<yG>();} get text=>CM; get type=>cN; get width=>WO; get height=>XO; set text( g){CM=g;TO=true;} set RC( g){hM=g;NM=hM.color;TO=true;} set wordWrap( g){iN=g;TO=true;} set width( g){WO=g;TO=true;} set height( g){XO=g;TO=true;} kB( g,[ returnRectangle]){return fE(g,WO,XO,returnRectangle);} XB( g, h){if(g>=0&&h>=0&&g<WO&&h<XO)return this;return null;} BB( g){TQ();g.zL.drawImage(bO,0.0,0.0);} VQ( o){var n=QH(o);KO.clear();QO.clear();if(iN==false){for(String h in CM.replaceAll('\r','').split('\n'))KO.add(h);}else{for(String h in CM.replaceAll('\r','').split('\n')){var g='';for(String j in h.split(' ')){var m=g;g=(g.length==0)?j:g+' '+j;if(zL.measureText(g).width>WO){if(m.length==0){KO.add(g);g='';}else{KO.add(m);g=j;}}}if(g.isEmpty==false){KO.add(g);}}}EO=0;HO=0;for(String g in KO){var k=zL.measureText(g);var l=0.0;if(hM.align==aC.JE||hM.align==aC.SH)l=(WO-k.width)/2;if(hM.align==aC.lF||hM.align==aC.LH)l=WO-k.width;var i=new yG(l,k.width,hM.size,n.OD,n.qD,0);QO.add(i);EO=bB.max(EO,i.width);HO=HO+i.height;}} TQ(){if(TO){TO=false;var h=WO.ceil().toInt();var i=XO.ceil().toInt();if(bO==null){bO=new QB.CanvasElement(width:h,height:i);zL=bO.context2d;}if(bO.width!=h)bO.width=h;if(bO.height!=i)bO.height=i;var m=new StringBuffer()..write(hM.italic?"italic ":"normal ")..write("normal ")..write(hM.bold?"bold ":"normal ")..write("${hM.size}px ")..write("${hM.font},sans-serif");var j=m.toString();zL.font=j;zL.textAlign="start";zL.textBaseline="alphabetic";zL.fillStyle=MD(NM);VQ(j);if(oN){zL.fillStyle=MD(rN);zL.fillRect(0,0,WO,XO);}else{zL.clearRect(0,0,WO,XO);}var k=hM.size;for(int g=0;g<KO.length;g++ ){var l=QO[g];zL.fillStyle=MD(NM);zL.fillText(KO[g],l.x,k);k+= l.height;}if(vN){zL.strokeStyle=MD(zN);zL.lineWidth=1;zL.strokeRect(0,0,WO,XO);}}}}class PK extends ZC{var PM;var SM;var xL;var CN;var PN;PK( j, h, i){PM=j;xL=h;SM=i;var g=sC.iD;CN=g.createGain();CN.connect(g.destination,0,0);CN.gain.value=(SM!=null)?bB.pow(SM.volume,2):1;PN=g.createBufferSource();PN.buffer=PM.BM;PN.loop=h;PN.connect(CN,0,0);PN.start(0);} set uD( g){SM=g;CN.gain.value=(SM!=null)?bB.pow(SM.volume,2):1;} stop(){PN.stop(0);}}abstract class oB{static  tC( g,[ soundLoadOptions=null]){switch (sC.lH){case "WebAudioApi":return BE.tC(g,soundLoadOptions);case "AudioElement":return DE.tC(g,soundLoadOptions);default:return YC.tC(g,soundLoadOptions);}}static var rF=new bC(mp3:true,mp4:true,ogg:true,wav:true); get length; play([ loop=false, soundTransform]);}abstract class ZC extends LC{ set uD( g); stop();}class BE extends oB{var BM;BE(){if(sC.iD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  tC( h,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=oB.rF;var l=new BE();var g=new VB.Completer<oB>();var i=sC.FG(h,soundLoadOptions);var p=sC.iD;if(i.length==0){return YC.tC(h,soundLoadOptions);}q(m){p.decodeAudioData(m.response,( o){l.BM=o;g.complete(l);},(n){if(soundLoadOptions.ignoreErrors){YC.tC(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to decode audio."));}});}k(n){if(i.length>0){QB.HttpRequest.request(i.removeAt(0),responseType:'arraybuffer').then(q).catchError(k);}else{if(soundLoadOptions.ignoreErrors){YC.tC(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to load audio."));}}}k(null);return g.future;} get length{return BM.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new fB();return new PK(this,loop,soundTransform);}}class yG{var OD;var qD;var height;var leading;var width;var x;yG(this.x,this.width,this.height,this.OD,this.qD,this.leading);}class CE{var font;var size;var color;var bold;var italic;var underline;var align;var leftMargin;var rightMargin;var indent;var leading;var letterSpacing=0;var hK=0;var iK=false;var tK=false;CE(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.leftMargin: 0,this.rightMargin: 0,this.indent: 0,this.leading: 0});}class SK extends ZC{var xL;var SM;SK( i, h, g){xL=h;SM=g;}set uD( g){SM=g;} stop(){}}abstract class AC{BB( g); XB( g, h, i){BB(g);return false;}WC( g){}}class pB{static const  IE="auto";static const  LE="arrow";static const  ME="button";static const  XH="hand";static const  YH="ibeam";static const  bH="wait";}class bC{var mp3;var mp4;var ogg;var wav;var ignoreErrors;bC({this.mp3: false,this.mp4: false,this.ogg: false,this.wav: false,this.ignoreErrors: true});}class YC extends oB{YC(){}static  tC( g,[ soundLoadOptions=null]){return new VB.Future<oB>.of(()=>new YC());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new fB();}return new SK(this,loop,soundTransform);}}class QF{var KM;QF(){KM=new Map<String,cD>();} jN( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(KM.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");KM[i]=g;} aO( i, g){var h="${i}.${g}";if(KM.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return KM[h];} uB( i, h,[ bitmapDataLoadOptions=null]){var g=new cD("BitmapData",i,h);g.eO(DB.tC(h,bitmapDataLoadOptions));jN(g);} KB( i, h,[ soundFileSupport=null]){var g=new cD("Sound",i,h);g.eO(oB.tC(h,soundFileSupport));jN(g);} nE( j, h, i){var g=new cD("TextureAtlas",j,h);g.eO(BC.tC(h,i));jN(g);} EJ( i, h){var g=new cD("FlumpLibrary",i,h);g.eO(FC.tC(h));jN(g);} load(){var h=this.jJ.map((i)=>i.ZM);return VB.Future.wait(h).then((j){var g=this.MJ;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get jJ{return KM.values.where((g)=>g.SD==null).toList();} get MJ{return KM.values.where((g)=>g.error!=null).toList();} SC( g){return aO("BitmapData",g).SD;} RG( g){return aO("Sound",g).SD;} sE( g){return aO("TextureAtlas",g).SD;} UJ( g){return aO("FlumpLibrary",g).SD;}}class cD{var qL;var FM;var QM;var ZM;var lM;var qM;cD( g, h, i){qL=g;FM=h;QM=i;lM=null;qM=null;} get kind=>qL; get name=>FM; get SD=>qM; get error=>lM;eO( i){ZM=i.then((g){qM=g;lM=null;},onError:( h){qM=null;lM=h.error;});}}class BC{final  yL=new List<TF>();var iM;static  tC( n, w){var k=new VB.Completer<BC>();var g=new BC();switch (w){case KD.EH:case KD.gD:QB.HttpRequest.getString(n).then((t){var o=nG.parse(t);var h=o["frames"];var p=o["meta"];var JB=EG(n,p["image"]);if(h is List){for(var q in h){var j=q as Map;var i=j["filename"] as String;var l=CG(i);var m=new TF.FL(g,l,j);g.yL.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=CG(i);var m=new TF.FL(g,l,j);g.yL.add(m);}}DB.tC(JB).then(( EB){g.iM=EB;k.complete(g);}).catchError((v){k.completeError(new StateError("Failed to load image."));});}).catchError((v){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} SC( h){for(int g=0;g<yL.length;g++ )if(yL[g].name==h)return new DB.KL(yL[g]);throw new ArgumentError("TextureAtlasFrame not found: '${h}'");} SJ( i){var h=new List<DB>();for(int g=0;g<yL.length;g++ )if(yL[g].name.startsWith(i))h.add(new DB.KL(yL[g]));return h;} get PJ{return yL.map((g)=>g.name).toList(growable:false);}}class KD{static const  EH="json";static const  gD="jsonarray";}class TF{final  uL;final  FM;final  cM;final  oM;final  BN;final  KN;final  TN;final  aN;final  fN;final  hN;final  mN;TF.FL( i, h, g):uL=i,FM=h,cM=EI(g["rotated"]),oM=QC(g["sourceSize"]["w"]),BN=QC(g["sourceSize"]["h"]),KN=QC(g["spriteSourceSize"]["x"]),TN=QC(g["spriteSourceSize"]["y"]),aN=QC(g["frame"]["x"]),fN=QC(g["frame"]["y"]),hN=QC(g["frame"]["w"]),mN=QC(g["frame"]["h"]); get rJ=>uL; get name=>FM; get pJ=>cM; get QJ=>aN; get RJ=>fN; get QG=>hN; get PG=>mN; get offsetX=>KN; get offsetY=>TN; get iJ=>oM; get hJ=>BN;}class zG<LD>{final  oL=new List<LD>();final  TM;var eM=0;zG( g()):TM=g; dG(){if(eM==0){return TM();}else{eM-- ;return oL[eM];}}eG( g){if(eM==oL.length){oL.add(g);}else{oL[eM]=g;}eM++ ;}reset(){oL.clear();eM=0;}}class JD{static final  wH=new QB.CanvasElement(width:16,height:16);static final  AI=wH.context2d;final  gO=new List<AC>();var kO=new AB.BL();var qO=true;clear(){gO.clear();qO=true;}BP( g){gO.add(g);qO=true;}beginPath()=>BP(new YK());closePath()=>BP(new ZK());moveTo( h, g)=>BP(new aK(h,g));lineTo( h, g)=>BP(new bK(h,g));arc( l, g, j, i, h, k)=>BP(new cK(l,g,j,i,h,k));rect( i, g, h, j)=>BP(new dK(i,g,h,j));lG( g,[ width=1.0, joints=wG.IH, caps=vG.IH])=>BP(new eK(PE(g),width,joints,caps));NJ( g)=>BP(new fK(PE(g))); MO( i){var h=new PC(i);for(int g=0;g<gO.length;g++ ){gO[g].WC(h);}return h.XJ();} mO( h, i){if(qO){qO=false;kO=MO(new FB.GL());}if(kO.contains(h,i)){var j=JD.AI;j.beginPath();for(int g=0;g<gO.length;g++ ){if(gO[g].XB(j,h,i)){return true;}}}return false;} BB( i){var g=i.context;g.save();g.beginPath();for(int h=0;h<gO.length;h++ ){gO[h].BB(g);}g.restore();}}class aC{static const  JE="center";static const  LH="end";static const  SH="justify";static const  lF="right";}class vG{static const  IH="round";}class bD extends ZC{var RM;var DM;var xL;var SM;bD( g, i, h){RM=g;xL=i;SM=h;DM=g.CO(this);DM.loop=xL;this.uD=h;DM.play();} set uD( g){SM=g;if(DM!=null)DM.volume=(SM!=null)?SM.volume:1;} stop(){if(DM!=null){if(DM.ended==false)DM.pause();RM.NP(this);DM=null;}}}class dC{static var XF=pB.IE;static var JH=false;static var dF=null;static var WH=null;static var ZH=null;static var gH=new VB.StreamController<String>();static var nH=gH.stream.asBroadcastStream();static  BG( i){var h=i;var g="auto";if(XF!=pB.IE){h=XF;}switch (h){case pB.IE:g="auto";break;case pB.LE:g="default";break;case pB.ME:g="pointer";break;case pB.XH:g="move";break;case pB.YH:g="text";break;case pB.bH:g="wait";break;}if(JH){g="none";}return g;}}class sG{static const  DH="dynamic";}class DC{static const  hD=0xFF000000;static const  pH=0xFF0000FF;static const  MI=0xFFA9A9A9;static const  YI=0xFF008000;static const  GG=0xFFFF0000;static const  vI=0xFFFFFFFF;}class tG{tG();}class eD extends u{var bitmapData;var pixelSnapping;var gC;eD([this.bitmapData=null,this.pixelSnapping="auto"]){gC=null;} kB( h,[ returnRectangle]){var g=(bitmapData!=null)?bitmapData.width:0;var i=(bitmapData!=null)?bitmapData.height:0;return fE(h,g,i,returnRectangle);} XB( g, h){if(bitmapData!=null&&g>=0.0&&h>=0.0&&g<bitmapData.width&&h<bitmapData.height)return this;return null;} BB( g){if(bitmapData==null)return;if(gC==null){bitmapData.BB(g);}else{bitmapData.hG(g,gC);}}}class sC{static var lH=FI();static var iD=RI();static var sF=TI();static  FI(){var h=(iD!=null)?"WebAudioApi":"AudioElement";var g=QB.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(sF.length==0)h="Mock";print("StageXL: supported audio engine is: ${h}");return h;}static  RI(){if(PF.AudioContext.supported)return new PF.AudioContext();return null;}static  TI(){var g=new List<String>();var h=new QB.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/mp4",""))!=-1)g.add("mp4");if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("StageXL: supported audio types are: ${g}");return g;}static  FG( i, h){var l=new RegExp(r"(mp3|mp4|ogg|wav)$",multiLine:false,caseSensitive:true);var g=sF.toList();var k=l.firstMatch(i);var j=new List<String>();if(k==null){throw new ArgumentError("Unsupported file extension.");}if(g.length==0){throw new UnsupportedError("This browser supports no known audio codec.");}if(!h.mp3)g.remove("mp3");if(!h.mp4)g.remove("mp4");if(!h.ogg)g.remove("ogg");if(!h.wav)g.remove("wav");var m=k.group(1);if(g.contains(m)){j.add(i);g.remove(m);}for(var n in g){j.add(i.replaceAll(l,n));}return j;}}class TB extends IB{static const  aF="touchBegin";static const  cF="touchEnd";static const  fF="touchCancel";static const  mF="touchMove";static const  fH="touchOver";static const  jH="touchOut";var jO;var lO;var oO,pO;var rO,tO;var sN;var FO;var tN;var wN;var zO;var CP;var DP;TB( g,[ bubbles=false]):super(g,bubbles){YO(g,bubbles);} YO( g,[ bubbles=false]){super.YO(g,bubbles);jO=0;lO=false;oO=pO=0;rO=tO=0;sN=false;FO=false;tN=false;wN=false;zO=1.00;CP=0;DP=0;}set WP( g){oO=g.x;pO=g.y;}set aP( g){rO=g.x;tO=g.y;} get wD=>jO; get altKey=>sN; get ctrlKey=>tN; get shiftKey=>wN;}final  HE=new Map<String,uF>();class RF{static const  vF="none";static const  TH="touchPoint";}class qC{static const  BH=0;static const  HH=1;static const  lF=2;static const  UH=3;static const  hF=4;}class xG{static const  KH="pixel";}final  fD=new zG<List<u>>(()=>new List<u>());class qG{static const  vF="none";}class uG extends LB implements gB{var WM;var gM;var pM;var AN;var HN;var xL;var RN;var YN;var gC;uG( g,[ frameRate=30, loop=true]){WM=g;gM=frameRate;pM=0;AN=null;HN=false;xL=loop;RN=new IB(IB.zF);YN=new IB(IB.GI);gC=null;}static const  LI=const hB<IB>(IB.zF); get onProgress=>uG.LI.forTarget(this); get EF=>WM.length; set loop( g){xL=g;} play(){HN=true;AN=null;} stop(){HN=false;AN=null;} rB( j){if(HN==false)return true;if(AN==null){AN=0.0;hO(RN,this,this,CC.eC);}else{AN+= j;var i=1.0/gM;while (HN&&AN>=i){var h=pM;var g=xL?(h+1)%EF:bB.min(h+1,EF-1);pM=g;AN-= i;if(h!=g){hO(RN,this,this,CC.eC);if(pM!=g)return true;}if(h!=g&&g==EF-1&&xL==false){hO(YN,this,this,CC.eC);if(pM!=g)return true;}}}return true;} kB( h,[ returnRectangle]){var g=WM[pM];return fE(h,g.width,g.height,returnRectangle);} XB( g, h){var i=WM[pM];if(g>=0&&h>=0&&g<i.width&&h<i.height)return this;return null;} BB( g){var h=WM[pM];if(gC==null)h.BB(g);else h.hG(g,gC);}}abstract class WB extends LB{final  aM=new List<u>();var xM=true;var IN=true; get xE=>aM.length; HB( g){if(g.parent==this){var h=aM.indexOf(g);aM.removeAt(h);aM.add(g);}else{mE(g,aM.length);}} mE( g, h){if(h<0||h>aM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){aM.removeAt(aM.indexOf(g));if(h>aM.length)h-- ;aM.insert(h,g);}else{g.zE();g.cP(this);aM.insert(h,g);g.dispatchEvent(new IB(IB.GH,true));if(this.nC!=null)kP(g,new IB(IB.PH));}} gG( h){var g=aM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");kJ(g);} kJ( g){if(g<0||g>=aM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=aM[g];h.dispatchEvent(new IB(IB.aH,true));if(this.nC!=null)kP(h,new IB(IB.eH));h.cP(null);aM.removeAt(g);} TJ( g){if(g<0||g>=aM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return aM[g];} qJ( g){aM.sort(g);} contains( g){for(;g!=null;g=g.uO)if(g==this)return true;return false;} kB( n,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new AB.BL();if(aM.length==0)return super.kB(n,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var o=aM.length;for(int l=0;l<aM.length;l++ ){var m=aM[l];vO.JG(m.SP,n);var g=m.kB(vO,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} XB( o, p){var l=null;for(int j=aM.length-1;j>=0;j-- ){var i=aM[j];if(i.visible){var g=i.SP;var m=o-g.ZB;var k=p-g.aB;var q=(g.d*m-g.c*k)/g.hC;var n=(g.a*k-g.b*m)/g.hC;var h=i.XB(q,n);if(h!=null){if(h is LB)if(h.ZG)return xM?h:this;l=this;}}}return l;} BB( i){for(int h=0;h<aM.length;h++ ){var g=aM[h];if(!g.VO&&g.visible)i.iG(g);}}YQ( g, i){i.add(g);if(g is WB){var k=g as WB;var j=k.aM;for(int h=0;h<j.length;h++ ){YQ(j[h],i);}}}kP( i, j){var g=fD.dG() as List<u>;YQ(i,g);for(int h=0;h<g.length;h++ ){g[h].dispatchEvent(j);}g.clear();fD.eG(g);}}abstract class LB extends u{var KJ=false;var ZG=true;var zK=true;var tabIndex=0;static const  cH=const hB<CB>(CB.oF);static const  oH=const hB<CB>(CB.pF);static const  uH=const hB<CB>(CB.nF);static const  zH=const hB<CB>(CB.eF);static const  JI=const hB<CB>(CB.kF);static const  VI=const hB<CB>(CB.qF); get onMouseOut=>LB.cH.forTarget(this); get onMouseOver=>LB.oH.forTarget(this); get onMouseMove=>LB.uH.forTarget(this); get onMouseDown=>LB.zH.forTarget(this); get onMouseUp=>LB.JI.forTarget(this); get onMouseWheel=>LB.VI.forTarget(this);static const  gI=const hB<TB>(TB.mF);static const  jI=const hB<TB>(TB.cF);static const  lI=const hB<TB>(TB.fF); get onTouchMove=>LB.gI.forTarget(this); get onTouchEnd=>LB.jI.forTarget(this); get onTouchCancel=>LB.lI.forTarget(this);static const  qI=const hB<EC>(EC.bF);static const  sI=const hB<EC>(EC.KE); get onKeyUp=>LB.qI.forTarget(this); get onKeyDown=>LB.sI.forTarget(this);}class OK extends qB{var color;var alpha;var blurX;var blurY;var strength;var inner;var knockout;var hideObject;OK([this.color=0,this.alpha=1.0,this.blurX=4,this.blurY=4,this.strength=2.0,this.inner=false,this.knockout=false,this.hideObject=false]){if(blurX<1||blurY<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(blurX>128||blurY>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} clone(){return new OK(color,alpha,blurX,blurY,strength,inner,knockout,hideObject);} apply( n, k, VD, JB){if(n==VD&&!hideObject){var wB=new DB(k.width,k.height);wB.KG(n,k,new GB.BL());n=wB;k=new AB(0,0,n.width,n.height);}var xB=n.JP();var IF=xB.getImageData(k.x,k.y,k.width,k.height);var JF=IF.data;var p=k.width;var eB=k.height;var zB=blurX*blurX;var OC=blurY*blurY;var KF=(1<<22)~/zB;var LF=(1<<22)~/OC;var o=blurX;var WD=blurX*2;var PB=blurY;var pC=blurY*2;var UB=p+WD;var NB=eB+pC;var MF=p*4;var nB=UB*4;var MB=fC?3:0;var q=VD.JP();var KC=q.createImageData(UB,NB);var g=KC.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){var m=0,v=OC>>1;var t=j*4+MB;var w=(j+o)*4+MB;for(int i=0;i<NB;i++ ){g[w]=(v*LF)>>22;w+= nB;if(i>=pC){m-= 2*l[i&1023]-l[(i-PB)&1023];}else if(i>=PB){m-= 2*l[i&1023];}var EB=(i<eB)?JF[t]:0;l[(i+PB)&1023]=EB;v+= m+= EB;t+= MF;}}for(int i=0;i<NB;i++ ){var m=0,v=zB>>1;var t=i*nB+o*4+MB;var w=i*nB+MB;for(int j=0;j<UB;j++ ){g[w]=(v*KF)>>22;w+= 4;if(j>=WD){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}var EB=(j<p)?g[t]:0;l[(j+o)&1023]=EB;v+= m+= EB;t+= 4;}}var JC=(alpha*256).toInt();var oC=(color>>16)&0xFF;var XD=(color>>8)&0xFF;var yB=(color>>0)&0xFF;if(fC){for(var h=0;h<=g.length-4;h+= 4){g[h+0]=oC;g[h+1]=XD;g[h+2]=yB;g[h+3]=(g[h+3]*JC)>>8;}}else{for(var h=0;h<=g.length-4;h+= 4){g[h+0]=(g[h+0]*JC)>>8;g[h+1]=yB;g[h+2]=XD;g[h+3]=oC;}}var YD=JB.x;var NC=JB.y;var ZD=JB.x-o;var aD=JB.y-PB;var NF=new AB(YD,NC,p,eB);var OF=new AB(ZD,aD,UB,NB);var YB=NF.union(OF);q.setTransform(1,0,0,1,0,0);q.clearRect(YB.x,YB.y,YB.width,YB.height);q.putImageData(KC,ZD,aD);if(this.hideObject==false)q.drawImage(xB.canvas,YD,NC);}}class QK extends qB{var distance;var angle;var color;var alpha;var blurX;var blurY;var strength;var inner;var knockout;var hideObject;QK([this.distance=4.0,this.angle=bB.PI/4,this.color=0,this.alpha=1.0,this.blurX=4,this.blurY=4,this.strength=1.0,this.inner=false,this.knockout=false,this.hideObject=false]){if(blurX<1||blurY<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(blurX>128||blurY>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} clone(){return new QK(distance,angle,color,alpha,blurX,blurY,strength,inner,knockout,hideObject);} apply( n, k, VD, JB){if(n==VD&&!hideObject){var wB=new DB(k.width,k.height);wB.KG(n,k,new GB.BL());n=wB;k=new AB(0,0,n.width,n.height);}var xB=n.JP();var IF=xB.getImageData(k.x,k.y,k.width,k.height);var JF=IF.data;var p=k.width;var eB=k.height;var zB=blurX*blurX;var OC=blurY*blurY;var KF=(1<<22)~/zB;var LF=(1<<22)~/OC;var o=blurX;var WD=blurX*2;var PB=blurY;var pC=blurY*2;var UB=p+WD;var NB=eB+pC;var MF=p*4;var nB=UB*4;var MB=fC?3:0;var q=VD.JP();var KC=q.createImageData(UB,NB);var g=KC.data;var l=new List<int>(1024);for(int j=0;j<p;j++ ){var m=0,v=OC>>1;var t=j*4+MB;var w=(j+o)*4+MB;for(int i=0;i<NB;i++ ){g[w]=(v*LF)>>22;w+= nB;if(i>=pC){m-= 2*l[i&1023]-l[(i-PB)&1023];}else if(i>=PB){m-= 2*l[i&1023];}var EB=(i<eB)?JF[t]:0;l[(i+PB)&1023]=EB;v+= m+= EB;t+= MF;}}for(int i=0;i<NB;i++ ){var m=0,v=zB>>1;var t=i*nB+o*4+MB;var w=i*nB+MB;for(int j=0;j<UB;j++ ){g[w]=(v*KF)>>22;w+= 4;if(j>=WD){m-= 2*l[j&1023]-l[(j-o)&1023];}else if(j>=o){m-= 2*l[j&1023];}var EB=(j<p)?g[t]:0;l[(j+o)&1023]=EB;v+= m+= EB;t+= 4;}}var JC=(alpha*256).toInt();var oC=(color>>16)&0xFF;var XD=(color>>8)&0xFF;var yB=(color>>0)&0xFF;if(fC){for(var h=0;h<=g.length-4;h+= 4){g[h+0]=oC;g[h+1]=XD;g[h+2]=yB;g[h+3]=(g[h+3]*JC)>>8;}}else{for(var h=0;h<=g.length-4;h+= 4){g[h+0]=(g[h+0]*JC)>>8;g[h+1]=yB;g[h+2]=XD;g[h+3]=oC;}}var YD=JB.x;var NC=JB.y;var ZD=JB.x-o+(this.distance*bB.cos(this.angle)).round().toInt();var aD=JB.y-PB+(this.distance*bB.sin(this.angle)).round().toInt();var NF=new AB(YD,NC,p,eB);var OF=new AB(ZD,aD,UB,NB);var YB=NF.union(OF);q.setTransform(1,0,0,1,0,0);q.clearRect(YB.x,YB.y,YB.width,YB.height);q.putImageData(KC,ZD,aD);if(this.hideObject==false)q.drawImage(xB.canvas,YD,NC);}}class NK extends qB{final  LM;NK( h):LM=new List<num>(20){if(h.length!=20)throw new ArgumentError("The supplied matrix needs to be a 4 x 5 matrix.");for(int g=0;g<h.length;g++ )LM[g]=h[g];}NK.HL():LM=[0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0,0,0,1,0];NK.IL():LM=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]; clone(){return new NK(LM);} apply( NC, m, OC, JC){var q=NC.JP().getImageData(m.x,m.y,m.width,m.height);var h=q.data;var wB=(LM[00]*65536).toInt();var PB=(LM[01]*65536).toInt();var KC=(LM[02]*65536).toInt();var p=(LM[03]*65536).toInt();var xB=(LM[04]*65536).toInt();var zB=(LM[05]*65536).toInt();var UB=(LM[06]*65536).toInt();var nB=(LM[07]*65536).toInt();var w=(LM[08]*65536).toInt();var n=(LM[09]*65536).toInt();var t=(LM[10]*65536).toInt();var v=(LM[11]*65536).toInt();var eB=(LM[12]*65536).toInt();var yB=(LM[13]*65536).toInt();var JB=(LM[14]*65536).toInt();var EB=(LM[15]*65536).toInt();var YB=(LM[16]*65536).toInt();var MB=(LM[17]*65536).toInt();var o=(LM[18]*65536).toInt();var NB=(LM[19]*65536).toInt();if(fC){for(int g=0;g<=h.length-4;g+= 4){var k=h[g+0];var l=h[g+1];var j=h[g+2];var i=h[g+3];h[g+0]=((wB*k)+(PB*l)+(KC*j)+(p*i)+xB)>>16;h[g+1]=((zB*k)+(UB*l)+(nB*j)+(w*i)+n)>>16;h[g+2]=((t*k)+(v*l)+(eB*j)+(yB*i)+JB)>>16;h[g+3]=((EB*k)+(YB*l)+(MB*j)+(o*i)+NB)>>16;}}else{for(int g=0;g<=h.length-4;g+= 4){var i=h[g+0];var j=h[g+1];var l=h[g+2];var k=h[g+3];h[g+0]=((EB*k)+(YB*l)+(MB*j)+(o*i)+NB)>>16;h[g+1]=((t*k)+(v*l)+(eB*j)+(yB*i)+JB)>>16;h[g+2]=((zB*k)+(UB*l)+(nB*j)+(w*i)+n)>>16;h[g+3]=((wB*k)+(PB*l)+(KC*j)+(p*i)+xB)>>16;}}OC.JP().putImageData(q,JC.x,JC.y);}}class MK extends qB{var blurX;var blurY;MK([this.blurX=4,this.blurY=4]){if(blurX<1||blurY<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(blurX>128||blurY>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} clone(){return new MK(blurX,blurY);} apply( oC, q, NC, wB){var OC=oC.JP();var MB=OC.getImageData(q.x,q.y,q.width,q.height);var xB=MB.data;var w=MB.width;var eB=MB.height;var YB=blurX*blurX;var yB=blurY*blurY;var JC=(1<<22)~/YB;var pC=(1<<22)~/yB;var l=blurX;var zB=blurX*2;var v=blurY;var nB=blurY*2;var NB=w+zB;var EB=eB+nB;var KC=w*4;var JB=NB*4;var UB=NC.JP();var PB=UB.createImageData(NB,EB);var t=PB.data;var j=new List<int>(1024);fI(xB);for(int i=0;i<4;i++ ){for(int h=0;h<w;h++ ){var k=0,m=yB>>1;var n=h*4+i;var o=(h+l)*4+i;for(int g=0;g<EB;g++ ){t[o]=(m*pC)>>22;o+= JB;if(g>=nB){k-= 2*j[g&1023]-j[(g-v)&1023];}else if(g>=v){k-= 2*j[g&1023];}var p=(g<eB)?xB[n]:0;j[(g+v)&1023]=p;m+= k+= p;n+= KC;}}}for(int i=0;i<4;i++ ){for(int g=0;g<EB;g++ ){var k=0,m=YB>>1;var n=g*JB+l*4+i;var o=g*JB+i;for(int h=0;h<NB;h++ ){t[o]=(m*JC)>>22;o+= 4;if(h>=zB){k-= 2*j[h&1023]-j[(h-l)&1023];}else if(h>=l){k-= 2*j[h&1023];}var p=(h<w)?t[n]:0;j[(h+l)&1023]=p;m+= k+= p;n+= 4;}}}mI(t);UB.putImageData(PB,wB.x-l,wB.y-v);}}abstract class qB{ clone(); apply( h, i, j, g);}class SF extends IB{static const  NH="textInput";var CM="";SF( g,[ bubbles=false]):super(g,bubbles); get text=>CM;}class dD<LD extends IB>{final  wL=new List<rC>();var mM=0;static var jF=new dD<HD>(); uN( g){for(int h=0;h<mM;h++ ){if(wL[h]==g)return;}if(mM==wL.length){wL.add(g);}else{wL[mM]=g;}mM++ ;} sO( j){j.wO=CC.eC;j.yO=false;j.EP=false;var k=mM;var i=0;for(int g=0;g<k;g++ ){var h=wL[g];if(h==null)continue;if(h.eN==0){wL[g]=null;continue;}j.UM=h.UM;j.IP=h.UM;h.sO(j);if(i!=g){wL[i]=h;wL[g]=null;}i++ ;}if(i!=k){for(int g=k;g<mM;g++ ){wL[i++ ]=wL[g];wL[g]=null;}mM=i;}}}class EC extends IB{static const  KE="keyDown";static const  bF="keyUp";var sN;var tN;var wN;var yN;var FO;var JO;var NO;var PO;EC( g,[ bubbles=false]):super(g,bubbles){YO(g,bubbles);} YO( g,[ bubbles=false]){super.YO(g,bubbles);sN=false;tN=false;wN=false;yN=false;FO=false;JO=0;NO=0;PO=0;} get altKey=>sN; get ctrlKey=>tN; get shiftKey=>wN; get charCode=>JO; get keyCode=>NO; get keyLocation=>PO;}class VF extends LB{VF();}class SB{final  zL;final  VM=new List<FB>(100);final  wM=new List<double>(100);var LN=0;var OM=0.0;var ZN=0.0;SB.DL( j,[ matrix]):zL=j{for(int h=0;h<100;h++ ){VM[h]=new FB.GL();wM[h]=1.0;}if(matrix!=null)VM[0].pD(matrix);var g=VM[0];var i=wM[0];zL.setTransform(g.a,g.b,g.c,g.d,g.ZB,g.aB);zL.globalAlpha=i;} get context=>zL; get currentTime=>OM; reset([ matrix, currentTime, deltaTime]){if(matrix!=null)VM[0].pD(matrix);LN=0;OM=?currentTime?currentTime:0.0;ZN=?deltaTime?deltaTime:0.0;var g=VM[0];var h=wM[0];zL.setTransform(g.a,g.b,g.c,g.d,g.ZB,g.aB);zL.globalAlpha=h;zL.clearRect(0,0,zL.canvas.width,zL.canvas.height);} iG( i){var m=LN;var n=LN+1;var l=VM[m];var h=VM[n];var q=wM[m];var p=wM[n]=i.RO*q;var g=l;var k=i.ZO;var o=i.cO;var j=i.nO;LN=n;h.JG(i.SP,l);if(k!=null||j!=null){zL.save();}if(k!=null){if(k.VC==null){g=h;}else if(identical(k.VC,i)){g=h;}else if(identical(k.VC,i.parent)){g=l;}else{g=k.VC.FF(i);if(g==null)g=NE;else g.concat(h);}k.BB(this,g);}if(j!=null){if(j.VC==null){g=h;}else if(identical(j.VC,i)){g=h;}else if(identical(j.VC,i.parent)){g=l;}else{g=j.VC.FF(i);if(g==null)g=NE;else g.concat(h);}j.BB(this,g);}zL.setTransform(h.a,h.b,h.c,h.d,h.ZB,h.aB);zL.globalAlpha=p;if(o!=null){o.BB(this);}else{i.BB(this);}if(k!=null||j!=null){zL.restore();}LN=m;}}class CB extends IB{static const  ZF="click";static const  OH="doubleClick";static const  eF="mouseDown";static const  kF="mouseUp";static const  nF="mouseMove";static const  oF="mouseOut";static const  pF="mouseOver";static const  qF="mouseWheel";static const  tF="middleClick";static const  tH="middleMouseDown";static const  yH="middleMouseUp";static const  wF="rightClick";static const  DI="rightMouseDown";static const  HI="rightMouseUp";var oO,pO;var rO,tO;var LP;var sN;var FO;var tN;var wN;var PP;var QP;var RP;CB( g,[ bubbles=false]):super(g,bubbles){YO(g,bubbles);} YO( g,[ bubbles=false]){super.YO(g,bubbles);oO=pO=0;rO=tO=0;LP=false;sN=false;FO=false;tN=false;wN=false;PP=0;QP=0;RP=0;}set WP( g){oO=g.x;pO=g.y;}set aP( g){rO=g.x;tO=g.y;} get MC=>LP; get altKey=>sN; get ctrlKey=>tN; get shiftKey=>wN; get PD=>PP; get deltaX=>QP; get deltaY=>RP;}class HD extends IB{var rL;HD( g):super(IB.OE,false){rL=g;} get bG=>rL; get nD=>false;}class hB<LD extends IB>{final  IM;const hB(this.IM); forTarget( g,{ useCapture: false}){return g.VN(IM,useCapture);}}class UF implements gB{final  EM;var OM=0.0;var dM=0.0;var nM=1;UF( g, h):EM=g{dM=bB.max(h,0.0001);} rB( h){var g=OM+h;while (g>=dM&&nM>0){OM=dM;nM-- ;EM();g-= dM;}OM=g;return (nM>0);} get currentTime=>OM;}abstract class gB{ rB( g);}class ED implements gB{final  JM=new List<gB>();var jM=0;var uM=0.0; add( g){if(g==null)return;if(this.contains(g))return;if(jM==JM.length){JM.add(g);}else{JM[jM]=g;}jM++ ;} remove( h){if(h==null)return;for(int g=0;g<jM;g++ ){if(identical(JM[g],h)){JM[g]=null;break;}}} contains( h){if(h==null)return false;for(int g=0;g<jM;g++ ){if(identical(JM[g],h)){return true;}}return false;} mJ( i){if(i==null)return;for(int g=0;g<jM;g++ ){var h=JM[g];if(h!=null&&h is jD){if(identical(h.JJ,i)){JM[g]=null;}}}} GF( h, i,[ transitionFunction]){var g=new jD(h,i,transitionFunction);add(g);return g;} MG( h, i){var g=new UF(h,i);add(g);return g;} rB( k){uM+= k;var j=jM;var h=0;for(int g=0;g<j;g++ ){var i=JM[g];if(i==null)continue;if(i.rB(k)==false){JM[g]=null;continue;}if(h!=g){JM[h]=i;JM[g]=null;}h++ ;}if(h!=j){for(int g=j;g<jM;g++ ){JM[h++ ]=JM[g];JM[g]=null;}jM=h;}return true;}}class rC<LD extends IB> extends VB.Stream<LD>{final  UM;final  IM;final  rM;final  MN=new List<FH>();var eN=0;rC(this.UM,this.IM,this.rM); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new FH<LD>(this,h);if(eN==MN.length){MN.add(g);}else{MN[eN]=g;}eN++ ;if(IM==IB.OE&&rM==false)dD.jF.uN(this);return g;} SO( h){for(int g=0;g<eN;g++ ){if(identical(MN[g],h)){MN[g]=null;break;}}} get TP{for(var g=0;g<eN;g++ )if(MN[g]!=null)return true;return false;} sO( k){var j=eN;var h=0;for(int g=0;g<j;g++ ){var i=MN[g];if(i==null)continue;i.ON(k);if(h!=g){MN[h]=i;MN[g]=null;}h++ ;}if(h!=j){for(int g=j;g<eN;g++ ){MN[h++ ]=MN[g];MN[g]=null;}eN=h;}}}class WF{final  GF;WF(this.GF);call( h, g){zM(h).vB(g);} get x=>zM("x"); get y=>zM("y"); get cB=>zM("scaleX"); get dB=>zM("scaleY"); get skewX=>zM("skewX"); get skewY=>zM("skewY"); get mB=>zM("pivotX"); get sB=>zM("pivotY"); get UC=>zM("rotation"); get alpha=>zM("alpha"); zM( h){var g=new jB(h);this.GF.zM(g);return g;}}class LC{var wL;var bM;dispatchEvent( g){hO(g,this,this,CC.eC);} MP( h, j, i){if(j&&bM!=null){var g=bM[h];if(g!=null&&g.TP)return true;}if(i&&wL!=null){var g=wL[h];if(g!=null&&g.TP)return true;}return false;} VN( h, g){if(g){if(bM==null)bM=new Map<String,rC>();}else{if(wL==null)wL=new Map<String,rC>();}var i=g?bM:wL;return i.putIfAbsent(h,(){return new rC(this,h,g);});}hO( g, k, l, j){var h=(j==CC.YF)?bM:wL;if(h==null)return;var i=h[g.type];if(i==null)return;g.UM=k;g.IP=l;g.wO=j;g.yO=false;g.EP=false;i.sO(g);}}class RK extends u{var vL=new JD(); get SG=>vL; kB( g,[ returnRectangle]){if(vL==null){return super.kB(g,returnRectangle);}else{return vL.MO(g);}} XB( g, h){if(vL==null){return null;}else{return vL.mO(g,h)?this:null;}} BB( g){if(vL!=null)vL.BB(g);}}class GB{var hL;var lL;GB( h, g):hL=h,lL=g;GB.BL():this(0,0); clone()=>new GB(hL,lL); toString()=>"Point [x=${hL}, y=${lL}]"; get x=>hL; get y=>lL; get length=>bB.sqrt(hL*hL+lL*lL);set x( g){hL=g;}set y( g){lL=g;} add( g){return new GB(hL+g.x,lL+g.y);} subtract( g){return new GB(hL-g.x,lL-g.y);}pD( g){hL=g.x;lL=g.y;} OG( g){return hL==g.x&&lL==g.y;}}class AB{var hL;var lL;var sL;var GM;AB( i, g, h, j):hL=i,lL=g,sL=h,GM=j;AB.BL():this(0,0,0,0); clone()=>new AB(hL,lL,sL,GM); toString()=>"Rectangle [x=${hL}, y=${lL}, width=${sL}, height=${GM}]"; get x=>hL; get y=>lL; get width=>sL; get height=>GM; get left=>hL; get top=>lL; get right=>hL+sL; get bottom=>lL+GM; get size=>new GB(sL,GM);set x( g){hL=g;}set y( g){lL=g;}set width( g){sL=g;}set height( g){GM=g;}set top( g){lL=g;} contains( g, h){return hL<=g&&lL<=h&&hL+sL>=g&&lL+GM>=h;} OG( g){return hL==g.x&&lL==g.y&&sL==g.width&&GM==g.height;} get isEmpty{return sL==0&&GM==0;}pD( g){hL=g.x;lL=g.y;sL=g.width;GM=g.height;} union( g){var i=bB.min(this.left,g.left);var h=bB.min(this.top,g.top);var j=bB.max(this.right,g.right);var k=bB.max(this.bottom,g.bottom);return new AB(i,h,j-i,k-h);} align(){var h=this.left.floor();var g=this.top.floor();var i=this.right.ceil();var j=this.bottom.ceil();return new AB(h,g,i-h,j-g);}}class rG{var x;var y;var fG;rG(this.x,this.y,this.fG);}class FB{var iL,jL,mL,nL,pL,tL;var HM;FB( h, i, g, j, k, l):iL=h.toDouble(),jL=i.toDouble(),mL=g.toDouble(),nL=j.toDouble(),pL=k.toDouble(),tL=l.toDouble(),HM=(h*j-i*g).toDouble();FB.GL():iL=1.0,jL=0.0,mL=0.0,nL=1.0,pL=0.0,tL=0.0,HM=1.0; clone(){return new FB(iL,jL,mL,nL,pL,tL);} IG(){var h=(nL/HM);var i=-(jL/HM);var g=-(mL/HM);var j=(iL/HM);var k=-(h*pL+g*tL);var l=-(i*pL+j*tL);return new FB(h,i,g,j,k,l);} get a=>iL; get b=>jL; get c=>mL; get d=>nL; get ZB=>pL; get aB=>tL; get hC=>HM; xD( h){var i=h.x.toDouble();var g=h.y.toDouble();return new GB(i*iL+g*mL+pL,i*jL+g*nL+tL);} fP( h){var i=h.x.toDouble();var g=h.y.toDouble();return new GB(i*iL+g*mL+pL,i*jL+g*nL+tL);} concat( g){var m=iL;var p=jL;var q=mL;var o=nL;var l=pL;var n=tL;var v=HM;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var w=g.ZB;var t=g.aB;var EB=g.hC;iL=(m*j+p*i).toDouble();jL=(m*k+p*h).toDouble();mL=(q*j+o*i).toDouble();nL=(q*k+o*h).toDouble();pL=(l*j+n*i+w).toDouble();tL=(l*k+n*h+t).toDouble();HM=(v*EB).toDouble();} aJ(){iL=1.0;jL=0.0;mL=0.0;nL=1.0;pL=0.0;tL=0.0;HM=1.0;} vE(){var j=iL;var m=jL;var l=mL;var k=nL;var h=pL;var i=tL;var g=HM;iL=(k/g).toDouble();jL=-(m/g).toDouble();mL=-(l/g).toDouble();nL=(j/g).toDouble();pL=-(iL*h+mL*i).toDouble();tL=-(jL*h+nL*i).toDouble();HM=(1.0/g).toDouble();} rotate( i){var g=bB.cos(i);var h=bB.sin(i);var j=iL;var n=jL;var m=mL;var l=nL;var k=pL;var o=tL;iL=(j*g-n*h).toDouble();jL=(j*h+n*g).toDouble();mL=(m*g-l*h).toDouble();nL=(m*h+l*g).toDouble();pL=(k*g-o*h).toDouble();tL=(k*h+o*g).toDouble();} TD( h, i, g, k, j, l){iL=h.toDouble();jL=i.toDouble();mL=g.toDouble();nL=k.toDouble();pL=j.toDouble();tL=l.toDouble();HM=(iL*nL-jL*mL).toDouble();} pD( g){iL=g.a.toDouble();jL=g.b.toDouble();mL=g.c.toDouble();nL=g.d.toDouble();pL=g.ZB.toDouble();tL=g.aB.toDouble();HM=g.hC.toDouble();} JG( h, g){var n=h.a;var q=h.b;var t=h.c;var p=h.d;var m=h.ZB;var o=h.aB;var w=h.hC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var EB=g.ZB;var v=g.aB;var JB=g.hC;iL=(n*k+q*j).toDouble();jL=(n*l+q*i).toDouble();mL=(t*k+p*j).toDouble();nL=(t*l+p*i).toDouble();pL=(m*k+o*j+EB).toDouble();tL=(m*l+o*i+v).toDouble();HM=(w*JB).toDouble();}}class IB{static const  GH="added";static const  PH="addedToStage";static const  OE="enterFrame";static const  aH="removed";static const  eH="removedFromStage";static const  kH="resize";static const  GI="complete";static const  zF="progress";var cN;var GP;var wO;var UM;var IP;var yO;var EP;IB( g,[ bubbles=false]){YO(g,bubbles);} YO( g,[ bubbles=false]){cN=g;GP=bubbles;wO=CC.eC;UM=null;IP=null;yO=false;EP=false;} get vD=>yO; get type=>cN; get bubbles=>GP; get nD=>true; get target=>UM;}class EE{var kL;var AM;var MM;var fM;var vM;EE(){kL=new ED();AM=new List<vC>();MM=double.NAN;fM=dD.jF;vM=new HD(0);QB.window.requestAnimationFrame(DO);} get wE=>kL; DO( g){QB.window.requestAnimationFrame(DO);if(MM.isNaN)MM=g;if(MM>g)MM=g;var k=g-MM;var h=k/1000.0;var l=g/1000.0;if(k>=1){MM=g;vM.rL=h;fM.sO(vM);kL.rB(h);for(int i=0;i<AM.length;i++ ){var j=AM[i];j.wE.rB(h);j.VG(l,h);}}} FJ( g){if(g.AF!=null){g.AF.lJ(g);}AM.add(g);g.hP=this;} lJ( g){if(g.AF==this){AM.remove(g);g.hP=null;}}}class fB{var volume;var pan;var uK=1;var vK=0;var yK=1;var xK=0;fB([this.volume=1,this.pan=0]);}class FE{var png;var jpg;var webp;FE({this.png: true,this.jpg: true,this.webp: false});}class iB{final  hL;final  lL;iB( h, g):hL=h.toDouble(),lL=g.toDouble(); clone()=>new iB(hL,lL); get x=>hL; get y=>lL; toString()=>"Vector [x=${hL}, y=${lL}]"; operator+( g)=>new iB(hL+g.hL,lL+g.lL); operator-( g)=>new iB(hL-g.hL,lL-g.lL); operator*( g)=>new iB(hL*g.hL,lL*g.lL); operator/( g)=>new iB(hL/g.hL,lL/g.lL); operator-()=>new iB(-hL,-lL); operator==( g)=>hL==g.hL&&lL==g.lL; get length=>bB.sqrt(hL*hL+lL*lL); distance( g){var i=hL-g.hL;var h=lL-g.lL;return bB.sqrt(i*i+h*h);} rotate( g){var i=bB.sin(g);var h=bB.cos(g);return new iB(hL*h-lL*i,hL*i+lL*h);}}class DB implements cC{var sL;var GM;var YM;var kM;var tM;var EN;var NN;var UN;var bN;var dN;var gN;var kN;var qN;var zL;static var rF=new FE(png:true,jpg:true,webp:false);DB( h, i,[ transparent=true, fillColor=0xFFFFFFFF]){sL=h.toInt();GM=i.toInt();YM=transparent;kM=0;NN=bN=0;UN=dN=0;tM=gN=sL;EN=kN=GM;var g=new QB.CanvasElement(width:sL,height:GM);zL=g.context2d;zL.fillStyle=YM?PE(fillColor):MD(fillColor);zL.fillRect(0,0,sL,GM);qN=g;}DB.JL( g){if(g==null)throw new ArgumentError();sL=g.naturalWidth.toInt();GM=g.naturalHeight.toInt();YM=true;kM=0;NN=bN=0;UN=dN=0;tM=gN=sL;EN=kN=GM;qN=g;}DB.KL( g){sL=g.iJ.toInt();GM=g.hJ.toInt();YM=true;kM=g.pJ?2:1;NN=g.offsetX;UN=g.offsetY;tM=g.QG;EN=g.PG;bN=g.QJ;dN=g.RJ;gN=g.QG;kN=g.PG;qN=g.rJ.iM.qN;}static  tC( h,[ bitmapDataLoadOptions=null]){if(bitmapDataLoadOptions==null)bitmapDataLoadOptions=DB.rF;var i=new VB.Completer<DB>();var g=new QB.ImageElement();var j;var k;j=g.onLoad.listen((m){j.cancel();k.cancel();i.complete(new DB.JL(g));});k=g.onError.listen((m){j.cancel();k.cancel();i.completeError(new StateError("Error loading image."));});if(bitmapDataLoadOptions.webp==false){g.src=h;return i.future;}nI.then(( o){var n=new RegExp(r"(png|jpg|jpeg)$",multiLine:false,caseSensitive:true);var l=n.firstMatch(h);if(o==false||l==null){g.src=h;}else{g.src=h.substring(0,h.length-l.group(1).length)+"webp";}});return i.future;} get width=>sL; get height=>GM; clone(){var g=new DB(sL,GM,true,0);g.LJ(this);return g;} GJ( i, j, g, h){h.apply(i,j,this,g);} KG( j, g, h,[ alphaBitmapData=null, alphaPoint=null, mergeAlpha=false]){var i=j.JP().getImageData(g.x,g.y,g.width,g.height);JP().putImageData(i,h.x,h.y);} LJ( h,[ matrix=null]){var g=JP();var i=new SB.DL(g,matrix);h.BB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} clear(){var g=JP();g.clearRect(0,0,sL,GM);} BB( h){var g=h.context;switch (kM){case 0:g.drawImage(qN,NN,UN);break;case 1:g.drawImageScaledFromSource(qN,bN,dN,gN,kN,NN,UN,tM,EN);break;case 2:g.transform(0.0,-1.0,1.0,0.0,NN,UN+EN);g.drawImageScaledFromSource(qN,bN,dN,kN,gN,0.0,0.0,EN,tM);break;}} hG( PB, g){var w=PB.context;if(g.width<=0.0||g.height<=0.0)return;switch (kM){case 0:w.drawImageScaledFromSource(qN,g.x-NN,g.y-UN,g.width,g.height,g.x+NN,g.y+UN,g.width,g.height);break;case 1:var j=bN;var h=dN;var p=j+gN;var q=h+kN;var l=bN-NN+g.x;var m=dN-UN+g.y;var v=l+g.width;var t=m+g.height;var o=(j>l)?j:l;var n=(h>m)?h:m;var EB=(p<v)?p:v;var NB=(q<t)?q:t;var k=EB-o;var i=NB-n;var MB=NN-j+o;var JB=UN-h+n;if(k>0.0&&i>0.0){w.drawImageScaledFromSource(qN,o,n,k,i,MB,JB,k,i);}break;case 2:var j=bN;var h=dN;var p=j+kN;var q=h+gN;var l=bN+UN-g.y+EN-g.height;var m=dN-NN+g.x;var v=l+g.height;var t=m+g.width;var o=(j>l)?j:l;var n=(h>m)?h:m;var EB=(p<v)?p:v;var NB=(q<t)?q:t;var k=NB-n;var i=EB-o;var MB=NN-h+n;var JB=UN+p-EB;if(k>0.0&&i>0.0){w.transform(0.0,-1.0,1.0,0.0,MB,JB+i);w.drawImageScaledFromSource(qN,o,n,i,k,0,0,i,k);}break;}} JP(){if(zL==null){var g=new QB.CanvasElement(width:sL,height:GM);zL=g.context2d;switch (kM){case 0:zL.drawImage(qN,NN,UN);break;case 1:zL.drawImageScaledFromSource(qN,bN,dN,gN,kN,NN,UN,tM,EN);break;case 2:zL.transform(0.0,-1.0,1.0,0.0,NN,UN+EN);zL.drawImageScaledFromSource(qN,bN,dN,kN,gN,0.0,0.0,EN,tM);zL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}kM=0;NN=bN=0;UN=dN=0;tM=gN=sL;EN=kN=GM;qN=g;}return zL;}}typedef  GE( ratio);typedef  AH<LD extends IB>( event);class FH<LD extends IB> extends VB.StreamSubscription<LD>{var DN;var ON;var SN;var XN;FH(this.DN,this.ON){SN=0;XN=false;} cancel(){if(XN==false){DN.SO(this);XN=true;ON=null;}} onError( g( error)){} get HP=>SN>0; pause([ resumeSignal]){SN++ ;if(resumeSignal!=null){resumeSignal.whenComplete(resume);}} resume(){if(HP==false){throw new StateError("Subscription is not paused.");}SN-- ;}} MD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class FC{var QM;var GN;var gM;final  WN=new List<kE>();final  lN=new List<AJ>();static  tC( l){var i=new VB.Completer<FC>();QB.HttpRequest.getString(l).then((p){var h=nG.parse(p) as Map;var j=new List();var g=new FC();g.QM=l;g.GN=h["md5"];g.gM=h["frameRate"].toInt();for(var m in h["movies"] as List){var n=new kE(m,g);g.WN.add(n);}for(var o in h["textureGroups"] as List){var k=new AJ(o,g);g.lN.add(k);j.add(k.oD.future);}VB.Future.wait(j).then((t){i.complete(g);}).catchError((q){i.completeError(new StateError("Failed to load image."));});}).catchError((q){i.completeError(new StateError("Failed to load json file."));});return i.future;} XP( h){for(var g in WN)if(g.id==h)return g;throw new ArgumentError("The movie '${h}' is not available.");} iP( g){for(var h in lN){if(h.rD.containsKey(g)){return h.rD[g];}}for(var i in WN){if(i.id==g){return new XK(this,g);}}throw new ArgumentError("The symbol '${g}' is not available.");}} QH( g){if(HE.containsKey(g)==false){HE[g]=new uF(g);}return HE[g];}final  NE=new FB.GL();class gF{static var rH=RF.vF;static var xH=new VB.StreamController<String>();static var BI=xH.stream.asBroadcastStream();static  get NI=>rH;}abstract class u extends LC implements cC{static var iH=0;var pN=iH++ ;var hL=0.0;var lL=0.0;var xN=0.0;var AO=0.0;var BO=1.0;var GO=1.0;var IO=0.0;var LO=0.0;var OO=0.0;var RO=1.0;var UO=true;var VO=false;var ZO=null;var cO=null;var dO=null;var fO=false;var iO=null;var nO=null;var FM="";var uO=null;final  vO=new FB.GL();final  AP=new FB.GL();var FP=true;static const  WI=const hB<HD>(IB.OE); get eJ=>u.WI.forTarget(this); get x=>hL; get y=>lL; get mB=>xN; get sB=>AO; get cB=>BO; get dB=>GO; get skewX=>IO; get skewY=>LO; get UC=>OO; get visible=>UO; get alpha=>RO; get name=>FM; get parent=>uO; get sD{var g=this.nC;return (g!=null)?this.TC(g.sP):null;} get cJ{var g=this.sD;return (g!=null)?g.x:0.0;} get dJ{var g=this.sD;return (g!=null)?g.y:0.0;} get root{var g=this;while (g.uO!=null)g=g.uO;return g;} get nC{var g=this.root;if(g is vC)return g;return null;}set x( g){hL=g.toDouble();FP=true;}set y( g){lL=g.toDouble();FP=true;}set mB( g){xN=g.toDouble();FP=true;}set sB( g){AO=g.toDouble();FP=true;}set cB( g){BO=g.toDouble();FP=true;}set dB( g){GO=g.toDouble();FP=true;}set skewX( g){IO=g.toDouble();FP=true;}set skewY( g){LO=g.toDouble();FP=true;}set UC( g){OO=g.toDouble();FP=true;}set visible( g){UO=g;}set alpha( g){RO=g.toDouble();}set mask( g){ZO=g;} setTransform( h, g,[ scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY]){FP=true;hL=h.toDouble();lL=g.toDouble();if(scaleX!=null){BO=scaleX.toDouble();if(scaleY!=null){GO=scaleY.toDouble();if(rotation!=null){OO=rotation.toDouble();if(skewX!=null){IO=skewX.toDouble();if(skewY!=null){LO=skewY.toDouble();if(pivotX!=null){xN=pivotX.toDouble();if(pivotY!=null)AO=pivotY.toDouble();}}}}}}} get width=>kB(SP).width; get height=>kB(SP).height; set width( h){this.cB=1;var g=this.width;this.cB=(g!=0.0)?h/g:1.0;} set height( h){this.dB=1;var g=this.height;this.dB=(g!=0.0)?h/g:1.0;} zE(){if(uO!=null)uO.gG(this);} get SP{if(FP){FP=false;var j=IO+OO;var i=LO+OO;if(j==0.0&&i==0.0){AP.TD(BO,0.0,0.0,GO,hL-xN*BO,lL-AO*GO);}else{var g,l,k,h;var m=bB.cos(j);var n=bB.sin(j);if(j==i){g=BO*m;l=BO*n;k=-GO*n;h=GO*m;}else{g=BO*bB.cos(i);l=BO*bB.sin(i);k=-GO*n;h=GO*m;}var p=hL-(xN*g+AO*k);var o=lL-(xN*l+AO*h);AP.TD(g,l,k,h,p,o);}}return AP;} FF( h){if(h==uO)return SP.clone();if(h.uO==this)return h.SP.IG();var j=new FB.GL();var g=this;while (g!=h&&g.uO!=null){j.concat(g.SP);g=g.uO;}if(h==null&&g!=null){j.concat(g.SP);g=null;}if(g==h)return j;var k=new FB.GL();var i=h;while (i!=this&&i.uO!=null){k.concat(i.SP);i=i.uO;}k.vE();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new AB.BL();returnRectangle.x=g.ZB;returnRectangle.y=g.aB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} XB( g, h){if(kB(NE).contains(g,h))return this;return null;} TC( h){vO.aJ();for(u g=this;g!=null;g=g.uO)vO.concat(g.SP);vO.vE();return vO.xD(h);} dispatchEvent( h){var g=null;if(h.nD||h.bubbles){for(u j=uO;j!=null;j=j.uO){if(j.MP(h.type,h.nD,h.bubbles)){if(g==null)g=fD.dG() as List<u>;g.add(j);}}}if(h.nD&&g!=null){for(int i=g.length-1;i>=0&&h.vD==false;i-- ){g[i].hO(h,this,g[i],CC.YF);}}if(h.vD==false){hO(h,this,this,CC.eC);}if(h.bubbles&&g!=null){for(int i=0;i<g.length&&h.vD==false;i++ ){g[i].hO(h,this,g[i],CC.RH);}}if(g!=null){g.clear();fD.eG(g);}} cP( h){for(var g=h;g!=null;g=g.uO)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");uO=h;} BB( g);}class GC{static const  dH="B";static const  hH="BL";static const  mH="BR";static const  HH="L";static const  lF="R";static const  qH="T";static const  sH="TL";static const  vH="TR";static const  vF="";} PE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class uF{var fontStyle;var OD=0;var qD=0;var height=0;uF( j){this.fontStyle=j;var h=new QB.Element.tag("span");h.style.font=this.fontStyle;h.text="Hg";var g=new QB.Element.tag("div");g.style.display="inline-block";g.style.width="1px";g.style.height="0px";var i=new QB.Element.tag("div");i.append(g);i.append(h);QB.document.body.append(i);try {g.style.verticalAlign="baseline";this.OD=g.offsetTop-h.offsetTop;g.style.verticalAlign="bottom";this.height=g.offsetTop-h.offsetTop;this.qD=height-OD;}catch (k){}finally {i.remove();}}}class PC{var matrix;var jC=double.INFINITY;var kC=double.NEGATIVE_INFINITY;var lC=double.INFINITY;var iC=double.NEGATIVE_INFINITY;var xC=double.INFINITY;var yC=double.NEGATIVE_INFINITY;var zC=double.INFINITY;var wC=double.NEGATIVE_INFINITY;var QD=double.NAN;var RD=double.NAN;PC(this.matrix); get tE=>!QD.isNaN&&!RD.isNaN; get TG=>!jC.isInfinite&&!kC.isInfinite&&!lC.isInfinite&&!iC.isInfinite; get ZJ=>!xC.isInfinite&&!yC.isInfinite&&!zC.isInfinite&&!wC.isInfinite;nJ(){QD=RD=double.NAN;jC=lC=double.INFINITY;kC=iC=double.NEGATIVE_INFINITY;}DD( h, g){QD=h;RD=g;}XC( h, g,[ transformed=false]){if(tE){h=h.toDouble();g=g.toDouble();var i=transformed?h:h*matrix.a+g*matrix.c+matrix.ZB;var j=transformed?g:h*matrix.b+g*matrix.d+matrix.aB;if(jC>i)jC=i;if(kC<i)kC=i;if(lC>j)lC=j;if(iC<j)iC=j;}}stroke( l){if(TG){var g=bB.sqrt(matrix.hC)*l/2;var h=jC-g;var i=kC+g;var j=lC-g;var k=iC+g;if(xC>h)xC=h;if(yC<i)yC=i;if(zC>j)zC=j;if(wC<k)wC=k;}}fill(){if(TG){if(xC>jC)xC=jC;if(yC<kC)yC=kC;if(zC>lC)zC=lC;if(wC<iC)wC=iC;}} XJ(){if(ZJ){var g=xC.floor();var i=yC.ceil();var h=zC.floor();var j=wC.ceil();return new AB(g,h,i-g,j-h);}else{return new AB.BL();}}}class s{static var QE;static  uC( g){return g;}static  xF( g){return 0.5-0.5*bB.cos(g*2.0*bB.PI);}static  II( g){return 0.5+0.5*bB.cos(g*2.0*bB.PI);}static  KI( g){if(QE==null)QE=new bB.Random();if(g==0.0||g==1.0)return g;return QE.nextDouble();}static  RE( g){return g*g;}static  SE( g){g=1.0-g;return 1.0-g*g;}static  SI( g){g=g*2.0;return (g<1.0)?0.5*RE(g):0.5*SE(g-1.0)+0.5;}static  UI( g){g=g*2.0;return (g<1.0)?0.5*SE(g):0.5*RE(g-1.0)+0.5;}static  TE( g){return g*g*g;}static  UE( g){g=1.0-g;return 1.0-g*g*g;}static  DG( g){g=g*2.0;return (g<1.0)?0.5*TE(g):0.5*UE(g-1.0)+0.5;}static  XI( g){g=g*2.0;return (g<1.0)?0.5*UE(g):0.5*TE(g-1.0)+0.5;}static  VE( g){return g*g*g*g;}static  WE( g){g=1.0-g;return 1.0-g*g*g*g;}static  aI( g){g=g*2.0;return (g<1.0)?0.5*VE(g):0.5*WE(g-1.0)+0.5;}static  bI( g){g=g*2.0;return (g<1.0)?0.5*WE(g):0.5*VE(g-1.0)+0.5;}static  XE( g){return g*g*g*g*g;}static  YE( g){g=1.0-g;return 1.0-g*g*g*g*g;}static  dI( g){g=g*2.0;return (g<1.0)?0.5*XE(g):0.5*YE(g-1.0)+0.5;}static  eI( g){g=g*2.0;return (g<1.0)?0.5*YE(g):0.5*XE(g-1.0)+0.5;}static  ZE( g){return 1.0-bB.sqrt(1.0-g*g);}static  aE( g){g=1.0-g;return bB.sqrt(1.0-g*g);}static  hI( g){g=g*2.0;return (g<1.0)?0.5*ZE(g):0.5*aE(g-1.0)+0.5;}static  iI( g){g=g*2.0;return (g<1.0)?0.5*aE(g):0.5*ZE(g-1.0)+0.5;}static  bE( g){return 1.0-bB.cos(g*(bB.PI/2.0));}static  cE( g){return bB.sin(g*(bB.PI/2.0));}static  oI( g){g=g*2.0;return (g<1.0)?0.5*bE(g):0.5*cE(g-1.0)+0.5;}static  pI( g){g=g*2.0;return (g<1.0)?0.5*cE(g):0.5*bE(g-1.0)+0.5;}static  dE( g){if(g==0.0)return 0.0;return bB.pow(2.0,10.0*(g-1.0));}static  eE( g){if(g==1.0)return 1.0;return 1.0-bB.pow(2.0,-10.0*g);}static  rI( g){g=g*2.0;return (g<1.0)?0.5*dE(g):0.5*eE(g-1.0)+0.5;}static  tI( g){g=g*2.0;return (g<1.0)?0.5*eE(g):0.5*dE(g-1.0)+0.5;}static  gE( g){var h=1.70158;return g*g*((h+1.0)*g-h);}static  hE( g){var h=1.70158;g=g-1.0;return g*g*((h+1.0)*g+h)+1.0;}static  HG( g){g=g*2.0;return (g<1.0)?0.5*gE(g):0.5*hE(g-1.0)+0.5;}static  uI( g){g=g*2.0;return (g<1.0)?0.5*hE(g):0.5*gE(g-1.0)+0.5;}static  iE( g){if(g==0.0||g==1.0)return g;g=g-1.0;return -bB.pow(2.0,10.0*g)*bB.sin((g-0.3/4.0)*(2.0*bB.PI)/0.3);}static  kD( g){if(g==0.0||g==1.0)return g;return bB.pow(2.0,-10.0*g)*bB.sin((g-0.3/4.0)*(2.0*bB.PI)/0.3)+1;}static  wI( g){g=g*2.0;return (g<1.0)?0.5*iE(g):0.5*kD(g-1.0)+0.5;}static  xI( g){g=g*2.0;return (g<1.0)?0.5*kD(g):0.5*iE(g-1.0)+0.5;}static  jE( g){return 1.0-lD(1.0-g);}static  lD( g){if(g<1/2.75){return 7.5625*g*g;}else if(g<2/2.75){g=g-1.5/2.75;return 7.5625*g*g+0.75;}else if(g<2.5/2.75){g=g-2.25/2.75;return 7.5625*g*g+0.9375;}else{g=g-2.625/2.75;return 7.5625*g*g+0.984375;}}static  yI( g){g=g*2.0;return (g<1.0)?0.5*jE(g):0.5*lD(g-1.0)+0.5;}static  zI( g){g=g*2.0;return (g<1.0)?0.5*lD(g):0.5*jE(g-1.0)+0.5;}}class ND{static const  IE="auto";static const  CI="stop";static const  yF="once";} EI( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}class AG{var target=null;var MC=false;var oE=0;var PD=0;var YG,aG;var WG,XG;AG(this.YG,this.aG,this.WG,this.XG);}class UK extends FD{final  xO;UK( i, g, h, j):xO=new AB(i,g,h,j); BB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.ZB,g.aB);h.beginPath();h.rect(xO.x,xO.y,xO.width,xO.height);h.clip();}} QC( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class jB{final  yE;var BF=double.NAN;var DF=double.NAN;jB(this.yE); vB( g){this.DF=g.toDouble();} get bJ=>!BF.isNaN&&!DF.isNaN; OP( g){switch (yE){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.mB;case 'pivotY':return g.sB;case 'scaleX':return g.cB;case 'scaleY':return g.dB;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.UC;case 'alpha':return g.alpha;default:return 0.0;}} jP( g, h){switch (yE){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.mB=h;break;case 'pivotY':g.sB=h;break;case 'scaleX':g.cB=h;break;case 'scaleY':g.dB=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.UC=h;break;case 'alpha':g.alpha=h;break;}}}class OI{static var QI=0;var wD=QI++ ;var target=null;var tD=false;OI(this.target,this.tD);}class VK extends FD{final  VP;VK( i, g, h):VP=new rG(i,g,h); BB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.ZB,g.aB);h.beginPath();h.arc(VP.x,VP.y,VP.fG,0,bB.PI*2.0,false);h.clip();}}class vC extends WB{var bO;var zL;var YP,ZP;var WO,XO;var bP,dP;var eP;var gP;var hP;var kL;var mK=30;var lP;var mP;var nP;var oP;var pP;var rP;var sP;var tP;var uP;var vP;var wP;var xP;var yP;vC( h, g){FM=h;bO=g;bO.focus();zL=g.context2d;WO=YP=g.width;XO=ZP=g.height;bP=g.clientWidth;dP=g.clientHeight;eP=new FB.GL();gP=new FB.GL();hP=null;kL=new ED();mP=new SB.DL(zL);nP=ND.IE;oP=GD.iF;pP=GC.vF;uP=[new AG(CB.eF,CB.kF,CB.ZF,CB.OH),new AG(CB.tH,CB.yH,CB.tF,CB.tF),new AG(CB.DI,CB.HI,CB.wF,CB.wF)];rP=pB.LE;tP=null;sP=new GB(0,0);wP=new CB(CB.ZF,true);dC.nH.listen(nH);bO.onMouseDown.listen(PQ);bO.onMouseUp.listen(PQ);bO.onMouseMove.listen(PQ);bO.onMouseOut.listen(PQ);bO.onMouseWheel.listen(QQ);vP=new Map<int,OI>();yP=new TB(TB.aF,true);gF.BI.listen(RQ);RQ(null);xP=new EC(EC.KE,true);bO.onKeyDown.listen(SQ);bO.onKeyUp.listen(SQ);bO.onKeyPress.listen(UQ);} get AF=>hP; get wE=>kL; get sD=>sP; get focus=>lP; get align=>pP;WQ(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){WQ();}set y( g){WQ();}set mB( g){WQ();}set sB( g){WQ();}set cB( g){WQ();}set dB( g){WQ();}set skewX( g){WQ();}set skewY( g){WQ();}set UC( g){WQ();}set alpha( g){WQ();}set width( g){WQ();}set height( g){WQ();}VG( g, h){if(nP==ND.IE||nP==ND.yF){XQ();mP.reset(gP,g,h);BB(mP);if(nP==ND.yF)nP=ND.CI;}}XQ(){var m=bO.getBoundingClientRect();var n=bO.clientLeft+m.left;var o=bO.clientTop+m.top;var k=bO.clientWidth;var l=bO.clientHeight;if(k==0||l==0)return;var g=YP;var h=ZP;var i=0;var j=0;switch (oP){case GD.CH:g=YP;h=ZP;break;case GD.MH:if(k*ZP>l*YP){h=(YP*l)~/k;}else{g=(ZP*k)~/l;}break;case GD.VH:g=k;h=l;break;case GD.iF:if(k*ZP>l*YP){g=(ZP*k)~/l;}else{h=(YP*l)~/k;}break;}switch (pP){case GC.dH:i=(YP-g+1)~/2;j=(ZP-h);break;case GC.hH:i=0;j=(ZP-h);break;case GC.mH:i=(YP-g);j=(ZP-h);break;case GC.HH:i=0;j=(ZP-h+1)~/2;break;case GC.lF:i=(YP-g);j=(ZP-h+1)~/2;break;case GC.qH:i=(YP-g+1)~/2;j=0;break;case GC.sH:i=0;j=0;break;case GC.vH:i=(YP-g+1);j=0;break;case GC.vF:i=(YP-g+1)~/2;j=(ZP-h+1)~/2;break;}gP.TD(1.0,0.0,0.0,1.0,0-i,0-j);eP.TD(g/k,0.0,0.0,h/l,i-n,j-o);if(WO!=g||XO!=h){bO.width=WO=g;bO.height=XO=h;}if(bP!=k||dP!=l){bP=k;dP=l;dispatchEvent(new IB(IB.kH));}}nH( g){bO.style.cursor=dC.BG(rP);}PQ( j){j.preventDefault();var n=new DateTime.now().millisecondsSinceEpoch;var p=j.button;var h=null;var i=eP.fP(j.client);var m=null;if(p<0||p>2)return;if(j.type=="mousemove"&&sP.OG(i))return;var g=uP[p];sP=i;if(dC.dF!=null)dC.dF.KP();if(j.type!="mouseout")h=XB(i.x,i.y) as LB;var l=pB.LE;if(h is ID&&(h as ID).HF){l=pB.ME;}if(h is VF&&(h as VF).HF){l=pB.ME;}if(rP!=l){rP=l;bO.style.cursor=dC.BG(l);}if(tP!=null&&tP!=h){tP.dispatchEvent(wP..YO(CB.oF,true)..WP=(tP.nC!=null)?tP.TC(i):new GB.BL()..aP=i..LP=g.MC);tP=null;}if(h!=null&&h!=tP){h.dispatchEvent(wP..YO(CB.pF,true)..WP=h.TC(i)..aP=i..LP=g.MC);tP=h;}var k=null;var o=false;var q=false;if(j.type=="mousedown"){k=g.YG;if(h!=g.target||n>g.oE+500)g.PD=0;g.MC=true;g.target=h;g.oE=n;g.PD++ ;}if(j.type=="mouseup"){k=g.aG;g.MC=false;o=(g.target==h);q=o&&g.PD.isEven&&(n<g.oE+500);}if(j.type=="mousemove"){k=CB.nF;}if(k!=null&&h!=null){m=h.TC(i);h.dispatchEvent(wP..YO(k,true)..WP=m..aP=i..LP=g.MC..PP=g.PD);if(o){if(q&&h.KJ){h.dispatchEvent(wP..YO(g.XG,true)..WP=m..aP=i..LP=g.MC);}else{h.dispatchEvent(wP..YO(g.WG,true)..WP=m..aP=i..LP=g.MC);}}}}QQ( h){var g=eP.fP(h.client);var i=XB(g.x,g.y) as LB;if(i!=null){i.dispatchEvent(wP..YO(CB.qF,true)..WP=i.TC(g)..aP=g..QP=h.deltaX..RP=h.deltaY);if(wP.vD)h.preventDefault();}}var jQ=[] ;RQ( h){jQ.forEach((g)=>g.cancel());if(gF.NI==RF.TH){jQ=[bO.onTouchStart.listen(kQ),bO.onTouchEnd.listen(kQ),bO.onTouchMove.listen(kQ),bO.onTouchEnter.listen(kQ),bO.onTouchLeave.listen(kQ),bO.onTouchCancel.listen(kQ)];}}kQ( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=eP.fP(m.client);var h=XB(i.x,i.y) as LB;var g=vP.containsKey(l)?vP[l]:new OI(h,vP.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(yP..YO(TB.jH,true)..WP=(g.target.nC!=null)?g.target.TC(i):new GB.BL()..aP=i..jO=g.wD..lO=g.tD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(yP..YO(TB.fH,true)..WP=h.TC(i)..aP=i..jO=g.wD..lO=g.tD);g.target=h;}var k=null;if(j.type=="touchstart"){vP[l]=g;k=TB.aF;}if(j.type=="touchend"){vP.remove(l);k=TB.cF;}if(j.type=="touchcancel"){vP.remove(l);k=TB.fF;}if(j.type=="touchmove"){k=TB.mF;}if(k!=null&&h!=null){h.dispatchEvent(yP..YO(k,true)..WP=h.TC(i)..aP=i..jO=g.wD..lO=g.tD);}}}SQ( g){g.preventDefault();var h=null;if(g.type=="keyup")h=EC.bF;if(g.type=="keydown")h=EC.KE;xP..YO(h,true)..sN=g.altKey..tN=g.ctrlKey..wN=g.shiftKey..JO=g.charCode..NO=g.keyCode..PO=qC.BH;if(g.keyLocation==QB.KeyLocation.LEFT)xP.PO=qC.HH;if(g.keyLocation==QB.KeyLocation.RIGHT)xP.PO=qC.lF;if(g.keyLocation==QB.KeyLocation.NUMPAD)xP.PO=qC.UH;if(g.keyLocation==QB.KeyLocation.JOYSTICK)xP.PO=qC.hF;if(g.keyLocation==QB.KeyLocation.MOBILE)xP.PO=qC.hF;if(lP!=null)lP.dispatchEvent(xP);}UQ( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new SF(SF.NH,true);h.CM=new String.fromCharCodes([i]);if(lP!=null)lP.dispatchEvent(h);}} CG( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class WK extends FD{final  qP;WK( g):qP=g.toList(growable:false){if(g.length<3)throw new ArgumentError("A custom mask needs at least 3 points.");} BB( j, g){var h=j.context;h.setTransform(g.a,g.b,g.c,g.d,g.ZB,g.aB);h.beginPath();for(int i=0;i<qP.length;i++ )h.lineTo(qP[i].x,qP[i].y);h.clip();}} EG( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} ZI(){var g=new QB.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;}class XK extends u implements gB{final  zP;final  AQ;final  BQ=new List<kI>();var CQ=0.0;var DQ=0.0;var EQ=0;var yL=0;XK( g, j):zP=g,AQ=g.XP(j){for(var h in AQ.qE){var i=new kI(zP,h);BQ.add(i);}yL=AQ.rE;DQ=yL/zP.gM;} rB( h){CQ+= h;var i=CQ%DQ;EQ=bB.min((yL*i/DQ).toInt(),yL-1);for(var g in BQ){g.rB(h);g.jG(EQ);}return true;} BB( h){for(var g in BQ){if(g.visible){h.iG(g);}}}} cI(){var i=new VB.Completer<bool>();var g=new QB.ImageElement(); h(){i.complete(g.width==2&&g.height==2);}g.onLoad.listen((j)=>h());g.onError.listen((j)=>h());g.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";return i.future;}class jD implements gB{final  FQ;final  GQ;final  HQ=new List<jB>();var IQ;var JQ;var KQ;var LQ;var dM;var OM;var MQ;var NQ;var OQ;jD( g, h,[ transitionFunction]):FQ=g,GQ=(?transitionFunction)?transitionFunction:s.uC{LQ=new WF(this);OM=0.0;dM=bB.max(0.0001,h);MQ=0.0;NQ=false;OQ=false;} get HC=>LQ; zM( g){if(FQ!=null&&OQ==false){HQ.add(g);}} rB( m){if(OM<dM||OQ==false){OM=OM+m;if(OM>dM){OM=dM;}if(OM>=0.0){if(OQ==false){OQ=true;for(int h=0;h<HQ.length;h++ ){var g=HQ[h];g.BF=g.OP(FQ);}if(IQ!=null){IQ();}}var k=OM/dM;var l=GQ(k).toDouble();for(int h=0;h<HQ.length;h++ ){var g=HQ[h];if(g.bJ){var i=g.BF.toDouble();var n=g.DF.toDouble();var j=i+l*(n-i);g.jP(FQ,NQ?j.round():j);}}if(JQ!=null){JQ();}if(KQ!=null&&OM==dM){KQ();}}}return OM<dM;} get JJ=>FQ; get currentTime=>OM;set LG( g){if(OQ==false)OM=OM+MQ-g;MQ=g;} set onComplete( g()){KQ=g;}}class YK extends AC{YK();BB( g){g.beginPath();}WC( g){g.nJ();}} fI( h){if(fC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];h[g+0]=(h[g+0]*i)~/255;h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;h[g+3]=(h[g+3]*i)~/255;}}}class ZK extends AC{ZK();BB( g){g.closePath();}}class aK extends AC{var hL,lL;aK( h, g){hL=h.toDouble();lL=g.toDouble();}BB( g){g.moveTo(hL,lL);}WC( g){g.DD(hL,lL);}}class kI extends u implements gB{final  AD;final  pE;final  CF=new Map<String,cC>();var UD;kI( i, h):this.AD=i,this.pE=h{for(var g in h.IC){if(g.mC!=null&&CF.containsKey(g.mC)==false){CF[g.mC]=i.iP(g.mC);}}jG(0);} rB( g){if(UD is gB){var h=UD as gB;h.rB(g);}} jG( t){var g=pE.WJ(t);var o=g.x,p=g.y;var n=g.cB,k=g.dB;var m=g.skewX,l=g.skewY;var w=g.mB,PB=g.sB;var q=g.alpha;if(g.index!=t&&g.mG){var i=pE.VJ(g);if(i!=null){var h=(t-g.index)/g.duration;var j=g.NG;if(j!=0){var v=0.0;if(j<0){var JB=1-h;v=1-JB*JB;j=0-j;}else{v=h*h;}h=j*v+(1-j)*h;}o=o+(i.x-o)*h;p=p+(i.y-p)*h;n=n+(i.cB-n)*h;k=k+(i.dB-k)*h;m=m+(i.skewX-m)*h;l=l+(i.skewY-l)*h;q=q+(i.alpha-q)*h;}}var EB=n*bB.cos(l);var UB=n*bB.sin(l);var MB=-k*bB.sin(m);var NB=k*bB.cos(m);var YB=o-(w*EB+PB*MB);var eB=p-(w*UB+PB*NB);FP=false;AP.TD(EB,UB,MB,NB,YB,eB);RO=q;UO=g.visible;UD=(g.mC!=null)?CF[g.mC]:null;} BB( g){if(UD!=null){UD.BB(g);}}} mI( h){if(fC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];if(i>0){h[g+0]=(h[g+0]*255)~/i;h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;}}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];if(i>0){h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;h[g+3]=(h[g+3]*255)~/i;}}}}var fC=ZI();var nI=cI();class bK extends AC{var hL,lL;bK( h, g){hL=h.toDouble();lL=g.toDouble();}BB( g){g.lineTo(hL,lL);}WC( g){if(g.tE==false){g.DD(hL,lL);}g.XC(g.QD,g.RD);g.XC(hL,lL);g.DD(hL,lL);}} fE( g, m, n, j){m=m.toDouble();n=n.toDouble();var JB=0.0;var EB=0.0;var q=m*g.a;var w=m*g.b;var t=m*g.a+n*g.c;var p=m*g.b+n*g.d;var v=n*g.c;var o=n*g.d;var h=JB;if(h>q)h=q;if(h>t)h=t;if(h>v)h=v;var i=EB;if(i>w)i=w;if(i>p)i=p;if(i>o)i=o;var l=JB;if(l<q)l=q;if(l<t)l=t;if(l<v)l=v;var k=EB;if(k<w)k=w;if(k<p)k=p;if(k<o)k=o;if(j==null)j=new AB.BL();j.x=g.ZB+h;j.y=g.aB+i;j.width=l-h;j.height=k-i;return j;}class kE{final  id;final  AD;final  qE=new List<lE>();kE( g, j):AD=j,id=g["id"]{for(var h in g["layers"]){var i=new lE(h);this.qE.add(i);}} get rE{var g=0;for(var h in qE)g=bB.max(g,h.rE);return g;}}class lE{final  name;final  OJ;final  IC=new List<mD>();lE( g):this.name=g["name"],this.OJ=g.containsKey("flipbook")?g["flipbook"]:false{for(var i in g["keyframes"]){var h=new mD(i);this.IC.add(h);}} get rE{var g=IC[IC.length-1];return g.index+g.duration;} WJ( h){var g=1;while (g<IC.length&&IC[g].index<=h)g++ ;return IC[g-1];} VJ( h){for(int g=0;g<IC.length-1;g++ )if(identical(IC[g],h))return IC[g+1];return null;}}class mD{var index;var duration;var mC;var label;var x,y;var cB,dB;var skewX,skewY;var mB,sB;var visible;var alpha;var mG;var NG;mD( g){this.index=g["index"];this.duration=g["duration"];this.mC=g.containsKey("ref")?g["ref"]:null;this.label=g.containsKey("label")?g["label"]:null;this.x=g.containsKey("loc")?g["loc"][0]:0.0;this.y=g.containsKey("loc")?g["loc"][1]:0.0;this.cB=g.containsKey("scale")?g["scale"][0]:1.0;this.dB=g.containsKey("scale")?g["scale"][1]:1.0;this.skewX=g.containsKey("skew")?g["skew"][0]:0.0;this.skewY=g.containsKey("skew")?g["skew"][1]:0.0;this.mB=g.containsKey("pivot")?g["pivot"][0]:0.0;this.sB=g.containsKey("pivot")?g["pivot"][1]:0.0;this.visible=g.containsKey("visible")?g["visible"]:true;this.alpha=g.containsKey("alpha")?g["alpha"]:1.0;this.mG=g.containsKey("tweened")?g["tweened"]:true;this.NG=g.containsKey("ease")?g["ease"]:0.0;}}class AJ{var AD;var rD;var oD;AJ( p,this.AD){this.rD=new Map<String,BJ>();this.oD=new VB.Completer();var k=0;for(var j in p["atlases"] as List){var n=j["file"] as String;var q=EG(AD.QM,n);k++ ;var g=new QB.ImageElement();g.onLoad.listen((o){if( --k==0)this.oD.complete(this);});g.onError.listen((o){this.oD.completeError(new StateError("Failed to load image."));});g.src=q;for(var i in j["textures"] as List){var m=i["symbol"] as String;var h=i["rect"] as List;var l=i["origin"] as List;var t=new BJ(h[0],h[1],h[2],h[3],l[0],l[1],g);this.rD[m]=t;}}}}class cK extends AC{var hL,lL,ZQ;var aQ,bQ;var cQ;cK( l, g, j, i, h, k){hL=l.toDouble();lL=g.toDouble();ZQ=j.toDouble();aQ=i.toDouble();bQ=h.toDouble();cQ=k;}BB( g){g.arc(hL,lL,ZQ,aQ,bQ,cQ);}WC( g){var j=new iB(ZQ,0);var o=j.rotate(aQ);var m=j.rotate(bQ);if(g.tE==false){g.DD(hL+o.x,lL+o.y);}var h=aQ;var i=bQ;if(cQ){if(h<i)h=h+2*bB.PI;}else{if(i<h)i=i+2*bB.PI;}var p=i-h;var l=(p*30).abs()~/bB.PI+1;g.XC(g.QD,g.RD);for(var k=0;k<=l;k++ ){var n=j.rotate(h+k*p/l);g.XC(hL+n.x,lL+n.y);}g.DD(hL+m.x,lL+m.y);}}class BJ implements cC{var x,y,width,height;var fJ,gJ;var UG;var dQ;var eQ;BJ(this.x,this.y,this.width,this.height,this.fJ,this.gJ,this.UG); BB( g){g.context.drawImageScaledFromSource(UG,x,y,width,height,0,0,width,height);}}class dK extends AC{var hL,lL;var sL,GM;dK( i, g, h, j){hL=i.toDouble();lL=g.toDouble();sL=h.toDouble();GM=j.toDouble();}BB( g){g.rect(hL,lL,sL,GM);}WC( g){g.DD(hL,lL);g.XC(hL,lL);g.XC(hL+sL,lL);g.XC(hL+sL,lL+GM);g.XC(hL,lL+GM);}}abstract class CJ extends AC{var fQ;var gQ;var hQ;CJ( h, i, g){fQ=h.toDouble();gQ=i;hQ=g;} XB( g, h, i){g.lineWidth=fQ;g.lineJoin=gQ;g.lineCap=hQ;try {return g.isPointInStroke(h,i);}catch (j){return false;}}WC( g){g.stroke(fQ);}}class eK extends CJ{var iQ;eK( g, i, j, h):super(i,j,h){iQ=g;}BB( g){g.strokeStyle=iQ;g.lineWidth=fQ;g.lineJoin=gQ;g.lineCap=hQ;g.stroke();}}abstract class DJ extends AC{ XB( g, h, i){return g.isPointInPath(h,i);}WC( g){g.fill();}}class fK extends DJ{var iQ;fK( g){iQ=g;}BB( g){g.fillStyle=iQ;g.fill();}}//@ sourceMappingURL=stagexl_web.dart.map
