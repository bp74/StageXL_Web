import "dart:json" as eG;import "dart:html" as QB;import "dart:math" as YB;import "dart:web_audio" as IF;import "dart:async" as VB;class mJ{static const  nJ="Chrome";static const  oJ="Firefox";static const  pJ="Internet Explorer";static const  qJ="Safari";final  wI;final  minimumVersion;const mJ(this.wI,[this.minimumVersion]);}class rJ{final  name;const rJ(this.name);}class yJ extends XB{final  GL=[{'name':'DropShadowFilter (black)','filter':new IK(10,YB.PI/4,CC.YD,0.8,8,8)},{'name':'GlowFilter (red)','filter':new GK(CC.AG,1.0,20,20)},{'name':'ColorMatrixFilter (grayscale)','filter':new MK.AL()},{'name':'ColorMatrixFilter (invert)','filter':new MK.BL()},{'name':'BlurFilter (radius 1)','filter':new FK(1,1)},{'name':'BlurFilter (radius 5)','filter':new FK(5,5)},{'name':'BlurFilter (radius 10)','filter':new FK(10,10)},{'name':'BlurFilter (radius 20)','filter':new FK(20,20)}];yJ(){var m=new IB(940,500,true,0x000000);var k=RB.RC('king');var o=new IB(230,245,true,0xFFF0F0F0);var p=new UD(m);DB(p);for(int h=0;h<GL.length;h++ ){var i=235*(h%4);var j=250*(h~/4);var q=GL[h]['filter'] as sB;var t=GL[h]['name'] as String;var v=new CB(0,0,k.width,k.height);var n=new EB(i+40,j+45);m.vI(k,v,n,q);var l=new UD(o);l.x=i;l.y=j;dE(l,0);var g=new JK();g.QC=new vD('Helvetica Neue, Helvetica, Arial',14,CC.YD);g.x=i+5;g.y=j+5;g.width=200;g.text=t;DB(g);}}}class vJ extends XB{final  FL=new YB.Random();vJ(){var g=new VD();g.hB=470;g.qB=250;g.x=470;g.y=250;DB(g);for(int h=0;h<150;h++ ){var w=1+FL.nextInt(3);var p=RB.RC('flower${w}');var i=new UD(p);i.hB=64;i.qB=64;i.x=64+FL.nextInt(940-128);i.y=64+FL.nextInt(500-128);g.DB(i);var o=new aD(i,600,s.mC);o.GC('rotation',YB.PI*60.0);OB.add(o);}var k=new List<EB>();for(int h=0;h<6;h++ ){var n=(h*60)*YB.PI/180;var m=(h*60+30)*YB.PI/180;k.add(new EB(470+200*YB.cos(n),250+200*YB.sin(n)));k.add(new EB(470+100*YB.cos(m),250+100*YB.sin(m)));}var t=new AD.tK(100,100,740,300);var v=new AD.vK(470,250,200);var q=new AD.xK(k);QB.query('#mask-none').onClick.listen((j)=>g.mask=null);QB.query('#mask-rectangle').onClick.listen((j)=>g.mask=t);QB.query('#mask-circle').onClick.listen((j)=>g.mask=v);QB.query('#mask-custom').onClick.listen((j)=>g.mask=q);QB.query('#mask-spin').onClick.listen((j){var l=new aD(g,2.0,s.BG);l.GC('rotation',YB.PI*4.0);l.onComplete=()=>g.tC=0.0;OB.add(l);});}}class xJ extends XB{var FL=new YB.Random();var IL;var JL;xJ(){IL=RB.kE('walkTextureAtlas');JL=IL.HJ('walk');ML();}ML(){var h=FL.nextDouble();var g=new pG(JL,30);g.x=-128;g.y=20.0+180.0*h;g.iB=g.jB=0.5+0.5*h;g.play();DB(g);iJ((k,j)=>(k.y-j.y).toInt());var i=new aD(g,5.0+(1.0-h)*5.0,s.mC);i.GC('x',940.0);i.onComplete=(){OB.remove(g);WG(g);};OB.add(g);OB.add(i);OB.FG(ML,0.2);}}class tJ extends XB{final  HL=['C4','A3','A3','C4','D4','G3','G3','A3','A3#','F4','F4','E4','C4','D4','C4','A3#','A3','C4','D4','D4','D4','G4','F4','E4','F4','D4','C4','F3','G3','A3','D4','C4','C4','A3#','A3','E3','F3'];final  LL=['Hey ','Jude, ',"don't ",'make ','it ','bad.<br>','Take ','a ','sad ','song ','and ','make ','it ','better.<br>','','','','Remember ','','','to ','let ','her ','into ','','your ','heart.<br>','Than ','you ','can ','start ','','to ','make ','things ','better.','',' '];tJ(){var h=new UD(RB.RC('Background'));DB(h);var g=new fG(HL,LL);g.x=120;g.y=30;DB(g);QB.query('#startOver').onClick.listen((i)=>g.gJ());}}class sJ extends XB{final  text='Filet mignon leberkas pig pork chop biltong, short loin strip steak turkey brisket ' 'venison. Pastrami venison pancetta, leberkas pork chop chicken prosciutto beef ribs ' 'bresaola kielbasa swine biltong capicola. Hamburger beef ribs ball tip drumstick salami ' 'pig. Capicola pork loin shank, salami chicken hamburger tail. Sirloin spare ribs ' 'ground round cow strip steak prosciutto swine bacon corned beef.';sJ(){var j=new JK();j.QC=new vD('Helvetica,Arial',14,CC.OI,bold:true,italic:true);j.text=text;j.x=10;j.y=10;j.width=920;j.height=20;DB(j);var h=new JK();h.QC=new vD('Helvetica,Arial',16,CC.AG);h.text=text;h.x=10;h.y=50;h.width=200;h.height=300;h.wordWrap=true;DB(h);var g=new JK();g.QC=new vD('Helvetica,Arial',16,CC.gH,align:YC.gF);g.text=text;g.x=300;g.y=50;g.width=200;g.height=300;g.wordWrap=true;DB(g);var i=new JK();i.QC=new vD('Caesar Dressing',30,CC.YD,align:YC.AE);i.text=text;i.x=590;i.y=50;i.width=340;i.height=300;i.wordWrap=true;DB(i);}}class uJ extends XB{uJ(){var g=new JK();g.QC=new vD('Helvetica,Arial',14,CC.DI,bold:true);g.text='ToDo: show a cool demo ...';g.x=10;g.y=10;g.width=920;g.height=20;DB(g);}}class BK extends XB{BK(){var k=RB.JJ('flump');var i=new QK(k,'idle');i.x=500;i.y=200;DB(i);var j=new QK(k,'walk');j.x=150;j.y=460;DB(j);var g=new QK(k,'attack');g.x=450;g.y=460;DB(g);var h=new QK(k,'defeat');h.x=720;h.y=460;DB(h);OB.add(i);OB.add(j);OB.add(g);OB.add(h);IB.NE('images/flumpLibraryAtlas0.png').then((m){var l=new UD(m);l.x=40;l.y=40;DB(l);});}}class AK extends XB{var IL;AK(){IL=RB.kE('levelUp');KL();IB.NE('images/LevelupTextureAtlas.png').then((h){var g=new UD(h);g.x=70;g.y=40;DB(g);});}KL(){var l=330;for(int j=0;j<7;j++ ){var h=IL.RC('LevelUp${j}');var g=new UD(h);g.hB=h.width/2;g.qB=h.height/2;g.x=l+h.width/2;g.y=150;g.iB=0.0;g.jB=0.0;DB(g);var k=new aD(g,2.0,s.bD);k.GC('scaleX',1.0);k.GC('scaleY',1.0);k.EG=j*0.05;var i=new aD(g,0.4,s.mC);i.GC('scaleX',0.0);i.GC('scaleY',0.0);i.EG=2.0;i.onComplete=()=>g.rE();OB.add(k);OB.add(i);l=l+5+h.width;}OB.FG(()=>KL(),3.0);}}class zJ{final  EL=[{"name":"linear","transition":s.mC},{"name":"sine","transition":s.rF},{"name":"cosine","transition":s.zH},{"name":"random","transition":s.BI},{"name":"easeInQuadratic","transition":s.HE},{"name":"easeOutQuadratic","transition":s.IE},{"name":"easeInOutQuadratic","transition":s.II},{"name":"easeOutInQuadratic","transition":s.KI},{"name":"easeInCubic","transition":s.JE},{"name":"easeOutCubic","transition":s.KE},{"name":"easeInOutCubic","transition":s.yF},{"name":"easeOutInCubic","transition":s.NI},{"name":"easeInQuartic","transition":s.LE},{"name":"easeOutQuartic","transition":s.ME},{"name":"easeInOutQuartic","transition":s.RI},{"name":"easeOutInQuartic","transition":s.SI},{"name":"easeInQuintic","transition":s.OE},{"name":"easeOutQuintic","transition":s.PE},{"name":"easeInOutQuintic","transition":s.UI},{"name":"easeOutInQuintic","transition":s.VI},{"name":"easeInCircular","transition":s.QE},{"name":"easeOutCircular","transition":s.RE},{"name":"easeInOutCircular","transition":s.YI},{"name":"easeOutInCircular","transition":s.ZI},{"name":"easeInSine","transition":s.SE},{"name":"easeOutSine","transition":s.TE},{"name":"easeInOutSine","transition":s.dI},{"name":"easeOutInSine","transition":s.eI},{"name":"easeInExponential","transition":s.VE},{"name":"easeOutExponential","transition":s.WE},{"name":"easeInOutExponential","transition":s.gI},{"name":"easeOutInExponential","transition":s.iI},{"name":"easeInBack","transition":s.XE},{"name":"easeOutBack","transition":s.YE},{"name":"easeInOutBack","transition":s.BG},{"name":"easeOutInBack","transition":s.jI},{"name":"easeInElastic","transition":s.ZE},{"name":"easeOutElastic","transition":s.bD},{"name":"easeInOutElastic","transition":s.lI},{"name":"easeOutInElastic","transition":s.mI},{"name":"easeInBounce","transition":s.aE},{"name":"easeOutBounce","transition":s.cD},{"name":"easeInOutBounce","transition":s.nI},{"name":"easeOutInBounce","transition":s.oI}]; NJ(){var j=new QB.DivElement();for(int h=0;h<EL.length/4;h++ ){var i=new QB.DivElement();i.classes.add("row");j.children.add(i);for(int g=0;g<4;g++ ){var m=EL[h*4+g]["name"];var l=EL[h*4+g]["transition"];var k=XL(m,l);k.id="cell";i.children.add(k);}}return j;} XL( o, q( ratio)){var h=new QB.DivElement();h.classes.add("span3");h.style.height="130px";var j=new QB.CanvasElement(width:200,height:140);j.style.position="absolute";j.style.zIndex="1";h.children.add(j);var i=new QB.DivElement();i.text=o;i.style.position="relative";i.style.zIndex="2";i.style.top="6px";h.children.add(i);var l=new nC("stage",j);var n=new HK();var g=n.LG;g.beginPath();g.moveTo(0.5,30.5);g.lineTo(199.5,30.5);g.lineTo(199.5,109.5);g.lineTo(0.5,109.5);g.closePath();g.bG(0xFF000000);g.CJ(0xFFDFDFDF);g.beginPath();g.moveTo(0.5,109.5);for(int k=0;k<=199;k++ ){var m=k/199.0;var p=0.5+m*199.0;var t=109.5-79.0*q(m);g.lineTo(p,t);}g.bG(0xFF0000FF,2);l.DB(n);l.NG(0,0);return h;}}class wJ extends UD implements dB{var qD,rD;wJ( g,this.qD,this.rD):super(g){this.hB=g.width/2;this.qB=g.height/2;} oB( i){var g=x+qD*i;var h=y+rD*i;if(g>910||g<30)qD=-qD;else x=g;if(h>470||h<30)rD=-rD;else y=h;return true;}}var rB;var sD;var OB;var RB;class CK extends XB{CK(){NL(250);QB.query('#minus10').onClick.listen((g)=>OL(10));QB.query('#minus50').onClick.listen((g)=>OL(50));QB.query('#plus50').onClick.listen((g)=>NL(50));QB.query('#plus10').onClick.listen((g)=>NL(10));this.UJ.listen(PL);}var QL=null;PL( g){if(QL==null){QL=1.00/g.TG;}else{QL=0.05/g.TG+0.95*QL;}QB.query('#fpsMeter').innerHtml='fps: ${QL.round()}';}NL( l){var g=new YB.Random();var i=RB.kE('flags');var j=i.EJ;while ( --l>=0){var k=j[g.nextInt(j.length)];var m=i.RC(k);var h=new wJ(m,g.nextInt(200)-100,g.nextInt(200)-100);h.x=30+g.nextInt(940-60);h.y=30+g.nextInt(500-60);DB(h);OB.add(h);}QB.query('#flagCounter').innerHtml='Flags: ${pE}';}OL( h){while ( --h>=0&&pE>0){var g=IJ(0);g.rE();OB.remove(g);}QB.query('#flagCounter').innerHtml='Flags: ${pE}';}} main(){var l=QB.window.location.pathname;var m=new RegExp(r"([A-Za-z0-9-]+)\.html",multiLine:false,caseSensitive:false);var g=m.firstMatch(l);if(g!=null&&g.groupCount==1){var h=g.group(1);print("current page: ${h}");var i=QB.query("#stage");if(i!=null){rB=new nC('stage',i);sD=new wD();sD.uI(rB);OB=sD.oE;RB=new JF();}switch (h){case "filter":RB..tB('king','images/king.png')..load().then((SL)=>rB.DB(new yJ()));break;case "masking":RB..tB('flower1','images/Flower1.png')..tB('flower2','images/Flower2.png')..tB('flower3','images/Flower3.png')..load().then((SL)=>rB.DB(new vJ()));break;case "flipbook":RB..eE('walkTextureAtlas','images/walk.json',zC.XD)..load().then((SL)=>rB.DB(new xJ()));break;case "performance":RB..eE('flags','images/flags.json',zC.XD)..load().then((SL)=>rB.DB(new CK()));break;case "sound":RB..tB('KeyBlack','images/piano/KeyBlack.png')..tB('KeyWhite0','images/piano/KeyWhite0.png')..tB('KeyWhite1','images/piano/KeyWhite1.png')..tB('KeyWhite2','images/piano/KeyWhite2.png')..tB('KeyWhite3','images/piano/KeyWhite3.png')..tB('Finger','images/piano/Finger.png')..tB('Background','images/piano/Background.jpg')..KB('Cheer','sounds/Cheer.mp3')..KB('Note1','sounds/piano/Note1.mp3')..KB('Note2','sounds/piano/Note2.mp3')..KB('Note3','sounds/piano/Note3.mp3')..KB('Note4','sounds/piano/Note4.mp3')..KB('Note5','sounds/piano/Note5.mp3')..KB('Note6','sounds/piano/Note6.mp3')..KB('Note7','sounds/piano/Note7.mp3')..KB('Note8','sounds/piano/Note8.mp3')..KB('Note9','sounds/piano/Note9.mp3')..KB('Note10','sounds/piano/Note10.mp3')..KB('Note11','sounds/piano/Note11.mp3')..KB('Note12','sounds/piano/Note12.mp3')..KB('Note13','sounds/piano/Note13.mp3')..KB('Note14','sounds/piano/Note14.mp3')..KB('Note15','sounds/piano/Note15.mp3')..KB('Note16','sounds/piano/Note16.mp3')..KB('Note17','sounds/piano/Note17.mp3')..KB('Note18','sounds/piano/Note18.mp3')..KB('Note19','sounds/piano/Note19.mp3')..KB('Note20','sounds/piano/Note20.mp3')..KB('Note21','sounds/piano/Note21.mp3')..KB('Note22','sounds/piano/Note22.mp3')..KB('Note23','sounds/piano/Note23.mp3')..KB('Note24','sounds/piano/Note24.mp3')..KB('Note25','sounds/piano/Note25.mp3')..load().then((SL)=>rB.DB(new tJ()));break;case "text":rB.DB(new sJ());break;case "tweener":rB.DB(new uJ());break;case "flump":RB..tI('flump','images/flumpLibrary.json')..load().then((SL)=>rB.DB(new BK()));break;case "texturepacker":RB..eE('levelUp','images/LevelupTextureAtlas.json',zC.XD)..load().then((SL)=>rB.DB(new AK()));break;case "transitions":var k=new zJ();var j=k.NJ();QB.query("#transitions").children.add(j);break;}}}class fG extends XB{final  vC;final  uC;final  RL=['C3','C3#','D3','D3#','E3','F3','F3#','G3','G3#','A3','A3#','B3','C4','C4#','D4','D4#','E4','F4','F4#','G4','G4#','A4','A4#','B4','C5'];var TL=new Map<String,gG>();var UL;var VL=0;fG(this.vC,this.uC){for(int h=0,i=0;h<RL.length;h++ ){var k=RB.KG('Note${h+1}');var j=RL[h];var g=TL[j]=new gG(this,j,k);if(j.endsWith('#')){g.x=i-16;g.y=35;DB(g);}else{g.x=i;g.y=35;dE(g,0);i=i+47;}}UL=new UD(RB.RC('Finger'));UL.hB=20;DB(UL);WL();}xI( g){if(VL<vC.length&&vC[VL]==g){if(VL==vC.length-1)RB.KG('Cheer').play();VL++ ;WL();}}gJ(){VL=0;UL.alpha=1;WL();}WL(){var h=QB.query('#lyrics');var m=-1;h.innerHtml='';for(int g=0,j=0;g<uC.length;g++ ){if(uC[g]!='')j=g;if(g==this.VL)m=j;}for(int g=0;g<uC.length;g++ ){if(g==m){h.appendHtml('<span id="word">${uC[g]}</span>');}else{h.appendHtml(uC[g]);}}if(VL<vC.length){var k=vC[VL];if(TL.containsKey(k)){var i=TL[k];OB.eJ(UL);UL.y=0;var n=new aD(this.UL,0.4,s.yF);var l=new aD(this.UL,0.4,s.rF);n.GC('x',i.x+i.width/2);l.GC('y',-10);OB.add(n);OB.add(l);}}else{var o=new aD(UL,0.4,s.mC);o.GC('alpha',0);OB.add(o);}}}class gG extends VD{final  UG;final  gB;final  aG;gG(this.UG,this.gB,this.aG){var h;if(gB.endsWith('#')){h='KeyBlack';}else if(gB.startsWith('C5')){h='KeyWhite0';}else if(gB.startsWith('C')||gB.startsWith('F')){h='KeyWhite1';}else if(gB.startsWith('D')||gB.startsWith('G')||gB.startsWith('A')){h='KeyWhite2';}else if(gB.startsWith('E')||gB.startsWith('B')){h='KeyWhite3';}var i=RB.RC(h);var l=new UD(i);this.DB(l);var j=gB.endsWith('#')?CC.kI:CC.YD;var k=new vD('Helvetica,Arial',10,j,align:YC.AE);var g=new JK();g.QC=k;g.text=gB;g.width=i.width;g.height=20;g.RG=false;g.y=i.height-20;DB(g);this.yE=true;this.onMouseDown.listen(YL);this.onMouseOver.listen(YL);this.onMouseUp.listen(ZL);this.onMouseOut.listen(ZL);}YL( g){if(g.LC){this.aG.play();this.alpha=0.7;this.UG.xI(this.gB);}}ZL( g){this.alpha=1.0;}}const DK=const EK();class EK{const EK();}class hG{static const  pF="none";}class ED{static const  tG="exactFit";static const  DH="noBorder";static const  MH="noScale";static const  dF="showAll";}class KK extends WC{var uL;var LM;KK( i, h, g){uL=h;LM=g;}set lD( g){LM=g;} stop(){}}abstract class zB{BB( g); WB( g, h, i){BB(g);return false;}TC( g){}}class UD extends u{var bitmapData;var pixelSnapping;var bC;UD([this.bitmapData=null,this.pixelSnapping="auto"]){bC=null;} pB( h,[ returnRectangle]){var g=(bitmapData!=null)?bitmapData.width:0;var i=(bitmapData!=null)?bitmapData.height:0;return UE(h,g,i,returnRectangle);} WB( g, h){if(bitmapData!=null&&g>=0.0&&h>=0.0&&g<bitmapData.width&&h<bitmapData.height)return this;return null;} BB( g){if(bitmapData==null)return;if(bC==null){bitmapData.BB(g);}else{bitmapData.XG(g,bC);}}}class VD extends XB{var cK=false;var yE=false;var mE=null;var vL=null;var AN=null; get LG{return (vL!=null)?vL:vL=new CD();}wO(){var i=this.jD;var j=this.iC;var m=this.visible;if(i!=null&&this.iC!=null){var h=VC.QH;if(h!=null){var g=GP.pD(i);if(g.x<h.left)g.x=h.left;if(g.x>h.right)g.x=h.right;if(g.y<h.top)g.y=h.top;if(g.y>h.bottom)g.y=h.bottom;i=GP.CG().pD(g);}var l=new EB(qN,tN).add(i).subtract(VC.NH);var k=GP.pD(l);this.visible=false;AN=j.WB(j.SJ,j.TJ);this.x=k.x;this.y=k.y;this.visible=m;}} pB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new CB.uK();super.pB(g,returnRectangle);if(vL!=null){returnRectangle=vL.jN(g).union(returnRectangle);}return returnRectangle;} WB( i, j){var h=null;if(this.mE!=null){var g=this.cG(this.mE);if(g!=null){var k=i*g.a+j*g.c+g.kB;var l=i*g.b+j*g.d+g.lB;if(this.mE.WB(k,l)!=null){h=this;}}}else{h=super.WB(i,j);if(h==null&&vL!=null){if(vL.NO(i,j)){h=this;}}}return h;}BB( g){if(vL!=null)vL.BB(g);super.BB(g);}}class CD{static final  nH=new QB.CanvasElement(width:16,height:16);static final  rH=nH.context2d;final  YO=new List<zB>();var bO=new CB.uK();var hO=true;clear(){YO.clear();hO=true;}pO( g){YO.add(g);hO=true;}beginPath()=>pO(new RK());closePath()=>pO(new SK());moveTo( h, g)=>pO(new TK(h,g));lineTo( h, g)=>pO(new UK(h,g));arc( l, g, j, i, h, k)=>pO(new VK(l,g,j,i,h,k));rect( i, g, h, j)=>pO(new WK(i,g,h,j));bG( g,[ width=1, joints=kG.zG, caps=mG.zG])=>pO(new XK(FE(g),width,joints,caps));CJ( g)=>pO(new YK(FE(g))); jN( i){var h=new OC(i);for(int g=0;g<YO.length;g++ ){YO[g].TC(h);}return h.MJ();} NO( h, i){if(hO){hO=false;bO=jN(new GB.zK());}if(bO.contains(h,i)){var j=CD.rH;j.beginPath();for(int g=0;g<YO.length;g++ ){if(YO[g].WB(j,h,i)){return true;}}}return false;} BB( i){var g=i.context;g.save();g.beginPath();for(int h=0;h<YO.length;h++ ){YO[h].BB(g);}g.restore();}}abstract class nB{static  NE( g){var h=xC.cH;if(h=="WebAudioApi")return uD.NE(g);if(h=="AudioElement")return tD.NE(g);return PF.NE(g);} get length; play([ loop=false, soundTransform]);static  tF( g){var m=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var i=m.firstMatch(g);var h=xC.mF;if(i==null)throw new ArgumentError("Unsupported file extension.");if(h.length==0)throw new UnsupportedError("This browser supports no known audio codec.");var j=i.group(1).toLowerCase();if(h.indexOf(j)==-1){var l=g.substring(0,g.length-j.length);var k=h[0];g="${l}${k}";}return g;}}abstract class WC extends KC{ set lD( g); stop();}class qG{var ID;var gD;var height;var leading;var width;var x;qG(this.x,this.width,this.height,this.ID,this.gD,this.leading);}class JK extends LB{var rL="";var GM=0x000000;var ZM=null;var qM=hG.pF;var IN=nG.BH;var UN=iG.uG;var aN=false;var gN=false;var kN=0x000000;var oN=false;var rN=0x000000;var xN=0;var AO=0;var DO;var IO;var LO=true;var PO=100;var QO=100;var UO=null;var qL=null;JK([ text, textFormat]){if(text!=null)rL=text;if(textFormat!=null)QC=textFormat;else ZM=new vD("Arial",12,0x000000);DO=new List<String>();IO=new List<qG>();} get text=>rL; get type=>UN; get width=>PO; get height=>QO; set text( g){rL=g;LO=true;} set QC( g){ZM=g;GM=ZM.color;LO=true;} set wordWrap( g){aN=g;LO=true;} set width( g){PO=g;LO=true;} set height( g){QO=g;LO=true;} pB( g,[ returnRectangle]){return UE(g,PO,QO,returnRectangle);} WB( g, h){if(g>=0&&h>=0&&g<PO&&h<QO)return this;return null;} BB( g){FQ();g.qL.drawImage(UO,0.0,0.0);} HQ( o){var n=IH(o);DO.clear();IO.clear();if(aN==false){for(String h in rL.replaceAll('\r','').split('\n'))DO.add(h);}else{for(String h in rL.replaceAll('\r','').split('\n')){var g='';for(String j in h.split(' ')){var m=g;g=(g.length==0)?j:g+' '+j;if(qL.measureText(g).width>PO){if(m.length==0){DO.add(g);g='';}else{DO.add(m);g=j;}}}if(g.isEmpty==false){DO.add(g);}}}xN=0;AO=0;for(String g in DO){var k=qL.measureText(g);var l=0;if(ZM.align==YC.AE||ZM.align==YC.JH)l=(PO-k.width)/2;if(ZM.align==YC.gF||ZM.align==YC.CH)l=PO-k.width;var i=new qG(l,k.width,ZM.size,n.ID,n.gD,0);IO.add(i);xN=YB.max(xN,i.width);AO=AO+i.height;}} FQ(){if(LO){LO=false;var h=PO.ceil().toInt();var i=QO.ceil().toInt();if(UO==null){UO=new QB.CanvasElement(width:h,height:i);qL=UO.context2d;}if(UO.width!=h)UO.width=h;if(UO.height!=i)UO.height=i;var m=new StringBuffer()..write(ZM.italic?"italic ":"normal ")..write("normal ")..write(ZM.bold?"bold ":"normal ")..write("${ZM.size}px ")..write("${ZM.font},sans-serif");var j=m.toString();qL.font=j;qL.textAlign="start";qL.textBaseline="alphabetic";qL.fillStyle=GD(GM);HQ(j);if(gN){qL.fillStyle=GD(kN);qL.fillRect(0,0,PO,QO);}else{qL.clearRect(0,0,PO,QO);}var k=ZM.size;for(int g=0;g<DO.length;g++ ){var l=IO[g];qL.fillStyle=GD(GM);qL.fillText(DO[g],l.x,k);k+= l.height;}if(oN){qL.strokeStyle=GD(rN);qL.lineWidth=1;qL.strokeRect(0,0,PO,QO);}}}}class tD extends nB{var wL;var OM;var jM;tD(){jM=new List<SD>();wL=new QB.AudioElement();wL.onEnded.listen(fN);OM=new List<QB.AudioElement>();OM.add(wL);QB.document.body.children.add(wL);}static  NE( o){var k=new tD();var g=k.wL;var i=new VB.Completer<nB>();var h;var j;n(m){h.cancel();j.cancel();i.complete(k);}l(m){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(n);j=g.onError.listen(l);g.src=nB.tF(o);g.load();return i.future;} get length{return wL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new bB();return new SD(this,loop,soundTransform);} vN( h){var g;if(OM.length==0){g=wL.clone(true);g.onEnded.listen(fN);}else{g=OM.removeAt(0);}jM.add(h);return g;} AP( g){var h=g.wL;var i=jM.indexOf(g);jM.removeAt(i);OM.add(h);if(wL.currentTime>0&&wL.ended==false)wL.currentTime=0;} fN( j){var i=j.target;var g=null;for(int h=0;h<jM.length&&g==null;h++ )if(jM[h].wL==i)g=jM[h];if(g!=null)g.stop();}}class SD extends WC{var KM;var wL;var uL;var LM;SD( g, i, h){KM=g;uL=i;LM=h;wL=g.vN(this);wL.loop=uL;this.lD=h;wL.play();} set lD( g){LM=g;if(wL!=null)wL.volume=(LM!=null)?LM.volume:1;} stop(){if(wL!=null){if(wL.ended==false)wL.pause();KM.AP(this);wL=null;}}}class vD{var font;var size;var color;var bold;var italic;var underline;var align;var leftMargin;var rightMargin;var indent;var leading;var letterSpacing=0;var aK=0;var bK=false;var mK=false;vD(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.leftMargin: 0,this.rightMargin: 0,this.indent: 0,this.leading: 0});}class LK extends WC{var IM;var LM;var uL;var uM;var HN;LK( j, h, i){IM=j;uL=h;LM=i;var g=xC.ZD;uM=g.createGain();uM.connect(g.destination,0,0);uM.gain.value=(LM!=null)?YB.pow(LM.volume,2):1;HN=g.createBufferSource();HN.buffer=IM.sL;HN.loop=h;HN.connect(uM,0,0);HN.start(0);} set lD( g){LM=g;uM.gain.value=(LM!=null)?YB.pow(LM.volume,2):1;} stop(){HN.stop(0);}}class PF extends nB{PF(){}static  NE( g){return new VB.Future<nB>.of(()=>new PF());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new bB();}return new KK(this,loop,soundTransform);}}class JF{var DM;JF(){DM=new Map<String,TD>();} bN( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(DM.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");DM[i]=g;} TO( i, g){var h="${i}.${g}";if(DM.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return DM[h];} tB( i, h){var g=new TD("BitmapData",i,h);g.WO(IB.NE(h));bN(g);} KB( i, h){var g=new TD("Sound",i,h);g.WO(nB.NE(h));bN(g);} eE( j, h, i){var g=new TD("TextureAtlas",j,h);g.WO(BC.NE(h,i));bN(g);} tI( i, h){var g=new TD("FlumpLibrary",i,h);g.WO(EC.NE(h));bN(g);} load(){var h=this.ZJ.map((i)=>i.SM);return VB.Future.wait(h).then((j){var g=this.BJ;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get ZJ{return DM.values.where((g)=>g.MD==null).toList();} get BJ{return DM.values.where((g)=>g.error!=null).toList();} RC( g){return TO("BitmapData",g).MD;} KG( g){return TO("Sound",g).MD;} kE( g){return TO("TextureAtlas",g).MD;} JJ( g){return TO("FlumpLibrary",g).MD;}}class TD{var jL;var yL;var JM;var SM;var cM;var iM;TD( g, h, i){jL=g;yL=h;JM=i;cM=null;iM=null;} get kind=>jL; get name=>yL; get MD=>iM; get error=>cM;WO( i){SM=i.then((g){iM=g;cM=null;},onError:( h){iM=null;cM=h.error;});}}class bB{var volume;var pan;var nK=1;var oK=0;var rK=1;var qK=0;bB([this.volume=1,this.pan=0]);}class BC{final  kL=new QB.ImageElement();final  dM=new List<KF>();static  NE( n, v){var k=new VB.Completer<BC>();var g=new BC();switch (v){case zC.vG:case zC.XD:QB.HttpRequest.getString(n).then((t){var o=eG.parse(t);var h=o["frames"];var p=o["meta"];if(h is List){for(var q in h){var j=q as Map;var i=j["filename"] as String;var l=xF(i);var m=new KF.yK(g,l,j);g.dM.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=xF(i);var m=new KF.yK(g,l,j);g.dM.add(m);}}g.kL..onLoad.listen((w)=>k.complete(g))..onError.listen((w)=>k.completeError(new StateError("Failed to load image.")))..src=zF(n,p["image"]);}).catchError((FB){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} get iD=>kL; RC( h){for(int g=0;g<dM.length;g++ )if(dM[g].name==h)return new IB.DL(dM[g]);throw new ArgumentError("TextureAtlasFrame not found: '${h}'");} HJ( i){var h=new List<IB>();for(int g=0;g<dM.length;g++ )if(dM[g].name.startsWith(i))h.add(new IB.DL(dM[g]));return h;} get EJ{return dM.map((g)=>g.name).toList(growable:false);}}class KF{final  nL;final  yL;final  UM;final  gM;final  tM;final  BN;final  LN;final  SN;final  XN;final  ZN;final  eN;KF.yK( i, h, g):nL=i,yL=h,UM=vH(g["rotated"]),gM=PC(g["sourceSize"]["w"]),tM=PC(g["sourceSize"]["h"]),BN=PC(g["spriteSourceSize"]["x"]),LN=PC(g["spriteSourceSize"]["y"]),SN=PC(g["frame"]["x"]),XN=PC(g["frame"]["y"]),ZN=PC(g["frame"]["w"]),eN=PC(g["frame"]["h"]); get jJ=>nL; get name=>yL; get hJ=>UM; get FJ=>SN; get GJ=>XN; get JG=>ZN; get IG=>eN; get offsetX=>BN; get offsetY=>LN; get YJ=>gM; get XJ=>tM;}class oG<FD>{final  hL=new List<FD>();final  MM;var XM=0;oG( g()):MM=g; aJ(){if(XM==0){return MM();}else{XM-- ;return hL[XM];}}bJ( g){if(XM==hL.length){hL.add(g);}else{hL[XM]=g;}XM++ ;}reset(){hL.clear();XM=0;}}class xC{static var cH=wH();static var ZD=HI();static var mF=JI();static  wH(){var h=(ZD!=null)?"WebAudioApi":"AudioElement";var g=QB.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(mF.length==0)h="Mock";print("StageXL: supported audio engine is: ${h}");return h;}static  HI(){if(IF.AudioContext.supported)return new IF.AudioContext();return null;}static  JI(){var g=new List<String>();var h=new QB.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("StageXL: supported audio types are: ${g}");return g;}}class pG extends LB implements dB{var QM;var YM;var hM;var sM;var yM;var uL;var JN;var PN;var bC;pG( g,[ frameRate=30, loop=true]){QM=g;YM=frameRate;hM=0;sM=null;yM=false;uL=loop;JN=new HB(HB.uF);PN=new HB(HB.xH);bC=null;}static const  CI=const cB<HB>(HB.uF); get onProgress=>pG.CI.forTarget(this); get wE=>QM.length; set loop( g){uL=g;} play(){yM=true;sM=null;} stop(){yM=false;sM=null;} oB( j){if(yM==false)return true;if(sM==null){sM=0.0;yO(JN,this,this,AC.ZC);}else{sM+= j;var i=1.0/YM;while (yM&&sM>=i){var h=hM;var g=uL?(h+1)%wE:YB.min(h+1,wE-1);hM=g;sM-= i;if(h!=g){yO(JN,this,this,AC.ZC);if(hM!=g)return true;}if(h!=g&&g==wE-1&&uL==false){yO(PN,this,this,AC.ZC);if(hM!=g)return true;}}}return true;} pB( h,[ returnRectangle]){var g=QM[hM];return UE(h,g.width,g.height,returnRectangle);} WB( g, h){var i=QM[hM];if(g>=0&&h>=0&&g<i.width&&h<i.height)return this;return null;} BB( g){var h=QM[hM];if(bC==null)h.BB(g);else h.XG(g,bC);}}class LF{static const  pF="none";static const  KH="touchPoint";}class lC{static const  sG=0;static const  yG=1;static const  gF=2;static const  LH=3;static const  cF=4;}class kG{static const  zG="round";}class jG extends LB{jG();}class CC{static const  YD=0xFF000000;static const  gH=0xFF0000FF;static const  DI=0xFFA9A9A9;static const  OI=0xFF008000;static const  AG=0xFFFF0000;static const  kI=0xFFFFFFFF;}class YC{static const  AE="center";static const  CH="end";static const  JH="justify";static const  gF="right";}abstract class XB extends LB{final  TM=new List<u>();var pM=true;var zM=true; get pE=>TM.length; DB( g){if(g.parent==this){var h=TM.indexOf(g);TM.removeAt(h);TM.add(g);}else{dE(g,TM.length);}} dE( g, h){if(h<0||h>TM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){TM.removeAt(TM.indexOf(g));if(h>TM.length)h-- ;TM.insert(h,g);}else{g.rE();g.OP(this);TM.insert(h,g);g.dispatchEvent(new HB(HB.xG,true));if(this.iC!=null)XP(g,new HB(HB.GH));}} WG( h){var g=TM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");cJ(g);} cJ( g){if(g<0||g>=TM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=TM[g];h.dispatchEvent(new HB(HB.RH,true));if(this.iC!=null)XP(h,new HB(HB.VH));h.OP(null);TM.removeAt(g);} IJ( g){if(g<0||g>=TM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return TM[g];} iJ( g){TM.sort(g);} contains( g){for(;g!=null;g=g.XO)if(g==this)return true;return false;} pB( n,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new CB.uK();if(TM.length==0)return super.pB(n,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var o=TM.length;for(int l=0;l<TM.length;l++ ){var m=TM[l];ZO.DG(m.GP,n);var g=m.pB(ZO,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} WB( o, p){var l=null;for(int j=TM.length-1;j>=0;j-- ){var i=TM[j];if(i.visible){var g=i.GP;var m=o-g.kB;var k=p-g.lB;var q=(g.d*m-g.c*k)/g.cC;var n=(g.a*k-g.b*m)/g.cC;var h=i.WB(q,n);if(h!=null){if(h is LB)if(h.RG)return pM?h:this;l=this;}}}return l;} BB( i){for(int h=0;h<TM.length;h++ ){var g=TM[h];if(!g.OO&&g.visible)i.YG(g);}} XP( g, j){g.dispatchEvent(j);if(g is XB){var i=new List<u>.from(g.TM,growable:false);for(int h=0;h<i.length;h++ )XP(i[h],j);}}}class nG{static const  BH="pixel";}class VC{static var QF=mB.zD;static var AH=false;static var XF=null;static var NH=null;static var QH=null;static var XH=new VB.StreamController<String>();static var eH=XH.stream.asBroadcastStream();static  wF( i){var h=i;var g="auto";if(QF!=mB.zD){h=QF;}switch (h){case mB.zD:g="auto";break;case mB.CE:g="default";break;case mB.DE:g="pointer";break;case mB.OH:g="move";break;case mB.PH:g="text";break;case mB.SH:g="wait";break;}if(AH){g="none";}return g;}}class mB{static const  zD="auto";static const  CE="arrow";static const  DE="button";static const  OH="hand";static const  PH="ibeam";static const  SH="wait";}class iG{static const  uG="dynamic";}abstract class LB extends u{var zI=false;var RG=true;var sK=true;var tabIndex=0;static const  TH=const cB<AB>(AB.jF);static const  fH=const cB<AB>(AB.kF);static const  lH=const cB<AB>(AB.iF);static const  qH=const cB<AB>(AB.YF);static const  AI=const cB<AB>(AB.fF);static const  MI=const cB<AB>(AB.lF); get onMouseOut=>LB.TH.forTarget(this); get onMouseOver=>LB.fH.forTarget(this); get onMouseMove=>LB.lH.forTarget(this); get onMouseDown=>LB.qH.forTarget(this); get onMouseUp=>LB.AI.forTarget(this); get onMouseWheel=>LB.MI.forTarget(this);static const  XI=const cB<TB>(TB.hF);static const  aI=const cB<TB>(TB.WF);static const  cI=const cB<TB>(TB.aF); get onTouchMove=>LB.XI.forTarget(this); get onTouchEnd=>LB.aI.forTarget(this); get onTouchCancel=>LB.cI.forTarget(this);static const  fI=const cB<DC>(DC.VF);static const  hI=const cB<DC>(DC.BE); get onKeyUp=>LB.fI.forTarget(this); get onKeyDown=>LB.hI.forTarget(this);}final  yD=new Map<String,oF>();class zC{static const  vG="json";static const  XD="jsonarray";}final  RF=new oG<List<u>>(()=>new List<u>());class AC{static const  SF=1;static const  ZC=2;static const  HH=3;}class GK extends sB{var color;var alpha;var blurX;var blurY;var strength;var inner;var knockout;var hideObject;GK([this.color=0,this.alpha=1.0,this.blurX=4,this.blurY=4,this.strength=2.0,this.inner=false,this.knockout=false,this.hideObject=false]){if(blurX<1||blurY<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(blurX>128||blurY>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} clone(){return new GK(color,alpha,blurX,blurY,strength,inner,knockout,hideObject);} apply( zE, m, AF, FB){var uB=zE.xO();var BF=uB.getImageData(m.x,m.y,m.width,m.height);var CF=BF.data;var p=m.width;var ZB=m.height;var kC=blurX*blurX;var JC=blurY*blurY;var DF=(1<<22)~/kC;var EF=(1<<22)~/JC;var n=blurX;var jC=blurX*2;var JB=blurY;var IC=blurY*2;var NB=p+jC;var UB=ZB+IC;var FF=p*4;var aB=NB*4;var PB=aC?3:0;var w=AF.xO();var vB=w.createImageData(NB,UB);var h=vB.data;var k=new List<int>(1024);for(int i=0;i<p;i++ ){var l=0,t=JC>>1;var v=i*4+PB;var o=(i+n)*4+PB;for(int j=0;j<UB;j++ ){h[o]=(t*EF)>>22;o+= aB;if(j>=IC){l-= 2*k[j&1023]-k[(j-JB)&1023];}else if(j>=JB){l-= 2*k[j&1023];}var q=(j<ZB)?CF[v]:0;k[(j+JB)&1023]=q;t+= l+= q;v+= FF;}}for(int j=0;j<UB;j++ ){var l=0,t=kC>>1;var v=j*aB+n*4+PB;var o=j*aB+PB;for(int i=0;i<NB;i++ ){h[o]=(t*DF)>>22;o+= 4;if(i>=jC){l-= 2*k[i&1023]-k[(i-n)&1023];}else if(i>=n){l-= 2*k[i&1023];}var q=(i<p)?h[v]:0;k[(i+n)&1023]=q;t+= l+= q;v+= 4;}}var xB=(alpha*256).toInt();var PD=(color>>16)&0xFF;var QD=(color>>8)&0xFF;var wB=(color>>0)&0xFF;if(aC){for(var g=0;g<=h.length-4;g+= 4){h[g+0]=PD;h[g+1]=QD;h[g+2]=wB;h[g+3]=(h[g+3]*xB)>>8;}}else{for(var g=0;g<=h.length-4;g+= 4){h[g+0]=(h[g+0]*xB)>>8;h[g+1]=wB;h[g+2]=QD;h[g+3]=PD;}}var MC=FB.x;var yB=FB.y;var NC=FB.x-n;var RD=FB.y-JB;var GF=new CB(MC,yB,p,ZB);var HF=new CB(NC,RD,NB,UB);var MB=GF.union(HF);w.setTransform(1,0,0,1,0,0);w.clearRect(MB.x,MB.y,MB.width,MB.height);w.putImageData(vB,NC,RD);if(this.hideObject==false)w.drawImage(uB.canvas,MC,yB);}}class IK extends sB{var distance;var angle;var color;var alpha;var blurX;var blurY;var strength;var inner;var knockout;var hideObject;IK([this.distance=4.0,this.angle=YB.PI/4,this.color=0,this.alpha=1.0,this.blurX=4,this.blurY=4,this.strength=1.0,this.inner=false,this.knockout=false,this.hideObject=false]){if(blurX<1||blurY<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(blurX>128||blurY>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} clone(){return new IK(distance,angle,color,alpha,blurX,blurY,strength,inner,knockout,hideObject);} apply( zE, m, AF, FB){var uB=zE.xO();var BF=uB.getImageData(m.x,m.y,m.width,m.height);var CF=BF.data;var p=m.width;var ZB=m.height;var kC=blurX*blurX;var JC=blurY*blurY;var DF=(1<<22)~/kC;var EF=(1<<22)~/JC;var n=blurX;var jC=blurX*2;var JB=blurY;var IC=blurY*2;var NB=p+jC;var UB=ZB+IC;var FF=p*4;var aB=NB*4;var PB=aC?3:0;var w=AF.xO();var vB=w.createImageData(NB,UB);var h=vB.data;var k=new List<int>(1024);for(int i=0;i<p;i++ ){var l=0,t=JC>>1;var v=i*4+PB;var o=(i+n)*4+PB;for(int j=0;j<UB;j++ ){h[o]=(t*EF)>>22;o+= aB;if(j>=IC){l-= 2*k[j&1023]-k[(j-JB)&1023];}else if(j>=JB){l-= 2*k[j&1023];}var q=(j<ZB)?CF[v]:0;k[(j+JB)&1023]=q;t+= l+= q;v+= FF;}}for(int j=0;j<UB;j++ ){var l=0,t=kC>>1;var v=j*aB+n*4+PB;var o=j*aB+PB;for(int i=0;i<NB;i++ ){h[o]=(t*DF)>>22;o+= 4;if(i>=jC){l-= 2*k[i&1023]-k[(i-n)&1023];}else if(i>=n){l-= 2*k[i&1023];}var q=(i<p)?h[v]:0;k[(i+n)&1023]=q;t+= l+= q;v+= 4;}}var xB=(alpha*256).toInt();var PD=(color>>16)&0xFF;var QD=(color>>8)&0xFF;var wB=(color>>0)&0xFF;if(aC){for(var g=0;g<=h.length-4;g+= 4){h[g+0]=PD;h[g+1]=QD;h[g+2]=wB;h[g+3]=(h[g+3]*xB)>>8;}}else{for(var g=0;g<=h.length-4;g+= 4){h[g+0]=(h[g+0]*xB)>>8;h[g+1]=wB;h[g+2]=QD;h[g+3]=PD;}}var MC=FB.x;var yB=FB.y;var NC=FB.x-n+(this.distance*YB.cos(this.angle)).round().toInt();var RD=FB.y-JB+(this.distance*YB.sin(this.angle)).round().toInt();var GF=new CB(MC,yB,p,ZB);var HF=new CB(NC,RD,NB,UB);var MB=GF.union(HF);w.setTransform(1,0,0,1,0,0);w.clearRect(MB.x,MB.y,MB.width,MB.height);w.putImageData(vB,NC,RD);if(this.hideObject==false)w.drawImage(uB.canvas,MC,yB);}}class MK extends sB{final  EM;MK( h):EM=new List<num>(20){if(h.length!=20)throw new ArgumentError("The supplied matrix needs to be a 4 x 5 matrix.");for(int g=0;g<h.length;g++ )EM[g]=h[g];}MK.AL():EM=[0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0.212671,0.715160,0.072169,0,0,0,0,0,1,0];MK.BL():EM=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]; clone(){return new MK(EM);} apply( MC, m, NC, IC){var q=MC.xO().getImageData(m.x,m.y,m.width,m.height);var h=q.data;var uB=(EM[00]*65536).toInt();var PB=(EM[01]*65536).toInt();var JC=(EM[02]*65536).toInt();var p=(EM[03]*65536).toInt();var vB=(EM[04]*65536).toInt();var xB=(EM[05]*65536).toInt();var UB=(EM[06]*65536).toInt();var yB=(EM[07]*65536).toInt();var w=(EM[08]*65536).toInt();var n=(EM[09]*65536).toInt();var t=(EM[10]*65536).toInt();var v=(EM[11]*65536).toInt();var ZB=(EM[12]*65536).toInt();var wB=(EM[13]*65536).toInt();var JB=(EM[14]*65536).toInt();var FB=(EM[15]*65536).toInt();var aB=(EM[16]*65536).toInt();var MB=(EM[17]*65536).toInt();var o=(EM[18]*65536).toInt();var NB=(EM[19]*65536).toInt();if(aC){for(int g=0;g<=h.length-4;g+= 4){var k=h[g+0];var l=h[g+1];var j=h[g+2];var i=h[g+3];h[g+0]=((uB*k)+(PB*l)+(JC*j)+(p*i)+vB)>>16;h[g+1]=((xB*k)+(UB*l)+(yB*j)+(w*i)+n)>>16;h[g+2]=((t*k)+(v*l)+(ZB*j)+(wB*i)+JB)>>16;h[g+3]=((FB*k)+(aB*l)+(MB*j)+(o*i)+NB)>>16;}}else{for(int g=0;g<=h.length-4;g+= 4){var i=h[g+0];var j=h[g+1];var l=h[g+2];var k=h[g+3];h[g+0]=((FB*k)+(aB*l)+(MB*j)+(o*i)+NB)>>16;h[g+1]=((t*k)+(v*l)+(ZB*j)+(wB*i)+JB)>>16;h[g+2]=((xB*k)+(UB*l)+(yB*j)+(w*i)+n)>>16;h[g+3]=((uB*k)+(PB*l)+(JC*j)+(p*i)+vB)>>16;}}NC.xO().putImageData(q,IC.x,IC.y);}}class FK extends sB{var blurX;var blurY;FK([this.blurX=4,this.blurY=4]){if(blurX<1||blurY<1)throw new ArgumentError("Error #9004: The minimum blur size is 1.");if(blurX>128||blurY>128)throw new ArgumentError("Error #9004: The maximum blur size is 128.");} clone(){return new FK(blurX,blurY);} apply( jC, q, MC, uB){var NC=jC.xO();var MB=NC.getImageData(q.x,q.y,q.width,q.height);var vB=MB.data;var w=MB.width;var ZB=MB.height;var aB=blurX*blurX;var wB=blurY*blurY;var IC=(1<<22)~/aB;var kC=(1<<22)~/wB;var l=blurX;var xB=blurX*2;var v=blurY;var yB=blurY*2;var NB=w+xB;var FB=ZB+yB;var JC=w*4;var JB=NB*4;var UB=MC.xO();var PB=UB.createImageData(NB,FB);var t=PB.data;var j=new List<int>(1024);TI(vB);for(int i=0;i<4;i++ ){for(int h=0;h<w;h++ ){var k=0,m=wB>>1;var n=h*4+i;var o=(h+l)*4+i;for(int g=0;g<FB;g++ ){t[o]=(m*kC)>>22;o+= JB;if(g>=yB){k-= 2*j[g&1023]-j[(g-v)&1023];}else if(g>=v){k-= 2*j[g&1023];}var p=(g<ZB)?vB[n]:0;j[(g+v)&1023]=p;m+= k+= p;n+= JC;}}}for(int i=0;i<4;i++ ){for(int g=0;g<FB;g++ ){var k=0,m=aB>>1;var n=g*JB+l*4+i;var o=g*JB+i;for(int h=0;h<NB;h++ ){t[o]=(m*IC)>>22;o+= 4;if(h>=xB){k-= 2*j[h&1023]-j[(h-l)&1023];}else if(h>=l){k-= 2*j[h&1023];}var p=(h<w)?t[n]:0;j[(h+l)&1023]=p;m+= k+= p;n+= 4;}}}WI(t);UB.putImageData(PB,uB.x-l,uB.y-v);}}abstract class sB{ clone(); apply( h, i, j, g);}class TB extends HB{static const  TF="touchBegin";static const  WF="touchEnd";static const  aF="touchCancel";static const  hF="touchMove";static const  WH="touchOver";static const  aH="touchOut";var aO;var dO;var fO,gO;var iO,kO;var lN;var yN;var mN;var pN;var oO;var qO;var rO;TB( g,[ bubbles=false]):super(g,bubbles){RO(g,bubbles);} RO( g,[ bubbles=false]){super.RO(g,bubbles);aO=0;dO=false;fO=gO=0;iO=kO=0;lN=false;yN=false;mN=false;pN=false;oO=1.00;qO=0;rO=0;}set HP( g){fO=g.x;gO=g.y;}set MP( g){iO=g.x;kO=g.y;} get oD=>aO; get altKey=>lN; get ctrlKey=>mN; get shiftKey=>pN;}class MF extends HB{static const  EH="textInput";var rL="";MF( g,[ bubbles=false]):super(g,bubbles); get text=>rL;}class DC extends HB{static const  BE="keyDown";static const  VF="keyUp";var lN;var mN;var pN;var sN;var yN;var CO;var FO;var HO;DC( g,[ bubbles=false]):super(g,bubbles){RO(g,bubbles);} RO( g,[ bubbles=false]){super.RO(g,bubbles);lN=false;mN=false;pN=false;sN=false;yN=false;CO=0;FO=0;HO=0;} get altKey=>lN; get ctrlKey=>mN; get shiftKey=>pN; get charCode=>CO; get keyCode=>FO; get keyLocation=>HO;}class AB extends HB{static const  UF="click";static const  FH="doubleClick";static const  YF="mouseDown";static const  fF="mouseUp";static const  iF="mouseMove";static const  jF="mouseOut";static const  kF="mouseOver";static const  lF="mouseWheel";static const  nF="middleClick";static const  kH="middleMouseDown";static const  pH="middleMouseUp";static const  qF="rightClick";static const  uH="rightMouseDown";static const  yH="rightMouseUp";var fO,gO;var iO,kO;var zO;var lN;var yN;var mN;var pN;var DP;var EP;var FP;AB( g,[ bubbles=false]):super(g,bubbles){RO(g,bubbles);} RO( g,[ bubbles=false]){super.RO(g,bubbles);fO=gO=0;iO=kO=0;zO=false;lN=false;yN=false;mN=false;pN=false;DP=0;EP=0;FP=0;}set HP( g){fO=g.x;gO=g.y;}set MP( g){iO=g.x;kO=g.y;} get LC=>zO; get altKey=>lN; get ctrlKey=>mN; get shiftKey=>pN; get JD=>DP; get deltaX=>EP; get deltaY=>FP;}class DD<FD extends HB> extends VB.Stream<FD>{final  NM;final  BM;final  kM;final  DN=new List<wG>();var WN=0;DD(this.NM,this.BM,this.kM); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new wG<FD>(this,h);if(WN==DN.length)DN.add(g);else DN[WN]=g;WN++ ;if(BM==HB.EE&&kM==false)WD.eF.nN(this);return g;} KO( h){for(int g=0;g<WN;g++ ){if(DN[g]==h){DN[g]=null;break;}}} jO( k){var j=WN;var h=0;for(int g=0;g<j;g++ ){var i=DN[g];if(i==null)continue;i.GN(k);if(h!=g){DN[h]=i;DN[g]=null;}h++ ;}if(h!=j){for(int g=j;g<WN;g++ ){DN[h++ ]=DN[g];DN[g]=null;}WN=h;}}}class HK extends u{final  vL=new CD(); get LG=>vL; pB( g,[ returnRectangle]){return vL.jN(g);} WB( g, h){return vL.NO(g,h)?this:null;} BB( g){vL.BB(g);}}class BD extends HB{var mL;BD( g):super(HB.EE,false){mL=g;} get TG=>mL; get fE=>false;}class cB<FD extends HB>{final  BM;const cB(this.BM); forTarget( g,{ useCapture: false}){return g.NN(BM,useCapture);}}class SB{final  qL;final  PM=new List<GB>(100);final  oM=new List<double>(100);var CN=0;var HM=0.0;var RN=0.0;SB.wK( j,[ matrix]):qL=j{for(int h=0;h<100;h++ ){PM[h]=new GB.zK();oM[h]=1.0;}if(matrix!=null)PM[0].fD(matrix);var g=PM[0];var i=oM[0];qL.setTransform(g.a,g.b,g.c,g.d,g.kB,g.lB);qL.globalAlpha=i;} get context=>qL; get currentTime=>HM; reset([ matrix, currentTime, deltaTime]){if(matrix!=null)PM[0].fD(matrix);CN=0;HM=?currentTime?currentTime:0.0;RN=?deltaTime?deltaTime:0.0;var g=PM[0];var h=oM[0];qL.setTransform(g.a,g.b,g.c,g.d,g.kB,g.lB);qL.globalAlpha=h;qL.clearRect(0,0,qL.canvas.width,qL.canvas.height);} YG( i){var k=CN;var l=CN+1;var m=PM[k];var h=PM[l];var p=oM[k];var o=oM[l]=i.JO*p;var g=m;var j=i.SO;var n=i.VO;CN=l;h.DG(i.GP,m);if(j!=null){if(j.nD==null){g=h;}else if(identical(j.nD,i)){g=h;}else if(identical(j.nD,i.parent)){g=m;}else{g=j.nD.cG(i);if(g==null)g=ZF;else g.concat(h);}qL.save();qL.setTransform(g.a,g.b,g.c,g.d,g.kB,g.lB);j.BB(this);}qL.setTransform(h.a,h.b,h.c,h.d,h.kB,h.lB);qL.globalAlpha=o;if(n!=null){n.BB(this);}else{i.BB(this);}if(j!=null){qL.restore();}CN=k;}}class NF implements dB{final  xL;var HM=0.0;var VM=0.0;var fM=1;NF( g, h):xL=g{VM=YB.max(h,0.0001);} oB( h){var g=HM+h;while (g>=VM&&fM>0){HM=VM;fM-- ;xL();g-= VM;}HM=g;return (fM>0);} get currentTime=>HM;}abstract class dB{ oB( g);}class yC implements dB{final  CM=new List<dB>();var aM=0;var mM=0.0; add( g){if(g==null)return;if(this.contains(g))return;if(aM==CM.length){CM.add(g);}else{CM[aM]=g;}aM++ ;} remove( h){if(h==null)return;for(int g=0;g<aM;g++ ){if(identical(CM[g],h)){CM[g]=null;break;}}} contains( h){if(h==null)return false;for(int g=0;g<aM;g++ ){if(identical(CM[g],h)){return true;}}return false;} eJ( i){if(i==null)return;for(int g=0;g<aM;g++ ){var h=CM[g];if(h!=null&&h is aD){if(identical(h.yI,i)){CM[g]=null;}}}} xE( h, i,[ transitionFunction]){var g=new aD(h,i,transitionFunction);add(g);return g;} FG( h, i){var g=new NF(h,i);add(g);return g;} oB( k){mM+= k;var j=aM;var h=0;for(int g=0;g<j;g++ ){var i=CM[g];if(i==null)continue;if(i.oB(k)==false){CM[g]=null;continue;}if(h!=g){CM[h]=i;CM[g]=null;}h++ ;}if(h!=j){for(int g=j;g<aM;g++ ){CM[h++ ]=CM[g];CM[g]=null;}aM=h;}return true;}}class mG{static const  zG="round";}class OF{final  xE;OF(this.xE);call( h, g){rM(h).kJ(g);} get x=>rM("x"); get y=>rM("y"); get iB=>rM("scaleX"); get jB=>rM("scaleY"); get skewX=>rM("skewX"); get skewY=>rM("skewY"); get hB=>rM("pivotX"); get qB=>rM("pivotY"); get tC=>rM("rotation"); get alpha=>rM("alpha"); rM( h){var g=new fB(h);this.xE.rM(g);return g;}}class WD<FD extends HB>{final  pL=new List<DD>();var eM=0;static var eF=new WD<BD>(); nN( g){for(int h=0;h<eM;h++ ){if(pL[h]==g)return;}if(eM==pL.length){pL.add(g);}else{pL[eM]=g;}eM++ ;} jO( j){j.mO=AC.ZC;j.nO=false;j.sO=false;var k=eM;var i=0;for(int g=0;g<k;g++ ){var h=pL[g];if(h==null)continue;if(h.WN==0){pL[g]=null;continue;}j.NM=h.NM;j.vO=h.NM;h.jO(j);if(i!=g){pL[i]=h;pL[g]=null;}i++ ;}if(i!=k){for(int g=k;g<eM;g++ ){pL[i++ ]=pL[g];pL[g]=null;}eM=i;}}}class KC{var pL; PJ( g){if(pL!=null)return pL.containsKey(g)||pL.containsKey("${g}_CAPTURE");else return false;} dispatchEvent( g){yO(g,this,this,AC.ZC);} yO( g, k, l, i){if(pL!=null){var j=(i==AC.SF)?"${g.type}_CAPTURE":g.type;var h=pL[j];if(h!=null){g.NM=k;g.vO=l;g.mO=i;g.nO=false;g.sO=false;h.jO(g);}}} NN( g, j){if(pL==null){pL=new Map<String,DD>();}var i=j?"${g}_CAPTURE":g;var h=pL[i];if(h==null)h=pL[i]=new DD(this,g,j);return h;}}class EB{var aL;var eL;EB( h, g):aL=h,eL=g;EB.uK():this(0,0); clone()=>new EB(aL,eL); toString()=>"Point [x=${aL}, y=${eL}]"; get x=>aL; get y=>eL; get length=>YB.sqrt(aL*aL+eL*eL);set x( g){aL=g;}set y( g){eL=g;} add( g){return new EB(aL+g.x,eL+g.y);} subtract( g){return new EB(aL-g.x,eL-g.y);}fD( g){aL=g.x;eL=g.y;} HG( g){return aL==g.x&&eL==g.y;}}class CB{var aL;var eL;var lL;var zL;CB( i, g, h, j):aL=i,eL=g,lL=h,zL=j;CB.uK():this(0,0,0,0); clone()=>new CB(aL,eL,lL,zL); toString()=>"Rectangle [x=${aL}, y=${eL}, width=${lL}, height=${zL}]"; get x=>aL; get y=>eL; get width=>lL; get height=>zL; get left=>aL; get top=>eL; get right=>aL+lL; get bottom=>eL+zL; get size=>new EB(lL,zL);set x( g){aL=g;}set y( g){eL=g;}set width( g){lL=g;}set height( g){zL=g;}set top( g){eL=g;} contains( g, h){return aL<=g&&eL<=h&&aL+lL>=g&&eL+zL>=h;} HG( g){return aL==g.x&&eL==g.y&&lL==g.width&&zL==g.height;} get isEmpty{return lL==0&&zL==0;}fD( g){aL=g.x;eL=g.y;lL=g.width;zL=g.height;} union( g){var i=YB.min(this.left,g.left);var h=YB.min(this.top,g.top);var j=YB.max(this.right,g.right);var k=YB.max(this.bottom,g.bottom);return new CB(i,h,j-i,k-h);}}class lG{var x;var y;var VG;lG(this.x,this.y,this.VG);}class GB{var bL,cL,fL,gL,iL,oL;var AM;GB( h, i, g, j, k, l):bL=h.toDouble(),cL=i.toDouble(),fL=g.toDouble(),gL=j.toDouble(),iL=k.toDouble(),oL=l.toDouble(),AM=(h*j-i*g).toDouble();GB.zK():bL=1.0,cL=0.0,fL=0.0,gL=1.0,iL=0.0,oL=0.0,AM=1.0; clone(){return new GB(bL,cL,fL,gL,iL,oL);} CG(){var h=(gL/AM);var i=-(cL/AM);var g=-(fL/AM);var j=(bL/AM);var k=-(h*iL+g*oL);var l=-(i*iL+j*oL);return new GB(h,i,g,j,k,l);} get a=>bL; get b=>cL; get c=>fL; get d=>gL; get kB=>iL; get lB=>oL; get cC=>AM; pD( h){var i=h.x.toDouble();var g=h.y.toDouble();return new EB(i*bL+g*fL+iL,i*cL+g*gL+oL);} RP( h){var i=h.x.toDouble();var g=h.y.toDouble();return new EB(i*bL+g*fL+iL,i*cL+g*gL+oL);} concat( g){var m=bL;var p=cL;var q=fL;var o=gL;var l=iL;var n=oL;var v=AM;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var w=g.kB;var t=g.lB;var FB=g.cC;bL=(m*j+p*i).toDouble();cL=(m*k+p*h).toDouble();fL=(q*j+o*i).toDouble();gL=(q*k+o*h).toDouble();iL=(l*j+n*i+w).toDouble();oL=(l*k+n*h+t).toDouble();AM=(v*FB).toDouble();} QJ(){bL=1.0;cL=0.0;fL=0.0;gL=1.0;iL=0.0;oL=0.0;AM=1.0;} nE(){var j=bL;var m=cL;var l=fL;var k=gL;var h=iL;var i=oL;var g=AM;bL=(k/g).toDouble();cL=-(m/g).toDouble();fL=-(l/g).toDouble();gL=(j/g).toDouble();iL=-(bL*h+fL*i).toDouble();oL=-(cL*h+gL*i).toDouble();AM=(1.0/g).toDouble();} rotate( i){var g=YB.cos(i);var h=YB.sin(i);var j=bL;var n=cL;var m=fL;var l=gL;var k=iL;var o=oL;bL=(j*g-n*h).toDouble();cL=(j*h+n*g).toDouble();fL=(m*g-l*h).toDouble();gL=(m*h+l*g).toDouble();iL=(k*g-o*h).toDouble();oL=(k*h+o*g).toDouble();} ND( h, i, g, k, j, l){bL=h.toDouble();cL=i.toDouble();fL=g.toDouble();gL=k.toDouble();iL=j.toDouble();oL=l.toDouble();AM=(bL*gL-cL*fL).toDouble();} fD( g){bL=g.a.toDouble();cL=g.b.toDouble();fL=g.c.toDouble();gL=g.d.toDouble();iL=g.kB.toDouble();oL=g.lB.toDouble();AM=g.cC.toDouble();} DG( h, g){var n=h.a;var q=h.b;var t=h.c;var p=h.d;var m=h.kB;var o=h.lB;var w=h.cC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var FB=g.kB;var v=g.lB;var JB=g.cC;bL=(n*k+q*j).toDouble();cL=(n*l+q*i).toDouble();fL=(t*k+p*j).toDouble();gL=(t*l+p*i).toDouble();iL=(m*k+o*j+FB).toDouble();oL=(m*l+o*i+v).toDouble();AM=(w*JB).toDouble();}}class uD extends nB{var sL;uD(){if(xC.ZD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  NE( n){var h=new uD();var k=nB.tF(n);var g=new VB.Completer<nB>();QB.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var m=xC.ZD;m.decodeAudioData(j,( l){h.sL=l;g.complete(h);},(o){g.completeError(new StateError("Failed to decode audio."));});}).catchError((o){g.completeError(new StateError("Failed to load audio."));});return g.future;} get length{return sL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new bB();return new LK(this,loop,soundTransform);}}class wD{var dL;var tL;var FM;var WM;var nM;wD(){dL=new yC();tL=new List<nC>();FM=double.NAN;WM=WD.eF;nM=new BD(0);QB.window.requestAnimationFrame(wN);} get oE=>dL; wN( g){QB.window.requestAnimationFrame(wN);if(FM.isNaN)FM=g;if(FM>g)FM=g;var k=g-FM;var h=k/1000.0;var l=g/1000.0;if(k>=1){FM=g;nM.mL=h;WM.jO(nM);dL.oB(h);for(int i=0;i<tL.length;i++ ){var j=tL[i];j.oE.oB(h);j.NG(l,h);}}} uI( g){if(g.sE!=null){g.sE.dJ(g);}tL.add(g);g.TP=this;} dJ( g){if(g.sE==this){tL.remove(g);g.TP=null;}}}class AD{var nD=null;AD();factory AD.tK( i, g, h, j){return new NK(i,g,h,j);}factory AD.vK( i, g, h){return new OK(i,g,h);}factory AD.xK( g){return new PK(g);} BB( g){}}class HB{static const  xG="added";static const  GH="addedToStage";static const  EE="enterFrame";static const  RH="removed";static const  VH="removedFromStage";static const  bH="resize";static const  xH="complete";static const  uF="progress";var UN;var tO;var mO;var NM;var vO;var nO;var sO;HB( g,[ bubbles=false]){RO(g,bubbles);} RO( g,[ bubbles=false]){UN=g;tO=bubbles;mO=AC.ZC;NM=null;vO=null;nO=false;sO=false;} get mD=>nO; get type=>UN; get bubbles=>tO; get fE=>true; get target=>NM;}abstract class XC{ BB( g);}class IB implements XC{var lL;var zL;var RM;var bM;var lM;var wM;var EN;var MN;var TN;var VN;var YN;var cN;var iN;var qL;IB( h, i,[ transparent=true, fillColor=0xFFFFFFFF]){lL=h.toInt();zL=i.toInt();RM=transparent;bM=0;EN=TN=0;MN=VN=0;lM=YN=lL;wM=cN=zL;var g=new QB.CanvasElement(width:lL,height:zL);qL=g.context2d;qL.fillStyle=RM?FE(fillColor):GD(fillColor);qL.fillRect(0,0,lL,zL);iN=g;}IB.CL( g){if(g==null)throw new ArgumentError();lL=g.naturalWidth.toInt();zL=g.naturalHeight.toInt();RM=true;bM=0;EN=TN=0;MN=VN=0;lM=YN=lL;wM=cN=zL;iN=g;}IB.DL( g){lL=g.YJ.toInt();zL=g.XJ.toInt();RM=true;bM=g.hJ?2:1;EN=g.offsetX;MN=g.offsetY;lM=g.JG;wM=g.IG;TN=g.FJ;VN=g.GJ;YN=g.JG;cN=g.IG;iN=g.jJ.iD;}static  NE( i){var h=new VB.Completer<IB>();var g=new QB.ImageElement();g.onLoad.listen((j)=>h.complete(new IB.CL(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>lL; get height=>zL; clone(){var g=new IB(lL,zL,true,0);g.AJ(this);return g;} vI( i, j, g, h){h.apply(i,j,this,g);} AJ( h,[ matrix=null]){var g=xO();var i=new SB.wK(g,matrix);h.BB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} clear(){var g=xO();g.clearRect(0,0,lL,zL);} BB( h){var g=h.context;switch (bM){case 0:g.drawImage(iN,EN,MN);break;case 1:g.drawImageScaledFromSource(iN,TN,VN,YN,cN,EN,MN,lM,wM);break;case 2:g.transform(0.0,-1.0,1.0,0.0,EN,MN+wM);g.drawImageScaledFromSource(iN,TN,VN,cN,YN,0.0,0.0,wM,lM);break;}} XG( PB, g){var w=PB.context;if(g.width<=0.0||g.height<=0.0)return;switch (bM){case 0:w.drawImageScaledFromSource(iN,g.x-EN,g.y-MN,g.width,g.height,g.x+EN,g.y+MN,g.width,g.height);break;case 1:var j=TN;var h=VN;var p=j+YN;var q=h+cN;var l=TN-EN+g.x;var m=VN-MN+g.y;var v=l+g.width;var t=m+g.height;var o=(j>l)?j:l;var n=(h>m)?h:m;var FB=(p<v)?p:v;var NB=(q<t)?q:t;var k=FB-o;var i=NB-n;var MB=EN-j+o;var JB=MN-h+n;if(k>0.0&&i>0.0){w.drawImageScaledFromSource(iN,o,n,k,i,MB,JB,k,i);}break;case 2:var j=TN;var h=VN;var p=j+cN;var q=h+YN;var l=TN+MN-g.y+wM-g.height;var m=VN-EN+g.x;var v=l+g.height;var t=m+g.width;var o=(j>l)?j:l;var n=(h>m)?h:m;var FB=(p<v)?p:v;var NB=(q<t)?q:t;var k=NB-n;var i=FB-o;var MB=EN-h+n;var JB=MN+p-FB;if(k>0.0&&i>0.0){w.transform(0.0,-1.0,1.0,0.0,MB,JB+i);w.drawImageScaledFromSource(iN,o,n,i,k,0,0,i,k);}break;}} xO(){if(qL==null){var g=new QB.CanvasElement(width:lL,height:zL);qL=g.context2d;switch (bM){case 0:qL.drawImage(iN,EN,MN);break;case 1:qL.drawImageScaledFromSource(iN,TN,VN,YN,cN,EN,MN,lM,wM);break;case 2:qL.transform(0.0,-1.0,1.0,0.0,EN,MN+wM);qL.drawImageScaledFromSource(iN,TN,VN,cN,YN,0.0,0.0,wM,lM);qL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}bM=0;EN=TN=0;MN=VN=0;lM=YN=lL;wM=cN=zL;iN=g;}return qL;}}class eB{final  aL;final  eL;eB( h, g):aL=h.toDouble(),eL=g.toDouble(); clone()=>new eB(aL,eL); get x=>aL; get y=>eL; toString()=>"Vector [x=${aL}, y=${eL}]"; operator+( g)=>new eB(aL+g.aL,eL+g.eL); operator-( g)=>new eB(aL-g.aL,eL-g.eL); operator*( g)=>new eB(aL*g.aL,eL*g.eL); operator/( g)=>new eB(aL/g.aL,eL/g.eL); operator-()=>new eB(-aL,-eL); operator==( g)=>aL==g.aL&&eL==g.eL; get length=>YB.sqrt(aL*aL+eL*eL); distance( g){var i=aL-g.aL;var h=eL-g.eL;return YB.sqrt(i*i+h*h);} rotate( g){var i=YB.sin(g);var h=YB.cos(g);return new eB(aL*h-eL*i,aL*i+eL*h);}}typedef  xD( ratio);typedef  rG<FD extends HB>( event);class wG<FD extends HB> extends VB.StreamSubscription<FD>{var vM;var GN;var KN;var QN;wG(this.vM,this.GN){KN=0;QN=false;} cancel(){if(QN==false){vM.KO(this);QN=true;GN=null;}} onError( g( error)){} get uO=>KN>0; pause([ resumeSignal]){KN++ ;if(resumeSignal!=null){resumeSignal.whenComplete(resume);}} resume(){if(uO==false){throw new StateError("Subscription is not paused.");}KN-- ;}} GD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";} IH( g){if(yD.containsKey(g)==false){yD[g]=new oF(g);}return yD[g];}class EC{var JM;var xM;var YM;final  ON=new List<bE>();final  dN=new List<pI>();static  NE( l){var i=new VB.Completer<EC>();QB.HttpRequest.getString(l).then((p){var h=eG.parse(p) as Map;var j=new List();var g=new EC();g.JM=l;g.xM=h["md5"];g.YM=h["frameRate"].toInt();for(var m in h["movies"] as List){var n=new bE(m,g);g.ON.add(n);}for(var o in h["textureGroups"] as List){var k=new pI(o,g);g.dN.add(k);j.add(k.eD.future);}VB.Future.wait(j).then((t){i.complete(g);}).catchError((q){i.completeError(new StateError("Failed to load image."));});}).catchError((q){i.completeError(new StateError("Failed to load json file."));});return i.future;} IP( h){for(var g in ON)if(g.id==h)return g;throw new ArgumentError("The movie '${h}' is not available.");} VP( g){for(var h in dN){if(h.hD.containsKey(g)){return h.hD[g];}}for(var i in ON){if(i.id==g){return new QK(this,g);}}throw new ArgumentError("The symbol '${g}' is not available.");}}final  ZF=new GB.zK();class bF{static var iH=LF.pF;static var oH=new VB.StreamController<String>();static var sH=oH.stream.asBroadcastStream();static  get EI=>iH;}abstract class u extends KC implements XC{static var ZH=0;var hN=ZH++ ;var aL=0.0;var eL=0.0;var qN=0.0;var tN=0.0;var uN=1.0;var zN=1.0;var BO=0.0;var EO=0.0;var GO=0.0;var JO=1.0;var MO=true;var OO=false;var SO=null;var VO=null;var yL="";var XO=null;final  ZO=new GB.zK();final  eO=new GB.zK();var lO=true;static const  LI=const cB<BD>(HB.EE); get UJ=>u.LI.forTarget(this); get x=>aL; get y=>eL; get hB=>qN; get qB=>tN; get iB=>uN; get jB=>zN; get skewX=>BO; get skewY=>EO; get tC=>GO; get alpha=>JO; get visible=>MO; get name=>yL; get parent=>XO; get jD{var g=this.iC;return (g!=null)?this.SC(g.eP):null;} get SJ{var g=this.jD;return (g!=null)?g.x:0.0;} get TJ{var g=this.jD;return (g!=null)?g.y:0.0;} get root{var g=this;while (g.XO!=null)g=g.XO;return g;} get iC{var g=this.root;if(g is nC)return g;return null;}set x( g){aL=g.toDouble();lO=true;}set y( g){eL=g.toDouble();lO=true;}set hB( g){qN=g.toDouble();lO=true;}set qB( g){tN=g.toDouble();lO=true;}set iB( g){uN=g.toDouble();lO=true;}set jB( g){zN=g.toDouble();lO=true;}set skewX( g){BO=g.toDouble();lO=true;}set skewY( g){EO=g.toDouble();lO=true;}set tC( g){GO=g.toDouble();lO=true;}set alpha( g){JO=g.toDouble();lO=true;}set visible( g){MO=g;lO=true;}set mask( g){SO=g;} setTransform( h, g,[ scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY]){lO=true;aL=h.toDouble();eL=g.toDouble();if(scaleX!=null){uN=scaleX.toDouble();if(scaleY!=null){zN=scaleY.toDouble();if(rotation!=null){GO=rotation.toDouble();if(skewX!=null){BO=skewX.toDouble();if(skewY!=null){EO=skewY.toDouble();if(pivotX!=null){qN=pivotX.toDouble();if(pivotY!=null)tN=pivotY.toDouble();}}}}}}} get width=>pB(GP).width; get height=>pB(GP).height; set width( h){this.iB=1;var g=this.width;this.iB=(g!=0.0)?h/g:1.0;} set height( h){this.jB=1;var g=this.height;this.jB=(g!=0.0)?h/g:1.0;} rE(){if(XO!=null)XO.WG(this);} get GP{if(lO){lO=false;var j=BO+GO;var i=EO+GO;if(j==0.0&&i==0.0){eO.ND(uN,0.0,0.0,zN,aL-qN*uN,eL-tN*zN);}else{var g,l,k,h;var m=YB.cos(j);var n=YB.sin(j);if(j==i){g=uN*m;l=uN*n;k=-zN*n;h=zN*m;}else{g=uN*YB.cos(i);l=uN*YB.sin(i);k=-zN*n;h=zN*m;}var p=aL-(qN*g+tN*k);var o=eL-(qN*l+tN*h);eO.ND(g,l,k,h,p,o);}}return eO;} cG( h){if(h==XO)return GP.clone();if(h.XO==this)return h.GP.CG();var j=new GB.zK();var g=this;while (g!=h&&g.XO!=null){j.concat(g.GP);g=g.XO;}if(h==null&&g!=null){j.concat(g.GP);g=null;}if(g==h)return j;var k=new GB.zK();var i=h;while (i!=this&&i.XO!=null){k.concat(i.GP);i=i.XO;}k.nE();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} pB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new CB.uK();returnRectangle.x=g.kB;returnRectangle.y=g.lB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} WB( g, h){if(pB(ZF).contains(g,h))return this;return null;} SC( h){ZO.QJ();for(u g=this;g!=null;g=g.XO)ZO.concat(g.GP);ZO.nE();return ZO.pD(h);} dispatchEvent( h){var g=null;if(h.fE||h.bubbles)for(u j=XO;j!=null;j=j.XO)if(j.PJ(h.type)){if(g==null)g=RF.aJ() as List<u>;g.add(j);}if(h.fE&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.mD==false)g[i].yO(h,this,g[i],AC.SF);if(h.mD==false)yO(h,this,this,AC.ZC);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.mD==false)g[i].yO(h,this,g[i],AC.HH);if(g!=null){g.clear();RF.bJ(g);}} OP( h){for(var g=h;g!=null;g=g.XO)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");XO=h;} BB( g);}class FC{static const  UH="B";static const  YH="BL";static const  dH="BR";static const  yG="L";static const  gF="R";static const  hH="T";static const  jH="TL";static const  mH="TR";static const  pF="";} FE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class oF{var fontStyle;var ID=0;var gD=0;var height=0;oF( j){this.fontStyle=j;var h=new QB.Element.tag("span");h.style.font=this.fontStyle;h.text="Hg";var g=new QB.Element.tag("div");g.style.display="inline-block";g.style.width="1px";g.style.height="0px";var i=new QB.Element.tag("div");i.append(g);i.append(h);QB.document.body.append(i);try {g.style.verticalAlign="baseline";this.ID=g.offsetTop-h.offsetTop;g.style.verticalAlign="bottom";this.height=g.offsetTop-h.offsetTop;this.gD=height-ID;}catch (k){}finally {i.remove();}}}class OC{var matrix;var eC=double.INFINITY;var fC=double.NEGATIVE_INFINITY;var gC=double.INFINITY;var dC=double.NEGATIVE_INFINITY;var pC=double.INFINITY;var qC=double.NEGATIVE_INFINITY;var rC=double.INFINITY;var oC=double.NEGATIVE_INFINITY;var KD=double.NAN;var LD=double.NAN;OC(this.matrix); get lE=>!KD.isNaN&&!LD.isNaN; get MG=>!eC.isInfinite&&!fC.isInfinite&&!gC.isInfinite&&!dC.isInfinite; get OJ=>!pC.isInfinite&&!qC.isInfinite&&!rC.isInfinite&&!oC.isInfinite;fJ(){KD=LD=double.NAN;eC=gC=double.INFINITY;fC=dC=double.NEGATIVE_INFINITY;}wC( h, g){KD=h;LD=g;}UC( h, g,[ transformed=false]){if(lE){h=h.toDouble();g=g.toDouble();var i=transformed?h:h*matrix.a+g*matrix.c+matrix.kB;var j=transformed?g:h*matrix.b+g*matrix.d+matrix.lB;if(eC>i)eC=i;if(fC<i)fC=i;if(gC>j)gC=j;if(dC<j)dC=j;}}stroke( l){if(MG){var g=YB.sqrt(matrix.cC)*l/2;var h=eC-g;var i=fC+g;var j=gC-g;var k=dC+g;if(pC>h)pC=h;if(qC<i)qC=i;if(rC>j)rC=j;if(oC<k)oC=k;}}fill(){if(MG){if(pC>eC)pC=eC;if(qC<fC)qC=fC;if(rC>gC)rC=gC;if(oC<dC)oC=dC;}} MJ(){if(OJ){var g=pC.floor();var i=qC.ceil();var h=rC.floor();var j=oC.ceil();return new CB(g,h,i-g,j-h);}else{return new CB.uK();}}}class s{static var GE;static  mC( g){return g;}static  rF( g){return 0.5-0.5*YB.cos(g*2.0*YB.PI);}static  zH( g){return 0.5+0.5*YB.cos(g*2.0*YB.PI);}static  BI( g){if(GE==null)GE=new YB.Random();if(g==0.0||g==1.0)return g;return GE.nextDouble();}static  HE( g){return g*g;}static  IE( g){g=1.0-g;return 1.0-g*g;}static  II( g){g=g*2.0;return (g<1.0)?0.5*HE(g):0.5*IE(g-1.0)+0.5;}static  KI( g){g=g*2.0;return (g<1.0)?0.5*IE(g):0.5*HE(g-1.0)+0.5;}static  JE( g){return g*g*g;}static  KE( g){g=1.0-g;return 1.0-g*g*g;}static  yF( g){g=g*2.0;return (g<1.0)?0.5*JE(g):0.5*KE(g-1.0)+0.5;}static  NI( g){g=g*2.0;return (g<1.0)?0.5*KE(g):0.5*JE(g-1.0)+0.5;}static  LE( g){return g*g*g*g;}static  ME( g){g=1.0-g;return 1.0-g*g*g*g;}static  RI( g){g=g*2.0;return (g<1.0)?0.5*LE(g):0.5*ME(g-1.0)+0.5;}static  SI( g){g=g*2.0;return (g<1.0)?0.5*ME(g):0.5*LE(g-1.0)+0.5;}static  OE( g){return g*g*g*g*g;}static  PE( g){g=1.0-g;return 1.0-g*g*g*g*g;}static  UI( g){g=g*2.0;return (g<1.0)?0.5*OE(g):0.5*PE(g-1.0)+0.5;}static  VI( g){g=g*2.0;return (g<1.0)?0.5*PE(g):0.5*OE(g-1.0)+0.5;}static  QE( g){return 1.0-YB.sqrt(1.0-g*g);}static  RE( g){g=1.0-g;return YB.sqrt(1.0-g*g);}static  YI( g){g=g*2.0;return (g<1.0)?0.5*QE(g):0.5*RE(g-1.0)+0.5;}static  ZI( g){g=g*2.0;return (g<1.0)?0.5*RE(g):0.5*QE(g-1.0)+0.5;}static  SE( g){return 1.0-YB.cos(g*(YB.PI/2.0));}static  TE( g){return YB.sin(g*(YB.PI/2.0));}static  dI( g){g=g*2.0;return (g<1.0)?0.5*SE(g):0.5*TE(g-1.0)+0.5;}static  eI( g){g=g*2.0;return (g<1.0)?0.5*TE(g):0.5*SE(g-1.0)+0.5;}static  VE( g){if(g==0.0)return 0.0;return YB.pow(2.0,10.0*(g-1.0));}static  WE( g){if(g==1.0)return 1.0;return 1.0-YB.pow(2.0,-10.0*g);}static  gI( g){g=g*2.0;return (g<1.0)?0.5*VE(g):0.5*WE(g-1.0)+0.5;}static  iI( g){g=g*2.0;return (g<1.0)?0.5*WE(g):0.5*VE(g-1.0)+0.5;}static  XE( g){var h=1.70158;return g*g*((h+1.0)*g-h);}static  YE( g){var h=1.70158;g=g-1.0;return g*g*((h+1.0)*g+h)+1.0;}static  BG( g){g=g*2.0;return (g<1.0)?0.5*XE(g):0.5*YE(g-1.0)+0.5;}static  jI( g){g=g*2.0;return (g<1.0)?0.5*YE(g):0.5*XE(g-1.0)+0.5;}static  ZE( g){if(g==0.0||g==1.0)return g;g=g-1.0;return -YB.pow(2.0,10.0*g)*YB.sin((g-0.3/4.0)*(2.0*YB.PI)/0.3);}static  bD( g){if(g==0.0||g==1.0)return g;return YB.pow(2.0,-10.0*g)*YB.sin((g-0.3/4.0)*(2.0*YB.PI)/0.3)+1;}static  lI( g){g=g*2.0;return (g<1.0)?0.5*ZE(g):0.5*bD(g-1.0)+0.5;}static  mI( g){g=g*2.0;return (g<1.0)?0.5*bD(g):0.5*ZE(g-1.0)+0.5;}static  aE( g){return 1.0-cD(1.0-g);}static  cD( g){if(g<1/2.75){return 7.5625*g*g;}else if(g<2/2.75){g=g-1.5/2.75;return 7.5625*g*g+0.75;}else if(g<2.5/2.75){g=g-2.25/2.75;return 7.5625*g*g+0.9375;}else{g=g-2.625/2.75;return 7.5625*g*g+0.984375;}}static  nI( g){g=g*2.0;return (g<1.0)?0.5*aE(g):0.5*cD(g-1.0)+0.5;}static  oI( g){g=g*2.0;return (g<1.0)?0.5*cD(g):0.5*aE(g-1.0)+0.5;}}class HD{static const  zD="auto";static const  tH="stop";static const  sF="once";} vH( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}class NK extends AD{final  cO;NK( i, g, h, j):cO=new CB(i,g,h,j); BB( h){var g=h.context;g.beginPath();g.rect(cO.x,cO.y,cO.width,cO.height);g.clip();}}class vF{var target=null;var LC=false;var gE=0;var JD=0;var QG,SG;var OG,PG;vF(this.QG,this.SG,this.OG,this.PG);} PC( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class fB{final  qE;var tE=double.NAN;var vE=double.NAN;fB(this.qE); kJ( g){this.vE=g.toDouble();} get RJ=>!tE.isNaN&&!vE.isNaN; CP( g){switch (qE){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.hB;case 'pivotY':return g.qB;case 'scaleX':return g.iB;case 'scaleY':return g.jB;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.tC;case 'alpha':return g.alpha;default:return 0.0;}} WP( g, h){switch (qE){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.hB=h;break;case 'pivotY':g.qB=h;break;case 'scaleX':g.iB=h;break;case 'scaleY':g.jB=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.tC=h;break;case 'alpha':g.alpha=h;break;}}}class FI{static var GI=0;var oD=GI++ ;var target=null;var kD=false;FI(this.target,this.kD);}class OK extends AD{final  BP;OK( i, g, h):BP=new lG(i,g,h); BB( h){var g=h.context;g.beginPath();g.arc(BP.x,BP.y,BP.VG,0,YB.PI*2.0,false);g.clip();}}class nC extends XB{var UO;var qL;var JP,KP;var PO,QO;var NP,PP;var QP;var SP;var TP;var dL;var fK=30;var YP;var ZP;var aP;var bP;var cP;var dP;var eP;var fP;var gP;var hP;var iP;var jP;var kP;nC( h, g){yL=h;UO=g;UO.focus();qL=g.context2d;PO=JP=g.width;QO=KP=g.height;NP=g.clientWidth;PP=g.clientHeight;QP=new GB.zK();SP=new GB.zK();TP=null;dL=new yC();ZP=new SB.wK(qL);aP=HD.zD;bP=ED.dF;cP=FC.pF;gP=[new vF(AB.YF,AB.fF,AB.UF,AB.FH),new vF(AB.kH,AB.pH,AB.nF,AB.nF),new vF(AB.uH,AB.yH,AB.qF,AB.qF)];dP=mB.CE;fP=null;eP=new EB(0,0);iP=new AB(AB.UF,true);VC.eH.listen(eH);UO.onMouseDown.listen(BQ);UO.onMouseUp.listen(BQ);UO.onMouseMove.listen(BQ);UO.onMouseOut.listen(BQ);UO.onMouseWheel.listen(CQ);hP=new Map<int,FI>();kP=new TB(TB.TF,true);bF.sH.listen(DQ);DQ(null);jP=new DC(DC.BE,true);UO.onKeyDown.listen(EQ);UO.onKeyUp.listen(EQ);UO.onKeyPress.listen(GQ);} get sE=>TP; get oE=>dL; get jD=>eP; get focus=>YP; get align=>cP;IQ(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){IQ();}set y( g){IQ();}set hB( g){IQ();}set qB( g){IQ();}set iB( g){IQ();}set jB( g){IQ();}set skewX( g){IQ();}set skewY( g){IQ();}set tC( g){IQ();}set alpha( g){IQ();}set width( g){IQ();}set height( g){IQ();}NG( g, h){if(aP==HD.zD||aP==HD.sF){JQ();ZP.reset(SP,g,h);BB(ZP);if(aP==HD.sF)aP=HD.tH;}}JQ(){var m=UO.getBoundingClientRect();var n=UO.clientLeft+m.left;var o=UO.clientTop+m.top;var k=UO.clientWidth;var l=UO.clientHeight;if(k==0||l==0)return;var g=JP;var h=KP;var i=0;var j=0;switch (bP){case ED.tG:g=JP;h=KP;break;case ED.DH:if(k*KP>l*JP){h=(JP*l)~/k;}else{g=(KP*k)~/l;}break;case ED.MH:g=k;h=l;break;case ED.dF:if(k*KP>l*JP){g=(KP*k)~/l;}else{h=(JP*l)~/k;}break;}switch (cP){case FC.UH:i=(JP-g+1)~/2;j=(KP-h);break;case FC.YH:i=0;j=(KP-h);break;case FC.dH:i=(JP-g);j=(KP-h);break;case FC.yG:i=0;j=(KP-h+1)~/2;break;case FC.gF:i=(JP-g);j=(KP-h+1)~/2;break;case FC.hH:i=(JP-g+1)~/2;j=0;break;case FC.jH:i=0;j=0;break;case FC.mH:i=(JP-g+1);j=0;break;case FC.pF:i=(JP-g+1)~/2;j=(KP-h+1)~/2;break;}SP.ND(1.0,0.0,0.0,1.0,0-i,0-j);QP.ND(g/k,0.0,0.0,h/l,i-n,j-o);if(PO!=g||QO!=h){UO.width=PO=g;UO.height=QO=h;}if(NP!=k||PP!=l){NP=k;PP=l;dispatchEvent(new HB(HB.bH));}}eH( g){UO.style.cursor=VC.wF(dP);}BQ( j){j.preventDefault();var n=new DateTime.now().millisecondsSinceEpoch;var p=j.button;var h=null;var i=QP.RP(j.client);var m=null;if(p<0||p>2)return;if(j.type=="mousemove"&&eP.HG(i))return;var g=gP[p];eP=i;if(VC.XF!=null)VC.XF.wO();if(j.type!="mouseout")h=WB(i.x,i.y) as LB;var l=mB.CE;if(h is VD)if(h.yE)l=mB.DE;if(h is jG)if(h.yE)l=mB.DE;if(dP!=l){dP=l;UO.style.cursor=VC.wF(l);}if(fP!=null&&fP!=h){fP.dispatchEvent(iP..RO(AB.jF,true)..HP=(fP.iC!=null)?fP.SC(i):new EB.uK()..MP=i..zO=g.LC);fP=null;}if(h!=null&&h!=fP){h.dispatchEvent(iP..RO(AB.kF,true)..HP=h.SC(i)..MP=i..zO=g.LC);fP=h;}var k=null;var o=false;var q=false;if(j.type=="mousedown"){k=g.QG;if(h!=g.target||n>g.gE+500)g.JD=0;g.LC=true;g.target=h;g.gE=n;g.JD++ ;}if(j.type=="mouseup"){k=g.SG;g.LC=false;o=(g.target==h);q=o&&g.JD.isEven&&(n<g.gE+500);}if(j.type=="mousemove"){k=AB.iF;}if(k!=null&&h!=null){m=h.SC(i);h.dispatchEvent(iP..RO(k,true)..HP=m..MP=i..zO=g.LC..DP=g.JD);if(o){if(q&&h.zI){h.dispatchEvent(iP..RO(g.PG,true)..HP=m..MP=i..zO=g.LC);}else{h.dispatchEvent(iP..RO(g.OG,true)..HP=m..MP=i..zO=g.LC);}}}}CQ( h){var g=QP.RP(h.client);var i=WB(g.x,g.y) as LB;if(i!=null){i.dispatchEvent(iP..RO(AB.lF,true)..HP=i.SC(g)..MP=g..EP=h.deltaX..FP=h.deltaY);if(iP.mD)h.preventDefault();}}var UQ=[] ;DQ( h){UQ.forEach((g)=>g.cancel());if(bF.EI==LF.KH){UQ=[UO.onTouchStart.listen(VQ),UO.onTouchEnd.listen(VQ),UO.onTouchMove.listen(VQ),UO.onTouchEnter.listen(VQ),UO.onTouchLeave.listen(VQ),UO.onTouchCancel.listen(VQ)];}}VQ( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=QP.RP(m.client);var h=WB(i.x,i.y) as LB;var g=hP.containsKey(l)?hP[l]:new FI(h,hP.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(kP..RO(TB.aH,true)..HP=(g.target.iC!=null)?g.target.SC(i):new EB.uK()..MP=i..aO=g.oD..dO=g.kD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(kP..RO(TB.WH,true)..HP=h.SC(i)..MP=i..aO=g.oD..dO=g.kD);g.target=h;}var k=null;if(j.type=="touchstart"){hP[l]=g;k=TB.TF;}if(j.type=="touchend"){hP.remove(l);k=TB.WF;}if(j.type=="touchcancel"){hP.remove(l);k=TB.aF;}if(j.type=="touchmove"){k=TB.hF;}if(k!=null&&h!=null){h.dispatchEvent(kP..RO(k,true)..HP=h.SC(i)..MP=i..aO=g.oD..dO=g.kD);}}}EQ( g){g.preventDefault();var h=null;if(g.type=="keyup")h=DC.VF;if(g.type=="keydown")h=DC.BE;jP..RO(h,true)..lN=g.altKey..mN=g.ctrlKey..pN=g.shiftKey..CO=g.charCode..FO=g.keyCode..HO=lC.sG;if(g.keyLocation==QB.KeyLocation.LEFT)jP.HO=lC.yG;if(g.keyLocation==QB.KeyLocation.RIGHT)jP.HO=lC.gF;if(g.keyLocation==QB.KeyLocation.NUMPAD)jP.HO=lC.LH;if(g.keyLocation==QB.KeyLocation.JOYSTICK)jP.HO=lC.cF;if(g.keyLocation==QB.KeyLocation.MOBILE)jP.HO=lC.cF;if(YP!=null)YP.dispatchEvent(jP);}GQ( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new MF(MF.EH,true);h.rL=new String.fromCharCodes([i]);if(YP!=null)YP.dispatchEvent(h);}}class PK extends AD{final  LP;PK( g):LP=g.toList(growable:false){if(g.length<3)throw new ArgumentError("A custom mask needs at least 3 points.");} BB( i){var h=i.context;h.beginPath();for(int g=0;g<LP.length;g++ )h.lineTo(LP[g].x,LP[g].y);h.clip();}} xF( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);} zF( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} QI(){var g=new QB.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;}class QK extends u implements dB{final  lP;final  mP;final  nP=new List<bI>();var oP=0.0;var pP=0.0;var qP=0;var dM=0;QK( g, j):lP=g,mP=g.IP(j){for(var h in mP.iE){var i=new bI(lP,h);nP.add(i);}dM=mP.jE;pP=dM/lP.YM;} oB( h){oP+= h;var i=oP%pP;qP=YB.min((dM*i/pP).toInt(),dM-1);for(var g in nP){g.oB(h);g.ZG(qP);}return true;} BB( h){for(var g in nP){if(g.visible){h.YG(g);}}}} TI( h){if(aC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];h[g+0]=(h[g+0]*i)~/255;h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];h[g+1]=(h[g+1]*i)~/255;h[g+2]=(h[g+2]*i)~/255;h[g+3]=(h[g+3]*i)~/255;}}}class aD implements dB{final  rP;final  sP;final  tP=new List<fB>();var uP;var vP;var wP;var xP;var VM;var HM;var yP;var zP;var AQ;aD( g, h,[ transitionFunction]):rP=g,sP=(?transitionFunction)?transitionFunction:s.mC{xP=new OF(this);HM=0.0;VM=YB.max(0.0001,h);yP=0.0;zP=false;AQ=false;} get GC=>xP; rM( g){if(rP!=null&&AQ==false){tP.add(g);}} oB( m){if(HM<VM||AQ==false){HM=HM+m;if(HM>VM){HM=VM;}if(HM>=0.0){if(AQ==false){AQ=true;for(int h=0;h<tP.length;h++ ){var g=tP[h];g.tE=g.CP(rP);}if(uP!=null){uP();}}var k=HM/VM;var l=sP(k).toDouble();for(int h=0;h<tP.length;h++ ){var g=tP[h];if(g.RJ){var i=g.tE.toDouble();var n=g.vE.toDouble();var j=i+l*(n-i);g.WP(rP,zP?j.round():j);}}if(vP!=null){vP();}if(wP!=null&&HM==VM){wP();}}}return HM<VM;} get yI=>rP; get currentTime=>HM;set EG( g){if(AQ==false)HM=HM+yP-g;yP=g;} set onComplete( g()){wP=g;}}class RK extends zB{RK();BB( g){g.beginPath();}TC( g){g.fJ();}} WI( h){if(aC){for(var g=0;g<=h.length-4;g+= 4){var i=h[g+3];if(i>0){h[g+0]=(h[g+0]*255)~/i;h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;}}}else{for(var g=0;g<=h.length-4;g+= 4){var i=h[g+0];if(i>0){h[g+1]=(h[g+1]*255)~/i;h[g+2]=(h[g+2]*255)~/i;h[g+3]=(h[g+3]*255)~/i;}}}}class SK extends zB{SK();BB( g){g.closePath();}}class TK extends zB{var aL,eL;TK( h, g){aL=h.toDouble();eL=g.toDouble();}BB( g){g.moveTo(aL,eL);}TC( g){g.wC(aL,eL);}}var aC=QI();class bI extends u implements dB{final  sC;final  hE;final  uE=new Map<String,XC>();var OD;bI( i, h):this.sC=i,this.hE=h{for(var g in h.HC){if(g.hC!=null&&uE.containsKey(g.hC)==false){uE[g.hC]=i.VP(g.hC);}}ZG(0);} oB( g){if(OD is dB){var h=OD as dB;h.oB(g);}} ZG( t){var g=hE.LJ(t);var o=g.x,p=g.y;var n=g.iB,k=g.jB;var m=g.skewX,l=g.skewY;var w=g.hB,PB=g.qB;var q=g.alpha;if(g.index!=t&&g.dG){var i=hE.KJ(g);if(i!=null){var h=(t-g.index)/g.duration;var j=g.GG;if(j!=0){var v=0.0;if(j<0){var JB=1-h;v=1-JB*JB;j=0-j;}else{v=h*h;}h=j*v+(1-j)*h;}o=o+(i.x-o)*h;p=p+(i.y-p)*h;n=n+(i.iB-n)*h;k=k+(i.jB-k)*h;m=m+(i.skewX-m)*h;l=l+(i.skewY-l)*h;q=q+(i.alpha-q)*h;}}var FB=n*YB.cos(l);var UB=n*YB.sin(l);var MB=-k*YB.sin(m);var NB=k*YB.cos(m);var aB=o-(w*FB+PB*MB);var ZB=p-(w*UB+PB*NB);lO=false;eO.ND(FB,UB,MB,NB,aB,ZB);JO=q;MO=g.visible;OD=(g.hC!=null)?uE[g.hC]:null;} BB( g){if(OD!=null){OD.BB(g);}}} UE( g, m, n, j){m=m.toDouble();n=n.toDouble();var JB=0.0;var FB=0.0;var q=m*g.a;var w=m*g.b;var t=m*g.a+n*g.c;var p=m*g.b+n*g.d;var v=n*g.c;var o=n*g.d;var h=JB;if(h>q)h=q;if(h>t)h=t;if(h>v)h=v;var i=FB;if(i>w)i=w;if(i>p)i=p;if(i>o)i=o;var l=JB;if(l<q)l=q;if(l<t)l=t;if(l<v)l=v;var k=FB;if(k<w)k=w;if(k<p)k=p;if(k<o)k=o;if(j==null)j=new CB.uK();j.x=g.kB+h;j.y=g.lB+i;j.width=l-h;j.height=k-i;return j;}class UK extends zB{var aL,eL;UK( h, g){aL=h.toDouble();eL=g.toDouble();}BB( g){g.lineTo(aL,eL);}TC( g){if(g.lE==false){g.wC(aL,eL);}g.UC(g.KD,g.LD);g.UC(aL,eL);g.wC(aL,eL);}}class bE{final  id;final  sC;final  iE=new List<cE>();bE( g, j):sC=j,id=g["id"]{for(var h in g["layers"]){var i=new cE(h);this.iE.add(i);}} get jE{var g=0;for(var h in iE)g=YB.max(g,h.jE);return g;}}class cE{final  name;final  DJ;final  HC=new List<dD>();cE( g):this.name=g["name"],this.DJ=g.containsKey("flipbook")?g["flipbook"]:false{for(var i in g["keyframes"]){var h=new dD(i);this.HC.add(h);}} get jE{var g=HC[HC.length-1];return g.index+g.duration;} LJ( h){var g=1;while (g<HC.length&&HC[g].index<=h)g++ ;return HC[g-1];} KJ( h){for(int g=0;g<HC.length-1;g++ )if(identical(HC[g],h))return HC[g+1];return null;}}class dD{var index;var duration;var hC;var label;var x,y;var iB,jB;var skewX,skewY;var hB,qB;var visible;var alpha;var dG;var GG;dD( g){this.index=g["index"];this.duration=g["duration"];this.hC=g.containsKey("ref")?g["ref"]:null;this.label=g.containsKey("label")?g["label"]:null;this.x=g.containsKey("loc")?g["loc"][0]:0.0;this.y=g.containsKey("loc")?g["loc"][1]:0.0;this.iB=g.containsKey("scale")?g["scale"][0]:1.0;this.jB=g.containsKey("scale")?g["scale"][1]:1.0;this.skewX=g.containsKey("skew")?g["skew"][0]:0.0;this.skewY=g.containsKey("skew")?g["skew"][1]:0.0;this.hB=g.containsKey("pivot")?g["pivot"][0]:0.0;this.qB=g.containsKey("pivot")?g["pivot"][1]:0.0;this.visible=g.containsKey("visible")?g["visible"]:true;this.alpha=g.containsKey("alpha")?g["alpha"]:1.0;this.dG=g.containsKey("tweened")?g["tweened"]:true;this.GG=g.containsKey("ease")?g["ease"]:0.0;}}class pI{var sC;var hD;var eD;pI( p,this.sC){this.hD=new Map<String,qI>();this.eD=new VB.Completer();var k=0;for(var j in p["atlases"] as List){var n=j["file"] as String;var q=zF(sC.JM,n);k++ ;var g=new QB.ImageElement();g.onLoad.listen((o){if( --k==0)this.eD.complete(this);});g.onError.listen((o){this.eD.completeError(new StateError("Failed to load image."));});g.src=q;for(var i in j["textures"] as List){var m=i["symbol"] as String;var h=i["rect"] as List;var l=i["origin"] as List;var t=new qI(h[0],h[1],h[2],h[3],l[0],l[1],g);this.hD[m]=t;}}}}class VK extends zB{var aL,eL,KQ;var LQ,MQ;var NQ;VK( l, g, j, i, h, k){aL=l.toDouble();eL=g.toDouble();KQ=j.toDouble();LQ=i.toDouble();MQ=h.toDouble();NQ=k;}BB( g){g.arc(aL,eL,KQ,LQ,MQ,NQ);}TC( g){var j=new eB(KQ,0);var o=j.rotate(LQ);var m=j.rotate(MQ);if(g.lE==false){g.wC(aL+o.x,eL+o.y);}var h=LQ;var i=MQ;if(NQ){if(h<i)h=h+2*YB.PI;}else{if(i<h)i=i+2*YB.PI;}var p=i-h;var l=(p*30).abs()~/YB.PI+1;g.UC(g.KD,g.LD);for(var k=0;k<=l;k++ ){var n=j.rotate(h+k*p/l);g.UC(aL+n.x,eL+n.y);}g.wC(aL+m.x,eL+m.y);}}class qI implements XC{var x,y,width,height;var VJ,WJ;var iD;var OQ;var PQ;qI(this.x,this.y,this.width,this.height,this.VJ,this.WJ,this.iD); BB( g){g.context.drawImageScaledFromSource(iD,x,y,width,height,0,0,width,height);}}class WK extends zB{var aL,eL;var lL,zL;WK( i, g, h, j){aL=i.toDouble();eL=g.toDouble();lL=h.toDouble();zL=j.toDouble();}BB( g){g.rect(aL,eL,lL,zL);}TC( g){g.wC(aL,eL);g.UC(aL,eL);g.UC(aL+lL,eL);g.UC(aL+lL,eL+zL);g.UC(aL,eL+zL);}}abstract class rI extends zB{var QQ;var RQ;var SQ;rI( h, i, g){QQ=h.toInt();RQ=i;SQ=g;} WB( g, h, i){g.lineWidth=QQ;g.lineJoin=RQ;g.lineCap=SQ;try {return g.isPointInStroke(h,i);}catch (j){return false;}}TC( g){g.stroke(QQ);}}class XK extends rI{var TQ;XK( g, i, j, h):super(i,j,h){TQ=g;}BB( g){g.strokeStyle=TQ;g.lineWidth=QQ;g.lineJoin=RQ;g.lineCap=SQ;g.stroke();}}abstract class sI extends zB{ WB( g, h, i){return g.isPointInPath(h,i);}TC( g){g.fill();}}class YK extends sI{var TQ;YK( g){TQ=g;}BB( g){g.fillStyle=TQ;g.fill();}}//@ sourceMappingURL=stagexl_web.dart.map
