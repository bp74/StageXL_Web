import "dart:async" as YB;import "dart:web_audio" as tE;import "dart:math" as VB;import "dart:html" as kC;import "dart:json" as DJ;class EJ{static const  FJ="Chrome";static const  GJ="Firefox";static const  HJ="Internet Explorer";static const  IJ="Safari";final  MI;final  minimumVersion;const EJ(this.MI,[this.minimumVersion]);}class JJ{const JJ();}class KJ{final  name;const KJ(this.name);}class LJ{const LJ();}class MJ{const MJ();}class NJ extends DB implements lB{var yJ;var GK;var CK;NJ( j, g, h){this.TB=false;CK=0.0;GK=sB.hG(j,h);yJ=new IB(GK[0]);yJ.x=-25;yJ.y=-25;q(yJ);NB(AB.BD,(i)=>g.add(this));NB(AB.OD,(i)=>g.remove(this));} zB( g){CK+= g;var h=(CK*10).toInt()%GK.length;yJ.FC=GK[h];return true;}}class aG extends DB{var bK;var kK;var pK;var uK;var yK;var BL;var CL;var tJ;var xJ;var EL;var FL;var GL;var HL;var IL;var JL;var KL;var ML;var NL;var OL;var PL;var RL;var SL;aG( kB, n, v, s, QB, m, o, FB, k){tJ=kB;xJ=n;EL=new VB.Random();FL=HC.GD;GL=k;bK=v;kK=s;pK=QB;uK=m;yK=o;BL=FB;CL=k.length;KL=new List<KB>();NL=new DB();OL=new DB();PL=new DB();RL=new DB();SL=new DB();q(NL);q(OL);q(PL);q(RL);q(SL);OL.TB=false;PL.TB=false;RL.TB=false;SL.TB=false;ZI();aI();YI();ML=true;var l=new FD();this.mask=new QE.nJ(0.0,0.0,500.0,500.0);for(int i=0;i<10;i++ ){for(int g=0;g<10;g++ ){var h=IL[i+g*10];h.x=i*50+25;h.y=g*50+25-550;h.rB(NL,OL,PL);var j=new VC(h.y,g*50+25,0.4,PB.EC);j.ZC=i*0.03;j.PC=(UB){h.y=UB;};j.onComplete=(){if(l.tD()==100){aL();ML=false;KL.clear();this.mask=null;}};xJ.add(j);}}NB(t.gD,bL);} XG( g){if(g==HC.EE){FL=g;}if(g==HC.FE&&FL==HC.GD){FL=g;if(ML==false)dispatchEvent(new bB(bB.GE,null));}} CG(){this.mask=new QE.nJ(0.0,0.0,500.0,500.0);for(int h=0;h<10;h++ ){for(int i=0;i<10;i++ ){var g=IL[i+h*10];g.fB=false;g.OC=false;g.JB=BB.VD;g.rB(NL,OL,PL);var j=new VC(g.y,500+h*50+25,0.5,PB.EC);j.ZC=i*0.1;j.PC=(k){g.y=k;};xJ.add(j);}}} ZI(){JL=new List<UD>();for(int h=0;h<kK;h++ ){var g=new UD(tJ,xJ,h);g.SB=(EL.nextInt(30)-15)*VB.PI/180;g.x=300-(90*kK)/2+h*90+EL.nextInt(20)-10;g.y=550;JL.add(g);RL.q(g);}} AG( g, h){var i=0;var j=IL[g+h*10];if(j.direction==0){var l=(g>0)?IL[g-1+h*10]:null;var m=(g<9)?IL[g+1+h*10]:null;if(j.gC(l))i++ ;if(j.gC(m))i++ ;}else{var k=(h>0)?IL[g+(h-1)*10]:null;var n=(h<9)?IL[g+(h+1)*10]:null;if(j.sC(k))i++ ;if(j.sC(n))i++ ;}return i;} yF(){for(int h=0;h<10;h++ ){for(int g=0;g<10;g++ ){var k=IL[g+h*10];var i=CL*2;while (AG(g,h)==2&&i>0){if(i%2==0){k.direction=1-k.direction;i-- ;}else{var m=0;for(int j=0;j<GL.length;j++ )if(k.color==GL[j])m=j;k.color=GL[(m+1)%GL.length];i-- ;}}}}var l=false;for(int h=0;h<10;h++ ){for(int g=0;g<10;g++ ){l=l||(AG(g,h)==2);}}return l;} OG(){for(int g=0;g<10;g++ )for(int h=1;h<9;h++ )if(IL[(h-1)+g*10].sD(IL[h+g*10])&&IL[h+g*10].sD(IL[(h+1)+g*10]))return true;for(int h=0;h<10;h++ )for(int g=1;g<9;g++ )if(IL[h+(g-1)*10].sD(IL[h+g*10])&&IL[h+g*10].sD(IL[h+(g+1)*10]))return true;return false;} hL( j, l, k){for(int g=0;g<20;g++ ){var h=bK~/k;var i=l*h+EL.nextInt(h);if(HL[i].JB==BB.VD){HL[i].JB=j;return;}}} aI(){HL=new List<MB>();for(int g=0;g<bK;g++ ){var i=GL[EL.nextInt(GL.length)];var h=EL.nextInt(2);HL.add(new MB(tJ,xJ,i,h));}for(int g=0;g<kK*2;g++ )hL("Lock${(g%kK)+1}",g,kK*2);for(int g=0;g<pK;g++ )hL(BB.RB,g,pK);for(int g=0;g<uK;g++ )hL(BB.IC,g,uK);for(int g=0;g<yK;g++ )hL(BB.yE,g,yK);for(int g=0;g<BL;g++ )hL(BB.zE,g,BL);} YI(){IL=new List<MB>();var g=true;while (g){IL.clear();for(int h=0;h<100;h++ ){var j=GL[EL.nextInt(GL.length)];var i=EL.nextInt(2);IL.add(new MB(tJ,xJ,j,i));}g=yF();}} TG(){if(ML||FL!=HC.GD)return false;var l=true;ML=true;while (l){for(int k=0;k<IL.length;k++ ){var g=IL[k];g.fB=false;g.OC=false;g.rB(NL,OL,PL);g.color=GL[EL.nextInt(GL.length)];g.direction=EL.nextInt(2);}l=yF()||(OG()==false);}tJ.oB("BonusUniversal").play();var m=new FD();for(int i=0;i<10;i++ ){for(int j=0;j<10;j++ ){var g=IL[i+j*10];g.UG=0.0;var h=new VC(0.0,1.0,0.2,PB.WC);h.ZC=i*0.06;h.PC=(n){g.UG=n;};h.onStart=(){g.rB(NL,OL,PL);};h.onComplete=(){if(m.tD()==100){aL();iL();KL.clear();}};xJ.add(h);}}return true;} aL(){for(int i=0;i<10;i++ ){for(int h=0;h<10;h++ ){var g=IL[h+i*10];var l=(h<9)?IL[h+1+i*10]:null;var m=(i<9)?IL[h+(i+1)*10]:null;var j=false;var k=false;if(g.gC(l)){j=true;k=(g.JB==BB.RB||l.JB==BB.RB);}if(g.sC(m)){j=true;k=(g.JB==BB.RB||m.JB==BB.RB);}if(g.fB!=j||g.OC!=k){g.fB=j;g.OC=k;g.rB(NL,OL,PL);}}}} jL( s, l, n, k, m, o){ML=true;s.tD(k);var i=1;for(int g=0;g<k;g++ ){var h=IL[l+g*m+(n+g*o)*10];if(h.JB==BB.yE)i=i*2;if(h.JB==BB.zE)i=i*5;var v=l+g*m;var FB=n+g*o;xJ.iB((){h.empty=true;h.rB(NL,OL,PL);tJ.oB("ChainBlast").play();var j=new wE(tJ,xJ,h.color,h.direction);j.x=v*50;j.y=FB*50;xJ.add(j);SL.q(j);pI(h);if(s.BG()==0)lL();},0.1+g*0.1);}dispatchEvent(new bB(bB.wE,{"Length":k,"Factor":i}));} iL(){ML=false;var j=new FD();for(int h=0;h<10;h++ ){for(int i=0;i<10;){var g=1;while (i+g<10&&IL[i+g-1+h*10].gC(IL[i+g+h*10]))g++ ;if(g>=3)jL(j,i,h,g,1,0);i=i+g;}}for(int i=0;i<10;i++ ){for(int h=0;h<10;){var g=1;while (h+g<10&&IL[i+(h+g-1)*10].sC(IL[i+(h+g)*10]))g++ ;if(g>=3)jL(j,i,h,g,0,1);h=h+g;}}if(j.value==0){if(FL==HC.EE)dispatchEvent(new bB(bB.xE,null));if(FL==HC.FE)dispatchEvent(new bB(bB.GE,null));if(FL==HC.GD&&OG()==false)TG();}} pI( h){if(h.JB.indexOf("Lock")==0){var k=int.parse(h.JB.substring(4,5))-1;var j=JL[k];var g=sB.HE(tJ,h.JB);g.x=h.x;g.y=h.y;q(g);var i=new dB(g,0.5,PB.EC);i.eB.x.aB(j.x);i.eB.y.aB(j.y-10);i.onComplete=()=>GC(g);xJ.add(i);xJ.iB(()=>kI(k),0.5);}} kI( k){var h=JL[k];var i;if(h.TD){i=new bB(bB.WD,{"Type":"SingleLocked","Position":new KB(h.x+20,h.y)});tJ.oB("Unlock").play();}else{i=new bB(bB.WD,{"Type":"SingleUnlocked","Position":new KB(h.x+20,h.y)});}dispatchEvent(i);h.TD=false;h.SG(false);var j=true;for(int g=0;g<JL.length;g++ ){j=j&&(JL[g].TD==false);}if(j){tJ.oB("BonusAllUnlock").play();for(int g=0;g<JL.length;g++ ){JL[g].TD=true;xJ.iB(()=>JL[(g+k)%JL.length].uI(),g*0.2);}xJ.iB(()=>dispatchEvent(new bB(bB.WD,{"Type":"All","Position":new KB(280,550)})),0.75);}} lL(){var n=new FD();for(int i=0;i<10;i++ ){var k=9;var j=8;while (k>=0){while (k>=0&&IL[i+k*10].empty==false){k-- ;j-- ;}while (j>=0&&IL[i+j*10].empty==true){j-- ;}if(k>=0){var g,h,l;if(j>=0){h=IL[i+j*10];if(i>0){l=IL[i-1+j*10];if(h.gC(l)){l.fB=false;l.rB(NL,OL,PL);}}h.fB=false;h.empty=true;h.rB(NL,OL,PL);}else{if(HL.length>0){h=HL.removeAt(0);}else{var v=GL[EL.nextInt(GL.length)];var s=EL.nextInt(2);h=new MB(tJ,xJ,v,s);}}g=IL[i+k*10];g.color=h.color;g.direction=h.direction;g.JB=h.JB;g.fB=false;g.empty=false;g.x=50*i+25;g.y=50*j+25;g.rB(NL,OL,PL);n.tD();var m=new VC(g.y,50*k+25,0.1,PB.WC);m.PC=(o){g.y=o;};m.onComplete=(){if(n.BG()==0){aL();iL();oL();}};xJ.add(m);}}}} bL( g){if(g.target==NL&&this.TB){var j=VB.min(g.kE/50,9).toInt();var h=VB.min(g.lE/50,9).toInt();var i=new KB(j,h);KL.add(i);oL();}} oL(){while (FL==HC.GD&&ML==false&&KL.length>0){var m=KL.removeAt(0);var j=m.x.toInt();var k=m.y.toInt();var g=IL[j+k*10];var i=(j>0)?IL[j-1+k*10]:null;var n=(j<9)?IL[j+1+k*10]:null;var h=(k>0)?IL[j+(k-1)*10]:null;var o=(k<9)?IL[j+(k+1)*10]:null;var l=false;if(g.JB==BB.IC){tJ.oB("ChainError").play();continue;}if(g.sC(h)){h.fB=false;h.rB(NL,OL,PL);}if(g.gC(i)){i.fB=false;i.rB(NL,OL,PL);}g.direction=1-g.direction;g.fB=false;g.OC=false;tJ.oB("ChainRotate").play();if(g.gC(n)){g.fB=true;g.OC=(g.JB==BB.RB||n.JB==BB.RB);}if(g.sC(o)){g.fB=true;g.OC=(g.JB==BB.RB||o.JB==BB.RB);}g.rB(NL,OL,PL);l=l||g.fB;if(g.sC(h)){h.fB=true;h.OC=(g.JB==BB.RB||h.JB==BB.RB);h.rB(NL,OL,PL);l=true;}if(g.gC(i)){i.fB=true;i.OC=(g.JB==BB.RB||i.JB==BB.RB);i.rB(NL,OL,PL);l=true;}if(l){tJ.oB("ChainLink").play();}iL();}}}class HC{static const  GD=1;static const  EE=2;static const  FE=3;}class dG extends DB{var uJ;var wJ;var AK;var HK;var MK;dG( h, i){q(new IB(h.w("InfoBox")));wJ=new KC();wJ.NC=new ZD("Arial",35,0xFFFFFF,bold:true,align:CC.UC);wJ.width=220;wJ.height=40;wJ.wordWrap=false;wJ.text="Level 1";wJ.x=20;wJ.y=115;wJ.SB=-2*VB.PI/180;q(wJ);HK=new KC();HK.NC=new ZD("Arial",25,0xFFFFFF,bold:true,align:CC.UC);HK.width=220;HK.height=30;HK.wordWrap=false;HK.text="40";HK.x=-HK.width/2;HK.y=-HK.height/2;HK.SB=-2*VB.PI/180;MK=new DB();MK.q(HK);MK.x=150;MK.y=172;q(MK);var g=sB.DE(h,3,0);g.x=110;g.y=171;g.SB=-2*VB.PI/180;g.jB=g.qB=0.6;q(g);} set cI( g){uJ=g;wJ.text="Level ${uJ}";} set wF( g){AK=g;HK.text="${AK}";}}class FD{var value=0; tD([ g=1])=>(value+= g); BG([ g=1])=>(value-= g);}class PJ extends DB implements lB{var yJ;var CK;PJ( j, g, i){this.TB=false;CK=0.0;yJ=sB.HE(j,i);q(yJ);NB(AB.BD,(h)=>g.add(this));NB(AB.OD,(h)=>g.remove(this));} zB( g){CK+= g;this.SB=VB.sin(CK*7)*10*VB.PI/180;return true;}}class uE{var vF;var VG;var WG;var angle;var YG;var SB;}class QJ extends DB implements lB{var yJ;var GK;var CK;QJ( j, g, h){this.TB=false;CK=0.0;GK=sB.gG(j,h);yJ=new IB(GK[0]);yJ.x=-25;yJ.y=-25;q(yJ);NB(AB.BD,(i)=>g.add(this));NB(AB.OD,(i)=>g.remove(this));} zB( g){CK+= g;var h=(CK*10).toInt()%GK.length;yJ.FC=GK[h];return true;}}class BB{static const  VD="None";static const  RB="Joker";static const  IC="Block";static const  yE="Double";static const  zE="Quint";}class CE extends DB{var tJ;var xJ;var JK;var OK;CE( i, j, h){tJ=i;xJ=j;var k=new IB(tJ.w("MessageBox"));q(k);var g=new KC();g.NC=new ZD("Arial",24,0xFFFFFF,bold:true,align:CC.UC);g.width=240;g.height=200;g.wordWrap=true;g.text=h;g.x=47;g.y=130-g.pE/2;g.TB=false;q(g);JK=null;NB(t.eC,LL);}void show( h){this.parent.q(this);this.x=-this.width;this.y=150;OK=h;var g=new dB(this,0.3,PB.EC);g.eB.x.aB(110);g.onComplete=()=>JK=xJ.iB(UL,10);xJ.add(g);} UL(){if(JK!=null){xJ.remove(JK);JK=null;OK();var g=new dB(this,0.4,PB.sF);g.eB.x.aB(800);g.onComplete=()=>this.parent.GC(this);xJ.add(g);}} LL( g){UL();}}class sB{static  DE( j, i, h){var g=new IB(j.aC("Elements").w("Chain${i}${h}"));g.QC=25;g.RC=25;return g;}static  eG( j, i, h){var g=new IB(j.aC("Elements").w("Link${i}${h}"));g.QC=25;g.RC=25;return g;}static  HE( i, h){var g=new IB(i.aC("Elements").w(h));g.QC=25;g.RC=25;return g;}static  fG( o, n){var m=new DB();var l=0;var s=o.aC("Levelup");for(int k=0;k<7;k++ ){var g=new IB(s.w("LevelUp${k}"));g.x=-g.width/2;g.y=-g.height/2;var h=new DB();h.q(g);h.x=l+g.width/2;h.jB=0;h.qB=0;m.q(h);var i=new dB(h,2.0,PB.II);i.eB.jB.aB(1.0);i.eB.qB.aB(1.0);i.ZC=k*0.05;var j=new dB(h,0.4,PB.WC);j.eB.jB.aB(0.0);j.eB.qB.aB(0.0);j.ZC=3.0;n.add(i);n.add(j);l=l+5+g.width;}return m;}static  gG( j, h){var i=j.aC("Elements");var g=new List<CB>();g.add(i.w("JokerChain${h}0"));g.add(i.w("JokerChain${h}1"));g.add(i.w("JokerChain${h}2"));g.add(i.w("JokerChain${h}3"));g.add(i.w("JokerChain${h}4"));return g;}static  hG( j, h){var i=j.aC("Elements");var g=new List<CB>();g.add(i.w("JokerLink${h}0"));g.add(i.w("JokerLink${h}1"));g.add(i.w("JokerLink${h}2"));g.add(i.w("JokerLink${h}3"));g.add(i.w("JokerLink${h}4"));return g;}static  iG( j, h){var i=j.aC("Locks");var g=new List<CB>();g.add(i.w("Lock${h}0"));g.add(i.w("Lock${h}1"));g.add(i.w("Lock${h}2"));g.add(i.w("Lock${h}3"));g.add(i.w("Lock${h}4"));return g;}static  jG( i){var h=i.aC("Head");var g=new List<CB>();g.add(h.w("Head1"));g.add(h.w("Head2"));g.add(h.w("Head3"));g.add(h.w("Head2"));g.add(h.w("Head1"));return g;}static  kG( i){var h=i.aC("Alarm");var g=new List<CB>();g.add(h.w("Alarm0"));g.add(h.w("Alarm1"));g.add(h.w("Alarm2"));g.add(h.w("Alarm3"));g.add(h.w("Alarm4"));g.add(h.w("Alarm5"));return g;}}class cG extends DB{var tJ;var xJ;var IK;var PK;var XK;cG( g, h){tJ=g;xJ=h;IK=sB.jG(tJ);PK=new IB(IK[0]);PK.x=-PK.width/2;PK.y=-PK.height/2;q(PK);XK=null;} MG( g){xJ.remove(XK);XK=new VC(0,g,0.5*g,PB.WC);XK.PC=(h){var i=((h*IK.length)%IK.length).toInt();PK.FC=IK[i];PK.y=VB.sin(h*2*VB.PI)*3-PK.height/2;};xJ.add(XK);} hI(){xJ.remove(XK);PK.FC=IK[0];}}class UD extends DB{var tJ;var xJ;var BK;var yJ;var SK;var YK;UD( h, i, g){tJ=h;xJ=i;BK=g;SK=sB.iG(tJ,g);YK=true;yJ=new IB(SK[0]);yJ.x=-34;yJ.y=-50;q(yJ);} get TD=>YK; set TD( g){YK=g;} SG( g){yJ.FC=SK[g?0:4];} uI(){var i=new VC(0.0,1.0,2.0,PB.EC);i.PC=(j){jB=qB=1.0+0.2*VB.sin(j*4*VB.PI);};var g=new dB(this,0.2,PB.EC);g.eB.alpha.aB(0.0);g.ZC=2.0;g.onComplete=()=>SG(YK);var h=new dB(this,0.2,PB.sF);h.eB.alpha.aB(1);h.ZC=2.2;xJ.add(i);xJ.add(g);xJ.add(h);}}class ZG extends DB{var tJ;var xJ;var KK;var RK;var WK;var cK;var gK;ZG( g, h){tJ=g;xJ=h;KK=sB.kG(tJ);RK=new IB(KK[0]);WK=tJ.oB("Warning");cK=null;q(RK);} start(){cK=WK.play();xJ.remove(gK);gK=new VC(0,80,9.0,PB.WC);gK.PC=(h){var g=h.toInt()%8;RK.FC=KK[(g<=4)?g+1:8-g];};xJ.add(gK);} stop(){if(cK!=null){cK.stop();cK=null;}xJ.remove(gK);RK.FC=KK[0];}}class bB extends AB{static const  wE="Explosion";static const  WD="Unlocked";static const  xE="Finalized";static const  GE="Timeouted";var jK;bB( h, g,[ i=false]):super(h,i){jK=g;} get info{return jK;}}class vE extends DB{vE( m, k, l){var g=new KC();g.NC=new ZD("Arial",30,0xFFFFFF,bold:true,align:CC.UC);g.width=110;g.height=36;g.wordWrap=false;g.x=646;g.y=130;g.TB=false;g.text=l.toString();g.x=-g.width/2;g.y=-g.height/2;var h=new DB();h.q(g);q(h);var j=new VC(0.0,1.0,1.5,PB.EC);j.PC=(i){h.alpha=1-i;h.y=-i*50;h.jB=1.0+0.1*VB.sin(i*10);h.qB=1.0+0.1*VB.cos(i*10);};j.onComplete=(){this.nE();};k.add(j);}}class bG extends DB{var vJ;var zJ;var FK;var OK;bG( h, i){var o=new IB(h.w("ExitBox"));q(o);var g=new KC();g.NC=new ZD("Arial",24,0xFFFFFF,bold:true,align:CC.UC);g.width=240;g.height=100;g.wordWrap=true;g.text=h.DD("GENexitquery");g.x=47;g.y=150-g.pE/2;g.TB=false;q(g);vJ=new RE(7,h.w("ExitGauge"),bD.XE);vJ.x=268;vJ.y=25;vJ.NB("TimeOver",QL);q(vJ);vJ.nD("TimeOver",0);vJ.start();var k=new IB(h.w("ExitYesButtonNormal"));var l=new IB(h.w("ExitYesButtonPressed"));zJ=new uC(k,k,l,l);zJ.x=68;zJ.y=239;zJ.NB(t.eC,WL);q(zJ);var j=new IB(h.w("ExitNoButtonNormal"));var m=new IB(h.w("ExitNoButtonPressed"));FK=new uC(j,j,m,m);FK.x=173;FK.y=232;FK.NB(t.eC,YL);q(FK);this.NB(AB.BD,(n)=>i.add(vJ));this.NB(AB.OD,(n)=>i.remove(vJ));} ZL( g){if(OK!=null){OK(g);OK=null;}} WL( g){ZL(true);} YL( g){ZL(false);} QL( g){ZL(false);}show( g){OK=g;}}class OJ extends DB{var tJ;var xJ;var EK;var NK;var UK;var aK;var vJ;var fK;var iK;var lK;var nK;var uJ;var qK;var rK;var sK;var tK;var vK;var wK;var xK;var zK;var AL;OJ( k, l){tJ=k;xJ=l;var j=new IB(tJ.w("ShuffleButtonNormal"));var i=new IB(tJ.w("ShuffleButtonPressed"));NK=new uC(j,j,i,i);NK.NB(t.eC,TL);NK.x=530;NK.y=525;q(NK);var h=new IB(tJ.w("ExitButtonNormal"));var g=new IB(tJ.w("ExitButtonPressed"));UK=new uC(h,h,g,g);UK.NB(t.eC,VL);UK.x=700;UK.y=500;q(UK);EK=new dG(tJ,xJ);EK.x=540;EK.y=-1000;q(EK);vJ=new RE(10,tJ.w("TimeGauge"),bD.UE);vJ.x=659;vJ.y=244;vJ.NB("TimeShort",XL);vJ.NB("TimeOver",QL);q(vJ);xJ.add(vJ);fK=new cG(tJ,xJ);fK.x=640;fK.y=230;q(fK);iK=new ZG(tJ,xJ);iK.x=665;iK.y=160;q(iK);lK=new KC();lK.NC=new ZD("Arial",30,0xD0D0D0,bold:true,align:CC.UC);lK.width=140;lK.height=36;lK.wordWrap=false;lK.x=646;lK.y=130;lK.TB=false;lK.text="0";lK.jB=0.9;q(lK);nK=new KC();nK.NC=new ZD("Arial",20,0xFFFFFF,bold:true,align:CC.UC);nK.width=44;nK.height=30;nK.wordWrap=false;nK.x=610;nK.y=559;nK.TB=false;nK.text="3x";q(nK);vK=new DB();q(vK);wK=new DB();q(wK);xK=new DB();q(xK);zK=tJ.oB("Intro");AL=zK.play();} start(){uJ=1;qK=1;tK=0;rK=3;var g=new CE(tJ,xJ,tJ.DD("ESCStartText"));wK.q(g);xJ.iB(()=>fK.MG(21),1);g.show(()=>xJ.iB(()=>cL(),0.5));} cL(){if(aK!=null&&this.contains(aK))vK.GC(aK);var m=uJ;var g=0;var h=0;switch (uJ){case 01:h=50;aK=new aG(tJ,xJ,g=40,3,0,0,0,0,[0,1,2]);break;case 02:h=45;aK=new aG(tJ,xJ,g=45,3,1,0,0,0,[2,3,4]);break;case 03:h=40;aK=new aG(tJ,xJ,g=50,4,2,2,1,0,[5,6,7]);break;case 04:h=35;aK=new aG(tJ,xJ,g=55,4,3,3,2,0,[0,2,6]);break;case 05:h=30;aK=new aG(tJ,xJ,g=60,5,4,4,2,1,[1,3,5]);break;case 06:h=34;aK=new aG(tJ,xJ,g=60,5,5,5,3,2,[1,2,4,7]);break;case 07:h=33;aK=new aG(tJ,xJ,g=65,5,5,6,3,2,[0,1,2,3]);break;case 08:h=32;aK=new aG(tJ,xJ,g=70,5,5,6,3,2,[0,2,5,6]);break;case 09:h=31;aK=new aG(tJ,xJ,g=75,5,5,6,3,2,[1,4,5,7]);break;default:h=30;aK=new aG(tJ,xJ,g=80+(uJ-10)*5,5,5,6,3,2,[0,1,2,3]);break;}sK=g;if(rK<3){rK++ ;nK.text="${rK}x";}aK.NB(bB.wE,dL);aK.NB(bB.WD,eL);aK.NB(bB.xE,fL);aK.NB(bB.GE,gL);aK.x=20;aK.y=16;aK.TB=false;vK.q(aK);vJ.reset(h);vJ.nD("TimeShort",9);vJ.nD("TimeOver",0);vJ.pause();EK.cI=m;EK.wF=g;EK.y=-210;var k=new dB(EK,0.4,PB.EC);k.eB.y.aB(-90);xJ.add(k);var j=new CE(tJ,xJ,tJ.DD("ESCLevelBoxText").replaceAll("{0}","${g}"));wK.q(j);j.show((){aK.TB=true;vJ.start();if(zK!=null){var i=new VC(1.0,0.0,4.0,PB.WC);i.PC=(l){AL.LC.volume=l;AL.LC=AL.LC;};i.onComplete=(){AL.stop();fK.hI();};xJ.add(i);zK=null;}});} XL( g){iK.start();} QL( g){aK.XG(HC.FE);} eL( j){var g=0;var k=j.info["Position"];var h=j.info["Type"];if(h=="SingleLocked")g=3000;if(h=="SingleUnlocked")g=1000;if(h=="All")g=10000;var i=new vE(tJ,xJ,g);i.x=k.x;i.y=k.y;vK.q(i);tK=tK+g;lK.text="${tK}";} dL( j){var g=sK;var i=j.info["Length"];var k=j.info["Factor"];g=(g>i)?g-i:0;sK=g;EK.wF=g;if(g==0)aK.XG(HC.EE);var h=0;switch (i){case 3:h=1000;break;case 4:h=2000;break;case 5:h=5000;break;default:h=5000;break;}tK=tK+h*k;lK.text="${tK}";} fL( m){vJ.pause();iK.stop();var l=tJ.oB("Laugh");var k=tJ.oB("LevelUp");l.play();fK.MG(3);var g=sB.fG(tJ,xJ);g.x=55;g.y=260;vK.q(g);xJ.iB((){aK.CG();k.play();},2.0);xJ.iB((){var j=(vJ.sI*1000).toInt();var h=new vE(tJ,xJ,j);h.x=704;h.y=360;vK.q(h);tK=tK+j;lK.text="${tK}";},2.5);var i=new dB(EK,0.5,PB.EC);i.eB.y.aB(-210);i.ZC=3.0;xJ.add(i);xJ.iB((){vK.GC(g);},3.5);xJ.iB((){uJ++ ;cL();},4.0);} gL( i){iK.stop();aK.CG();var g;if(qK>0){qK-- ;g=new CE(tJ,xJ,tJ.DD("GEN2ndchancetime"));wK.q(g);tJ.oB("LevelUp").play();g.show((){xJ.iB(()=>cL(),0.5);var h=new dB(EK,0.5,PB.EC);h.eB.y.aB(-210);xJ.add(h);});}else{g=new CE(tJ,xJ,tJ.DD("GENtimeup"));wK.q(g);tJ.oB("GameOver").play();g.show((){xJ.iB(()=>kL(),0.5);var h=new dB(EK,0.5,PB.EC);h.eB.y.aB(-210);xJ.add(h);});}} TL( h){if(aK!=null&&rK>0){var g=aK.TG();if(g){rK=rK-1;nK.text="${rK}x";}}} VL( j){var h=new DB();h.q(new IB(new CB(800,600,false,0x000000)));h.alpha=0.6;xK.q(h);var g=new bG(tJ,xJ);g.x=235;g.y=150;xK.q(g);g.show(( i){xK.GC(g);if(i==false)xK.GC(h);else mL(false);});}kL(){var h=new DB();var j=new IB(tJ.w("ExitBox"));h.q(j);var g=new KC();g.NC=new ZD("Arial",30,0xFFFFFF,bold:true,align:CC.UC);g.width=240;g.height=200;g.wordWrap=true;g.text=tJ.DD("GENgameover");g.x=47;g.y=30+(g.height-g.pE)/2;g.TB=false;h.q(g);h.x=110;h.y=-h.height;wK.q(h);xJ.iB(()=>tJ.oB("Laugh").play(),0.3);var i=new dB(h,0.3,PB.EC);i.eB.y.aB(150);xJ.add(i);xJ.iB(()=>mL(true),5.0);h.NB(t.eC,( k)=>mL(true));}var nL=false; mL( g){vJ.pause();if(nL==false){nL=true;}}}class MB{var tJ;var xJ;var BK;var DK;var LK;var QK;var TK;var VK;var ZK;var dK;var hK;var mK;var oK;MB( i, j, h, g){tJ=i;xJ=j;BK=h;DK=g;LK=BB.VD;QK=-1000;TK=-1000;VK=false;ZK=false;dK=false;hK=null;mK=null;oK=null;} get color=>BK; set color( g){BK=g;} get direction=>DK; set direction( g){DK=g;} get JB=>LK; set JB( g){LK=g;} get fB=>VK; set fB( g){VK=g;} get OC=>ZK; set OC( g){ZK=g;} get empty=>dK; set empty( g){dK=g;} sD( g){var h=g!=null&&(g.color==BK||g.JB==BB.RB||LK==BB.RB)&&g.JB!=BB.IC&&LK!=BB.IC;return h;} gC( g){var h=g!=null&&(g.color==BK||g.JB==BB.RB||LK==BB.RB)&&g.direction==0&&DK==0&&g.JB!=BB.IC&&LK!=BB.IC;return h;} sC( g){var h=g!=null&&(g.color==BK||g.JB==BB.RB||LK==BB.RB)&&g.direction==1&&DK==1&&g.JB!=BB.IC&&LK!=BB.IC;return h;} get x=>QK; set x( g){QK=g;if(hK!=null)hK.x=g;if(mK!=null)mK.x=g;if(oK!=null)oK.x=g;} get y=>TK; set y( g){TK=g;if(hK!=null)hK.y=g;if(mK!=null)mK.y=g;if(oK!=null)oK.y=g;} set UG( g){if(hK!=null){hK.jB=hK.qB=1+0.3*VB.sin(g*VB.PI);}} rB( g, h, i){if(hK!=null){hK.parent.GC(hK);hK=null;}if(mK!=null){mK.parent.GC(mK);mK=null;}if(oK!=null){oK.parent.GC(oK);oK=null;}if(empty==false){switch (LK){case BB.RB:hK=new QJ(tJ,xJ,DK);hK.x=QK;hK.y=TK;g.q(hK);break;case BB.IC:hK=sB.HE(tJ,BB.IC);hK.x=QK;hK.y=TK;g.q(hK);break;default:hK=sB.DE(tJ,BK,DK);hK.x=QK;hK.y=TK;g.q(hK);break;}if(VK){mK=ZK?new NJ(tJ,xJ,DK):sB.eG(tJ,BK,DK);mK.x=QK+((DK==0)?25:0);mK.y=TK+((DK==1)?25:0);h.q(mK);}switch (LK){case BB.VD:break;case BB.IC:break;case BB.RB:break;default:oK=new PJ(tJ,xJ,LK);oK.x=QK;oK.y=TK;i.q(oK);break;}}}}class wE extends DB implements lB{var eK;var CK;wE( s, QB, o, n){eK=new List<uE>();CK=0.0;this.TB=false;var v=sB.DE(s,o,n);var m=new VB.Random();var j;var l;var FB;for(int h=0;h<=1;h++ ){for(int g=0;g<=1;g++ ){if(g==0&&h==0){j=VB.PI*1.15;SB=-VB.PI*2;}if(g==1&&h==0){j=VB.PI*1.85;SB=VB.PI*2;}if(g==1&&h==1){j=VB.PI*0.15;SB=VB.PI*2;}if(g==0&&h==1){j=VB.PI*0.85;SB=-VB.PI*2;}j=j+0.2*VB.PI*m.nextDouble();l=80.0+40.0*m.nextDouble();var k=new IB(v.FC);k.QI=new GB(g*25,h*25,25,25);k.QC=12.5+g*25;k.RC=12.5+h*25;k.x=g*25;k.y=h*25;q(k);var i=new uE();i.vF=k;i.VG=g*25+12.5;i.WG=h*25+12.5;i.angle=j;i.YG=l;i.SB=SB;eK.add(i);}}} zB( l){CK=VB.min(0.8,CK+l);var o=981.0;for(var g in eK){var h=g.vF;var i=g.angle;var j=g.YG;var k=g.SB;var m=g.VG+CK*(VB.cos(i)*j);var n=g.WG+CK*(VB.sin(i)*j+CK*o*0.5);h.x=m;h.y=n;h.SB=CK*k;}if(CK>=0.6){this.alpha=(0.8-CK)/0.2;}if(CK>=0.8){this.nE();}return (CK<0.8);}}class RJ extends DB{var tJ;var xJ;RJ( g){tJ=g;this.iI.listen(DL);}DL( h){xJ=bC.SD;var g=new OJ(tJ,xJ);q(new IB(tJ.w("Background")));q(g);g.start();}}var lC;var XD;var dC;var YD;var JC; main(){lC=new XC("Stage",kC.query('#stage'));XD=new KE();XD.KI(lC);CB.gF.webp=true;CB.CD("images/Loading.png").then((g){dC=new IB(g);dC.QC=20;dC.RC=20;dC.x=400;dC.y=270;lC.q(dC);JC=new KC();JC.NC=new ZD("Arial",20,0xA0A0A0,bold:true);JC.width=240;JC.height=40;JC.text="... loading ...";JC.x=400-JC.vI/2;JC.y=320;JC.TB=false;lC.q(JC);YD=new dB(dC,100,PB.WC);YD.eB.SB.aB(100.0*2.0*VB.PI);XD.SD.add(YD);lG();});} lG(){var g=new EB();g.mB("Background","images/Background.jpg");g.mB("ExitBox","images/ExitBox.png");g.mB("ExitButtonNormal","images/ExitButtonNormal.png");g.mB("ExitButtonPressed","images/ExitButtonPressed.png");g.mB("ExitGauge","images/ExitGauge.png");g.mB("ExitNoButtonNormal","images/ExitNoButtonNormal.png");g.mB("ExitNoButtonPressed","images/ExitNoButtonPressed.png");g.mB("ExitYesButtonNormal","images/ExitYesButtonNormal.png");g.mB("ExitYesButtonPressed","images/ExitYesButtonPressed.png");g.mB("InfoBox","images/InfoBox.png");g.mB("MessageBox","images/MessageBox.png");g.mB("ShuffleButtonNormal","images/ShuffleButtonNormal.png");g.mB("ShuffleButtonPressed","images/ShuffleButtonPressed.png");g.mB("TimeGauge","images/TimeGauge.png");g.QD("Alarm","images/AlarmTextureAtlas.json",pC.AD);g.QD("Head","images/HeadTextureAtlas.json",pC.AD);g.QD("Elements","images/ElementsTextureAtlas.json",pC.AD);g.QD("Levelup","images/LevelupTextureAtlas.json",pC.AD);g.QD("Locks","images/LocksTextureAtlas.json",pC.AD);g.ZB("BonusAllUnlock","sounds/BonusAllUnlock.mp3");g.ZB("BonusUniversal","sounds/BonusUniversal.mp3");g.ZB("ChainBlast","sounds/ChainBlast.mp3");g.ZB("ChainBlastSpecial","sounds/ChainBlastSpecial.mp3");g.ZB("ChainError","sounds/ChainError.mp3");g.ZB("ChainFall","sounds/ChainFall.mp3");g.ZB("ChainHelp","sounds/ChainHelp.mp3");g.ZB("ChainLink","sounds/ChainLink.mp3");g.ZB("ChainRotate","sounds/ChainRotate.mp3");g.ZB("Click","sounds/Click.mp3");g.ZB("GameOver","sounds/GameOver.mp3");g.ZB("Laugh","sounds/Laugh.mp3");g.ZB("LevelUp","sounds/LevelUp.mp3");g.ZB("PointsCounter","sounds/PointsCounter.mp3");g.ZB("Unlock","sounds/Unlock.mp3");g.ZB("Warning","sounds/Warning.mp3");g.ZB("Intro","sounds/Intro.mp3");g.yB("ESCAPE_INS_AIM_0","Connect at least 3 chain links of the same colour to a horizontal or vertical chain.");g.yB("ESCAPE_INS_DES_0","You can change the direction of a chain link by touching it.");g.yB("ESCAPE_INS_TIP_0","Earn extra points for connecting chain links displaying a key symbol.");g.yB("ESCBlockErrorHint","Sorry but block chains can´t be twisted!");g.yB("ESCLevelBoxText","Connect {0} chain links and help the crook to escape!");g.yB("ESCNoActionHint","Press on the chain links to twist them.");g.yB("ESCNoComboHint","You have to connect at least 3 chain links of the same colour.");g.yB("ESCStartText","Form horizontal or vertical same-colour chains and become an escape agent!");g.yB("ESCtogo","Chain links:");g.yB("GENexitquery","Do you really want to quit the game?");g.yB("GEN2ndchancetime","Time is up. Second chance!");g.yB("GENtimeup","Sorry! Your time is up.");g.yB("GENgameover","Game Over");g.load().then((j){lC.GC(dC);lC.GC(JC);XD.SD.remove(YD);lC.q(new RJ(g));}).catchError((i){for(var h in g.EG){print("Loading resouce failed: ${h.kind}.${h.name} - ${h.error}");}});}const SJ=const TJ();class TJ{const TJ();}class PE{var png;var jpg;var webp;var autoHiDpi;PE({this.png: true,this.jpg: true,this.webp: false,this.autoHiDpi: true});}class BF{static const  aE="none";static const  HH="touchPoint";}abstract class OB extends u{var SI=false;var TB=true;var kJ=true;var tabIndex=0;static const  PH=const tB<t>(t.iD);static const  bH=const tB<t>(t.WF);static const  gH=const tB<t>(t.gD);static const  mH=const tB<t>(t.YE);static const  vH=const tB<t>(t.cF); get onMouseOut=>OB.PH.forTarget(this); get onMouseMove=>OB.bH.forTarget(this); get onMouseDown=>OB.gH.forTarget(this); get onMouseUp=>OB.mH.forTarget(this); get onMouseWheel=>OB.vH.forTarget(this);static const  xH=const tB<WB>(WB.UF);static const  yH=const tB<WB>(WB.KF);static const  zH=const tB<WB>(WB.OF); get onTouchMove=>OB.xH.forTarget(this); get onTouchEnd=>OB.yH.forTarget(this); get onTouchCancel=>OB.zH.forTarget(this);static const  CI=const tB<SC>(SC.JF);static const  DI=const tB<SC>(SC.HF); get onKeyUp=>OB.CI.forTarget(this); get onKeyDown=>OB.DI.forTarget(this);static const  GI=const tB<ID>(ID.IF); get jI=>OB.GI.forTarget(this);}abstract class qC extends OB{final  fM=new List<u>();var uM=true;var KN=true; q( g){if(g.parent==this){var h=fM.indexOf(g);fM.removeAt(h);fM.add(g);}else{JI(g,fM.length);}} JI( g, h){if(h<0||h>fM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){fM.removeAt(fM.indexOf(g));if(h>fM.length)h-- ;fM.insert(h,g);}else{g.nE();g.wP(this);fM.insert(h,g);g.dispatchEvent(new AB(AB.wG,true));if(this.bC!=null)DQ(g,new AB(AB.BD));}} GC( h){var g=fM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");qI(g);} qI( g){if(g<0||g>=fM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=fM[g];h.dispatchEvent(new AB(AB.RH,true));if(this.bC!=null)DQ(h,new AB(AB.OD));h.wP(null);fM.removeAt(g);} contains( g){for(;g!=null;g=g.EP)if(g==this)return true;return false;} nB( o,[ g]){if(g==null)g=new GB.lJ();if(fM.length==0)return super.nB(o,g);var i=double.INFINITY;var j=double.INFINITY;var l=double.NEGATIVE_INFINITY;var k=double.NEGATIVE_INFINITY;var s=fM.length;for(int m=0;m<fM.length;m++ ){var n=fM[m];HP.hE(n.aP,o);var h=n.nB(HP,g);if(h.left<i)i=h.left;if(h.top<j)j=h.top;if(h.right>l)l=h.right;if(h.bottom>k)k=h.bottom;}g.x=i;g.y=j;g.width=l-i;g.height=k-j;return g;} pB( i, k){i=i.toDouble();k=k.toDouble();var n=null;for(int l=fM.length-1;l>=0;l-- ){var j=fM[l];if(j.jQ){var g=j.aP;var o=i-g.AC;var m=k-g.BC;var v=(g.d*o-g.c*m)/g.hC;var s=(g.a*m-g.b*o)/g.hC;var h=j.pB(v,s);if(h!=null){if(h is OB)if(h.TB)return uM?h:this;n=this;}}}return n;} gB( i){for(int g=0;g<fM.length;g++ ){var h=fM[g];if(h.jQ)i.RG(h);}}kQ( g, i){i.add(g);if(g is qC){var k=g as qC;var j=k.fM;for(int h=0;h<j.length;h++ ){kQ(j[h],i);}}}DQ( i, j){var g=kD.NG() as List<u>;kQ(i,g);for(int h=0;h<g.length;h++ ){g[h].dispatchEvent(j);}g.clear();kD.PG(g);}}class JD{static const  tG="exactFit";static const  BH="noBorder";static const  JH="noScale";static const  SF="showAll";}class KB{var pL;var tL;KB( h, g):pL=h,tL=g;KB.lJ():this(0,0); clone()=>new KB(pL,tL); toString()=>"Point [x=${pL}, y=${tL}]"; get x=>pL; get y=>tL; get length=>VB.sqrt(pL*pL+tL*tL);set x( g){pL=g;}set y( g){tL=g;} add( g){return new KB(pL+g.x,tL+g.y);} subtract( g){return new KB(pL-g.x,tL-g.y);}rD( g){pL=g.x;tL=g.y;} DG( g){return pL==g.x&&tL==g.y;}}class GB{var pL;var tL;var AM;var NM;GB( i, g, h, j):pL=i,tL=g,AM=h,NM=j;GB.lJ():this(0,0,0,0); clone()=>new GB(pL,tL,AM,NM); toString()=>"Rectangle [x=${pL}, y=${tL}, width=${AM}, height=${NM}]"; get x=>pL; get y=>tL; get width=>AM; get height=>NM; get left=>pL; get top=>tL; get right=>pL+AM; get bottom=>tL+NM; get size=>new KB(AM,NM);set x( g){pL=g;}set y( g){tL=g;}set width( g){AM=g;}set height( g){NM=g;}set bottom( g){this.height=g-tL;}set left( g){pL=g;}set right( g){AM=g-pL;}set top( g){tL=g;} contains( g, h){return pL<=g&&tL<=h&&pL+AM>=g&&tL+NM>=h;} DG( g){return pL==g.x&&tL==g.y&&AM==g.width&&NM==g.height;} get isEmpty{return AM==0&&NM==0;}rD( g){pL=g.x;tL=g.y;AM=g.width;NM=g.height;} union( g){var i=VB.min(this.left,g.left);var h=VB.min(this.top,g.top);var j=VB.max(this.right,g.right);var k=VB.max(this.bottom,g.bottom);return new GB(i,h,j-i,k-h);} align(){var h=this.left.floor();var g=this.top.floor();var i=this.right.ceil();var j=this.bottom.ceil();return new GB(h,g,i-h,j-g);}}class NE{var fC;var tC;}class WB extends AB{static const  GF="touchBegin";static const  KF="touchEnd";static const  OF="touchCancel";static const  UF="touchMove";static const  QH="touchOver";static const  UH="touchOut";var JP;var MP;var OP,PP;var RP,TP;var jN;var OO;var rN;var zN;var XP;var YP;var ZP;WB( g,[ h=false]):super(g,h){cP(g,h);} cP( g,[ h=false]){super.cP(g,h);JP=0;MP=false;OP=PP=0;RP=TP=0;jN=false;OO=false;rN=false;zN=false;XP=1.00;YP=0;ZP=0;}set uP( g){OP=g.x;PP=g.y;}set vP( g){RP=g.x;TP=g.y;} get AE=>JP; get kE=>OP; get lE=>PP; get altKey=>jN; get ctrlKey=>rN; get shiftKey=>zN;}class wC{static const  sG=0;static const  xG=1;static const  dF=2;static const  IH=3;static const  RF=4;}class DB extends qC{var YJ=false;var sE=false;var jE=null;var xM=null;var PN=null;fP(){var i=this.uD;var j=this.bC;var m=this.visible;if(i!=null&&this.bC!=null){var h=nC.NH;if(h!=null){var g=aP.BE(i);if(g.x<h.left)g.x=h.left;if(g.x>h.right)g.x=h.right;if(g.y<h.top)g.y=h.top;if(g.y>h.bottom)g.y=h.bottom;i=aP.zF().BE(g);}var l=new KB(JN,VN).add(i).subtract(nC.KH);var k=aP.BE(l);this.visible=false;PN=j.pB(j.eI,j.fI);this.x=k.x;this.y=k.y;this.visible=m;}} nB( h,[ g]){if(g==null)g=new GB.lJ();super.nB(h,g);if(xM!=null){g=xM.VQ(h).union(g);}return g;} pB( i, j){var h=null;if(this.jE!=null){var g=this.qE(this.jE);if(g!=null){var k=i*g.a+j*g.c+g.AC;var l=i*g.b+j*g.d+g.BC;if(this.jE.pB(k,l)!=null){h=this;}}}else{h=super.pB(i,j);if(h==null&&xM!=null){if(xM.ZQ(i,j)){h=this;}}}return h;}gB( g){if(xM!=null)xM.gB(g);super.gB(g);}}class IB extends u{var EM;var SM;var kM;IB([ h=null, g="auto"]){this.FC=h;this.oI=g;kM=null;} get FC=>EM;set FC( g){if(g==null)EM=null;if(g is CB)EM=g;}set oI( g){if(g is String)SM=g;}set QI( g){if(g==null)kM=null;if(g is GB)kM=g;} nB( k,[ j]){var g=EM;var h=0,i=0;if(g!=null){h=g.width;i=g.height;}return eE(k,h,i,j);} pB( h, i){var g=EM;if(g==null)return null;if(h<0.0||i<0)return null;if(h>=g.width||i>=g.height)return null;return this;} gB( h){var g=EM;if(g==null)return;if(kM==null){g.gB(h);}else{g.QG(h,kM);}}}class UJ extends TC{var JM;var YM;UJ( i, h, g){JM=h;YM=g;} get LC=>YM;set LC( g){YM=g;} stop(){}}class IE implements lB{final  MM;var UM=0.0;var jM=0.0;var qM=1;IE( g, h):MM=g{jM=VB.max(h,0.0001);} zB( h){var g=UM+h;while (g>=jM&&qM>0){UM=jM;qM-- ;MM();g-= jM;}UM=g;return (qM>0);} get ED=>jM; get currentTime=>UM;}abstract class LE{ gB( g);}class uC extends OB{var upState;var overState;var downState;var hitTestState;var sE=true;var enabled=true;var gN;uC([this.upState,this.overState,this.downState,this.hitTestState]){NB(t.bF,TO);NB(t.iD,TO);NB(t.gD,TO);NB(t.YE,TO);gN=this.upState;} nB( h,[ g]){if(gN!=null){HP.hE(gN.aP,h);return gN.nB(HP,g);}return super.nB(h,g);} pB( k, l){if(this.hitTestState!=null){var g=this.hitTestState.aP;var h=k-g.AC;var i=l-g.BC;var m=(g.d*h-g.c*i)/g.hC;var j=(g.a*i-g.b*h)/g.hC;if(this.hitTestState.pB(m,j)!=null)return this;}return null;} gB( g){if(gN!=null)g.RG(gN);} TO( g){if(g.type==t.iD){gN=upState;}else{gN=g.YC?downState:overState;}}}class oG{}final  SE=new Map<String,ZE>();class ID extends AB{static const  IF="textInput";var uL="";ID( g,[ h=false]):super(g,h); get text=>uL;}abstract class QE{var jC=null;var border=false;var borderColor=0xFF000000;var borderWidth=1;var GN;QE();factory QE.nJ( i, g, h, j){return new WJ(i,g,h,j);}LI( h, g){GN=h.context;GN.setTransform(g.a,g.b,g.c,g.d,g.AC,g.BC);GN.beginPath();bP();GN.save();GN.clip();}UI(){GN.restore();if(border){GN.strokeStyle=YF(borderColor);GN.lineWidth=borderWidth;GN.lineCap="round";GN.lineJoin="round";GN.stroke();}}bP();}class KE{var rL;var GM;var QM;var dM;var RN;var dN;var oN;var AO;KE(){rL=new LB();GM=new List<XC>();QM=-1;RN=false;dN=new MF(0);oN=new ZF();AO=new fF();dM=yO;CP();} get SD=>rL;CP(){kC.window.requestAnimationFrame(dM);}yO( g){CP();g=g.toDouble();if(QM==-1)QM=g;if(QM>g)QM=g;var j=g-QM;var i=j/1000.0;var k=g/1000.0;var l=false;if(j>=1){QM=g;dN.LN=i;kF.dispatchEvent(dN);rL.zB(i);for(int h=0;h<GM.length;h++ ){GM[h].SD.zB(i);}if(RN){RN=false;pF.dispatchEvent(AO);}for(int h=0;h<GM.length;h++ ){GM[h].dI(k,i);}mF.dispatchEvent(oN);}} KI( g){if(g.oE!=null){g.oE.rI(g);}GM.add(g);g.IQ=this;} rI( g){if(g.oE==this){GM.remove(g);g.IQ=null;}}}class nG{}class HB{var qL,sL,vL,wL,zL,CM;var OM;HB( h, i, g, j, k, l):qL=h.toDouble(),sL=i.toDouble(),vL=g.toDouble(),wL=j.toDouble(),zL=k.toDouble(),CM=l.toDouble(),OM=(h*j-i*g).toDouble();HB.pJ():qL=1.0,sL=0.0,vL=0.0,wL=1.0,zL=0.0,CM=0.0,OM=1.0; clone(){return new HB(qL,sL,vL,wL,zL,CM);} zF(){var h=(wL/OM);var i=-(sL/OM);var g=-(vL/OM);var j=(qL/OM);var k=-(h*zL+g*CM);var l=-(i*zL+j*CM);return new HB(h,i,g,j,k,l);} get a=>qL; get b=>sL; get c=>vL; get d=>wL; get AC=>zL; get BC=>CM; get hC=>OM; BE( h){var i=h.x.toDouble();var g=h.y.toDouble();return new KB(i*qL+g*vL+zL,i*sL+g*wL+CM);} yP( h){var i=h.x.toDouble();var g=h.y.toDouble();return new KB(i*qL+g*vL+zL,i*sL+g*wL+CM);} concat( g){var m=qL;var s=sL;var v=vL;var o=wL;var l=zL;var n=CM;var QB=OM;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var UB=g.AC;var FB=g.BC;var kB=g.hC;qL=(m*j+s*i).toDouble();sL=(m*k+s*h).toDouble();vL=(v*j+o*i).toDouble();wL=(v*k+o*h).toDouble();zL=(l*j+n*i+UB).toDouble();CM=(l*k+n*h+FB).toDouble();OM=(QB*kB).toDouble();} XI(){qL=1.0;sL=0.0;vL=0.0;wL=1.0;zL=0.0;CM=0.0;OM=1.0;} HG(){var j=qL;var m=sL;var l=vL;var k=wL;var h=zL;var i=CM;var g=OM;qL=(k/g).toDouble();sL=-(m/g).toDouble();vL=-(l/g).toDouble();wL=(j/g).toDouble();zL=-(qL*h+vL*i).toDouble();CM=-(sL*h+wL*i).toDouble();OM=(1.0/g).toDouble();} scale( h, g){qL=(qL*h).toDouble();sL=(sL*g).toDouble();vL=(vL*h).toDouble();wL=(wL*g).toDouble();zL=(zL*h).toDouble();CM=(CM*g).toDouble();OM=(OM*h*g).toDouble();} translate( g, h){zL=(zL+g).toDouble();CM=(CM+h).toDouble();} wD( h, i, g, k, j, l){qL=h.toDouble();sL=i.toDouble();vL=g.toDouble();wL=k.toDouble();zL=j.toDouble();CM=l.toDouble();OM=(qL*wL-sL*vL).toDouble();} rD( g){qL=g.a.toDouble();sL=g.b.toDouble();vL=g.c.toDouble();wL=g.d.toDouble();zL=g.AC.toDouble();CM=g.BC.toDouble();OM=g.hC.toDouble();} hE( h, g){var n=h.a;var v=h.b;var FB=h.c;var s=h.d;var m=h.AC;var o=h.BC;var UB=h.hC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var kB=g.AC;var QB=g.BC;var cC=g.hC;qL=(n*k+v*j).toDouble();sL=(n*l+v*i).toDouble();vL=(FB*k+s*j).toDouble();wL=(FB*l+s*i).toDouble();zL=(m*k+o*j+kB).toDouble();CM=(m*l+o*i+QB).toDouble();OM=(UB*cC).toDouble();}}class bD extends u{static const  UE='DIRECTION_UP';static const  LF='DIRECTION_RIGHT';static const  XE='DIRECTION_DOWN';static const  hD='DIRECTION_LEFT';var xN;var DO;var EM;var kM;bD( h,[ g=hD]){if(g!=UE&&g!=XE&&g!=hD&&g!=LF){throw new ArgumentError('Invalid Gauge direction!');}xN=g;DO=1.0;EM=h;kM=new GB.lJ();LP();} get ratio=>DO;set ratio( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;DO=g;LP();} get FC=>EM;set FC( g){EM=g;LP();}LP(){if(EM==null){kM.left=0;kM.top=0;kM.right=0;kM.bottom=0;}else{var h=EM.width;var g=EM.height;switch (xN){case hD:kM.left=((1.0-DO)*h).toInt();kM.top=0;kM.right=h;kM.bottom=g;break;case UE:kM.left=0;kM.top=((1.0-DO)*g).toInt();kM.right=h;kM.bottom=g;break;case LF:kM.left=0;kM.top=0;kM.right=(DO*h).toInt();kM.bottom=g;break;case XE:kM.left=0;kM.top=0;kM.right=h;kM.bottom=(DO*g).toInt();break;}}} nB( i,[ g]){var h=(EM!=null)?EM.width:0;var j=(EM!=null)?EM.height:0;return eE(i,h,j,g);} pB( g, h){if(EM!=null&&g>=0.0&&h>=0.0&&g<EM.width&&h<EM.height)return this;return null;} gB( g){if(EM!=null)EM.QG(g,kM);}}abstract class u extends MC implements LE{static var CH=0;var mM=CH++ ;var pL=0.0;var tL=0.0;var JN=0.0;var VN=0.0;var bN=1.0;var kN=1.0;var qN=0.0;var vN=0.0;var EO=0.0;var KO=1.0;var NO=true;var QO=false;var XO=null;var cO=null;var iO=null;var mO=false;var sO=null;var uO=null;var xO=null;var KM="";var EP=null;final  HP=new HB.pJ();final  KP=new HB.pJ();var QP=true;static const  rH=const tB<AB>(AB.BD); get iI=>u.rH.forTarget(this); get x=>pL; get y=>tL; get QC=>JN; get RC=>VN; get jB=>bN; get qB=>kN; get skewX=>qN; get skewY=>vN; get SB=>EO; get visible=>NO; get alpha=>KO; get NI=>cO!=null; get qD=>xO; get name=>KM; get parent=>EP; get uD{var g=this.bC;return (g!=null)?this.iC(g.PQ):null;} get eI{var g=this.uD;return (g!=null)?g.x:0.0;} get fI{var g=this.uD;return (g!=null)?g.y:0.0;} get root{var g=this;while (g.EP!=null)g=g.EP;return g;} get bC{var g=this.root;return (g is XC)?g:null;}set x( g){if(g is num)pL=g;QP=true;}set y( g){if(g is num)tL=g;QP=true;}set QC( g){if(g is num)JN=g;QP=true;}set RC( g){if(g is num)VN=g;QP=true;}set jB( g){if(g is num)bN=g;QP=true;}set qB( g){if(g is num)kN=g;QP=true;}set skewX( g){if(g is num)qN=g;QP=true;}set skewY( g){if(g is num)vN=g;QP=true;}set SB( g){if(g is num)EO=g;QP=true;}set visible( g){if(g is bool)NO=g;}set alpha( g){if(g is num)KO=g;}set mask( g){XO=g;}set qD( g){xO=g;} setTransform( k, l,[ n, g, h, o, j, i, m]){if(k is num)pL=k;if(l is num)tL=l;if(n is num)bN=n;if(g is num)kN=g;if(h is num)EO=h;if(o is num)qN=o;if(j is num)vN=j;if(i is num)JN=i;if(m is num)VN=m;QP=true;} get width=>nB(aP).width; get height=>nB(aP).height; set width( h){this.jB=1;var g=this.width;this.jB=(g!=0.0)?h/g:1.0;} set height( h){this.qB=1;var g=this.height;this.qB=(g!=0.0)?h/g:1.0;} nE(){if(EP!=null)EP.GC(this);} get jQ=>NO&&!QO; get aP{if(QP){QP=false;var j=qN+EO;var i=vN+EO;if(j==0.0&&i==0.0){KP.wD(bN,0.0,0.0,kN,pL-JN*bN,tL-VN*kN);}else{var g,l,k,h;var m=VB.cos(j);var n=VB.sin(j);if(j==i){g=bN*m;l=bN*n;k=-kN*n;h=kN*m;}else{g=bN*VB.cos(i);l=bN*VB.sin(i);k=-kN*n;h=kN*m;}var s=pL-(JN*g+VN*k);var o=tL-(JN*l+VN*h);KP.wD(g,l,k,h,s,o);}}return KP;} qE( h){if(h==EP)return aP.clone();if(h.EP==this)return h.aP.zF();var j=new HB.pJ();var g=this;while (g!=h&&g.EP!=null){j.concat(g.aP);g=g.EP;}if(h==null&&g!=null){j.concat(g.aP);g=null;}if(g==h)return j;var k=new HB.pJ();var i=h;while (i!=this&&i.EP!=null){k.concat(i.aP);i=i.EP;}k.HG();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} nB( h,[ g]){if(g==null)g=new GB.lJ();g.x=h.AC;g.y=h.BC;g.width=0;g.height=0;return g;} pB( g, h){if(nB(dE).contains(g,h))return this;return null;} iC( h){HP.XI();for(u g=this;g!=null;g=g.EP)HP.concat(g.aP);HP.HG();return HP.BE(h);} cQ( g){g.context.translate(iO.x,iO.y);cO.gB(g);} dispatchEvent( h){var g=null;if(h.pD||h.bubbles){for(u j=EP;j!=null;j=j.EP){if(j.jP(h.type,h.pD,h.bubbles)){if(g==null)g=kD.NG() as List<u>;g.add(j);}}}if(h.pD&&g!=null){for(int i=g.length-1;i>=0&&h.yD==false;i-- ){g[i].GP(h,this,g[i],mC.EF);}}if(h.yD==false){GP(h,this,this,mC.dD);}if(h.bubbles&&g!=null){for(int i=0;i<g.length&&h.yD==false;i++ ){g[i].GP(h,this,g[i],mC.EH);}}if(g!=null){g.clear();kD.PG(g);}} wP( h){for(var g=h;g!=null;g=g.EP)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");EP=h;} gB( g);}abstract class cB{static  CD( g,[ h=null]){switch (zC.VH){case "WebAudioApi":return ME.CD(g,h);case "AudioElement":return JE.CD(g,h);default:return rC.CD(g,h);}}static var gF=new oC(mp3:true,mp4:true,ogg:true,wav:true); get length; play([ h=false, g]);}abstract class TC extends MC{ get LC; set LC( g); stop();}class oC{var mp3;var mp4;var ogg;var wav;var ignoreErrors;oC({this.mp3: false,this.mp4: false,this.ogg: false,this.wav: false,this.ignoreErrors: true});}class XB{var volume;var pan;var fJ=1;var gJ=0;var jJ=1;var iJ=0;XB([this.volume=1,this.pan=0]);}class zC{static var VH=kH();static var jD=sH();static var hF=tH();static  kH(){var h=(jD!=null)?"WebAudioApi":"AudioElement";var g=kC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(hF.length==0)h="Mock";print("StageXL: supported audio engine is: ${h}");return h;}static  sH(){if(tE.AudioContext.supported)return new tE.AudioContext();return null;}static  tH(){var g=new List<String>();var h=new kC.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/mp4",""))!=-1)g.add("mp4");if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("StageXL: supported audio types are: ${g}");return g;}static  tF( i, h){var l=new RegExp(r"(mp3|mp4|ogg|wav)$",multiLine:false,caseSensitive:true);var g=hF.toList();var k=l.firstMatch(i);var j=new List<String>();if(k==null){throw new ArgumentError("Unsupported file extension.");}if(g.length==0){throw new UnsupportedError("This browser supports no known audio codec.");}if(!h.mp3)g.remove("mp3");if(!h.mp4)g.remove("mp4");if(!h.ogg)g.remove("ogg");if(!h.wav)g.remove("wav");var m=k.group(1);if(g.contains(m)){j.add(i);g.remove(m);}for(var n in g){j.add(i.replaceAll(l,n));}return j;}}class JE extends cB{var LM;var aM;var tM;JE(){tM=new List<cD>();LM=new kC.AudioElement();LM.onEnded.listen(GO);aM=new List<kC.AudioElement>();aM.add(LM);kC.document.body.children.add(LM);}static  CD( l,[ g=null]){if(g==null)g=cB.gF;var n=new JE();var h=n.LM;var i=zC.tF(l,g);var j=new YB.Completer<cB>();if(i.length==0){return rC.CD(l,g);}var k;var m;FB(s){k.cancel();m.cancel();j.complete(n);}o(s){if(i.length>0){h.src=i.removeAt(0);h.load();}else{k.cancel();m.cancel();if(g.ignoreErrors){rC.CD(l,g).then((v)=>j.complete(v));}else{j.completeError(new StateError("Failed to load audio."));}}}k=h.onCanPlayThrough.listen(FB);m=h.onError.listen(o);h.src=i.removeAt(0);h.load();return j.future;} get length{return LM.duration;} play([ h=false, g]){if(g==null)g=new XB();return new cD(this,h,g);} YO( h){var g;if(aM.length==0){g=LM.clone(true);g.onEnded.listen(GO);}else{g=aM.removeAt(0);}tM.add(h);return g;} mP( g){var h=g.LM;var i=tM.indexOf(g);tM.removeAt(i);aM.add(h);if(LM.currentTime>0&&LM.ended==false)LM.currentTime=0;} GO( j){var i=j.target;var g=null;for(int h=0;h<tM.length&&g==null;h++ )if(tM[h].LM==i)g=tM[h];if(g!=null)g.stop();}}class cD extends TC{var VM;var LM;var JM;var YM;cD( g, i, h){VM=g;JM=i;YM=h;LM=g.YO(this);LM.loop=JM;this.LC=h;LM.play();} get LC=>YM; set LC( g){YM=g;if(LM!=null)LM.volume=(YM!=null)?YM.volume:1;} stop(){if(LM!=null){if(LM.ended==false)LM.pause();VM.mP(this);LM=null;}}}class ME extends cB{var IM;ME(){if(zC.jD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  CD( i,[ g=null]){if(g==null)g=cB.gF;var m=new ME();var h=new YB.Completer<cB>();var j=zC.tF(i,g);var v=zC.jD;if(j.length==0){return rC.CD(i,g);}FB(n){v.decodeAudioData(n.response).then(( s){m.IM=s;h.complete(m);}).catchError((o){if(g.ignoreErrors){rC.CD(i,g).then((k)=>h.complete(k));}else{h.completeError(new StateError("Failed to decode audio."));}});}l(o){if(j.length>0){kC.HttpRequest.request(j.removeAt(0),responseType:'arraybuffer').then(FB).catchError(l);}else{if(g.ignoreErrors){rC.CD(i,g).then((k)=>h.complete(k));}else{h.completeError(new StateError("Failed to load audio."));}}}l(null);return h.future;} get length{return IM.duration;} play([ h=false, g]){if(g==null)g=new XB();return new VJ(this,h,g);}}class VJ extends TC{var RM;var YM;var JM;var AN;var UN;VJ( j, h, i){RM=j;JM=h;YM=i;var g=zC.jD;AN=g.createGain();AN.connectNode(g.destination,0,0);AN.gain.value=(YM!=null)?VB.pow(YM.volume,2):1;UN=g.createBufferSource();UN.buffer=RM.IM;UN.loop=h;UN.connectNode(AN,0,0);UN.start(0);} get LC=>YM; set LC( g){YM=g;AN.gain.value=(YM!=null)?VB.pow(YM.volume,2):1;} stop(){UN.stop(0);}}class rC extends cB{rC(){}static  CD( g,[ h=null]){return new YB.Future<cB>.value(new rC());} get length{return double.NAN;} play([ h=false, g]){if(g==null){g=new XB();}return new UJ(this,h,g);}}class mC{static const  EF=1;static const  dD=2;static const  EH=3;}class aD extends AB{aD( g):super(g,false); get pD=>false;}class KC extends OB{var uL="";var WM=null;var oM=pG.aE;var DN=vC.uG;var WN=0;var fN=0;var mN=0.0;var tN=0.0;var BO=0.0;var JO=0.0;var MO=0.0;var RO=false;var VO=false;var ZO=false;var hO=false;var lO=false;var oO="•";var rO=0x000000;var vO=0x000000;var AP=0;var AM=100;var NM=100;var DP=0.0;var FP=0.0;final  IP=new List<HD>();var NP=true;var VP=null;var GN=null;KC([ h, g]){this.text=(h!=null)?h:"";this.NC=(g!=null)?g:new ZD("Arial",12,0x000000);this.onKeyDown.listen(lP);this.jI.listen(oP);this.onMouseDown.listen(rP);} get text=>uL; get type=>DN; get border=>lO; get borderColor=>vO; get width=>AM; get height=>NM; set text( g){uL=g.replaceAll('\r\n','\n').replaceAll('\r','\n');WN=uL.length;NP=true;} set NC( g){WM=g.clone();NP=true;} set wordWrap( g){RO=g;NP=true;} set width( g){AM=g.toDouble();NP=true;} set height( g){NM=g.toDouble();NP=true;} get vI{bQ();return DP;} get pE{bQ();return FP;} nB( h,[ g]){return eE(h,AM,NM,g);} pB( g, h){if(g>=0&&h>=0&&g<AM&&h<NM)return this;return null;} gB( i){bQ();mN+= i.RI;var g=i.GN;g.drawImageScaled(VP,0.0,0.0,AM,NM);if(DN==vC.MD){var h=this.bC;if(h!=null&&h.focus==this&&mN.remainder(0.8)<0.4){g.fillStyle=ND(WM.color);g.fillRect(tN,BO,JO,MO);}}}gQ( kB){IP.clear();var j=0;var h='';var n='';var cC=0;var k=WM.size.toDouble();var xI=WM.leftMargin.toDouble();var yI=WM.topMargin.toDouble();var zI=WM.align.toString();var UB=kB.oD.toDouble();var AJ=kB.iE.toDouble();for(var QB in uL.split('\n')){if(RO==false){IP.add(new HD.mJ(QB,j));j+= QB.length+1;}else{h=null;for(var FB in QB.split(' ')){n=h;h=(n==null)?FB:"${n} ${FB}";h=iQ(h);cC=GN.measureText(h).width.toDouble();if(cC>=AM){if(n==null){IP.add(new HD.mJ(h,j));j+= h.length+1;h=null;}else{IP.add(new HD.mJ(n,j));j+= n.length+1;h=iQ(FB);}}}if(h!=null){IP.add(new HD.mJ(h,j));j+= h.length+1;}}}DP=0.0;FP=0.0;var s=0.0;var v=yI+k;for(int i=0;i<IP.length;i++ ){var g=IP[i];if(g is !HD)continue;var o=GN.measureText(g.uL).width.toDouble();switch (zI){case CC.UC:case CC.GH:s=(AM-o)/2;break;case CC.dF:case CC.AH:s=(AM-o);break;default:s=xI;}g.pL=s;g.tL=v;g.AM=o;g.NM=k;g.EN=UB;g.SN=AJ;g.aN=0.0;v=v+k;DP=VB.max(DP,o);FP=FP+k;}if(DN==vC.MD){for(int i=IP.length-1;i>=0;i-- ){var g=IP[i];if(g is !HD)continue;if(WN>=g.BM){var BJ=WN-g.BM;var CJ=g.uL.substring(0,BJ);fN=i;tN=g.pL+GN.measureText(CJ).width.toDouble();BO=g.tL-UB*0.9;JO=1.0;MO=k;break;}}var l=0.0;var m=0.0;while (l+tN>AM)l-= AM*0.2;while (l+tN<0)l+= AM*0.2;while (m+BO+MO>NM)m-= k;while (m+BO<0)m+= k;tN+= l;BO+= m;for(int i=0;i<IP.length;i++ ){var g=IP[i];if(g is !HD)continue;g.pL+= l;g.tL+= m;}}} iQ( g){if(g is !String)return g;if(ZO==false)return g;var h="";for(int i=0;i<g.length;i++ ){h="${h}${oO}";}return h;}bQ({ calculateOnly: false}){if(NP){NP=false;var h=(XC.cE?mD:1.0)/lD;var k=(AM*h).ceil();var i=(NM*h).ceil();if(VP==null){VP=new kC.CanvasElement(width:k,height:i);GN=VP.context2D;}if(VP.width!=k)VP.width=k;if(VP.height!=i)VP.height=i;var g="${WM.size}px ${WM.font},sans-serif";if(WM.bold)g="bold ${g}";if(WM.italic)g="italic ${g}";GN.font=g;GN.textAlign="start";GN.textBaseline="alphabetic";GN.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);gQ(FH(g));if(calculateOnly){NP=true;return;}GN.setTransform(h,0.0,0.0,h,0.0,0.0);if(hO){GN.fillStyle=ND(rO);GN.fillRect(0,0,AM,NM);}else{GN.clearRect(0,0,AM,NM);}GN.fillStyle=ND(WM.color);for(int l=0;l<IP.length;l++ ){var j=IP[l];GN.fillText(j.uL,j.pL,j.tL);}if(lO){GN.strokeStyle=ND(vO);GN.lineWidth=1;GN.strokeRect(0,0,AM,NM);}}}lP( v){if(DN==vC.MD){bQ(calculateOnly:true);var l=uL;var n=l.length;var j=IP;var g=WN;var i=fN;var h=-1;switch (v.keyCode){case kC.KeyCode.BACKSPACE:if(g>0){uL=l.substring(0,g-1)+l.substring(g);h=g-1;}break;case kC.KeyCode.END:var m=j[i];h=m.BM+m.uL.length;break;case kC.KeyCode.HOME:var m=j[i];h=m.BM;break;case kC.KeyCode.LEFT:if(g>0){h=g-1;}break;case kC.KeyCode.UP:if(i>0&&i<j.length){var o=j[i];var k=j[i-1];var s=VB.min(g-o.BM,k.uL.length);h=k.BM+s;}else{h=0;}break;case kC.KeyCode.RIGHT:if(g<n){h=g+1;}break;case kC.KeyCode.DOWN:if(i>=0&&i<j.length-1){var o=j[i];var k=j[i+1];var s=VB.min(g-o.BM,k.uL.length);h=k.BM+s;}else{h=n;}break;case kC.KeyCode.DELETE:if(g<n){uL=l.substring(0,g)+l.substring(g+1);h=g;}break;}if(h!=-1){WN=h;mN=0.0;NP=true;}}}oP( j){if(DN==vC.MD){var i=uL.length;var h=WN;var g=j.text;if(g=='\r')g='\n';if(g=='\n'&&VO==false)g='';if(g=='')return;if(AP!=0&&i>=AP)return;uL=uL.substring(0,h)+g+uL.substring(h);WN=WN+g.length;mN=0.0;NP=true;}}rP( n){var UB=n.kE.toDouble();var l=n.lE.toDouble();if(GN==null)return;GN.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);for(int i=0;i<IP.length;i++ ){var g=IP[i];if(g is !HD)continue;var m=g.uL;var QB=g.pL;var v=g.tL-g.EN;var FB=g.tL+g.SN;if(v<=l&&FB>=l){var o=double.INFINITY;var j=0;for(var h=0;h<=m.length;h++ ){var s=GN.measureText(m.substring(0,h)).width.toDouble();var k=(QB+s-UB).abs();if(k<o){o=k;j=h;}}WN=g.BM+j;mN=0.0;NP=true;}}}}class AF{final  rE;AF(this.rE);call( h, g){zM(h).aB(g);} get x=>zM("x"); get y=>zM("y"); get jB=>zM("scaleX"); get qB=>zM("scaleY"); get skewX=>zM("skewX"); get skewY=>zM("skewY"); get QC=>zM("pivotX"); get RC=>zM("pivotY"); get SB=>zM("rotation"); get alpha=>zM("alpha"); zM( h){var g=new xB(h);this.rE.zM(g);return g;}}class vC{static const  uG="dynamic";static const  MD="input";}class ZD{var font;var size;var color;var bold;var italic;var underline;var align;var topMargin;var leftMargin;var rightMargin;var indent;var leading;ZD(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.topMargin: 0.0,this.leftMargin: 0.0,this.rightMargin: 0.0,this.indent: 0.0,this.leading: 0.0}); clone(){return new ZD(font,size,color,bold:bold,italic:italic,underline:underline,align:align,topMargin:topMargin,leftMargin:leftMargin,rightMargin:rightMargin,indent:indent,leading:leading);}}class CC{static const  UC="center";static const  AH="end";static const  GH="justify";static const  dF="right";}class HD{var uL;var BM;var pL=0.0;var tL=0.0;var AM=0.0;var NM=0.0;var EN=0.0;var SN=0.0;var aN=0.0;HD.mJ(this.uL,this.BM); get x=>pL; get y=>tL; get width=>AM; get height=>NM; get oD=>EN; get iE=>SN; get leading=>aN;}class yC{final  matrix=new HB.pJ();var alpha=1.0;var qD=eD.fD;var MN; get gI{if(MN==null)MN=new yC();return MN;}}class pC{static const  vG="json";static const  AD="jsonarray";}class AB{static const  wG="added";static const  BD="addedToStage";static const  PF="enterFrame";static const  VF="exitFrame";static const  RH="removed";static const  OD="removedFromStage";static const  XH="resize";static const  eF="render";static const  oF="progress";var DN;var dP;var eP;var ZM;var gP;var hP;var kP;AB( g,[ h=false]){cP(g,h);} cP( g,[ h=false]){DN=g;dP=h;eP=mC.dD;ZM=null;gP=null;hP=false;kP=false;} get yD=>hP; get type=>DN; get bubbles=>dP; get pD=>true; get target=>ZM;}abstract class qG{}class MC{var FM;var gM; NB( g, h(event),{ useCapture: false}){return eN(g,useCapture).listen(h);}dispatchEvent( g){GP(g,this,this,mC.dD);} jP( h, j, i){if(j&&gM!=null){var g=gM[h];if(g!=null&&g.tO)return true;}if(i&&FM!=null){var g=FM[h];if(g!=null&&g.tO)return true;}return false;} eN( h, g){if(g){if(gM==null)gM=new Map<String,xC>();}else{if(FM==null)FM=new Map<String,xC>();}var i=g?gM:FM;return i.putIfAbsent(h,(){return new xC(this,h,g);});}GP( g, k, l, j){var h=(j==mC.EF)?gM:FM;if(h==null)return;var i=h[g.type];if(i==null)return;g.ZM=k;g.gP=l;g.eP=j;g.hP=false;g.kP=false;i.dispatchEvent(g);}}class xC<LD extends AB> extends YB.Stream<LD>{final  ZM;final  PM;final  sM;var ON=[] ;xC(this.ZM,this.PM,this.sM); get isBroadcast=>true; asBroadcastStream({ onListen( subscription), onCancel( subscription)})=>this; get tO=>ON.length>0; listen( i( event),{ onError(error), onDone(), cancelOnError: false}){var h=new FF<LD>(this,i);ON.add(h);if(sM==false){var g=this;switch (PM){case AB.PF:kF.fE(g);break;case AB.VF:mF.fE(g);break;case AB.eF:pF.fE(g);break;}}return h;}OI( j){if(j.IN)return;var i=[] ;for(var g=0;g<ON.length;g++ ){var h=ON[g];if(identical(h,j)){h.IN=true;}else{i.add(h);}}ON=i;}dispatchEvent( j){var k=ON;var i=ON.length;for(var g=0;g<i;g++ ){var h=k[g];if(h.IN==false){h.lN(j);}}}}class EB extends MC{final  eM=new Map<String,OE>();static const  MH=const tB<AB>(AB.oF); get onProgress=>EB.MH.forTarget(this);eO( i, g, k, l){var j="${i}.${g}";var h=new OE(i,g,k,l);if(eM.containsKey(j)){throw new StateError("ResourceManager already contains a resource called '${g}'");}else{eM[j]=h;}h.complete.then((SP){this.dispatchEvent(new AB(AB.oF));});} WP( i, h){var j="${i}.${h}";var g=eM[j];if(g==null){throw new StateError("Resource '${h}' does not exist.");}else if(g.value!=null){return g.value;}else if(g.error!=null){throw g.error;}else{throw new StateError("Resource '${h}' has not finished loading yet.");}} load(){var i=this.nI.map((h)=>h.complete);return YB.Future.wait(i).then((j){var g=this.EG.length;if(g>0){throw new StateError("Failed to load ${g} resource(s).");}else{return this;}});} get nI{return eM.values.where((g)=>g.value==null&&g.error==null).toList();} get EG{return eM.values.where((g)=>g.error!=null).toList();} mB( h, g,[ i=null]){eO("BitmapData",h,g,CB.CD(g,i));} ZB( i, g,[ h=null]){eO("Sound",i,g,cB.CD(g,h));} QD( i, g, h){eO("TextureAtlas",i,g,hB.CD(g,h));} yB( h, g){eO("Text",h,"",new YB.Future.value(g));} w( h){var g=WP("BitmapData",h);if(g is !CB)throw "dart2js_hint";return g;} oB( h){var g=WP("Sound",h);if(g is !cB)throw "dart2js_hint";return g;} aC( h){var g=WP("TextureAtlas",h);if(g is !hB)throw "dart2js_hint";return g;} DD( h){var g=WP("Text",h);if(g is !String)throw "dart2js_hint";return g;}}class OE{var yL;var KM;var TM;var cM=null;var nM=null;var vM=new YB.Completer();OE( h, i, j, k):yL=h,KM=i,TM=j{k.then((g){cM=g;}).catchError((l){nM=l;}).whenComplete((){vM.complete(this);});} toString()=>"ResourceManagerResource [kind=${yL}, name=${KM}, url = ${TM}]"; get kind=>yL; get name=>KM; get value=>cM; get error=>nM; get complete=>vM.future;}class hB{final  HM=new List<CF>();var EM;static  CD( n, UB){var k=new YB.Completer<hB>();var g=new hB();switch (UB){case pC.vG:case pC.AD:kC.HttpRequest.getString(n).then((FB){var o=DJ.parse(FB);var h=o["frames"];var s=o["meta"];var cC=uH(n,s["image"]);if(h is List){for(var v in h){var j=v as Map;var i=j["filename"] as String;var l=rF(i);var m=new CF.oJ(g,l,j);g.HM.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=rF(i);var m=new CF.oJ(g,l,j);g.HM.add(m);}}CB.CD(cC).then(( kB){g.EM=kB;k.complete(g);}).catchError((QB){k.completeError(new StateError("Failed to load image."));});}).catchError((QB){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} w( h){for(int g=0;g<HM.length;g++ ){var i=HM[g];if(i.name==h){return new CB.sJ(i);}}throw new ArgumentError("TextureAtlasFrame not found: '${h}'");}}class tB<LD extends AB>{final  PM;const tB(this.PM); forTarget( g,{ useCapture: false}){return g.eN(PM,useCapture);}}class CF{final  DM;final  KM;final  hM;final  pM;final  BN;final  QN;final  YN;final  hN;final  nN;final  uN;final  FO;CF.oJ( i, h, g):DM=i,KM=h,hM=fH(g["rotated"]),pM=DC(g["sourceSize"]["w"]),BN=DC(g["sourceSize"]["h"]),QN=DC(g["spriteSourceSize"]["x"]),YN=DC(g["spriteSourceSize"]["y"]),hN=DC(g["frame"]["x"]),nN=DC(g["frame"]["y"]),uN=DC(g["frame"]["w"]),FO=DC(g["frame"]["h"]); get wI=>DM; get name=>KM; get tI=>hM; get VI=>hN; get WI=>nN; get GG=>uN; get FG=>FO; get offsetX=>QN; get offsetY=>YN; get mI=>pM; get lI=>BN;}class mG<LD>{final  xL=new List<LD>();final  XM;var iM=0;mG( g()):XM=g; NG(){if(iM==0){return XM();}else{iM-- ;return xL[iM];}}PG( g){if(iM==xL.length){xL.add(g);}else{xL[iM]=g;}iM++ ;}reset(){xL.clear();iM=0;}}class SC extends AB{static const  HF="keyDown";static const  JF="keyUp";var jN=false;var rN=false;var zN=false;var HO=false;var OO=false;var WO=0;var bO=0;var fO=0;SC( g,[ h=false]):super(g,h); get altKey=>jN; get ctrlKey=>rN; get shiftKey=>zN; get charCode=>WO; get keyCode=>bO; get keyLocation=>fO;}class pG{static const  aE="none";}class nC{static var DF=uB.TE;static var yG=false;static var NF=null;static var KH=null;static var NH=null;static var SH=new YB.StreamController<String>();static var WH=SH.stream.asBroadcastStream();static  qF( i){var h=i;var g="auto";if(DF!=uB.TE){h=DF;}switch (h){case uB.TE:g="auto";break;case uB.VE:g="default";break;case uB.WE:g="pointer";break;case uB.LH:g="move";break;case uB.TF:g="text";break;case uB.OH:g="wait";break;}if(yG){g="none";}return g;}}class t extends AB{static const  eC="click";static const  DH="doubleClick";static const  gD="mouseDown";static const  YE="mouseUp";static const  WF="mouseMove";static const  iD="mouseOut";static const  bF="mouseOver";static const  cF="mouseWheel";static const  iF="middleClick";static const  aH="middleMouseDown";static const  eH="middleMouseUp";static const  jF="rightClick";static const  jH="rightMouseDown";static const  lH="rightMouseUp";var OP,PP;var RP,TP;var iP;var jN;var OO;var rN;var zN;var pP;var qP;var sP;t( g,[ h=false]):super(g,h){cP(g,h);} cP( g,[ h=false]){super.cP(g,h);OP=PP=0;RP=TP=0;iP=false;jN=false;OO=false;rN=false;zN=false;pP=0;qP=0;sP=0;}set uP( g){OP=g.x;PP=g.y;}set vP( g){RP=g.x;TP=g.y;} get kE=>OP; get lE=>PP; get YC=>iP; get altKey=>jN; get ctrlKey=>rN; get shiftKey=>zN; get RD=>pP; get deltaX=>qP; get deltaY=>sP;}class uB{static const  TE="auto";static const  VE="arrow";static const  WE="button";static const  LH="hand";static const  TF="ibeam";static const  OH="wait";}abstract class lB{ zB( g);}class RE extends bD implements lB{static const  zG='TIME_OUT';var HN=false;var UM=0.0;var jM=0.0;var sN;var yN=true;RE( g, i,[ h=bD.hD]):super(i,h){if(g<=0)throw new ArgumentError('Time must be greater than zero');jM=g;xF();} zB( g){if(HN&&ratio>0.0){ratio=ratio-g/ED;if(ratio==0.0)pause();}return true;} start(){HN=true;} pause(){HN=false;} reset([ g=0.0]){pause();g=VB.max(g,0.0);if(g!=0.0){jM=g;xF();}ratio=1.0;} nD( g, h){sN[g]=h/ED;} xF(){sN=new Map<String,num>();nD(RE.zG,0);} get ED=>jM; get sI=>ratio*ED; set ratio( i){var h=ratio;super.ratio=i;if(yN){sN.forEach((j,g){if(g<h&&g>=ratio)dispatchEvent(new AB(j));});}}}class CB implements LE{var AM;var NM;var bM;var lM;var rM;var CN;var NN;var XN;var iN;var pN;var wN;var CO;var IO;var LO;var SO;var GN;static var gF=new PE();CB( i, l,[ j=true, g=0xFFFFFFFF,k=1.0]){AM=DC(i);NM=DC(l);bM=j;lM=k.toDouble();rM=lM/lD;CN=((1.0-rM).abs()<0.001)?0:1;iN=0;pN=0;NN=AM;XN=NM;wN=0;CO=0;IO=(AM*rM).ceil();LO=(NM*rM).ceil();var h=new kC.CanvasElement(width:IO,height:LO);SO=h;GN=h.context2D;GN.fillStyle=bM?YF(g):ND(g);GN.fillRect(0,0,IO,LO);}CB.rJ( g,[ j=1.0]){var h=DC(g.naturalWidth);var i=DC(g.naturalHeight);bM=true;lM=nH(j);rM=lM;AM=(h/lM).round();NM=(i/lM).round();CN=((1.0-rM).abs()<0.001)?0:1;iN=0;pN=0;NN=AM;XN=NM;wN=0;CO=0;IO=h;LO=i;SO=g;}CB.sJ( g){var h=g.wI.EM;AM=g.mI.toInt();NM=g.lI.toInt();bM=true;lM=h.lM;rM=h.rM;CN=g.tI?3:2;iN=g.offsetX;pN=g.offsetY;NN=g.GG;XN=g.FG;wN=(g.VI*rM).floor();CO=(g.WI*rM).floor();IO=(g.GG*rM).ceil();LO=(g.FG*rM).ceil();SO=h.SO;}static  CD( g,[ i=null, l=1.0]){if(i==null){i=CB.gF;}if(XC.cE&&i.autoHiDpi){if(g.contains("@1x.")&&mD>=1.5){l=l*2.0;g=g.replaceAll("@1x.","@2x.");}}var j=new YB.Completer<CB>();var h=new kC.ImageElement();var k;var m;k=h.onLoad.listen((v){k.cancel();m.cancel();j.complete(new CB.rJ(h,l));});m=h.onError.listen((v){k.cancel();m.cancel();j.completeError(new StateError("Failed to load image."));});if(i.webp==false){h.src=g;return j.future;}AI.then(( o){var s=new RegExp(r"(png|jpg|jpeg)$",multiLine:false,caseSensitive:true);var n=s.firstMatch(g);if(o==false||n==null){h.src=g;}else{h.src=g.substring(0,g.length-n.group(1).length)+"webp";}});return j.future;} get width=>AM; get height=>NM; clone([ g]){g=(g!=null)?g:lM;var h=new CB(AM,NM,true,0,g);h.TI(this);return h;} TI( h,[ g=null]){lQ();g=(g==null)?new HB.pJ():g.clone();g.scale(rM,rM);var i=new wB.qJ(GN,g);h.gB(i);GN.globalAlpha=1.0;GN.globalCompositeOperation=eD.fD;} clear(){lQ();GN.setTransform(rM,0.0,0.0,rM,0.0,0.0);GN.clearRect(0,0,AM,NM);} gB( h){var g=h.context;switch (CN){case 0:g.drawImage(SO,iN,pN);break;case 1:g.drawImageScaled(SO,iN,pN,NN,XN);break;case 2:g.drawImageScaledFromSource(SO,wN,CO,IO,LO,iN,pN,NN,XN);break;case 3:g.transform(0.0,-1.0,1.0,0.0,iN,pN+XN);g.drawImageScaledFromSource(SO,wN,CO,LO,IO,0.0,0.0,XN,NN);break;}} QG( o, g){if(g.width==0||g.height==0)return;var i=o.context;if(CN!=0){lQ();}var h=(g.x-iN)*rM;var n=(g.y-pN)*rM;var s=g.width*rM;var k=g.height*rM;var l=g.x+iN;var j=g.y+pN;var v=g.width;var m=g.height;i.drawImageScaledFromSource(SO,h,n,s,k,l,j,v,m);} lQ(){if(GN==null){var g=lM/lD;var j=(AM*g).ceil();var i=(NM*g).ceil();var h=new kC.CanvasElement(width:j,height:i);var k=new HB(g,0.0,0.0,g,0.0,0.0);var l=new wB.qJ(h.context2D,k);this.gB(l);lM=lM;rM=g;CN=((1.0-rM).abs()<0.001)?0:1;iN=0;pN=0;NN=AM;XN=NM;wN=0;CO=0;IO=j;LO=i;SO=h;GN=h.context2D;}}}typedef  KD( ratio);typedef  rG<LD extends AB>( event);class FF<LD extends AB> extends YB.StreamSubscription<LD>{var wM=0;var IN=false;var ZN;var lN;FF(this.ZN,this.lN); get isPaused=>wM>0; onError( g(error)){} cancel(){ZN.OI(this);} pause([ g]){wM++ ;if(g!=null){g.whenComplete(resume);}} resume(){if(wM==0){throw new StateError("Subscription is not paused.");}wM-- ;}}class LB implements lB{var yM;var TN;var cN=0.0;LB(){yM=new NE();TN=yM;} add( g){if(g is !lB){throw new ArgumentError("The supplied animatable does not extend type Animatable.");}if(this.contains(g)==false){var h=new NE();TN.fC=g;TN.tC=h;TN=h;}} remove( h){if(h!=null){var g=yM;while (identical(g,TN)==false){if(identical(g.fC,h)){g.fC=null;break;}g=g.tC;}}} contains( h){if(h!=null){var g=yM;while (identical(g,TN)==false){if(identical(g.fC,h))return true;g=g.tC;}}return false;} rE( g, i,[ h]){var j=h!=null?new dB(g,i,h):new dB(g,i);add(j);return j;} iB( h, i){var g=new IE(h,i);add(g);return g;} zB( j){cN+= j;var g=yM;var i=TN;while (identical(g,i)==false){var k=g.fC;if(k==null){var h=g.tC;g.fC=h.fC;g.tC=h.tC;if(identical(h,i))i=g;if(identical(h,TN))TN=g;}else if(k.zB(j)==false){g.fC=null;}else{g=g.tC;}}return true;}}class eD{static const  fD="source-over";} ND( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";} FH( g){if(SE.containsKey(g)==false){SE[g]=new ZE(g);}return SE[g];}class MF extends aD{var LN;MF( g):super(AB.PF),LN=g;}class QF{static var ZH=BF.aE;static var dH=new YB.StreamController<String>();static var hH=dH.stream.asBroadcastStream();static  get oH=>ZH;}class vB{static const  XF="B";static const  TH="BL";static const  aF="BR";static const  xG="L";static const  dF="R";static const  YH="T";static const  cH="TR";static const  aE="";} YF( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class VC extends lB{final  PO;final  UO;final  aO;var gO;var jO;var nO;var qO;var jM;var UM;var wO;var zO;var BP;VC( h, i, j,[ g]):PO=h,UO=i,aO=(g!=null)?g:PB.WC{gO=h;UM=0.0;jM=VB.max(0.0001,j);wO=0.0;zO=false;BP=false;} zB( i){if(UM<jM||BP==false){UM=UM+i;if(UM>jM)UM=jM;if(UM>=0.0){if(BP==false){BP=true;if(jO!=null)jO();}var g=UM/jM;var h=aO(g);gO=PO+h*(UO-PO);if(nO!=null)nO(zO?gO.round():gO);if(qO!=null&&UM==jM)qO();}}return UM<jM;} get xD=>PO; get zD=>UO; get ED=>jM; get currentTime=>UM;set ZC( g){if(BP==false)UM=UM+wO-g;wO=g;} set onStart( g()){jO=g;} set PC( g( value)){nO=g;} set onComplete( g()){qO=g;}}class ZF extends aD{ZF():super(AB.VF);}class wB{final  GN;var UM=0.0;var dO=0.0;var kO;var pO;wB.qJ( i,[ h]):GN=i{kO=new yC();pO=kO;var g=kO.matrix;if(h is HB){g.rD(h);}GN.setTransform(g.a,g.b,g.c,g.d,g.AC,g.BC);GN.globalAlpha=1.0;GN.globalCompositeOperation=eD.fD;} get context=>GN; get currentTime=>UM; get RI=>dO; reset([ i, h, j]){UM=(h is num)?h:0.0;dO=(j is num)?j:0.0;pO=kO;var g=kO.matrix;if(i is HB){g.rD(i);}GN.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);GN.clearRect(0,0,GN.canvas.width,GN.canvas.height);GN.setTransform(g.a,g.b,g.c,g.d,g.AC,g.BC);GN.globalAlpha=1.0;GN.globalCompositeOperation=eD.fD;} RG( h){var g=h.aP;var FB=h.KO;var k=h.XO;var j=h.uO;var o=h.xO;var m=pO as yC;var i=pO.gI as yC;pO=i;var n=i.matrix;var v=m.alpha.toDouble()*FB;var s=(o!=null)?o:m.qD;n.hE(g,m.matrix);i.alpha=v;i.qD=s;if(k!=null){if(k.jC==null){g=i.matrix;}else if(identical(k.jC,h)){g=i.matrix;}else if(identical(k.jC,h.parent)){g=m.matrix;}else{g=k.jC.qE(h);if(g==null)g=dE;else g.concat(i.matrix);}k.LI(this,g);}if(j!=null){if(j.jC==null){g=i.matrix;}else if(identical(j.jC,h)){g=i.matrix;}else if(identical(j.jC,h.parent)){g=m.matrix;}else{g=j.jC.qE(h);if(g==null)g=dE;else g.concat(i.matrix);}j.XJ(this,g);}var l=n;GN.setTransform(l.a,l.b,l.c,l.d,l.AC,l.BC);GN.globalCompositeOperation=s;GN.globalAlpha=v;if(h.NI){h.cQ(this);}else{h.gB(this);}if(j!=null){j.ZJ();}if(k!=null){k.UI();}pO=m;}}class fF extends aD{fF():super(AB.eF);}class ZE{var fontStyle;var oD=0;var iE=0;var height=0;ZE( j){this.fontStyle=j;var h=new kC.Element.tag("span");h.style.font=this.fontStyle;h.text="Hg";var g=new kC.Element.tag("div");g.style.display="inline-block";g.style.width="1px";g.style.height="0px";var i=new kC.Element.tag("div");i.append(g);i.append(h);kC.document.body.append(i);try {g.style.verticalAlign="baseline";this.oD=g.offsetTop-h.offsetTop;g.style.verticalAlign="bottom";this.height=g.offsetTop-h.offsetTop;this.iE=height-oD;}catch (k){}finally {i.remove();}}}class PB{static  WC( g){return g;}static  sF( g){return g*g*g;}static  EC( g){g=1.0-g;return 1.0-g*g*g;}static  II( g){if(g==0.0||g==1.0)return g;return VB.pow(2.0,-10.0*g)*VB.sin((g-0.3/4.0)*(2.0*VB.PI)/0.3)+1;}}class PD{static const  TE="auto";static const  iH="stop";static const  lF="once";} fH( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}final  kF=new bE<MF>();final  mF=new bE<ZF>(); DC( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class nF{var target=null;var YC=false;var gE=0;var RD=0;var KG,LG;var IG,JG;nF(this.KG,this.LG,this.IG,this.JG);}final  pF=new bE<fF>(); nH( g){if(g is num){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a number.");}}class bE<LD extends aD>{final  FM=[] ;fE( g){FM.add(g);}dispatchEvent( g){var j=FM;var k=FM.length;for(int h=0;h<k;h++ ){var i=j[h];if(i.tO){g.ZM=i.ZM;g.gP=i.ZM;g.eP=mC.dD;g.hP=false;g.kP=false;i.dispatchEvent(g);}else{j.removeAt(h);k-- ;h-- ;}}}}class xB{final  mE;var xD=double.NAN;var zD=double.NAN;xB(this.mE); aB( g){this.zD=g.toDouble();} get bI=>!xD.isNaN&&!zD.isNaN; nP( g){switch (mE){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.QC;case 'pivotY':return g.RC;case 'scaleX':return g.jB;case 'scaleY':return g.qB;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.SB;case 'alpha':return g.alpha;default:return 0.0;}} BQ( g, h){switch (mE){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.QC=h;break;case 'pivotY':g.RC=h;break;case 'scaleX':g.jB=h;break;case 'scaleY':g.qB=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.SB=h;break;case 'alpha':g.alpha=h;break;}}}class pH{static var qH=0;var AE=qH++ ;var target=null;var vD=false;pH(this.target,this.vD);} rF( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class WJ extends QE{final  tP;WJ( i, g, h, j):tP=new GB(i,g,h,j);bP(){GN.rect(tP.x,tP.y,tP.width,tP.height);}}class XC extends qC{static var cE=HI;var VP;var GN;var xP,zP;var AQ;var CQ,EQ;var FQ;var GQ;var HQ;var IQ;var rL;var JQ;var KQ;var LQ;var MQ;var NQ;var OQ;var PQ;var QQ;var RQ;var SQ;var TQ;var UQ;XC( k, g,[ j, i, h]){if(g is !kC.CanvasElement){throw new ArgumentError("The canvas argument is not a CanvasElement");}if(g.tabIndex==-1)g.tabIndex=0;if(g.style.outline=="")g.style.outline="none";KM=k;VP=g;GN=g.context2D;xP=(j!=null)?j:g.width;zP=(i!=null)?i:g.height;AQ=(h!=null)?h:30;CQ=-1;EQ=-1;FQ=new GB.lJ();GQ=new HB.pJ();HQ=new HB.pJ();aQ();IQ=null;rL=new LB();KQ=new wB.qJ(GN);LQ=PD.TE;MQ=JD.SF;NQ=vB.aE;RQ=[new nF(t.gD,t.YE,t.eC,t.DH),new nF(t.aH,t.eH,t.iF,t.iF),new nF(t.jH,t.lH,t.jF,t.jF)];OQ=uB.VE;QQ=null;PQ=new KB(0,0);TQ=new t(t.eC,true);nC.WH.listen(WH);VP.onMouseDown.listen(TO);VP.onMouseUp.listen(TO);VP.onMouseMove.listen(TO);VP.onMouseOut.listen(TO);VP.onMouseWheel.listen(dQ);SQ=new Map<int,pH>();UQ=new WB(WB.GF,true);QF.hH.listen(eQ);eQ(null);VP.onKeyDown.listen(fQ);VP.onKeyUp.listen(fQ);VP.onKeyPress.listen(fQ);} get oE=>IQ; get SD=>rL; get uD=>PQ; get focus=>JQ; get align=>NQ;hQ(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){hQ();}set y( g){hQ();}set QC( g){hQ();}set RC( g){hQ();}set jB( g){hQ();}set qB( g){hQ();}set skewX( g){hQ();}set skewY( g){hQ();}set SB( g){hQ();}set alpha( g){hQ();}set width( g){hQ();}set height( g){hQ();}dI( g, h){if(LQ==PD.TE||LQ==PD.lF){aQ();KQ.reset(HQ,g,h);gB(KQ);if(LQ==PD.lF)LQ=PD.iH;}}aQ(){var QB=VP.getBoundingClientRect();var kB=VP.clientLeft+QB.left;var UB=VP.clientTop+QB.top;var h=VP.clientWidth;var j=VP.clientHeight;var o=xP;var FB=zP;if(h is !num)throw "dart2js_hint";if(j is !num)throw "dart2js_hint";if(o is !num)throw "dart2js_hint";if(FB is !num)throw "dart2js_hint";if(h==0||j==0)return;var i=1.0;var g=1.0;var k=0.0;var m=0.0;var n=h/o;var l=j/FB;switch (MQ){case JD.tG:i=n;g=l;break;case JD.BH:i=g=(n>l)?n:l;break;case JD.JH:i=g=1.0;break;case JD.SF:i=g=(n<l)?n:l;break;}switch (NQ){case vB.cH:case vB.dF:case vB.aF:k=(h-o*i);break;case vB.YH:case vB.aE:case vB.XF:k=(h-o*i)/2;break;}switch (NQ){case vB.TH:case vB.XF:case vB.aF:m=(j-FB*g);break;case vB.xG:case vB.aE:case vB.dF:m=(j-FB*g)/2;break;}var s=FQ;s.x=-k/i;s.y=-m/g;s.width=h/i;s.height=j/g;var v=(XC.cE?mD:1.0)/lD;HQ.wD(i,0.0,0.0,g,k,m);HQ.scale(v,v);GQ.wD(1.0,0.0,0.0,1.0,-kB-k,-UB-m);GQ.scale(1.0/i,1.0/g);if(CQ!=h||EQ!=j){CQ=h;EQ=j;VP.width=(CQ*v).round();VP.height=(EQ*v).round();if(VP.clientWidth!=h||VP.clientHeight!=j){VP.style.width="${h}px";VP.style.height="${j}px";}dispatchEvent(new AB(AB.XH));}}WH( g){VP.style.cursor=nC.qF(OQ);}TO( j){j.preventDefault();var n=new DateTime.now().millisecondsSinceEpoch;var s=j.button;var g=null;var i=GQ.yP(j.client);var m=null;if(s<0||s>2)return;if(j.type=="mousemove"&&PQ.DG(i))return;var h=RQ[s];PQ=i;if(nC.NF!=null)nC.NF.fP();if(j.type!="mouseout")g=pB(i.x,i.y) as OB;var k=uB.VE;if(g is DB&&(g as DB).sE){k=uB.WE;}if(g is uC&&(g as uC).sE){k=uB.WE;}if(g is KC&&(g as KC).type==vC.MD){k=uB.TF;}if(OQ!=k){OQ=k;VP.style.cursor=nC.qF(k);}if(QQ!=null&&QQ!=g){QQ.dispatchEvent(TQ..cP(t.iD,true)..uP=(QQ.bC!=null)?QQ.iC(i):new KB.lJ()..vP=i..iP=h.YC);QQ=null;}if(g!=null&&g!=QQ){g.dispatchEvent(TQ..cP(t.bF,true)..uP=g.iC(i)..vP=i..iP=h.YC);QQ=g;}var l=null;var o=false;var v=false;if(j.type=="mousedown"){VP.focus();l=h.KG;if(g!=h.target||n>h.gE+500)h.RD=0;h.YC=true;h.target=g;h.gE=n;h.RD++ ;}if(j.type=="mouseup"){l=h.LG;h.YC=false;o=(h.target==g);v=o&&h.RD.isEven&&(n<h.gE+500);}if(j.type=="mousemove"){l=t.WF;}if(l!=null&&g!=null){m=g.iC(i);g.dispatchEvent(TQ..cP(l,true)..uP=m..vP=i..iP=h.YC..pP=h.RD);if(o){if(v&&g.SI){g.dispatchEvent(TQ..cP(h.JG,true)..uP=m..vP=i..iP=h.YC);}else{g.dispatchEvent(TQ..cP(h.IG,true)..uP=m..vP=i..iP=h.YC);}}}}dQ( h){var g=GQ.yP(h.client);var i=pB(g.x,g.y) as OB;if(i!=null){i.dispatchEvent(TQ..cP(t.cF,true)..uP=i.iC(g)..vP=g..qP=h.deltaX..sP=h.deltaY);if(TQ.yD)h.preventDefault();}}var mQ=[] ;eQ( h){mQ.forEach((g)=>g.cancel());if(QF.oH==BF.HH){mQ=[VP.onTouchStart.listen(nQ),VP.onTouchEnd.listen(nQ),VP.onTouchMove.listen(nQ),VP.onTouchEnter.listen(nQ),VP.onTouchLeave.listen(nQ),VP.onTouchCancel.listen(nQ)];}}nQ( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=GQ.yP(m.client);var h=pB(i.x,i.y) as OB;var g=SQ.containsKey(l)?SQ[l]:new pH(h,SQ.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(UQ..cP(WB.UH,true)..uP=(g.target.bC!=null)?g.target.iC(i):new KB.lJ()..vP=i..JP=g.AE..MP=g.vD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(UQ..cP(WB.QH,true)..uP=h.iC(i)..vP=i..JP=g.AE..MP=g.vD);g.target=h;}var k=null;if(j.type=="touchstart"){VP.focus();SQ[l]=g;k=WB.GF;}if(j.type=="touchend"){SQ.remove(l);k=WB.KF;}if(j.type=="touchcancel"){SQ.remove(l);k=WB.OF;}if(j.type=="touchmove"){k=WB.UF;}if(k!=null&&h!=null){h.dispatchEvent(UQ..cP(k,true)..uP=h.iC(i)..vP=i..JP=g.AE..MP=g.vD);}}}fQ( g){if(g.keyCode==8){g.preventDefault();}if(JQ==null){return;}if(g.type=="keypress"){var j=g.charCode;var k=g.keyCode;if(k==13)j=13;if(j==0)return;var l=new ID(ID.IF,true)..uL=new String.fromCharCodes([j]);JQ.dispatchEvent(l);}else{var h=wC.sG;var i="";if(g.type=="keyup")i=SC.JF;if(g.type=="keydown")i=SC.HF;if(g.keyLocation==kC.KeyLocation.LEFT)h=wC.xG;if(g.keyLocation==kC.KeyLocation.RIGHT)h=wC.dF;if(g.keyLocation==kC.KeyLocation.NUMPAD)h=wC.IH;if(g.keyLocation==kC.KeyLocation.JOYSTICK)h=wC.RF;if(g.keyLocation==kC.KeyLocation.MOBILE)h=wC.RF;var m=new SC(i,true)..jN=g.altKey..rN=g.ctrlKey..zN=g.shiftKey..WO=g.charCode..bO=g.keyCode..fO=h;JQ.dispatchEvent(m);}}} uH( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} wH(){var i=new YB.Completer<bool>();var g=new kC.ImageElement(); h(){i.complete(g.width==2&&g.height==2);}g.onLoad.listen((j)=>h());g.onError.listen((j)=>h());g.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";return i.future;}class dB implements lB{final  WQ;final  aO;final  XQ=new List<xB>();var jO;var nO;var qO;var YQ;var jM;var UM;var wO;var zO;var BP;dB( g, i,[ h=PB.WC]):WQ=g,aO=h{YQ=new AF(this);UM=0.0;jM=VB.max(0.0001,i);wO=0.0;zO=false;BP=false;} get eB=>YQ; zM( g){if(WQ!=null&&BP==false){XQ.add(g);}} complete(){if(jM>=UM)zB(jM-UM);} zB( m){if(UM<jM||BP==false){UM=UM+m;if(UM>jM){UM=jM;}if(UM>=0.0){if(BP==false){BP=true;for(int h=0;h<XQ.length;h++ ){var g=XQ[h];g.xD=g.nP(WQ);}if(jO!=null){jO();}}var k=UM/jM;var l=aO(k).toDouble();for(int h=0;h<XQ.length;h++ ){var g=XQ[h];if(g.bI){var i=g.xD.toDouble();var n=g.zD.toDouble();var j=i+l*(n-i);g.BQ(WQ,zO?j.round():j);}}if(nO!=null){nO();}if(qO!=null&&UM==jM){qO();}}}return UM<jM;} get ED=>jM; get currentTime=>UM;set ZC( g){if(BP==false)UM=UM+wO-g;wO=g;} set onStart( g()){jO=g;} set PC( g()){nO=g;} set onComplete( g()){qO=g;}}final  AI=wH();final  kD=new mG<List<u>>(()=>new List<u>());final  dE=new HB.pJ(); eE( g, m, n, j){m=m.toDouble();n=n.toDouble();var cC=0.0;var kB=0.0;var v=m*g.a;var UB=m*g.b;var FB=m*g.a+n*g.c;var s=m*g.b+n*g.d;var QB=n*g.c;var o=n*g.d;var h=cC;if(h>v)h=v;if(h>FB)h=FB;if(h>QB)h=QB;var i=kB;if(i>UB)i=UB;if(i>s)i=s;if(i>o)i=o;var l=cC;if(l<v)l=v;if(l<FB)l=FB;if(l<QB)l=QB;var k=kB;if(k<UB)k=UB;if(k<s)k=s;if(k<o)k=o;if(j==null)j=new GB.lJ();j.x=g.AC+h;j.y=g.BC+i;j.width=l-h;j.height=k-i;return j;}final  BI=new kC.CanvasElement(width:16,height:16);final  uF=BI.context2D;final  lD=uF.backingStorePixelRatio==null?1.0:uF.backingStorePixelRatio.toDouble();final  mD=kC.window.devicePixelRatio==null?1.0:kC.window.devicePixelRatio;final  EI=((){var g=kC.window.navigator.userAgent.toLowerCase();return g.indexOf("iphone")>=0||g.indexOf("ipad")>=0||g.indexOf("ipod")>=0||g.indexOf("android")>=0||g.indexOf("webos")>=0||g.indexOf("windows phone")>=0;})();final  FI=kC.window.screen==null?1024:VB.max(kC.window.screen.width,kC.window.screen.height);final  HI=mD>1.0&&(!EI||FI>480);//@ sourceMappingURL=escape.dart.map
