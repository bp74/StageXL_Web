import "dart:html" as eC;import "dart:web_audio" as bF;import "dart:json" as kH;import "dart:async" as wB;import "dart:math" as TB;class lH{static const  mH="Chrome";static const  nH="Firefox";static const  oH="Internet Explorer";static const  pH="Safari";final  zG;final  RH;const lH(this.zG,[this.RH]);}class qH{final  name;const qH(this.name);}class hF extends BB{var bI;var kI;var uI;var AJ;var DJ;hF(){uI=eB.LB.iB("Warning");AJ=null;bI=GB.pF();kI=new CB(bI[0]);n(kI);} start(){AJ=uI.play();p.remove(DJ);DJ=new PC(0,80,9.0,MB.QC);DJ.LC=(h){var g=h.toInt()%8;kI.RB=bI[(g<=4)?g+1:8-g];};p.add(DJ);} stop(){if(AJ!=null){AJ.stop();AJ=null;}p.remove(DJ);kI.RB=bI[0];}}class cF extends BB{var GJ;var NJ;var SJ;var WJ;var ZJ;var aJ;var bJ;var cJ;var dJ;var fJ;var gJ;var hJ;var iJ;var jJ;var kJ;var mJ;var nJ;var oJ;var pJ;var rJ;cF( AB, s, KB, m, o, FB, k){cJ=new TB.Random();dJ=xB.tC;fJ=k;GJ=AB;NJ=s;SJ=KB;WJ=m;ZJ=o;aJ=FB;bJ=k.length;jJ=new List<NB>();mJ=new BB();nJ=new BB();oJ=new BB();pJ=new BB();rJ=new BB();n(mJ);n(nJ);n(oJ);n(pJ);n(rJ);nJ.VB=false;oJ.VB=false;pJ.VB=false;rJ.VB=false;LH();MH();KH();kJ=true;var l=new sC();this.mask=new jD.NI(0.0,0.0,500.0,500.0);for(int g=0;g<10;g++ ){for(int h=0;h<10;h++ ){var i=hJ[g+h*10];i.x=g*50+25;i.y=h*50+25-550;i.jB(mJ,nJ,oJ);var j=new PC(i.y,h*50+25,0.4,MB.qB);j.TC=g*0.03;j.LC=(SB){i.y=SB;};j.onComplete=(){if(l.YD()==100){yJ();kJ=false;jJ.clear();this.mask=null;}};p.add(j);}}HB(q.PD,zJ);} ZF( g){if(g==xB.eD)dJ=g;if(g==xB.fD&&dJ==xB.tC){dJ=g;if(kJ==false)dispatchEvent(new bB(bB.hD,null));}} GF(){this.mask=new jD.NI(0.0,0.0,500.0,500.0);for(int h=0;h<10;h++ ){for(int i=0;i<10;i++ ){var g=hJ[i+h*10];g.dB=false;g.KC=false;g.EB=u.ED;g.jB(mJ,nJ,oJ);var j=new PC(g.y,500+h*50+25,0.5,MB.qB);j.TC=i*0.1;j.LC=(k){g.y=k;};p.add(j);}}} LH(){iJ=new List<DD>();for(int h=0;h<NJ;h++ ){var g=new DD(h);g.ZB=(cJ.nextInt(30)-15)*TB.PI/180;g.x=300-(90*NJ)/2+h*90+cJ.nextInt(20)-10;g.y=550;iJ.add(g);pJ.n(g);}} DF( g, h){var i=0;var j=hJ[g+h*10];if(j.direction==0){var l=(g>0)?hJ[g-1+h*10]:null;var m=(g<9)?hJ[g+1+h*10]:null;if(j.bC(l))i++ ;if(j.bC(m))i++ ;}else{var k=(h>0)?hJ[g+(h-1)*10]:null;var o=(h<9)?hJ[g+(h+1)*10]:null;if(j.jC(k))i++ ;if(j.jC(o))i++ ;}return i;} CF(){for(int h=0;h<10;h++ ){for(int g=0;g<10;g++ ){var k=hJ[g+h*10];var i=bJ*2;while (DF(g,h)==2&&i>0){if(i%2==0){k.direction=1-k.direction;i-- ;}else{var m=0;for(int j=0;j<fJ.length;j++ )if(k.color==fJ[j])m=j;k.color=fJ[(m+1)%fJ.length];i-- ;}}}}var l=false;for(int h=0;h<10;h++ )for(int g=0;g<10;g++ )l=l||(DF(g,h)==2);return l;} QF(){for(int g=0;g<10;g++ )for(int h=1;h<9;h++ )if(hJ[(h-1)+g*10].WD(hJ[h+g*10])&&hJ[h+g*10].WD(hJ[(h+1)+g*10]))return true;for(int h=0;h<10;h++ )for(int g=1;g<9;g++ )if(hJ[h+(g-1)*10].WD(hJ[h+g*10])&&hJ[h+g*10].WD(hJ[h+(g+1)*10]))return true;return false;} FK( k, l, j){for(int h=0;h<20;h++ ){var g=GJ~/j;var i=l*g+cJ.nextInt(g);if(gJ[i].EB==u.ED){gJ[i].EB=k;return;}}} MH(){gJ=new List<IB>();for(int g=0;g<GJ;g++ ){var i=fJ[cJ.nextInt(fJ.length)];var h=cJ.nextInt(2);gJ.add(new IB(i,h));}for(int g=0;g<NJ*2;g++ )FK("Lock${(g%NJ)+1}",g,NJ*2);for(int g=0;g<SJ;g++ )FK(u.PB,g,SJ);for(int g=0;g<WJ;g++ )FK(u.yB,g,WJ);for(int g=0;g<ZJ;g++ )FK(u.SE,g,ZJ);for(int g=0;g<aJ;g++ )FK(u.TE,g,aJ);} KH(){hJ=new List<IB>();var g=true;while (g){hJ.clear();for(int h=0;h<100;h++ ){var j=fJ[cJ.nextInt(fJ.length)];var i=cJ.nextInt(2);hJ.add(new IB(j,i));}g=CF();}} VF(){if(kJ||dJ!=xB.tC)return false;var l=true;kJ=true;while (l){for(int k=0;k<hJ.length;k++ ){var g=hJ[k];g.dB=false;g.KC=false;g.jB(mJ,nJ,oJ);g.color=fJ[cJ.nextInt(fJ.length)];g.direction=cJ.nextInt(2);}l=CF()||(QF()==false);}var s=eB.LB.iB("BonusUniversal");s.play();var m=new sC();for(int i=0;i<10;i++ ){for(int j=0;j<10;j++ ){var g=hJ[i+j*10];g.WF=0.0;var h=new PC(0.0,1.0,0.2,MB.QC);h.TC=i*0.06;h.LC=(o){g.WF=o;};h.onStart=(){g.jB(mJ,nJ,oJ);};h.onComplete=(){if(m.YD()==100){yJ();GK();jJ.clear();}};p.add(h);}}return true;} yJ(){for(int i=0;i<10;i++ ){for(int h=0;h<10;h++ ){var g=hJ[h+i*10];var l=(h<9)?hJ[h+1+i*10]:null;var m=(i<9)?hJ[h+(i+1)*10]:null;var j=false;var k=false;if(g.bC(l)){j=true;k=(g.EB==u.PB||l.EB==u.PB);}if(g.jC(m)){j=true;k=(g.EB==u.PB||m.EB==u.PB);}if(g.dB!=j||g.KC!=k){g.dB=j;g.KC=k;g.jB(mJ,nJ,oJ);}}}} IK( o, l, s, k, m, AB){kJ=true;o.YD(k);var i=1;for(int h=0;h<k;h++ ){var g=hJ[l+h*m+(s+h*AB)*10];if(g.EB==u.SE)i=i*2;if(g.EB==u.TE)i=i*5;var KB=l+h*m;var SB=s+h*AB;p.fB((){g.empty=true;g.jB(mJ,nJ,oJ);var FB=eB.LB.iB("ChainBlast");FB.play();var j=new QE(g.color,g.direction);j.x=KB*50;j.y=SB*50;p.add(j);rJ.n(j);YH(g);if(o.EF()==0)KK();},0.1+h*0.1);}dispatchEvent(new bB(bB.QE,{"Length":k,"Factor":i}));} GK(){kJ=false;var j=new sC();for(int h=0;h<10;h++ ){for(int i=0;i<10;){var g=1;while (i+g<10&&hJ[i+g-1+h*10].bC(hJ[i+g+h*10]))g++ ;if(g>=3)IK(j,i,h,g,1,0);i=i+g;}}for(int i=0;i<10;i++ ){for(int h=0;h<10;){var g=1;while (h+g<10&&hJ[i+(h+g-1)*10].jC(hJ[i+(h+g)*10]))g++ ;if(g>=3)IK(j,i,h,g,0,1);h=h+g;}}if(j.value==0){if(dJ==xB.eD)dispatchEvent(new bB(bB.RE,null));if(dJ==xB.fD)dispatchEvent(new bB(bB.hD,null));if(dJ==xB.tC&&QF()==false)VF();}} YH( h){if(h.EB.indexOf("Lock")==0){var k=int.parse(h.EB.substring(4,5))-1;var j=iJ[k];var g=GB.iD(h.EB);g.x=h.x;g.y=h.y;n(g);var i=new lB(g,0.5,MB.qB);i.YB("x",j.x);i.YB("y",j.y-10);i.onComplete=()=>sB(g);p.add(i);p.fB(()=>TH(k),0.5);}} TH( k){var h=iJ[k];var i;if(h.CD){i=new bB(bB.FD,{"Type":"SingleLocked","Position":new NB(h.x+20,h.y)});var m=eB.LB.iB("Unlock");m.play();}else{i=new bB(bB.FD,{"Type":"SingleUnlocked","Position":new NB(h.x+20,h.y)});}dispatchEvent(i);h.CD=false;h.UF(false);var j=true;for(int g=0;g<iJ.length;g++ )j=j&&(iJ[g].CD==false);if(j){var l=eB.LB.iB("BonusAllUnlock");l.play();for(int g=0;g<iJ.length;g++ ){iJ[g].CD=true;p.fB(()=>iJ[(g+k)%iJ.length].eH(),g*0.2);}p.fB(()=>dispatchEvent(new bB(bB.FD,{"Type":"All","Position":new NB(280,550)})),0.75);}} KK(){var o=new sC();for(int i=0;i<10;i++ ){var k=9;var j=8;while (k>=0){while (k>=0&&hJ[i+k*10].empty==false){k-- ;j-- ;}while (j>=0&&hJ[i+j*10].empty==true){j-- ;}if(k>=0){var g,h,l;if(j>=0){h=hJ[i+j*10];if(i>0){l=hJ[i-1+j*10];if(h.bC(l)){l.dB=false;l.jB(mJ,nJ,oJ);}}h.dB=false;h.empty=true;h.jB(mJ,nJ,oJ);}else{if(gJ.length>0){h=gJ[0];gJ.removeRange(0,1);}else{h=new IB(fJ[cJ.nextInt(fJ.length)],cJ.nextInt(2));}}g=hJ[i+k*10];g.color=h.color;g.direction=h.direction;g.EB=h.EB;g.dB=false;g.empty=false;g.x=50*i+25;g.y=50*j+25;g.jB(mJ,nJ,oJ);o.YD();var m=new PC(g.y,50*k+25,0.1,MB.QC);m.LC=(s){g.y=s;};m.onComplete=(){if(o.EF()==0){yJ();GK();MK();}};p.add(m);}}}} zJ( g){if(g.target==mJ&&this.VB){var j=TB.min(g.IF/50,9).toInt();var h=TB.min(g.JF/50,9).toInt();var i=new NB(j,h);jJ.add(i);MK();}} MK(){while (dJ==xB.tC&&kJ==false&&jJ.length>0){var s=jJ[0];jJ.removeRange(0,1);var j=s.x.toInt();var k=s.y.toInt();var g=hJ[j+k*10];var h=(j>0)?hJ[j-1+k*10]:null;var o=(j<9)?hJ[j+1+k*10]:null;var i=(k>0)?hJ[j+(k-1)*10]:null;var m=(k<9)?hJ[j+(k+1)*10]:null;var l=false;if(g.EB==u.yB){var AB=eB.LB.iB("ChainError");AB.play();continue;}if(g.jC(i)){i.dB=false;i.jB(mJ,nJ,oJ);}if(g.bC(h)){h.dB=false;h.jB(mJ,nJ,oJ);}g.direction=1-g.direction;g.dB=false;g.KC=false;var FB=eB.LB.iB("ChainRotate");FB.play();if(g.bC(o)){g.dB=true;g.KC=(g.EB==u.PB||o.EB==u.PB);}if(g.jC(m)){g.dB=true;g.KC=(g.EB==u.PB||m.EB==u.PB);}g.jB(mJ,nJ,oJ);l=l||g.dB;if(g.jC(i)){i.dB=true;i.KC=(g.EB==u.PB||i.EB==u.PB);i.jB(mJ,nJ,oJ);l=true;}if(g.bC(h)){h.dB=true;h.KC=(g.EB==u.PB||h.EB==u.PB);h.jB(mJ,nJ,oJ);l=true;}if(l){var KB=eB.LB.iB("ChainLink");KB.play();}GK();}}}class bB extends w{static const  QE="Explosion";static const  FD="Unlocked";static const  RE="Finalized";static const  hD="Timeouted";var MJ;bB( h, g,[ bubbles=false]):super(h,bubbles){MJ=g;} get info{return MJ;}}class PE extends BB{var WI;PE( j){var g=new NC();g.SC=new bE("Arial",30,0xFFFFFF,DC:true,align:oB.OC);g.width=110;g.height=36;g.wordWrap=false;g.x=646;g.y=130;g.VB=false;g.text=j.toString();g.x=-g.width/2;g.y=-g.height/2;WI=new BB();WI.n(g);n(WI);var i=new PC(0.0,1.0,1.5,MB.qB);i.LC=(h){WI.alpha=1-h;WI.y=-h*50;WI.tB=1.0+0.1*TB.sin(h*10);WI.EC=1.0+0.1*TB.cos(h*10);};i.onComplete=(){this.HE();};p.add(i);}}class dF extends BB{var YI;var gI;var rI;var hI;dF(){var m=new CB(GB.LB.t("ExitBox"));n(m);var g=new NC();g.SC=new bE("Arial",24,0xFFFFFF,DC:true,align:oB.OC);g.width=240;g.height=100;g.wordWrap=true;g.text=fC.LB.qC("GENexitquery");g.x=47;g.y=150-g.KE/2;g.VB=false;n(g);YI=new qD(7,GB.LB.t("ExitGauge"),LD.xD);YI.x=268;YI.y=25;YI.HB("TimeOver",qJ);n(YI);YI.UD("TimeOver",0);YI.start();var i=new CB(GB.LB.t("ExitYesButtonNormal"));var j=new CB(GB.LB.t("ExitYesButtonPressed"));gI=new vC(i,i,j,j);gI.x=68;gI.y=239;gI.HB(q.ZC,uJ);n(gI);var h=new CB(GB.LB.t("ExitNoButtonNormal"));var k=new CB(GB.LB.t("ExitNoButtonPressed"));rI=new vC(h,h,k,k);rI.x=173;rI.y=232;rI.HB(q.ZC,wJ);n(rI);this.HB(w.wC,(l)=>p.add(YI));this.HB(w.yC,(l)=>p.remove(YI));} xJ( g){if(hI!=null){hI(g);hI=null;}} uJ( g){xJ(true);} wJ( g){xJ(false);} qJ( g){xJ(false);}show( g){hI=g;}}class eF extends BB{var XI;var fI;var pI;var yI;var YI;var CJ;var FJ;var HJ;var KJ;var VI;var OJ;var PJ;var QJ;var RJ;var TJ;var UJ;var VJ;var XJ;var YJ;eF(){var j=new CB(GB.LB.t("ShuffleButtonNormal"));var h=new CB(GB.LB.t("ShuffleButtonPressed"));fI=new vC(j,j,h,h);fI.HB(q.ZC,lJ);fI.x=530;fI.y=525;n(fI);var g=new CB(GB.LB.t("ExitButtonNormal"));var i=new CB(GB.LB.t("ExitButtonPressed"));pI=new vC(g,g,i,i);pI.HB(q.ZC,tJ);pI.x=700;pI.y=500;n(pI);XI=new fF();XI.x=540;XI.y=-1000;n(XI);YI=new qD(10,GB.LB.t("TimeGauge"),LD.tD);YI.x=659;YI.y=244;YI.HB("TimeShort",vJ);YI.HB("TimeOver",qJ);n(YI);p.add(YI);CJ=new gF();CJ.x=640;CJ.y=230;n(CJ);FJ=new hF();FJ.x=665;FJ.y=160;n(FJ);HJ=new NC();HJ.SC=new bE("Arial",30,0xD0D0D0,DC:true,align:oB.OC);HJ.width=140;HJ.height=36;HJ.wordWrap=false;HJ.x=646;HJ.y=130;HJ.VB=false;HJ.text="0";HJ.tB=0.9;n(HJ);KJ=new NC();KJ.SC=new bE("Arial",20,0xFFFFFF,DC:true,align:oB.OC);KJ.width=44;KJ.height=30;KJ.wordWrap=false;KJ.x=610;KJ.y=559;KJ.VB=false;KJ.text="3x";n(KJ);TJ=new BB();n(TJ);UJ=new BB();n(UJ);VJ=new BB();n(VJ);XJ=eB.LB.iB("Intro");YJ=XJ.play();} start(){VI=1;OJ=1;RJ=0;PJ=3;var g=new cD(fC.LB.qC("ESCStartText"));UJ.n(g);p.fB(()=>CJ.OF(21),1);g.show(()=>p.fB(()=>AK(),0.5));} AK(){if(yI!=null&&this.contains(yI))TJ.sB(yI);var m=VI;var g=0;var h=0;switch (VI){case 01:h=50;yI=new cF(g=40,3,0,0,0,0,[0,1,2]);break;case 02:h=45;yI=new cF(g=45,3,1,0,0,0,[2,3,4]);break;case 03:h=40;yI=new cF(g=50,4,2,2,1,0,[5,6,7]);break;case 04:h=35;yI=new cF(g=55,4,3,3,2,0,[0,2,6]);break;case 05:h=30;yI=new cF(g=60,5,4,4,2,1,[1,3,5]);break;case 06:h=34;yI=new cF(g=60,5,5,5,3,2,[1,2,4,7]);break;case 07:h=33;yI=new cF(g=65,5,5,6,3,2,[0,1,2,3]);break;case 08:h=32;yI=new cF(g=70,5,5,6,3,2,[0,2,5,6]);break;case 09:h=31;yI=new cF(g=75,5,5,6,3,2,[1,4,5,7]);break;default:h=30;yI=new cF(g=80+(VI-10)*5,5,5,6,3,2,[0,1,2,3]);break;}QJ=g;if(PJ<3){PJ++ ;KJ.text="${PJ}x";}yI.HB(bB.QE,BK);yI.HB(bB.FD,CK);yI.HB(bB.RE,DK);yI.HB(bB.hD,EK);yI.x=20;yI.y=16;yI.VB=false;TJ.n(yI);YI.reset(h);YI.UD("TimeShort",9);YI.UD("TimeOver",0);YI.pause();XI.level=m;XI.AF=g;XI.y=-210;var k=new lB(XI,0.4,MB.qB);k.YB("y",-90);p.add(k);var j=new cD(fC.LB.qC("ESCLevelBoxText").replaceAll("{0}","${g}"));UJ.n(j);j.show((){yI.VB=true;YI.start();if(XJ!=null){var i=new PC(1.0,0.0,4.0,MB.QC);i.LC=(l){YJ.FC.volume=l;YJ.FC=YJ.FC;};i.onComplete=(){YJ.stop();CJ.SH();};p.add(i);XJ=null;}});} vJ( g){FJ.start();} qJ( g){yI.ZF(xB.fD);} CK( j){var g=0;var k=j.info["Position"];var h=j.info["Type"];if(h=="SingleLocked")g=3000;if(h=="SingleUnlocked")g=1000;if(h=="All")g=10000;var i=new PE(g);i.x=k.x;i.y=k.y;TJ.n(i);RJ=RJ+g;HJ.text="${RJ}";} BK( j){var g=QJ;var i=j.info["Length"];var k=j.info["Factor"];g=(g>i)?g-i:0;QJ=g;XI.AF=g;if(g==0)yI.ZF(xB.eD);var h=0;switch (i){case 3:h=1000;break;case 4:h=2000;break;case 5:h=5000;break;default:h=5000;break;}RJ=RJ+h*k;HJ.text="${RJ}";} DK( m){YI.pause();FJ.stop();var l=eB.LB.iB("Laugh");var k=eB.LB.iB("LevelUp");l.play();CJ.OF(3);var g=GB.jF();g.x=55;g.y=260;TJ.n(g);p.fB((){yI.GF();k.play();},2.0);p.fB((){var j=(YI.bH*1000).toInt();var h=new PE(j);h.x=704;h.y=360;TJ.n(h);RJ=RJ+j;HJ.text="${RJ}";},2.5);var i=new lB(XI,0.5,MB.qB);i.YB("y",-210);i.TC=3.0;p.add(i);p.fB((){TJ.sB(g);},3.5);p.fB((){VI++ ;AK();},4.0);} EK( j){FJ.stop();yI.GF();var g;var i;if(OJ>0){OJ-- ;g=new cD(fC.LB.qC("GEN2ndchancetime"));UJ.n(g);i=eB.LB.iB("LevelUp");i.play();g.show((){p.fB(()=>AK(),0.5);var h=new lB(XI,0.5,MB.qB);h.YB("y",-210);p.add(h);});}else{g=new cD(fC.LB.qC("GENtimeup"));UJ.n(g);i=eB.LB.iB("GameOver");i.play();g.show((){p.fB(()=>HK(),0.5);var h=new lB(XI,0.5,MB.qB);h.YB("y",-210);p.add(h);});}} lJ( h){if(yI!=null&&PJ>0){var g=yI.VF();if(g){PJ=PJ-1;KJ.text="${PJ}x";}}} tJ( j){var h=new BB();h.n(new CB(new DB(800,600,false,0x000000)));h.alpha=0.6;VJ.n(h);var g=new dF();g.x=235;g.y=150;VJ.n(g);g.show(( i){VJ.sB(g);if(i==false)VJ.sB(h);else JK(false);});}HK(){var h=new BB();var j=new CB(GB.LB.t("ExitBox"));h.n(j);var g=new NC();g.SC=new bE("Arial",30,0xFFFFFF,DC:true,align:oB.OC);g.width=240;g.height=200;g.wordWrap=true;g.text=fC.LB.qC("GENgameover");g.x=47;g.y=30+(g.height-g.KE)/2;g.VB=false;h.n(g);h.x=110;h.y=-h.height;UJ.n(h);var k=eB.LB.iB("Laugh");p.fB(()=>k.play(),0.3);var i=new lB(h,0.3,MB.qB);i.YB("y",150);p.add(i);p.fB(()=>JK(true),5.0);h.HB(q.ZC,( l)=>JK(true));}var LK=false; JK( g){YI.pause();if(LK==false){LK=true;}}}class IB{var TI;var UI;var dI;var jI;var oI;var qI;var xI;var BJ;var EJ;var IJ;var LJ;IB( h, g){TI=h;UI=g;dI=u.ED;jI=-1000;oI=-1000;qI=false;xI=false;BJ=false;EJ=null;IJ=null;LJ=null;} get color=>TI; set color( g){TI=g;} get direction=>UI; set direction( g){UI=g;} get EB=>dI; set EB( g){dI=g;} get dB=>qI; set dB( g){qI=g;} get KC=>xI; set KC( g){xI=g;} get empty=>BJ; set empty( g){BJ=g;} WD( g){var h=g!=null&&(g.color==TI||g.EB==u.PB||dI==u.PB)&&g.EB!=u.yB&&dI!=u.yB;return h;} bC( g){var h=g!=null&&(g.color==TI||g.EB==u.PB||dI==u.PB)&&g.direction==0&&UI==0&&g.EB!=u.yB&&dI!=u.yB;return h;} jC( g){var h=g!=null&&(g.color==TI||g.EB==u.PB||dI==u.PB)&&g.direction==1&&UI==1&&g.EB!=u.yB&&dI!=u.yB;return h;} get x=>jI; set x( g){jI=g;if(EJ!=null)EJ.x=g;if(IJ!=null)IJ.x=g;if(LJ!=null)LJ.x=g;} get y=>oI; set y( g){oI=g;if(EJ!=null)EJ.y=g;if(IJ!=null)IJ.y=g;if(LJ!=null)LJ.y=g;} set WF( h){if(EJ!=null){var g=1+0.3*TB.sin(h*TB.PI);EJ.tB=g;EJ.EC=g;}} jB( g, h, i){if(EJ!=null){EJ.parent.sB(EJ);EJ=null;}if(IJ!=null){IJ.parent.sB(IJ);IJ=null;}if(LJ!=null){LJ.parent.sB(LJ);LJ=null;}if(empty==false){switch (dI){case u.PB:EJ=new rH(UI);EJ.x=jI;EJ.y=oI;g.n(EJ);break;case u.yB:EJ=GB.iD(u.yB);EJ.x=jI;EJ.y=oI;g.n(EJ);break;default:EJ=GB.gD(TI,UI);EJ.x=jI;EJ.y=oI;g.n(EJ);break;}if(qI){IJ=xI?new tH(UI):GB.iF(TI,UI);IJ.x=jI+((UI==0)?25:0);IJ.y=oI+((UI==1)?25:0);h.n(IJ);}switch (dI){case u.ED:break;case u.yB:break;case u.PB:break;default:LJ=new sH(dI);LJ.x=jI;LJ.y=oI;i.n(LJ);break;}}}}class fF extends BB{var VI;var eI;var lI;var tI;var zI;fF(){n(new CB(GB.LB.t("InfoBox")));eI=new NC();eI.SC=new bE("Arial",35,0xFFFFFF,DC:true,align:oB.OC);eI.width=220;eI.height=40;eI.wordWrap=false;eI.text="Level 1";eI.x=20;eI.y=115;eI.ZB=-2*TB.PI/180;n(eI);tI=new NC();tI.SC=new bE("Arial",25,0xFFFFFF,DC:true,align:oB.OC);tI.width=220;tI.height=30;tI.wordWrap=false;tI.text="40";tI.x=-tI.width/2;tI.y=-tI.height/2;tI.ZB=-2*TB.PI/180;zI=new BB();zI.n(tI);zI.x=150;zI.y=172;n(zI);var g=GB.gD(3,0);g.x=110;g.y=171;g.ZB=-2*TB.PI/180;g.tB=g.EC=0.6;n(g);} set level( g){VI=g;eI.text="Level ${VI}";} set AF( g){lI=g;tI.text="${lI}";}}class DD extends BB{var TI;var cI;var mI;var wI;DD( g){TI=g;mI=GB.nF(g);wI=true;cI=new CB(mI[0]);cI.x=-34;cI.y=-50;n(cI);} get CD=>wI; set CD( g){wI=g;} UF( g){cI.RB=mI[g?0:4];} eH(){var i=new PC(0.0,1.0,2.0,MB.qB);i.LC=(j){tB=EC=1.0+0.2*TB.sin(j*4*TB.PI);};var g=new lB(this,0.2,MB.qB);g.YB("alpha",0.0);g.TC=2.0;g.onComplete=()=>UF(wI);var h=new lB(this,0.2,MB.wE);h.YB("alpha",1);h.TC=2.2;p.add(i);p.add(g);p.add(h);}}class cD extends BB{var aI;var hI;cD( h){var i=new CB(GB.LB.t("MessageBox"));n(i);var g=new NC();g.SC=new bE("Arial",24,0xFFFFFF,DC:true,align:oB.OC);g.width=240;g.height=200;g.wordWrap=true;g.text=h;g.x=47;g.y=130-g.KE/2;g.VB=false;n(g);aI=null;HB(q.ZC,eJ);}void show( h){this.parent.n(this);this.x=-this.width;this.y=150;hI=h;var g=new lB(this,0.3,MB.qB);g.YB("x",110);g.onComplete=()=>aI=p.fB(sJ,10);p.add(g);} sJ(){if(aI!=null){p.remove(aI);aI=null;hI();var g=new lB(this,0.4,MB.wE);g.YB("x",800);g.onComplete=()=>this.parent.sB(this);p.add(g);}} eJ( g){sJ();}}class dD{var zE;var XF;var YF;var angle;var aF;var ZB;}class rH extends BB implements kB{var cI;var sI;var nI;rH( g){this.VB=false;nI=0.0;sI=GB.lF(g);cI=new CB(sI[0]);cI.x=-25;cI.y=-25;n(cI);HB(w.wC,(h)=>p.add(this));HB(w.yC,(h)=>p.remove(this));} CC( g){nI+= g;var h=(nI*10).toInt()%sI.length;cI.RB=sI[h];return true;}}class tH extends BB implements kB{var cI;var sI;var nI;tH( g){this.VB=false;nI=0.0;sI=GB.mF(g);cI=new CB(sI[0]);cI.x=-25;cI.y=-25;n(cI);HB(w.wC,(h)=>p.add(this));HB(w.yC,(h)=>p.remove(this));} CC( g){nI+= g;var h=(nI*10).toInt()%sI.length;cI.RB=sI[h];return true;}}class sH extends BB implements kB{var cI;var nI;sH( h){this.VB=false;nI=0.0;cI=GB.iD(h);n(cI);HB(w.wC,(g)=>p.add(this));HB(w.yC,(g)=>p.remove(this));} CC( g){nI+= g;this.ZB=TB.sin(nI*7)*10*TB.PI/180;return true;}}class sC{var value=0; YD([ inc=1])=>(value+= inc); EF([ dec=1])=>(value-= dec);}class gF extends BB{var ZI;var iI;var vI;gF(){ZI=GB.oF();iI=new CB(ZI[0]);iI.x=-iI.width/2;iI.y=-iI.height/2;n(iI);vI=null;} OF( g){p.remove(vI);vI=new PC(0,g,0.5*g,MB.QC);vI.LC=(h){var i=((h*ZI.length)%ZI.length).toInt();iI.RB=ZI[i];iI.y=TB.sin(h*2*TB.PI)*3-iI.height/2;};p.add(vI);} SH(){p.remove(vI);iI.RB=ZI[0];}}class eB{static var LB;}class fC{static var LB;}class u{static const  ED="None";static const  PB="Joker";static const  yB="Block";static const  SE="Double";static const  TE="Quint";}class GB{static var LB;static  gD( i, h){var g=new CB(LB.UC("Elements").t("Chain${i}${h}"));g.WC=25;g.XC=25;return g;}static  iF( i, h){var g=new CB(LB.UC("Elements").t("Link${i}${h}"));g.WC=25;g.XC=25;return g;}static  iD( h){var g=new CB(LB.UC("Elements").t(h));g.WC=25;g.XC=25;return g;}static  jF(){var m=new BB();var l=0;var o=LB.UC("Levelup");for(int k=0;k<7;k++ ){var g=new CB(o.t("LevelUp${k}"));g.x=-g.width/2;g.y=-g.height/2;var h=new BB();h.n(g);h.x=l+g.width/2;h.tB=0;h.EC=0;m.n(h);var i=new lB(h,2.0,MB.wG);i.YB("scaleX",1.0);i.YB("scaleY",1.0);i.TC=k*0.05;var j=new lB(h,0.4,MB.QC);j.YB("scaleX",0.0);j.YB("scaleY",0.0);j.TC=3.0;p.add(i);p.add(j);l=l+5+g.width;}return m;}static  lF( h){var i=LB.UC("Elements");var g=new List<DB>();g.add(i.t("JokerChain${h}0"));g.add(i.t("JokerChain${h}1"));g.add(i.t("JokerChain${h}2"));g.add(i.t("JokerChain${h}3"));g.add(i.t("JokerChain${h}4"));return g;}static  mF( h){var i=LB.UC("Elements");var g=new List<DB>();g.add(i.t("JokerLink${h}0"));g.add(i.t("JokerLink${h}1"));g.add(i.t("JokerLink${h}2"));g.add(i.t("JokerLink${h}3"));g.add(i.t("JokerLink${h}4"));return g;}static  nF( h){var i=LB.UC("Locks");var g=new List<DB>();g.add(i.t("Lock${h}0"));g.add(i.t("Lock${h}1"));g.add(i.t("Lock${h}2"));g.add(i.t("Lock${h}3"));g.add(i.t("Lock${h}4"));return g;}static  oF(){var h=LB.UC("Head");var g=new List<DB>();g.add(h.t("Head1"));g.add(h.t("Head2"));g.add(h.t("Head3"));g.add(h.t("Head2"));g.add(h.t("Head1"));return g;}static  pF(){var h=LB.UC("Alarm");var g=new List<DB>();g.add(h.t("Alarm0"));g.add(h.t("Alarm1"));g.add(h.t("Alarm2"));g.add(h.t("Alarm3"));g.add(h.t("Alarm4"));g.add(h.t("Alarm5"));return g;}}class xB{static const  tC=1;static const  eD=2;static const  fD=3;}class QE extends BB implements kB{var JJ;var nI;QE( s, o){JJ=new List<dD>();nI=0.0;this.VB=false;var AB=GB.gD(s,o);var m=new TB.Random();var i;var l;var FB;for(int h=0;h<=1;h++ ){for(int g=0;g<=1;g++ ){if(g==0&&h==0){i=TB.PI*1.15;ZB=-TB.PI*2;}if(g==1&&h==0){i=TB.PI*1.85;ZB=TB.PI*2;}if(g==1&&h==1){i=TB.PI*0.15;ZB=TB.PI*2;}if(g==0&&h==1){i=TB.PI*0.85;ZB=-TB.PI*2;}i=i+0.2*TB.PI*m.nextDouble();l=80.0+40.0*m.nextDouble();var j=new CB(AB.RB);j.VD=new QB(g*25,h*25,25,25);j.WC=12.5+g*25;j.XC=12.5+h*25;j.x=g*25;j.y=h*25;n(j);var k=new dD();k.zE=j;k.XF=g*25+12.5;k.YF=h*25+12.5;k.angle=i;k.aF=l;k.ZB=ZB;JJ.add(k);}}} CC( m){nI=TB.min(0.8,nI+m);var AB=981.0;for(int h=0;h<JJ.length;h++ ){var g=JJ[h];var i=g.zE;var j=g.angle;var k=g.aF;var l=g.ZB;var o=g.XF+nI*(TB.cos(j)*k);var s=g.YF+nI*(TB.sin(j)*k+nI*AB*0.5);i.x=o;i.y=s;i.ZB=nI*l;}if(nI>=0.6)this.alpha=(0.8-nI)/0.2;if(nI>=0.8)this.HE();return (nI<0.8);}}var GD;var gC;var HD;var p;var YC;var ID;var zB; main(){GD=new pC("StageBackground",eC.query('#stageBackground'));gC=new pC("StageForeground",eC.query('#stageForeground'));HD=new tF();HD.yE(GD);HD.yE(gC);p=HD.OH;var g=DB.xE("images/Loading.png");g.then((h){YC=new CB(h);YC.WC=20;YC.XC=20;YC.x=400;YC.y=270;gC.n(YC);ID=new lB(YC,100,MB.QC);ID.YB("rotation",100.0*2.0*TB.PI);p.add(ID);zB=new NC();zB.SC=new bE("Arial",20,0xA0A0A0,DC:true);zB.width=240;zB.height=40;zB.text="... loading ...";zB.x=400-zB.fH/2;zB.y=320;zB.VB=false;gC.n(zB);kF();});} kF(){var g=new mC();g.hB("Background","images/Background.jpg");g.hB("ExitBox","images/ExitBox.png");g.hB("ExitButtonNormal","images/ExitButtonNormal.png");g.hB("ExitButtonPressed","images/ExitButtonPressed.png");g.hB("ExitGauge","images/ExitGauge.png");g.hB("ExitNoButtonNormal","images/ExitNoButtonNormal.png");g.hB("ExitNoButtonPressed","images/ExitNoButtonPressed.png");g.hB("ExitYesButtonNormal","images/ExitYesButtonNormal.png");g.hB("ExitYesButtonPressed","images/ExitYesButtonPressed.png");g.hB("InfoBox","images/InfoBox.png");g.hB("MessageBox","images/MessageBox.png");g.hB("ShuffleButtonNormal","images/ShuffleButtonNormal.png");g.hB("ShuffleButtonPressed","images/ShuffleButtonPressed.png");g.hB("TimeGauge","images/TimeGauge.png");g.AD("Alarm","images/AlarmTextureAtlas.json",hC.oC);g.AD("Head","images/HeadTextureAtlas.json",hC.oC);g.AD("Elements","images/ElementsTextureAtlas.json",hC.oC);g.AD("Levelup","images/LevelupTextureAtlas.json",hC.oC);g.AD("Locks","images/LocksTextureAtlas.json",hC.oC);g.aB("BonusAllUnlock","sounds/BonusAllUnlock.mp3");g.aB("BonusUniversal","sounds/BonusUniversal.mp3");g.aB("ChainBlast","sounds/ChainBlast.mp3");g.aB("ChainBlastSpecial","sounds/ChainBlastSpecial.mp3");g.aB("ChainError","sounds/ChainError.mp3");g.aB("ChainFall","sounds/ChainFall.mp3");g.aB("ChainHelp","sounds/ChainHelp.mp3");g.aB("ChainLink","sounds/ChainLink.mp3");g.aB("ChainRotate","sounds/ChainRotate.mp3");g.aB("Click","sounds/Click.mp3");g.aB("GameOver","sounds/GameOver.mp3");g.aB("Laugh","sounds/Laugh.mp3");g.aB("LevelUp","sounds/LevelUp.mp3");g.aB("PointsCounter","sounds/PointsCounter.mp3");g.aB("Unlock","sounds/Unlock.mp3");g.aB("Warning","sounds/Warning.mp3");g.aB("Intro","sounds/Intro.mp3");g.mB("ESCAPE_INS_AIM_0","Connect at least 3 chain links of the same colour to a horizontal or vertical chain.");g.mB("ESCAPE_INS_DES_0","You can change the direction of a chain link by touching it.");g.mB("ESCAPE_INS_TIP_0","Earn extra points for connecting chain links displaying a key symbol.");g.mB("ESCBlockErrorHint","Sorry but block chains canÂ´t be twisted!");g.mB("ESCLevelBoxText","Connect {0} chain links and help the crook to escape!");g.mB("ESCNoActionHint","Press on the chain links to twist them.");g.mB("ESCNoComboHint","You have to connect at least 3 chain links of the same colour.");g.mB("ESCStartText","Form horizontal or vertical same-colour chains and become an escape agent!");g.mB("ESCtogo","Chain links:");g.mB("GENexitquery","Do you really want to quit the game?");g.mB("GEN2ndchancetime","Time is up. Second chance!");g.mB("GENtimeup","Sorry! Your time is up.");g.mB("GENgameover","Game Over");g.load().then((j){gC.sB(YC);gC.sB(zB);p.remove(ID);GB.LB=g;eB.LB=g;fC.LB=g;var i=new CB(GB.LB.t("Background"));GD.n(i);GD.aH=lC.wD;var h=new eF();gC.n(h);h.start();});}class cB{var UK;var xK;cB(){UK=new eC.ImageElement();xK=new List<XE>();}static  ZG( m, KB){var l=new wB.Completer<cB>();var j=new cB();switch (KB){case hC.AG:case hC.oC: o( k, g){var AB=kG(k);var h=new XE(AB,j);h.yK=g["frame"]["x"].toInt();h.GL=g["frame"]["y"].toInt();h.OL=g["frame"]["w"].toInt();h.UL=g["frame"]["h"].toInt();h.bL=g["spriteSourceSize"]["x"].toInt();h.hL=g["spriteSourceSize"]["y"].toInt();h.lL=g["sourceSize"]["w"].toInt();h.vL=g["sourceSize"]["h"].toInt();h.CM=g["rotated"] as bool;j.xK.add(h);}eC.HttpRequest.getString(m).then((FB){var s=kH.parse(FB);var i=s["frames"];var SB=s["meta"];if(i is List)for(var g in i)o(g["filename"],g);if(i is Map)for(String k in i.keys)o(k,i[k]);j.UK..onLoad.listen((gB)=>l.complete(j))..onError.listen((gB)=>l.completeError(new StateError("Failed to load image.")))..src=oG(m,SB["image"]);}).catchError((vB){l.completeError(new StateError("Failed to load json file."));});break;}return l.future;} get IH=>UK; t( i){var h;for(int g=0;g<xK.length&&h==null;g++ )if(xK[g].name==i)h=new DB.SI(xK[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;}}class nC{static const  xF=0;static const  DG=1;static const  MG=2;static const  RG=3;static const  mE=4;}class MD{static var SD;static  get TD{if(SD==null){try {SD=new bF.AudioContext();}catch (g){SD=null;}}return SD;}static var zC;static  get nG{if(zC==null){zC=(TD!=null)?"WebAudioApi":"AudioElement";var g=eC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))zC="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))zC="Mock";}return zC;}}class KD extends MC{var uK;var jK;var gK;var wK;KD( g, i, h){uK=g;gK=i;wK=h;jK=g.dM(this);jK.loop=gK;this.FC=h;jK.play();} get FC=>wK; set FC( g){wK=g;if(jK!=null)jK.volume=(wK!=null)?wK.volume:1;} stop(){if(jK!=null){if(jK.ended==false)jK.pause();uK.mN(this);jK=null;}}}class UE{static const  KG="none";static const  QG="touchPoint";}class mC{var YK;var sK;var PL;var cL;var kL;var sL;var AM;mC(){YK=new Map<String,DB>();sK=new Map<String,JB>();PL=new Map<String,cB>();cL=new Map<String,String>();kL=null;sL=0;AM=0;} hB( g, h){sL++ ;DB.xE(h).then(( i){YK[g]=i;sL-- ;SN();}).catchError(( j){AM++ ;sL-- ;SN();});} aB( g, h){sL++ ;JB.zF(h).then(( i){sK[g]=i;sL-- ;SN();}).catchError(( j){AM++ ;sL-- ;SN();});} AD( h, i, g){sL++ ;cB.ZG(i,g).then(( j){PL[h]=j;sL-- ;SN();}).catchError(( k){AM++ ;sL-- ;SN();});} mB( h, g){cL[h]=g;} load(){kL=new wB.Completer<mC>();SN();return kL.future;} t( g){if(YK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return YK[g];} iB( g){if(sK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return sK[g];} UC( g){if(PL.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return PL[g];} qC( g){if(cL.containsKey(g)==false)return "[[${g}]]";return cL[g];}SN(){if(kL!=null&&sL==0){if(AM==0)kL.complete(this);else kL.completeError(new StateError("Error loading resources."));}}}class mD{var yG;var AH;var height;var GE;var width;var x;mD(this.x,this.width,this.height,this.yG,this.AH,this.GE);}class NC extends OB{var eK="";var qK=0x000000;var NL=null;var aL=rF.KG;var qL=qF.FG;var NK=sF.yF;var GM=false;var LM=false;var PM=0x000000;var VM=false;var aM=0x000000;var fM=0;var jM=0;var mM;var sM;var vM=true;var xM=100;var AN=100;var CN=null;var bK=null;NC(){NL=new bE("Arial",12,0x000000);mM=new List<String>();sM=new List<mD>();} get type=>NK; get width=>xM; get height=>AN; set text( g){eK=g;vM=true;} set SC( g){NL=g;qK=NL.color;vM=true;} set wordWrap( g){GM=g;vM=true;} set width( g){xM=g;vM=true;} set height( g){AN=g;vM=true;} get fH{zN();return fM;} get KE{zN();return jM;} rB( g,[ returnRectangle]){return BE(g,xM,AN,returnRectangle);} VC( g, h){if(g>=0&&h>=0&&g<xM&&h<AN)return this;return null;} nB( g){zN();g.bK.drawImage(CN,0.0,0.0);} DO(){mM.clear();sM.clear();if(GM==false){mM.add(eK);}else{var g=new StringBuffer();var i;var h;for(String o in eK.replaceAll('\r','').split('\n')){for(String j in o.split(' ')){i=g.length;g.add((i>0)?" ${j}":j);h=g.toString();if(bK.measureText(h).width>xM){if(i>0)h=h.substring(0,i);else j="";mM.add(h);g.clear();g.add(j);}}if(g.isEmpty==false){mM.add(g.toString());g.clear();}}}fM=0;jM=0;for(String h in mM){var l=bK.measureText(h);var m=0;if(NL.align==oB.OC||NL.align==oB.OG)m=(xM-l.width)/2;if(NL.align==oB.MG||NL.align==oB.IG)m=xM-l.width;var k=new mD(m,l.width,NL.size,0,0,0);sM.add(k);fM=TB.max(fM,k.width);jM=jM+k.height;}} zN(){if(vM){vM=false;var i=xM.ceil().toInt();var j=AN.ceil().toInt();if(CN==null){CN=new eC.CanvasElement(width:i,height:j);bK=CN.context2d;}if(CN.width!=i)CN.width=i;if(CN.height!=j)CN.height=j;var g=new StringBuffer();g.add(NL.HF?"italic ":"normal ");g.add("normal ");g.add(NL.DC?"bold ":"normal ");g.add("${NL.size}px ");g.add("${NL.font},sans-serif");bK.font=g.toString();bK.textAlign="start";bK.textBaseline="top";bK.fillStyle=xC(qK);DO();if(LM){bK.fillStyle=xC(PM);bK.fillRect(0,0,xM,AN);}else{bK.clearRect(0,0,xM,AN);}var k=0;for(int h=0;h<mM.length;h++ ){var l=sM[h];bK.fillStyle=xC(qK);bK.fillText(mM[h],l.x,k);k+= l.height;}if(VM){bK.strokeStyle=xC(aM);bK.lineWidth=1;bK.strokeRect(0,0,xM,AN);}}}}class qF{static const  FG="pixel";}class sF{static const  yF="dynamic";}abstract class MC extends AC{ get FC; set FC( g); stop();}class oB{static const  OC="center";static const  IG="end";static const  OG="justify";static const  MG="right";}abstract class JB{static  zF( g){var h=MD.nG;if(h=="WebAudioApi")return nD.zF(g);if(h=="AudioElement")return pD.zF(g);return YE.zF(g);} get length; play([ loop=false, soundTransform]);static var aC;static  uE( g){if(aC==null){aC=new List<String>();var i=new eC.AudioElement();var h=["maybe","probably"];if(h.indexOf(i.canPlayType("audio/ogg",""))!=-1)aC.add("ogg");if(h.indexOf(i.canPlayType("audio/mp3",""))!=-1)aC.add("mp3");if(h.indexOf(i.canPlayType("audio/wav",""))!=-1)aC.add("wav");}var k=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var j=k.firstMatch(g);if(j==null)throw new ArgumentError("Unsupported file extension.");var l=j.group(1).toLowerCase();if(aC.indexOf(l)==-1&&aC.length>0)g="${g.substring(0,g.length-3)}${aC[0]}";return g;}}class pD extends JB{var jK;var CL;var VL;pD(){VL=new List<KD>();jK=new eC.AudioElement();jK.onEnded.listen(KM);CL=new List<eC.AudioElement>();CL.add(jK);eC.document.body.children.add(jK);}static  zF( s){var k=new pD();var g=k.jK;var i=new wB.Completer<JB>();var h;var j;o(m){h.cancel();j.cancel();i.complete(k);}l(m){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(o);j=g.onError.listen(l);g.src=JB.uE(s);g.load();return i.future;} get length{return jK.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new XB();return new KD(this,loop,soundTransform);} dM( h){var g;if(CL.length==0){g=jK.clone(true);g.onEnded.listen(KM);}else{g=CL.removeAt(0);}VL.add(h);return g;} mN( g){var h=g.jK;var i=VL.indexOf(g);VL.removeAt(i);CL.add(h);if(jK.currentTime>0&&jK.ended==false)jK.currentTime=0;} KM(j){var i=j.target;var g=null;for(int h=0;h<VL.length&&g==null;h++ )if(VL[h].jK==i)g=VL[h];if(g!=null)g.stop();}}class YE extends JB{YE(){}static  zF( i){var h=new YE();var g=new wB.Completer<JB>();eC.window.setTimeout(()=>g.complete(h),1);return g.future;} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new XB();return new uH(this,loop,soundTransform);}}class vH extends MC{var rK;var wK;var gK;var dL;var pL;vH( j, h, i){rK=j;gK=h;wK=i;var g=MD.TD;dL=g.createGain();dL.connect(g.destination,0,0);dL.gain.value=(wK!=null)?TB.pow(wK.volume,2):1;pL=g.createBufferSource();pL.buffer=rK.iK;pL.loop=h;pL.connect(dL,0,0);pL.start(0);} get FC=>wK; set FC( g){wK=g;dL.gain.value=(wK!=null)?TB.pow(wK.volume,2):1;} stop(){pL.stop(0);}}class XE{var TK;var lK;var yK;var GL;var OL;var UL;var bL;var hL;var lL;var vL;var CM;XE( g, h){TK=g;lK=h;} get gH=>lK; get name=>TK; get EH=>yK; get FH=>GL; get DH=>OL; get CH=>UL; get offsetX=>bL; get offsetY=>hL; get VH=>lL; get UH=>vL; get dH=>CM;}class pB{static const  rD="auto";static const  uD="arrow";static const  vD="button";static const  SG="hand";static const  TG="ibeam";static const  VG="wait";}class hC{static const  AG="json";static const  oC="jsonarray";}class rF{static const  KG="none";}class nD extends JB{var iK;nD(){if(MD.TD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  zF( o){var h=new nD();var k=JB.uE(o);var g=new wB.Completer<JB>();eC.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var m=MD.TD;m.decodeAudioData(j,( l){h.iK=l;g.complete(h);},(s){g.completeError(new StateError("Failed to decode audio."));});}).catchError((s){g.completeError(new StateError("Failed to load audio."));});return g.future;} get length{return iK.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new XB();return new vH(this,loop,soundTransform);}}class uH extends MC{var gK;var wK;uH( i, h, g){gK=h;wK=g;} get FC=>wK; set FC( g){wK=g;} stop(){}}class oD implements kB{var cK=0.0;var vK=0.0;var HL=1;var TL;oD( g, h){TL=g;vK=TB.max(h,0.0001);} CC( h){var g=cK+h;while (g>=vK&&HL>0){cK=vK;HL-- ;TL();g-= vK;}if(HL==0)return false;cK=g;return true;} get totalTime=>vK; get currentTime=>cK;}abstract class kB{ CC( g);}class kD implements kB{var ZK;var zK;var JL;kD(){ZK=0.0;zK=new List<kB>();JL=0;} add( g){if(g==null)return;if(JL==zK.length)zK.add(g);else zK[JL]=g;JL++ ;} remove( h){if(h==null)return;for(int g=0;g<JL;g++ ){if(zK[g]==h){zK[g]=null;break;}}} fB( h, i){var g=new oD(h,i);add(g);return g;} CC( k){ZK+= k;var l=JL;var h=0;for(int i=0;i<l;i++ ){var j=zK[i];if(j!=null&&j.CC(k)){if(h!=i)zK[h]=j;h++ ;}}for(int g=l;g<JL;g++ )zK[h++ ]=zK[g];for(int g=h;g<JL;g++ )zK[g]=null;JL=h;return true;}}class LD extends v{static const  tD='DIRECTION_UP';static const  iE='DIRECTION_RIGHT';static const  xD='DIRECTION_DOWN';static const  QD='DIRECTION_LEFT';var HM;var JM;var NM;var RM;LD( g,[ direction=QD]){if(direction!=tD&&direction!=xD&&direction!=QD&&direction!=iE){throw new ArgumentError('Invalid Gauge direction!');}HM=direction;JM=1.0;NM=g;RM=new QB.MI();GN();} get ratio=>JM;set ratio( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;JM=g;GN();} get RB=>NM;set RB( g){NM=g;GN();}GN(){if(NM==null){RM.left=0;RM.top=0;RM.right=0;RM.bottom=0;}else{var h=NM.width;var g=NM.height;switch (HM){case QD:RM.left=((1.0-JM)*h).toInt();RM.top=0;RM.right=h;RM.bottom=g;break;case tD:RM.left=0;RM.top=((1.0-JM)*g).toInt();RM.right=h;RM.bottom=g;break;case iE:RM.left=0;RM.top=0;RM.right=(JM*h).toInt();RM.bottom=g;break;case xD:RM.left=0;RM.top=0;RM.right=h;RM.bottom=(JM*g).toInt();break;}}} rB( h,[ returnRectangle]){var g=(NM!=null)?NM.width:0;var i=(NM!=null)?NM.height:0;return BE(h,g,i,returnRectangle);} VC( g, h){if(NM!=null&&g>=0.0&&h>=0.0&&g<NM.width&&h<NM.height)return this;return null;} nB( g){if(NM!=null)NM.RF(g,RM);}}class vF{var name;var uB;var JE;vF(this.name,this.uB,this.JE);}class jD{var NK;var WK;var mK;var BL;jD.NI( i, g, h, j){NK=0;WK=new QB(i,g,h,j);} nB( i){var g=i.context;g.beginPath();switch (NK){case 0:g.rect(WK.x,WK.y,WK.width,WK.height);break;case 1:g.arc(mK.x,mK.y,mK.HI,0,TB.PI*2.0,false);break;case 2:g.moveTo(BL[0].x,BL[0].y);for(int h=1;h<BL.length;h++ )g.lineTo(BL[h].x,BL[h].y);break;}g.clip();}}class vC extends OB{var LE;var PF;var FF;var XD;var ME=true;var enabled=true;var BM;vC([this.LE,this.PF,this.FF,this.XD]){HB(q.qE,XM);HB(q.RD,XM);HB(q.PD,XM);HB(q.yD,XM);BM=this.LE;} rB( g,[ returnRectangle]){if(BM!=null){qM.FE(BM.YN,g);return BM.rB(qM,returnRectangle);}return super.rB(g,returnRectangle);} VC( k, l){if(this.XD!=null){var g=this.XD.YN;var h=k-g.GC;var i=l-g.HC;var m=(g.d*h-g.c*i)/g.cC;var j=(g.a*i-g.b*h)/g.cC;if(this.XD.VC(m,j)!=null)return this;}return null;} nB( g){if(BM!=null)g.SF(BM);} XM( g){if(g.type==q.RD){BM=LE;}else{BM=g.RC?FF:PF;}}}class NB{var x;var y;NB(this.x,this.y);NB.MI():this(0,0); get length=>TB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new NB(this.x+g.x,this.y+g.y); EE( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class QB{var x;var y;var width;var height;QB(this.x,this.y,this.width,this.height);QB.MI():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new NB(this.width,this.height); set bottom( g){this.height=g-this.y;} set left( g){this.x=g;} set right( g){this.width=g-this.x;} set top( g){this.y=g;} contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); EE( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;}}class uF{uF();}class UB{var OK,PK,RK,SK,VK,XK;var hK;UB.QI():OK=1.0,PK=0.0,RK=0.0,SK=1.0,VK=0.0,XK=0.0,hK=1.0; get a=>OK; get b=>PK; get c=>RK; get d=>SK; get GC=>VK; get HC=>XK; get cC=>hK; hH( g){return new NB(g.x*OK+g.y*RK+VK,g.x*PK+g.y*SK+XK);} concat( g){var m=OK;var AB=PK;var FB=RK;var s=SK;var l=VK;var o=XK;var SB=hK;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var gB=g.GC;var KB=g.HC;var vB=g.cC;OK=(m*j+AB*i);PK=(m*k+AB*h);RK=(FB*j+s*i);SK=(FB*k+s*h);VK=(l*j+o*i+gB);XK=(l*k+o*h+KB);hK=(SB*vB);} HH(){OK=1.0;PK=0.0;RK=0.0;SK=1.0;VK=0.0;XK=0.0;hK=1.0;} NH(){var j=OK;var m=PK;var l=RK;var k=SK;var h=VK;var i=XK;var g=hK;OK=(k/g);PK=-(m/g);RK=-(l/g);SK=(j/g);VK=-(OK*h+RK*i);XK=-(PK*h+SK*i);hK=(1.0/g);} TF( g, j, i, h, k, l){OK=g;PK=j;RK=i;SK=h;VK=k;XK=l;hK=(g*h-j*i);} EE( g){OK=g.a;PK=g.b;RK=g.c;SK=g.d;VK=g.GC;XK=g.HC;hK=g.cC;} FE( h, g){var o=h.a;var FB=h.b;var KB=h.c;var AB=h.d;var m=h.GC;var s=h.HC;var gB=h.cC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var vB=g.GC;var SB=g.HC;var dC=g.cC;OK=(o*k+FB*j);PK=(o*l+FB*i);RK=(KB*k+AB*j);SK=(KB*l+AB*i);VK=(m*k+s*j+vB);XK=(m*l+s*i+SB);hK=(gB*dC);}}class tF{var QK;var fK;var oK;var KL;var YL;tF(){QK=new kD();fK=new List<pC>();oK=double.NAN;KL=JD.fE;YL=new VE(0);eC.window.requestAnimationFrame(cM);} get OH=>QK; cM( g){eC.window.requestAnimationFrame(cM);if(oK.isNaN)oK=g;if(oK>g)oK=g;var j=g-oK;var i=j/1000.0;if(j>=1){oK=g;YL.aK=i;KL.NN(YL);QK.CC(i);for(int h=0;h<fK.length;h++ ){var k=fK[h];k.QH();}}} yE( g){fK.add(g);}}class BC{var bK;var tK;var IL;var RL;BC.OI( j,[ matrix]){bK=j;tK=new List<UB>.fixedLength(100);IL=new List<double>.fixedLength(100);for(int h=0;h<100;h++ ){tK[h]=new UB.QI();IL[h]=1.0;}RL=0;if(matrix!=null)tK[0].EE(matrix);var g=tK[0];var i=IL[0];bK.setTransform(g.a,g.b,g.c,g.d,g.GC,g.HC);bK.globalAlpha=i;} get context=>bK; reset(){RL=0;var g=tK[0];var h=IL[0];bK.setTransform(g.a,g.b,g.c,g.d,g.GC,g.HC);bK.globalAlpha=h;bK.clearRect(0,0,bK.canvas.width,bK.canvas.height);} SF( h){var i=RL;var j=RL+1;var l=tK[i];var g=tK[j];var m=IL[i];var k=IL[j]=h.MM*m;g.FE(h.YN,l);bK.setTransform(g.a,g.b,g.c,g.d,g.GC,g.HC);bK.globalAlpha=k;RL=j;if(h.mask==null){h.nB(this);}else{bK.save();h.mask.nB(this);h.nB(this);bK.restore();}RL=i;}}class BB extends kC{var zH=false;var ME=false;}class XB{var volume;var WH;var FI=1;var GI=0;var KI=1;var JI=0;XB([this.volume=1,this.WH=0]);}class bE{var font;var size;var color;var DC;var HF;var iH;var align;var PH;var cH;var JH;var GE;var letterSpacing=0;var xH=0;var yH=false;var EI=false;bE(this.font,this.size,this.color,{this.DC: false,this.HF: false,this.iH: false,this.align: "left",this.PH: 0,this.cH: 0,this.JH: 0,this.GE: 0});}class AC{var dK; GH( g){if(dK!=null)return dK.containsKey(g)||dK.containsKey("${g}_CAPTURE");else return false;} HB( g, i(event),{ useCapture: false}){var h=xL(g,useCapture);var j=h.listen(i);return j;} dispatchEvent( g){gN(g,this,this,iC.OD);} gN( g, l, k, i){if(dK!=null){var j=(i==iC.dE)?"${g.type}_CAPTURE":g.type;var h=dK[j];if(h!=null){g.AL=l;g.bN=k;g.WN=i;g.dN=false;g.fN=false;h.NN(g);}}} xL( g, j){if(dK==null)dK=new Map<String,uC>();var i=j?"${g}_CAPTURE":g;var h=dK[i];if(h==null)h=dK[i]=new uC(this,g,j);return h;}}class JD<ND extends w>{static var fE=new JD<VE>();var dK;var nL;JD(){dK=new List<uC>(50);nL=0;} hM( g){for(int h=0;h<nL;h++ )if(dK[h]==g)return;if(nL==dK.length)dK.add(g);else dK[nL]=g;nL++ ;} NN( i){var l=nL;var j=0;i.WN=iC.OD;i.dN=false;i.fN=false;for(int k=0;k<l;k++ ){var h=dK[k];if(h!=null&&h.uL>0){i.AL=h.AL;i.bN=h.AL;h.NN(i);if(j!=k)dK[j]=h;j++ ;}}for(int g=l;g<nL;g++ )dK[j++ ]=dK[g];for(int g=j;g<nL;g++ )dK[g]=null;nL=j;}}class uC<ND extends w> extends wB.Stream<ND>{final  AL;final  nK;final  WL;var jL;var uL;uC(this.AL,this.nK,this.WL){jL=new List<BG>(5);uL=0;} listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new BG<ND>(this,h);if(uL==jL.length)jL.add(g);else jL[uL]=g;uL++ ;if(nK==w.kE&&WL==false)JD.fE.hM(this);return g;} uM( h){for(int g=0;g<uL;g++ ){if(jL[g]==h){jL[g]=null;break;}}} NN( l){var k=uL;var h=0;for(int i=0;i<k;i++ ){var j=jL[i];if(j!=null){j.oL(l);if(h!=i)jL[h]=j;h++ ;}}for(int g=k;g<uL;g++ )jL[h++ ]=jL[g];for(int g=h;g<uL;g++ )jL[g]=null;uL=h;}}class JC<ND extends w>{final  nK;const JC(this.nK); forTarget( g,{ useCapture: false}){return g.xL(nK,useCapture);}}class iC{static const  dE=1;static const  OD=2;static const  NG=3;}class VE extends w{var aK;VE( g):super(w.kE,false){aK=g;} get CE=>false;}class q extends w{static const  ZC="click";static const  LG="doubleClick";static const  PD="mouseDown";static const  yD="mouseUp";static const  pE="mouseMove";static const  RD="mouseOut";static const  qE="mouseOver";static const  bG="mouseWheel";static const  sE="middleClick";static const  eG="middleMouseDown";static const  hG="middleMouseUp";static const  tE="rightClick";static const  jG="rightMouseDown";static const  lG="rightMouseUp";var IN,KN;var LN,MN;var lN;var QM;var iM;var TM;var WM;var pN;var qN;var rN;q( g,[ bubbles=false]):super(g,bubbles){BN(g,bubbles);} BN( g,[ bubbles=false]){super.BN(g,bubbles);IN=KN=0;LN=MN=0;lN=false;QM=false;iM=false;TM=false;WM=false;pN=0;qN=0;rN=0;}set sN( g){IN=g.x;KN=g.y;}set tN( g){LN=g.x;MN=g.y;} get IF=>IN; get JF=>KN; get RC=>lN; get altKey=>QM; get ctrlKey=>TM; get shiftKey=>WM; get BD=>pN;}class IC extends w{static const  sD="keyDown";static const  gE="keyUp";var QM;var TM;var WM;var ZM;var iM;var lM;var oM;var rM;IC( g,[ bubbles=false]):super(g,bubbles){BN(g,bubbles);} BN( g,[ bubbles=false]){super.BN(g,bubbles);QM=false;TM=false;WM=false;ZM=false;iM=false;lM=0;oM=0;rM=0;} get altKey=>QM; get ctrlKey=>TM; get shiftKey=>WM; get charCode=>lM; get keyCode=>oM; get keyLocation=>rM;}class aE extends w{static const  JG="textInput";var eK="";aE( g,[ bubbles=false]):super(g,bubbles){}}class WB extends w{static const  eE="touchBegin";static const  hE="touchEnd";static const  jE="touchCancel";static const  oE="touchMove";static const  XG="touchOver";static const  YG="touchOut";var EN;var HN;var IN,KN;var LN,MN;var QM;var iM;var TM;var WM;var PN;var RN;var TN;WB( g,[ bubbles=false]):super(g,bubbles){BN(g,bubbles);} BN( g,[ bubbles=false]){super.BN(g,bubbles);EN=0;HN=false;IN=KN=0;LN=MN=0;QM=false;iM=false;TM=false;WM=false;PN=1.00;RN=0;TN=0;}set sN( g){IN=g.x;KN=g.y;}set tN( g){LN=g.x;MN=g.y;} get bD=>EN; get IF=>IN; get JF=>KN; get altKey=>QM; get ctrlKey=>TM; get shiftKey=>WM;}class lD{static var cE=pB.rD;static var EG=false;static var PG=new AC();static  vE( i){var h=i;var g="auto";if(cE!=pB.rD)h=cE;switch (h){case pB.rD:g="auto";break;case pB.uD:g="default";break;case pB.vD:g="pointer";break;case pB.SG:g="move";break;case pB.TG:g="text";break;case pB.VG:g="wait";break;}if(EG)g="none";return g;}}abstract class ZE{ nB( g);}class CB extends v{var RB;var XH;var VD;CB([this.RB=null,this.XH="auto"]){VD=null;} rB( h,[ returnRectangle]){var g=(RB!=null)?RB.width:0;var i=(RB!=null)?RB.height:0;return BE(h,g,i,returnRectangle);} VC( g, h){if(RB!=null&&g>=0.0&&h>=0.0&&g<RB.width&&h<RB.height)return this;return null;} nB( g){if(RB!=null){if(VD==null)RB.nB(g);else RB.RF(g,VD);}}}abstract class v extends AC implements ZE{var EL=0.0;var LL=0.0;var SL=0.0;var ZL=0.0;var fL=1.0;var mL=1.0;var wL=0.0;var DM;var FM;var MM=1.0;var OM=true;var SM=null;var TK="";var eM=null;var qM;var tM;v(){DM=new UB.QI();FM=true;qM=new UB.QI();tM=new UB.QI();} get x=>EL; get y=>LL; get WC=>SL; get XC=>ZL; get tB=>fL; get EC=>mL; get ZB=>wL; get alpha=>MM; get visible=>OM; get mask=>SM; get name=>TK; get parent=>eM; get root{var g=this;while (g.eM!=null)g=g.eM;return g;} get aD{var g=this.root;if(g is pC)return g;return null;}set x( g){EL=g;FM=true;}set y( g){LL=g;FM=true;}set WC( g){SL=g;FM=true;}set XC( g){ZL=g;FM=true;}set tB( g){fL=g;FM=true;}set EC( g){mL=g;FM=true;}set ZB( g){wL=g;FM=true;}set alpha( g){MM=g;FM=true;}set mask( g){SM=g;} get width=>rB(YN).width; get height=>rB(YN).height; set width( h){this.tB=1;var g=this.width;this.tB=(g!=0.0)?h/g:1.0;} set height( h){this.EC=1;var g=this.height;this.EC=(g!=0.0)?h/g:1.0;} HE(){if(eM!=null)eM.sB(this);} get YN{if(FM){FM=false;if(wL==0.0){DM.TF(fL,0.0,0.0,mL,EL-SL*fL,LL-ZL*mL);}else{var g=TB.cos(wL);var h=TB.sin(wL);var i=fL*g;var l=fL*h;var k=-mL*h;var j=mL*g;var m=EL-SL*i-ZL*k;var o=LL-SL*l-ZL*j;DM.TF(i,l,k,j,m,o);}}return DM;} rB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new QB.MI();returnRectangle.x=g.GC;returnRectangle.y=g.HC;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} VC( g, h){if(rB(tM).contains(g,h))return this;return null;} rC( h){qM.HH();for(v g=this;g!=null;g=g.eM)qM.concat(g.YN);qM.NH();return qM.hH(h);} dispatchEvent( h){var g=null;if(h.CE||h.bubbles)for(v j=eM;j!=null;j=j.eM)if(j.GH(h.type)){if(g==null)g=new List<v>();g.add(j);}if(h.CE&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.IE==false)g[i].gN(h,this,g[i],iC.dE);if(h.IE==false)gN(h,this,this,iC.OD);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.IE==false)g[i].gN(h,this,g[i],iC.NG);} vN( h){for(var g=h;g!=null;g=g.eM)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");eM=h;} nB( g);}abstract class OB extends v{var BH=false;var VB=true;var LI=true;var tabIndex=0;static const  WG=const JC<q>(q.RD);static const  fG=const JC<q>(q.pE);static const  iG=const JC<q>(q.PD);static const  mG=const JC<q>(q.yD);static const  qG=const JC<q>(q.bG); get onMouseOut=>OB.WG.forTarget(this); get onMouseMove=>OB.fG.forTarget(this); get onMouseDown=>OB.iG.forTarget(this); get onMouseUp=>OB.mG.forTarget(this); get onMouseWheel=>OB.qG.forTarget(this);static const  rG=const JC<WB>(WB.oE);static const  sG=const JC<WB>(WB.hE);static const  tG=const JC<WB>(WB.jE); get onTouchMove=>OB.rG.forTarget(this); get onTouchEnd=>OB.sG.forTarget(this); get onTouchCancel=>OB.tG.forTarget(this);static const  uG=const JC<IC>(IC.gE);static const  vG=const JC<IC>(IC.sD); get onKeyUp=>OB.uG.forTarget(this); get onKeyDown=>OB.vG.forTarget(this);}abstract class kC extends OB{var FL;var ML=true;var XL=true;kC(){FL=new List<v>();} n( g){if(g.parent==this){var h=FL.indexOf(g);FL.removeAt(h);FL.add(g);}else{xG(g,FL.length);}} xG( g, h){if(h<0&&h>FL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){FL.removeAt(FL.indexOf(g));if(h>FL.length)h-- ;FL.insertRange(h,1,g);}else{g.HE();g.vN(this);FL.insertRange(h,1,g);g.dispatchEvent(new w(w.CG,true));if(this.aD!=null)wN(g,new w(w.wC));}} sB( h){var g=FL.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");ZH(g);} ZH( g){if(g<0&&g>=FL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=FL[g];h.dispatchEvent(new w(w.UG,true));if(this.aD!=null)wN(h,new w(w.yC));h.vN(null);FL.removeAt(g);} contains( g){for(;g!=null;g=g.eM)if(g==this)return true;return false;} rB( o,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new QB.MI();if(FL.length==0)return super.rB(o,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var s=FL.length;for(int l=0;l<FL.length;l++ ){var m=FL[l];qM.FE(m.YN,o);var g=m.rB(qM,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} VC( s, AB){var l=null;for(int j=FL.length-1;j>=0;j-- ){var i=FL[j];if(i.visible){var g=i.YN;var m=s-g.GC;var k=AB-g.HC;var FB=(g.d*m-g.c*k)/g.cC;var o=(g.a*k-g.b*m)/g.cC;var h=i.VC(FB,o);if(h!=null){if(h is OB)if(h.VB)return ML?h:this;l=this;}}}return l;} nB( i){for(int g=0;g<FL.length;g++ ){var h=FL[g];if(h.visible)i.SF(h);}} wN( g, j){g.dispatchEvent(j);if(g is kC){var i=new List<v>.from(g.FL);for(int h=0;h<i.length;h++ )wN(i[h],j);}}}class WE{var target=null;var RC=false;var DE=0;var BD=0;var MF,NF;var KF,LF;WE(this.MF,this.NF,this.KF,this.LF);}class lC{static const  rD="auto";static const  HG="stop";static const  wD="once";}class w{static const  CG="added";static const  wC="addedToStage";static const  kE="enterFrame";static const  UG="removed";static const  yC="removedFromStage";var NK;var UN;var WN;var AL;var bN;var dN;var fN;w( g,[ bubbles=false]){BN(g,bubbles);} BN( g,[ bubbles=false]){NK=g;UN=bubbles;WN=iC.OD;AL=null;bN=null;dN=false;fN=false;} get IE=>dN; get type=>NK; get bubbles=>UN; get CE=>true; get target=>AL;}class DB implements ZE{var kK;var pK;var DL;var QL;var bK;var iL;var rL;var yL;var yK;var GL;var OL;var UL;DB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){kK=g;pK=h;DL=transparent;var i=new eC.CanvasElement(width:kK,height:pK);bK=i.context2d;bK.fillStyle=DL?aG(fillColor):xC(fillColor);bK.fillRect(0,0,g,h);QL=i;iL=0;}DB.RI( g){kK=g.naturalWidth;pK=g.naturalHeight;DL=true;QL=g;iL=0;}DB.SI( g){kK=g.VH;pK=g.UH;DL=true;QL=g.gH.IH;iL=g.dH?2:1;rL=g.offsetX.toDouble();yL=g.offsetY.toDouble();yK=g.EH.toDouble();GL=g.FH.toDouble();OL=g.DH.toDouble();UL=g.CH.toDouble();}static  xE( i){var h=new wB.Completer<DB>();var g=new eC.ImageElement();g.onLoad.listen((j)=>h.complete(new DB.RI(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>kK; get height=>pK; nB( g){switch (iL){case 0:g.context.drawImage(QL,0.0,0.0);break;case 1:g.context.drawImage(QL,yK,GL,OL,UL,rL,yL,OL,UL);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,rL,yL+UL);g.context.drawImage(QL,yK,GL,UL,OL,0.0,0.0,UL,OL);break;}} RF( gB, g){if(g.width<=0.0||g.height<=0.0)return;switch (iL){case 0:gB.context.drawImage(QL,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=yK;double h=GL;double AB=j+OL;double FB=h+UL;double l=yK-rL+g.x;double m=GL-yL+g.y;double SB=l+g.width;double KB=m+g.height;double s=(j>l)?j:l;double o=(h>m)?h:m;double vB=(AB<SB)?AB:SB;double NE=(FB<KB)?FB:KB;double OE=rL-j+s;double dC=yL-h+o;double k=vB-s;double i=NE-o;if(k>0.0&&i>0.0){gB.context.drawImage(QL,s,o,k,i,OE,dC,k,i);}break;case 2:double j=yK;double h=GL;double AB=j+UL;double FB=h+OL;double l=yK+yL-g.y+UL-g.height;double m=GL-rL+g.x;double SB=l+g.height;double KB=m+g.width;double s=(j>l)?j:l;double o=(h>m)?h:m;double vB=(AB<SB)?AB:SB;double NE=(FB<KB)?FB:KB;double OE=rL-h+o;double dC=yL+AB-vB;double k=NE-o;double i=vB-s;if(k>0.0&&i>0.0){gB.context.transform(0.0,-1.0,1.0,0.0,OE,dC+i);gB.context.drawImage(QL,s,o,i,k,0.0,0.0,i,k);}break;}}}class qD extends LD implements kB{static const  GG='TIME_OUT';var gL=false;var cK=0.0;var vK=0.0;var EM;var IM=true;qD( g, h,[ direction=LD.QD]):super(h,direction){if(g<=0)throw new ArgumentError('Time must be greater than zero');vK=g;BF();} CC( g){if(gL&&ratio>0.0){ratio=ratio-g/totalTime;if(ratio==0.0)pause();}return true;} start(){gL=true;} pause(){gL=false;} reset([ time=0.0]){pause();time=TB.max(time,0.0);if(time!=0.0){vK=time;BF();}ratio=1.0;} UD( g, h){EM[g]=h/totalTime;} BF(){EM=new Map<String,num>();UD(qD.GG,0);} get totalTime=>vK; get bH=>ratio*totalTime; set ratio( i){var h=ratio;super.ratio=i;if(IM){EM.forEach((j,g){if(g<h&&g>=ratio)dispatchEvent(new w(j));});}}}typedef  wF<ND extends w>( event);class BG<ND extends w> extends wB.StreamSubscription<ND>{var eL;var oL;var tL;var zL;BG(this.eL,this.oL){tL=0;zL=false;} cancel(){if(zL==false){eL.uM(this);zL=true;oL=null;}} onError( g( error)){} get aN=>tL>0; pause([ resumeSignal]){tL++ ;if(resumeSignal!=null)resumeSignal.whenComplete(resume);} resume(){if(aN==false)throw new StateError("Subscription is not paused.");tL-- ;}} xC( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class lE{static var nE=false;static var zD=false;static var AE=0;static var dG=UE.KG;static var PG=new AC();static gG(){if(nE==false){nE=true;var g=eC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){zD=true;AE=10;}if(g.contains("Android")){zD=true;AE=10;}if(g.contains("IEMobile")){zD=true;AE=10;}}}static  get pG{gG();return dG;}}class PC extends kB{var UM;var YM;var bM;var gM;var kM;var nM;var pM;var vK;var cK;var wM;var yM;var zM;PC( g, h, i,[ transitionFunction( ratio)]){UM=g;YM=h;bM=g;gM=(transitionFunction!=null)?transitionFunction:MB.QC;cK=0.0;vK=TB.max(0.0001,i);wM=0.0;yM=false;zM=false;} CC( i){if(cK<vK||zM==false){cK=cK+i;if(cK>vK)cK=vK;if(cK>=0.0){if(zM==false){zM=true;if(kM!=null)kM();}var g=cK/vK;var h=gM(g);bM=UM+h*(YM-UM);if(nM!=null)nM(yM?bM.round():bM);if(pM!=null&&cK==vK)pM();}}return cK<vK;} get uB=>UM; get JE=>YM; get totalTime=>vK; get currentTime=>cK;set TC( g){if(zM==false)cK=cK+wM-g;wM=g;} set onStart( g()){kM=g;} set LC( g( value)){nM=g;} set onComplete( g()){pM=g;}}class rE{static var cG=0;var bD=cG++ ;var target=null;var ZD=false;rE(this.target,this.ZD);} aG( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class MB{static  QC( g){return g;}static  wE( g){return g*g*g;}static  qB( g){g=1.0-g;return 1.0-g*g*g;}static  wG( g){if(g==0.0||g==1.0)return g;return TB.pow(2.0,-10.0*g)*TB.sin((g-0.3/4.0)*(2.0*TB.PI)/0.3)+1;}}class lB implements kB{var DN;var gM;var JN;var kM;var nM;var pM;var vK;var cK;var wM;var yM;var zM;lB( g, h,[ transitionFunction( ratio)]){DN=g;gM=(transitionFunction!=null)?transitionFunction:MB.QC;cK=0.0;vK=TB.max(0.0001,h);wM=0.0;yM=false;zM=false;JN=new List<vF>();} YB( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(DN!=null&&zM==false)JN.add(new vF(g,0.0,h));} moveTo( h, g){YB('x',h);YB('y',g);} CC( l){if(cK<vK||zM==false){cK=cK+l;if(cK>vK)cK=vK;if(cK>=0.0){if(zM==false){zM=true;for(int i=0;i<JN.length;i++ ){var g=JN[i];switch (g.name){case 'x':g.uB=DN.x;break;case 'y':g.uB=DN.y;break;case 'pivotX':g.uB=DN.WC;break;case 'pivotY':g.uB=DN.XC;break;case 'scaleX':g.uB=DN.tB;break;case 'scaleY':g.uB=DN.EC;break;case 'rotation':g.uB=DN.ZB;break;case 'alpha':g.uB=DN.alpha;break;}}if(kM!=null)kM();}var j=cK/vK;var k=gM(j);for(int i=0;i<JN.length;i++ ){var g=JN[i];var h=g.uB+k*(g.JE-g.uB);h=yM?h.round():h;switch (g.name){case 'x':DN.x=h;break;case 'y':DN.y=h;break;case 'pivotX':DN.WC=h;break;case 'pivotY':DN.XC=h;break;case 'scaleX':DN.tB=h;break;case 'scaleY':DN.EC=h;break;case 'rotation':DN.ZB=h;break;case 'alpha':DN.alpha=h;break;}}if(nM!=null)nM();if(pM!=null&&cK==vK)pM();}}return cK<vK;} get totalTime=>vK; get currentTime=>cK;set TC( g){if(zM==false)cK=cK+wM-g;wM=g;} set onStart( g()){kM=g;} set LC( g()){nM=g;} set onComplete( g()){pM=g;}} kG( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class pC extends kC{var CN;var bK;var ON;var QN;var VN;var XN;var ZN;var cN;var eN;var hN;var iN;var jN;var kN;var nN;var oN;pC( h, g){TK=h;CN=g;CN.focus();bK=g.context2d;QN=new BC.OI(bK);VN=lC.rD;XN=pB.uD;lD.PG.HB("mouseCursorChanged",uN);eN=[new WE(q.PD,q.yD,q.ZC,q.LG),new WE(q.eG,q.hG,q.sE,q.sE),new WE(q.jG,q.lG,q.tE,q.tE)];cN=null;ZN=new NB(0,0);iN=new q(q.ZC,true);nN=XM;CN.onMouseDown.listen(nN);CN.onMouseUp.listen(nN);CN.onMouseMove.listen(nN);CN.onMouseOut.listen(nN);CN.onMouseWheel.listen(nN);hN=new Map<int,rE>();kN=new WB(WB.eE,true);oN=xN;lE.PG.HB("inputModeChanged",yN);yN(null);jN=new IC(IC.sD,true);CN.onKeyDown.listen(AO);CN.onKeyUp.listen(AO);CN.onKeyPress.listen(BO);} get focus=>ON; set aH( g){VN=g;} CO(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){CO();} set y( g){CO();} set WC( g){CO();} set XC( g){CO();} set tB( g){CO();} set EC( g){CO();} set ZB( g){CO();} set alpha( g){CO();} set width( g){CO();} set height( g){CO();} QH(){if(VN==lC.rD||VN==lC.wD){QN.reset();nB(QN);if(VN==lC.wD)VN=lC.HG;}} uN( g){CN.style.cursor=lD.vE(XN);} XM( j){j.preventDefault();var KB=CN.getBoundingClientRect();var o=new DateTime.now().millisecondsSinceEpoch;var AB=j.button;var h=null;var i=new NB(j.clientX-KB.left,j.clientY-KB.top);var m=null;if(AB<0||AB>2)return;if(j.type=="mousemove"&&ZN.equals(i))return;var g=eN[AB];ZN=i;if(j.type!="mouseout")h=VC(i.x,i.y) as OB;var k=pB.uD;if(h is BB)if(h.ME)k=pB.vD;if(h is vC)if(h.ME)k=pB.vD;if(XN!=k){XN=k;CN.style.cursor=lD.vE(k);}if(cN!=null&&cN!=h){cN.dispatchEvent(iN..BN(q.RD,true)..sN=(cN.aD!=null)?cN.rC(i):new NB.MI()..tN=i..lN=g.RC);cN=null;}if(h!=null&&h!=cN){h.dispatchEvent(iN..BN(q.qE,true)..sN=h.rC(i)..tN=i..lN=g.RC);cN=h;}var l=null;var s=false;var FB=false;if(j.type=="mousedown"){l=g.MF;if(h!=g.target||o>g.DE+500)g.BD=0;g.RC=true;g.target=h;g.DE=o;g.BD++ ;}if(j.type=="mouseup"){l=g.NF;g.RC=false;s=(g.target==h);FB=s&&g.BD.isEven&&(o<g.DE+500);}if(j.type=="mousemove"){l=q.pE;}if(l!=null&&h!=null){m=h.rC(i);h.dispatchEvent(iN..BN(l,true)..sN=m..tN=i..lN=g.RC..pN=g.BD);if(s){if(FB&&h.BH){h.dispatchEvent(iN..BN(g.LF,true)..sN=m..tN=i..lN=g.RC);}else{h.dispatchEvent(iN..BN(g.KF,true)..sN=m..tN=i..lN=g.RC);}}}}var EO=[] ; yN( h){EO.forEach((g)=>g.cancel());if(lE.pG==UE.QG){EO=[CN.onTouchStart.listen(oN),CN.onTouchEnd.listen(oN),CN.onTouchMove.listen(oN),CN.onTouchEnter.listen(oN),CN.onTouchLeave.listen(oN),CN.onTouchCancel.listen(oN)];}} xN( j){j.preventDefault();var o=CN.getBoundingClientRect();for(var m in j.changedTouches){var l=m.identifier;var h=null;var i=new NB(m.clientX-o.left,m.clientY-o.top);var s=null;h=VC(i.x,i.y) as OB;var g=hN.containsKey(l)?hN[l]:new rE(h,hN.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(kN..BN(WB.YG,true)..sN=(g.target.aD!=null)?g.target.rC(i):new NB.MI()..tN=i..EN=g.bD..HN=g.ZD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(kN..BN(WB.XG,true)..sN=h.rC(i)..tN=i..EN=g.bD..HN=g.ZD);g.target=h;}var k=null;if(j.type=="touchstart"){hN[l]=g;k=WB.eE;}if(j.type=="touchend"){hN.remove(l);k=WB.hE;}if(j.type=="touchcancel"){hN.remove(l);k=WB.jE;}if(j.type=="touchmove"){k=WB.oE;}if(k!=null&&h!=null){h.dispatchEvent(kN..BN(k,true)..sN=h.rC(i)..tN=i..EN=g.bD..HN=g.ZD);}}} AO( g){g.preventDefault();var h=null;if(g.type=="keyup")h=IC.gE;if(g.type=="keydown")h=IC.sD;jN..BN(h,true)..QM=g.altKey..TM=g.ctrlKey..WM=g.shiftKey..lM=g.charCode..oM=g.keyCode..rM=nC.xF;if(g.keyLocation==eC.KeyLocation.LEFT)jN.rM=nC.DG;if(g.keyLocation==eC.KeyLocation.RIGHT)jN.rM=nC.MG;if(g.keyLocation==eC.KeyLocation.NUMPAD)jN.rM=nC.RG;if(g.keyLocation==eC.KeyLocation.JOYSTICK)jN.rM=nC.mE;if(g.keyLocation==eC.KeyLocation.MOBILE)jN.rM=nC.mE;if(ON!=null)ON.dispatchEvent(jN);} BO( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new aE(aE.JG,true);h.eK=new String.fromCharCodes([i]);if(ON!=null)ON.dispatchEvent(h);}} oG( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} BE( g, m, FB, j){var dC=0.0;var vB=0.0;var AB=m*g.a;var gB=m*g.b;var KB=m*g.a+FB*g.c;var s=m*g.b+FB*g.d;var SB=FB*g.c;var o=FB*g.d;var h=dC;if(h>AB)h=AB;if(h>KB)h=KB;if(h>SB)h=SB;var i=vB;if(i>gB)i=gB;if(i>s)i=s;if(i>o)i=o;var l=dC;if(l<AB)l=AB;if(l<KB)l=KB;if(l<SB)l=SB;var k=vB;if(k<gB)k=gB;if(k<s)k=s;if(k<o)k=o;if(j==null)j=new QB.MI();j.x=g.GC+h;j.y=g.HC+i;j.width=l-h;j.height=k-i;return j;}//@ sourceMappingURL=escape.dart.map
