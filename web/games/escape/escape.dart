import "dart:math" as QB;import "dart:json" as HH;import "dart:html" as XC;class RF extends AB{var rH;var BI;var LI;var SI;var VI;RF(){LI=eB.JB.iB("Warning");SI=null;rH=GB.cF();BI=new CB(rH[0]);n(BI);} start(){SI=LI.play();p.remove(VI);VI=new LC(0,80,9.0,KB.KC);VI.GC=(h){var g=h.toInt()%8;BI.OB=rH[(g<=4)?g+1:8-g];};p.add(VI);} stop(){if(SI!=null){SI.stop();SI=null;}p.remove(VI);BI.OB=rH[0];}}class QF extends AB{var YI;var fI;var kI;var oI;var rI;var sI;var tI;var uI;var vI;var xI;var yI;var zI;var AJ;var BJ;var CJ;var EJ;var FJ;var GJ;var HJ;var JJ;QF( o, l, v, PB, BB, s, k){uI=new QB.Random();vI=vB.nC;xI=k;YI=o;fI=l;kI=v;oI=PB;rI=BB;sI=s;tI=k.length;BJ=new List<bB>();EJ=new AB();FJ=new AB();GJ=new AB();HJ=new AB();JJ=new AB();n(EJ);n(FJ);n(GJ);n(HJ);n(JJ);FJ.SB=false;GJ.SB=false;HJ.SB=false;JJ.SB=false;iG();jG();hG();CJ=true;var m=new mC();this.mask=new dF.jH(0.0,0.0,500.0,500.0);for(int g=0;g<10;g++ ){for(int h=0;h<10;h++ ){var i=zI[g+h*10];i.x=g*50+25;i.y=h*50+25-550;i.jB(EJ,FJ,GJ);var j=new LC(i.y,h*50+25,0.4,KB.qB);j.delay=g*0.03;j.GC=(LB){i.y=LB;};j.onComplete=(){if(m.TD()==100){QJ();CJ=false;BJ.clear();this.mask=null;}};p.add(j);}}addEventListener(t.HD,RJ);} NF( g){if(g==vB.XD)vI=g;if(g==vB.YD&&vI==vB.nC){vI=g;if(CJ==false)MB(new aB(aB.aD,null));}} wE(){this.mask=new dF.jH(0.0,0.0,500.0,500.0);for(int h=0;h<10;h++ ){for(int i=0;i<10;i++ ){var g=zI[i+h*10];g.dB=false;g.FC=false;g.FB=u.xC;g.jB(EJ,FJ,GJ);var j=new LC(g.y,500+h*50+25,0.5,KB.qB);j.delay=i*0.1;j.GC=(k){g.y=k;};p.add(j);}}} iG(){AJ=new List<wC>();for(int h=0;h<fI;h++ ){var g=new wC(h);g.WB=(uI.nextInt(30)-15)*QB.PI/180;g.x=300-(90*fI)/2+h*90+uI.nextInt(20)-10;g.y=550;AJ.add(g);HJ.n(g);}} tE( g, h){var i=0;var j=zI[g+h*10];if(j.direction==0){var o=(g>0)?zI[g-1+h*10]:null;var l=(g<9)?zI[g+1+h*10]:null;if(j.TC(o))i++ ;if(j.TC(l))i++ ;}else{var k=(h>0)?zI[g+(h-1)*10]:null;var m=(h<9)?zI[g+(h+1)*10]:null;if(j.cC(k))i++ ;if(j.cC(m))i++ ;}return i;} sE(){for(int h=0;h<10;h++ ){for(int g=0;g<10;g++ ){var i=zI[g+h*10];var j=tI*2;while (tE(g,h)==2&&j>0){if(j%2==0){i.direction=1-i.direction;j-- ;}else{var m=0;for(int k=0;k<xI.length;k++ )if(i.color==xI[k])m=k;i.color=xI[(m+1)%xI.length];j-- ;}}}}var l=false;for(int h=0;h<10;h++ )for(int g=0;g<10;g++ )l=l||(tE(g,h)==2);return l;} EF(){for(int g=0;g<10;g++ )for(int h=1;h<9;h++ )if(zI[(h-1)+g*10].PD(zI[h+g*10])&&zI[h+g*10].PD(zI[(h+1)+g*10]))return true;for(int h=0;h<10;h++ )for(int g=1;g<9;g++ )if(zI[h+(g-1)*10].PD(zI[h+g*10])&&zI[h+g*10].PD(zI[h+(g+1)*10]))return true;return false;} XJ( l, j, k){for(int h=0;h<20;h++ ){var g=YI~/k;var i=j*g+uI.nextInt(g);if(yI[i].FB==u.xC){yI[i].FB=l;return;}}} jG(){yI=new List<IB>();for(int g=0;g<YI;g++ ){var i=xI[uI.nextInt(xI.length)];var h=uI.nextInt(2);yI.add(new IB(i,h));}for(int g=0;g<fI*2;g++ )XJ("Lock${(g%fI)+1}",g,fI*2);for(int g=0;g<kI;g++ )XJ(u.NB,g,kI);for(int g=0;g<oI;g++ )XJ(u.wB,g,oI);for(int g=0;g<rI;g++ )XJ(u.KE,g,rI);for(int g=0;g<sI;g++ )XJ(u.LE,g,sI);} hG(){zI=new List<IB>();var g=true;while (g){zI.clear();for(int h=0;h<100;h++ ){var i=xI[uI.nextInt(xI.length)];var j=uI.nextInt(2);zI.add(new IB(i,j));}g=sE();}} JF(){if(CJ||vI!=vB.nC)return false;var l=true;CJ=true;while (l){for(int k=0;k<zI.length;k++ ){var g=zI[k];g.dB=false;g.FC=false;g.jB(EJ,FJ,GJ);g.color=xI[uI.nextInt(xI.length)];g.direction=uI.nextInt(2);}l=sE()||(EF()==false);}var s=eB.JB.iB("BonusUniversal");s.play();var m=new mC();for(int i=0;i<10;i++ ){for(int j=0;j<10;j++ ){var g=zI[i+j*10];g.KF=0.0;var h=new LC(0.0,1.0,0.2,KB.KC);h.delay=i*0.06;h.GC=(o){g.KF=o;};h.CF=(){g.jB(EJ,FJ,GJ);};h.onComplete=(){if(m.TD()==100){QJ();YJ();BJ.clear();}};p.add(h);}}return true;} QJ(){for(int i=0;i<10;i++ ){for(int h=0;h<10;h++ ){var g=zI[h+i*10];var l=(h<9)?zI[h+1+i*10]:null;var m=(i<9)?zI[h+(i+1)*10]:null;var j=false;var k=false;if(g.TC(l)){j=true;k=(g.FB==u.NB||l.FB==u.NB);}if(g.cC(m)){j=true;k=(g.FB==u.NB||m.FB==u.NB);}if(g.dB!=j||g.FC!=k){g.dB=j;g.FC=k;g.jB(EJ,FJ,GJ);}}}} aJ( o, l, s, k, m, v){CJ=true;o.TD(k);var i=1;for(int h=0;h<k;h++ ){var g=zI[l+h*m+(s+h*v)*10];if(g.FB==u.KE)i=i*2;if(g.FB==u.LE)i=i*5;var LB=l+h*m;var PB=s+h*v;p.fB((){g.empty=true;g.jB(EJ,FJ,GJ);var BB=eB.JB.iB("ChainBlast");BB.play();var j=new IE(g.color,g.direction);j.x=LB*50;j.y=PB*50;p.add(j);JJ.n(j);uG(g);if(o.uE()==0)cJ();},0.1+h*0.1);}MB(new aB(aB.IE,{"Length":k,"Factor":i}));} YJ(){CJ=false;var j=new mC();for(int h=0;h<10;h++ ){for(int i=0;i<10;){var g=1;while (i+g<10&&zI[i+g-1+h*10].TC(zI[i+g+h*10]))g++ ;if(g>=3)aJ(j,i,h,g,1,0);i=i+g;}}for(int i=0;i<10;i++ ){for(int h=0;h<10;){var g=1;while (h+g<10&&zI[i+(h+g-1)*10].cC(zI[i+(h+g)*10]))g++ ;if(g>=3)aJ(j,i,h,g,0,1);h=h+g;}}if(j.value==0){if(vI==vB.XD)MB(new aB(aB.JE,null));if(vI==vB.YD)MB(new aB(aB.aD,null));if(vI==vB.nC&&EF()==false)JF();}} uG( h){if(h.FB.indexOf("Lock")==0){var k=int.parse(h.FB.substring(4,5))-1;var j=AJ[k];var g=GB.bD(h.FB);g.x=h.x;g.y=h.y;n(g);var i=new lB(g,0.5,KB.qB);i.VB("x",j.x);i.VB("y",j.y-10);i.onComplete=()=>sB(g);p.add(i);p.fB(()=>pG(k),0.5);}} pG( k){var h=AJ[k];var i;if(h.vC){i=new aB(aB.yC,{"Type":"SingleLocked","Position":new bB(h.x+20,h.y)});var l=eB.JB.iB("Unlock");l.play();}else{i=new aB(aB.yC,{"Type":"SingleUnlocked","Position":new bB(h.x+20,h.y)});}MB(i);h.vC=false;h.IF(false);var j=true;for(int g=0;g<AJ.length;g++ )j=j&&(AJ[g].vC==false);if(j){var m=eB.JB.iB("BonusAllUnlock");m.play();for(int g=0;g<AJ.length;g++ ){AJ[g].vC=true;p.fB(()=>AJ[(g+k)%AJ.length].AH(),g*0.2);}p.fB(()=>MB(new aB(aB.yC,{"Type":"All","Position":new bB(280,550)})),0.75);}} cJ(){var o=new mC();for(int i=0;i<10;i++ ){var k=9;var j=8;while (k>=0){while (k>=0&&zI[i+k*10].empty==false){k-- ;j-- ;}while (j>=0&&zI[i+j*10].empty==true){j-- ;}if(k>=0){var g,h,l;if(j>=0){h=zI[i+j*10];if(i>0){l=zI[i-1+j*10];if(h.TC(l)){l.dB=false;l.jB(EJ,FJ,GJ);}}h.dB=false;h.empty=true;h.jB(EJ,FJ,GJ);}else{if(yI.length>0){h=yI[0];yI.removeRange(0,1);}else{h=new IB(xI[uI.nextInt(xI.length)],uI.nextInt(2));}}g=zI[i+k*10];g.color=h.color;g.direction=h.direction;g.FB=h.FB;g.dB=false;g.empty=false;g.x=50*i+25;g.y=50*j+25;g.jB(EJ,FJ,GJ);o.TD();var m=new LC(g.y,50*k+25,0.1,KB.KC);m.GC=(s){g.y=s;};m.onComplete=(){if(o.uE()==0){QJ();YJ();eJ();}};p.add(m);}}}} RJ( g){if(g.target==EJ&&this.SB){var j=QB.min(g.zE/50,9).toInt();var h=QB.min(g.AF/50,9).toInt();var i=new bB(j,h);BJ.add(i);eJ();}} eJ(){while (vI==vB.nC&&CJ==false&&BJ.length>0){var m=BJ[0];BJ.removeRange(0,1);var j=m.x.toInt();var k=m.y.toInt();var g=zI[j+k*10];var i=(j>0)?zI[j-1+k*10]:null;var o=(j<9)?zI[j+1+k*10]:null;var h=(k>0)?zI[j+(k-1)*10]:null;var s=(k<9)?zI[j+(k+1)*10]:null;var l=false;if(g.FB==u.wB){var v=eB.JB.iB("ChainError");v.play();continue;}if(g.cC(h)){h.dB=false;h.jB(EJ,FJ,GJ);}if(g.TC(i)){i.dB=false;i.jB(EJ,FJ,GJ);}g.direction=1-g.direction;g.dB=false;g.FC=false;var LB=eB.JB.iB("ChainRotate");LB.play();if(g.TC(o)){g.dB=true;g.FC=(g.FB==u.NB||o.FB==u.NB);}if(g.cC(s)){g.dB=true;g.FC=(g.FB==u.NB||s.FB==u.NB);}g.jB(EJ,FJ,GJ);l=l||g.dB;if(g.cC(h)){h.dB=true;h.FC=(g.FB==u.NB||h.FB==u.NB);h.jB(EJ,FJ,GJ);l=true;}if(g.TC(i)){i.dB=true;i.FC=(g.FB==u.NB||i.FB==u.NB);i.jB(EJ,FJ,GJ);l=true;}if(l){var BB=eB.JB.iB("ChainLink");BB.play();}YJ();}}}class aB extends EB{static const  IE="Explosion";static const  yC="Unlocked";static const  JE="Finalized";static const  aD="Timeouted";var eI;aB( h, g,[ bubbles=false]):super(h,bubbles){eI=g;} get info{return eI;}}class vB{static const  nC=1;static const  XD=2;static const  YD=3;}class HE extends AB{var nH;HE( j){var g=new IC();g.MC=new TE("Arial",30,0xFFFFFF,BC:true,align:pB.JC);g.width=110;g.height=36;g.wordWrap=false;g.x=646;g.y=130;g.SB=false;g.text=j.toString();g.x=-g.width/2;g.y=-g.height/2;nH=new AB();nH.n(g);n(nH);var i=new LC(0.0,1.0,1.5,KB.qB);i.GC=(h){nH.alpha=1-h;nH.y=-h*50;nH.tB=1.0+0.1*QB.sin(h*10);nH.CC=1.0+0.1*QB.cos(h*10);};i.onComplete=(){this.yD();};p.add(i);}}class UF extends AB{var pH;var xH;var II;var yH;UF(){var l=new CB(GB.JB.q("ExitBox"));n(l);var g=new IC();g.MC=new TE("Arial",24,0xFFFFFF,BC:true,align:pB.JC);g.width=240;g.height=100;g.wordWrap=true;g.text=YC.JB.lC("GENexitquery");g.x=47;g.y=150-g.CE/2;g.SB=false;n(g);pH=new iD(7,GB.JB.q("ExitGauge"),CD.sD);pH.x=268;pH.y=25;pH.addEventListener("TimeOver",IJ);n(pH);pH.ND("TimeOver",0);pH.start();var h=new CB(GB.JB.q("ExitYesButtonNormal"));var i=new CB(GB.JB.q("ExitYesButtonPressed"));xH=new oC(h,h,i,i);xH.x=68;xH.y=239;xH.addEventListener(t.RC,MJ);n(xH);var j=new CB(GB.JB.q("ExitNoButtonNormal"));var k=new CB(GB.JB.q("ExitNoButtonPressed"));II=new oC(j,j,k,k);II.x=173;II.y=232;II.addEventListener(t.RC,OJ);n(II);this.addEventListener(EB.qC,(m)=>p.add(pH));this.addEventListener(EB.sC,(m)=>p.remove(pH));} PJ( g){if(yH!=null){yH(g);yH=null;}} MJ( g){PJ(true);} OJ( g){PJ(false);} IJ( g){PJ(false);}show( g){yH=g;}}class WD{var pE;var LF;var MF;var angle;var OF;var WB;}class IB{var kH;var lH;var uH;var AI;var FI;var HI;var OI;var TI;var WI;var aI;var dI;IB( g, h){kH=g;lH=h;uH=u.xC;AI=-1000;FI=-1000;HI=false;OI=false;TI=false;WI=null;aI=null;dI=null;} get color=>kH; set color( g){kH=g;} get direction=>lH; set direction( g){lH=g;} get FB=>uH; set FB( g){uH=g;} get dB=>HI; set dB( g){HI=g;} get FC=>OI; set FC( g){OI=g;} get empty=>TI; set empty( g){TI=g;} PD( g){var h=g!=null&&(g.color==kH||g.FB==u.NB||uH==u.NB)&&g.FB!=u.wB&&uH!=u.wB;return h;} TC( g){var h=g!=null&&(g.color==kH||g.FB==u.NB||uH==u.NB)&&g.direction==0&&lH==0&&g.FB!=u.wB&&uH!=u.wB;return h;} cC( g){var h=g!=null&&(g.color==kH||g.FB==u.NB||uH==u.NB)&&g.direction==1&&lH==1&&g.FB!=u.wB&&uH!=u.wB;return h;} get x=>AI; set x( g){AI=g;if(WI!=null)WI.x=g;if(aI!=null)aI.x=g;if(dI!=null)dI.x=g;} get y=>FI; set y( g){FI=g;if(WI!=null)WI.y=g;if(aI!=null)aI.y=g;if(dI!=null)dI.y=g;} set KF( h){if(WI!=null){var g=1+0.3*QB.sin(h*QB.PI);WI.tB=g;WI.CC=g;}} jB( g, h, i){if(WI!=null){WI.parent.sB(WI);WI=null;}if(aI!=null){aI.parent.sB(aI);aI=null;}if(dI!=null){dI.parent.sB(dI);dI=null;}if(empty==false){switch (uH){case u.NB:WI=new IH(lH);WI.x=AI;WI.y=FI;g.n(WI);break;case u.wB:WI=GB.bD(u.wB);WI.x=AI;WI.y=FI;g.n(WI);break;default:WI=GB.ZD(kH,lH);WI.x=AI;WI.y=FI;g.n(WI);break;}if(HI){aI=OI?new JH(lH):GB.VF(kH,lH);aI.x=AI+((lH==0)?25:0);aI.y=FI+((lH==1)?25:0);h.n(aI);}switch (uH){case u.xC:break;case u.wB:break;case u.NB:break;default:dI=new KH(uH);dI.x=AI;dI.y=FI;i.n(dI);break;}}}}class PF extends AB{var oH;var wH;var GI;var QI;var pH;var UI;var XI;var ZI;var cI;var mH;var gI;var hI;var iI;var jI;var lI;var mI;var nI;var pI;var qI;PF(){var j=new CB(GB.JB.q("ShuffleButtonNormal"));var h=new CB(GB.JB.q("ShuffleButtonPressed"));wH=new oC(j,j,h,h);wH.addEventListener(t.RC,DJ);wH.x=530;wH.y=525;n(wH);var g=new CB(GB.JB.q("ExitButtonNormal"));var i=new CB(GB.JB.q("ExitButtonPressed"));GI=new oC(g,g,i,i);GI.addEventListener(t.RC,LJ);GI.x=700;GI.y=500;n(GI);oH=new TF();oH.x=540;oH.y=-1000;n(oH);pH=new iD(10,GB.JB.q("TimeGauge"),CD.lD);pH.x=659;pH.y=244;pH.addEventListener("TimeShort",NJ);pH.addEventListener("TimeOver",IJ);n(pH);p.add(pH);UI=new SF();UI.x=640;UI.y=230;n(UI);XI=new RF();XI.x=665;XI.y=160;n(XI);ZI=new IC();ZI.MC=new TE("Arial",30,0xD0D0D0,BC:true,align:pB.JC);ZI.width=140;ZI.height=36;ZI.wordWrap=false;ZI.x=646;ZI.y=130;ZI.SB=false;ZI.text="0";ZI.tB=0.9;n(ZI);cI=new IC();cI.MC=new TE("Arial",20,0xFFFFFF,BC:true,align:pB.JC);cI.width=44;cI.height=30;cI.wordWrap=false;cI.x=610;cI.y=559;cI.SB=false;cI.text="3x";n(cI);lI=new AB();n(lI);mI=new AB();n(mI);nI=new AB();n(nI);pI=eB.JB.iB("Intro");qI=pI.play();} start(){mH=1;gI=1;jI=0;hI=3;var g=new VD(YC.JB.lC("ESCStartText"));mI.n(g);p.fB(()=>UI.BF(21),1);g.show(()=>p.fB(()=>SJ(),0.5));} SJ(){if(QI!=null&&this.contains(QI))lI.sB(QI);var m=mH;var g=0;var h=0;switch (mH){case 01:h=50;QI=new QF(g=40,3,0,0,0,0,[0,1,2]);break;case 02:h=45;QI=new QF(g=45,3,1,0,0,0,[2,3,4]);break;case 03:h=40;QI=new QF(g=50,4,2,2,1,0,[5,6,7]);break;case 04:h=35;QI=new QF(g=55,4,3,3,2,0,[0,2,6]);break;case 05:h=30;QI=new QF(g=60,5,4,4,2,1,[1,3,5]);break;case 06:h=34;QI=new QF(g=60,5,5,5,3,2,[1,2,4,7]);break;case 07:h=33;QI=new QF(g=65,5,5,6,3,2,[0,1,2,3]);break;case 08:h=32;QI=new QF(g=70,5,5,6,3,2,[0,2,5,6]);break;case 09:h=31;QI=new QF(g=75,5,5,6,3,2,[1,4,5,7]);break;default:h=30;QI=new QF(g=80+(mH-10)*5,5,5,6,3,2,[0,1,2,3]);break;}iI=g;if(hI<3){hI++ ;cI.text="${hI}x";}QI.addEventListener(aB.IE,TJ);QI.addEventListener(aB.yC,UJ);QI.addEventListener(aB.JE,VJ);QI.addEventListener(aB.aD,WJ);QI.x=20;QI.y=16;QI.SB=false;lI.n(QI);pH.reset(h);pH.ND("TimeShort",9);pH.ND("TimeOver",0);pH.pause();oH.level=m;oH.qE=g;oH.y=-210;var k=new lB(oH,0.4,KB.qB);k.VB("y",-90);p.add(k);var j=new VD(YC.JB.lC("ESCLevelBoxText").replaceAll("{0}","${g}"));mI.n(j);j.show((){QI.SB=true;pH.start();if(pI!=null){var i=new LC(1.0,0.0,4.0,KB.KC);i.GC=(l){qI.DC.volume=l;qI.DC=qI.DC;};i.onComplete=(){qI.stop();UI.oG();};p.add(i);pI=null;}});} NJ( g){XI.start();} IJ( g){QI.NF(vB.YD);} UJ( j){var g=0;var k=j.info["Position"];var i=j.info["Type"];if(i=="SingleLocked")g=3000;if(i=="SingleUnlocked")g=1000;if(i=="All")g=10000;var h=new HE(g);h.x=k.x;h.y=k.y;lI.n(h);jI=jI+g;ZI.text="${jI}";} TJ( j){var g=iI;var i=j.info["Length"];var k=j.info["Factor"];g=(g>i)?g-i:0;iI=g;oH.qE=g;if(g==0)QI.NF(vB.XD);var h=0;switch (i){case 3:h=1000;break;case 4:h=2000;break;case 5:h=5000;break;default:h=5000;}jI=jI+h*k;ZI.text="${jI}";} VJ( m){pH.pause();XI.stop();var l=eB.JB.iB("Laugh");var k=eB.JB.iB("LevelUp");l.play();UI.BF(3);var g=GB.WF();g.x=55;g.y=260;lI.n(g);p.fB((){QI.wE();k.play();},2.0);p.fB((){var j=(pH.xG*1000).toInt();var h=new HE(j);h.x=704;h.y=360;lI.n(h);jI=jI+j;ZI.text="${jI}";},2.5);var i=new lB(oH,0.5,KB.qB);i.VB("y",-210);i.delay=3.0;p.add(i);p.fB((){lI.sB(g);},3.5);p.fB((){mH++ ;SJ();},4.0);} WJ( j){XI.stop();QI.wE();var g;var i;if(gI>0){gI-- ;g=new VD(YC.JB.lC("GEN2ndchancetime"));mI.n(g);i=eB.JB.iB("LevelUp");i.play();g.show((){p.fB(()=>SJ(),0.5);var h=new lB(oH,0.5,KB.qB);h.VB("y",-210);p.add(h);});}else{g=new VD(YC.JB.lC("GENtimeup"));mI.n(g);i=eB.JB.iB("GameOver");i.play();g.show((){p.fB(()=>ZJ(),0.5);var h=new lB(oH,0.5,KB.qB);h.VB("y",-210);p.add(h);});}} DJ( h){if(QI!=null&&hI>0){var g=QI.JF();if(g){hI=hI-1;cI.text="${hI}x";}}} LJ( j){var h=new AB();h.n(new CB(new DB(800,600,false,0x000000)));h.alpha=0.6;nI.n(h);var g=new UF();g.x=235;g.y=150;nI.n(g);g.show(( i){nI.sB(g);if(i==false)nI.sB(h);else bJ(false);});}ZJ(){var h=new AB();var j=new CB(GB.JB.q("ExitBox"));h.n(j);var g=new IC();g.MC=new TE("Arial",30,0xFFFFFF,BC:true,align:pB.JC);g.width=240;g.height=200;g.wordWrap=true;g.text=YC.JB.lC("GENgameover");g.x=47;g.y=30+(g.height-g.CE)/2;g.SB=false;h.n(g);h.x=110;h.y=-h.height;mI.n(h);var k=eB.JB.iB("Laugh");p.fB(()=>k.play(),0.3);var i=new lB(h,0.3,KB.qB);i.VB("y",150);p.add(i);p.fB(()=>bJ(true),5.0);h.addEventListener(t.RC,( l)=>bJ(true));}var dJ=false; bJ( g){pH.pause();if(dJ==false){dJ=true;}}}class GB{static var JB;static  ZD( h, i){var g=new CB(JB.NC("Elements").q("Chain${h}${i}"));g.OC=25;g.PC=25;return g;}static  VF( h, i){var g=new CB(JB.NC("Elements").q("Link${h}${i}"));g.OC=25;g.PC=25;return g;}static  bD( h){var g=new CB(JB.NC("Elements").q(h));g.OC=25;g.PC=25;return g;}static  WF(){var m=new AB();var l=0;var o=JB.NC("Levelup");for(int k=0;k<7;k++ ){var h=new CB(o.q("LevelUp${k}"));h.x=-h.width/2;h.y=-h.height/2;var g=new AB();g.n(h);g.x=l+h.width/2;g.tB=0;g.CC=0;m.n(g);var i=new lB(g,2.0,KB.TG);i.VB("scaleX",1.0);i.VB("scaleY",1.0);i.delay=k*0.05;var j=new lB(g,0.4,KB.KC);j.VB("scaleX",0.0);j.VB("scaleY",0.0);j.delay=3.0;p.add(i);p.add(j);l=l+5+h.width;}return m;}static  YF( i){var h=JB.NC("Elements");var g=new List<DB>();g.add(h.q("JokerChain${i}0"));g.add(h.q("JokerChain${i}1"));g.add(h.q("JokerChain${i}2"));g.add(h.q("JokerChain${i}3"));g.add(h.q("JokerChain${i}4"));return g;}static  ZF( i){var h=JB.NC("Elements");var g=new List<DB>();g.add(h.q("JokerLink${i}0"));g.add(h.q("JokerLink${i}1"));g.add(h.q("JokerLink${i}2"));g.add(h.q("JokerLink${i}3"));g.add(h.q("JokerLink${i}4"));return g;}static  aF( h){var i=JB.NC("Locks");var g=new List<DB>();g.add(i.q("Lock${h}0"));g.add(i.q("Lock${h}1"));g.add(i.q("Lock${h}2"));g.add(i.q("Lock${h}3"));g.add(i.q("Lock${h}4"));return g;}static  bF(){var h=JB.NC("Head");var g=new List<DB>();g.add(h.q("Head1"));g.add(h.q("Head2"));g.add(h.q("Head3"));g.add(h.q("Head2"));g.add(h.q("Head1"));return g;}static  cF(){var h=JB.NC("Alarm");var g=new List<DB>();g.add(h.q("Alarm0"));g.add(h.q("Alarm1"));g.add(h.q("Alarm2"));g.add(h.q("Alarm3"));g.add(h.q("Alarm4"));g.add(h.q("Alarm5"));return g;}}class SF extends AB{var qH;var zH;var MI;SF(){qH=GB.bF();zH=new CB(qH[0]);zH.x=-zH.width/2;zH.y=-zH.height/2;n(zH);MI=null;} BF( g){p.remove(MI);MI=new LC(0,g,0.5*g,KB.KC);MI.GC=(h){var i=((h*qH.length)%qH.length).toInt();zH.OB=qH[i];zH.y=QB.sin(h*2*QB.PI)*3-zH.height/2;};p.add(MI);} oG(){p.remove(MI);zH.OB=qH[0];}}class TF extends AB{var mH;var vH;var CI;var KI;var RI;TF(){n(new CB(GB.JB.q("InfoBox")));vH=new IC();vH.MC=new TE("Arial",35,0xFFFFFF,BC:true,align:pB.JC);vH.width=220;vH.height=40;vH.wordWrap=false;vH.text="Level 1";vH.x=20;vH.y=115;vH.WB=-2*QB.PI/180;n(vH);KI=new IC();KI.MC=new TE("Arial",25,0xFFFFFF,BC:true,align:pB.JC);KI.width=220;KI.height=30;KI.wordWrap=false;KI.text="40";KI.x=-KI.width/2;KI.y=-KI.height/2;KI.WB=-2*QB.PI/180;RI=new AB();RI.n(KI);RI.x=150;RI.y=172;n(RI);var g=GB.ZD(3,0);g.x=110;g.y=171;g.WB=-2*QB.PI/180;g.tB=g.CC=0.6;n(g);} set level( g){mH=g;vH.text="Level ${mH}";} set qE( g){CI=g;KI.text="${CI}";}}class wC extends AB{var kH;var tH;var DI;var NI;wC( g){kH=g;DI=GB.aF(g);NI=true;tH=new CB(DI[0]);tH.x=-34;tH.y=-50;n(tH);} get vC=>NI; set vC( g){NI=g;} IF( g){tH.OB=DI[g?0:4];} AH(){var i=new LC(0.0,1.0,2.0,KB.qB);i.GC=(j){tB=CC=1.0+0.2*QB.sin(j*4*QB.PI);};var g=new lB(this,0.2,KB.qB);g.VB("alpha",0.0);g.delay=2.0;g.onComplete=()=>IF(NI);var h=new lB(this,0.2,KB.mE);h.VB("alpha",1);h.delay=2.2;p.add(i);p.add(g);p.add(h);}}class VD extends AB{var sH;var yH;VD( i){var h=new CB(GB.JB.q("MessageBox"));n(h);var g=new IC();g.MC=new TE("Arial",24,0xFFFFFF,BC:true,align:pB.JC);g.width=240;g.height=200;g.wordWrap=true;g.text=i;g.x=47;g.y=130-g.CE/2;g.SB=false;n(g);sH=null;addEventListener(t.RC,wI);}void show( h){this.parent.n(this);this.x=-this.width;this.y=150;yH=h;var g=new lB(this,0.3,KB.qB);g.VB("x",110);g.onComplete=()=>sH=p.fB(KJ,10);p.add(g);} KJ(){if(sH!=null){p.remove(sH);sH=null;yH();var g=new lB(this,0.4,KB.mE);g.VB("x",800);g.onComplete=()=>this.parent.sB(this);p.add(g);}} wI( g){KJ();}}class eB{static var JB;}class u{static const  xC="None";static const  NB="Joker";static const  wB="Block";static const  KE="Double";static const  LE="Quint";}class IH extends AB implements kB{var tH;var JI;var EI;IH( h){this.SB=false;EI=0.0;JI=GB.YF(h);tH=new CB(JI[0]);tH.x=-25;tH.y=-25;n(tH);addEventListener(EB.qC,(g)=>p.add(this));addEventListener(EB.sC,(g)=>p.remove(this));} AC( g){EI+= g;var h=(EI*10).toInt()%JI.length;tH.OB=JI[h];return true;}}class JH extends AB implements kB{var tH;var JI;var EI;JH( h){this.SB=false;EI=0.0;JI=GB.ZF(h);tH=new CB(JI[0]);tH.x=-25;tH.y=-25;n(tH);addEventListener(EB.qC,(g)=>p.add(this));addEventListener(EB.sC,(g)=>p.remove(this));} AC( g){EI+= g;var h=(EI*10).toInt()%JI.length;tH.OB=JI[h];return true;}}class KH extends AB implements kB{var tH;var EI;KH( h){this.SB=false;EI=0.0;tH=GB.bD(h);n(tH);addEventListener(EB.qC,(g)=>p.add(this));addEventListener(EB.sC,(g)=>p.remove(this));} AC( g){EI+= g;this.WB=QB.sin(EI*7)*10*QB.PI/180;return true;}}class YC{static var JB;}class mC{var value=0; TD([ inc=1])=>(value+= inc); uE([ dec=1])=>(value-= dec);}class IE extends AB implements kB{var bI;var EI;IE( o, v){bI=new List<WD>();EI=0.0;this.SB=false;var s=GB.ZD(o,v);var m=new QB.Random();var i;var l;var BB;for(int h=0;h<=1;h++ ){for(int g=0;g<=1;g++ ){if(g==0&&h==0){i=QB.PI*1.15;WB=-QB.PI*2;}if(g==1&&h==0){i=QB.PI*1.85;WB=QB.PI*2;}if(g==1&&h==1){i=QB.PI*0.15;WB=QB.PI*2;}if(g==0&&h==1){i=QB.PI*0.85;WB=-QB.PI*2;}i=i+0.2*QB.PI*m.nextDouble();l=80.0+40.0*m.nextDouble();var j=new CB(s.OB);j.OD=new RB(g*25,h*25,25,25);j.OC=12.5+g*25;j.PC=12.5+h*25;j.x=g*25;j.y=h*25;n(j);var k=new WD();k.pE=j;k.LF=g*25+12.5;k.MF=h*25+12.5;k.angle=i;k.OF=l;k.WB=WB;bI.add(k);}}} AC( m){EI=QB.min(0.8,EI+m);var l=981.0;for(int i=0;i<bI.length;i++ ){var g=bI[i];var h=g.pE;var k=g.angle;var j=g.OF;var s=g.WB;var o=g.LF+EI*(QB.cos(k)*j);var v=g.MF+EI*(QB.sin(k)*j+EI*l*0.5);h.x=o;h.y=v;h.WB=EI*s;}if(EI>=0.6)this.alpha=(0.8-EI)/0.2;if(EI>=0.8)this.yD();return (EI<0.8);}}var zC;var ZC;var AD;var p;var QC;var BD;var xB; main(){zC=new hC("StageBackground",XC.query('#stageBackground'));ZC=new hC("StageForeground",XC.query('#stageForeground'));AD=new jF();AD.oE(zC);AD.oE(ZC);p=AD.lG;var h=DB.nE("images/Loading.png");h.then((g){QC=new CB(g);QC.OC=20;QC.PC=20;QC.x=400;QC.y=270;ZC.n(QC);BD=new lB(QC,100,KB.KC);BD.VB("rotation",100.0*2.0*QB.PI);p.add(BD);xB=new IC();xB.MC=new TE("Arial",20,0xA0A0A0,BC:true);xB.width=240;xB.height=40;xB.text="... loading ...";xB.x=400-xB.CH/2;xB.y=320;xB.SB=false;ZC.n(xB);XF();});} XF(){var g=new iC();g.hB("Background","images/Background.jpg");g.hB("ExitBox","images/ExitBox.png");g.hB("ExitButtonNormal","images/ExitButtonNormal.png");g.hB("ExitButtonPressed","images/ExitButtonPressed.png");g.hB("ExitGauge","images/ExitGauge.png");g.hB("ExitNoButtonNormal","images/ExitNoButtonNormal.png");g.hB("ExitNoButtonPressed","images/ExitNoButtonPressed.png");g.hB("ExitYesButtonNormal","images/ExitYesButtonNormal.png");g.hB("ExitYesButtonPressed","images/ExitYesButtonPressed.png");g.hB("InfoBox","images/InfoBox.png");g.hB("MessageBox","images/MessageBox.png");g.hB("ShuffleButtonNormal","images/ShuffleButtonNormal.png");g.hB("ShuffleButtonPressed","images/ShuffleButtonPressed.png");g.hB("TimeGauge","images/TimeGauge.png");g.uC("Alarm","images/AlarmTextureAtlas.json",bC.kC);g.uC("Head","images/HeadTextureAtlas.json",bC.kC);g.uC("Elements","images/ElementsTextureAtlas.json",bC.kC);g.uC("Levelup","images/LevelupTextureAtlas.json",bC.kC);g.uC("Locks","images/LocksTextureAtlas.json",bC.kC);g.ZB("BonusAllUnlock","sounds/BonusAllUnlock.mp3");g.ZB("BonusUniversal","sounds/BonusUniversal.mp3");g.ZB("ChainBlast","sounds/ChainBlast.mp3");g.ZB("ChainBlastSpecial","sounds/ChainBlastSpecial.mp3");g.ZB("ChainError","sounds/ChainError.mp3");g.ZB("ChainFall","sounds/ChainFall.mp3");g.ZB("ChainHelp","sounds/ChainHelp.mp3");g.ZB("ChainLink","sounds/ChainLink.mp3");g.ZB("ChainRotate","sounds/ChainRotate.mp3");g.ZB("Click","sounds/Click.mp3");g.ZB("GameOver","sounds/GameOver.mp3");g.ZB("Laugh","sounds/Laugh.mp3");g.ZB("LevelUp","sounds/LevelUp.mp3");g.ZB("PointsCounter","sounds/PointsCounter.mp3");g.ZB("Unlock","sounds/Unlock.mp3");g.ZB("Warning","sounds/Warning.mp3");g.ZB("Intro","sounds/Intro.mp3");g.addText("ESCAPE_INS_AIM_0","Connect at least 3 chain links of the same colour to a horizontal or vertical chain.");g.addText("ESCAPE_INS_DES_0","You can change the direction of a chain link by touching it.");g.addText("ESCAPE_INS_TIP_0","Earn extra points for connecting chain links displaying a key symbol.");g.addText("ESCBlockErrorHint","Sorry but block chains can´t be twisted!");g.addText("ESCLevelBoxText","Connect {0} chain links and help the crook to escape!");g.addText("ESCNoActionHint","Press on the chain links to twist them.");g.addText("ESCNoComboHint","You have to connect at least 3 chain links of the same colour.");g.addText("ESCStartText","Form horizontal or vertical same-colour chains and become an escape agent!");g.addText("ESCtogo","Chain links:");g.addText("GENexitquery","Do you really want to quit the game?");g.addText("GEN2ndchancetime","Time is up. Second chance!");g.addText("GENtimeup","Sorry! Your time is up.");g.addText("GENgameover","Game Over");g.load().then((j){ZC.sB(QC);ZC.sB(xB);p.remove(BD);GB.JB=g;eB.JB=g;YC.JB=g;var i=new CB(GB.JB.q("Background"));zC.n(i);zC.wG=eC.pD;var h=new PF();ZC.n(h);h.start();});}class hD implements kB{var BK;var OK;var ZK;hD(){ZK=0.0;BK=new List<kB>();OK=0;} add( g){if(g==null)return;if(OK>=BK.length)BK.add(g);else BK[OK]=g;OK++ ;} remove( h){if(h==null)return;for(int g=0;g<OK;g++ )if(BK[g]==h)BK[g]=null;} fB( h, i){var g=new cD(h,i);add(g);return g;} AC( j){ZK+= j;var k=OK;var h=0;for(int g=0;g<k;g++ ){var i=BK[g];if(i!=null&&i.AC(j)){if(h!=g)BK[h]=i;h++ ;}}for(int g=k;g<OK;g++ )BK[h++ ]=BK[g];for(int g=h;g<OK;g++ )BK[g]=null;OK=h;return true;}}class oB{static const  jD="auto";static const  nD="arrow";static const  oD="button";static const  EG="hand";static const  FG="ibeam";static const  HG="wait";}class cD implements kB{var sJ=0.0;var LK=0.0;var YK=1;var kK;cD( g, h){kK=g;LK=QB.max(h,0.0001);} AC( h){var g=sJ+h;while (g>=LK&&YK>0){sJ=LK;YK-- ;kK();g-= LK;}if(YK==0)return false;sJ=g;return true;} get totalTime=>LK; get currentTime=>sJ;}abstract class kB{ AC( g);}class QE{var lJ;var AK;var QK;var XK;var fK;var lK;var tK;var yK;var AL;var HL;var PL;QE( h, g){lJ=h;AK=g;} get DH=>AK; get name=>lJ; get bG=>QK; get cG=>XK; get aG=>fK; get ZG=>lK; get offsetX=>tK; get offsetY=>yK; get rG=>AL; get qG=>HL; get zG=>PL;}class iC{var qJ;var KK;var gK;var sK;var zK;var FL;var ML;iC(){qJ=new Map<String,DB>();KK=new Map<String,HB>();gK=new Map<String,XB>();sK=new Map<String,String>();zK=null;FL=0;ML=0;} hB( i, j){var g=DB.nE(j);FL++ ;g.then(( h){qJ[i]=h;FL-- ;eM();});g.handleException((k){ML++ ;FL-- ;eM();});} ZB( h, i){var g=HB.oF(i);FL++ ;g.then(( j){KK[h]=j;FL-- ;eM();});g.handleException((k){ML++ ;FL-- ;eM();});} uC( h, j, k){var g=XB.IG(j,k);FL++ ;g.then(( i){gK[h]=i;FL-- ;eM();});g.handleException((l){ML++ ;FL-- ;eM();});} addText( h, g){sK[h]=g;} load(){zK=new Completer<iC>();eM();return zK.future;} q( g){if(qJ.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return qJ[g];} iB( g){if(KK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return KK[g];} NC( g){if(gK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return gK[g];} lC( g){if(sK.containsKey(g)==false)return "[[${g}]]";return sK[g];}eM(){if(zK!=null&&FL==0){if(ML==0)zK.complete(this);else zK.completeException(this);}}}class gD{static var UE=oB.jD;static var sF=false;static var qD;static  get QG{if(qD==null)qD=new YB();return qD;}static  lE( i){var h=i;var g="auto";if(UE!=oB.jD)h=UE;switch (h){case oB.jD:g="auto";break;case oB.nD:g="default";break;case oB.oD:g="pointer";break;case oB.EG:g="move";break;case oB.FG:g="text";break;case oB.HG:g="wait";break;}if(sF)g="none";return g;}}class XB{var oJ;var RK;XB(){oJ=new XC.ImageElement();RK=new List<QE>();}static  IG( o, PB){var m=new Completer<XB>();var i=new XB();switch (PB){case bC.pF:case bC.kC:var j=new XC.HttpRequest();j.open('GET',o,true);j.on.load.add((nB){ s( l, g){var LB=RG(l);var h=new QE(LB,i);h.QK=g["frame"]["x"].toInt();h.XK=g["frame"]["y"].toInt();h.fK=g["frame"]["w"].toInt();h.lK=g["frame"]["h"].toInt();h.tK=g["spriteSourceSize"]["x"].toInt();h.yK=g["spriteSourceSize"]["y"].toInt();h.AL=g["sourceSize"]["w"].toInt();h.HL=g["sourceSize"]["h"].toInt();h.PL=g["rotated"] as bool;i.RK.add(h);}var v=HH.JSON.parse(j.responseText);var k=v["frames"];var BB=v["meta"];if(k is List)for(var g in k)s(g["filename"],g);if(k is Map)for(String l in k.VH())s(l,k[l]);i.oJ.on.load.add((gB)=>m.complete(i));i.oJ.on.error.add((gB)=>m.completeException("Failed to load image."));i.oJ.src=SG(o,BB["image"]);});j.on.error.add((nB)=>m.completeException("Failed to load json file."));j.send();break;}return m.future;} get fG=>oJ; q( i){var g;for(int h=0;h<RK.length&&g==null;h++ )if(RK[h].name==i)g=new DB.hH(RK[h]);if(g==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return g;}static  RG( g){var h=const RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,ignoreCase:true);var i=h.firstMatch(g);return i.group(1);}static  SG( i, h){var k=const RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,ignoreCase:true);var j=k.firstMatch(i);var g=j.group(1);return (g==null)?h:"${g}${h}";}}class eD{var VG;var XG;var height;var xD;var width;var x;eD(this.x,this.width,this.height,this.VG,this.XG,this.xD);}class bB{var x;var y;bB(this.x,this.y);bB.gH():this(0,0); get length=>QB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new bB(this.x+g.x,this.y+g.y);}class RB{var x;var y;var width;var height;RB(this.x,this.y,this.width,this.height);RB.gH():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new bB(this.width,this.height); set bottom( g){this.height=g-this.y;} set left( g){this.x=g;} set right( g){this.width=g-this.x;} set top( g){this.y=g;} contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); get isEmpty=>(this.width==0&&this.height==0);}class gF{gF();}class TB{var gJ,hJ,jJ,kJ,mJ,pJ;var uJ;TB.eH():gJ=1.0,hJ=0.0,jJ=0.0,kJ=1.0,mJ=0.0,pJ=0.0,uJ=1.0; get a=>gJ; get b=>hJ; get c=>jJ; get d=>kJ; get UC=>mJ; get VC=>pJ; get dC=>uJ; EH( g){return new bB(g.x*gJ+g.y*jJ+mJ,g.x*hJ+g.y*kJ+pJ);} concat( g){var m=gJ;var v=hJ;var BB=jJ;var s=kJ;var l=mJ;var o=pJ;var PB=uJ;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var gB=g.UC;var LB=g.VC;var nB=g.dC;gJ=(m*j+v*i);hJ=(m*k+v*h);jJ=(BB*j+s*i);kJ=(BB*k+s*h);mJ=(l*j+o*i+gB);pJ=(l*k+o*h+LB);uJ=(PB*nB);} eG(){gJ=1.0;hJ=0.0;jJ=0.0;kJ=1.0;mJ=0.0;pJ=0.0;uJ=1.0;} kG(){var j=gJ;var m=hJ;var l=jJ;var k=kJ;var h=mJ;var i=pJ;var g=uJ;gJ=(k/g);hJ=-(m/g);jJ=-(l/g);kJ=(j/g);mJ=-(gJ*h+jJ*i);pJ=-(hJ*h+kJ*i);uJ=(1.0/g);} HF( g, j, i, h, k, l){gJ=g;hJ=j;jJ=i;kJ=h;mJ=k;pJ=l;uJ=(g*h-j*i);} wD( g, h){var o=g.a;var BB=g.b;var LB=g.c;var v=g.d;var m=g.UC;var s=g.VC;var gB=g.dC;var k=h.a;var l=h.b;var j=h.c;var i=h.d;var nB=h.UC;var PB=h.VC;var WC=h.dC;gJ=(o*k+BB*j);hJ=(o*l+BB*i);jJ=(LB*k+v*j);kJ=(LB*l+v*i);mJ=(m*k+s*j+nB);pJ=(m*l+s*i+PB);uJ=(gB*WC);}}class jF{var iJ;var wJ;var GK;var eK;var qK;jF(){iJ=new hD();wJ=new List<hC>();GK=double.NAN;eK=ED.kD;qK=new lF(0);XC.window.requestAnimationFrame(xL);} get lG=>iJ; xL( g){XC.window.requestAnimationFrame(xL);if(GK.isNaN)GK=g;if(GK>g)GK=g;var i=g-GK;var j=i/1000.0;if(i>=1){GK=g;qK.rJ=j;eK.MB(qK);iJ.AC(j);for(int h=0;h<wJ.length;h++ ){var k=wJ[h];k.nG();}}} oE( g){wJ.add(g);}}class zB{var tJ;var PK;var bK;var jK;zB.fH( h){tJ=h;PK=new List<TB>();bK=new List<double>();jK=0;for(int g=0;g<100;g++ ){PK.add(new TB.eH());bK.add(1.0);}} get context=>tJ; reset(){tJ.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);tJ.globalAlpha=1;tJ.clearRect(0,0,tJ.canvas.width,tJ.canvas.height);jK=0;} GF( h){jK++ ;var g=PK[jK];g.wD(h.gM,PK[jK-1]);tJ.setTransform(g.a,g.b,g.c,g.d,g.UC,g.VC);tJ.globalAlpha=bK[jK]=bK[jK-1]*h.cL;if(h.mask==null){h.mB(this);}else{tJ.save();h.mask.mB(this);h.mB(this);tJ.restore();}jK-- ;}}class eC{static const  jD="auto";static const  vF="stop";static const  pD="once";}class EB{static const  qF="added";static const  qC="addedToStage";static const  rD="enterFrame";static const  GG="removed";static const  sC="removedFromStage";var fJ;var aM;var cM;var fM;var hM;var iM;var kM;EB( g,[ bubbles=false]){OM(g,bubbles);} OM( g,[ bubbles=false]){fJ=g;aM=bubbles;cM=aC.GD;fM=null;hM=null;iM=false;kM=false;} get AE=>iM; get BH=>kM; get type=>fJ; get eventPhase=>cM; get bubbles=>aM; get vD=>true; get target=>fM;}class RE{var QG;RE( g){QG=g;} operator[]( g){return QG.NL(g);}}class aC{static const  VE=1;static const  GD=2;static const  AG=3;}class YB{var zJ; dG( g){return zJ!=null&&zJ.containsKey(g);} addEventListener( h, g,[ useCapture=false]){NL(h).add(g,useCapture);} MB( g){VM(g,this,this,aC.GD);}RE get on=>new RE(this); VM( g, i, k, j){if(zJ!=null){var h=zJ[g.type];if(h!=null){g.fM=i;g.hM=k;g.cM=j;g.iM=false;g.kM=false;h.MB(g);}}} NL( g){if(zJ==null)zJ=new Map<String,cB>();var h=zJ[g];if(h==null)h=zJ[g]=new cB(this,g);return h;}}class kF{var QD;var UD;kF(this.QD,this.UD);}class eF extends OE{eF( g):super(g);}class ED{static final kD=new ED();var LL;ED(){LL=new List<cB>();} add( g){LL.add(g);} remove( h){var g=LL.indexOf(h);if(g!=-1)LL[g]=null;} MB( j){var k=LL.length;var i=0;for(int g=0;g<k;g++ ){var h=LL[g];if(h!=null){j.fM=h.xE;j.hM=h.xE;j.cM=aC.GD;h.MB(j);if(i!=g)LL[i]=h;i++ ;}}for(int g=k;g<LL.length;g++ )LL[i++ ]=LL[g];LL.length=i;}}class lF extends EB{var rJ;lF( g):super(EB.rD,false){rJ=g;} get vD=>false;}class t extends EB{static const  RC="click";static const  yF="doubleClick";static const  HD="mouseDown";static const  tD="mouseUp";static const  dE="mouseMove";static const  JD="mouseOut";static const  gE="mouseOver";static const  hE="mouseWheel";static const  iE="middleClick";static const  LG="middleMouseDown";static const  MG="middleMouseUp";static const  jE="rightClick";static const  NG="rightMouseDown";static const  OG="rightMouseUp";var mM,nM;var oM,pM;var qM;var iL;var yL;var lL;var nL;var fL;var sM;var tM;var uM;var vM;t( g,[ bubbles=false]):super(g,bubbles){OM(g,bubbles);} OM( g,[ bubbles=false]){super.OM(g,bubbles);mM=nM=0;oM=pM=0;qM=false;iL=false;yL=false;lL=false;nL=false;fL=0;sM=0;tM=0;uM=false;vM=null;} get zE=>mM; get AF=>nM; get WG=>qM; get altKey=>iL; get ctrlKey=>lL; get shiftKey=>nL; get deltaX=>sM; get deltaY=>tM;}class fC extends EB{static const  mD="keyDown";static const  WE="keyUp";var iL;var lL;var nL;var oL;var yL;var CM;var EM;var FM;fC( g,[ bubbles=false]):super(g,bubbles){OM(g,bubbles);} OM( g,[ bubbles=false]){super.OM(g,bubbles);iL=false;lL=false;nL=false;oL=false;yL=false;CM=0;EM=0;FM=0;} get altKey=>iL; get ctrlKey=>lL; get shiftKey=>nL; get charCode=>CM; get keyCode=>EM; get keyLocation=>FM;}class PE extends EB{static const  xF="textInput";var vJ="";PE( g,[ bubbles=false]):super(g,bubbles){}}abstract class w extends YB implements ME{var TK=0.0;var aK=0.0;var hK=0.0;var pK=0.0;var wK=1.0;var BL=1.0;var IL=0.0;var QL;var UL;var cL=1.0;var hL=true;var lJ="";var rL=null;var mask;var NM;var PM;w(){QL=new TB.eH();UL=true;NM=new TB.eH();PM=new TB.eH();} get x=>TK; get y=>aK; get OC=>hK; get PC=>pK; get tB=>wK; get CC=>BL; get WB=>IL; get alpha=>cL; get visible=>hL; get name=>lJ; get parent=>rL;NE get on=>new NE(this); get root{var g=this;while (g.rL!=null)g=g.rL;return g;} get zD{var g=this.root;if(g is hC)return g;return null;} set x( g){TK=g;UL=true;} set y( g){aK=g;UL=true;} set OC( g){hK=g;UL=true;} set PC( g){pK=g;UL=true;} set tB( g){wK=g;UL=true;} set CC( g){BL=g;UL=true;} set WB( g){IL=g;UL=true;} set alpha( g){cL=g;UL=true;} get width=>rB(gM).width; get height=>rB(gM).height; set width( h){this.tB=1;var g=this.width;this.tB=(g!=0.0)?h/g:1.0;} set height( h){this.CC=1;var g=this.height;this.CC=(g!=0.0)?h/g:1.0;} yD(){if(rL!=null)rL.sB(this);} get gM{if(UL){UL=false;if(IL==0.0){QL.HF(wK,0.0,0.0,BL,TK-hK*wK,aK-pK*BL);}else{var g=QB.cos(IL);var h=QB.sin(IL);var i=wK*g;var l=wK*h;var k=-BL*h;var j=BL*g;var m=TK-hK*i-pK*k;var o=aK-hK*l-pK*j;QL.HF(i,l,k,j,m,o);}}return QL;} rB( g,[ returnRectangle=null]){if(returnRectangle==null)returnRectangle=new RB.gH();returnRectangle.x=g.UC;returnRectangle.y=g.VC;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} EC( g, h){if(rB(PM).contains(g,h))return this;return null;} RD( h){NM.eG();for(w g=this;g!=null;g=g.rL)NM.concat(g.gM);NM.kG();return NM.EH(h);} MB( h){var g=null;if(h.vD||h.bubbles)for(w j=rL;j!=null;j=j.rL)if(j.dG(h.type)){if(g==null)g=new List<w>();g.add(j);}if(h.vD&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.AE==false)g[i].VM(h,this,g[i],aC.VE);if(h.AE==false)VM(h,this,this,aC.GD);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.AE==false)g[i].VM(h,this,g[i],aC.AG);} yM( h){for(var g=h;g!=null;g=g.rL)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");rL=h;} mB( g);}abstract class yB extends w{var YG=false;var SB=true;var dH=true;var tabIndex=0;OE get on=>new OE(this);}abstract class jC extends yB{var VK;var cK=true;var mK=true;jC(){VK=new List<w>();}eF get on=>new eF(this); n( g){if(g.parent==this){var h=VK.indexOf(g);VK.removeAt(h);VK.add(g);}else{UG(g,VK.length);}} UG( g, h){if(h<0&&h>VK.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){VK.removeAt(VK.indexOf(g));if(h>VK.length)h-- ;VK.insertRange(h,1,g);}else{g.yD();g.yM(this);VK.insertRange(h,1,g);g.MB(new EB(EB.qF,true));if(this.zD!=null)AN(g,new EB(EB.qC));}} sB( h){var g=VK.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");vG(g);} vG( g){if(g<0&&g>=VK.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=VK[g];h.MB(new EB(EB.GG,true));if(this.zD!=null)AN(h,new EB(EB.sC));h.yM(null);VK.removeAt(g);} contains( g){for(;g!=null;g=g.rL)if(g==this)return true;return false;} rB( m,[ returnRectangle=null]){if(returnRectangle==null)returnRectangle=new RB.gH();if(VK.length==0)return super.rB(m,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var l=double.NEGATIVE_INFINITY;var k=double.NEGATIVE_INFINITY;var o=VK.length;for(int j=0;j<o;j++ ){NM.wD(VK[j].gM,m);var g=VK[j].rB(NM,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>l)l=g.right;if(g.bottom>k)k=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=l-h;returnRectangle.height=k-i;return returnRectangle;} EC( BB, o){var l=null;for(int j=VK.length-1;j>=0;j-- ){var i=VK[j];if(i.visible){var g=i.gM;var m=BB-g.UC;var k=o-g.VC;var s=(g.d*m-g.c*k)/g.dC;var v=(g.a*k-g.b*m)/g.dC;var h=i.EC(s,v);if(h!=null){if(h is yB)if(h.SB)return cK?h:this;l=this;}}}return l;} mB( i){for(int g=0;g<VK.length;g++ ){var h=VK[g];if(h.visible)i.GF(h);}} AN( h, i){h.MB(i);if(h is jC){var j=new List<w>.from(h.VK);var k=j.length;for(int g=0;g<k;g++ )AN(j[g],i);}}}class hC extends jC{var FK;var tJ;var nK;var vK;var CL;var JL;var SL;var VL;var aL;var fL;var kL;var qL;var vL;var AM;var HM;var JM;var LM;hC( h, g){lJ=h;FK=g;FK.style.outline="none";FK.focus();tJ=g.context2d;vK=new zB.fH(tJ);CL=eC.jD;JL=oB.nD;SL=[false,false,false];VL=[null,null,null];aL=[0,0,0];fL=[0,0,0];kL=[t.HD,t.LG,t.NG];qL=[t.tD,t.MG,t.OG];vL=[t.RC,t.iE,t.jE];AM=[t.yF,t.iE,t.jE];HM=null;FK.on.mouseDown.add(sL);FK.on.mouseUp.add(sL);FK.on.mouseMove.add(sL);FK.on.mouseOut.add(sL);FK.on.mouseWheel.add(wM);FK.on.keyDown.add(xM);FK.on.keyUp.add(xM);FK.on.keyPress.add(zM);JM=new t(t.RC,true);LM=new fC(fC.mD,true);gD.QG.addEventListener("mouseCursorChanged",BN);} get focus=>nK; set wG( g){CL=g;} CN(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){CN();} set y( g){CN();} set OC( g){CN();} set PC( g){CN();} set tB( g){CN();} set CC( g){CN();} set WB( g){CN();} set alpha( g){CN();} set width( g){CN();} set height( g){CN();} nG(){if(CL==eC.jD||CL==eC.pD){vK.reset();mB(vK);if(CL==eC.pD)CL=eC.vF;}} BN( g){FK.style.cursor=gD.lE(JL);} sL( k){k.preventDefault();var v=new Date.now().millisecondsSinceEpoch;var g=k.button;var h=null;if(g<0||g>2)return;var i=new bB(k.offsetX,k.offsetY);var j=null;if(k.type!="mouseout")h=EC(i.x,i.y) as yB;var m=oB.nD;if(h is AB)if(h.EE)m=oB.oD;if(h is oC)if(h.EE)m=oB.oD;if(JL!=m){JL=m;FK.style.cursor=gD.lE(m);}if(HM!=null&&HM!=h){if(HM.zD!=null)j=HM.RD(i);else j=new bB.gH();JM.OM(t.JD,true);JM.mM=j.x;JM.nM=j.y;JM.oM=i.x;JM.pM=i.y;JM.qM=SL[g];HM.MB(JM);HM=null;}if(h!=null&&h!=HM){j=h.RD(i);JM.OM(t.gE,true);JM.mM=j.x;JM.nM=j.y;JM.oM=i.x;JM.pM=i.y;JM.qM=SL[g];HM=h;HM.MB(JM);}var l=null;var s=fL[g];var BB=false;var o=false;if(k.type=="mousedown"){l=kL[g];SL[g]=true;if(h!=VL[g]||v>aL[g]+500)s=0;VL[g]=h;aL[g]=v;fL[g]= ++s;}if(k.type=="mouseup"){l=qL[g];SL[g]=false;BB=(VL[g]==h);o=BB&&fL[g].isEven&&(v<aL[g]+500);}if(k.type=="mousemove"){l=t.dE;s=0;}if(l!=null&&h!=null){j=h.RD(i);JM.OM(l,true);JM.mM=j.x;JM.nM=j.y;JM.oM=i.x;JM.pM=i.y;JM.qM=SL[g];JM.fL=s;h.MB(JM);if(BB){o=o&&h.YG;l=o?AM[g]:vL[g];JM.OM(l,true);JM.mM=j.x;JM.nM=j.y;JM.oM=i.x;JM.pM=i.y;JM.qM=SL[g];h.MB(JM);}}} wM( g){var h=EC(g.offsetX,g.offsetY);if(h!=null){var i=new bB(g.offsetX,g.offsetY);var j=h.RD(i);JM.OM(t.hE,true);JM.mM=j.x;JM.nM=j.y;JM.oM=i.x;JM.pM=i.y;JM.sM=g.deltaX;JM.tM=g.deltaY;h.MB(JM);}} xM( g){g.preventDefault();var h=null;if(g.type=="keyup")h=fC.WE;if(g.type=="keydown")h=fC.mD;LM.OM(h,true);LM.iL=g.altKey;LM.lL=g.ctrlKey;LM.nL=g.shiftKey;LM.CM=g.charCode;LM.EM=g.keyCode;LM.FM=gC.mF;if(g.keyLocation==XC.KeyLocation.LEFT)LM.FM=gC.rF;if(g.keyLocation==XC.KeyLocation.RIGHT)LM.FM=gC.zF;if(g.keyLocation==XC.KeyLocation.NUMPAD)LM.FM=gC.DG;if(g.keyLocation==XC.KeyLocation.JOYSTICK)LM.FM=gC.aE;if(g.keyLocation==XC.KeyLocation.MOBILE)LM.FM=gC.aE;if(nK!=null)nK.MB(LM);} zM( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new PE(PE.xF,true);h.vJ=new String.fromCharCodes([i]);if(nK!=null)nK.MB(h);}}class AB extends jC{var QH=false;var EE=false;}class CB extends w{var OB;var tG;var OD;CB([this.OB=null,this.tG="auto"]){OD=null;} rB( h,[ returnRectangle=null]){var g=(OB!=null)?OB.width:0;var i=(OB!=null)?OB.height:0;return uD(h,g,i,returnRectangle);} EC( g, h){if(OB!=null&&g>=0.0&&h>=0.0&&g<OB.width&&h<OB.height)return this;return null;} mB( g){if(OB!=null){if(OD==null)OB.mB(g);else OB.FF(g,OD);}}}class pB{static const  JC="center";static const  wF="end";static const  BG="justify";static const  zF="right";}abstract class ME{ mB( g);}class oC extends yB{var DE;var DF;var vE;var SD;var EE=true;var enabled=true;var OL;oC([this.DE=null,this.DF=null,this.vE=null,this.SD=null]){addEventListener(t.gE,sL);addEventListener(t.JD,sL);addEventListener(t.HD,sL);addEventListener(t.tD,sL);OL=this.DE;} rB( g,[ returnRectangle=null]){if(OL!=null){NM.wD(OL.gM,g);return OL.rB(NM,returnRectangle);}return super.rB(g,returnRectangle);} EC( m, j){if(this.SD!=null){var g=this.SD.gM;var h=m-g.UC;var i=j-g.VC;var k=(g.d*h-g.c*i)/g.dC;var l=(g.a*i-g.b*h)/g.dC;if(this.SD.EC(k,l)!=null)return this;}return null;} mB( g){if(OL!=null)g.GF(OL);} sL( g){var h=(this.EC(g.zE,g.AF)==this)&&(g.type!=t.JD);var i=g.WG;OL=DE;if(h&&i)OL=vE;if(h&&!i)OL=DF;}}class dF{var fJ;var nJ;var DK;var SK;dF.jH( i, g, h, j){fJ=0;nJ=new RB(i,g,h,j);} mB( i){var g=i.context;g.beginPath();switch (fJ){case 0:g.rect(nJ.x,nJ.y,nJ.width,nJ.height);break;case 1:g.arc(DK.x,DK.y,DK.ZH,0,QB.PI*2.0,false);break;case 2:g.moveTo(SK[0].x,SK[0].y);for(int h=1;h<SK.length;h++ )g.lineTo(SK[h].x,SK[h].y);break;}g.clip();}}class NE extends RE{NE( g):super(g);}class gC{static const  mF=0;static const  rF=1;static const  zF=2;static const  DG=3;static const  aE=4;}class OE extends NE{OE( g):super(g); get mouseOut=>this[t.JD]; get mouseMove=>this[t.dE]; get mouseDown=>this[t.HD]; get mouseUp=>this[t.tD]; get mouseWheel=>this[t.hE]; get keyUp=>this[fC.WE]; get keyDown=>this[fC.mD];}class CD extends w{static const  lD='DIRECTION_UP';static const  YE='DIRECTION_RIGHT';static const  sD='DIRECTION_DOWN';static const  ID='DIRECTION_LEFT';var XL;var ZL;var eL;var jL;CD( g,[ direction=ID]){if(direction!=lD&&direction!=sD&&direction!=ID&&direction!=YE){throw new ArgumentError('Invalid Gauge direction!');}XL=direction;ZL=1.0;eL=g;jL=new RB.gH();TM();} get ratio=>ZL;set ratio( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;ZL=g;TM();} get OB=>eL;set OB( g){eL=g;TM();}TM(){if(eL==null){jL.left=0;jL.top=0;jL.right=0;jL.bottom=0;}else{var g=eL.width;var h=eL.height;switch (XL){case ID:jL.left=((1.0-ZL)*g).toInt();jL.top=0;jL.right=g;jL.bottom=h;break;case lD:jL.left=0;jL.top=((1.0-ZL)*h).toInt();jL.right=g;jL.bottom=h;break;case YE:jL.left=0;jL.top=0;jL.right=(ZL*g).toInt();jL.bottom=h;break;case sD:jL.left=0;jL.top=0;jL.right=g;jL.bottom=(ZL*h).toInt();break;}}} rB( h,[ returnRectangle=null]){var g=(eL!=null)?eL.width:0;var i=(eL!=null)?eL.height:0;return uD(h,g,i,returnRectangle);} EC( g, h){if(eL!=null&&g>=0.0&&h>=0.0&&g<eL.width&&h<eL.height)return this;return null;} mB( g){if(eL!=null)eL.FF(g,jL);}}class bC{static const  pF="json";static const  kC="jsonarray";}abstract class HB{static  oF( g){var h=FD.PG;if(h=="WebAudioApi")return dD.oF(g);if(h=="AudioElement")return fD.oF(g);return SE.oF(g);} get length; play([ loop=false, soundTransform=null]);static var SC;static  kE( g){if(SC==null){SC=new List<String>();var h=new XC.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)SC.add("ogg");if(i.indexOf(h.canPlayType("audio/mp3",""))!=-1)SC.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)SC.add("wav");}var l=const RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,ignoreCase:true);var j=l.firstMatch(g);if(j==null)throw new ArgumentError("Unsupported file extension.");var k=j.group(1).toLowerCase();if(SC.indexOf(k)==-1&&SC.length>0)g="${g.substring(0,g.length-3)}${SC[0]}";return g;}}abstract class HC extends YB{ get DC; set DC( g); stop();}class UB{var volume;var sG;var XH=1;var YH=0;var cH=1;var bH=0;UB([this.volume=1,this.sG=0]);}class FD{static var LD;static  get MD{if(LD==null){try {LD=new XC.AudioContext();}catch (g){LD=null;}}return LD;}static var tC;static  get PG{if(tC==null){tC=(MD!=null)?"WebAudioApi":"AudioElement";var g=XC.window.navigator.userAgent;if(g.contains("IEMobile")&&g.contains("9.0"))tC="Mock";if((g.contains("iPhone")||g.contains("iPad"))&&(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5")))tC="Mock";}return tC;}}class fD extends HB{var EK;var WK;var oK;fD(){oK=new List<DD>();EK=new XC.AudioElement();EK.on.ended.add(dL);WK=new List<XC.AudioElement>();WK.add(EK);XC.document.body.elements.add(EK);}static  oF( l){var h=new fD();var g=new Completer<HB>(); j(i){if(g.future.isComplete==false)g.complete(h);} k(i){if(g.future.isComplete==false)g.completeException("Failed to load audio.");}h.EK.src=HB.kE(l);h.EK.on.canPlayThrough.add(j);h.EK.on.error.add(k);h.EK.load();return g.future;} get length{return EK.duration;} play([ loop=false, soundTransform=null]){if(soundTransform==null)soundTransform=new UB();return new DD(this,loop,soundTransform);} tL( h){var g;if(WK.length==0){g=EK.clone(true);g.on.ended.add(dL);}else{g=WK[0];WK.removeAt(0);}oK.add(h);return g;} rM( g){var h=g.EK;var i=oK.indexOf(g);oK.removeAt(i);WK.add(h);if(EK.currentTime>0&&EK.ended==false)EK.currentTime=0;} dL(j){var i=j.target;var g=null;for(int h=0;h<oK.length&&g==null;h++ )if(oK[h].EK==i)g=oK[h];if(g!=null)g.stop();}}class DD extends HC{var MK;var EK;var xJ;var NK;DD( h, i, g){MK=h;xJ=i;NK=g;EK=h.tL(this);EK.loop=xJ;this.DC=g;EK.play();} get DC=>NK; set DC( g){NK=g;if(EK!=null)EK.volume=(NK!=null)?NK.volume:1;} stop(){if(EK!=null){if(EK.ended==false)EK.pause();MK.rM(this);EK=null;}}}class dD extends HB{var CK;dD(){if(FD.MD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  oF( m){var i=new dD();var g=new Completer<HB>();var h=new XC.HttpRequest(); o( k){i.CK=k;if(g.future.isComplete==false)g.complete(i);} j(LB){if(g.future.isComplete==false)g.completeException("Failed to decode audio.");} v(s){var BB=FD.MD;BB.decodeAudioData(h.response,o,j);} l(s){if(g.future.isComplete==false)g.completeException("Failed to load audio.");}h.open('GET',HB.kE(m),true);h.responseType='arraybuffer';h.on.load.add(v);h.on.error.add(l);h.send();return g.future;} get length{return CK.duration;} play([ loop=false, soundTransform=null]){if(soundTransform==null)soundTransform=new UB();return new LH(this,loop,soundTransform);}}class LH extends HC{var JK;var NK;var xJ;var uK;var GL;LH( j, h, i){JK=j;xJ=h;NK=i;var g=FD.MD;uK=g.createGain();uK.connect(g.destination,0,0);uK.gain.value=(NK!=null)?QB.pow(NK.volume,2):1;GL=g.createBufferSource();GL.buffer=JK.CK;GL.loop=h;GL.connect(uK,0,0);GL.start(0);} get DC=>NK; set DC( g){NK=g;uK.gain.value=(NK!=null)?QB.pow(NK.volume,2):1;} stop(){GL.stop(0);}}class SE extends HB{SE(){}static  oF( i){var h=new SE();var g=new Completer<HB>();XC.window.setTimeout(()=>g.complete(h),1);return g.future;} get length{return double.NAN;} play([ loop=false, soundTransform=null]){if(soundTransform==null)soundTransform=new UB();return new MH(this,loop,soundTransform);}}class MH extends HC{var xJ;var NK;MH( i, h, g){xJ=h;NK=g;} get DC=>NK; set DC( g){NK=g;} stop(){}}class fF{static const  tF="pixel";}class IC extends yB{var vJ="";var IK=0x000000;var dK=null;var rK=iF.CG;var EL=fF.tF;var fJ=hF.nF;var WL=false;var bL=false;var gL=0x000000;var mL=false;var pL=0x000000;var uL=0;var zL=0;var DM;var GM;var IM=true;var KM=100;var MM=100;var FK=null;var tJ=null;IC(){dK=new TE("Arial",12,0x000000);DM=new List<String>();GM=new List<eD>();} get type=>fJ; get width=>KM; get height=>MM; set text( g){vJ=g;IM=true;} set MC( g){dK=g;IK=dK.color;IM=true;} set wordWrap( g){WL=g;IM=true;} set width( g){KM=g;IM=true;} set height( g){MM=g;IM=true;} get CH{DN();return uL;} get CE{DN();return zL;} rB( g,[ returnRectangle=null]){return uD(g,KM,MM,returnRectangle);} EC( g, h){if(g>=0&&h>=0&&g<KM&&h<MM)return this;return null;} mB( g){DN();g.tJ.drawImage(FK,0.0,0.0);} EN(){DM.clear();GM.clear();if(WL==false){DM.add(vJ);}else{var g=new StringBuffer();var i;var h;for(String j in vJ.split(" ")){i=g.length;g.add((i>0)?" ${j}":j);h=g.toString();if(tJ.measureText(h).width>KM){if(i>0)h=h.substring(0,i);else j="";DM.add(h);g.clear();g.add(j);}}if(g.isEmpty==false)DM.add(g.toString());}uL=0;zL=0;for(String h in DM){var k=tJ.measureText(h);var l=0;if(dK.align==pB.JC||dK.align==pB.BG)l=(KM-k.width)/2;if(dK.align==pB.zF||dK.align==pB.wF)l=KM-k.width;var m=new eD(l,k.width,dK.size,0,0,0);GM.add(m);uL=QB.max(uL,m.width);zL=zL+m.height;}} DN(){if(IM){IM=false;var j=KM.ceil().toInt();var i=MM.ceil().toInt();if(FK==null){FK=new XC.CanvasElement(width:j,height:i);tJ=FK.context2d;}if(FK.width!=j)FK.width=j;if(FK.height!=i)FK.height=i;var g=new StringBuffer();g.add(dK.yE?"italic ":"normal ");g.add("normal ");g.add(dK.BC?"bold ":"normal ");g.add("${dK.size}px ");g.add("${dK.font},sans-serif");tJ.font=g.toString();tJ.textAlign="start";tJ.textBaseline="top";tJ.fillStyle=rC(IK);EN();if(bL){tJ.fillStyle=rC(gL);tJ.fillRect(0,0,KM,MM);}else{tJ.clearRect(0,0,KM,MM);}var k=0;for(int h=0;h<DM.length;h++ ){var l=GM[h];tJ.fillStyle=rC(IK);tJ.fillText(DM[h],l.x,k);k+= l.height;}if(mL){tJ.strokeStyle=rC(pL);tJ.lineWidth=1;tJ.strokeRect(0,0,KM,MM);}}}}class iF{static const  CG="none";}class hF{static const  nF="dynamic";}class TE{var font;var size;var color;var BC;var yE;var FH;var align;var mG;var yG;var gG;var xD;var letterSpacing=0;var OH=0;var PH=false;var WH=false;TE(this.font,this.size,this.color,{this.BC: false,this.yE: false,this.FH: false,this.align: "left",this.mG: 0,this.yG: 0,this.gG: 0,this.xD: 0});}class DB implements ME{var yJ;var HK;var UK;var iK;var tJ;var DL;var KL;var RL;var QK;var XK;var fK;var lK;DB( g, i,[ transparent=true, fillColor=0xFFFFFFFF]){yJ=g;HK=i;UK=transparent;var h=new XC.CanvasElement(width:yJ,height:HK);tJ=h.context2d;tJ.fillStyle=UK?KG(fillColor):rC(fillColor);tJ.fillRect(0,0,g,i);iK=h;DL=0;}DB.iH( g){yJ=g.naturalWidth;HK=g.naturalHeight;UK=true;iK=g;DL=0;}DB.hH( g){yJ=g.rG;HK=g.qG;UK=true;iK=g.DH.fG;DL=g.zG?2:1;KL=g.offsetX.toDouble();RL=g.offsetY.toDouble();QK=g.bG.toDouble();XK=g.cG.toDouble();fK=g.aG.toDouble();lK=g.ZG.toDouble();}static  nE( i){var h=new Completer<DB>();var g=new XC.ImageElement();g.on.load.add((j)=>h.complete(new DB.iH(g)));g.on.error.add((j)=>h.completeException("Failed to load image."));g.src=i;return h.future;} get width=>yJ; get height=>HK; mB( g){switch (DL){case 0:g.context.drawImage(iK,0.0,0.0);break;case 1:g.context.drawImage(iK,QK,XK,fK,lK,KL,RL,fK,lK);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,KL,RL+lK);g.context.drawImage(iK,QK,XK,lK,fK,0.0,0.0,lK,fK);break;}} FF( gB, g){if(g.width<=0.0||g.height<=0.0)return;switch (DL){case 0:gB.context.drawImage(iK,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=QK;double h=XK;double s=j+fK;double BB=h+lK;double m=QK-KL+g.x;double k=XK-RL+g.y;double PB=m+g.width;double LB=k+g.height;double v=(j>m)?j:m;double l=(h>k)?h:k;double nB=(s<PB)?s:PB;double FE=(BB<LB)?BB:LB;double WC=KL-j+v;double GE=RL-h+l;double o=nB-v;double i=FE-l;if(o>0.0&&i>0.0){gB.context.drawImage(iK,v,l,o,i,WC,GE,o,i);}break;case 2:double j=QK;double h=XK;double s=j+lK;double BB=h+fK;double m=QK+RL-g.y+lK-g.height;double k=XK-KL+g.x;double PB=m+g.height;double LB=k+g.width;double v=(j>m)?j:m;double l=(h>k)?h:k;double nB=(s<PB)?s:PB;double FE=(BB<LB)?BB:LB;double WC=KL-h+l;double GE=RL+s-nB;double o=FE-l;double i=nB-v;if(o>0.0&&i>0.0){gB.context.transform(0.0,-1.0,1.0,0.0,WC,GE+i);gB.context.drawImage(iK,v,l,i,o,0.0,0.0,i,o);}break;}}}class iD extends CD implements kB{static const  uF='TIME_OUT';var xK=false;var sJ=0.0;var LK=0.0;var TL;var YL=true;iD( g, h,[ direction=CD.ID]):super(h,direction){if(g<=0)throw new ArgumentError('Time must be greater than zero');LK=g;rE();} AC( g){if(xK&&ratio>0.0){ratio=ratio-g/totalTime;if(ratio==0.0)pause();}return true;} start(){xK=true;} pause(){xK=false;} reset([ time=0.0]){pause();time=QB.max(time,0.0);if(time!=0.0){LK=time;rE();}ratio=1.0;} ND( h, g){TL[h]=g/totalTime;} rE(){TL=new Map<String,num>();ND(iD.uF,0);} get totalTime=>LK; get xG=>ratio*totalTime; set ratio( h){var i=ratio;super.ratio=h;if(YL){TL.forEach((j,g){if(g<i&&g>=ratio)MB(new EB(j));});}}}typedef  pC(event); rC( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}typedef  XE();typedef  ZE();typedef  bE( value);typedef  cE();typedef  KD( ratio);typedef  eE();typedef  fE();class JG{var name;var uB;var BE;JG(this.name,this.uB,this.BE);}class cB{var QG;var wL;var BM;cB( g, h){QG=g;wL=h;BM=new List<kF>();} get xE=>QG; add( h,[ useCapture=false]){for(int g=0;g<BM.length;g++ )if(BM[g].QD==h&&BM[g].UD==useCapture)return;if(wL==EB.rD&&BM.length==0)ED.kD.add(this);BM.add(new kF(h,useCapture));} remove( h,[ useCapture=false]){for(int g=0;g<BM.length;g++ ){if(BM[g].QD==h&&BM[g].UD==useCapture){BM=new List<kF>.from(BM);BM.removeAt(g);if(wL==EB.rD&&BM.length==0)ED.kD.remove(this);break;}}} operator+( g){this.add(g,false);} operator-( g){this.remove(g,false);} MB( h){for(int g=0;g<BM.length;g++ )if(h.eventPhase!=aC.VE||BM[g].UD)if(h.BH==false)BM[g].QD(h);}} KG( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class KB{static  KC( g){return g;}static  mE( g){return g*g*g;}static  qB( g){g=1.0-g;return 1.0-g*g*g;}static  TG( g){if(g==0.0||g==1.0)return g;return QB.pow(2.0,-10.0*g)*QB.sin((g-0.3/4.0)*(2.0*QB.PI)/0.3)+1;}}class LC extends kB{var QM;var RM;var SM;var UM;var WM;var XM;var YM;var LK;var sJ;var ZM;var bM;var dM;LC( g, h, i,[ transitionFunction=null]){QM=g;RM=h;SM=g;UM=(transitionFunction!=null)?transitionFunction:KB.KC;sJ=0.0;LK=QB.max(0.0001,i);ZM=0.0;bM=false;dM=false;} AC( h){if(sJ<LK||dM==false){sJ=sJ+h;if(sJ>LK)sJ=LK;if(sJ>=0.0){if(dM==false){dM=true;if(WM!=null)WM();}var g=sJ/LK;var i=UM(g);SM=QM+i*(RM-QM);if(XM!=null)XM(bM?SM.round():SM);if(YM!=null&&sJ==LK)YM();}}return sJ<LK;} get uB=>QM; get BE=>RM; get totalTime=>LK; get currentTime=>sJ; get isComplete=>sJ>=LK;set delay( g){if(dM==false)sJ=sJ+ZM-g;ZM=g;} set CF( g){WM=g;} set GC( g){XM=g;} set onComplete( g){YM=g;}} uD( g, BB, o, l){var WC=0.0;var nB=0.0;var v=BB*g.a;var gB=BB*g.b;var LB=BB*g.a+o*g.c;var s=BB*g.b+o*g.d;var PB=o*g.c;var m=o*g.d;var h=WC;if(h>v)h=v;if(h>LB)h=LB;if(h>PB)h=PB;var i=nB;if(i>gB)i=gB;if(i>s)i=s;if(i>m)i=m;var j=WC;if(j<v)j=v;if(j<LB)j=LB;if(j<PB)j=PB;var k=nB;if(k<gB)k=gB;if(k<s)k=s;if(k<m)k=m;if(l==null)l=new RB.gH();l.x=g.UC+h;l.y=g.VC+i;l.width=j-h;l.height=k-i;return l;}class lB implements kB{var jM;var UM;var lM;var WM;var XM;var YM;var LK;var sJ;var ZM;var bM;var dM;lB( h, g,[ transitionFunction=null]){jM=h;UM=(transitionFunction!=null)?transitionFunction:KB.KC;sJ=0.0;LK=QB.max(0.0001,g);ZM=0.0;bM=false;dM=false;lM=new List<JG>();} VB( g, i){var h=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(h.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(jM!=null&&dM==false)lM.add(new JG(g,0.0,i));} moveTo( h, g){VB('x',h);VB('y',g);} AC( k){if(sJ<LK||dM==false){sJ=sJ+k;if(sJ>LK)sJ=LK;if(sJ>=0.0){if(dM==false){dM=true;for(int i=0;i<lM.length;i++ ){var g=lM[i];switch (g.name){case 'x':g.uB=jM.x;break;case 'y':g.uB=jM.y;break;case 'pivotX':g.uB=jM.OC;break;case 'pivotY':g.uB=jM.PC;break;case 'scaleX':g.uB=jM.tB;break;case 'scaleY':g.uB=jM.CC;break;case 'rotation':g.uB=jM.WB;break;case 'alpha':g.uB=jM.alpha;break;}}if(WM!=null)WM();}var j=sJ/LK;var l=UM(j);for(int i=0;i<lM.length;i++ ){var g=lM[i];var h=g.uB+l*(g.BE-g.uB);h=bM?h.round():h;switch (g.name){case 'x':jM.x=h;break;case 'y':jM.y=h;break;case 'pivotX':jM.OC=h;break;case 'pivotY':jM.PC=h;break;case 'scaleX':jM.tB=h;break;case 'scaleY':jM.CC=h;break;case 'rotation':jM.WB=h;break;case 'alpha':jM.alpha=h;break;}}if(XM!=null)XM();if(YM!=null&&sJ==LK)YM();}}return sJ<LK;} get totalTime=>LK; get currentTime=>sJ; get isComplete=>sJ>=LK;set delay( g){if(dM==false)sJ=sJ+ZM-g;ZM=g;} set CF( g){WM=g;} set GC( g){XM=g;} set onComplete( g){YM=g;}}
//@ sourceMappingURL=out.dart.map