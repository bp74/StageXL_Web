import "dart:html" as mC;import "dart:web_audio" as aE;import "dart:json" as RI;import "dart:math" as VB;import "dart:async" as hB;class SI{static const  TI="Chrome";static const  UI="Firefox";static const  VI="Internet Explorer";static const  WI="Safari";final  jH;final  minimumVersion;const SI(this.jH,[this.minimumVersion]);}class XI{final  name;const XI(this.name);}class eB{static var MB;}class aB extends BB{static const  cE="Explosion";static const  LD="Unlocked";static const  dE="Finalized";static const  tD="Timeouted";var wJ;aB( h, g,[ bubbles=false]):super(h,bubbles){wJ=g;} get info{return wJ;}}class CC{static const  tC=1;static const  qD=2;static const  rD=3;}class AG extends AB{var KJ;var UJ;var eJ;var kJ;var mJ;AG(){eJ=eB.MB.lB("Warning");kJ=null;KJ=GB.KG();UJ=new CB(KJ[0]);o(UJ);} start(){kJ=eJ.play();q.remove(mJ);mJ=new SC(0,80,9.0,OB.TC);mJ.LC=(h){var g=h.toInt()%8;UJ.bitmapData=KJ[(g<=4)?g+1:8-g];};q.add(mJ);} stop(){if(kJ!=null){kJ.stop();kJ=null;}q.remove(mJ);UJ.bitmapData=KJ[0];}}class oD{var RF;var rF;var sF;var angle;var wF;var SB;}class xF extends AB{var IJ;var QJ;var bJ;var RJ;xF(){var m=new CB(GB.MB.u("ExitBox"));o(m);var g=new OC();g.JC=new xD("Arial",24,0xFFFFFF,bold:true,align:wB.RC);g.width=240;g.height=100;g.wordWrap=true;g.text=eC.MB.rC("GENexitquery");g.x=47;g.y=150-g.VE/2;g.UB=false;o(g);IJ=new CE(7,GB.MB.u("ExitGauge"),TD.JE);IJ.x=268;IJ.y=25;IJ.LB("TimeOver",bK);o(IJ);IJ.ZD("TimeOver",0);IJ.start();var i=new CB(GB.MB.u("ExitYesButtonNormal"));var j=new CB(GB.MB.u("ExitYesButtonPressed"));QJ=new yC(i,i,j,j);QJ.x=68;QJ.y=239;QJ.LB(s.YC,eK);o(QJ);var h=new CB(GB.MB.u("ExitNoButtonNormal"));var k=new CB(GB.MB.u("ExitNoButtonPressed"));bJ=new yC(h,h,k,k);bJ.x=173;bJ.y=232;bJ.LB(s.YC,gK);o(bJ);this.LB(BB.BD,(l)=>q.add(IJ));this.LB(BB.DD,(l)=>q.remove(IJ));} hK( g){if(RJ!=null){RJ(g);RJ=null;}} eK( g){hK(true);} gK( g){hK(false);} bK( g){hK(false);}show( g){RJ=g;}}class KB{var DJ;var EJ;var NJ;var TJ;var YJ;var aJ;var hJ;var lJ;var oJ;var sJ;var vJ;KB( h, g){DJ=h;EJ=g;NJ=v.KD;TJ=-1000;YJ=-1000;aJ=false;hJ=false;lJ=false;oJ=null;sJ=null;vJ=null;} get color=>DJ; set color( g){DJ=g;} get direction=>EJ; set direction( g){EJ=g;} get EB=>NJ; set EB( g){NJ=g;} get dB=>aJ; set dB( g){aJ=g;} get KC=>hJ; set KC( g){hJ=g;} get empty=>lJ; set empty( g){lJ=g;} cD( g){var h=g!=null&&(g.color==DJ||g.EB==v.RB||NJ==v.RB)&&g.EB!=v.DC&&NJ!=v.DC;return h;} aC( g){var h=g!=null&&(g.color==DJ||g.EB==v.RB||NJ==v.RB)&&g.direction==0&&EJ==0&&g.EB!=v.DC&&NJ!=v.DC;return h;} kC( g){var h=g!=null&&(g.color==DJ||g.EB==v.RB||NJ==v.RB)&&g.direction==1&&EJ==1&&g.EB!=v.DC&&NJ!=v.DC;return h;} get x=>TJ; set x( g){TJ=g;if(oJ!=null)oJ.x=g;if(sJ!=null)sJ.x=g;if(vJ!=null)vJ.x=g;} get y=>YJ; set y( g){YJ=g;if(oJ!=null)oJ.y=g;if(sJ!=null)sJ.y=g;if(vJ!=null)vJ.y=g;} set qF( h){if(oJ!=null){var g=1+0.3*VB.sin(h*VB.PI);oJ.sB=g;oJ.AC=g;}} nB( g, h, i){if(oJ!=null){oJ.parent.zB(oJ);oJ=null;}if(sJ!=null){sJ.parent.zB(sJ);sJ=null;}if(vJ!=null){vJ.parent.zB(vJ);vJ=null;}if(empty==false){switch (NJ){case v.RB:oJ=new ZI(EJ);oJ.x=TJ;oJ.y=YJ;g.o(oJ);break;case v.DC:oJ=GB.uD(v.DC);oJ.x=TJ;oJ.y=YJ;g.o(oJ);break;default:oJ=GB.sD(DJ,EJ);oJ.x=TJ;oJ.y=YJ;g.o(oJ);break;}if(aJ){sJ=hJ?new YI(EJ):GB.DG(DJ,EJ);sJ.x=TJ+((EJ==0)?25:0);sJ.y=YJ+((EJ==1)?25:0);h.o(sJ);}switch (NJ){case v.KD:break;case v.DC:break;case v.RB:break;default:vJ=new aI(NJ);vJ.x=TJ;vJ.y=YJ;i.o(vJ);break;}}}}class yF extends AB{var GJ;var PJ;var ZJ;var iJ;var IJ;var nJ;var pJ;var rJ;var uJ;var FJ;var yJ;var zJ;var AK;var BK;var DK;var EK;var FK;var HK;var IK;yF(){var j=new CB(GB.MB.u("ShuffleButtonNormal"));var h=new CB(GB.MB.u("ShuffleButtonPressed"));PJ=new yC(j,j,h,h);PJ.LB(s.YC,WK);PJ.x=530;PJ.y=525;o(PJ);var g=new CB(GB.MB.u("ExitButtonNormal"));var i=new CB(GB.MB.u("ExitButtonPressed"));ZJ=new yC(g,g,i,i);ZJ.LB(s.YC,dK);ZJ.x=700;ZJ.y=500;o(ZJ);GJ=new BG();GJ.x=540;GJ.y=-1000;o(GJ);IJ=new CE(10,GB.MB.u("TimeGauge"),TD.FE);IJ.x=659;IJ.y=244;IJ.LB("TimeShort",fK);IJ.LB("TimeOver",bK);o(IJ);q.add(IJ);nJ=new CG();nJ.x=640;nJ.y=230;o(nJ);pJ=new AG();pJ.x=665;pJ.y=160;o(pJ);rJ=new OC();rJ.JC=new xD("Arial",30,0xD0D0D0,bold:true,align:wB.RC);rJ.width=140;rJ.height=36;rJ.wordWrap=false;rJ.x=646;rJ.y=130;rJ.UB=false;rJ.text="0";rJ.sB=0.9;o(rJ);uJ=new OC();uJ.JC=new xD("Arial",20,0xFFFFFF,bold:true,align:wB.RC);uJ.width=44;uJ.height=30;uJ.wordWrap=false;uJ.x=610;uJ.y=559;uJ.UB=false;uJ.text="3x";o(uJ);DK=new AB();o(DK);EK=new AB();o(EK);FK=new AB();o(FK);HK=eB.MB.lB("Intro");IK=HK.play();} start(){FJ=1;yJ=1;BK=0;zJ=3;var g=new pD(eC.MB.rC("ESCStartText"));EK.o(g);q.fB(()=>nJ.kF(21),1);g.show(()=>q.fB(()=>kK(),0.5));} kK(){if(iJ!=null&&this.contains(iJ))DK.zB(iJ);var m=FJ;var g=0;var h=0;switch (FJ){case 01:h=50;iJ=new zF(g=40,3,0,0,0,0,[0,1,2]);break;case 02:h=45;iJ=new zF(g=45,3,1,0,0,0,[2,3,4]);break;case 03:h=40;iJ=new zF(g=50,4,2,2,1,0,[5,6,7]);break;case 04:h=35;iJ=new zF(g=55,4,3,3,2,0,[0,2,6]);break;case 05:h=30;iJ=new zF(g=60,5,4,4,2,1,[1,3,5]);break;case 06:h=34;iJ=new zF(g=60,5,5,5,3,2,[1,2,4,7]);break;case 07:h=33;iJ=new zF(g=65,5,5,6,3,2,[0,1,2,3]);break;case 08:h=32;iJ=new zF(g=70,5,5,6,3,2,[0,2,5,6]);break;case 09:h=31;iJ=new zF(g=75,5,5,6,3,2,[1,4,5,7]);break;default:h=30;iJ=new zF(g=80+(FJ-10)*5,5,5,6,3,2,[0,1,2,3]);break;}AK=g;if(zJ<3){zJ++ ;uJ.text="${zJ}x";}iJ.LB(aB.cE,lK);iJ.LB(aB.LD,mK);iJ.LB(aB.dE,nK);iJ.LB(aB.tD,oK);iJ.x=20;iJ.y=16;iJ.UB=false;DK.o(iJ);IJ.reset(h);IJ.ZD("TimeShort",9);IJ.ZD("TimeOver",0);IJ.pause();GJ.level=m;GJ.SF=g;GJ.y=-210;var k=new bB(GJ,0.4,OB.xB);k.cB("y",-90);q.add(k);var j=new pD(eC.MB.rC("ESCLevelBoxText").replaceAll("{0}","${g}"));EK.o(j);j.show((){iJ.UB=true;IJ.start();if(HK!=null){var i=new SC(1.0,0.0,4.0,OB.TC);i.LC=(l){IK.FC.volume=l;IK.FC=IK.FC;};i.onComplete=(){IK.stop();nJ.yH();};q.add(i);HK=null;}});} fK( g){pJ.start();} bK( g){iJ.vF(CC.rD);} mK( j){var g=0;var k=j.info["Position"];var h=j.info["Type"];if(h=="SingleLocked")g=3000;if(h=="SingleUnlocked")g=1000;if(h=="All")g=10000;var i=new bE(g);i.x=k.x;i.y=k.y;DK.o(i);BK=BK+g;rJ.text="${BK}";} lK( j){var g=AK;var i=j.info["Length"];var k=j.info["Factor"];g=(g>i)?g-i:0;AK=g;GJ.SF=g;if(g==0)iJ.vF(CC.qD);var h=0;switch (i){case 3:h=1000;break;case 4:h=2000;break;case 5:h=5000;break;default:h=5000;break;}BK=BK+h*k;rJ.text="${BK}";} nK( m){IJ.pause();pJ.stop();var l=eB.MB.lB("Laugh");var k=eB.MB.lB("LevelUp");l.play();nJ.kF(3);var g=GB.EG();g.x=55;g.y=260;DK.o(g);q.fB((){iJ.YF();k.play();},2.0);q.fB((){var j=(IJ.JI*1000).toInt();var h=new bE(j);h.x=704;h.y=360;DK.o(h);BK=BK+j;rJ.text="${BK}";},2.5);var i=new bB(GJ,0.5,OB.xB);i.cB("y",-210);i.VC=3.0;q.add(i);q.fB((){DK.zB(g);},3.5);q.fB((){FJ++ ;kK();},4.0);} oK( j){pJ.stop();iJ.YF();var g;var i;if(yJ>0){yJ-- ;g=new pD(eC.MB.rC("GEN2ndchancetime"));EK.o(g);i=eB.MB.lB("LevelUp");i.play();g.show((){q.fB(()=>kK(),0.5);var h=new bB(GJ,0.5,OB.xB);h.cB("y",-210);q.add(h);});}else{g=new pD(eC.MB.rC("GENtimeup"));EK.o(g);i=eB.MB.lB("GameOver");i.play();g.show((){q.fB(()=>rK(),0.5);var h=new bB(GJ,0.5,OB.xB);h.cB("y",-210);q.add(h);});}} WK( h){if(iJ!=null&&zJ>0){var g=iJ.pF();if(g){zJ=zJ-1;uJ.text="${zJ}x";}}} dK( j){var h=new AB();h.o(new CB(new DB(800,600,false,0x000000)));h.alpha=0.6;FK.o(h);var g=new xF();g.x=235;g.y=150;FK.o(g);g.show(( i){FK.zB(g);if(i==false)FK.zB(h);else tK(false);});}rK(){var h=new AB();var j=new CB(GB.MB.u("ExitBox"));h.o(j);var g=new OC();g.JC=new xD("Arial",30,0xFFFFFF,bold:true,align:wB.RC);g.width=240;g.height=200;g.wordWrap=true;g.text=eC.MB.rC("GENgameover");g.x=47;g.y=30+(g.height-g.VE)/2;g.UB=false;h.o(g);h.x=110;h.y=-h.height;EK.o(h);var k=eB.MB.lB("Laugh");q.fB(()=>k.play(),0.3);var i=new bB(h,0.3,OB.xB);i.cB("y",150);q.add(i);q.fB(()=>tK(true),5.0);h.LB(s.YC,( l)=>tK(true));}var vK=false; tK( g){IJ.pause();if(vK==false){vK=true;}}}class JD extends AB{var DJ;var MJ;var WJ;var gJ;JD( g){DJ=g;WJ=GB.IG(g);gJ=true;MJ=new CB(WJ[0]);MJ.x=-34;MJ.y=-50;o(MJ);} get HD=>gJ; set HD( g){gJ=g;} oF( g){MJ.bitmapData=WJ[g?0:4];} LI(){var i=new SC(0.0,1.0,2.0,OB.xB);i.LC=(j){sB=AC=1.0+0.2*VB.sin(j*4*VB.PI);};var g=new bB(this,0.2,OB.xB);g.cB("alpha",0.0);g.VC=2.0;g.onComplete=()=>oF(gJ);var h=new bB(this,0.2,OB.OF);h.cB("alpha",1);h.VC=2.2;q.add(i);q.add(g);q.add(h);}}class zF extends AB{var qJ;var xJ;var CK;var GK;var JK;var KK;var LK;var MK;var NK;var PK;var QK;var RK;var SK;var TK;var UK;var VK;var XK;var YK;var ZK;var aK;zF( FB, p, QB, m, n, w, k){MK=new VB.Random();NK=CC.tC;PK=k;qJ=FB;xJ=p;CK=QB;GK=m;JK=n;KK=w;LK=k.length;TK=new List<IB>();VK=new AB();XK=new AB();YK=new AB();ZK=new AB();aK=new AB();o(VK);o(XK);o(YK);o(ZK);o(aK);XK.UB=false;YK.UB=false;ZK.UB=false;aK.UB=false;sH();tH();rH();UK=true;var l=new sC();this.mask=new zD.wI(0.0,0.0,500.0,500.0);for(int g=0;g<10;g++ ){for(int h=0;h<10;h++ ){var i=RK[g+h*10];i.x=g*50+25;i.y=h*50+25-550;i.nB(VK,XK,YK);var j=new SC(i.y,h*50+25,0.4,OB.xB);j.VC=g*0.03;j.LC=(TB){i.y=TB;};j.onComplete=(){if(l.eD()==100){iK();UK=false;TK.clear();this.mask=null;}};q.add(j);}}LB(s.VD,jK);} vF( g){if(g==CC.qD)NK=g;if(g==CC.rD&&NK==CC.tC){NK=g;if(UK==false)dispatchEvent(new aB(aB.tD,null));}} YF(){this.mask=new zD.wI(0.0,0.0,500.0,500.0);for(int h=0;h<10;h++ ){for(int i=0;i<10;i++ ){var g=RK[i+h*10];g.dB=false;g.KC=false;g.EB=v.KD;g.nB(VK,XK,YK);var j=new SC(g.y,500+h*50+25,0.5,OB.xB);j.VC=i*0.1;j.LC=(k){g.y=k;};q.add(j);}}} sH(){SK=new List<JD>();for(int h=0;h<xJ;h++ ){var g=new JD(h);g.SB=(MK.nextInt(30)-15)*VB.PI/180;g.x=300-(90*xJ)/2+h*90+MK.nextInt(20)-10;g.y=550;SK.add(g);ZK.o(g);}} WF( g, h){var i=0;var j=RK[g+h*10];if(j.direction==0){var l=(g>0)?RK[g-1+h*10]:null;var m=(g<9)?RK[g+1+h*10]:null;if(j.aC(l))i++ ;if(j.aC(m))i++ ;}else{var k=(h>0)?RK[g+(h-1)*10]:null;var n=(h<9)?RK[g+(h+1)*10]:null;if(j.kC(k))i++ ;if(j.kC(n))i++ ;}return i;} UF(){for(int h=0;h<10;h++ ){for(int g=0;g<10;g++ ){var k=RK[g+h*10];var i=LK*2;while (WF(g,h)==2&&i>0){if(i%2==0){k.direction=1-k.direction;i-- ;}else{var m=0;for(int j=0;j<PK.length;j++ )if(k.color==PK[j])m=j;k.color=PK[(m+1)%PK.length];i-- ;}}}}var l=false;for(int h=0;h<10;h++ )for(int g=0;g<10;g++ )l=l||(WF(g,h)==2);return l;} lF(){for(int g=0;g<10;g++ )for(int h=1;h<9;h++ )if(RK[(h-1)+g*10].cD(RK[h+g*10])&&RK[h+g*10].cD(RK[(h+1)+g*10]))return true;for(int h=0;h<10;h++ )for(int g=1;g<9;g++ )if(RK[h+(g-1)*10].cD(RK[h+g*10])&&RK[h+g*10].cD(RK[h+(g+1)*10]))return true;return false;} pK( j, l, k){for(int g=0;g<20;g++ ){var h=qJ~/k;var i=l*h+MK.nextInt(h);if(QK[i].EB==v.KD){QK[i].EB=j;return;}}} tH(){QK=new List<KB>();for(int g=0;g<qJ;g++ ){var i=PK[MK.nextInt(PK.length)];var h=MK.nextInt(2);QK.add(new KB(i,h));}for(int g=0;g<xJ*2;g++ )pK("Lock${(g%xJ)+1}",g,xJ*2);for(int g=0;g<CK;g++ )pK(v.RB,g,CK);for(int g=0;g<GK;g++ )pK(v.DC,g,GK);for(int g=0;g<JK;g++ )pK(v.eE,g,JK);for(int g=0;g<KK;g++ )pK(v.fE,g,KK);} rH(){RK=new List<KB>();var g=true;while (g){RK.clear();for(int h=0;h<100;h++ ){var j=PK[MK.nextInt(PK.length)];var i=MK.nextInt(2);RK.add(new KB(j,i));}g=UF();}} pF(){if(UK||NK!=CC.tC)return false;var l=true;UK=true;while (l){for(int k=0;k<RK.length;k++ ){var g=RK[k];g.dB=false;g.KC=false;g.nB(VK,XK,YK);g.color=PK[MK.nextInt(PK.length)];g.direction=MK.nextInt(2);}l=UF()||(lF()==false);}var p=eB.MB.lB("BonusUniversal");p.play();var m=new sC();for(int i=0;i<10;i++ ){for(int j=0;j<10;j++ ){var g=RK[i+j*10];g.qF=0.0;var h=new SC(0.0,1.0,0.2,OB.TC);h.VC=i*0.06;h.LC=(n){g.qF=n;};h.onStart=(){g.nB(VK,XK,YK);};h.onComplete=(){if(m.eD()==100){iK();qK();TK.clear();}};q.add(h);}}return true;} iK(){for(int i=0;i<10;i++ ){for(int h=0;h<10;h++ ){var g=RK[h+i*10];var l=(h<9)?RK[h+1+i*10]:null;var m=(i<9)?RK[h+(i+1)*10]:null;var j=false;var k=false;if(g.aC(l)){j=true;k=(g.EB==v.RB||l.EB==v.RB);}if(g.kC(m)){j=true;k=(g.EB==v.RB||m.EB==v.RB);}if(g.dB!=j||g.KC!=k){g.dB=j;g.KC=k;g.nB(VK,XK,YK);}}}} sK( w, l, n, k, m, p){UK=true;w.eD(k);var i=1;for(int h=0;h<k;h++ ){var g=RK[l+h*m+(n+h*p)*10];if(g.EB==v.eE)i=i*2;if(g.EB==v.fE)i=i*5;var QB=l+h*m;var TB=n+h*p;q.fB((){g.empty=true;g.nB(VK,XK,YK);var FB=eB.MB.lB("ChainBlast");FB.play();var j=new cE(g.color,g.direction);j.x=QB*50;j.y=TB*50;q.add(j);aK.o(j);EI(g);if(w.XF()==0)uK();},0.1+h*0.1);}dispatchEvent(new aB(aB.cE,{"Length":k,"Factor":i}));} qK(){UK=false;var j=new sC();for(int h=0;h<10;h++ ){for(int i=0;i<10;){var g=1;while (i+g<10&&RK[i+g-1+h*10].aC(RK[i+g+h*10]))g++ ;if(g>=3)sK(j,i,h,g,1,0);i=i+g;}}for(int i=0;i<10;i++ ){for(int h=0;h<10;){var g=1;while (h+g<10&&RK[i+(h+g-1)*10].kC(RK[i+(h+g)*10]))g++ ;if(g>=3)sK(j,i,h,g,0,1);h=h+g;}}if(j.value==0){if(NK==CC.qD)dispatchEvent(new aB(aB.dE,null));if(NK==CC.rD)dispatchEvent(new aB(aB.tD,null));if(NK==CC.tC&&lF()==false)pF();}} EI( h){if(h.EB.indexOf("Lock")==0){var k=int.parse(h.EB.substring(4,5))-1;var j=SK[k];var g=GB.uD(h.EB);g.x=h.x;g.y=h.y;o(g);var i=new bB(g,0.5,OB.xB);i.cB("x",j.x);i.cB("y",j.y-10);i.onComplete=()=>zB(g);q.add(i);q.fB(()=>zH(k),0.5);}} zH( k){var h=SK[k];var i;if(h.HD){i=new aB(aB.LD,{"Type":"SingleLocked","Position":new IB(h.x+20,h.y)});var l=eB.MB.lB("Unlock");l.play();}else{i=new aB(aB.LD,{"Type":"SingleUnlocked","Position":new IB(h.x+20,h.y)});}dispatchEvent(i);h.HD=false;h.oF(false);var j=true;for(int g=0;g<SK.length;g++ )j=j&&(SK[g].HD==false);if(j){var m=eB.MB.lB("BonusAllUnlock");m.play();for(int g=0;g<SK.length;g++ ){SK[g].HD=true;q.fB(()=>SK[(g+k)%SK.length].LI(),g*0.2);}q.fB(()=>dispatchEvent(new aB(aB.LD,{"Type":"All","Position":new IB(280,550)})),0.75);}} uK(){var n=new sC();for(int i=0;i<10;i++ ){var k=9;var j=8;while (k>=0){while (k>=0&&RK[i+k*10].empty==false){k-- ;j-- ;}while (j>=0&&RK[i+j*10].empty==true){j-- ;}if(k>=0){var g,h,l;if(j>=0){h=RK[i+j*10];if(i>0){l=RK[i-1+j*10];if(h.aC(l)){l.dB=false;l.nB(VK,XK,YK);}}h.dB=false;h.empty=true;h.nB(VK,XK,YK);}else{if(QK.length>0){h=QK[0];QK.removeRange(0,1);}else{h=new KB(PK[MK.nextInt(PK.length)],MK.nextInt(2));}}g=RK[i+k*10];g.color=h.color;g.direction=h.direction;g.EB=h.EB;g.dB=false;g.empty=false;g.x=50*i+25;g.y=50*j+25;g.nB(VK,XK,YK);n.eD();var m=new SC(g.y,50*k+25,0.1,OB.TC);m.LC=(p){g.y=p;};m.onComplete=(){if(n.XF()==0){iK();qK();wK();}};q.add(m);}}}} jK( g){if(g.target==VK&&this.UB){var j=VB.min(g.eF/50,9).toInt();var h=VB.min(g.fF/50,9).toInt();var i=new IB(j,h);TK.add(i);wK();}} wK(){while (NK==CC.tC&&UK==false&&TK.length>0){var m=TK[0];TK.removeRange(0,1);var j=m.x.toInt();var k=m.y.toInt();var g=RK[j+k*10];var i=(j>0)?RK[j-1+k*10]:null;var n=(j<9)?RK[j+1+k*10]:null;var h=(k>0)?RK[j+(k-1)*10]:null;var p=(k<9)?RK[j+(k+1)*10]:null;var l=false;if(g.EB==v.DC){var FB=eB.MB.lB("ChainError");FB.play();continue;}if(g.kC(h)){h.dB=false;h.nB(VK,XK,YK);}if(g.aC(i)){i.dB=false;i.nB(VK,XK,YK);}g.direction=1-g.direction;g.dB=false;g.KC=false;var QB=eB.MB.lB("ChainRotate");QB.play();if(g.aC(n)){g.dB=true;g.KC=(g.EB==v.RB||n.EB==v.RB);}if(g.kC(p)){g.dB=true;g.KC=(g.EB==v.RB||p.EB==v.RB);}g.nB(VK,XK,YK);l=l||g.dB;if(g.kC(h)){h.dB=true;h.KC=(g.EB==v.RB||h.EB==v.RB);h.nB(VK,XK,YK);l=true;}if(g.aC(i)){i.dB=true;i.KC=(g.EB==v.RB||i.EB==v.RB);i.nB(VK,XK,YK);l=true;}if(l){var w=eB.MB.lB("ChainLink");w.play();}qK();}}}class v{static const  KD="None";static const  RB="Joker";static const  DC="Block";static const  eE="Double";static const  fE="Quint";}class pD extends AB{var LJ;var RJ;pD( h){var i=new CB(GB.MB.u("MessageBox"));o(i);var g=new OC();g.JC=new xD("Arial",24,0xFFFFFF,bold:true,align:wB.RC);g.width=240;g.height=200;g.wordWrap=true;g.text=h;g.x=47;g.y=130-g.VE/2;g.UB=false;o(g);LJ=null;LB(s.YC,OK);}void show( h){this.parent.o(this);this.x=-this.width;this.y=150;RJ=h;var g=new bB(this,0.3,OB.xB);g.cB("x",110);g.onComplete=()=>LJ=q.fB(cK,10);q.add(g);} cK(){if(LJ!=null){q.remove(LJ);LJ=null;RJ();var g=new bB(this,0.4,OB.OF);g.cB("x",800);g.onComplete=()=>this.parent.zB(this);q.add(g);}} OK( g){cK();}}class BG extends AB{var FJ;var OJ;var VJ;var dJ;var jJ;BG(){o(new CB(GB.MB.u("InfoBox")));OJ=new OC();OJ.JC=new xD("Arial",35,0xFFFFFF,bold:true,align:wB.RC);OJ.width=220;OJ.height=40;OJ.wordWrap=false;OJ.text="Level 1";OJ.x=20;OJ.y=115;OJ.SB=-2*VB.PI/180;o(OJ);dJ=new OC();dJ.JC=new xD("Arial",25,0xFFFFFF,bold:true,align:wB.RC);dJ.width=220;dJ.height=30;dJ.wordWrap=false;dJ.text="40";dJ.x=-dJ.width/2;dJ.y=-dJ.height/2;dJ.SB=-2*VB.PI/180;jJ=new AB();jJ.o(dJ);jJ.x=150;jJ.y=172;o(jJ);var g=GB.sD(3,0);g.x=110;g.y=171;g.SB=-2*VB.PI/180;g.sB=g.AC=0.6;o(g);} set level( g){FJ=g;OJ.text="Level ${FJ}";} set SF( g){VJ=g;dJ.text="${VJ}";}}class YI extends AB implements pB{var MJ;var cJ;var XJ;YI( g){this.UB=false;XJ=0.0;cJ=GB.HG(g);MJ=new CB(cJ[0]);MJ.x=-25;MJ.y=-25;o(MJ);LB(BB.BD,(h)=>q.add(this));LB(BB.DD,(h)=>q.remove(this));} yB( g){XJ+= g;var h=(XJ*10).toInt()%cJ.length;MJ.bitmapData=cJ[h];return true;}}class sC{var value=0; eD([ inc=1])=>(value+= inc); XF([ dec=1])=>(value-= dec);}class aI extends AB implements pB{var MJ;var XJ;aI( h){this.UB=false;XJ=0.0;MJ=GB.uD(h);o(MJ);LB(BB.BD,(g)=>q.add(this));LB(BB.DD,(g)=>q.remove(this));} yB( g){XJ+= g;this.SB=VB.sin(XJ*7)*10*VB.PI/180;return true;}}class CG extends AB{var JJ;var SJ;var fJ;CG(){JJ=GB.JG();SJ=new CB(JJ[0]);SJ.x=-SJ.width/2;SJ.y=-SJ.height/2;o(SJ);fJ=null;} kF( g){q.remove(fJ);fJ=new SC(0,g,0.5*g,OB.TC);fJ.LC=(h){var i=((h*JJ.length)%JJ.length).toInt();SJ.bitmapData=JJ[i];SJ.y=VB.sin(h*2*VB.PI)*3-SJ.height/2;};q.add(fJ);} yH(){q.remove(fJ);SJ.bitmapData=JJ[0];}}class ZI extends AB implements pB{var MJ;var cJ;var XJ;ZI( g){this.UB=false;XJ=0.0;cJ=GB.GG(g);MJ=new CB(cJ[0]);MJ.x=-25;MJ.y=-25;o(MJ);LB(BB.BD,(h)=>q.add(this));LB(BB.DD,(h)=>q.remove(this));} yB( g){XJ+= g;var h=(XJ*10).toInt()%cJ.length;MJ.bitmapData=cJ[h];return true;}}class GB{static var MB;static  sD( i, h){var g=new CB(MB.WC("Elements").u("Chain${i}${h}"));g.MC=25;g.NC=25;return g;}static  DG( i, h){var g=new CB(MB.WC("Elements").u("Link${i}${h}"));g.MC=25;g.NC=25;return g;}static  uD( h){var g=new CB(MB.WC("Elements").u(h));g.MC=25;g.NC=25;return g;}static  EG(){var m=new AB();var l=0;var n=MB.WC("Levelup");for(int k=0;k<7;k++ ){var g=new CB(n.u("LevelUp${k}"));g.x=-g.width/2;g.y=-g.height/2;var h=new AB();h.o(g);h.x=l+g.width/2;h.sB=0;h.AC=0;m.o(h);var i=new bB(h,2.0,OB.hH);i.cB("scaleX",1.0);i.cB("scaleY",1.0);i.VC=k*0.05;var j=new bB(h,0.4,OB.TC);j.cB("scaleX",0.0);j.cB("scaleY",0.0);j.VC=3.0;q.add(i);q.add(j);l=l+5+g.width;}return m;}static  GG( h){var i=MB.WC("Elements");var g=new List<DB>();g.add(i.u("JokerChain${h}0"));g.add(i.u("JokerChain${h}1"));g.add(i.u("JokerChain${h}2"));g.add(i.u("JokerChain${h}3"));g.add(i.u("JokerChain${h}4"));return g;}static  HG( h){var i=MB.WC("Elements");var g=new List<DB>();g.add(i.u("JokerLink${h}0"));g.add(i.u("JokerLink${h}1"));g.add(i.u("JokerLink${h}2"));g.add(i.u("JokerLink${h}3"));g.add(i.u("JokerLink${h}4"));return g;}static  IG( h){var i=MB.WC("Locks");var g=new List<DB>();g.add(i.u("Lock${h}0"));g.add(i.u("Lock${h}1"));g.add(i.u("Lock${h}2"));g.add(i.u("Lock${h}3"));g.add(i.u("Lock${h}4"));return g;}static  JG(){var h=MB.WC("Head");var g=new List<DB>();g.add(h.u("Head1"));g.add(h.u("Head2"));g.add(h.u("Head3"));g.add(h.u("Head2"));g.add(h.u("Head1"));return g;}static  KG(){var h=MB.WC("Alarm");var g=new List<DB>();g.add(h.u("Alarm0"));g.add(h.u("Alarm1"));g.add(h.u("Alarm2"));g.add(h.u("Alarm3"));g.add(h.u("Alarm4"));g.add(h.u("Alarm5"));return g;}}class eC{static var MB;}class bE extends AB{var HJ;bE( j){var g=new OC();g.JC=new xD("Arial",30,0xFFFFFF,bold:true,align:wB.RC);g.width=110;g.height=36;g.wordWrap=false;g.x=646;g.y=130;g.UB=false;g.text=j.toString();g.x=-g.width/2;g.y=-g.height/2;HJ=new AB();HJ.o(g);o(HJ);var i=new SC(0.0,1.0,1.5,OB.xB);i.LC=(h){HJ.alpha=1-h;HJ.y=-h*50;HJ.sB=1.0+0.1*VB.sin(h*10);HJ.AC=1.0+0.1*VB.cos(h*10);};i.onComplete=(){this.TE();};q.add(i);}}class cE extends AB implements pB{var tJ;var XJ;cE( p, n){tJ=new List<oD>();XJ=0.0;this.UB=false;var w=GB.sD(p,n);var m=new VB.Random();var i;var l;var FB;for(int h=0;h<=1;h++ ){for(int g=0;g<=1;g++ ){if(g==0&&h==0){i=VB.PI*1.15;SB=-VB.PI*2;}if(g==1&&h==0){i=VB.PI*1.85;SB=VB.PI*2;}if(g==1&&h==1){i=VB.PI*0.15;SB=VB.PI*2;}if(g==0&&h==1){i=VB.PI*0.85;SB=-VB.PI*2;}i=i+0.2*VB.PI*m.nextDouble();l=80.0+40.0*m.nextDouble();var j=new CB(w.bitmapData);j.aD=new JB(g*25,h*25,25,25);j.MC=12.5+g*25;j.NC=12.5+h*25;j.x=g*25;j.y=h*25;o(j);var k=new oD();k.RF=j;k.rF=g*25+12.5;k.sF=h*25+12.5;k.angle=i;k.wF=l;k.SB=SB;tJ.add(k);}}} yB( m){XJ=VB.min(0.8,XJ+m);var w=981.0;for(int h=0;h<tJ.length;h++ ){var g=tJ[h];var i=g.RF;var j=g.angle;var k=g.wF;var l=g.SB;var n=g.rF+XJ*(VB.cos(j)*k);var p=g.sF+XJ*(VB.sin(j)*k+XJ*w*0.5);i.x=n;i.y=p;i.SB=XJ*l;}if(XJ>=0.6)this.alpha=(0.8-XJ)/0.2;if(XJ>=0.8)this.TE();return (XJ<0.8);}}var MD;var fC;var ND;var q;var XC;var OD;var EC; main(){MD=new jC("StageBackground",mC.query('#stageBackground'));fC=new jC("StageForeground",mC.query('#stageForeground'));ND=new wD();ND.QF(MD);ND.QF(fC);q=ND.RE;var g=DB.PF("images/Loading.png");g.then((h){XC=new CB(h);XC.MC=20;XC.NC=20;XC.x=400;XC.y=270;fC.o(XC);OD=new bB(XC,100,OB.TC);OD.cB.SB.tF(100.0*2.0*VB.PI);q.add(OD);EC=new OC();EC.JC=new xD("Arial",20,0xA0A0A0,bold:true);EC.width=240;EC.height=40;EC.text="... loading ...";EC.x=400-EC.MI/2;EC.y=320;EC.UB=false;fC.o(EC);FG();});} FG(){var g=new RD();g.jB("Background","images/Background.jpg");g.jB("ExitBox","images/ExitBox.png");g.jB("ExitButtonNormal","images/ExitButtonNormal.png");g.jB("ExitButtonPressed","images/ExitButtonPressed.png");g.jB("ExitGauge","images/ExitGauge.png");g.jB("ExitNoButtonNormal","images/ExitNoButtonNormal.png");g.jB("ExitNoButtonPressed","images/ExitNoButtonPressed.png");g.jB("ExitYesButtonNormal","images/ExitYesButtonNormal.png");g.jB("ExitYesButtonPressed","images/ExitYesButtonPressed.png");g.jB("InfoBox","images/InfoBox.png");g.jB("MessageBox","images/MessageBox.png");g.jB("ShuffleButtonNormal","images/ShuffleButtonNormal.png");g.jB("ShuffleButtonPressed","images/ShuffleButtonPressed.png");g.jB("TimeGauge","images/TimeGauge.png");g.ED("Alarm","images/AlarmTextureAtlas.json",gC.pC);g.ED("Head","images/HeadTextureAtlas.json",gC.pC);g.ED("Elements","images/ElementsTextureAtlas.json",gC.pC);g.ED("Levelup","images/LevelupTextureAtlas.json",gC.pC);g.ED("Locks","images/LocksTextureAtlas.json",gC.pC);g.ZB("BonusAllUnlock","sounds/BonusAllUnlock.mp3");g.ZB("BonusUniversal","sounds/BonusUniversal.mp3");g.ZB("ChainBlast","sounds/ChainBlast.mp3");g.ZB("ChainBlastSpecial","sounds/ChainBlastSpecial.mp3");g.ZB("ChainError","sounds/ChainError.mp3");g.ZB("ChainFall","sounds/ChainFall.mp3");g.ZB("ChainHelp","sounds/ChainHelp.mp3");g.ZB("ChainLink","sounds/ChainLink.mp3");g.ZB("ChainRotate","sounds/ChainRotate.mp3");g.ZB("Click","sounds/Click.mp3");g.ZB("GameOver","sounds/GameOver.mp3");g.ZB("Laugh","sounds/Laugh.mp3");g.ZB("LevelUp","sounds/LevelUp.mp3");g.ZB("PointsCounter","sounds/PointsCounter.mp3");g.ZB("Unlock","sounds/Unlock.mp3");g.ZB("Warning","sounds/Warning.mp3");g.ZB("Intro","sounds/Intro.mp3");g.rB("ESCAPE_INS_AIM_0","Connect at least 3 chain links of the same colour to a horizontal or vertical chain.");g.rB("ESCAPE_INS_DES_0","You can change the direction of a chain link by touching it.");g.rB("ESCAPE_INS_TIP_0","Earn extra points for connecting chain links displaying a key symbol.");g.rB("ESCBlockErrorHint","Sorry but block chains can´t be twisted!");g.rB("ESCLevelBoxText","Connect {0} chain links and help the crook to escape!");g.rB("ESCNoActionHint","Press on the chain links to twist them.");g.rB("ESCNoComboHint","You have to connect at least 3 chain links of the same colour.");g.rB("ESCStartText","Form horizontal or vertical same-colour chains and become an escape agent!");g.rB("ESCtogo","Chain links:");g.rB("GENexitquery","Do you really want to quit the game?");g.rB("GEN2ndchancetime","Time is up. Second chance!");g.rB("GENtimeup","Sorry! Your time is up.");g.rB("GENgameover","Game Over");g.load().then((l){fC.zB(XC);fC.zB(EC);q.remove(OD);GB.MB=g;eB.MB=g;eC.MB=g;var j=new CB(GB.MB.u("Background"));MD.o(j);MD.II=qC.LE;var i=new yF();fC.o(i);i.start();}).catchError((k){for(var h in g.aF){print("Loading resouce failed: ${h.kind}.${h.name} - ${h.error}");}});}const bI=const cI();class cI{const cI();}class XB{var volume;var pan;var qI=1;var rI=0;var uI=1;var tI=0;XB([this.volume=1,this.pan=0]);}class gC{static const  VG="json";static const  pC="jsonarray";}class hE{final  KL;final  UL;final  oL;final  zL;final  LM;final  SM;final  aM;final  fM;final  lM;final  oM;final  vM;hE.zI( i, h, g):KL=i,UL=h,oL=RH(g["rotated"]),zL=ZC(g["sourceSize"]["w"]),LM=ZC(g["sourceSize"]["h"]),SM=ZC(g["spriteSourceSize"]["x"]),aM=ZC(g["spriteSourceSize"]["y"]),fM=ZC(g["frame"]["x"]),lM=ZC(g["frame"]["y"]),oM=ZC(g["frame"]["w"]),vM=ZC(g["frame"]["h"]); get NI=>KL; get name=>UL; get KI=>oL; get mH=>fM; get nH=>lM; get cF=>oM; get bF=>vM; get offsetX=>SM; get offsetY=>aM; get BI=>zL; get AI=>LM;}abstract class PC extends QC{ get FC; set FC( g); stop();}class LG<AD>{final  EL=new List<AD>();final  hL;var rL=0;LG( g()):hL=g; DI(){if(rL==0){return hL();}else{rL-- ;return EL[rL];}}FI( g){if(rL==EL.length){EL.add(g);}else{EL[rL]=g;}rL++ ;}reset(){EL.clear();rL=0;}}class zD{var kD=null;zD();factory zD.wI( i, g, h, j){return new fI(i,g,h,j);} YB( g){}}class AE extends NB{var SL;var kL;var CM;AE(){CM=new List<SD>();SL=new mC.AudioElement();SL.onEnded.listen(wM);kL=new List<mC.AudioElement>();kL.add(SL);mC.document.body.children.add(SL);}static  PF( p){var k=new AE();var g=k.SL;var i=new hB.Completer<NB>();var h;var j;n(m){h.cancel();j.cancel();i.complete(k);}l(m){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(n);j=g.onError.listen(l);g.src=NB.KF(p);g.load();return i.future;} get length{return SL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new XB();return new SD(this,loop,soundTransform);} SN( h){var g;if(kL.length==0){g=SL.clone(true);g.onEnded.listen(wM);}else{g=kL.removeAt(0);}CM.add(h);return g;} aO( g){var h=g.SL;var i=CM.indexOf(g);CM.removeAt(i);kL.add(h);if(SL.currentTime>0&&SL.ended==false)SL.currentTime=0;} wM( j){var i=j.target;var g=null;for(int h=0;h<CM.length&&g==null;h++ )if(CM[h].SL==i)g=CM[h];if(g!=null)g.stop();}}class CB extends t{var bitmapData;var pixelSnapping;var aD;CB([this.bitmapData=null,this.pixelSnapping="auto"]){aD=null;} kB( h,[ returnRectangle]){var g=(bitmapData!=null)?bitmapData.width:0;var i=(bitmapData!=null)?bitmapData.height:0;return ME(h,g,i,returnRectangle);} mB( g, h){if(bitmapData!=null&&g>=0.0&&h>=0.0&&g<bitmapData.width&&h<bitmapData.height)return this;return null;} YB( g){if(bitmapData==null)return;if(aD==null){bitmapData.YB(g);}else{bitmapData.mF(g,aD);}}}class hC{static var mE=vB.EE;static var ZG=false;static var tE=null;static var nG=null;static var qG=null;static var wG=new hB.StreamController<String>();static var DH=wG.stream.asBroadcastStream();static  MF( i){var h=i;var g="auto";if(mE!=vB.EE){h=mE;}switch (h){case vB.EE:g="auto";break;case vB.HE:g="default";break;case vB.IE:g="pointer";break;case vB.oG:g="move";break;case vB.pG:g="text";break;case vB.sG:g="wait";break;}if(ZG){g="none";}return g;}}class vB{static const  EE="auto";static const  HE="arrow";static const  IE="button";static const  oG="hand";static const  pG="ibeam";static const  sG="wait";}class TD extends t{static const  FE='DIRECTION_UP';static const  sE='DIRECTION_RIGHT';static const  JE='DIRECTION_DOWN';static const  WD='DIRECTION_LEFT';var qM;var uM;var yM;var DN;TD( g,[ direction=WD]){if(direction!=FE&&direction!=JE&&direction!=WD&&direction!=sE){throw new ArgumentError('Invalid Gauge direction!');}qM=direction;uM=1.0;yM=g;DN=new JB.xI();EO();} get ratio=>uM;set ratio( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;uM=g;EO();} get bitmapData=>yM;set bitmapData( g){yM=g;EO();}EO(){if(yM==null){DN.left=0;DN.top=0;DN.right=0;DN.bottom=0;}else{var h=yM.width;var g=yM.height;switch (qM){case WD:DN.left=((1.0-uM)*h).toInt();DN.top=0;DN.right=h;DN.bottom=g;break;case FE:DN.left=0;DN.top=((1.0-uM)*g).toInt();DN.right=h;DN.bottom=g;break;case sE:DN.left=0;DN.top=0;DN.right=(uM*h).toInt();DN.bottom=g;break;case JE:DN.left=0;DN.top=0;DN.right=h;DN.bottom=(uM*g).toInt();break;}}} kB( h,[ returnRectangle]){var g=(yM!=null)?yM.width:0;var i=(yM!=null)?yM.height:0;return ME(h,g,i,returnRectangle);} mB( g, h){if(yM!=null&&g>=0.0&&h>=0.0&&g<yM.width&&h<yM.height)return this;return null;} YB( g){if(yM!=null)yM.mF(g,DN);}}class iE{static const  IF="none";static const  kG="touchPoint";}class xD{var font;var size;var color;var bold;var italic;var underline;var align;var leftMargin;var rightMargin;var indent;var leading;var letterSpacing=0;var gI=0;var hI=false;var pI=false;xD(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.leftMargin: 0,this.rightMargin: 0,this.indent: 0,this.leading: 0});}class oC{static const  SG=0;static const  YG=1;static const  gG=2;static const  lG=3;static const  yE=4;}class NG{static const  IF="none";}class OG{static const  UG="dynamic";}abstract class NB{static  PF( g){var h=wC.BH;if(h=="WebAudioApi")return BE.PF(g);if(h=="AudioElement")return AE.PF(g);return kE.PF(g);} get length; play([ loop=false, soundTransform]);static  KF( g){var m=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var i=m.firstMatch(g);var h=wC.FF;if(i==null)throw new ArgumentError("Unsupported file extension.");if(h.length==0)throw new UnsupportedError("This browser supports no known audio codec.");var j=i.group(1).toLowerCase();if(h.indexOf(j)==-1){var l=g.substring(0,g.length-j.length);var k=h[0];g="${l}${k}";}return g;}}class wB{static const  RC="center";static const  cG="end";static const  jG="justify";static const  gG="right";}class MG{static const  aG="pixel";}class wC{static var BH=SH();static var YD=YH();static var FF=ZH();static  SH(){var h=(YD!=null)?"WebAudioApi":"AudioElement";var g=mC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(FF.length==0)h="Mock";print("StageXL: supported audio engine is: ${h}");return h;}static  YH(){if(aE.AudioContext.supported)return new aE.AudioContext();return null;}static  ZH(){var g=new List<String>();var h=new mC.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("StageXL: supported audio types are: ${g}");return g;}}final  DE=new Map<String,HF>();class BE extends NB{var OL;BE(){if(wC.YD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  PF( n){var h=new BE();var k=NB.KF(n);var g=new hB.Completer<NB>();mC.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var m=wC.YD;m.decodeAudioData(j,( l){h.OL=l;g.complete(h);},(p){g.completeError(new StateError("Failed to decode audio."));});}).catchError((p){g.completeError(new StateError("Failed to load audio."));});return g.future;} get length{return OL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new XB();return new eI(this,loop,soundTransform);}}class iB{final  HL=new mC.ImageElement();final  uL=new List<hE>();static  PF( n, TB){var k=new hB.Completer<iB>();var g=new iB();switch (TB){case gC.VG:case gC.pC:mC.HttpRequest.getString(n).then((QB){var p=RI.parse(QB);var h=p["frames"];var w=p["meta"];if(h is List){for(var FB in h){var j=FB as Map;var i=j["filename"] as String;var l=NF(i);var m=new hE.zI(g,l,j);g.uL.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=NF(i);var m=new hE.zI(g,l,j);g.uL.add(m);}}g.HL..onLoad.listen((gB)=>k.complete(g))..onError.listen((gB)=>k.completeError(new StateError("Failed to load image.")))..src=bH(n,w["image"]);}).catchError((BC){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} get qH=>HL; u( h){for(int g=0;g<uL.length;g++ )if(uL[g].name==h)return new DB.CJ(uL[g]);throw new ArgumentError("TextureAtlasFrame not found: '${h}'");}}abstract class yD{ YB( g);}class BB{static const  XG="added";static const  BD="addedToStage";static const  wE="enterFrame";static const  rG="removed";static const  DD="removedFromStage";static const  AH="resize";var iM;var UO;var NO;var iL;var WO;var OO;var SO;BB( g,[ bubbles=false]){tN(g,bubbles);} tN( g,[ bubbles=false]){iM=g;UO=bubbles;NO=iC.UD;iL=null;WO=null;OO=false;SO=false;} get jD=>OO; get type=>iM; get bubbles=>UO; get NE=>true; get target=>iL;}class QG{}class yC extends PB{var upState;var overState;var downState;var hitTestState;var XE=true;var enabled=true;var gM;yC([this.upState,this.overState,this.downState,this.hitTestState]){LB(s.DF,LN);LB(s.XD,LN);LB(s.VD,LN);LB(s.KE,LN);gM=this.upState;} kB( g,[ returnRectangle]){if(gM!=null){BO.PE(gM.TO,g);return gM.kB(BO,returnRectangle);}return super.kB(g,returnRectangle);} mB( k, l){if(this.hitTestState!=null){var g=this.hitTestState.TO;var h=k-g.tB;var i=l-g.uB;var m=(g.d*h-g.c*i)/g.bC;var j=(g.a*i-g.b*h)/g.bC;if(this.hitTestState.mB(m,j)!=null)return this;}return null;} YB( g){if(gM!=null)g.nF(gM);} LN( g){if(g.type==s.XD){gM=upState;}else{gM=g.UC?downState:overState;}}}final  nE=new LG<List<t>>(()=>new List<t>());class uC{static const  TG="exactFit";static const  dG="noBorder";static const  mG="noScale";static const  zE="showAll";}class OC extends PB{var PL="";var bL=0x000000;var sL=null;var JM=NG.IF;var YM=MG.aG;var iM=OG.UG;var pM=false;var xM=false;var BN=0x000000;var IN=false;var MN=0x000000;var TN=0;var XN=0;var bN;var iN;var mN=true;var pN=100;var rN=100;var xN=null;var QL=null;OC([ text, textFormat]){if(text!=null)PL=text;if(textFormat!=null)JC=textFormat;else sL=new xD("Arial",12,0x000000);bN=new List<String>();iN=new List<PG>();} get type=>iM; get width=>pN; get height=>rN; set text( g){PL=g;mN=true;} set JC( g){sL=g;bL=sL.color;mN=true;} set wordWrap( g){pM=g;mN=true;} set width( g){pN=g;mN=true;} set height( g){rN=g;mN=true;} get MI{HP();return TN;} get VE{HP();return XN;} kB( g,[ returnRectangle]){return ME(g,pN,rN,returnRectangle);} mB( g, h){if(g>=0&&h>=0&&g<pN&&h<rN)return this;return null;} YB( g){HP();g.QL.drawImage(xN,0.0,0.0);} PP( p){var n=iG(p);bN.clear();iN.clear();if(pM==false){for(String h in PL.replaceAll('\r','').split('\n'))bN.add(h);}else{for(String h in PL.replaceAll('\r','').split('\n')){var g='';for(String j in h.split(' ')){var m=g;g=(g.length==0)?j:g+' '+j;if(QL.measureText(g).width>pN){if(m.length==0){bN.add(g);g='';}else{bN.add(m);g=j;}}}if(g.isEmpty==false){bN.add(g);}}}TN=0;XN=0;for(String g in bN){var k=QL.measureText(g);var l=0;if(sL.align==wB.RC||sL.align==wB.jG)l=(pN-k.width)/2;if(sL.align==wB.gG||sL.align==wB.cG)l=pN-k.width;var i=new PG(l,k.width,sL.size,n.FD,n.dD,0);iN.add(i);TN=VB.max(TN,i.width);XN=XN+i.height;}} HP(){if(mN){mN=false;var h=pN.ceil().toInt();var i=rN.ceil().toInt();if(xN==null){xN=new mC.CanvasElement(width:h,height:i);QL=xN.context2d;}if(xN.width!=h)xN.width=h;if(xN.height!=i)xN.height=i;var m=new StringBuffer()..write(sL.italic?"italic ":"normal ")..write("normal ")..write(sL.bold?"bold ":"normal ")..write("${sL.size}px ")..write("${sL.font},sans-serif");var j=m.toString();QL.font=j;QL.textAlign="start";QL.textBaseline="alphabetic";QL.fillStyle=CD(bL);PP(j);if(xM){QL.fillStyle=CD(BN);QL.fillRect(0,0,pN,rN);}else{QL.clearRect(0,0,pN,rN);}var k=sL.size;for(int g=0;g<bN.length;g++ ){var l=iN[g];QL.fillStyle=CD(bL);QL.fillText(bN[g],l.x,k);k+= l.height;}if(IN){QL.strokeStyle=CD(MN);QL.lineWidth=1;QL.strokeRect(0,0,pN,rN);}}}}class vD implements pB{final  TL;var cL=0.0;var pL=0.0;var yL=1;vD( g, h):TL=g{pL=VB.max(h,0.0001);} yB( h){var g=cL+h;while (g>=pL&&yL>0){cL=pL;yL-- ;TL();g-= pL;}cL=g;return (yL>0);} get totalTime=>pL; get currentTime=>cL;}abstract class pB{ yB( g);}class xC implements pB{final  YL=new List<pB>();var tL=0;var EM=0.0; add( g){if(g==null)return;if(this.contains(g))return;if(tL==YL.length){YL.add(g);}else{YL[tL]=g;}tL++ ;} remove( h){if(h==null)return;for(int g=0;g<tL;g++ ){if(identical(YL[g],h)){YL[g]=null;break;}}} contains( h){if(h==null)return false;for(int g=0;g<tL;g++ ){if(identical(YL[g],h)){return true;}}return false;} WE( h, i,[ transitionFunction]){var g=new bB(h,i,transitionFunction);add(g);return g;} fB( h, i){var g=new vD(h,i);add(g);return g;} yB( k){EM+= k;var j=tL;var h=0;for(int g=0;g<j;g++ ){var i=YL[g];if(i==null)continue;if(i.yB(k)==false){YL[g]=null;continue;}if(h!=g){YL[h]=i;YL[g]=null;}h++ ;}if(h!=j){for(int g=j;g<tL;g++ ){YL[h++ ]=YL[g];YL[g]=null;}tL=h;}return true;}}class QC{var ML; oH( g){if(ML!=null)return ML.containsKey(g)||ML.containsKey("${g}_CAPTURE");else return false;} LB( g, i(event),{ useCapture: false}){var h=cM(g,useCapture);var j=h.listen(i);return j;} dispatchEvent( g){YO(g,this,this,iC.UD);} YO( g, k, l, i){if(ML!=null){var j=(i==iC.oE)?"${g.type}_CAPTURE":g.type;var h=ML[j];if(h!=null){g.iL=k;g.WO=l;g.NO=i;g.OO=false;g.SO=false;h.KO(g);}}} cM( g, j){if(ML==null){ML=new Map<String,vC>();}var i=j?"${g}_CAPTURE":g;var h=ML[i];if(h==null)h=ML[i]=new vC(this,g,j);return h;}}class lE{final  WE;lE(this.WE);call( h, g){KM(h).tF(g);} get x=>KM("x"); get y=>KM("y"); get sB=>KM("scaleX"); get AC=>KM("scaleY"); get skewX=>KM("skewX"); get skewY=>KM("skewY"); get MC=>KM("pivotX"); get NC=>KM("pivotY"); get SB=>KM("rotation"); get alpha=>KM("alpha"); KM( h){var g=new qB(h);this.WE.KM(g);return g;}}class eI extends PC{var dL;var gL;var RL;var NM;var XM;eI( j, h, i){dL=j;RL=h;gL=i;var g=wC.YD;NM=g.createGain();NM.connect(g.destination,0,0);NM.gain.value=(gL!=null)?VB.pow(gL.volume,2):1;XM=g.createBufferSource();XM.buffer=dL.OL;XM.loop=h;XM.connect(NM,0,0);XM.start(0);} get FC=>gL; set FC( g){gL=g;NM.gain.value=(gL!=null)?VB.pow(gL.volume,2):1;} stop(){XM.stop(0);}}class QD{var GL;var UL;var eL;var mL;var vL;var AM;QD( g, h, i){GL=g;UL=h;eL=i;vL=null;AM=null;} get kind=>GL; get name=>UL; get ID=>AM; get error=>vL;zN( i){mL=i.then((g){AM=g;vL=null;},onError:( h){AM=null;vL=h.error;});}}class RD{var ZL;RD(){ZL=new Map<String,QD>();} sM( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(ZL.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");ZL[i]=g;} wN( i, g){var h="${i}.${g}";if(ZL.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return ZL[h];} jB( i, h){var g=new QD("BitmapData",i,h);g.zN(DB.PF(h));sM(g);} ZB( i, h){var g=new QD("Sound",i,h);g.zN(NB.PF(h));sM(g);} ED( j, h, i){var g=new QD("TextureAtlas",j,h);g.zN(iB.PF(h,i));sM(g);} rB( i, h){var g=new QD("Text",i,"");g.zN(new hB.Future.immediate(h));sM(g);} load(){var h=this.CI.map((i)=>i.mL);return hB.Future.wait(h).then((j){var g=this.aF;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get CI{return ZL.values.where((g)=>g.ID==null).toList();} get aF{return ZL.values.where((g)=>g.error!=null).toList();} u( g){return wN("BitmapData",g).ID;} lB( g){return wN("Sound",g).ID;} WC( g){return wN("TextureAtlas",g).ID;} rC( g){return wN("Text",g).ID;}}class IB{var xK;var BL;IB( h, g):xK=h,BL=g;IB.xI():this(0,0); clone()=>new IB(xK,BL); toString()=>"Point [x=${xK}, y=${BL}]"; get x=>xK; get y=>BL; get length=>VB.sqrt(xK*xK+BL*BL);set x( g){xK=g;}set y( g){BL=g;} add( g){return new IB(xK+g.x,BL+g.y);} subtract( g){return new IB(xK-g.x,BL-g.y);}bD( g){xK=g.x;BL=g.y;} ZF( g){return xK==g.x&&BL==g.y;}}class JB{var xK;var BL;var JL;var VL;JB( i, g, h, j):xK=i,BL=g,JL=h,VL=j;JB.xI():this(0,0,0,0); clone()=>new JB(xK,BL,JL,VL); toString()=>"Rectangle [x=${xK}, y=${BL}, width=${JL}, height=${VL}]"; get x=>xK; get y=>BL; get width=>JL; get height=>VL; get left=>xK; get top=>BL; get right=>xK+JL; get bottom=>BL+VL; get size=>new IB(JL,VL);set x( g){xK=g;}set y( g){BL=g;}set width( g){JL=g;}set height( g){VL=g;}set bottom( g){this.height=g-BL;}set left( g){xK=g;}set right( g){JL=g-xK;}set top( g){BL=g;} contains( g, h){return xK<=g&&BL<=h&&xK+JL>=g&&BL+VL>=h;} ZF( g){return xK==g.x&&BL==g.y&&JL==g.width&&VL==g.height;} get isEmpty{return JL==0&&VL==0;}bD( g){xK=g.x;BL=g.y;JL=g.width;VL=g.height;} union( g){var i=VB.min(this.left,g.left);var h=VB.min(this.top,g.top);var j=VB.max(this.right,g.right);var k=VB.max(this.bottom,g.bottom);return new JB(i,h,j-i,k-h);}}class HB{var yK,zK,CL,DL,FL,LL;var WL;HB( h, i, g, j, k, l):yK=h.toDouble(),zK=i.toDouble(),CL=g.toDouble(),DL=j.toDouble(),FL=k.toDouble(),LL=l.toDouble(),WL=(h*j-i*g).toDouble();HB.AJ():yK=1.0,zK=0.0,CL=0.0,DL=1.0,FL=0.0,LL=0.0,WL=1.0; clone(){return new HB(yK,zK,CL,DL,FL,LL);} VF(){var h=(DL/WL);var i=-(zK/WL);var g=-(CL/WL);var j=(yK/WL);var k=-(h*FL+g*LL);var l=-(i*FL+j*LL);return new HB(h,i,g,j,k,l);} get a=>yK; get b=>zK; get c=>CL; get d=>DL; get tB=>FL; get uB=>LL; get bC=>WL; nD( h){var i=h.x.toDouble();var g=h.y.toDouble();return new IB(i*yK+g*CL+FL,i*zK+g*DL+LL);} nO( h){var i=h.x.toDouble();var g=h.y.toDouble();return new IB(i*yK+g*CL+FL,i*zK+g*DL+LL);} concat( g){var m=yK;var w=zK;var FB=CL;var p=DL;var l=FL;var n=LL;var TB=WL;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var gB=g.tB;var QB=g.uB;var BC=g.bC;yK=(m*j+w*i).toDouble();zK=(m*k+w*h).toDouble();CL=(FB*j+p*i).toDouble();DL=(FB*k+p*h).toDouble();FL=(l*j+n*i+gB).toDouble();LL=(l*k+n*h+QB).toDouble();WL=(TB*BC).toDouble();} pH(){yK=1.0;zK=0.0;CL=0.0;DL=1.0;FL=0.0;LL=0.0;WL=1.0;} dF(){var j=yK;var m=zK;var l=CL;var k=DL;var h=FL;var i=LL;var g=WL;yK=(k/g).toDouble();zK=-(m/g).toDouble();CL=-(l/g).toDouble();DL=(j/g).toDouble();FL=-(yK*h+CL*i).toDouble();LL=-(zK*h+DL*i).toDouble();WL=(1.0/g).toDouble();} hD( h, i, g, k, j, l){yK=h.toDouble();zK=i.toDouble();CL=g.toDouble();DL=k.toDouble();FL=j.toDouble();LL=l.toDouble();WL=(yK*DL-zK*CL).toDouble();} bD( g){yK=g.a.toDouble();zK=g.b.toDouble();CL=g.c.toDouble();DL=g.d.toDouble();FL=g.tB.toDouble();LL=g.uB.toDouble();WL=g.bC.toDouble();} PE( h, g){var n=h.a;var FB=h.b;var QB=h.c;var w=h.d;var m=h.tB;var p=h.uB;var gB=h.bC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var BC=g.tB;var TB=g.uB;var dC=g.bC;yK=(n*k+FB*j).toDouble();zK=(n*l+FB*i).toDouble();CL=(QB*k+w*j).toDouble();DL=(QB*l+w*i).toDouble();FL=(m*k+p*j+BC).toDouble();LL=(m*l+p*i+TB).toDouble();WL=(gB*dC).toDouble();}}class wD{var AL;var NL;var aL;var qL;var FM;wD(){AL=new xC();NL=new List<jC>();aL=double.NAN;qL=PD.AF;FM=new jE(0);mC.window.requestAnimationFrame(RN);} get RE=>AL; RN( g){mC.window.requestAnimationFrame(RN);if(aL.isNaN)aL=g;if(aL>g)aL=g;var k=g-aL;var h=k/1000.0;var l=g/1000.0;if(k>=1){aL=g;FM.IL=h;qL.KO(FM);AL.yB(h);for(int i=0;i<NL.length;i++ ){var j=NL[i];j.RE.yB(h);j.vH(l,h);}}} QF( g){if(g.UE!=null){g.UE.HI(g);}NL.add(g);g.pO=this;} HI( g){if(g.UE==this){NL.remove(g);g.pO=null;}}}class PG{var FD;var dD;var height;var leading;var width;var x;PG(this.x,this.width,this.height,this.FD,this.dD,this.leading);}class dI extends PC{var RL;var gL;dI( i, h, g){RL=h;gL=g;} get FC=>gL;set FC( g){gL=g;} stop(){}}class AB extends nC{var iI=false;var XE=false;var QE=null;var IM=null;var RM=null;XO(){var i=this.fD;var j=this.lC;var m=this.visible;if(i!=null&&this.lC!=null){var h=hC.qG;if(h!=null){var g=TO.nD(i);if(g.x<h.left)g.x=h.left;if(g.x>h.right)g.x=h.right;if(g.y<h.top)g.y=h.top;if(g.y>h.bottom)g.y=h.bottom;i=TO.VF().nD(g);}var l=new IB(KN,PN).add(i).subtract(hC.nG);var k=TO.nD(l);this.visible=false;RM=j.mB(j.wH,j.xH);this.x=k.x;this.y=k.y;this.visible=m;}} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new JB.xI();super.kB(g,returnRectangle);if(IM!=null){returnRectangle=IM.FP(g).union(returnRectangle);}return returnRectangle;} mB( i, j){var h=null;if(this.QE!=null){var g=this.uF(this.QE);if(g!=null){var k=i*g.a+j*g.c+g.tB;var l=i*g.b+j*g.d+g.uB;if(this.QE.mB(k,l)!=null){h=this;}}}else{h=super.mB(i,j);if(h==null&&IM!=null){if(IM.KP(i,j)){h=this;}}}return h;}YB( g){if(IM!=null)IM.YB(g);super.YB(g);}}class PD<AD extends BB>{final  ML=new List<vC>();var xL=0;static var AF=new PD<jE>(); GN( g){for(int h=0;h<xL;h++ ){if(ML[h]==g)return;}if(xL==ML.length){ML.add(g);}else{ML[xL]=g;}xL++ ;} KO( j){j.NO=iC.UD;j.OO=false;j.SO=false;var k=xL;var i=0;for(int g=0;g<k;g++ ){var h=ML[g];if(h==null)continue;if(h.kM==0){ML[g]=null;continue;}j.iL=h.iL;j.WO=h.iL;h.KO(j);if(i!=g){ML[i]=h;ML[g]=null;}i++ ;}if(i!=k){for(int g=k;g<xL;g++ ){ML[i++ ]=ML[g];ML[g]=null;}xL=i;}}}class vC<AD extends BB> extends hB.Stream<AD>{final  iL;final  XL;final  BM;final  UM=new List<WG>();var kM=0;vC(this.iL,this.XL,this.BM); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new WG<AD>(this,h);if(kM==UM.length)UM.add(g);else UM[kM]=g;kM++ ;if(XL==BB.wE&&BM==false)PD.AF.GN(this);return g;} kN( h){for(int g=0;g<kM;g++ ){if(UM[g]==h){UM[g]=null;break;}}} KO( k){var j=kM;var h=0;for(int g=0;g<j;g++ ){var i=UM[g];if(i==null)continue;i.WM(k);if(h!=g){UM[h]=i;UM[g]=null;}h++ ;}if(h!=j){for(int g=j;g<kM;g++ ){UM[h++ ]=UM[g];UM[g]=null;}kM=h;}}}class oB{final  QL;final  jL=new List<HB>(100);final  GM=new List<double>(100);var TM=0;var cL=0.0;var eM=0.0;oB.yI( j,[ matrix]):QL=j{for(int h=0;h<100;h++ ){jL[h]=new HB.AJ();GM[h]=1.0;}if(matrix!=null)jL[0].bD(matrix);var g=jL[0];var i=GM[0];QL.setTransform(g.a,g.b,g.c,g.d,g.tB,g.uB);QL.globalAlpha=i;} get context=>QL; get currentTime=>cL; reset([ matrix, currentTime, deltaTime]){if(matrix!=null)jL[0].bD(matrix);TM=0;cL=?currentTime?currentTime:0.0;eM=?deltaTime?deltaTime:0.0;var g=jL[0];var h=GM[0];QL.setTransform(g.a,g.b,g.c,g.d,g.tB,g.uB);QL.globalAlpha=h;QL.clearRect(0,0,QL.canvas.width,QL.canvas.height);} nF( i){var k=TM;var l=TM+1;var m=jL[k];var h=jL[l];var w=GM[k];var p=GM[l]=i.jN*w;var g=m;var j=i.uN;var n=i.yN;TM=l;h.PE(i.TO,m);if(j!=null){if(j.kD==null){g=h;}else if(identical(j.kD,i)){g=h;}else if(identical(j.kD,i.parent)){g=m;}else{g=j.kD.uF(i);if(g==null)g=uE;else g.concat(h);}QL.save();QL.setTransform(g.a,g.b,g.c,g.d,g.tB,g.uB);j.YB(this);}QL.setTransform(h.a,h.b,h.c,h.d,h.tB,h.uB);QL.globalAlpha=p;if(n!=null){n.YB(this);}else{i.YB(this);}if(j!=null){QL.restore();}TM=k;}}class jE extends BB{var IL;jE( g):super(BB.wE,false){IL=g;} get NE=>false;}class s extends BB{static const  YC="click";static const  fG="doubleClick";static const  VD="mouseDown";static const  KE="mouseUp";static const  CF="mouseMove";static const  XD="mouseOut";static const  DF="mouseOver";static const  EF="mouseWheel";static const  GF="middleClick";static const  IH="middleMouseDown";static const  MH="middleMouseUp";static const  JF="rightClick";static const  QH="rightMouseDown";static const  TH="rightMouseUp";var HO,IO;var JO,LO;var ZO;var CN;var VN;var EN;var JN;var cO;var dO;var eO;s( g,[ bubbles=false]):super(g,bubbles){tN(g,bubbles);} tN( g,[ bubbles=false]){super.tN(g,bubbles);HO=IO=0;JO=LO=0;ZO=false;CN=false;VN=false;EN=false;JN=false;cO=0;dO=0;eO=0;}set fO( g){HO=g.x;IO=g.y;}set iO( g){JO=g.x;LO=g.y;} get eF=>HO; get fF=>IO; get UC=>ZO; get altKey=>CN; get ctrlKey=>EN; get shiftKey=>JN; get GD=>cO; get deltaX=>dO; get deltaY=>eO;}class GC extends BB{static const  GE="keyDown";static const  qE="keyUp";var CN;var EN;var JN;var NN;var VN;var aN;var eN;var hN;GC( g,[ bubbles=false]):super(g,bubbles){tN(g,bubbles);} tN( g,[ bubbles=false]){super.tN(g,bubbles);CN=false;EN=false;JN=false;NN=false;VN=false;aN=0;eN=0;hN=0;} get altKey=>CN; get ctrlKey=>EN; get shiftKey=>JN; get charCode=>aN; get keyCode=>eN; get keyLocation=>hN;}class gE extends BB{static const  eG="textInput";var PL="";gE( g,[ bubbles=false]):super(g,bubbles);}class WB extends BB{static const  pE="touchBegin";static const  rE="touchEnd";static const  vE="touchCancel";static const  BF="touchMove";static const  vG="touchOver";static const  zG="touchOut";var CO;var FO;var HO,IO;var JO,LO;var CN;var VN;var EN;var JN;var PO;var QO;var RO;WB( g,[ bubbles=false]):super(g,bubbles){tN(g,bubbles);} tN( g,[ bubbles=false]){super.tN(g,bubbles);CO=0;FO=false;HO=IO=0;JO=LO=0;CN=false;VN=false;EN=false;JN=false;PO=1.00;QO=0;RO=0;}set fO( g){HO=g.x;IO=g.y;}set iO( g){JO=g.x;LO=g.y;} get mD=>CO; get eF=>HO; get fF=>IO; get altKey=>CN; get ctrlKey=>EN; get shiftKey=>JN;}class SD extends PC{var fL;var SL;var RL;var gL;SD( g, i, h){fL=g;RL=i;gL=h;SL=g.SN(this);SL.loop=RL;this.FC=h;SL.play();} get FC=>gL; set FC( g){gL=g;if(SL!=null)SL.volume=(gL!=null)?gL.volume:1;} stop(){if(SL!=null){if(SL.ended==false)SL.pause();fL.aO(this);SL=null;}}}class kE extends NB{kE(){}static  PF( g){return new hB.Future<NB>.of(()=>new kE());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new XB();}return new dI(this,loop,soundTransform);}}class HC<AD extends BB>{final  XL;const HC(this.XL); forTarget( g,{ useCapture: false}){return g.cM(XL,useCapture);}}class iC{static const  oE=1;static const  UD=2;static const  hG=3;}abstract class nC extends PB{final  nL=new List<t>();var HM=true;var QM=true; o( g){if(g.parent==this){var h=nL.indexOf(g);nL.removeAt(h);nL.add(g);}else{iH(g,nL.length);}} iH( g, h){if(h<0||h>nL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){nL.removeAt(nL.indexOf(g));if(h>nL.length)h-- ;nL.insert(h,g);}else{g.TE();g.kO(this);nL.insert(h,g);g.dispatchEvent(new BB(BB.XG,true));if(this.lC!=null)rO(g,new BB(BB.BD));}} zB( h){var g=nL.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");GI(g);} GI( g){if(g<0||g>=nL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=nL[g];h.dispatchEvent(new BB(BB.rG,true));if(this.lC!=null)rO(h,new BB(BB.DD));h.kO(null);nL.removeAt(g);} contains( g){for(;g!=null;g=g.AO)if(g==this)return true;return false;} kB( n,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new JB.xI();if(nL.length==0)return super.kB(n,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var p=nL.length;for(int l=0;l<nL.length;l++ ){var m=nL[l];BO.PE(m.TO,n);var g=m.kB(BO,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} mB( p, w){var l=null;for(int j=nL.length-1;j>=0;j-- ){var i=nL[j];if(i.visible){var g=i.TO;var m=p-g.tB;var k=w-g.uB;var FB=(g.d*m-g.c*k)/g.bC;var n=(g.a*k-g.b*m)/g.bC;var h=i.mB(FB,n);if(h!=null){if(h is PB)if(h.UB)return HM?h:this;l=this;}}}return l;} YB( i){for(int h=0;h<nL.length;h++ ){var g=nL[h];if(!g.oN&&g.visible)i.nF(g);}} rO( g, j){g.dispatchEvent(j);if(g is nC){var i=new List<t>.from(g.nL,growable:false);for(int h=0;h<i.length;h++ )rO(i[h],j);}}}abstract class PB extends t{var kH=false;var UB=true;var vI=true;var tabIndex=0;static const  tG=const HC<s>(s.XD);static const  JH=const HC<s>(s.CF);static const  NH=const HC<s>(s.VD);static const  UH=const HC<s>(s.KE);static const  aH=const HC<s>(s.EF); get onMouseOut=>PB.tG.forTarget(this); get onMouseMove=>PB.JH.forTarget(this); get onMouseDown=>PB.NH.forTarget(this); get onMouseUp=>PB.UH.forTarget(this); get onMouseWheel=>PB.aH.forTarget(this);static const  cH=const HC<WB>(WB.BF);static const  dH=const HC<WB>(WB.rE);static const  eH=const HC<WB>(WB.vE); get onTouchMove=>PB.cH.forTarget(this); get onTouchEnd=>PB.dH.forTarget(this); get onTouchCancel=>PB.eH.forTarget(this);static const  fH=const HC<GC>(GC.qE);static const  gH=const HC<GC>(GC.GE); get onKeyUp=>PB.fH.forTarget(this); get onKeyDown=>PB.gH.forTarget(this);}class DB implements yD{var JL;var VL;var lL;var wL;var DM;var OM;var VM;var bM;var hM;var jM;var nM;var tM;var AN;var QL;DB( h, i,[ transparent=true, fillColor=0xFFFFFFFF]){JL=h.toInt();VL=i.toInt();lL=transparent;wL=0;VM=hM=0;bM=jM=0;DM=nM=JL;OM=tM=VL;var g=new mC.CanvasElement(width:JL,height:VL);QL=g.context2d;QL.fillStyle=lL?EH(fillColor):CD(fillColor);QL.fillRect(0,0,JL,VL);AN=g;}DB.BJ( g){if(g==null)throw new ArgumentError();JL=g.naturalWidth.toInt();VL=g.naturalHeight.toInt();lL=true;wL=0;VM=hM=0;bM=jM=0;DM=nM=JL;OM=tM=VL;AN=g;}DB.CJ( g){JL=g.BI.toInt();VL=g.AI.toInt();lL=true;wL=g.KI?2:1;VM=g.offsetX;bM=g.offsetY;DM=g.cF;OM=g.bF;hM=g.mH;jM=g.nH;nM=g.cF;tM=g.bF;AN=g.NI.qH;}static  PF( i){var h=new hB.Completer<DB>();var g=new mC.ImageElement();g.onLoad.listen((j)=>h.complete(new DB.BJ(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>JL; get height=>VL; clone(){var g=new DB(JL,VL,true,0);g.lH(this);return g;} lH( h,[ matrix=null]){var g=RP();var i=new oB.yI(g,matrix);h.YB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} clear(){var g=RP();g.clearRect(0,0,JL,VL);} YB( h){var g=h.context;switch (wL){case 0:g.drawImage(AN,VM,bM);break;case 1:g.drawImageScaledFromSource(AN,hM,jM,nM,tM,VM,bM,DM,OM);break;case 2:g.transform(0.0,-1.0,1.0,0.0,VM,bM+OM);g.drawImageScaledFromSource(AN,hM,jM,tM,nM,0.0,0.0,OM,DM);break;}} mF( QI, g){var gB=QI.context;if(g.width<=0.0||g.height<=0.0)return;switch (wL){case 0:gB.drawImageScaledFromSource(AN,g.x-VM,g.y-bM,g.width,g.height,g.x+VM,g.y+bM,g.width,g.height);break;case 1:var j=hM;var h=jM;var w=j+nM;var FB=h+tM;var l=hM-VM+g.x;var m=jM-bM+g.y;var TB=l+g.width;var QB=m+g.height;var p=(j>l)?j:l;var n=(h>m)?h:m;var BC=(w<TB)?w:TB;var YE=(FB<QB)?FB:QB;var k=BC-p;var i=YE-n;var ZE=VM-j+p;var dC=bM-h+n;if(k>0.0&&i>0.0){gB.drawImageScaledFromSource(AN,p,n,k,i,ZE,dC,k,i);}break;case 2:var j=hM;var h=jM;var w=j+tM;var FB=h+nM;var l=hM+bM-g.y+OM-g.height;var m=jM-VM+g.x;var TB=l+g.height;var QB=m+g.width;var p=(j>l)?j:l;var n=(h>m)?h:m;var BC=(w<TB)?w:TB;var YE=(FB<QB)?FB:QB;var k=YE-n;var i=BC-p;var ZE=VM-h+n;var dC=bM+w-BC;if(k>0.0&&i>0.0){gB.transform(0.0,-1.0,1.0,0.0,ZE,dC+i);gB.drawImageScaledFromSource(AN,p,n,i,k,0,0,i,k);}break;}} RP(){if(QL==null){var g=new mC.CanvasElement(width:JL,height:VL);QL=g.context2d;switch (wL){case 0:QL.drawImage(AN,VM,bM);break;case 1:QL.drawImageScaledFromSource(AN,hM,jM,nM,tM,VM,bM,DM,OM);break;case 2:QL.transform(0.0,-1.0,1.0,0.0,VM,bM+OM);QL.drawImageScaledFromSource(AN,hM,jM,tM,nM,0.0,0.0,OM,DM);QL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}wL=0;VM=hM=0;bM=jM=0;DM=nM=JL;OM=tM=VL;AN=g;}return QL;}}class CE extends TD implements pB{static const  bG='TIME_OUT';var PM=false;var cL=0.0;var pL=0.0;var mM;var rM=true;CE( g, h,[ direction=TD.WD]):super(h,direction){if(g<=0)throw new ArgumentError('Time must be greater than zero');pL=g;TF();} yB( g){if(PM&&ratio>0.0){ratio=ratio-g/totalTime;if(ratio==0.0)pause();}return true;} start(){PM=true;} pause(){PM=false;} reset([ time=0.0]){pause();time=VB.max(time,0.0);if(time!=0.0){pL=time;TF();}ratio=1.0;} ZD( g, h){mM[g]=h/totalTime;} TF(){mM=new Map<String,num>();ZD(CE.bG,0);} get totalTime=>pL; get JI=>ratio*totalTime; set ratio( i){var h=ratio;super.ratio=i;if(rM){mM.forEach((j,g){if(g<h&&g>=ratio)dispatchEvent(new BB(j));});}}}typedef  zC( ratio);typedef  RG<AD extends BB>( event);class WG<AD extends BB> extends hB.StreamSubscription<AD>{var MM;var WM;var ZM;var dM;WG(this.MM,this.WM){ZM=0;dM=false;} cancel(){if(dM==false){MM.kN(this);dM=true;WM=null;}} onError( g( error)){} get VO=>ZM>0; pause([ resumeSignal]){ZM++ ;if(resumeSignal!=null){resumeSignal.whenComplete(resume);}} resume(){if(VO==false){throw new StateError("Subscription is not paused.");}ZM-- ;}} CD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";} iG( g){if(DE.containsKey(g)==false){DE[g]=new HF(g);}return DE[g];}final  uE=new HB.AJ();class xE{static var GH=iE.IF;static var LH=new hB.StreamController<String>();static var OH=LH.stream.asBroadcastStream();static  get VH=>GH;}abstract class t extends QC implements yD{static var yG=0;var zM=yG++ ;var xK=0.0;var BL=0.0;var KN=0.0;var PN=0.0;var QN=1.0;var WN=1.0;var ZN=0.0;var cN=0.0;var fN=0.0;var jN=1.0;var nN=true;var oN=false;var uN=null;var yN=null;var UL="";var AO=null;final  BO=new HB.AJ();final  GO=new HB.AJ();var MO=true; get x=>xK; get y=>BL; get MC=>KN; get NC=>PN; get sB=>QN; get AC=>WN; get skewX=>ZN; get skewY=>cN; get SB=>fN; get alpha=>jN; get visible=>nN; get name=>UL; get parent=>AO; get fD{var g=this.lC;return (g!=null)?this.cC(g.yO):null;} get wH{var g=this.fD;return (g!=null)?g.x:0.0;} get xH{var g=this.fD;return (g!=null)?g.y:0.0;} get root{var g=this;while (g.AO!=null)g=g.AO;return g;} get lC{var g=this.root;if(g is jC)return g;return null;}set x( g){xK=g.toDouble();MO=true;}set y( g){BL=g.toDouble();MO=true;}set MC( g){KN=g.toDouble();MO=true;}set NC( g){PN=g.toDouble();MO=true;}set sB( g){QN=g.toDouble();MO=true;}set AC( g){WN=g.toDouble();MO=true;}set skewX( g){ZN=g.toDouble();MO=true;}set skewY( g){cN=g.toDouble();MO=true;}set SB( g){fN=g.toDouble();MO=true;}set alpha( g){jN=g.toDouble();MO=true;}set visible( g){nN=g;MO=true;}set mask( g){uN=g;} setTransform( h, g,[ scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY]){MO=true;xK=h.toDouble();BL=g.toDouble();if(scaleX!=null){QN=scaleX.toDouble();if(scaleY!=null){WN=scaleY.toDouble();if(rotation!=null){fN=rotation.toDouble();if(skewX!=null){ZN=skewX.toDouble();if(skewY!=null){cN=skewY.toDouble();if(pivotX!=null){KN=pivotX.toDouble();if(pivotY!=null)PN=pivotY.toDouble();}}}}}}} get width=>kB(TO).width; get height=>kB(TO).height; set width( h){this.sB=1;var g=this.width;this.sB=(g!=0.0)?h/g:1.0;} set height( h){this.AC=1;var g=this.height;this.AC=(g!=0.0)?h/g:1.0;} TE(){if(AO!=null)AO.zB(this);} get TO{if(MO){MO=false;var j=ZN+fN;var i=cN+fN;if(j==0.0&&i==0.0){GO.hD(QN,0.0,0.0,WN,xK-KN*QN,BL-PN*WN);}else{var g,l,k,h;var m=VB.cos(j);var n=VB.sin(j);if(j==i){g=QN*m;l=QN*n;k=-WN*n;h=WN*m;}else{g=QN*VB.cos(i);l=QN*VB.sin(i);k=-WN*n;h=WN*m;}var w=xK-(KN*g+PN*k);var p=BL-(KN*l+PN*h);GO.hD(g,l,k,h,w,p);}}return GO;} uF( h){if(h==AO)return TO.clone();if(h.AO==this)return h.TO.VF();var j=new HB.AJ();var g=this;while (g!=h&&g.AO!=null){j.concat(g.TO);g=g.AO;}if(h==null&&g!=null){j.concat(g.TO);g=null;}if(g==h)return j;var k=new HB.AJ();var i=h;while (i!=this&&i.AO!=null){k.concat(i.TO);i=i.AO;}k.dF();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new JB.xI();returnRectangle.x=g.tB;returnRectangle.y=g.uB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} mB( g, h){if(kB(uE).contains(g,h))return this;return null;} cC( h){BO.pH();for(t g=this;g!=null;g=g.AO)BO.concat(g.TO);BO.dF();return BO.nD(h);} dispatchEvent( h){var g=null;if(h.NE||h.bubbles)for(t j=AO;j!=null;j=j.AO)if(j.oH(h.type)){if(g==null)g=nE.DI() as List<t>;g.add(j);}if(h.NE&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.jD==false)g[i].YO(h,this,g[i],iC.oE);if(h.jD==false)YO(h,this,this,iC.UD);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.jD==false)g[i].YO(h,this,g[i],iC.hG);if(g!=null){g.clear();nE.FI(g);}} kO( h){for(var g=h;g!=null;g=g.AO)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");AO=h;} YB( g);}class IC{static const  uG="B";static const  xG="BL";static const  CH="BR";static const  YG="L";static const  gG="R";static const  FH="T";static const  HH="TL";static const  KH="TR";static const  IF="";}class SC extends pB{final  HN;final  ON;final  UN;var YN;var dN;var gN;var lN;var pL;var cL;var qN;var sN;var vN;SC( g, h, i,[ transitionFunction]):HN=g,ON=h,UN=(transitionFunction!=null)?transitionFunction:OB.TC{YN=g;cL=0.0;pL=VB.max(0.0001,i);qN=0.0;sN=false;vN=false;} yB( i){if(cL<pL||vN==false){cL=cL+i;if(cL>pL)cL=pL;if(cL>=0.0){if(vN==false){vN=true;if(dN!=null)dN();}var g=cL/pL;var h=UN(g);YN=HN+h*(ON-HN);if(gN!=null)gN(sN?YN.round():YN);if(lN!=null&&cL==pL)lN();}}return cL<pL;} get iD=>HN; get lD=>ON; get totalTime=>pL; get currentTime=>cL;set VC( g){if(vN==false)cL=cL+qN-g;qN=g;} set onStart( g()){dN=g;} set LC( g( value)){gN=g;} set onComplete( g()){lN=g;}} EH( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class HF{var fontStyle;var FD=0;var dD=0;var height=0;HF( j){this.fontStyle=j;var h=new mC.Element.tag("span");h.style.font=this.fontStyle;h.text="Hg";var g=new mC.Element.tag("div");g.style.display="inline-block";g.style.width="1px";g.style.height="0px";var i=new mC.Element.tag("div");i.append(g);i.append(h);mC.document.body.append(i);try {g.style.verticalAlign="baseline";this.FD=g.offsetTop-h.offsetTop;g.style.verticalAlign="bottom";this.height=g.offsetTop-h.offsetTop;this.dD=height-FD;}catch (k){}finally {i.remove();}}}class OB{static  TC( g){return g;}static  OF( g){return g*g*g;}static  xB( g){g=1.0-g;return 1.0-g*g*g;}static  hH( g){if(g==0.0||g==1.0)return g;return VB.pow(2.0,-10.0*g)*VB.sin((g-0.3/4.0)*(2.0*VB.PI)/0.3)+1;}}class qC{static const  EE="auto";static const  PH="stop";static const  LE="once";} RH( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}class fI extends zD{final  DO;fI( i, g, h, j):DO=new JB(i,g,h,j); YB( h){var g=h.context;g.beginPath();g.rect(DO.x,DO.y,DO.width,DO.height);g.clip();}}class LF{var target=null;var UC=false;var OE=0;var GD=0;var iF,jF;var gF,hF;LF(this.iF,this.jF,this.gF,this.hF);} ZC( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class qB{final  SE;var iD=double.NAN;var lD=double.NAN;qB(this.SE); tF( g){this.lD=g.toDouble();} get uH=>!iD.isNaN&&!lD.isNaN; bO( g){switch (SE){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.MC;case 'pivotY':return g.NC;case 'scaleX':return g.sB;case 'scaleY':return g.AC;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.SB;case 'alpha':return g.alpha;default:return 0.0;}} qO( g, h){switch (SE){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.MC=h;break;case 'pivotY':g.NC=h;break;case 'scaleX':g.sB=h;break;case 'scaleY':g.AC=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.SB=h;break;case 'alpha':g.alpha=h;break;}}}class WH{static var XH=0;var mD=XH++ ;var target=null;var gD=false;WH(this.target,this.gD);}class jC extends nC{var xN;var QL;var gO,hO;var pN,rN;var jO,lO;var mO;var oO;var pO;var AL;var jI=30;var sO;var tO;var uO;var vO;var wO;var xO;var yO;var zO;var AP;var BP;var CP;var DP;var EP;jC( h, g){UL=h;xN=g;xN.focus();QL=g.context2d;pN=gO=g.width;rN=hO=g.height;jO=g.clientWidth;lO=g.clientHeight;mO=new HB.AJ();oO=new HB.AJ();pO=null;AL=new xC();tO=new oB.yI(QL);uO=qC.EE;vO=uC.zE;wO=IC.IF;AP=[new LF(s.VD,s.KE,s.YC,s.fG),new LF(s.IH,s.MH,s.GF,s.GF),new LF(s.QH,s.TH,s.JF,s.JF)];xO=vB.HE;zO=null;yO=new IB(0,0);CP=new s(s.YC,true);hC.DH.listen(DH);xN.onMouseDown.listen(LN);xN.onMouseUp.listen(LN);xN.onMouseMove.listen(LN);xN.onMouseOut.listen(LN);xN.onMouseWheel.listen(LP);BP=new Map<int,WH>();EP=new WB(WB.pE,true);xE.OH.listen(MP);MP(null);DP=new GC(GC.GE,true);xN.onKeyDown.listen(NP);xN.onKeyUp.listen(NP);xN.onKeyPress.listen(OP);} get UE=>pO; get RE=>AL; get fD=>yO; get focus=>sO;set II( g){uO=g;} get align=>wO;QP(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){QP();}set y( g){QP();}set MC( g){QP();}set NC( g){QP();}set sB( g){QP();}set AC( g){QP();}set skewX( g){QP();}set skewY( g){QP();}set SB( g){QP();}set alpha( g){QP();}set width( g){QP();}set height( g){QP();}vH( g, h){if(uO==qC.EE||uO==qC.LE){SP();tO.reset(oO,g,h);YB(tO);if(uO==qC.LE)uO=qC.PH;}}SP(){var m=xN.getBoundingClientRect();var n=xN.clientLeft+m.left;var p=xN.clientTop+m.top;var k=xN.clientWidth;var l=xN.clientHeight;if(k==0||l==0)return;var g=gO;var h=hO;var i=0;var j=0;switch (vO){case uC.TG:g=gO;h=hO;break;case uC.dG:if(k*hO>l*gO){h=(gO*l)~/k;}else{g=(hO*k)~/l;}break;case uC.mG:g=k;h=l;break;case uC.zE:if(k*hO>l*gO){g=(hO*k)~/l;}else{h=(gO*l)~/k;}break;}switch (wO){case IC.uG:i=(gO-g+1)~/2;j=(hO-h);break;case IC.xG:i=0;j=(hO-h);break;case IC.CH:i=(gO-g);j=(hO-h);break;case IC.YG:i=0;j=(hO-h+1)~/2;break;case IC.gG:i=(gO-g);j=(hO-h+1)~/2;break;case IC.FH:i=(gO-g+1)~/2;j=0;break;case IC.HH:i=0;j=0;break;case IC.KH:i=(gO-g+1);j=0;break;case IC.IF:i=(gO-g+1)~/2;j=(hO-h+1)~/2;break;}oO.hD(1.0,0.0,0.0,1.0,0-i,0-j);mO.hD(g/k,0.0,0.0,h/l,i-n,j-p);if(pN!=g||rN!=h){xN.width=pN=g;xN.height=rN=h;}if(jO!=k||lO!=l){jO=k;lO=l;dispatchEvent(new BB(BB.AH));}}DH( g){xN.style.cursor=hC.MF(xO);}LN( j){j.preventDefault();var n=new DateTime.now().millisecondsSinceEpoch;var w=j.button;var h=null;var i=mO.nO(j.client);var m=null;if(w<0||w>2)return;if(j.type=="mousemove"&&yO.ZF(i))return;var g=AP[w];yO=i;if(hC.tE!=null)hC.tE.XO();if(j.type!="mouseout")h=mB(i.x,i.y) as PB;var l=vB.HE;if(h is AB)if(h.XE)l=vB.IE;if(h is yC)if(h.XE)l=vB.IE;if(xO!=l){xO=l;xN.style.cursor=hC.MF(l);}if(zO!=null&&zO!=h){zO.dispatchEvent(CP..tN(s.XD,true)..fO=(zO.lC!=null)?zO.cC(i):new IB.xI()..iO=i..ZO=g.UC);zO=null;}if(h!=null&&h!=zO){h.dispatchEvent(CP..tN(s.DF,true)..fO=h.cC(i)..iO=i..ZO=g.UC);zO=h;}var k=null;var p=false;var FB=false;if(j.type=="mousedown"){k=g.iF;if(h!=g.target||n>g.OE+500)g.GD=0;g.UC=true;g.target=h;g.OE=n;g.GD++ ;}if(j.type=="mouseup"){k=g.jF;g.UC=false;p=(g.target==h);FB=p&&g.GD.isEven&&(n<g.OE+500);}if(j.type=="mousemove"){k=s.CF;}if(k!=null&&h!=null){m=h.cC(i);h.dispatchEvent(CP..tN(k,true)..fO=m..iO=i..ZO=g.UC..cO=g.GD);if(p){if(FB&&h.kH){h.dispatchEvent(CP..tN(g.hF,true)..fO=m..iO=i..ZO=g.UC);}else{h.dispatchEvent(CP..tN(g.gF,true)..fO=m..iO=i..ZO=g.UC);}}}}LP( h){var g=mO.nO(h.client);var i=mB(g.x,g.y) as PB;if(i!=null){i.dispatchEvent(CP..tN(s.EF,true)..fO=i.cC(g)..iO=g..dO=h.deltaX..eO=h.deltaY);if(CP.jD)h.preventDefault();}}var TP=[] ;MP( h){TP.forEach((g)=>g.cancel());if(xE.VH==iE.kG){TP=[xN.onTouchStart.listen(VP),xN.onTouchEnd.listen(VP),xN.onTouchMove.listen(VP),xN.onTouchEnter.listen(VP),xN.onTouchLeave.listen(VP),xN.onTouchCancel.listen(VP)];}}VP( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=mO.nO(m.client);var h=mB(i.x,i.y) as PB;var g=BP.containsKey(l)?BP[l]:new WH(h,BP.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(EP..tN(WB.zG,true)..fO=(g.target.lC!=null)?g.target.cC(i):new IB.xI()..iO=i..CO=g.mD..FO=g.gD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(EP..tN(WB.vG,true)..fO=h.cC(i)..iO=i..CO=g.mD..FO=g.gD);g.target=h;}var k=null;if(j.type=="touchstart"){BP[l]=g;k=WB.pE;}if(j.type=="touchend"){BP.remove(l);k=WB.rE;}if(j.type=="touchcancel"){BP.remove(l);k=WB.vE;}if(j.type=="touchmove"){k=WB.BF;}if(k!=null&&h!=null){h.dispatchEvent(EP..tN(k,true)..fO=h.cC(i)..iO=i..CO=g.mD..FO=g.gD);}}}NP( g){g.preventDefault();var h=null;if(g.type=="keyup")h=GC.qE;if(g.type=="keydown")h=GC.GE;DP..tN(h,true)..CN=g.altKey..EN=g.ctrlKey..JN=g.shiftKey..aN=g.charCode..eN=g.keyCode..hN=oC.SG;if(g.keyLocation==mC.KeyLocation.LEFT)DP.hN=oC.YG;if(g.keyLocation==mC.KeyLocation.RIGHT)DP.hN=oC.gG;if(g.keyLocation==mC.KeyLocation.NUMPAD)DP.hN=oC.lG;if(g.keyLocation==mC.KeyLocation.JOYSTICK)DP.hN=oC.yE;if(g.keyLocation==mC.KeyLocation.MOBILE)DP.hN=oC.yE;if(sO!=null)sO.dispatchEvent(DP);}OP( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new gE(gE.eG,true);h.PL=new String.fromCharCodes([i]);if(sO!=null)sO.dispatchEvent(h);}} NF( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);} bH( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";}class bB implements pB{final  GP;final  UN;final  IP=new List<qB>();var dN;var gN;var lN;var JP;var pL;var cL;var qN;var sN;var vN;bB( g, h,[ transitionFunction]):GP=g,UN=(?transitionFunction)?transitionFunction:OB.TC{JP=new lE(this);cL=0.0;pL=VB.max(0.0001,h);qN=0.0;sN=false;vN=false;} get cB=>JP; KM( g){if(GP!=null&&vN==false){IP.add(g);}} yB( m){if(cL<pL||vN==false){cL=cL+m;if(cL>pL){cL=pL;}if(cL>=0.0){if(vN==false){vN=true;for(int h=0;h<IP.length;h++ ){var g=IP[h];g.iD=g.bO(GP);}if(dN!=null){dN();}}var k=cL/pL;var l=UN(k).toDouble();for(int h=0;h<IP.length;h++ ){var g=IP[h];if(g.uH){var i=g.iD.toDouble();var n=g.lD.toDouble();var j=i+l*(n-i);g.qO(GP,sN?j.round():j);}}if(gN!=null){gN();}if(lN!=null&&cL==pL){lN();}}}return cL<pL;} get totalTime=>pL; get currentTime=>cL;set VC( g){if(vN==false)cL=cL+qN-g;qN=g;} set onStart( g()){dN=g;} set LC( g()){gN=g;} set onComplete( g()){lN=g;}} ME( g, m, n, j){m=m.toDouble();n=n.toDouble();var dC=0.0;var BC=0.0;var FB=m*g.a;var gB=m*g.b;var QB=m*g.a+n*g.c;var w=m*g.b+n*g.d;var TB=n*g.c;var p=n*g.d;var h=dC;if(h>FB)h=FB;if(h>QB)h=QB;if(h>TB)h=TB;var i=BC;if(i>gB)i=gB;if(i>w)i=w;if(i>p)i=p;var l=dC;if(l<FB)l=FB;if(l<QB)l=QB;if(l<TB)l=TB;var k=BC;if(k<gB)k=gB;if(k<w)k=w;if(k<p)k=p;if(j==null)j=new JB.xI();j.x=g.tB+h;j.y=g.uB+i;j.width=l-h;j.height=k-i;return j;}//@ sourceMappingURL=escape.dart.map
