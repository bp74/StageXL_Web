import "dart:json" as WI;import "dart:web_audio" as iE;import "dart:async" as jB;import "dart:math" as WB;import "dart:html" as rC;class XI{static const  YI="Chrome";static const  ZI="Firefox";static const  aI="Internet Explorer";static const  bI="Safari";final  sH;final  minimumVersion;const XI(this.sH,[this.minimumVersion]);}class cI{final  name;const cI(this.name);}class EG extends AB{var LJ;var UJ;var bJ;var jJ;var pJ;EG(){o(new EB(HB.MB.u("InfoBox")));UJ=new QC();UJ.KC=new EE("Arial",35,0xFFFFFF,bold:true,align:zB.TC);UJ.width=220;UJ.height=40;UJ.wordWrap=false;UJ.text="Level 1";UJ.x=20;UJ.y=115;UJ.SB=-2*WB.PI/180;o(UJ);jJ=new QC();jJ.KC=new EE("Arial",25,0xFFFFFF,bold:true,align:zB.TC);jJ.width=220;jJ.height=30;jJ.wordWrap=false;jJ.text="40";jJ.x=-jJ.width/2;jJ.y=-jJ.height/2;jJ.SB=-2*WB.PI/180;pJ=new AB();pJ.o(jJ);pJ.x=150;pJ.y=172;o(pJ);var g=HB.yD(3,0);g.x=110;g.y=171;g.SB=-2*WB.PI/180;g.hB=g.pB=0.6;o(g);} set level( g){LJ=g;UJ.text="Level ${LJ}";} set XF( g){bJ=g;jJ.text="${bJ}";}}class GG extends AB{var wJ;var DK;var IK;var MK;var PK;var QK;var RK;var SK;var TK;var VK;var WK;var XK;var YK;var ZK;var aK;var bK;var dK;var eK;var fK;var gK;GG( CB, p, QB, m, n, v, k){SK=new WB.Random();TK=DC.BD;VK=k;wJ=CB;DK=p;IK=QB;MK=m;PK=n;QK=v;RK=k.length;ZK=new List<JB>();bK=new AB();dK=new AB();eK=new AB();fK=new AB();gK=new AB();o(bK);o(dK);o(eK);o(fK);o(gK);dK.UB=false;eK.UB=false;fK.UB=false;gK.UB=false;zH();AI();yH();aK=true;var l=new AD();this.mask=new CE.CJ(0.0,0.0,500.0,500.0);for(int g=0;g<10;g++ ){for(int h=0;h<10;h++ ){var i=XK[g+h*10];i.x=g*50+25;i.y=h*50+25-550;i.sB(bK,dK,eK);var j=new UC(i.y,h*50+25,0.4,OB.AC);j.XC=g*0.03;j.MC=(TB){i.y=TB;};j.onComplete=(){if(l.lD()==100){oK();aK=false;ZK.clear();this.mask=null;}};q.add(j);}}LB(s.bD,pK);} AG( g){if(g==DC.wD)TK=g;if(g==DC.xD&&TK==DC.BD){TK=g;if(aK==false)dispatchEvent(new bB(bB.zD,null));}} dF(){this.mask=new CE.CJ(0.0,0.0,500.0,500.0);for(int h=0;h<10;h++ ){for(int i=0;i<10;i++ ){var g=XK[i+h*10];g.eB=false;g.LC=false;g.GB=w.PD;g.sB(bK,dK,eK);var j=new UC(g.y,500+h*50+25,0.5,OB.AC);j.XC=i*0.1;j.MC=(k){g.y=k;};q.add(j);}}} zH(){YK=new List<OD>();for(int h=0;h<DK;h++ ){var g=new OD(h);g.SB=(SK.nextInt(30)-15)*WB.PI/180;g.x=300-(90*DK)/2+h*90+SK.nextInt(20)-10;g.y=550;YK.add(g);fK.o(g);}} bF( g, h){var i=0;var j=XK[g+h*10];if(j.direction==0){var l=(g>0)?XK[g-1+h*10]:null;var m=(g<9)?XK[g+1+h*10]:null;if(j.cC(l))i++ ;if(j.cC(m))i++ ;}else{var k=(h>0)?XK[g+(h-1)*10]:null;var n=(h<9)?XK[g+(h+1)*10]:null;if(j.pC(k))i++ ;if(j.pC(n))i++ ;}return i;} ZF(){for(int h=0;h<10;h++ ){for(int g=0;g<10;g++ ){var k=XK[g+h*10];var i=RK*2;while (bF(g,h)==2&&i>0){if(i%2==0){k.direction=1-k.direction;i-- ;}else{var m=0;for(int j=0;j<VK.length;j++ )if(k.color==VK[j])m=j;k.color=VK[(m+1)%VK.length];i-- ;}}}}var l=false;for(int h=0;h<10;h++ )for(int g=0;g<10;g++ )l=l||(bF(g,h)==2);return l;} rF(){for(int g=0;g<10;g++ )for(int h=1;h<9;h++ )if(XK[(h-1)+g*10].jD(XK[h+g*10])&&XK[h+g*10].jD(XK[(h+1)+g*10]))return true;for(int h=0;h<10;h++ )for(int g=1;g<9;g++ )if(XK[h+(g-1)*10].jD(XK[h+g*10])&&XK[h+g*10].jD(XK[h+(g+1)*10]))return true;return false;} vK( j, l, k){for(int g=0;g<20;g++ ){var h=wJ~/k;var i=l*h+SK.nextInt(h);if(WK[i].GB==w.PD){WK[i].GB=j;return;}}} AI(){WK=new List<KB>();for(int g=0;g<wJ;g++ ){var i=VK[SK.nextInt(VK.length)];var h=SK.nextInt(2);WK.add(new KB(i,h));}for(int g=0;g<DK*2;g++ )vK("Lock${(g%DK)+1}",g,DK*2);for(int g=0;g<IK;g++ )vK(w.RB,g,IK);for(int g=0;g<MK;g++ )vK(w.EC,g,MK);for(int g=0;g<PK;g++ )vK(w.mE,g,PK);for(int g=0;g<QK;g++ )vK(w.nE,g,QK);} yH(){XK=new List<KB>();var g=true;while (g){XK.clear();for(int h=0;h<100;h++ ){var j=VK[SK.nextInt(VK.length)];var i=SK.nextInt(2);XK.add(new KB(j,i));}g=ZF();}} wF(){if(aK||TK!=DC.BD)return false;var l=true;aK=true;while (l){for(int k=0;k<XK.length;k++ ){var g=XK[k];g.eB=false;g.LC=false;g.sB(bK,dK,eK);g.color=VK[SK.nextInt(VK.length)];g.direction=SK.nextInt(2);}l=ZF()||(rF()==false);}var p=fB.MB.nB("BonusUniversal");p.play();var m=new AD();for(int i=0;i<10;i++ ){for(int j=0;j<10;j++ ){var g=XK[i+j*10];g.xF=0.0;var h=new UC(0.0,1.0,0.2,OB.VC);h.XC=i*0.06;h.MC=(n){g.xF=n;};h.onStart=(){g.sB(bK,dK,eK);};h.onComplete=(){if(m.lD()==100){oK();wK();ZK.clear();}};q.add(h);}}return true;} oK(){for(int i=0;i<10;i++ ){for(int h=0;h<10;h++ ){var g=XK[h+i*10];var l=(h<9)?XK[h+1+i*10]:null;var m=(i<9)?XK[h+(i+1)*10]:null;var j=false;var k=false;if(g.cC(l)){j=true;k=(g.GB==w.RB||l.GB==w.RB);}if(g.pC(m)){j=true;k=(g.GB==w.RB||m.GB==w.RB);}if(g.eB!=j||g.LC!=k){g.eB=j;g.LC=k;g.sB(bK,dK,eK);}}}} yK( v, l, n, k, m, p){aK=true;v.lD(k);var i=1;for(int h=0;h<k;h++ ){var g=XK[l+h*m+(n+h*p)*10];if(g.GB==w.mE)i=i*2;if(g.GB==w.nE)i=i*5;var QB=l+h*m;var TB=n+h*p;q.gB((){g.empty=true;g.sB(bK,dK,eK);var CB=fB.MB.nB("ChainBlast");CB.play();var j=new kE(g.color,g.direction);j.x=QB*50;j.y=TB*50;q.add(j);gK.o(j);KI(g);if(v.cF()==0)AL();},0.1+h*0.1);}dispatchEvent(new bB(bB.kE,{"Length":k,"Factor":i}));} wK(){aK=false;var j=new AD();for(int h=0;h<10;h++ ){for(int i=0;i<10;){var g=1;while (i+g<10&&XK[i+g-1+h*10].cC(XK[i+g+h*10]))g++ ;if(g>=3)yK(j,i,h,g,1,0);i=i+g;}}for(int i=0;i<10;i++ ){for(int h=0;h<10;){var g=1;while (h+g<10&&XK[i+(h+g-1)*10].pC(XK[i+(h+g)*10]))g++ ;if(g>=3)yK(j,i,h,g,0,1);h=h+g;}}if(j.value==0){if(TK==DC.wD)dispatchEvent(new bB(bB.lE,null));if(TK==DC.xD)dispatchEvent(new bB(bB.zD,null));if(TK==DC.BD&&rF()==false)wF();}} KI( h){if(h.GB.indexOf("Lock")==0){var k=int.parse(h.GB.substring(4,5))-1;var j=YK[k];var g=HB.AE(h.GB);g.x=h.x;g.y=h.y;o(g);var i=new cB(g,0.5,OB.AC);i.dB.x.aB(j.x);i.dB.y.aB(j.y-10);i.onComplete=()=>CC(g);q.add(i);q.gB(()=>GI(k),0.5);}} GI( k){var h=YK[k];var i;if(h.MD){i=new bB(bB.QD,{"Type":"SingleLocked","Position":new JB(h.x+20,h.y)});var l=fB.MB.nB("Unlock");l.play();}else{i=new bB(bB.QD,{"Type":"SingleUnlocked","Position":new JB(h.x+20,h.y)});}dispatchEvent(i);h.MD=false;h.vF(false);var j=true;for(int g=0;g<YK.length;g++ )j=j&&(YK[g].MD==false);if(j){var m=fB.MB.nB("BonusAllUnlock");m.play();for(int g=0;g<YK.length;g++ ){YK[g].MD=true;q.gB(()=>YK[(g+k)%YK.length].RI(),g*0.2);}q.gB(()=>dispatchEvent(new bB(bB.QD,{"Type":"All","Position":new JB(280,550)})),0.75);}} AL(){var n=new AD();for(int i=0;i<10;i++ ){var k=9;var j=8;while (k>=0){while (k>=0&&XK[i+k*10].empty==false){k-- ;j-- ;}while (j>=0&&XK[i+j*10].empty==true){j-- ;}if(k>=0){var g,h,l;if(j>=0){h=XK[i+j*10];if(i>0){l=XK[i-1+j*10];if(h.cC(l)){l.eB=false;l.sB(bK,dK,eK);}}h.eB=false;h.empty=true;h.sB(bK,dK,eK);}else{if(WK.length>0){h=WK[0];WK.removeRange(0,1);}else{h=new KB(VK[SK.nextInt(VK.length)],SK.nextInt(2));}}g=XK[i+k*10];g.color=h.color;g.direction=h.direction;g.GB=h.GB;g.eB=false;g.empty=false;g.x=50*i+25;g.y=50*j+25;g.sB(bK,dK,eK);n.lD();var m=new UC(g.y,50*k+25,0.1,OB.VC);m.MC=(p){g.y=p;};m.onComplete=(){if(n.cF()==0){oK();wK();CL();}};q.add(m);}}}} pK( g){if(g.target==bK&&this.UB){var j=WB.min(g.jF/50,9).toInt();var h=WB.min(g.kF/50,9).toInt();var i=new JB(j,h);ZK.add(i);CL();}} CL(){while (TK==DC.BD&&aK==false&&ZK.length>0){var m=ZK[0];ZK.removeRange(0,1);var j=m.x.toInt();var k=m.y.toInt();var g=XK[j+k*10];var i=(j>0)?XK[j-1+k*10]:null;var n=(j<9)?XK[j+1+k*10]:null;var h=(k>0)?XK[j+(k-1)*10]:null;var p=(k<9)?XK[j+(k+1)*10]:null;var l=false;if(g.GB==w.EC){var CB=fB.MB.nB("ChainError");CB.play();continue;}if(g.pC(h)){h.eB=false;h.sB(bK,dK,eK);}if(g.cC(i)){i.eB=false;i.sB(bK,dK,eK);}g.direction=1-g.direction;g.eB=false;g.LC=false;var QB=fB.MB.nB("ChainRotate");QB.play();if(g.cC(n)){g.eB=true;g.LC=(g.GB==w.RB||n.GB==w.RB);}if(g.pC(p)){g.eB=true;g.LC=(g.GB==w.RB||p.GB==w.RB);}g.sB(bK,dK,eK);l=l||g.eB;if(g.pC(h)){h.eB=true;h.LC=(g.GB==w.RB||h.GB==w.RB);h.sB(bK,dK,eK);l=true;}if(g.cC(i)){i.eB=true;i.LC=(g.GB==w.RB||i.GB==w.RB);i.sB(bK,dK,eK);l=true;}if(l){var v=fB.MB.nB("ChainLink");v.play();}wK();}}}class bB extends DB{static const  kE="Explosion";static const  QD="Unlocked";static const  lE="Finalized";static const  zD="Timeouted";var CK;bB( h, g,[ bubbles=false]):super(h,bubbles){CK=g;} get info{return CK;}}class DC{static const  BD=1;static const  wD=2;static const  xD=3;}class jE extends AB{var NJ;jE( j){var g=new QC();g.KC=new EE("Arial",30,0xFFFFFF,bold:true,align:zB.TC);g.width=110;g.height=36;g.wordWrap=false;g.x=646;g.y=130;g.UB=false;g.text=j.toString();g.x=-g.width/2;g.y=-g.height/2;NJ=new AB();NJ.o(g);o(NJ);var i=new UC(0.0,1.0,1.5,OB.AC);i.MC=(h){NJ.alpha=1-h;NJ.y=-h*50;NJ.hB=1.0+0.1*WB.sin(h*10);NJ.pB=1.0+0.1*WB.cos(h*10);};i.onComplete=(){this.aE();};q.add(i);}}class FG extends AB{var OJ;var WJ;var hJ;var XJ;FG(){var m=new EB(HB.MB.u("ExitBox"));o(m);var g=new QC();g.KC=new EE("Arial",24,0xFFFFFF,bold:true,align:zB.TC);g.width=240;g.height=100;g.wordWrap=true;g.text=gC.MB.zC("GENexitquery");g.x=47;g.y=150-g.cE/2;g.UB=false;o(g);OJ=new JE(7,HB.MB.u("ExitGauge"),XD.RE);OJ.x=268;OJ.y=25;OJ.LB("TimeOver",hK);o(OJ);OJ.fD("TimeOver",0);OJ.start();var i=new EB(HB.MB.u("ExitYesButtonNormal"));var j=new EB(HB.MB.u("ExitYesButtonPressed"));WJ=new vC(i,i,j,j);WJ.x=68;WJ.y=239;WJ.LB(s.aC,kK);o(WJ);var h=new EB(HB.MB.u("ExitNoButtonNormal"));var k=new EB(HB.MB.u("ExitNoButtonPressed"));hJ=new vC(h,h,k,k);hJ.x=173;hJ.y=232;hJ.LB(s.aC,mK);o(hJ);this.LB(DB.GD,(l)=>q.add(OJ));this.LB(DB.ID,(l)=>q.remove(OJ));} nK( g){if(XJ!=null){XJ(g);XJ=null;}} kK( g){nK(true);} mK( g){nK(false);} hK( g){nK(false);}show( g){XJ=g;}}class uD{var WF;var yF;var zF;var angle;var BG;var SB;}class KB{var JJ;var KJ;var TJ;var ZJ;var eJ;var gJ;var nJ;var rJ;var uJ;var yJ;var BK;KB( h, g){JJ=h;KJ=g;TJ=w.PD;ZJ=-1000;eJ=-1000;gJ=false;nJ=false;rJ=false;uJ=null;yJ=null;BK=null;} get color=>JJ; set color( g){JJ=g;} get direction=>KJ; set direction( g){KJ=g;} get GB=>TJ; set GB( g){TJ=g;} get eB=>gJ; set eB( g){gJ=g;} get LC=>nJ; set LC( g){nJ=g;} get empty=>rJ; set empty( g){rJ=g;} jD( g){var h=g!=null&&(g.color==JJ||g.GB==w.RB||TJ==w.RB)&&g.GB!=w.EC&&TJ!=w.EC;return h;} cC( g){var h=g!=null&&(g.color==JJ||g.GB==w.RB||TJ==w.RB)&&g.direction==0&&KJ==0&&g.GB!=w.EC&&TJ!=w.EC;return h;} pC( g){var h=g!=null&&(g.color==JJ||g.GB==w.RB||TJ==w.RB)&&g.direction==1&&KJ==1&&g.GB!=w.EC&&TJ!=w.EC;return h;} get x=>ZJ; set x( g){ZJ=g;if(uJ!=null)uJ.x=g;if(yJ!=null)yJ.x=g;if(BK!=null)BK.x=g;} get y=>eJ; set y( g){eJ=g;if(uJ!=null)uJ.y=g;if(yJ!=null)yJ.y=g;if(BK!=null)BK.y=g;} set xF( h){if(uJ!=null){var g=1+0.3*WB.sin(h*WB.PI);uJ.hB=g;uJ.pB=g;}} sB( g, h, i){if(uJ!=null){uJ.parent.CC(uJ);uJ=null;}if(yJ!=null){yJ.parent.CC(yJ);yJ=null;}if(BK!=null){BK.parent.CC(BK);BK=null;}if(empty==false){switch (TJ){case w.RB:uJ=new dI(KJ);uJ.x=ZJ;uJ.y=eJ;g.o(uJ);break;case w.EC:uJ=HB.AE(w.EC);uJ.x=ZJ;uJ.y=eJ;g.o(uJ);break;default:uJ=HB.yD(JJ,KJ);uJ.x=ZJ;uJ.y=eJ;g.o(uJ);break;}if(gJ){yJ=nJ?new fI(KJ):HB.IG(JJ,KJ);yJ.x=ZJ+((KJ==0)?25:0);yJ.y=eJ+((KJ==1)?25:0);h.o(yJ);}switch (TJ){case w.PD:break;case w.EC:break;case w.RB:break;default:BK=new eI(TJ);BK.x=ZJ;BK.y=eJ;i.o(BK);break;}}}}class DG extends AB{var MJ;var VJ;var fJ;var oJ;var OJ;var tJ;var vJ;var xJ;var AK;var LJ;var EK;var FK;var GK;var HK;var JK;var KK;var LK;var NK;var OK;DG(){var j=new EB(HB.MB.u("ShuffleButtonNormal"));var h=new EB(HB.MB.u("ShuffleButtonPressed"));VJ=new vC(j,j,h,h);VJ.LB(s.aC,cK);VJ.x=530;VJ.y=525;o(VJ);var g=new EB(HB.MB.u("ExitButtonNormal"));var i=new EB(HB.MB.u("ExitButtonPressed"));fJ=new vC(g,g,i,i);fJ.LB(s.aC,jK);fJ.x=700;fJ.y=500;o(fJ);MJ=new EG();MJ.x=540;MJ.y=-1000;o(MJ);OJ=new JE(10,HB.MB.u("TimeGauge"),XD.NE);OJ.x=659;OJ.y=244;OJ.LB("TimeShort",lK);OJ.LB("TimeOver",hK);o(OJ);q.add(OJ);tJ=new CG();tJ.x=640;tJ.y=230;o(tJ);vJ=new HG();vJ.x=665;vJ.y=160;o(vJ);xJ=new QC();xJ.KC=new EE("Arial",30,0xD0D0D0,bold:true,align:zB.TC);xJ.width=140;xJ.height=36;xJ.wordWrap=false;xJ.x=646;xJ.y=130;xJ.UB=false;xJ.text="0";xJ.hB=0.9;o(xJ);AK=new QC();AK.KC=new EE("Arial",20,0xFFFFFF,bold:true,align:zB.TC);AK.width=44;AK.height=30;AK.wordWrap=false;AK.x=610;AK.y=559;AK.UB=false;AK.text="3x";o(AK);JK=new AB();o(JK);KK=new AB();o(KK);LK=new AB();o(LK);NK=fB.MB.nB("Intro");OK=NK.play();} start(){LJ=1;EK=1;HK=0;FK=3;var g=new vD(gC.MB.zC("ESCStartText"));KK.o(g);q.gB(()=>tJ.pF(21),1);g.show(()=>q.gB(()=>qK(),0.5));} qK(){if(oJ!=null&&this.contains(oJ))JK.CC(oJ);var m=LJ;var g=0;var h=0;switch (LJ){case 01:h=50;oJ=new GG(g=40,3,0,0,0,0,[0,1,2]);break;case 02:h=45;oJ=new GG(g=45,3,1,0,0,0,[2,3,4]);break;case 03:h=40;oJ=new GG(g=50,4,2,2,1,0,[5,6,7]);break;case 04:h=35;oJ=new GG(g=55,4,3,3,2,0,[0,2,6]);break;case 05:h=30;oJ=new GG(g=60,5,4,4,2,1,[1,3,5]);break;case 06:h=34;oJ=new GG(g=60,5,5,5,3,2,[1,2,4,7]);break;case 07:h=33;oJ=new GG(g=65,5,5,6,3,2,[0,1,2,3]);break;case 08:h=32;oJ=new GG(g=70,5,5,6,3,2,[0,2,5,6]);break;case 09:h=31;oJ=new GG(g=75,5,5,6,3,2,[1,4,5,7]);break;default:h=30;oJ=new GG(g=80+(LJ-10)*5,5,5,6,3,2,[0,1,2,3]);break;}GK=g;if(FK<3){FK++ ;AK.text="${FK}x";}oJ.LB(bB.kE,rK);oJ.LB(bB.QD,sK);oJ.LB(bB.lE,tK);oJ.LB(bB.zD,uK);oJ.x=20;oJ.y=16;oJ.UB=false;JK.o(oJ);OJ.reset(h);OJ.fD("TimeShort",9);OJ.fD("TimeOver",0);OJ.pause();MJ.level=m;MJ.XF=g;MJ.y=-210;var k=new cB(MJ,0.4,OB.AC);k.dB.y.aB(-90);q.add(k);var j=new vD(gC.MB.zC("ESCLevelBoxText").replaceAll("{0}","${g}"));KK.o(j);j.show((){oJ.UB=true;OJ.start();if(NK!=null){var i=new UC(1.0,0.0,4.0,OB.VC);i.MC=(l){OK.GC.volume=l;OK.GC=OK.GC;};i.onComplete=(){OK.stop();tJ.FI();};q.add(i);NK=null;}});} lK( g){vJ.start();} hK( g){oJ.AG(DC.xD);} sK( j){var g=0;var k=j.info["Position"];var h=j.info["Type"];if(h=="SingleLocked")g=3000;if(h=="SingleUnlocked")g=1000;if(h=="All")g=10000;var i=new jE(g);i.x=k.x;i.y=k.y;JK.o(i);HK=HK+g;xJ.text="${HK}";} rK( j){var g=GK;var i=j.info["Length"];var k=j.info["Factor"];g=(g>i)?g-i:0;GK=g;MJ.XF=g;if(g==0)oJ.AG(DC.wD);var h=0;switch (i){case 3:h=1000;break;case 4:h=2000;break;case 5:h=5000;break;default:h=5000;break;}HK=HK+h*k;xJ.text="${HK}";} tK( m){OJ.pause();vJ.stop();var l=fB.MB.nB("Laugh");var k=fB.MB.nB("LevelUp");l.play();tJ.pF(3);var g=HB.JG();g.x=55;g.y=260;JK.o(g);q.gB((){oJ.dF();k.play();},2.0);q.gB((){var j=(OJ.OI*1000).toInt();var h=new jE(j);h.x=704;h.y=360;JK.o(h);HK=HK+j;xJ.text="${HK}";},2.5);var i=new cB(MJ,0.5,OB.AC);i.dB.y.aB(-210);i.XC=3.0;q.add(i);q.gB((){JK.CC(g);},3.5);q.gB((){LJ++ ;qK();},4.0);} uK( j){vJ.stop();oJ.dF();var g;var i;if(EK>0){EK-- ;g=new vD(gC.MB.zC("GEN2ndchancetime"));KK.o(g);i=fB.MB.nB("LevelUp");i.play();g.show((){q.gB(()=>qK(),0.5);var h=new cB(MJ,0.5,OB.AC);h.dB.y.aB(-210);q.add(h);});}else{g=new vD(gC.MB.zC("GENtimeup"));KK.o(g);i=fB.MB.nB("GameOver");i.play();g.show((){q.gB(()=>xK(),0.5);var h=new cB(MJ,0.5,OB.AC);h.dB.y.aB(-210);q.add(h);});}} cK( h){if(oJ!=null&&FK>0){var g=oJ.wF();if(g){FK=FK-1;AK.text="${FK}x";}}} jK( j){var h=new AB();h.o(new EB(new BB(800,600,false,0x000000)));h.alpha=0.6;LK.o(h);var g=new FG();g.x=235;g.y=150;LK.o(g);g.show(( i){LK.CC(g);if(i==false)LK.CC(h);else zK(false);});}xK(){var h=new AB();var j=new EB(HB.MB.u("ExitBox"));h.o(j);var g=new QC();g.KC=new EE("Arial",30,0xFFFFFF,bold:true,align:zB.TC);g.width=240;g.height=200;g.wordWrap=true;g.text=gC.MB.zC("GENgameover");g.x=47;g.y=30+(g.height-g.cE)/2;g.UB=false;h.o(g);h.x=110;h.y=-h.height;KK.o(h);var k=fB.MB.nB("Laugh");q.gB(()=>k.play(),0.3);var i=new cB(h,0.3,OB.AC);i.dB.y.aB(150);q.add(i);q.gB(()=>zK(true),5.0);h.LB(s.aC,( l)=>zK(true));}var BL=false; zK( g){OJ.pause();if(BL==false){BL=true;}}}class OD extends AB{var JJ;var SJ;var cJ;var mJ;OD( g){JJ=g;cJ=HB.NG(g);mJ=true;SJ=new EB(cJ[0]);SJ.x=-34;SJ.y=-50;o(SJ);} get MD=>mJ; set MD( g){mJ=g;} vF( g){SJ.bitmapData=cJ[g?0:4];} RI(){var i=new UC(0.0,1.0,2.0,OB.AC);i.MC=(j){hB=pB=1.0+0.2*WB.sin(j*4*WB.PI);};var g=new cB(this,0.2,OB.AC);g.dB.alpha.aB(0.0);g.XC=2.0;g.onComplete=()=>vF(mJ);var h=new cB(this,0.2,OB.TF);h.dB.alpha.aB(1);h.XC=2.2;q.add(i);q.add(g);q.add(h);}}class vD extends AB{var QJ;var XJ;vD( h){var i=new EB(HB.MB.u("MessageBox"));o(i);var g=new QC();g.KC=new EE("Arial",24,0xFFFFFF,bold:true,align:zB.TC);g.width=240;g.height=200;g.wordWrap=true;g.text=h;g.x=47;g.y=130-g.cE/2;g.UB=false;o(g);QJ=null;LB(s.aC,UK);}void show( h){this.parent.o(this);this.x=-this.width;this.y=150;XJ=h;var g=new cB(this,0.3,OB.AC);g.dB.x.aB(110);g.onComplete=()=>QJ=q.gB(iK,10);q.add(g);} iK(){if(QJ!=null){q.remove(QJ);QJ=null;XJ();var g=new cB(this,0.4,OB.TF);g.dB.x.aB(800);g.onComplete=()=>this.parent.CC(this);q.add(g);}} UK( g){iK();}}class dI extends AB implements uB{var SJ;var iJ;var dJ;dI( g){this.UB=false;dJ=0.0;iJ=HB.LG(g);SJ=new EB(iJ[0]);SJ.x=-25;SJ.y=-25;o(SJ);LB(DB.GD,(h)=>q.add(this));LB(DB.ID,(h)=>q.remove(this));} BC( g){dJ+= g;var h=(dJ*10).toInt()%iJ.length;SJ.bitmapData=iJ[h];return true;}}class fI extends AB implements uB{var SJ;var iJ;var dJ;fI( g){this.UB=false;dJ=0.0;iJ=HB.MG(g);SJ=new EB(iJ[0]);SJ.x=-25;SJ.y=-25;o(SJ);LB(DB.GD,(h)=>q.add(this));LB(DB.ID,(h)=>q.remove(this));} BC( g){dJ+= g;var h=(dJ*10).toInt()%iJ.length;SJ.bitmapData=iJ[h];return true;}}class eI extends AB implements uB{var SJ;var dJ;eI( h){this.UB=false;dJ=0.0;SJ=HB.AE(h);o(SJ);LB(DB.GD,(g)=>q.add(this));LB(DB.ID,(g)=>q.remove(this));} BC( g){dJ+= g;this.SB=WB.sin(dJ*7)*10*WB.PI/180;return true;}}class AD{var value=0; lD([ inc=1])=>(value+= inc); cF([ dec=1])=>(value-= dec);}class CG extends AB{var PJ;var YJ;var lJ;CG(){PJ=HB.OG();YJ=new EB(PJ[0]);YJ.x=-YJ.width/2;YJ.y=-YJ.height/2;o(YJ);lJ=null;} pF( g){q.remove(lJ);lJ=new UC(0,g,0.5*g,OB.VC);lJ.MC=(h){var i=((h*PJ.length)%PJ.length).toInt();YJ.bitmapData=PJ[i];YJ.y=WB.sin(h*2*WB.PI)*3-YJ.height/2;};q.add(lJ);} FI(){q.remove(lJ);YJ.bitmapData=PJ[0];}}class HG extends AB{var RJ;var aJ;var kJ;var qJ;var sJ;HG(){kJ=fB.MB.nB("Warning");qJ=null;RJ=HB.PG();aJ=new EB(RJ[0]);o(aJ);} start(){qJ=kJ.play();q.remove(sJ);sJ=new UC(0,80,9.0,OB.VC);sJ.MC=(h){var g=h.toInt()%8;aJ.bitmapData=RJ[(g<=4)?g+1:8-g];};q.add(sJ);} stop(){if(qJ!=null){qJ.stop();qJ=null;}q.remove(sJ);aJ.bitmapData=RJ[0];}}class w{static const  PD="None";static const  RB="Joker";static const  EC="Block";static const  mE="Double";static const  nE="Quint";}class gC{static var MB;}class fB{static var MB;}class HB{static var MB;static  yD( i, h){var g=new EB(MB.YC("Elements").u("Chain${i}${h}"));g.NC=25;g.OC=25;return g;}static  IG( i, h){var g=new EB(MB.YC("Elements").u("Link${i}${h}"));g.NC=25;g.OC=25;return g;}static  AE( h){var g=new EB(MB.YC("Elements").u(h));g.NC=25;g.OC=25;return g;}static  JG(){var m=new AB();var l=0;var n=MB.YC("Levelup");for(int k=0;k<7;k++ ){var g=new EB(n.u("LevelUp${k}"));g.x=-g.width/2;g.y=-g.height/2;var h=new AB();h.o(g);h.x=l+g.width/2;h.hB=0;h.pB=0;m.o(h);var i=new cB(h,2.0,OB.qH);i.dB.hB.aB(1.0);i.dB.pB.aB(1.0);i.XC=k*0.05;var j=new cB(h,0.4,OB.VC);j.dB.hB.aB(0.0);j.dB.pB.aB(0.0);j.XC=3.0;q.add(i);q.add(j);l=l+5+g.width;}return m;}static  LG( h){var i=MB.YC("Elements");var g=new List<BB>();g.add(i.u("JokerChain${h}0"));g.add(i.u("JokerChain${h}1"));g.add(i.u("JokerChain${h}2"));g.add(i.u("JokerChain${h}3"));g.add(i.u("JokerChain${h}4"));return g;}static  MG( h){var i=MB.YC("Elements");var g=new List<BB>();g.add(i.u("JokerLink${h}0"));g.add(i.u("JokerLink${h}1"));g.add(i.u("JokerLink${h}2"));g.add(i.u("JokerLink${h}3"));g.add(i.u("JokerLink${h}4"));return g;}static  NG( h){var i=MB.YC("Locks");var g=new List<BB>();g.add(i.u("Lock${h}0"));g.add(i.u("Lock${h}1"));g.add(i.u("Lock${h}2"));g.add(i.u("Lock${h}3"));g.add(i.u("Lock${h}4"));return g;}static  OG(){var h=MB.YC("Head");var g=new List<BB>();g.add(h.u("Head1"));g.add(h.u("Head2"));g.add(h.u("Head3"));g.add(h.u("Head2"));g.add(h.u("Head1"));return g;}static  PG(){var h=MB.YC("Alarm");var g=new List<BB>();g.add(h.u("Alarm0"));g.add(h.u("Alarm1"));g.add(h.u("Alarm2"));g.add(h.u("Alarm3"));g.add(h.u("Alarm4"));g.add(h.u("Alarm5"));return g;}}class kE extends AB implements uB{var zJ;var dJ;kE( p, n){zJ=new List<uD>();dJ=0.0;this.UB=false;var v=HB.yD(p,n);var m=new WB.Random();var i;var l;var CB;for(int h=0;h<=1;h++ ){for(int g=0;g<=1;g++ ){if(g==0&&h==0){i=WB.PI*1.15;SB=-WB.PI*2;}if(g==1&&h==0){i=WB.PI*1.85;SB=WB.PI*2;}if(g==1&&h==1){i=WB.PI*0.15;SB=WB.PI*2;}if(g==0&&h==1){i=WB.PI*0.85;SB=-WB.PI*2;}i=i+0.2*WB.PI*m.nextDouble();l=80.0+40.0*m.nextDouble();var j=new EB(v.bitmapData);j.hD=new IB(g*25,h*25,25,25);j.NC=12.5+g*25;j.OC=12.5+h*25;j.x=g*25;j.y=h*25;o(j);var k=new uD();k.WF=j;k.yF=g*25+12.5;k.zF=h*25+12.5;k.angle=i;k.BG=l;k.SB=SB;zJ.add(k);}}} BC( m){dJ=WB.min(0.8,dJ+m);var v=981.0;for(int h=0;h<zJ.length;h++ ){var g=zJ[h];var i=g.WF;var j=g.angle;var k=g.BG;var l=g.SB;var n=g.yF+dJ*(WB.cos(j)*k);var p=g.zF+dJ*(WB.sin(j)*k+dJ*v*0.5);i.x=n;i.y=p;i.SB=dJ*l;}if(dJ>=0.6)this.alpha=(0.8-dJ)/0.2;if(dJ>=0.8)this.aE();return (dJ<0.8);}}var RD;var hC;var SD;var q;var ZC;var TD;var FC; main(){RD=new oC("StageBackground",rC.query('#stageBackground'));hC=new oC("StageForeground",rC.query('#stageForeground'));SD=new DE();SD.VF(RD);SD.VF(hC);q=SD.YE;BB.KF=new BE(png:true,jpg:true,webp:true);var g=BB.xC("images/Loading.png");g.then((h){ZC=new EB(h);ZC.NC=20;ZC.OC=20;ZC.x=400;ZC.y=270;hC.o(ZC);TD=new cB(ZC,100,OB.VC);TD.dB.SB.aB(100.0*2.0*WB.PI);q.add(TD);FC=new QC();FC.KC=new EE("Arial",20,0xA0A0A0,bold:true);FC.width=240;FC.height=40;FC.text="... loading ...";FC.x=400-FC.SI/2;FC.y=320;FC.UB=false;hC.o(FC);KG();});} KG(){var g=new WD();g.lB("Background","images/Background.jpg");g.lB("ExitBox","images/ExitBox.png");g.lB("ExitButtonNormal","images/ExitButtonNormal.png");g.lB("ExitButtonPressed","images/ExitButtonPressed.png");g.lB("ExitGauge","images/ExitGauge.png");g.lB("ExitNoButtonNormal","images/ExitNoButtonNormal.png");g.lB("ExitNoButtonPressed","images/ExitNoButtonPressed.png");g.lB("ExitYesButtonNormal","images/ExitYesButtonNormal.png");g.lB("ExitYesButtonPressed","images/ExitYesButtonPressed.png");g.lB("InfoBox","images/InfoBox.png");g.lB("MessageBox","images/MessageBox.png");g.lB("ShuffleButtonNormal","images/ShuffleButtonNormal.png");g.lB("ShuffleButtonPressed","images/ShuffleButtonPressed.png");g.lB("TimeGauge","images/TimeGauge.png");g.JD("Alarm","images/AlarmTextureAtlas.json",mC.wC);g.JD("Head","images/HeadTextureAtlas.json",mC.wC);g.JD("Elements","images/ElementsTextureAtlas.json",mC.wC);g.JD("Levelup","images/LevelupTextureAtlas.json",mC.wC);g.JD("Locks","images/LocksTextureAtlas.json",mC.wC);g.ZB("BonusAllUnlock","sounds/BonusAllUnlock.mp3");g.ZB("BonusUniversal","sounds/BonusUniversal.mp3");g.ZB("ChainBlast","sounds/ChainBlast.mp3");g.ZB("ChainBlastSpecial","sounds/ChainBlastSpecial.mp3");g.ZB("ChainError","sounds/ChainError.mp3");g.ZB("ChainFall","sounds/ChainFall.mp3");g.ZB("ChainHelp","sounds/ChainHelp.mp3");g.ZB("ChainLink","sounds/ChainLink.mp3");g.ZB("ChainRotate","sounds/ChainRotate.mp3");g.ZB("Click","sounds/Click.mp3");g.ZB("GameOver","sounds/GameOver.mp3");g.ZB("Laugh","sounds/Laugh.mp3");g.ZB("LevelUp","sounds/LevelUp.mp3");g.ZB("PointsCounter","sounds/PointsCounter.mp3");g.ZB("Unlock","sounds/Unlock.mp3");g.ZB("Warning","sounds/Warning.mp3");g.ZB("Intro","sounds/Intro.mp3");g.wB("ESCAPE_INS_AIM_0","Connect at least 3 chain links of the same colour to a horizontal or vertical chain.");g.wB("ESCAPE_INS_DES_0","You can change the direction of a chain link by touching it.");g.wB("ESCAPE_INS_TIP_0","Earn extra points for connecting chain links displaying a key symbol.");g.wB("ESCBlockErrorHint","Sorry but block chains can´t be twisted!");g.wB("ESCLevelBoxText","Connect {0} chain links and help the crook to escape!");g.wB("ESCNoActionHint","Press on the chain links to twist them.");g.wB("ESCNoComboHint","You have to connect at least 3 chain links of the same colour.");g.wB("ESCStartText","Form horizontal or vertical same-colour chains and become an escape agent!");g.wB("ESCtogo","Chain links:");g.wB("GENexitquery","Do you really want to quit the game?");g.wB("GEN2ndchancetime","Time is up. Second chance!");g.wB("GENtimeup","Sorry! Your time is up.");g.wB("GENgameover","Game Over");g.load().then((l){hC.CC(ZC);hC.CC(FC);q.remove(TD);HB.MB=g;fB.MB=g;gC.MB=g;var j=new EB(HB.MB.u("Background"));RD.o(j);RD.NI=yC.TE;var i=new DG();hC.o(i);i.start();}).catchError((k){for(var h in g.fF){print("Loading resouce failed: ${h.kind}.${h.name} - ${h.error}");}});}const gI=const hI();class hI{const hI();}class kB{final  TL=new List<qE>();var AM;static  xC( n, iB){var k=new jB.Completer<kB>();var g=new kB();switch (iB){case mC.cG:case mC.wC:rC.HttpRequest.getString(n).then((QB){var p=WI.parse(QB);var h=p["frames"];var v=p["meta"];var PC=iH(n,v["image"]);if(h is List){for(var CB in h){var j=CB as Map;var i=j["filename"] as String;var l=SF(i);var m=new qE.FJ(g,l,j);g.TL.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=SF(i);var m=new qE.FJ(g,l,j);g.TL.add(m);}}BB.xC(PC).then(( xB){g.AM=xB;k.complete(g);}).catchError((TB){k.completeError(new StateError("Failed to load image."));});}).catchError((TB){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} u( h){for(int g=0;g<TL.length;g++ )if(TL[g].name==h)return new BB.IJ(TL[g]);throw new ArgumentError("TextureAtlasFrame not found: '${h}'");}}class YD extends RC{var lL;var YL;var XL;var mL;YD( g, i, h){lL=g;XL=i;mL=h;YL=g.XN(this);YL.loop=XL;this.GC=h;YL.play();} get GC=>mL; set GC( g){mL=g;if(YL!=null)YL.volume=(mL!=null)?mL.volume:1;} stop(){if(YL!=null){if(YL.ended==false)YL.pause();lL.lO(this);YL=null;}}}class FE extends NB{var YL;var qL;var IM;FE(){IM=new List<YD>();YL=new rC.AudioElement();YL.onEnded.listen(DN);qL=new List<rC.AudioElement>();qL.add(YL);rC.document.body.children.add(YL);}static  xC( k,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=NB.KF;var m=new FE();var g=m.YL;var h=uC.UF(k,soundLoadOptions);var i=new jB.Completer<NB>();if(h.length==0){return lC.xC(k,soundLoadOptions);}var j;var l;CB(p){j.cancel();l.cancel();i.complete(m);}n(p){if(h.length>0){g.src=h.removeAt(0);g.load();}else{j.cancel();l.cancel();if(soundLoadOptions.ignoreErrors){lC.xC(k,soundLoadOptions).then((v)=>i.complete(v));}else{i.completeError(new StateError("Failed to load audio."));}}}j=g.onCanPlayThrough.listen(CB);l=g.onError.listen(n);g.src=h.removeAt(0);g.load();return i.future;} get length{return YL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new YB();return new YD(this,loop,soundTransform);} XN( h){var g;if(qL.length==0){g=YL.clone(true);g.onEnded.listen(DN);}else{g=qL.removeAt(0);}IM.add(h);return g;} lO( g){var h=g.YL;var i=IM.indexOf(g);IM.removeAt(i);qL.add(h);if(YL.currentTime>0&&YL.ended==false)YL.currentTime=0;} DN( j){var i=j.target;var g=null;for(int h=0;h<IM.length&&g==null;h++ )if(IM[h].YL==i)g=IM[h];if(g!=null)g.stop();}}class jC{var mp3;var mp4;var ogg;var wav;var ignoreErrors;jC({this.mp3: false,this.mp4: false,this.ogg: false,this.wav: false,this.ignoreErrors: true});}abstract class NB{static  xC( g,[ soundLoadOptions=null]){switch (uC.IH){case "WebAudioApi":return IE.xC(g,soundLoadOptions);case "AudioElement":return FE.xC(g,soundLoadOptions);default:return lC.xC(g,soundLoadOptions);}}static var KF=new jC(mp3:true,mp4:true,ogg:true,wav:true); get length; play([ loop=false, soundTransform]);}class WD{var eL;WD(){eL=new Map<String,VD>();} zM( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(eL.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");eL[i]=g;} CO( i, g){var h="${i}.${g}";if(eL.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return eL[h];} lB( i, h,[ bitmapDataLoadOptions=null]){var g=new VD("BitmapData",i,h);g.GO(BB.xC(h,bitmapDataLoadOptions));zM(g);} ZB( i, h,[ soundFileSupport=null]){var g=new VD("Sound",i,h);g.GO(NB.xC(h,soundFileSupport));zM(g);} JD( j, h, i){var g=new VD("TextureAtlas",j,h);g.GO(kB.xC(h,i));zM(g);} wB( i, h){var g=new VD("Text",i,"");g.GO(new jB.Future.immediate(h));zM(g);} load(){var h=this.JI.map((i)=>i.sL);return jB.Future.wait(h).then((j){var g=this.fF;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get JI{return eL.values.where((g)=>g.ND==null).toList();} get fF{return eL.values.where((g)=>g.error!=null).toList();} u( g){return CO("BitmapData",g).ND;} nB( g){return CO("Sound",g).ND;} YC( g){return CO("TextureAtlas",g).ND;} zC( g){return CO("Text",g).ND;}}class VD{var ML;var ZL;var kL;var sL;var DM;var HM;VD( g, h, i){ML=g;ZL=h;kL=i;DM=null;HM=null;} get kind=>ML; get name=>ZL; get ND=>HM; get error=>DM;GO( i){sL=i.then((g){HM=g;DM=null;},onError:( h){HM=null;DM=h.error;});}}class CE{var fC=null;CE();factory CE.CJ( i, g, h, j){return new kI(i,g,h,j);} VB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.qB,g.rB);}}class mC{static const  cG="json";static const  wC="jsonarray";}class qE{final  PL;final  ZL;final  vL;final  GM;final  SM;final  ZM;final  hM;final  nM;final  sM;final  vM;final  CN;qE.FJ( i, h, g):PL=i,ZL=h,vL=YH(g["rotated"]),GM=bC(g["sourceSize"]["w"]),SM=bC(g["sourceSize"]["h"]),ZM=bC(g["spriteSourceSize"]["x"]),hM=bC(g["spriteSourceSize"]["y"]),nM=bC(g["frame"]["x"]),sM=bC(g["frame"]["y"]),vM=bC(g["frame"]["w"]),CN=bC(g["frame"]["h"]); get TI=>PL; get name=>ZL; get QI=>vL; get vH=>nM; get wH=>sM; get hF=>vM; get gF=>CN; get offsetX=>ZM; get offsetY=>hM; get II=>GM; get HI=>SM;}class XG<FD>{final  KL=new List<FD>();final  nL;var xL=0;XG( g()):nL=g; qF(){if(xL==0){return nL();}else{xL-- ;return KL[xL];}}sF( g){if(xL==KL.length){KL.add(g);}else{KL[xL]=g;}xL++ ;}reset(){KL.clear();xL=0;}}abstract class RC extends SC{ get GC; set GC( g); stop();}class uC{static var IH=ZH();static var eD=fH();static var LF=gH();static  ZH(){var h=(eD!=null)?"WebAudioApi":"AudioElement";var g=rC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(LF.length==0)h="Mock";print("StageXL: supported audio engine is: ${h}");return h;}static  fH(){if(iE.AudioContext.supported)return new iE.AudioContext();return null;}static  gH(){var g=new List<String>();var h=new rC.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/mp4",""))!=-1)g.add("mp4");if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("StageXL: supported audio types are: ${g}");return g;}static  UF( i, h){var l=new RegExp(r"(mp3|mp4|ogg|wav)$",multiLine:false,caseSensitive:true);var g=LF.toList();var k=l.firstMatch(i);var j=new List<String>();if(k==null){throw new ArgumentError("Unsupported file extension.");}if(g.length==0){throw new UnsupportedError("This browser supports no known audio codec.");}if(!h.mp3)g.remove("mp3");if(!h.mp4)g.remove("mp4");if(!h.ogg)g.remove("ogg");if(!h.wav)g.remove("wav");var m=k.group(1);if(g.contains(m)){j.add(i);g.remove(m);}for(var n in g){j.add(i.replaceAll(l,n));}return j;}}class sE{static const  OF="none";static const  rG="touchPoint";}class XD extends t{static const  NE='DIRECTION_UP';static const  yE='DIRECTION_RIGHT';static const  RE='DIRECTION_DOWN';static const  cD='DIRECTION_LEFT';var xM;var BN;var AM;var KN;XD( g,[ direction=cD]){if(direction!=NE&&direction!=RE&&direction!=cD&&direction!=yE){throw new ArgumentError('Invalid Gauge direction!');}xM=direction;BN=1.0;AM=g;KN=new IB.DJ();LO();} get ratio=>BN;set ratio( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;BN=g;LO();} get bitmapData=>AM;set bitmapData( g){AM=g;LO();}LO(){if(AM==null){KN.left=0;KN.top=0;KN.right=0;KN.bottom=0;}else{var h=AM.width;var g=AM.height;switch (xM){case cD:KN.left=((1.0-BN)*h).toInt();KN.top=0;KN.right=h;KN.bottom=g;break;case NE:KN.left=0;KN.top=((1.0-BN)*g).toInt();KN.right=h;KN.bottom=g;break;case yE:KN.left=0;KN.top=0;KN.right=(BN*h).toInt();KN.bottom=g;break;case RE:KN.left=0;KN.top=0;KN.right=h;KN.bottom=(BN*g).toInt();break;}}} mB( h,[ returnRectangle]){var g=(AM!=null)?AM.width:0;var i=(AM!=null)?AM.height:0;return UE(h,g,i,returnRectangle);} oB( g, h){if(AM!=null&&g>=0.0&&h>=0.0&&g<AM.width&&h<AM.height)return this;return null;} VB( g){if(AM!=null)AM.tF(g,KN);}}class TG{static const  OF="none";}class yB{static const  LE="auto";static const  OE="arrow";static const  PE="button";static const  vG="hand";static const  wG="ibeam";static const  zG="wait";}class QG{}class SG{static const  hG="pixel";}class iI extends RC{var XL;var mL;iI( i, h, g){XL=h;mL=g;} get GC=>mL;set GC( g){mL=g;} stop(){}}class UG{static const  bG="dynamic";}class vC extends PB{var upState;var overState;var downState;var hitTestState;var fE=true;var enabled=true;var mM;vC([this.upState,this.overState,this.downState,this.hitTestState]){LB(s.IF,RN);LB(s.dD,RN);LB(s.bD,RN);LB(s.SE,RN);mM=this.upState;} mB( g,[ returnRectangle]){if(mM!=null){UO.WE(mM.dO,g);return mM.mB(UO,returnRectangle);}return super.mB(g,returnRectangle);} oB( k, l){if(this.hitTestState!=null){var g=this.hitTestState.dO;var h=k-g.qB;var i=l-g.rB;var m=(g.d*h-g.c*i)/g.dC;var j=(g.a*i-g.b*h)/g.dC;if(this.hitTestState.oB(m,j)!=null)return this;}return null;} VB( g){if(mM!=null)g.uF(mM);} RN( g){if(g.type==s.dD){mM=upState;}else{mM=g.WC?downState:overState;}}}class zB{static const  TC="center";static const  jG="end";static const  qG="justify";static const  nG="right";}final  KE=new Map<String,NF>();class s extends DB{static const  aC="click";static const  mG="doubleClick";static const  bD="mouseDown";static const  SE="mouseUp";static const  HF="mouseMove";static const  dD="mouseOut";static const  IF="mouseOver";static const  JF="mouseWheel";static const  MF="middleClick";static const  PH="middleMouseDown";static const  TH="middleMouseUp";static const  PF="rightClick";static const  XH="rightMouseDown";static const  aH="rightMouseUp";var OO,PO;var QO,SO;var jO;var JN;var bN;var LN;var PN;var nO;var oO;var pO;s( g,[ bubbles=false]):super(g,bubbles){zN(g,bubbles);} zN( g,[ bubbles=false]){super.zN(g,bubbles);OO=PO=0;QO=SO=0;jO=false;JN=false;bN=false;LN=false;PN=false;nO=0;oO=0;pO=0;}set rO( g){OO=g.x;PO=g.y;}set uO( g){QO=g.x;SO=g.y;} get jF=>OO; get kF=>PO; get WC=>jO; get altKey=>JN; get ctrlKey=>LN; get shiftKey=>PN; get LD=>nO; get deltaX=>oO; get deltaY=>pO;}class RG{RG();}class QC extends PB{var UL="";var hL=0x000000;var zL=null;var QM=TG.OF;var fM=SG.hG;var pM=UG.bG;var wM=false;var EN=false;var IN=0x000000;var ON=false;var TN=0x000000;var ZN=0;var dN=0;var hN;var oN;var sN=true;var vN=100;var xN=100;var DO=null;var WL=null;QC([ text, textFormat]){if(text!=null)UL=text;if(textFormat!=null)KC=textFormat;else zL=new EE("Arial",12,0x000000);hN=new List<String>();oN=new List<WG>();} get type=>pM; get width=>vN; get height=>xN; set text( g){UL=g;sN=true;} set KC( g){zL=g;hL=zL.color;sN=true;} set wordWrap( g){wM=g;sN=true;} set width( g){vN=g;sN=true;} set height( g){xN=g;sN=true;} get SI{TP();return ZN;} get cE{TP();return dN;} mB( g,[ returnRectangle]){return UE(g,vN,xN,returnRectangle);} oB( g, h){if(g>=0&&h>=0&&g<vN&&h<xN)return this;return null;} VB( g){TP();g.WL.drawImage(DO,0.0,0.0);} cP( p){var n=pG(p);hN.clear();oN.clear();if(wM==false){for(String h in UL.replaceAll('\r','').split('\n'))hN.add(h);}else{for(String h in UL.replaceAll('\r','').split('\n')){var g='';for(String j in h.split(' ')){var m=g;g=(g.length==0)?j:g+' '+j;if(WL.measureText(g).width>vN){if(m.length==0){hN.add(g);g='';}else{hN.add(m);g=j;}}}if(g.isEmpty==false){hN.add(g);}}}ZN=0;dN=0;for(String g in hN){var k=WL.measureText(g);var l=0.0;if(zL.align==zB.TC||zL.align==zB.qG)l=(vN-k.width)/2;if(zL.align==zB.nG||zL.align==zB.jG)l=vN-k.width;var i=new WG(l,k.width,zL.size,n.KD,n.kD,0);oN.add(i);ZN=WB.max(ZN,i.width);dN=dN+i.height;}} TP(){if(sN){sN=false;var h=vN.ceil().toInt();var i=xN.ceil().toInt();if(DO==null){DO=new rC.CanvasElement(width:h,height:i);WL=DO.context2d;}if(DO.width!=h)DO.width=h;if(DO.height!=i)DO.height=i;var m=new StringBuffer()..write(zL.italic?"italic ":"normal ")..write("normal ")..write(zL.bold?"bold ":"normal ")..write("${zL.size}px ")..write("${zL.font},sans-serif");var j=m.toString();WL.font=j;WL.textAlign="start";WL.textBaseline="alphabetic";WL.fillStyle=HD(hL);cP(j);if(EN){WL.fillStyle=HD(IN);WL.fillRect(0,0,vN,xN);}else{WL.clearRect(0,0,vN,xN);}var k=zL.size;for(int g=0;g<hN.length;g++ ){var l=oN[g];WL.fillStyle=HD(hL);WL.fillText(hN[g],l.x,k);k+= l.height;}if(ON){WL.strokeStyle=HD(TN);WL.lineWidth=1;WL.strokeRect(0,0,vN,xN);}}}}class jI extends RC{var iL;var mL;var XL;var UM;var eM;jI( j, h, i){iL=j;XL=h;mL=i;var g=uC.eD;UM=g.createGain();UM.connect(g.destination,0,0);UM.gain.value=(mL!=null)?WB.pow(mL.volume,2):1;eM=g.createBufferSource();eM.buffer=iL.SL;eM.loop=h;eM.connect(UM,0,0);eM.start(0);} get GC=>mL; set GC( g){mL=g;UM.gain.value=(mL!=null)?WB.pow(mL.volume,2):1;} stop(){eM.stop(0);}}class YB{var volume;var pan;var wI=1;var xI=0;var AJ=1;var zI=0;YB([this.volume=1,this.pan=0]);}abstract class HE{ VB( g);}class BE{var png;var jpg;var webp;BE({this.png: true,this.jpg: true,this.webp: false});}class EB extends t{var bitmapData;var pixelSnapping;var hD;EB([this.bitmapData=null,this.pixelSnapping="auto"]){hD=null;} mB( h,[ returnRectangle]){var g=(bitmapData!=null)?bitmapData.width:0;var i=(bitmapData!=null)?bitmapData.height:0;return UE(h,g,i,returnRectangle);} oB( g, h){if(bitmapData!=null&&g>=0.0&&h>=0.0&&g<bitmapData.width&&h<bitmapData.height)return this;return null;} VB( g){if(bitmapData==null)return;if(hD==null){bitmapData.VB(g);}else{bitmapData.tF(g,hD);}}}class AB extends kC{var oI=false;var fE=false;var XE=null;var PM=null;var YM=null;iO(){var i=this.mD;var j=this.qC;var m=this.visible;if(i!=null&&this.qC!=null){var h=iC.xG;if(h!=null){var g=dO.tD(i);if(g.x<h.left)g.x=h.left;if(g.x>h.right)g.x=h.right;if(g.y<h.top)g.y=h.top;if(g.y>h.bottom)g.y=h.bottom;i=dO.aF().tD(g);}var l=new JB(QN,VN).add(i).subtract(iC.uG);var k=dO.tD(l);this.visible=false;YM=j.oB(j.DI,j.EI);this.x=k.x;this.y=k.y;this.visible=m;}} mB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new IB.DJ();super.mB(g,returnRectangle);if(PM!=null){returnRectangle=PM.RP(g).union(returnRectangle);}return returnRectangle;} oB( i, j){var h=null;if(this.XE!=null){var g=this.dE(this.XE);if(g!=null){var k=i*g.a+j*g.c+g.qB;var l=i*g.b+j*g.d+g.rB;if(this.XE.oB(k,l)!=null){h=this;}}}else{h=super.oB(i,j);if(h==null&&PM!=null){if(PM.XP(i,j)){h=this;}}}return h;}VB( g){if(PM!=null)PM.VB(g);super.VB(g);}}class lC extends NB{lC(){}static  xC( g,[ soundLoadOptions=null]){return new jB.Future<NB>.of(()=>new lC());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new YB();}return new iI(this,loop,soundTransform);}}class EE{var font;var size;var color;var bold;var italic;var underline;var align;var leftMargin;var rightMargin;var indent;var leading;var letterSpacing=0;var mI=0;var nI=false;var vI=false;EE(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.leftMargin: 0,this.rightMargin: 0,this.indent: 0,this.leading: 0});}abstract class kC extends PB{final  tL=new List<t>();var OM=true;var XM=true; o( g){if(g.parent==this){var h=tL.indexOf(g);tL.removeAt(h);tL.add(g);}else{rH(g,tL.length);}} rH( g, h){if(h<0||h>tL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){tL.removeAt(tL.indexOf(g));if(h>tL.length)h-- ;tL.insert(h,g);}else{g.aE();g.wO(this);tL.insert(h,g);g.dispatchEvent(new DB(DB.eG,true));if(this.qC!=null)DP(g,new DB(DB.GD));}} CC( h){var g=tL.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");LI(g);} LI( g){if(g<0||g>=tL.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=tL[g];h.dispatchEvent(new DB(DB.yG,true));if(this.qC!=null)DP(h,new DB(DB.ID));h.wO(null);tL.removeAt(g);} contains( g){for(;g!=null;g=g.TO)if(g==this)return true;return false;} mB( n,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new IB.DJ();if(tL.length==0)return super.mB(n,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var p=tL.length;for(int l=0;l<tL.length;l++ ){var m=tL[l];UO.WE(m.dO,n);var g=m.mB(UO,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} oB( p, v){var l=null;for(int j=tL.length-1;j>=0;j-- ){var i=tL[j];if(i.visible){var g=i.dO;var m=p-g.qB;var k=v-g.rB;var CB=(g.d*m-g.c*k)/g.dC;var n=(g.a*k-g.b*m)/g.dC;var h=i.oB(CB,n);if(h!=null){if(h is PB)if(h.UB)return OM?h:this;l=this;}}}return l;} VB( i){for(int h=0;h<tL.length;h++ ){var g=tL[h];if(!g.uN&&g.visible)i.uF(g);}}gP( g, i){i.add(g);if(g is kC){var k=g as kC;var j=k.tL;for(int h=0;h<j.length;h++ ){gP(j[h],i);}}}DP( i, j){var g=ZD.qF() as List<t>;gP(i,g);for(int h=0;h<g.length;h++ ){g[h].dispatchEvent(j);}g.clear();ZD.sF(g);}}class GE implements uB{final  aL;var jL=0.0;var wL=0.0;var FM=1;GE( g, h):aL=g{wL=WB.max(h,0.0001);} BC( h){var g=jL+h;while (g>=wL&&FM>0){jL=wL;FM-- ;aL();g-= wL;}jL=g;return (FM>0);} get totalTime=>wL; get currentTime=>jL;}abstract class uB{ BC( g);}class DD implements uB{final  fL=new List<uB>();var BM=0;var LM=0.0; add( g){if(g==null)return;if(this.contains(g))return;if(BM==fL.length){fL.add(g);}else{fL[BM]=g;}BM++ ;} remove( h){if(h==null)return;for(int g=0;g<BM;g++ ){if(identical(fL[g],h)){fL[g]=null;break;}}} contains( h){if(h==null)return false;for(int g=0;g<BM;g++ ){if(identical(fL[g],h)){return true;}}return false;} eE( h, i,[ transitionFunction]){var g=new cB(h,i,transitionFunction);add(g);return g;} gB( h, i){var g=new GE(h,i);add(g);return g;} BC( k){LM+= k;var j=BM;var h=0;for(int g=0;g<j;g++ ){var i=fL[g];if(i==null)continue;if(i.BC(k)==false){fL[g]=null;continue;}if(h!=g){fL[h]=i;fL[g]=null;}h++ ;}if(h!=j){for(int g=j;g<BM;g++ ){fL[h++ ]=fL[g];fL[g]=null;}BM=h;}return true;}}abstract class PB extends t{var tH=false;var UB=true;var BJ=true;var tabIndex=0;static const  AH=const IC<s>(s.dD);static const  QH=const IC<s>(s.HF);static const  UH=const IC<s>(s.bD);static const  bH=const IC<s>(s.SE);static const  hH=const IC<s>(s.JF); get onMouseOut=>PB.AH.forTarget(this); get onMouseMove=>PB.QH.forTarget(this); get onMouseDown=>PB.UH.forTarget(this); get onMouseUp=>PB.bH.forTarget(this); get onMouseWheel=>PB.hH.forTarget(this);static const  kH=const IC<XB>(XB.GF);static const  lH=const IC<XB>(XB.xE);static const  mH=const IC<XB>(XB.AF); get onTouchMove=>PB.kH.forTarget(this); get onTouchEnd=>PB.lH.forTarget(this); get onTouchCancel=>PB.mH.forTarget(this);static const  oH=const IC<HC>(HC.wE);static const  pH=const IC<HC>(HC.ME); get onKeyUp=>PB.oH.forTarget(this); get onKeyDown=>PB.pH.forTarget(this);}class rE{final  eE;rE(this.eE);call( h, g){RM(h).aB(g);} get x=>RM("x"); get y=>RM("y"); get hB=>RM("scaleX"); get pB=>RM("scaleY"); get skewX=>RM("skewX"); get skewY=>RM("skewY"); get NC=>RM("pivotX"); get OC=>RM("pivotY"); get SB=>RM("rotation"); get alpha=>RM("alpha"); RM( h){var g=new vB(h);this.eE.RM(g);return g;}}class nC{static const  uE=1;static const  aD=2;static const  oG=3;}abstract class VG{}class IE extends NB{var SL;IE(){if(uC.eD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  xC( h,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=NB.KF;var l=new IE();var g=new jB.Completer<NB>();var i=uC.UF(h,soundLoadOptions);var v=uC.eD;if(i.length==0){return lC.xC(h,soundLoadOptions);}CB(m){v.decodeAudioData(m.response,( p){l.SL=p;g.complete(l);},(n){if(soundLoadOptions.ignoreErrors){lC.xC(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to decode audio."));}});}k(n){if(i.length>0){rC.HttpRequest.request(i.removeAt(0),responseType:'arraybuffer').then(CB).catchError(k);}else{if(soundLoadOptions.ignoreErrors){lC.xC(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to load audio."));}}}k(null);return g.future;} get length{return SL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new YB();return new jI(this,loop,soundTransform);}}class JB{var DL;var HL;JB( h, g):DL=h,HL=g;JB.DJ():this(0,0); clone()=>new JB(DL,HL); toString()=>"Point [x=${DL}, y=${HL}]"; get x=>DL; get y=>HL; get length=>WB.sqrt(DL*DL+HL*HL);set x( g){DL=g;}set y( g){HL=g;} add( g){return new JB(DL+g.x,HL+g.y);} subtract( g){return new JB(DL-g.x,HL-g.y);}iD( g){DL=g.x;HL=g.y;} eF( g){return DL==g.x&&HL==g.y;}}class IB{var DL;var HL;var OL;var bL;IB( i, g, h, j):DL=i,HL=g,OL=h,bL=j;IB.DJ():this(0,0,0,0); clone()=>new IB(DL,HL,OL,bL); toString()=>"Rectangle [x=${DL}, y=${HL}, width=${OL}, height=${bL}]"; get x=>DL; get y=>HL; get width=>OL; get height=>bL; get left=>DL; get top=>HL; get right=>DL+OL; get bottom=>HL+bL; get size=>new JB(OL,bL);set x( g){DL=g;}set y( g){HL=g;}set width( g){OL=g;}set height( g){bL=g;}set bottom( g){this.height=g-HL;}set left( g){DL=g;}set right( g){OL=g-DL;}set top( g){HL=g;} contains( g, h){return DL<=g&&HL<=h&&DL+OL>=g&&HL+bL>=h;} eF( g){return DL==g.x&&HL==g.y&&OL==g.width&&bL==g.height;} get isEmpty{return OL==0&&bL==0;}iD( g){DL=g.x;HL=g.y;OL=g.width;bL=g.height;} union( g){var i=WB.min(this.left,g.left);var h=WB.min(this.top,g.top);var j=WB.max(this.right,g.right);var k=WB.max(this.bottom,g.bottom);return new IB(i,h,j-i,k-h);} align(){var h=this.left.floor();var g=this.top.floor();var i=this.right.ceil();var j=this.bottom.ceil();return new IB(h,g,i-h,j-g);}}class FB{var EL,FL,IL,JL,LL,QL;var cL;FB( h, i, g, j, k, l):EL=h.toDouble(),FL=i.toDouble(),IL=g.toDouble(),JL=j.toDouble(),LL=k.toDouble(),QL=l.toDouble(),cL=(h*j-i*g).toDouble();FB.GJ():EL=1.0,FL=0.0,IL=0.0,JL=1.0,LL=0.0,QL=0.0,cL=1.0; clone(){return new FB(EL,FL,IL,JL,LL,QL);} aF(){var h=(JL/cL);var i=-(FL/cL);var g=-(IL/cL);var j=(EL/cL);var k=-(h*LL+g*QL);var l=-(i*LL+j*QL);return new FB(h,i,g,j,k,l);} get a=>EL; get b=>FL; get c=>IL; get d=>JL; get qB=>LL; get rB=>QL; get dC=>cL; tD( h){var i=h.x.toDouble();var g=h.y.toDouble();return new JB(i*EL+g*IL+LL,i*FL+g*JL+QL);} zO( h){var i=h.x.toDouble();var g=h.y.toDouble();return new JB(i*EL+g*IL+LL,i*FL+g*JL+QL);} concat( g){var m=EL;var v=FL;var CB=IL;var p=JL;var l=LL;var n=QL;var TB=cL;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var iB=g.qB;var QB=g.rB;var xB=g.dC;EL=(m*j+v*i).toDouble();FL=(m*k+v*h).toDouble();IL=(CB*j+p*i).toDouble();JL=(CB*k+p*h).toDouble();LL=(l*j+n*i+iB).toDouble();QL=(l*k+n*h+QB).toDouble();cL=(TB*xB).toDouble();} xH(){EL=1.0;FL=0.0;IL=0.0;JL=1.0;LL=0.0;QL=0.0;cL=1.0;} iF(){var j=EL;var m=FL;var l=IL;var k=JL;var h=LL;var i=QL;var g=cL;EL=(k/g).toDouble();FL=-(m/g).toDouble();IL=-(l/g).toDouble();JL=(j/g).toDouble();LL=-(EL*h+IL*i).toDouble();QL=-(FL*h+JL*i).toDouble();cL=(1.0/g).toDouble();} oD( h, i, g, k, j, l){EL=h.toDouble();FL=i.toDouble();IL=g.toDouble();JL=k.toDouble();LL=j.toDouble();QL=l.toDouble();cL=(EL*JL-FL*IL).toDouble();} iD( g){EL=g.a.toDouble();FL=g.b.toDouble();IL=g.c.toDouble();JL=g.d.toDouble();LL=g.qB.toDouble();QL=g.rB.toDouble();cL=g.dC.toDouble();} WE( h, g){var n=h.a;var CB=h.b;var QB=h.c;var v=h.d;var m=h.qB;var p=h.rB;var iB=h.dC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var xB=g.qB;var TB=g.rB;var PC=g.dC;EL=(n*k+CB*j).toDouble();FL=(n*l+CB*i).toDouble();IL=(QB*k+v*j).toDouble();JL=(QB*l+v*i).toDouble();LL=(m*k+p*j+xB).toDouble();QL=(m*l+p*i+TB).toDouble();cL=(iB*PC).toDouble();}}class WG{var KD;var kD;var height;var leading;var width;var x;WG(this.x,this.width,this.height,this.KD,this.kD,this.leading);}class DE{var GL;var VL;var gL;var yL;var MM;DE(){GL=new DD();VL=new List<oC>();gL=double.NAN;yL=UD.FF;MM=new pE(0);rC.window.requestAnimationFrame(YN);} get YE=>GL; YN( g){rC.window.requestAnimationFrame(YN);if(gL.isNaN)gL=g;if(gL>g)gL=g;var k=g-gL;var h=k/1000.0;var l=g/1000.0;if(k>=1){gL=g;MM.NL=h;yL.RO(MM);GL.BC(h);for(int i=0;i<VL.length;i++ ){var j=VL[i];j.YE.BC(h);j.CI(l,h);}}} VF( g){if(g.bE!=null){g.bE.MI(g);}VL.add(g);g.BP=this;} MI( g){if(g.bE==this){VL.remove(g);g.BP=null;}}}final  ZD=new XG<List<t>>(()=>new List<t>());class DB{static const  eG="added";static const  GD="addedToStage";static const  BF="enterFrame";static const  yG="removed";static const  ID="removedFromStage";static const  HH="resize";var pM;var fO;var VO;var oL;var hO;var XO;var cO;DB( g,[ bubbles=false]){zN(g,bubbles);} zN( g,[ bubbles=false]){pM=g;fO=bubbles;VO=nC.aD;oL=null;hO=null;XO=false;cO=false;} get qD=>XO; get type=>pM; get bubbles=>fO; get gD=>true; get target=>oL;}class tC{static const  ZG=0;static const  fG=1;static const  nG=2;static const  sG=3;static const  DF=4;}class SC{var RL;var uL; LB( g, h(event),{ useCapture: false}){return jM(g,useCapture).listen(h);}dispatchEvent( g){IO(g,this,this,nC.aD);} kO( h, j, i){if(j&&uL!=null){var g=uL[h];if(g!=null&&g.qO)return true;}if(i&&RL!=null){var g=RL[h];if(g!=null&&g.qO)return true;}return false;} jM( h, g){if(g){if(uL==null)uL=new Map<String,sC>();}else{if(RL==null)RL=new Map<String,sC>();}var i=g?uL:RL;return i.putIfAbsent(h,(){return new sC(this,h,g);});}IO( g, k, l, j){var h=(j==nC.uE)?uL:RL;if(h==null)return;var i=h[g.type];if(i==null)return;g.oL=k;g.hO=l;g.VO=j;g.XO=false;g.cO=false;i.RO(g);}}class UD<FD extends DB>{final  RL=new List<sC>();var EM=0;static var FF=new UD<pE>(); MN( g){for(int h=0;h<EM;h++ ){if(RL[h]==g)return;}if(EM==RL.length){RL.add(g);}else{RL[EM]=g;}EM++ ;} RO( j){j.VO=nC.aD;j.XO=false;j.cO=false;var k=EM;var i=0;for(int g=0;g<k;g++ ){var h=RL[g];if(h==null)continue;if(h.rM==0){RL[g]=null;continue;}j.oL=h.oL;j.hO=h.oL;h.RO(j);if(i!=g){RL[i]=h;RL[g]=null;}i++ ;}if(i!=k){for(int g=k;g<EM;g++ ){RL[i++ ]=RL[g];RL[g]=null;}EM=i;}}}class sC<FD extends DB> extends jB.Stream<FD>{final  oL;final  dL;final  JM;final  bM=new List<dG>();var rM=0;sC(this.oL,this.dL,this.JM); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new dG<FD>(this,h);if(rM==bM.length){bM.add(g);}else{bM[rM]=g;}rM++ ;if(dL==DB.BF&&JM==false)UD.FF.MN(this);return g;} rN( h){for(int g=0;g<rM;g++ ){if(identical(bM[g],h)){bM[g]=null;break;}}} get qO{for(var g=0;g<rM;g++ )if(bM[g]!=null)return true;return false;} RO( k){var j=rM;var h=0;for(int g=0;g<j;g++ ){var i=bM[g];if(i==null)continue;i.dM(k);if(h!=g){bM[h]=i;bM[g]=null;}h++ ;}if(h!=j){for(int g=j;g<rM;g++ ){bM[h++ ]=bM[g];bM[g]=null;}rM=h;}}}class tB{final  WL;final  pL=new List<FB>(100);final  NM=new List<double>(100);var aM=0;var jL=0.0;var lM=0.0;tB.EJ( j,[ matrix]):WL=j{for(int h=0;h<100;h++ ){pL[h]=new FB.GJ();NM[h]=1.0;}if(matrix!=null)pL[0].iD(matrix);var g=pL[0];var i=NM[0];WL.setTransform(g.a,g.b,g.c,g.d,g.qB,g.rB);WL.globalAlpha=i;} get context=>WL; get currentTime=>jL; reset([ matrix, currentTime, deltaTime]){if(matrix!=null)pL[0].iD(matrix);aM=0;jL=?currentTime?currentTime:0.0;lM=?deltaTime?deltaTime:0.0;var g=pL[0];var h=NM[0];WL.setTransform(g.a,g.b,g.c,g.d,g.qB,g.rB);WL.globalAlpha=h;WL.clearRect(0,0,WL.canvas.width,WL.canvas.height);} uF( i){var m=aM;var n=aM+1;var l=pL[m];var h=pL[n];var CB=NM[m];var v=NM[n]=i.pN*CB;var g=l;var k=i.AO;var p=i.EO;var j=i.NO;aM=n;h.WE(i.dO,l);if(k!=null||j!=null){WL.save();}if(k!=null){if(k.fC==null){g=h;}else if(identical(k.fC,i)){g=h;}else if(identical(k.fC,i.parent)){g=l;}else{g=k.fC.dE(i);if(g==null)g=QE;else g.concat(h);}k.VB(this,g);}if(j!=null){if(j.fC==null){g=h;}else if(identical(j.fC,i)){g=h;}else if(identical(j.fC,i.parent)){g=l;}else{g=j.fC.dE(i);if(g==null)g=QE;else g.concat(h);}j.VB(this,g);}WL.setTransform(h.a,h.b,h.c,h.d,h.qB,h.rB);WL.globalAlpha=v;if(p!=null){p.VB(this);}else{i.VB(this);}if(k!=null||j!=null){WL.restore();}aM=m;}}class iC{static var tE=yB.LE;static var gG=false;static var zE=null;static var uG=null;static var xG=null;static var DH=new jB.StreamController<String>();static var KH=DH.stream.asBroadcastStream();static  RF( i){var h=i;var g="auto";if(tE!=yB.LE){h=tE;}switch (h){case yB.LE:g="auto";break;case yB.OE:g="default";break;case yB.PE:g="pointer";break;case yB.vG:g="move";break;case yB.wG:g="text";break;case yB.zG:g="wait";break;}if(gG){g="none";}return g;}}class pE extends DB{var NL;pE( g):super(DB.BF,false){NL=g;} get gD=>false;}class IC<FD extends DB>{final  dL;const IC(this.dL); forTarget( g,{ useCapture: false}){return g.jM(dL,useCapture);}}class HC extends DB{static const  ME="keyDown";static const  wE="keyUp";var JN;var LN;var PN;var SN;var bN;var gN;var kN;var nN;HC( g,[ bubbles=false]):super(g,bubbles){zN(g,bubbles);} zN( g,[ bubbles=false]){super.zN(g,bubbles);JN=false;LN=false;PN=false;SN=false;bN=false;gN=0;kN=0;nN=0;} get altKey=>JN; get ctrlKey=>LN; get shiftKey=>PN; get charCode=>gN; get keyCode=>kN; get keyLocation=>nN;}class oE extends DB{static const  lG="textInput";var UL="";oE( g,[ bubbles=false]):super(g,bubbles);}class XB extends DB{static const  vE="touchBegin";static const  xE="touchEnd";static const  AF="touchCancel";static const  GF="touchMove";static const  CH="touchOver";static const  GH="touchOut";var KO;var MO;var OO,PO;var QO,SO;var JN;var bN;var LN;var PN;var YO;var aO;var bO;XB( g,[ bubbles=false]):super(g,bubbles){zN(g,bubbles);} zN( g,[ bubbles=false]){super.zN(g,bubbles);KO=0;MO=false;OO=PO=0;QO=SO=0;JN=false;bN=false;LN=false;PN=false;YO=1.00;aO=0;bO=0;}set rO( g){OO=g.x;PO=g.y;}set uO( g){QO=g.x;SO=g.y;} get sD=>KO; get jF=>OO; get kF=>PO; get altKey=>JN; get ctrlKey=>LN; get shiftKey=>PN;}class CD{static const  aG="exactFit";static const  kG="noBorder";static const  tG="noScale";static const  EF="showAll";}class BB implements HE{var OL;var bL;var rL;var CM;var KM;var VM;var cM;var iM;var oM;var qM;var uM;var AN;var HN;var WL;static var KF=new BE(png:true,jpg:true,webp:false);BB( h, i,[ transparent=true, fillColor=0xFFFFFFFF]){OL=h.toInt();bL=i.toInt();rL=transparent;CM=0;cM=oM=0;iM=qM=0;KM=uM=OL;VM=AN=bL;var g=new rC.CanvasElement(width:OL,height:bL);WL=g.context2d;WL.fillStyle=rL?LH(fillColor):HD(fillColor);WL.fillRect(0,0,OL,bL);HN=g;}BB.HJ( g){if(g==null)throw new ArgumentError();OL=g.naturalWidth.toInt();bL=g.naturalHeight.toInt();rL=true;CM=0;cM=oM=0;iM=qM=0;KM=uM=OL;VM=AN=bL;HN=g;}BB.IJ( g){OL=g.II.toInt();bL=g.HI.toInt();rL=true;CM=g.QI?2:1;cM=g.offsetX;iM=g.offsetY;KM=g.hF;VM=g.gF;oM=g.vH;qM=g.wH;uM=g.hF;AN=g.gF;HN=g.TI.AM.HN;}static  xC( h,[ bitmapDataLoadOptions=null]){if(bitmapDataLoadOptions==null)bitmapDataLoadOptions=BB.KF;var i=new jB.Completer<BB>();var g=new rC.ImageElement();var j;var k;j=g.onLoad.listen((m){j.cancel();k.cancel();i.complete(new BB.HJ(g));});k=g.onError.listen((m){j.cancel();k.cancel();i.completeError(new StateError("Error loading image."));});if(bitmapDataLoadOptions.webp==false){g.src=h;return i.future;}nH.then(( p){var n=new RegExp(r"(png|jpg|jpeg)$",multiLine:false,caseSensitive:true);var l=n.firstMatch(h);if(p==false||l==null){g.src=h;}else{g.src=h.substring(0,h.length-l.group(1).length)+"webp";}});return i.future;} get width=>OL; get height=>bL; clone(){var g=new BB(OL,bL,true,0);g.uH(this);return g;} uH( h,[ matrix=null]){var g=fP();var i=new tB.EJ(g,matrix);h.VB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} clear(){var g=fP();g.clearRect(0,0,OL,bL);} VB( h){var g=h.context;switch (CM){case 0:g.drawImage(HN,cM,iM);break;case 1:g.drawImageScaledFromSource(HN,oM,qM,uM,AN,cM,iM,KM,VM);break;case 2:g.transform(0.0,-1.0,1.0,0.0,cM,iM+VM);g.drawImageScaledFromSource(HN,oM,qM,AN,uM,0.0,0.0,VM,KM);break;}} tF( VI, g){var iB=VI.context;if(g.width<=0.0||g.height<=0.0)return;switch (CM){case 0:iB.drawImageScaledFromSource(HN,g.x-cM,g.y-iM,g.width,g.height,g.x+cM,g.y+iM,g.width,g.height);break;case 1:var j=oM;var h=qM;var v=j+uM;var CB=h+AN;var l=oM-cM+g.x;var m=qM-iM+g.y;var TB=l+g.width;var QB=m+g.height;var p=(j>l)?j:l;var n=(h>m)?h:m;var xB=(v<TB)?v:TB;var gE=(CB<QB)?CB:QB;var k=xB-p;var i=gE-n;var hE=cM-j+p;var PC=iM-h+n;if(k>0.0&&i>0.0){iB.drawImageScaledFromSource(HN,p,n,k,i,hE,PC,k,i);}break;case 2:var j=oM;var h=qM;var v=j+AN;var CB=h+uM;var l=oM+iM-g.y+VM-g.height;var m=qM-cM+g.x;var TB=l+g.height;var QB=m+g.width;var p=(j>l)?j:l;var n=(h>m)?h:m;var xB=(v<TB)?v:TB;var gE=(CB<QB)?CB:QB;var k=gE-n;var i=xB-p;var hE=cM-h+n;var PC=iM+v-xB;if(k>0.0&&i>0.0){iB.transform(0.0,-1.0,1.0,0.0,hE,PC+i);iB.drawImageScaledFromSource(HN,p,n,i,k,0,0,i,k);}break;}} fP(){if(WL==null){var g=new rC.CanvasElement(width:OL,height:bL);WL=g.context2d;switch (CM){case 0:WL.drawImage(HN,cM,iM);break;case 1:WL.drawImageScaledFromSource(HN,oM,qM,uM,AN,cM,iM,KM,VM);break;case 2:WL.transform(0.0,-1.0,1.0,0.0,cM,iM+VM);WL.drawImageScaledFromSource(HN,oM,qM,AN,uM,0.0,0.0,VM,KM);WL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}CM=0;cM=oM=0;iM=qM=0;KM=uM=OL;VM=AN=bL;HN=g;}return WL;}}class JE extends XD implements uB{static const  iG='TIME_OUT';var WM=false;var jL=0.0;var wL=0.0;var tM;var yM=true;JE( g, h,[ direction=XD.cD]):super(h,direction){if(g<=0)throw new ArgumentError('Time must be greater than zero');wL=g;YF();} BC( g){if(WM&&ratio>0.0){ratio=ratio-g/totalTime;if(ratio==0.0)pause();}return true;} start(){WM=true;} pause(){WM=false;} reset([ time=0.0]){pause();time=WB.max(time,0.0);if(time!=0.0){wL=time;YF();}ratio=1.0;} fD( g, h){tM[g]=h/totalTime;} YF(){tM=new Map<String,num>();fD(JE.iG,0);} get totalTime=>wL; get OI=>ratio*totalTime; set ratio( i){var h=ratio;super.ratio=i;if(yM){tM.forEach((j,g){if(g<h&&g>=ratio)dispatchEvent(new DB(j));});}}}typedef  ED( ratio);typedef  YG<FD extends DB>( event);class dG<FD extends DB> extends jB.StreamSubscription<FD>{var TM;var dM;var gM;var kM;dG(this.TM,this.dM){gM=0;kM=false;} cancel(){if(kM==false){TM.rN(this);kM=true;dM=null;}} onError( g( error)){} get gO=>gM>0; pause([ resumeSignal]){gM++ ;if(resumeSignal!=null){resumeSignal.whenComplete(resume);}} resume(){if(gO==false){throw new StateError("Subscription is not paused.");}gM-- ;}} HD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";} pG( g){if(KE.containsKey(g)==false){KE[g]=new NF(g);}return KE[g];}final  QE=new FB.GJ();class CF{static var NH=sE.OF;static var SH=new jB.StreamController<String>();static var VH=SH.stream.asBroadcastStream();static  get cH=>NH;}abstract class t extends SC implements HE{static var FH=0;var GN=FH++ ;var DL=0.0;var HL=0.0;var QN=0.0;var VN=0.0;var WN=1.0;var cN=1.0;var fN=0.0;var iN=0.0;var lN=0.0;var pN=1.0;var tN=true;var uN=false;var AO=null;var EO=null;var FO=null;var HO=false;var JO=null;var NO=null;var ZL="";var TO=null;final  UO=new FB.GJ();final  ZO=new FB.GJ();var eO=true; get x=>DL; get y=>HL; get NC=>QN; get OC=>VN; get hB=>WN; get pB=>cN; get skewX=>fN; get skewY=>iN; get SB=>lN; get visible=>tN; get alpha=>pN; get name=>ZL; get parent=>TO; get mD{var g=this.qC;return (g!=null)?this.eC(g.KP):null;} get DI{var g=this.mD;return (g!=null)?g.x:0.0;} get EI{var g=this.mD;return (g!=null)?g.y:0.0;} get root{var g=this;while (g.TO!=null)g=g.TO;return g;} get qC{var g=this.root;if(g is oC)return g;return null;}set x( g){DL=g.toDouble();eO=true;}set y( g){HL=g.toDouble();eO=true;}set NC( g){QN=g.toDouble();eO=true;}set OC( g){VN=g.toDouble();eO=true;}set hB( g){WN=g.toDouble();eO=true;}set pB( g){cN=g.toDouble();eO=true;}set skewX( g){fN=g.toDouble();eO=true;}set skewY( g){iN=g.toDouble();eO=true;}set SB( g){lN=g.toDouble();eO=true;}set visible( g){tN=g;}set alpha( g){pN=g.toDouble();}set mask( g){AO=g;} setTransform( h, g,[ scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY]){eO=true;DL=h.toDouble();HL=g.toDouble();if(scaleX!=null){WN=scaleX.toDouble();if(scaleY!=null){cN=scaleY.toDouble();if(rotation!=null){lN=rotation.toDouble();if(skewX!=null){fN=skewX.toDouble();if(skewY!=null){iN=skewY.toDouble();if(pivotX!=null){QN=pivotX.toDouble();if(pivotY!=null)VN=pivotY.toDouble();}}}}}}} get width=>mB(dO).width; get height=>mB(dO).height; set width( h){this.hB=1;var g=this.width;this.hB=(g!=0.0)?h/g:1.0;} set height( h){this.pB=1;var g=this.height;this.pB=(g!=0.0)?h/g:1.0;} aE(){if(TO!=null)TO.CC(this);} get dO{if(eO){eO=false;var j=fN+lN;var i=iN+lN;if(j==0.0&&i==0.0){ZO.oD(WN,0.0,0.0,cN,DL-QN*WN,HL-VN*cN);}else{var g,l,k,h;var m=WB.cos(j);var n=WB.sin(j);if(j==i){g=WN*m;l=WN*n;k=-cN*n;h=cN*m;}else{g=WN*WB.cos(i);l=WN*WB.sin(i);k=-cN*n;h=cN*m;}var v=DL-(QN*g+VN*k);var p=HL-(QN*l+VN*h);ZO.oD(g,l,k,h,v,p);}}return ZO;} dE( h){if(h==TO)return dO.clone();if(h.TO==this)return h.dO.aF();var j=new FB.GJ();var g=this;while (g!=h&&g.TO!=null){j.concat(g.dO);g=g.TO;}if(h==null&&g!=null){j.concat(g.dO);g=null;}if(g==h)return j;var k=new FB.GJ();var i=h;while (i!=this&&i.TO!=null){k.concat(i.dO);i=i.TO;}k.iF();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} mB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new IB.DJ();returnRectangle.x=g.qB;returnRectangle.y=g.rB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} oB( g, h){if(mB(QE).contains(g,h))return this;return null;} eC( h){UO.xH();for(t g=this;g!=null;g=g.TO)UO.concat(g.dO);UO.iF();return UO.tD(h);} dispatchEvent( h){var g=null;if(h.gD||h.bubbles){for(t j=TO;j!=null;j=j.TO){if(j.kO(h.type,h.gD,h.bubbles)){if(g==null)g=ZD.qF() as List<t>;g.add(j);}}}if(h.gD&&g!=null){for(int i=g.length-1;i>=0&&h.qD==false;i-- ){g[i].IO(h,this,g[i],nC.uE);}}if(h.qD==false){IO(h,this,this,nC.aD);}if(h.bubbles&&g!=null){for(int i=0;i<g.length&&h.qD==false;i++ ){g[i].IO(h,this,g[i],nC.oG);}}if(g!=null){g.clear();ZD.sF(g);}} wO( h){for(var g=h;g!=null;g=g.TO)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");TO=h;} VB( g);}class JC{static const  BH="B";static const  EH="BL";static const  JH="BR";static const  fG="L";static const  nG="R";static const  MH="T";static const  OH="TL";static const  RH="TR";static const  OF="";}class UC extends uB{final  NN;final  UN;final  aN;var eN;var jN;var mN;var qN;var wL;var jL;var wN;var yN;var BO;UC( g, h, i,[ transitionFunction]):NN=g,UN=h,aN=(transitionFunction!=null)?transitionFunction:OB.VC{eN=g;jL=0.0;wL=WB.max(0.0001,i);wN=0.0;yN=false;BO=false;} BC( i){if(jL<wL||BO==false){jL=jL+i;if(jL>wL)jL=wL;if(jL>=0.0){if(BO==false){BO=true;if(jN!=null)jN();}var g=jL/wL;var h=aN(g);eN=NN+h*(UN-NN);if(mN!=null)mN(yN?eN.round():eN);if(qN!=null&&jL==wL)qN();}}return jL<wL;} get pD=>NN; get rD=>UN; get totalTime=>wL; get currentTime=>jL;set XC( g){if(BO==false)jL=jL+wN-g;wN=g;} set onStart( g()){jN=g;} set MC( g( value)){mN=g;} set onComplete( g()){qN=g;}} LH( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class NF{var fontStyle;var KD=0;var kD=0;var height=0;NF( j){this.fontStyle=j;var h=new rC.Element.tag("span");h.style.font=this.fontStyle;h.text="Hg";var g=new rC.Element.tag("div");g.style.display="inline-block";g.style.width="1px";g.style.height="0px";var i=new rC.Element.tag("div");i.append(g);i.append(h);rC.document.body.append(i);try {g.style.verticalAlign="baseline";this.KD=g.offsetTop-h.offsetTop;g.style.verticalAlign="bottom";this.height=g.offsetTop-h.offsetTop;this.kD=height-KD;}catch (k){}finally {i.remove();}}}class OB{static  VC( g){return g;}static  TF( g){return g*g*g;}static  AC( g){g=1.0-g;return 1.0-g*g*g;}static  qH( g){if(g==0.0||g==1.0)return g;return WB.pow(2.0,-10.0*g)*WB.sin((g-0.3/4.0)*(2.0*WB.PI)/0.3)+1;}}class yC{static const  LE="auto";static const  WH="stop";static const  TE="once";} YH( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}class QF{var target=null;var WC=false;var VE=0;var LD=0;var nF,oF;var lF,mF;QF(this.nF,this.oF,this.lF,this.mF);}class kI extends CE{final  WO;kI( i, g, h, j):WO=new IB(i,g,h,j); VB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.qB,g.rB);h.beginPath();h.rect(WO.x,WO.y,WO.width,WO.height);h.clip();}} bC( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class vB{final  ZE;var pD=double.NAN;var rD=double.NAN;vB(this.ZE); aB( g){this.rD=g.toDouble();} get BI=>!pD.isNaN&&!rD.isNaN; mO( g){switch (ZE){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.NC;case 'pivotY':return g.OC;case 'scaleX':return g.hB;case 'scaleY':return g.pB;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.SB;case 'alpha':return g.alpha;default:return 0.0;}} CP( g, h){switch (ZE){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.NC=h;break;case 'pivotY':g.OC=h;break;case 'scaleX':g.hB=h;break;case 'scaleY':g.pB=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.SB=h;break;case 'alpha':g.alpha=h;break;}}}class dH{static var eH=0;var sD=eH++ ;var target=null;var nD=false;dH(this.target,this.nD);}class oC extends kC{var DO;var WL;var sO,tO;var vN,xN;var vO,xO;var yO;var AP;var BP;var GL;var pI=30;var EP;var FP;var GP;var HP;var IP;var JP;var KP;var LP;var MP;var NP;var OP;var PP;var QP;oC( h, g){ZL=h;DO=g;DO.focus();WL=g.context2d;vN=sO=g.width;xN=tO=g.height;vO=g.clientWidth;xO=g.clientHeight;yO=new FB.GJ();AP=new FB.GJ();BP=null;GL=new DD();FP=new tB.EJ(WL);GP=yC.LE;HP=CD.EF;IP=JC.OF;MP=[new QF(s.bD,s.SE,s.aC,s.mG),new QF(s.PH,s.TH,s.MF,s.MF),new QF(s.XH,s.aH,s.PF,s.PF)];JP=yB.OE;LP=null;KP=new JB(0,0);OP=new s(s.aC,true);iC.KH.listen(KH);DO.onMouseDown.listen(RN);DO.onMouseUp.listen(RN);DO.onMouseMove.listen(RN);DO.onMouseOut.listen(RN);DO.onMouseWheel.listen(YP);NP=new Map<int,dH>();QP=new XB(XB.vE,true);CF.VH.listen(ZP);ZP(null);PP=new HC(HC.ME,true);DO.onKeyDown.listen(aP);DO.onKeyUp.listen(aP);DO.onKeyPress.listen(bP);} get bE=>BP; get YE=>GL; get mD=>KP; get focus=>EP;set NI( g){GP=g;} get align=>IP;dP(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){dP();}set y( g){dP();}set NC( g){dP();}set OC( g){dP();}set hB( g){dP();}set pB( g){dP();}set skewX( g){dP();}set skewY( g){dP();}set SB( g){dP();}set alpha( g){dP();}set width( g){dP();}set height( g){dP();}CI( g, h){if(GP==yC.LE||GP==yC.TE){eP();FP.reset(AP,g,h);VB(FP);if(GP==yC.TE)GP=yC.WH;}}eP(){var m=DO.getBoundingClientRect();var n=DO.clientLeft+m.left;var p=DO.clientTop+m.top;var k=DO.clientWidth;var l=DO.clientHeight;if(k==0||l==0)return;var g=sO;var h=tO;var i=0;var j=0;switch (HP){case CD.aG:g=sO;h=tO;break;case CD.kG:if(k*tO>l*sO){h=(sO*l)~/k;}else{g=(tO*k)~/l;}break;case CD.tG:g=k;h=l;break;case CD.EF:if(k*tO>l*sO){g=(tO*k)~/l;}else{h=(sO*l)~/k;}break;}switch (IP){case JC.BH:i=(sO-g+1)~/2;j=(tO-h);break;case JC.EH:i=0;j=(tO-h);break;case JC.JH:i=(sO-g);j=(tO-h);break;case JC.fG:i=0;j=(tO-h+1)~/2;break;case JC.nG:i=(sO-g);j=(tO-h+1)~/2;break;case JC.MH:i=(sO-g+1)~/2;j=0;break;case JC.OH:i=0;j=0;break;case JC.RH:i=(sO-g+1);j=0;break;case JC.OF:i=(sO-g+1)~/2;j=(tO-h+1)~/2;break;}AP.oD(1.0,0.0,0.0,1.0,0-i,0-j);yO.oD(g/k,0.0,0.0,h/l,i-n,j-p);if(vN!=g||xN!=h){DO.width=vN=g;DO.height=xN=h;}if(vO!=k||xO!=l){vO=k;xO=l;dispatchEvent(new DB(DB.HH));}}KH( g){DO.style.cursor=iC.RF(JP);}RN( j){j.preventDefault();var n=new DateTime.now().millisecondsSinceEpoch;var v=j.button;var h=null;var i=yO.zO(j.client);var m=null;if(v<0||v>2)return;if(j.type=="mousemove"&&KP.eF(i))return;var g=MP[v];KP=i;if(iC.zE!=null)iC.zE.iO();if(j.type!="mouseout")h=oB(i.x,i.y) as PB;var l=yB.OE;if(h is AB&&(h as AB).fE){l=yB.PE;}if(h is vC&&(h as vC).fE){l=yB.PE;}if(JP!=l){JP=l;DO.style.cursor=iC.RF(l);}if(LP!=null&&LP!=h){LP.dispatchEvent(OP..zN(s.dD,true)..rO=(LP.qC!=null)?LP.eC(i):new JB.DJ()..uO=i..jO=g.WC);LP=null;}if(h!=null&&h!=LP){h.dispatchEvent(OP..zN(s.IF,true)..rO=h.eC(i)..uO=i..jO=g.WC);LP=h;}var k=null;var p=false;var CB=false;if(j.type=="mousedown"){k=g.nF;if(h!=g.target||n>g.VE+500)g.LD=0;g.WC=true;g.target=h;g.VE=n;g.LD++ ;}if(j.type=="mouseup"){k=g.oF;g.WC=false;p=(g.target==h);CB=p&&g.LD.isEven&&(n<g.VE+500);}if(j.type=="mousemove"){k=s.HF;}if(k!=null&&h!=null){m=h.eC(i);h.dispatchEvent(OP..zN(k,true)..rO=m..uO=i..jO=g.WC..nO=g.LD);if(p){if(CB&&h.tH){h.dispatchEvent(OP..zN(g.mF,true)..rO=m..uO=i..jO=g.WC);}else{h.dispatchEvent(OP..zN(g.lF,true)..rO=m..uO=i..jO=g.WC);}}}}YP( h){var g=yO.zO(h.client);var i=oB(g.x,g.y) as PB;if(i!=null){i.dispatchEvent(OP..zN(s.JF,true)..rO=i.eC(g)..uO=g..oO=h.deltaX..pO=h.deltaY);if(OP.qD)h.preventDefault();}}var hP=[] ;ZP( h){hP.forEach((g)=>g.cancel());if(CF.cH==sE.rG){hP=[DO.onTouchStart.listen(iP),DO.onTouchEnd.listen(iP),DO.onTouchMove.listen(iP),DO.onTouchEnter.listen(iP),DO.onTouchLeave.listen(iP),DO.onTouchCancel.listen(iP)];}}iP( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=yO.zO(m.client);var h=oB(i.x,i.y) as PB;var g=NP.containsKey(l)?NP[l]:new dH(h,NP.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(QP..zN(XB.GH,true)..rO=(g.target.qC!=null)?g.target.eC(i):new JB.DJ()..uO=i..KO=g.sD..MO=g.nD);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(QP..zN(XB.CH,true)..rO=h.eC(i)..uO=i..KO=g.sD..MO=g.nD);g.target=h;}var k=null;if(j.type=="touchstart"){NP[l]=g;k=XB.vE;}if(j.type=="touchend"){NP.remove(l);k=XB.xE;}if(j.type=="touchcancel"){NP.remove(l);k=XB.AF;}if(j.type=="touchmove"){k=XB.GF;}if(k!=null&&h!=null){h.dispatchEvent(QP..zN(k,true)..rO=h.eC(i)..uO=i..KO=g.sD..MO=g.nD);}}}aP( g){g.preventDefault();var h=null;if(g.type=="keyup")h=HC.wE;if(g.type=="keydown")h=HC.ME;PP..zN(h,true)..JN=g.altKey..LN=g.ctrlKey..PN=g.shiftKey..gN=g.charCode..kN=g.keyCode..nN=tC.ZG;if(g.keyLocation==rC.KeyLocation.LEFT)PP.nN=tC.fG;if(g.keyLocation==rC.KeyLocation.RIGHT)PP.nN=tC.nG;if(g.keyLocation==rC.KeyLocation.NUMPAD)PP.nN=tC.sG;if(g.keyLocation==rC.KeyLocation.JOYSTICK)PP.nN=tC.DF;if(g.keyLocation==rC.KeyLocation.MOBILE)PP.nN=tC.DF;if(EP!=null)EP.dispatchEvent(PP);}bP( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new oE(oE.lG,true);h.UL=new String.fromCharCodes([i]);if(EP!=null)EP.dispatchEvent(h);}} SF( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);} iH( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} jH(){var i=new jB.Completer<bool>();var g=new rC.ImageElement(); h(){i.complete(g.width==2&&g.height==2);}g.onLoad.listen((j)=>h());g.onError.listen((j)=>h());g.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";return i.future;}class cB implements uB{final  SP;final  aN;final  VP=new List<vB>();var jN;var mN;var qN;var WP;var wL;var jL;var wN;var yN;var BO;cB( g, h,[ transitionFunction]):SP=g,aN=(?transitionFunction)?transitionFunction:OB.VC{WP=new rE(this);jL=0.0;wL=WB.max(0.0001,h);wN=0.0;yN=false;BO=false;} get dB=>WP; RM( g){if(SP!=null&&BO==false){VP.add(g);}} BC( m){if(jL<wL||BO==false){jL=jL+m;if(jL>wL){jL=wL;}if(jL>=0.0){if(BO==false){BO=true;for(int h=0;h<VP.length;h++ ){var g=VP[h];g.pD=g.mO(SP);}if(jN!=null){jN();}}var k=jL/wL;var l=aN(k).toDouble();for(int h=0;h<VP.length;h++ ){var g=VP[h];if(g.BI){var i=g.pD.toDouble();var n=g.rD.toDouble();var j=i+l*(n-i);g.CP(SP,yN?j.round():j);}}if(mN!=null){mN();}if(qN!=null&&jL==wL){qN();}}}return jL<wL;} get totalTime=>wL; get currentTime=>jL;set XC( g){if(BO==false)jL=jL+wN-g;wN=g;} set onStart( g()){jN=g;} set MC( g()){mN=g;} set onComplete( g()){qN=g;}}var nH=jH(); UE( g, m, n, j){m=m.toDouble();n=n.toDouble();var PC=0.0;var xB=0.0;var CB=m*g.a;var iB=m*g.b;var QB=m*g.a+n*g.c;var v=m*g.b+n*g.d;var TB=n*g.c;var p=n*g.d;var h=PC;if(h>CB)h=CB;if(h>QB)h=QB;if(h>TB)h=TB;var i=xB;if(i>iB)i=iB;if(i>v)i=v;if(i>p)i=p;var l=PC;if(l<CB)l=CB;if(l<QB)l=QB;if(l<TB)l=TB;var k=xB;if(k<iB)k=iB;if(k<v)k=v;if(k<p)k=p;if(j==null)j=new IB.DJ();j.x=g.qB+h;j.y=g.rB+i;j.width=l-h;j.height=k-i;return j;}//@ sourceMappingURL=escape.dart.map
