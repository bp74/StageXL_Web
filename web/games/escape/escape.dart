import "dart:math" as SB;import "dart:html" as ZC;import "dart:json" as aH;class dF extends AB{var rI;var yI;var DJ;var HJ;var KJ;var LJ;var MJ;var NJ;var OJ;var QJ;var RJ;var SJ;var TJ;var UJ;var VJ;var XJ;var YJ;var ZJ;var aJ;var cJ;dF( o, l, v, RB, EB, s, k){NJ=new SB.Random();OJ=wB.rC;QJ=k;rI=o;yI=l;DJ=v;HJ=RB;KJ=EB;LJ=s;MJ=k.length;UJ=new List<NB>();XJ=new AB();YJ=new AB();ZJ=new AB();aJ=new AB();cJ=new AB();n(XJ);n(YJ);n(ZJ);n(aJ);n(cJ);YJ.UB=false;ZJ.UB=false;aJ.UB=false;cJ.UB=false;BH();CH();AH();VJ=true;var m=new qC();this.mask=new wF.AI(0.0,0.0,500.0,500.0);for(int g=0;g<10;g++ ){for(int h=0;h<10;h++ ){var i=SJ[g+h*10];i.x=g*50+25;i.y=h*50+25-550;i.jB(XJ,YJ,ZJ);var j=new KC(i.y,h*50+25,0.4,MB.rB);j.delay=g*0.03;j.GC=(IB){i.y=IB;};j.onComplete=(){if(m.VD()==100){jJ();VJ=false;UJ.clear();this.mask=null;}};p.add(j);}}addEventListener(t.LD,kJ);} ZF( g){if(g==wB.cD)OJ=g;if(g==wB.dD&&OJ==wB.rC){OJ=g;if(VJ==false)KB(new cB(cB.fD,null));}} EF(){this.mask=new wF.AI(0.0,0.0,500.0,500.0);for(int h=0;h<10;h++ ){for(int i=0;i<10;i++ ){var g=SJ[i+h*10];g.dB=false;g.FC=false;g.FB=u.BD;g.jB(XJ,YJ,ZJ);var j=new KC(g.y,500+h*50+25,0.5,MB.rB);j.delay=i*0.1;j.GC=(k){g.y=k;};p.add(j);}}} BH(){TJ=new List<AD>();for(int h=0;h<yI;h++ ){var g=new AD(h);g.YB=(NJ.nextInt(30)-15)*SB.PI/180;g.x=300-(90*yI)/2+h*90+NJ.nextInt(20)-10;g.y=550;TJ.add(g);aJ.n(g);}} BF( g, h){var i=0;var j=SJ[g+h*10];if(j.direction==0){var o=(g>0)?SJ[g-1+h*10]:null;var l=(g<9)?SJ[g+1+h*10]:null;if(j.VC(o))i++ ;if(j.VC(l))i++ ;}else{var k=(h>0)?SJ[g+(h-1)*10]:null;var m=(h<9)?SJ[g+(h+1)*10]:null;if(j.eC(k))i++ ;if(j.eC(m))i++ ;}return i;} AF(){for(int h=0;h<10;h++ ){for(int g=0;g<10;g++ ){var i=SJ[g+h*10];var j=MJ*2;while (BF(g,h)==2&&j>0){if(j%2==0){i.direction=1-i.direction;j-- ;}else{var m=0;for(int k=0;k<QJ.length;k++ )if(i.color==QJ[k])m=k;i.color=QJ[(m+1)%QJ.length];j-- ;}}}}var l=false;for(int h=0;h<10;h++ )for(int g=0;g<10;g++ )l=l||(BF(g,h)==2);return l;} QF(){for(int g=0;g<10;g++ )for(int h=1;h<9;h++ )if(SJ[(h-1)+g*10].SD(SJ[h+g*10])&&SJ[h+g*10].SD(SJ[(h+1)+g*10]))return true;for(int h=0;h<10;h++ )for(int g=1;g<9;g++ )if(SJ[h+(g-1)*10].SD(SJ[h+g*10])&&SJ[h+g*10].SD(SJ[h+(g+1)*10]))return true;return false;} qJ( l, j, k){for(int h=0;h<20;h++ ){var g=rI~/k;var i=j*g+NJ.nextInt(g);if(RJ[i].FB==u.BD){RJ[i].FB=l;return;}}} CH(){RJ=new List<JB>();for(int g=0;g<rI;g++ ){var i=QJ[NJ.nextInt(QJ.length)];var h=NJ.nextInt(2);RJ.add(new JB(i,h));}for(int g=0;g<yI*2;g++ )qJ("Lock${(g%yI)+1}",g,yI*2);for(int g=0;g<DJ;g++ )qJ(u.OB,g,DJ);for(int g=0;g<HJ;g++ )qJ(u.xB,g,HJ);for(int g=0;g<KJ;g++ )qJ(u.QE,g,KJ);for(int g=0;g<LJ;g++ )qJ(u.RE,g,LJ);} AH(){SJ=new List<JB>();var g=true;while (g){SJ.clear();for(int h=0;h<100;h++ ){var i=QJ[NJ.nextInt(QJ.length)];var j=NJ.nextInt(2);SJ.add(new JB(i,j));}g=AF();}} VF(){if(VJ||OJ!=wB.rC)return false;var l=true;VJ=true;while (l){for(int k=0;k<SJ.length;k++ ){var g=SJ[k];g.dB=false;g.FC=false;g.jB(XJ,YJ,ZJ);g.color=QJ[NJ.nextInt(QJ.length)];g.direction=NJ.nextInt(2);}l=AF()||(QF()==false);}var s=eB.LB.iB("BonusUniversal");s.play();var m=new qC();for(int i=0;i<10;i++ ){for(int j=0;j<10;j++ ){var g=SJ[i+j*10];g.WF=0.0;var h=new KC(0.0,1.0,0.2,MB.LC);h.delay=i*0.06;h.GC=(o){g.WF=o;};h.OF=(){g.jB(XJ,YJ,ZJ);};h.onComplete=(){if(m.VD()==100){jJ();rJ();UJ.clear();}};p.add(h);}}return true;} jJ(){for(int i=0;i<10;i++ ){for(int h=0;h<10;h++ ){var g=SJ[h+i*10];var l=(h<9)?SJ[h+1+i*10]:null;var m=(i<9)?SJ[h+(i+1)*10]:null;var j=false;var k=false;if(g.VC(l)){j=true;k=(g.FB==u.OB||l.FB==u.OB);}if(g.eC(m)){j=true;k=(g.FB==u.OB||m.FB==u.OB);}if(g.dB!=j||g.FC!=k){g.dB=j;g.FC=k;g.jB(XJ,YJ,ZJ);}}}} tJ( o, l, s, k, m, v){VJ=true;o.VD(k);var i=1;for(int h=0;h<k;h++ ){var g=SJ[l+h*m+(s+h*v)*10];if(g.FB==u.QE)i=i*2;if(g.FB==u.RE)i=i*5;var IB=l+h*m;var RB=s+h*v;p.fB((){g.empty=true;g.jB(XJ,YJ,ZJ);var EB=eB.LB.iB("ChainBlast");EB.play();var j=new OE(g.color,g.direction);j.x=IB*50;j.y=RB*50;p.add(j);cJ.n(j);NH(g);if(o.CF()==0)vJ();},0.1+h*0.1);}KB(new cB(cB.OE,{"Length":k,"Factor":i}));} rJ(){VJ=false;var j=new qC();for(int h=0;h<10;h++ ){for(int i=0;i<10;){var g=1;while (i+g<10&&SJ[i+g-1+h*10].VC(SJ[i+g+h*10]))g++ ;if(g>=3)tJ(j,i,h,g,1,0);i=i+g;}}for(int i=0;i<10;i++ ){for(int h=0;h<10;){var g=1;while (h+g<10&&SJ[i+(h+g-1)*10].eC(SJ[i+(h+g)*10]))g++ ;if(g>=3)tJ(j,i,h,g,0,1);h=h+g;}}if(j.value==0){if(OJ==wB.cD)KB(new cB(cB.PE,null));if(OJ==wB.dD)KB(new cB(cB.fD,null));if(OJ==wB.rC&&QF()==false)VF();}} NH( h){if(h.FB.indexOf("Lock")==0){var k=int.parse(h.FB.substring(4,5))-1;var j=TJ[k];var g=GB.gD(h.FB);g.x=h.x;g.y=h.y;n(g);var i=new mB(g,0.5,MB.rB);i.XB("x",j.x);i.XB("y",j.y-10);i.onComplete=()=>tB(g);p.add(i);p.fB(()=>IH(k),0.5);}} IH( k){var h=TJ[k];var i;if(h.zC){i=new cB(cB.CD,{"Type":"SingleLocked","Position":new NB(h.x+20,h.y)});var l=eB.LB.iB("Unlock");l.play();}else{i=new cB(cB.CD,{"Type":"SingleUnlocked","Position":new NB(h.x+20,h.y)});}KB(i);h.zC=false;h.UF(false);var j=true;for(int g=0;g<TJ.length;g++ )j=j&&(TJ[g].zC==false);if(j){var m=eB.LB.iB("BonusAllUnlock");m.play();for(int g=0;g<TJ.length;g++ ){TJ[g].zC=true;p.fB(()=>TJ[(g+k)%TJ.length].TH(),g*0.2);}p.fB(()=>KB(new cB(cB.CD,{"Type":"All","Position":new NB(280,550)})),0.75);}} vJ(){var o=new qC();for(int i=0;i<10;i++ ){var k=9;var j=8;while (k>=0){while (k>=0&&SJ[i+k*10].empty==false){k-- ;j-- ;}while (j>=0&&SJ[i+j*10].empty==true){j-- ;}if(k>=0){var g,h,l;if(j>=0){h=SJ[i+j*10];if(i>0){l=SJ[i-1+j*10];if(h.VC(l)){l.dB=false;l.jB(XJ,YJ,ZJ);}}h.dB=false;h.empty=true;h.jB(XJ,YJ,ZJ);}else{if(RJ.length>0){h=RJ[0];RJ.removeRange(0,1);}else{h=new JB(QJ[NJ.nextInt(QJ.length)],NJ.nextInt(2));}}g=SJ[i+k*10];g.color=h.color;g.direction=h.direction;g.FB=h.FB;g.dB=false;g.empty=false;g.x=50*i+25;g.y=50*j+25;g.jB(XJ,YJ,ZJ);o.VD();var m=new KC(g.y,50*k+25,0.1,MB.LC);m.GC=(s){g.y=s;};m.onComplete=(){if(o.CF()==0){jJ();rJ();xJ();}};p.add(m);}}}} kJ( g){if(g.target==XJ&&this.UB){var j=SB.min(g.HF/50,9).toInt();var h=SB.min(g.IF/50,9).toInt();var i=new NB(j,h);UJ.add(i);xJ();}} xJ(){while (OJ==wB.rC&&VJ==false&&UJ.length>0){var m=UJ[0];UJ.removeRange(0,1);var j=m.x.toInt();var k=m.y.toInt();var g=SJ[j+k*10];var i=(j>0)?SJ[j-1+k*10]:null;var o=(j<9)?SJ[j+1+k*10]:null;var h=(k>0)?SJ[j+(k-1)*10]:null;var s=(k<9)?SJ[j+(k+1)*10]:null;var l=false;if(g.FB==u.xB){var v=eB.LB.iB("ChainError");v.play();continue;}if(g.eC(h)){h.dB=false;h.jB(XJ,YJ,ZJ);}if(g.VC(i)){i.dB=false;i.jB(XJ,YJ,ZJ);}g.direction=1-g.direction;g.dB=false;g.FC=false;var IB=eB.LB.iB("ChainRotate");IB.play();if(g.VC(o)){g.dB=true;g.FC=(g.FB==u.OB||o.FB==u.OB);}if(g.eC(s)){g.dB=true;g.FC=(g.FB==u.OB||s.FB==u.OB);}g.jB(XJ,YJ,ZJ);l=l||g.dB;if(g.eC(h)){h.dB=true;h.FC=(g.FB==u.OB||h.FB==u.OB);h.jB(XJ,YJ,ZJ);l=true;}if(g.VC(i)){i.dB=true;i.FC=(g.FB==u.OB||i.FB==u.OB);i.jB(XJ,YJ,ZJ);l=true;}if(l){var EB=eB.LB.iB("ChainLink");EB.play();}rJ();}}}class cB extends CB{static const  OE="Explosion";static const  CD="Unlocked";static const  PE="Finalized";static const  fD="Timeouted";var xI;cB( h, g,[ bubbles=false]):super(h,bubbles){xI=g;} get info{return xI;}}class NE extends AB{var GI;NE( j){var g=new IC();g.NC=new SE("Arial",30,0xFFFFFF,CC:true,align:qB.JC);g.width=110;g.height=36;g.wordWrap=false;g.x=646;g.y=130;g.UB=false;g.text=j.toString();g.x=-g.width/2;g.y=-g.height/2;GI=new AB();GI.n(g);n(GI);var i=new KC(0.0,1.0,1.5,MB.rB);i.GC=(h){GI.alpha=1-h;GI.y=-h*50;GI.uB=1.0+0.1*SB.sin(h*10);GI.DC=1.0+0.1*SB.cos(h*10);};i.onComplete=(){this.FE();};p.add(i);}}class fF extends AB{var II;var RI;var bI;var SI;fF(){var l=new BB(GB.LB.q("ExitBox"));n(l);var g=new IC();g.NC=new SE("Arial",24,0xFFFFFF,CC:true,align:qB.JC);g.width=240;g.height=100;g.wordWrap=true;g.text=aC.LB.oC("GENexitquery");g.x=47;g.y=150-g.IE/2;g.UB=false;n(g);II=new nD(7,GB.LB.q("ExitGauge"),HD.wD);II.x=268;II.y=25;II.addEventListener("TimeOver",bJ);n(II);II.QD("TimeOver",0);II.start();var h=new BB(GB.LB.q("ExitYesButtonNormal"));var i=new BB(GB.LB.q("ExitYesButtonPressed"));RI=new sC(h,h,i,i);RI.x=68;RI.y=239;RI.addEventListener(t.TC,fJ);n(RI);var j=new BB(GB.LB.q("ExitNoButtonNormal"));var k=new BB(GB.LB.q("ExitNoButtonPressed"));bI=new sC(j,j,k,k);bI.x=173;bI.y=232;bI.addEventListener(t.TC,hJ);n(bI);this.addEventListener(CB.tC,(m)=>p.add(II));this.addEventListener(CB.vC,(m)=>p.remove(II));} iJ( g){if(SI!=null){SI(g);SI=null;}} fJ( g){iJ(true);} hJ( g){iJ(false);} bJ( g){iJ(false);}show( g){SI=g;}}class aD{var xE;var XF;var YF;var angle;var aF;var YB;}class eF extends AB{var LI;var VI;var fI;var lI;var nI;eF(){fI=eB.LB.iB("Warning");lI=null;LI=GB.oF();VI=new BB(LI[0]);n(VI);} start(){lI=fI.play();p.remove(nI);nI=new KC(0,80,9.0,MB.LC);nI.GC=(h){var g=h.toInt()%8;VI.PB=LI[(g<=4)?g+1:8-g];};p.add(nI);} stop(){if(lI!=null){lI.stop();lI=null;}p.remove(nI);VI.PB=LI[0];}}class JB{var DI;var EI;var NI;var UI;var ZI;var cI;var iI;var mI;var pI;var tI;var wI;JB( g, h){DI=g;EI=h;NI=u.BD;UI=-1000;ZI=-1000;cI=false;iI=false;mI=false;pI=null;tI=null;wI=null;} get color=>DI; set color( g){DI=g;} get direction=>EI; set direction( g){EI=g;} get FB=>NI; set FB( g){NI=g;} get dB=>cI; set dB( g){cI=g;} get FC=>iI; set FC( g){iI=g;} get empty=>mI; set empty( g){mI=g;} SD( g){var h=g!=null&&(g.color==DI||g.FB==u.OB||NI==u.OB)&&g.FB!=u.xB&&NI!=u.xB;return h;} VC( g){var h=g!=null&&(g.color==DI||g.FB==u.OB||NI==u.OB)&&g.direction==0&&EI==0&&g.FB!=u.xB&&NI!=u.xB;return h;} eC( g){var h=g!=null&&(g.color==DI||g.FB==u.OB||NI==u.OB)&&g.direction==1&&EI==1&&g.FB!=u.xB&&NI!=u.xB;return h;} get x=>UI; set x( g){UI=g;if(pI!=null)pI.x=g;if(tI!=null)tI.x=g;if(wI!=null)wI.x=g;} get y=>ZI; set y( g){ZI=g;if(pI!=null)pI.y=g;if(tI!=null)tI.y=g;if(wI!=null)wI.y=g;} set WF( h){if(pI!=null){var g=1+0.3*SB.sin(h*SB.PI);pI.uB=g;pI.DC=g;}} jB( g, h, i){if(pI!=null){pI.parent.tB(pI);pI=null;}if(tI!=null){tI.parent.tB(tI);tI=null;}if(wI!=null){wI.parent.tB(wI);wI=null;}if(empty==false){switch (NI){case u.OB:pI=new dH(EI);pI.x=UI;pI.y=ZI;g.n(pI);break;case u.xB:pI=GB.gD(u.xB);pI.x=UI;pI.y=ZI;g.n(pI);break;default:pI=GB.eD(DI,EI);pI.x=UI;pI.y=ZI;g.n(pI);break;}if(cI){tI=iI?new bH(EI):GB.hF(DI,EI);tI.x=UI+((EI==0)?25:0);tI.y=ZI+((EI==1)?25:0);h.n(tI);}switch (NI){case u.BD:break;case u.xB:break;case u.OB:break;default:wI=new cH(NI);wI.x=UI;wI.y=ZI;i.n(wI);break;}}}}class gF extends AB{var HI;var QI;var aI;var jI;var II;var oI;var qI;var sI;var vI;var FI;var zI;var AJ;var BJ;var CJ;var EJ;var FJ;var GJ;var IJ;var JJ;gF(){var j=new BB(GB.LB.q("ShuffleButtonNormal"));var h=new BB(GB.LB.q("ShuffleButtonPressed"));QI=new sC(j,j,h,h);QI.addEventListener(t.TC,WJ);QI.x=530;QI.y=525;n(QI);var g=new BB(GB.LB.q("ExitButtonNormal"));var i=new BB(GB.LB.q("ExitButtonPressed"));aI=new sC(g,g,i,i);aI.addEventListener(t.TC,eJ);aI.x=700;aI.y=500;n(aI);HI=new cF();HI.x=540;HI.y=-1000;n(HI);II=new nD(10,GB.LB.q("TimeGauge"),HD.rD);II.x=659;II.y=244;II.addEventListener("TimeShort",gJ);II.addEventListener("TimeOver",bJ);n(II);p.add(II);oI=new bF();oI.x=640;oI.y=230;n(oI);qI=new eF();qI.x=665;qI.y=160;n(qI);sI=new IC();sI.NC=new SE("Arial",30,0xD0D0D0,CC:true,align:qB.JC);sI.width=140;sI.height=36;sI.wordWrap=false;sI.x=646;sI.y=130;sI.UB=false;sI.text="0";sI.uB=0.9;n(sI);vI=new IC();vI.NC=new SE("Arial",20,0xFFFFFF,CC:true,align:qB.JC);vI.width=44;vI.height=30;vI.wordWrap=false;vI.x=610;vI.y=559;vI.UB=false;vI.text="3x";n(vI);EJ=new AB();n(EJ);FJ=new AB();n(FJ);GJ=new AB();n(GJ);IJ=eB.LB.iB("Intro");JJ=IJ.play();} start(){FI=1;zI=1;CJ=0;AJ=3;var g=new bD(aC.LB.oC("ESCStartText"));FJ.n(g);p.fB(()=>oI.NF(21),1);g.show(()=>p.fB(()=>lJ(),0.5));} lJ(){if(jI!=null&&this.contains(jI))EJ.tB(jI);var m=FI;var g=0;var h=0;switch (FI){case 01:h=50;jI=new dF(g=40,3,0,0,0,0,[0,1,2]);break;case 02:h=45;jI=new dF(g=45,3,1,0,0,0,[2,3,4]);break;case 03:h=40;jI=new dF(g=50,4,2,2,1,0,[5,6,7]);break;case 04:h=35;jI=new dF(g=55,4,3,3,2,0,[0,2,6]);break;case 05:h=30;jI=new dF(g=60,5,4,4,2,1,[1,3,5]);break;case 06:h=34;jI=new dF(g=60,5,5,5,3,2,[1,2,4,7]);break;case 07:h=33;jI=new dF(g=65,5,5,6,3,2,[0,1,2,3]);break;case 08:h=32;jI=new dF(g=70,5,5,6,3,2,[0,2,5,6]);break;case 09:h=31;jI=new dF(g=75,5,5,6,3,2,[1,4,5,7]);break;default:h=30;jI=new dF(g=80+(FI-10)*5,5,5,6,3,2,[0,1,2,3]);break;}BJ=g;if(AJ<3){AJ++ ;vI.text="${AJ}x";}jI.addEventListener(cB.OE,mJ);jI.addEventListener(cB.CD,nJ);jI.addEventListener(cB.PE,oJ);jI.addEventListener(cB.fD,pJ);jI.x=20;jI.y=16;jI.UB=false;EJ.n(jI);II.reset(h);II.QD("TimeShort",9);II.QD("TimeOver",0);II.pause();HI.level=m;HI.yE=g;HI.y=-210;var k=new mB(HI,0.4,MB.rB);k.XB("y",-90);p.add(k);var j=new bD(aC.LB.oC("ESCLevelBoxText").replaceAll("{0}","${g}"));FJ.n(j);j.show((){jI.UB=true;II.start();if(IJ!=null){var i=new KC(1.0,0.0,4.0,MB.LC);i.GC=(l){JJ.EC.volume=l;JJ.EC=JJ.EC;};i.onComplete=(){JJ.stop();oI.HH();};p.add(i);IJ=null;}});} gJ( g){qI.start();} bJ( g){jI.ZF(wB.dD);} nJ( j){var g=0;var k=j.info["Position"];var i=j.info["Type"];if(i=="SingleLocked")g=3000;if(i=="SingleUnlocked")g=1000;if(i=="All")g=10000;var h=new NE(g);h.x=k.x;h.y=k.y;EJ.n(h);CJ=CJ+g;sI.text="${CJ}";} mJ( j){var g=BJ;var i=j.info["Length"];var k=j.info["Factor"];g=(g>i)?g-i:0;BJ=g;HI.yE=g;if(g==0)jI.ZF(wB.cD);var h=0;switch (i){case 3:h=1000;break;case 4:h=2000;break;case 5:h=5000;break;default:h=5000;}CJ=CJ+h*k;sI.text="${CJ}";} oJ( m){II.pause();qI.stop();var l=eB.LB.iB("Laugh");var k=eB.LB.iB("LevelUp");l.play();oI.NF(3);var g=GB.iF();g.x=55;g.y=260;EJ.n(g);p.fB((){jI.EF();k.play();},2.0);p.fB((){var j=(II.QH*1000).toInt();var h=new NE(j);h.x=704;h.y=360;EJ.n(h);CJ=CJ+j;sI.text="${CJ}";},2.5);var i=new mB(HI,0.5,MB.rB);i.XB("y",-210);i.delay=3.0;p.add(i);p.fB((){EJ.tB(g);},3.5);p.fB((){FI++ ;lJ();},4.0);} pJ( j){qI.stop();jI.EF();var g;var i;if(zI>0){zI-- ;g=new bD(aC.LB.oC("GEN2ndchancetime"));FJ.n(g);i=eB.LB.iB("LevelUp");i.play();g.show((){p.fB(()=>lJ(),0.5);var h=new mB(HI,0.5,MB.rB);h.XB("y",-210);p.add(h);});}else{g=new bD(aC.LB.oC("GENtimeup"));FJ.n(g);i=eB.LB.iB("GameOver");i.play();g.show((){p.fB(()=>sJ(),0.5);var h=new mB(HI,0.5,MB.rB);h.XB("y",-210);p.add(h);});}} WJ( h){if(jI!=null&&AJ>0){var g=jI.VF();if(g){AJ=AJ-1;vI.text="${AJ}x";}}} eJ( j){var h=new AB();h.n(new BB(new DB(800,600,false,0x000000)));h.alpha=0.6;GJ.n(h);var g=new fF();g.x=235;g.y=150;GJ.n(g);g.show(( i){GJ.tB(g);if(i==false)GJ.tB(h);else uJ(false);});}sJ(){var h=new AB();var j=new BB(GB.LB.q("ExitBox"));h.n(j);var g=new IC();g.NC=new SE("Arial",30,0xFFFFFF,CC:true,align:qB.JC);g.width=240;g.height=200;g.wordWrap=true;g.text=aC.LB.oC("GENgameover");g.x=47;g.y=30+(g.height-g.IE)/2;g.UB=false;h.n(g);h.x=110;h.y=-h.height;FJ.n(h);var k=eB.LB.iB("Laugh");p.fB(()=>k.play(),0.3);var i=new mB(h,0.3,MB.rB);i.XB("y",150);p.add(i);p.fB(()=>uJ(true),5.0);h.addEventListener(t.TC,( l)=>uJ(true));}var wJ=false; uJ( g){II.pause();if(wJ==false){wJ=true;}}}class cF extends AB{var FI;var OI;var WI;var eI;var kI;cF(){n(new BB(GB.LB.q("InfoBox")));OI=new IC();OI.NC=new SE("Arial",35,0xFFFFFF,CC:true,align:qB.JC);OI.width=220;OI.height=40;OI.wordWrap=false;OI.text="Level 1";OI.x=20;OI.y=115;OI.YB=-2*SB.PI/180;n(OI);eI=new IC();eI.NC=new SE("Arial",25,0xFFFFFF,CC:true,align:qB.JC);eI.width=220;eI.height=30;eI.wordWrap=false;eI.text="40";eI.x=-eI.width/2;eI.y=-eI.height/2;eI.YB=-2*SB.PI/180;kI=new AB();kI.n(eI);kI.x=150;kI.y=172;n(kI);var g=GB.eD(3,0);g.x=110;g.y=171;g.YB=-2*SB.PI/180;g.uB=g.DC=0.6;n(g);} set level( g){FI=g;OI.text="Level ${FI}";} set yE( g){WI=g;eI.text="${WI}";}}class bD extends AB{var KI;var SI;bD( i){var h=new BB(GB.LB.q("MessageBox"));n(h);var g=new IC();g.NC=new SE("Arial",24,0xFFFFFF,CC:true,align:qB.JC);g.width=240;g.height=200;g.wordWrap=true;g.text=i;g.x=47;g.y=130-g.IE/2;g.UB=false;n(g);KI=null;addEventListener(t.TC,PJ);}void show( h){this.parent.n(this);this.x=-this.width;this.y=150;SI=h;var g=new mB(this,0.3,MB.rB);g.XB("x",110);g.onComplete=()=>KI=p.fB(dJ,10);p.add(g);} dJ(){if(KI!=null){p.remove(KI);KI=null;SI();var g=new mB(this,0.4,MB.uE);g.XB("x",800);g.onComplete=()=>this.parent.tB(this);p.add(g);}} PJ( g){dJ();}}class AD extends AB{var DI;var MI;var XI;var hI;AD( g){DI=g;XI=GB.mF(g);hI=true;MI=new BB(XI[0]);MI.x=-34;MI.y=-50;n(MI);} get zC=>hI; set zC( g){hI=g;} UF( g){MI.PB=XI[g?0:4];} TH(){var i=new KC(0.0,1.0,2.0,MB.rB);i.GC=(j){uB=DC=1.0+0.2*SB.sin(j*4*SB.PI);};var g=new mB(this,0.2,MB.rB);g.XB("alpha",0.0);g.delay=2.0;g.onComplete=()=>UF(hI);var h=new mB(this,0.2,MB.uE);h.XB("alpha",1);h.delay=2.2;p.add(i);p.add(g);p.add(h);}}class dH extends AB implements kB{var MI;var dI;var YI;dH( h){this.UB=false;YI=0.0;dI=GB.kF(h);MI=new BB(dI[0]);MI.x=-25;MI.y=-25;n(MI);addEventListener(CB.tC,(g)=>p.add(this));addEventListener(CB.vC,(g)=>p.remove(this));} BC( g){YI+= g;var h=(YI*10).toInt()%dI.length;MI.PB=dI[h];return true;}}class bH extends AB implements kB{var MI;var dI;var YI;bH( h){this.UB=false;YI=0.0;dI=GB.lF(h);MI=new BB(dI[0]);MI.x=-25;MI.y=-25;n(MI);addEventListener(CB.tC,(g)=>p.add(this));addEventListener(CB.vC,(g)=>p.remove(this));} BC( g){YI+= g;var h=(YI*10).toInt()%dI.length;MI.PB=dI[h];return true;}}class cH extends AB implements kB{var MI;var YI;cH( h){this.UB=false;YI=0.0;MI=GB.gD(h);n(MI);addEventListener(CB.tC,(g)=>p.add(this));addEventListener(CB.vC,(g)=>p.remove(this));} BC( g){YI+= g;this.YB=SB.sin(YI*7)*10*SB.PI/180;return true;}}class qC{var value=0; VD([ inc=1])=>(value+= inc); CF([ dec=1])=>(value-= dec);}class u{static const  BD="None";static const  OB="Joker";static const  xB="Block";static const  QE="Double";static const  RE="Quint";}class bF extends AB{var JI;var TI;var gI;bF(){JI=GB.nF();TI=new BB(JI[0]);TI.x=-TI.width/2;TI.y=-TI.height/2;n(TI);gI=null;} NF( g){p.remove(gI);gI=new KC(0,g,0.5*g,MB.LC);gI.GC=(h){var i=((h*JI.length)%JI.length).toInt();TI.PB=JI[i];TI.y=SB.sin(h*2*SB.PI)*3-TI.height/2;};p.add(gI);} HH(){p.remove(gI);TI.PB=JI[0];}}class wB{static const  rC=1;static const  cD=2;static const  dD=3;}class aC{static var LB;}class eB{static var LB;}class GB{static var LB;static  eD( h, i){var g=new BB(LB.OC("Elements").q("Chain${h}${i}"));g.QC=25;g.RC=25;return g;}static  hF( h, i){var g=new BB(LB.OC("Elements").q("Link${h}${i}"));g.QC=25;g.RC=25;return g;}static  gD( h){var g=new BB(LB.OC("Elements").q(h));g.QC=25;g.RC=25;return g;}static  iF(){var m=new AB();var l=0;var o=LB.OC("Levelup");for(int k=0;k<7;k++ ){var h=new BB(o.q("LevelUp${k}"));h.x=-h.width/2;h.y=-h.height/2;var g=new AB();g.n(h);g.x=l+h.width/2;g.uB=0;g.DC=0;m.n(g);var i=new mB(g,2.0,MB.nG);i.XB("scaleX",1.0);i.XB("scaleY",1.0);i.delay=k*0.05;var j=new mB(g,0.4,MB.LC);j.XB("scaleX",0.0);j.XB("scaleY",0.0);j.delay=3.0;p.add(i);p.add(j);l=l+5+h.width;}return m;}static  kF( i){var h=LB.OC("Elements");var g=new List<DB>();g.add(h.q("JokerChain${i}0"));g.add(h.q("JokerChain${i}1"));g.add(h.q("JokerChain${i}2"));g.add(h.q("JokerChain${i}3"));g.add(h.q("JokerChain${i}4"));return g;}static  lF( i){var h=LB.OC("Elements");var g=new List<DB>();g.add(h.q("JokerLink${i}0"));g.add(h.q("JokerLink${i}1"));g.add(h.q("JokerLink${i}2"));g.add(h.q("JokerLink${i}3"));g.add(h.q("JokerLink${i}4"));return g;}static  mF( h){var i=LB.OC("Locks");var g=new List<DB>();g.add(i.q("Lock${h}0"));g.add(i.q("Lock${h}1"));g.add(i.q("Lock${h}2"));g.add(i.q("Lock${h}3"));g.add(i.q("Lock${h}4"));return g;}static  nF(){var h=LB.OC("Head");var g=new List<DB>();g.add(h.q("Head1"));g.add(h.q("Head2"));g.add(h.q("Head3"));g.add(h.q("Head2"));g.add(h.q("Head1"));return g;}static  oF(){var h=LB.OC("Alarm");var g=new List<DB>();g.add(h.q("Alarm0"));g.add(h.q("Alarm1"));g.add(h.q("Alarm2"));g.add(h.q("Alarm3"));g.add(h.q("Alarm4"));g.add(h.q("Alarm5"));return g;}}class OE extends AB implements kB{var uI;var YI;OE( o, v){uI=new List<aD>();YI=0.0;this.UB=false;var s=GB.eD(o,v);var m=new SB.Random();var i;var l;var EB;for(int h=0;h<=1;h++ ){for(int g=0;g<=1;g++ ){if(g==0&&h==0){i=SB.PI*1.15;YB=-SB.PI*2;}if(g==1&&h==0){i=SB.PI*1.85;YB=SB.PI*2;}if(g==1&&h==1){i=SB.PI*0.15;YB=SB.PI*2;}if(g==0&&h==1){i=SB.PI*0.85;YB=-SB.PI*2;}i=i+0.2*SB.PI*m.nextDouble();l=80.0+40.0*m.nextDouble();var j=new BB(s.PB);j.RD=new QB(g*25,h*25,25,25);j.QC=12.5+g*25;j.RC=12.5+h*25;j.x=g*25;j.y=h*25;n(j);var k=new aD();k.xE=j;k.XF=g*25+12.5;k.YF=h*25+12.5;k.angle=i;k.aF=l;k.YB=YB;uI.add(k);}}} BC( m){YI=SB.min(0.8,YI+m);var l=981.0;for(int i=0;i<uI.length;i++ ){var g=uI[i];var h=g.xE;var k=g.angle;var j=g.aF;var s=g.YB;var o=g.XF+YI*(SB.cos(k)*j);var v=g.YF+YI*(SB.sin(k)*j+YI*l*0.5);h.x=o;h.y=v;h.YB=YI*s;}if(YI>=0.6)this.alpha=(0.8-YI)/0.2;if(YI>=0.8)this.FE();return (YI<0.8);}}var DD;var bC;var ED;var p;var SC;var FD;var yB; main(){DD=new nC("StageBackground",ZC.query('#stageBackground'));bC=new nC("StageForeground",ZC.query('#stageForeground'));ED=new uF();ED.wE(DD);ED.wE(bC);p=ED.EH;var h=DB.vE("images/Loading.png");h.then((g){SC=new BB(g);SC.QC=20;SC.RC=20;SC.x=400;SC.y=270;bC.n(SC);FD=new mB(SC,100,MB.LC);FD.XB("rotation",100.0*2.0*SB.PI);p.add(FD);yB=new IC();yB.NC=new SE("Arial",20,0xA0A0A0,CC:true);yB.width=240;yB.height=40;yB.text="... loading ...";yB.x=400-yB.VH/2;yB.y=320;yB.UB=false;bC.n(yB);jF();});} jF(){var g=new gC();g.hB("Background","images/Background.jpg");g.hB("ExitBox","images/ExitBox.png");g.hB("ExitButtonNormal","images/ExitButtonNormal.png");g.hB("ExitButtonPressed","images/ExitButtonPressed.png");g.hB("ExitGauge","images/ExitGauge.png");g.hB("ExitNoButtonNormal","images/ExitNoButtonNormal.png");g.hB("ExitNoButtonPressed","images/ExitNoButtonPressed.png");g.hB("ExitYesButtonNormal","images/ExitYesButtonNormal.png");g.hB("ExitYesButtonPressed","images/ExitYesButtonPressed.png");g.hB("InfoBox","images/InfoBox.png");g.hB("MessageBox","images/MessageBox.png");g.hB("ShuffleButtonNormal","images/ShuffleButtonNormal.png");g.hB("ShuffleButtonPressed","images/ShuffleButtonPressed.png");g.hB("TimeGauge","images/TimeGauge.png");g.xC("Alarm","images/AlarmTextureAtlas.json",cC.mC);g.xC("Head","images/HeadTextureAtlas.json",cC.mC);g.xC("Elements","images/ElementsTextureAtlas.json",cC.mC);g.xC("Levelup","images/LevelupTextureAtlas.json",cC.mC);g.xC("Locks","images/LocksTextureAtlas.json",cC.mC);g.bB("BonusAllUnlock","sounds/BonusAllUnlock.mp3");g.bB("BonusUniversal","sounds/BonusUniversal.mp3");g.bB("ChainBlast","sounds/ChainBlast.mp3");g.bB("ChainBlastSpecial","sounds/ChainBlastSpecial.mp3");g.bB("ChainError","sounds/ChainError.mp3");g.bB("ChainFall","sounds/ChainFall.mp3");g.bB("ChainHelp","sounds/ChainHelp.mp3");g.bB("ChainLink","sounds/ChainLink.mp3");g.bB("ChainRotate","sounds/ChainRotate.mp3");g.bB("Click","sounds/Click.mp3");g.bB("GameOver","sounds/GameOver.mp3");g.bB("Laugh","sounds/Laugh.mp3");g.bB("LevelUp","sounds/LevelUp.mp3");g.bB("PointsCounter","sounds/PointsCounter.mp3");g.bB("Unlock","sounds/Unlock.mp3");g.bB("Warning","sounds/Warning.mp3");g.bB("Intro","sounds/Intro.mp3");g.addText("ESCAPE_INS_AIM_0","Connect at least 3 chain links of the same colour to a horizontal or vertical chain.");g.addText("ESCAPE_INS_DES_0","You can change the direction of a chain link by touching it.");g.addText("ESCAPE_INS_TIP_0","Earn extra points for connecting chain links displaying a key symbol.");g.addText("ESCBlockErrorHint","Sorry but block chains can´t be twisted!");g.addText("ESCLevelBoxText","Connect {0} chain links and help the crook to escape!");g.addText("ESCNoActionHint","Press on the chain links to twist them.");g.addText("ESCNoComboHint","You have to connect at least 3 chain links of the same colour.");g.addText("ESCStartText","Form horizontal or vertical same-colour chains and become an escape agent!");g.addText("ESCtogo","Chain links:");g.addText("GENexitquery","Do you really want to quit the game?");g.addText("GEN2ndchancetime","Time is up. Second chance!");g.addText("GENtimeup","Sorry! Your time is up.");g.addText("GENgameover","Game Over");g.load().then((j){bC.tB(SC);bC.tB(yB);p.remove(FD);GB.LB=g;eB.LB=g;aC.LB=g;var i=new BB(GB.LB.q("Background"));DD.n(i);DD.PH=hC.uD;var h=new gF();bC.n(h);h.start();});}abstract class jC extends lB{var oK;var uK=true;var FL=true;jC(){oK=new List<w>();}qF get on=>new qF(this); n( g){if(g.parent==this){var h=oK.indexOf(g);oK.removeAt(h);oK.add(g);}else{oG(g,oK.length);}} oG( g, h){if(h<0&&h>oK.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){oK.removeAt(oK.indexOf(g));if(h>oK.length)h-- ;oK.insertRange(h,1,g);}else{g.FE();g.VN(this);oK.insertRange(h,1,g);g.KB(new CB(CB.DG,true));if(this.XD!=null)WN(g,new CB(CB.tC));}} tB( h){var g=oK.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");OH(g);} OH( g){if(g<0&&g>=oK.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=oK[g];h.KB(new CB(CB.VG,true));if(this.XD!=null)WN(h,new CB(CB.vC));h.VN(null);oK.removeAt(g);} contains( g){for(;g!=null;g=g.DM)if(g==this)return true;return false;} sB( m,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new QB.xH();if(oK.length==0)return super.sB(m,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var l=double.NEGATIVE_INFINITY;var k=double.NEGATIVE_INFINITY;var o=oK.length;for(int j=0;j<o;j++ ){ZM.DE(oK[j].yM,m);var g=oK[j].sB(ZM,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>l)l=g.right;if(g.bottom>k)k=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=l-h;returnRectangle.height=k-i;return returnRectangle;} PC( EB, o){var l=null;for(int j=oK.length-1;j>=0;j-- ){var i=oK[j];if(i.visible){var g=i.yM;var m=EB-g.WC;var k=o-g.XC;var s=(g.d*m-g.c*k)/g.fC;var v=(g.a*k-g.b*m)/g.fC;var h=i.PC(s,v);if(h!=null){if(h is lB)if(h.UB)return uK?h:this;l=this;}}}return l;} nB( i){for(int g=0;g<oK.length;g++ ){var h=oK[g];if(h.visible)i.SF(h);}} WN( h, i){h.KB(i);if(h is jC){var j=new List<w>.from(h.oK);var k=j.length;for(int g=0;g<k;g++ )WN(j[g],i);}}}abstract class w extends aB implements XE{var mK=0.0;var tK=0.0;var BL=0.0;var GL=0.0;var ML=1.0;var SL=1.0;var YL=0.0;var fL;var hL;var oL=1.0;var rL=true;var EK="";var DM=null;var mask;var ZM;var cM;w(){fL=new WB.CI();hL=true;ZM=new WB.CI();cM=new WB.CI();} get x=>mK; get y=>tK; get QC=>BL; get RC=>GL; get uB=>ML; get DC=>SL; get YB=>YL; get alpha=>oL; get visible=>rL; get name=>EK; get parent=>DM;bE get on=>new bE(this); get root{var g=this;while (g.DM!=null)g=g.DM;return g;} get XD{var g=this.root;if(g is nC)return g;return null;} set x( g){mK=g;hL=true;} set y( g){tK=g;hL=true;} set QC( g){BL=g;hL=true;} set RC( g){GL=g;hL=true;} set uB( g){ML=g;hL=true;} set DC( g){SL=g;hL=true;} set YB( g){YL=g;hL=true;} set alpha( g){oL=g;hL=true;} get width=>sB(yM).width; get height=>sB(yM).height; set width( h){this.uB=1;var g=this.width;this.uB=(g!=0.0)?h/g:1.0;} set height( h){this.DC=1;var g=this.height;this.DC=(g!=0.0)?h/g:1.0;} FE(){if(DM!=null)DM.tB(this);} get yM{if(hL){hL=false;if(YL==0.0){fL.TF(ML,0.0,0.0,SL,mK-BL*ML,tK-GL*SL);}else{var g=SB.cos(YL);var h=SB.sin(YL);var i=ML*g;var l=ML*h;var k=-SL*h;var j=SL*g;var m=mK-BL*i-GL*k;var o=tK-BL*l-GL*j;fL.TF(i,l,k,j,m,o);}}return fL;} sB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new QB.xH();returnRectangle.x=g.WC;returnRectangle.y=g.XC;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} PC( g, h){if(sB(cM).contains(g,h))return this;return null;} pC( h){ZM.xG();for(w g=this;g!=null;g=g.DM)ZM.concat(g.yM);ZM.DH();return ZM.XH(h);} KB( h){var g=null;if(h.BE||h.bubbles)for(w j=DM;j!=null;j=j.DM)if(j.wG(h.type)){if(g==null)g=new List<w>();g.add(j);}if(h.BE&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.GE==false)g[i].jM(h,this,g[i],dC.dE);if(h.GE==false)jM(h,this,this,dC.KD);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.GE==false)g[i].jM(h,this,g[i],dC.OG);} VN( h){for(var g=h;g!=null;g=g.DM)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");DM=h;} nB( g);}abstract class lB extends w{var rG=false;var UB=true;var wH=true;var tabIndex=0;WE get on=>new WE(this);}class GD{static var OD;static  get PD{if(OD==null){try {OD=new ZC.AudioContext();}catch (g){OD=null;}}return OD;}static var wC;static  get jG{if(wC==null){wC=(PD!=null)?"WebAudioApi":"AudioElement";var g=ZC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))wC="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))wC="Mock";}return wC;}}class ZE{var target=null;var MC=false;var CE=0;var yC=0;var LF,MF;var JF,KF;ZE(this.LF,this.MF,this.JF,this.KF);}class zB extends CB{static const  eE="touchBegin";static const  gE="touchEnd";static const  iE="touchCancel";static const  mE="touchMove";static const  XG="touchOver";static const  YG="touchOut";var fM;var hM;var kM,lM;var mM,nM;var sL;var JM;var uL;var xL;var pM;var rM;var sM;zB( g,[ bubbles=false]):super(g,bubbles){bM(g,bubbles);} bM( g,[ bubbles=false]){super.bM(g,bubbles);fM=0;hM=false;kM=lM=0;mM=nM=0;sL=false;JM=false;uL=false;xL=false;pM=1.00;rM=0;sM=0;}set SN( g){kM=g.x;lM=g.y;}set TN( g){mM=g.x;nM=g.y;} get YD=>fM; get HF=>kM; get IF=>lM; get altKey=>sL; get ctrlKey=>uL; get shiftKey=>xL;}class CB{static const  DG="added";static const  tC="addedToStage";static const  vD="enterFrame";static const  VG="removed";static const  vC="removedFromStage";var yJ;var tM;var vM;var AN;var BN;var DN;var GN;CB( g,[ bubbles=false]){bM(g,bubbles);} bM( g,[ bubbles=false]){yJ=g;tM=bubbles;vM=dC.KD;AN=null;BN=null;DN=false;GN=false;} get GE=>DN; get UH=>GN; get type=>yJ; get eventPhase=>vM; get bubbles=>tM; get BE=>true; get target=>AN;}class AB extends jC{var jH=false;var KE=false;}class hD implements kB{var VK;var gK;var sK;hD(){sK=0.0;VK=new List<kB>();gK=0;} add( g){if(g==null)return;if(gK>=VK.length)VK.add(g);else VK[gK]=g;gK++ ;} remove( h){if(h==null)return;for(int g=0;g<gK;g++ )if(VK[g]==h)VK[g]=null;} fB( h, i){var g=new mD(h,i);add(g);return g;} BC( j){sK+= j;var k=gK;var h=0;for(int g=0;g<k;g++ ){var i=VK[g];if(i!=null&&i.BC(j)){if(h!=g)VK[h]=i;h++ ;}}for(int g=k;g<gK;g++ )VK[h++ ]=VK[g];for(int g=h;g<gK;g++ )VK[g]=null;gK=h;return true;}}class dC{static const  dE=1;static const  KD=2;static const  OG=3;}abstract class XE{ nB( g);}class BB extends w{var PB;var MH;var RD;BB([this.PB=null,this.MH="auto"]){RD=null;} sB( h,[ returnRectangle]){var g=(PB!=null)?PB.width:0;var i=(PB!=null)?PB.height:0;return AE(h,g,i,returnRectangle);} PC( g, h){if(PB!=null&&g>=0.0&&h>=0.0&&g<PB.width&&h<PB.height)return this;return null;} nB( g){if(PB!=null){if(RD==null)PB.nB(g);else PB.RF(g,RD);}}}class tF extends CB{var KK;tF( g):super(CB.vD,false){KK=g;} get BE=>false;}class aB{var UK; wG( g){return UK!=null&&UK.containsKey(g);} addEventListener( h, g,[ useCapture=false]){cL(h).add(g,useCapture);} KB( g){jM(g,this,this,dC.KD);}aE get on=>new aE(this); jM( g, i, k, j){if(UK!=null){var h=UK[g.type];if(h!=null){g.AN=i;g.BN=k;g.vM=j;g.DN=false;g.GN=false;h.KB(g);}}} cL( g){if(UK==null)UK=new Map<String,TB>();var h=UK[g];if(h==null)h=UK[g]=new TB(this,g);return h;}}class sC extends lB{var JE;var PF;var DF;var UD;var KE=true;var enabled=true;var dL;sC([this.JE,this.PF,this.DF,this.UD]){addEventListener(t.oE,zL);addEventListener(t.ND,zL);addEventListener(t.LD,zL);addEventListener(t.xD,zL);dL=this.JE;} sB( g,[ returnRectangle]){if(dL!=null){ZM.DE(dL.yM,g);return dL.sB(ZM,returnRectangle);}return super.sB(g,returnRectangle);} PC( m, j){if(this.UD!=null){var g=this.UD.yM;var h=m-g.WC;var i=j-g.XC;var k=(g.d*h-g.c*i)/g.fC;var l=(g.a*i-g.b*h)/g.fC;if(this.UD.PC(k,l)!=null)return this;}return null;} nB( g){if(dL!=null)g.SF(dL);} zL( g){if(g.type==t.ND){dL=JE;}else{dL=g.MC?DF:PF;}}}class rF{var name;var vB;var HE;rF(this.name,this.vB,this.HE);}class sF{var TD;var ZD;sF(this.TD,this.ZD);}class cC{static const  CG="json";static const  mC="jsonarray";}class AC{var LK;var cK;var rK;var AL;AC.BI( h){LK=h;cK=new List<WB>();rK=new List<double>();AL=0;for(int g=0;g<100;g++ ){cK.add(new WB.CI());rK.add(1.0);}} get context=>LK; reset(){LK.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);LK.globalAlpha=1;LK.clearRect(0,0,LK.canvas.width,LK.canvas.height);AL=0;} SF( h){AL++ ;var g=cK[AL];g.DE(h.yM,cK[AL-1]);LK.setTransform(g.a,g.b,g.c,g.d,g.WC,g.XC);LK.globalAlpha=rK[AL]=rK[AL-1]*h.oL;if(h.mask==null){h.nB(this);}else{LK.save();h.mask.nB(this);h.nB(this);LK.restore();}AL-- ;}}class hC{static const  oD="auto";static const  IG="stop";static const  uD="once";}class lD extends HB{var TK;var lK;var EL;lD(){EL=new List<JD>();TK=new ZC.AudioElement();TK.on.ended.add(lL);lK=new List<ZC.AudioElement>();lK.add(TK);ZC.document.body.elements.add(TK);}static  BG( l){var h=new lD();var g=new Completer<HB>(); j(i){if(g.future.isComplete==false)g.complete(h);} k(i){if(g.future.isComplete==false)g.completeException("Failed to load audio.");}h.TK.src=HB.sE(l);h.TK.on.canPlayThrough.add(j);h.TK.on.error.add(k);h.TK.load();return g.future;} get length{return TK.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new VB();return new JD(this,loop,soundTransform);} EM( h){var g;if(lK.length==0){g=TK.clone(true);g.on.ended.add(lL);}else{g=lK[0];lK.removeAt(0);}EL.add(h);return g;} MN( g){var h=g.TK;var i=EL.indexOf(g);EL.removeAt(i);lK.add(h);if(TK.currentTime>0&&TK.ended==false)TK.currentTime=0;} lL(j){var i=j.target;var g=null;for(int h=0;h<EL.length&&g==null;h++ )if(EL[h].TK==i)g=EL[h];if(g!=null)g.stop();}}class wF{var yJ;var HK;var XK;var kK;wF.AI( i, g, h, j){yJ=0;HK=new QB(i,g,h,j);} nB( i){var g=i.context;g.beginPath();switch (yJ){case 0:g.rect(HK.x,HK.y,HK.width,HK.height);break;case 1:g.arc(XK.x,XK.y,XK.sH,0,SB.PI*2.0,false);break;case 2:g.moveTo(kK[0].x,kK[0].y);for(int h=1;h<kK.length;h++ )g.lineTo(kK[h].x,kK[h].y);break;}g.clip();}}class TE extends CB{static const  KG="textInput";var QK="";TE( g,[ bubbles=false]):super(g,bubbles){}}class bE extends aE{bE( g):super(g);}class qF extends WE{qF( g):super(g);}class WE extends bE{WE( g):super(g); get mouseOut=>this[t.ND]; get mouseMove=>this[t.nE]; get mouseDown=>this[t.LD]; get mouseUp=>this[t.xD]; get mouseWheel=>this[t.bG]; get touchMove=>this[zB.mE]; get touchEnd=>this[zB.gE]; get touchCancel=>this[zB.iE]; get keyUp=>this[iC.fE]; get keyDown=>this[iC.qD];}class HD extends w{static const  rD='DIRECTION_UP';static const  hE='DIRECTION_RIGHT';static const  wD='DIRECTION_DOWN';static const  MD='DIRECTION_LEFT';var jL;var mL;var pL;var tL;HD( g,[ direction=MD]){if(direction!=rD&&direction!=wD&&direction!=MD&&direction!=hE){throw new ArgumentError('Invalid Gauge direction!');}jL=direction;mL=1.0;pL=g;tL=new QB.xH();gM();} get ratio=>mL;set ratio( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;mL=g;gM();} get PB=>pL;set PB( g){pL=g;gM();}gM(){if(pL==null){tL.left=0;tL.top=0;tL.right=0;tL.bottom=0;}else{var g=pL.width;var h=pL.height;switch (jL){case MD:tL.left=((1.0-mL)*g).toInt();tL.top=0;tL.right=g;tL.bottom=h;break;case rD:tL.left=0;tL.top=((1.0-mL)*h).toInt();tL.right=g;tL.bottom=h;break;case hE:tL.left=0;tL.top=0;tL.right=(mL*g).toInt();tL.bottom=h;break;case wD:tL.left=0;tL.top=0;tL.right=g;tL.bottom=(mL*h).toInt();break;}}} sB( h,[ returnRectangle]){var g=(pL!=null)?pL.width:0;var i=(pL!=null)?pL.height:0;return AE(h,g,i,returnRectangle);} PC( g, h){if(pL!=null&&g>=0.0&&h>=0.0&&g<pL.width&&h<pL.height)return this;return null;} nB( g){if(pL!=null)pL.RF(g,tL);}}class yF{static const  AG="dynamic";}class t extends CB{static const  TC="click";static const  MG="doubleClick";static const  LD="mouseDown";static const  xD="mouseUp";static const  nE="mouseMove";static const  ND="mouseOut";static const  oE="mouseOver";static const  bG="mouseWheel";static const  qE="middleClick";static const  eG="middleMouseDown";static const  gG="middleMouseUp";static const  rE="rightClick";static const  hG="rightMouseDown";static const  iG="rightMouseUp";var kM,lM;var mM,nM;var LN;var sL;var JM;var uL;var xL;var PN;var QN;var RN;t( g,[ bubbles=false]):super(g,bubbles){bM(g,bubbles);} bM( g,[ bubbles=false]){super.bM(g,bubbles);kM=lM=0;mM=nM=0;LN=false;sL=false;JM=false;uL=false;xL=false;PN=0;QN=0;RN=0;}set SN( g){kM=g.x;lM=g.y;}set TN( g){mM=g.x;nM=g.y;} get HF=>kM; get IF=>lM; get MC=>LN; get altKey=>sL; get ctrlKey=>uL; get shiftKey=>xL; get yC=>PN;}class iC extends CB{static const  qD="keyDown";static const  fE="keyUp";var sL;var uL;var xL;var BM;var JM;var NM;var QM;var SM;iC( g,[ bubbles=false]):super(g,bubbles){bM(g,bubbles);} bM( g,[ bubbles=false]){super.bM(g,bubbles);sL=false;uL=false;xL=false;BM=false;JM=false;NM=0;QM=0;SM=0;} get altKey=>sL; get ctrlKey=>uL; get shiftKey=>xL; get charCode=>NM; get keyCode=>QM; get keyLocation=>SM;}class aE{var QG;aE( g){QG=g;} operator[]( g){return QG.cL(g);}}class VE{static const  LG="none";static const  RG="touchPoint";}class qB{static const  JC="center";static const  JG="end";static const  PG="justify";static const  NG="right";}abstract class HB{static  BG( g){var h=GD.jG;if(h=="WebAudioApi")return jD.BG(g);if(h=="AudioElement")return lD.BG(g);return YE.BG(g);} get length; play([ loop=false, soundTransform]);static var UC;static  sE( g){if(UC==null){UC=new List<String>();var h=new ZC.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)UC.add("ogg");if(i.indexOf(h.canPlayType("audio/mp3",""))!=-1)UC.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)UC.add("wav");}var l=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,ignoreCase:true);var j=l.firstMatch(g);if(j==null)throw new ArgumentError("Unsupported file extension.");var k=j.group(1).toLowerCase();if(UC.indexOf(k)==-1&&UC.length>0)g="${g.substring(0,g.length-3)}${UC[0]}";return g;}}abstract class HC extends aB{ get EC; set EC( g); stop();}class VB{var volume;var LH;var qH=1;var rH=0;var vH=1;var uH=0;VB([this.volume=1,this.LH=0]);}class NB{var x;var y;NB(this.x,this.y);NB.xH():this(0,0); get length=>SB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new NB(this.x+g.x,this.y+g.y); equals( g)=>this.x==g.x&&this.y==g.y;}class QB{var x;var y;var width;var height;QB(this.x,this.y,this.width,this.height);QB.xH():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new NB(this.width,this.height); set bottom( g){this.height=g-this.y;} set left( g){this.x=g;} set right( g){this.width=g-this.x;} set top( g){this.y=g;} contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0);}class JD extends HC{var fK;var TK;var OK;var hK;JD( h, i, g){fK=h;OK=i;hK=g;TK=h.EM(this);TK.loop=OK;this.EC=g;TK.play();} get EC=>hK; set EC( g){hK=g;if(TK!=null)TK.volume=(hK!=null)?hK.volume:1;} stop(){if(TK!=null){if(TK.ended==false)TK.pause();fK.MN(this);TK=null;}}}class jD extends HB{var PK;jD(){if(GD.PD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  BG( m){var i=new jD();var g=new Completer<HB>();var h=new ZC.HttpRequest(); o( k){i.PK=k;if(g.future.isComplete==false)g.complete(i);} j(IB){if(g.future.isComplete==false)g.completeException("Failed to decode audio.");} v(s){var EB=GD.PD;EB.decodeAudioData(h.response,o,j);} l(s){if(g.future.isComplete==false)g.completeException("Failed to load audio.");}h.open('GET',HB.sE(m),true);h.responseType='arraybuffer';h.on.load.add(v);h.on.error.add(l);h.send();return g.future;} get length{return PK.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new VB();return new eH(this,loop,soundTransform);}}class eH extends HC{var bK;var hK;var OK;var LL;var TL;eH( j, h, i){bK=j;OK=h;hK=i;var g=GD.PD;LL=g.createGain();LL.connect(g.destination,0,0);LL.gain.value=(hK!=null)?SB.pow(hK.volume,2):1;TL=g.createBufferSource();TL.buffer=bK.PK;TL.loop=h;TL.connect(LL,0,0);TL.start(0);} get EC=>hK; set EC( g){hK=g;LL.gain.value=(hK!=null)?SB.pow(hK.volume,2):1;} stop(){TL.stop(0);}}class YE extends HB{YE(){}static  BG( i){var h=new YE();var g=new Completer<HB>();ZC.window.setTimeout(()=>g.complete(h),1);return g.future;} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new VB();return new fH(this,loop,soundTransform);}}class fH extends HC{var OK;var hK;fH( i, h, g){OK=h;hK=g;} get EC=>hK; set EC( g){hK=g;} stop(){}}class vF{vF();}class IC extends lB{var QK="";var aK=0x000000;var vK=null;var IL=xF.LG;var UL=pF.GG;var yJ=yF.AG;var iL=false;var nL=false;var qL=0x000000;var wL=false;var AM=0x000000;var GM=0;var KM=0;var PM;var TM;var UM=true;var XM=100;var aM=100;var dM=null;var LK=null;IC(){vK=new SE("Arial",12,0x000000);PM=new List<String>();TM=new List<iD>();} get type=>yJ; get width=>XM; get height=>aM; set text( g){QK=g;UM=true;} set NC( g){vK=g;aK=vK.color;UM=true;} set wordWrap( g){iL=g;UM=true;} set width( g){XM=g;UM=true;} set height( g){aM=g;UM=true;} get VH{ZN();return GM;} get IE{ZN();return KM;} sB( g,[ returnRectangle]){return AE(g,XM,aM,returnRectangle);} PC( g, h){if(g>=0&&h>=0&&g<XM&&h<aM)return this;return null;} nB( g){ZN();g.LK.drawImage(dM,0.0,0.0);} dN(){PM.clear();TM.clear();if(iL==false){PM.add(QK);}else{var g=new StringBuffer();var i;var h;for(String j in QK.split(" ")){i=g.length;g.add((i>0)?" ${j}":j);h=g.toString();if(LK.measureText(h).width>XM){if(i>0)h=h.substring(0,i);else j="";PM.add(h);g.clear();g.add(j);}}if(g.isEmpty==false)PM.add(g.toString());}GM=0;KM=0;for(String h in PM){var k=LK.measureText(h);var l=0;if(vK.align==qB.JC||vK.align==qB.PG)l=(XM-k.width)/2;if(vK.align==qB.NG||vK.align==qB.JG)l=XM-k.width;var m=new iD(l,k.width,vK.size,0,0,0);TM.add(m);GM=SB.max(GM,m.width);KM=KM+m.height;}} ZN(){if(UM){UM=false;var j=XM.ceil().toInt();var i=aM.ceil().toInt();if(dM==null){dM=new ZC.CanvasElement(width:j,height:i);LK=dM.context2d;}if(dM.width!=j)dM.width=j;if(dM.height!=i)dM.height=i;var g=new StringBuffer();g.add(vK.GF?"italic ":"normal ");g.add("normal ");g.add(vK.CC?"bold ":"normal ");g.add("${vK.size}px ");g.add("${vK.font},sans-serif");LK.font=g.toString();LK.textAlign="start";LK.textBaseline="top";LK.fillStyle=uC(aK);dN();if(nL){LK.fillStyle=uC(qL);LK.fillRect(0,0,XM,aM);}else{LK.clearRect(0,0,XM,aM);}var k=0;for(int h=0;h<PM.length;h++ ){var l=TM[h];LK.fillStyle=uC(aK);LK.fillText(PM[h],l.x,k);k+= l.height;}if(wL){LK.strokeStyle=uC(AM);LK.lineWidth=1;LK.strokeRect(0,0,XM,aM);}}}}class ID{static final pD=new ID();var aL;ID(){aL=new List<TB>();} add( g){aL.add(g);} remove( h){var g=aL.indexOf(h);if(g!=-1)aL[g]=null;} KB( j){var k=aL.length;var i=0;for(int g=0;g<k;g++ ){var h=aL[g];if(h!=null){j.AN=h.FF;j.BN=h.FF;j.vM=dC.KD;h.KB(j);if(i!=g)aL[i]=h;i++ ;}}for(int g=k;g<aL.length;g++ )aL[i++ ]=aL[g];aL.length=i;}}class WB{var zJ,AK,CK,DK,GK,IK;var RK;WB.CI():zJ=1.0,AK=0.0,CK=0.0,DK=1.0,GK=0.0,IK=0.0,RK=1.0; get a=>zJ; get b=>AK; get c=>CK; get d=>DK; get WC=>GK; get XC=>IK; get fC=>RK; XH( g){return new NB(g.x*zJ+g.y*CK+GK,g.x*AK+g.y*DK+IK);} concat( g){var m=zJ;var v=AK;var EB=CK;var s=DK;var l=GK;var o=IK;var RB=RK;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var gB=g.WC;var IB=g.XC;var oB=g.fC;zJ=(m*j+v*i);AK=(m*k+v*h);CK=(EB*j+s*i);DK=(EB*k+s*h);GK=(l*j+o*i+gB);IK=(l*k+o*h+IB);RK=(RB*oB);} xG(){zJ=1.0;AK=0.0;CK=0.0;DK=1.0;GK=0.0;IK=0.0;RK=1.0;} DH(){var j=zJ;var m=AK;var l=CK;var k=DK;var h=GK;var i=IK;var g=RK;zJ=(k/g);AK=-(m/g);CK=-(l/g);DK=(j/g);GK=-(zJ*h+CK*i);IK=-(AK*h+DK*i);RK=(1.0/g);} TF( g, j, i, h, k, l){zJ=g;AK=j;CK=i;DK=h;GK=k;IK=l;RK=(g*h-j*i);} DE( g, h){var o=g.a;var EB=g.b;var IB=g.c;var v=g.d;var m=g.WC;var s=g.XC;var gB=g.fC;var k=h.a;var l=h.b;var j=h.c;var i=h.d;var oB=h.WC;var RB=h.XC;var YC=h.fC;zJ=(o*k+EB*j);AK=(o*l+EB*i);CK=(IB*k+v*j);DK=(IB*l+v*i);GK=(m*k+s*j+oB);IK=(m*l+s*i+RB);RK=(gB*YC);}}class SE{var font;var size;var color;var CC;var GF;var YH;var align;var FH;var RH;var zG;var EE;var letterSpacing=0;var hH=0;var iH=false;var pH=false;SE(this.font,this.size,this.color,{this.CC: false,this.GF: false,this.YH: false,this.align: "left",this.FH: 0,this.RH: 0,this.zG: 0,this.EE: 0});}class uF{var BK;var NK;var YK;var wK;var HL;uF(){BK=new hD();NK=new List<nC>();YK=double.NAN;wK=ID.pD;HL=new tF(0);ZC.window.requestAnimationFrame(HM);} get EH=>BK; HM( g){ZC.window.requestAnimationFrame(HM);if(YK.isNaN)YK=g;if(YK>g)YK=g;var i=g-YK;var j=i/1000.0;if(i>=1){YK=g;HL.KK=j;wK.KB(HL);BK.BC(j);for(int h=0;h<NK.length;h++ ){var k=NK[h];k.GH();}}} wE( g){NK.add(g);}}class iD{var pG;var qG;var height;var EE;var width;var x;iD(this.x,this.width,this.height,this.pG,this.qG,this.EE);}class mD implements kB{var MK=0.0;var eK=0.0;var qK=1;var CL;mD( g, h){CL=g;eK=SB.max(h,0.0001);} BC( h){var g=MK+h;while (g>=eK&&qK>0){MK=eK;qK-- ;CL();g-= eK;}if(qK==0)return false;MK=g;return true;} get totalTime=>eK; get currentTime=>MK;}class kD{static var cE=pB.oD;static var FG=false;static var QG=new aB();static  tE( i){var h=i;var g="auto";if(cE!=pB.oD)h=cE;switch (h){case pB.oD:g="auto";break;case pB.sD:g="default";break;case pB.tD:g="pointer";break;case pB.TG:g="move";break;case pB.UG:g="text";break;case pB.WG:g="wait";break;}if(FG)g="none";return g;}}class pB{static const  oD="auto";static const  sD="arrow";static const  tD="button";static const  TG="hand";static const  UG="ibeam";static const  WG="wait";}class pF{static const  GG="pixel";}abstract class kB{ BC( g);}class kC{static const  zF=0;static const  EG=1;static const  NG=2;static const  SG=3;static const  kE=4;}class gC{var JK;var dK;var yK;var JL;var QL;var WL;var bL;gC(){JK=new Map<String,DB>();dK=new Map<String,HB>();yK=new Map<String,ZB>();JL=new Map<String,String>();QL=null;WL=0;bL=0;} hB( i, j){var g=DB.vE(j);WL++ ;g.then(( h){JK[i]=h;WL-- ;xM();});g.handleException((k){bL++ ;WL-- ;xM();});} bB( h, i){var g=HB.BG(i);WL++ ;g.then(( j){dK[h]=j;WL-- ;xM();});g.handleException((k){bL++ ;WL-- ;xM();});} xC( h, j, k){var g=ZB.ZG(j,k);WL++ ;g.then(( i){yK[h]=i;WL-- ;xM();});g.handleException((l){bL++ ;WL-- ;xM();});} addText( h, g){JL[h]=g;} load(){QL=new Completer<gC>();xM();return QL.future;} q( g){if(JK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return JK[g];} iB( g){if(dK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return dK[g];} OC( g){if(yK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return yK[g];} oC( g){if(JL.containsKey(g)==false)return "[[${g}]]";return JL[g];}xM(){if(QL!=null&&WL==0){if(bL==0)QL.complete(this);else QL.completeException(this);}}}class ZB{var FK;var iK;ZB(){FK=new ZC.ImageElement();iK=new List<UE>();}static  ZG( o, RB){var m=new Completer<ZB>();var i=new ZB();switch (RB){case cC.CG:case cC.mC:var j=new ZC.HttpRequest();j.open('GET',o,true);j.on.load.add((oB){ s( l, g){var IB=lG(l);var h=new UE(IB,i);h.jK=g["frame"]["x"].toInt();h.pK=g["frame"]["y"].toInt();h.xK=g["frame"]["w"].toInt();h.DL=g["frame"]["h"].toInt();h.KL=g["spriteSourceSize"]["x"].toInt();h.OL=g["spriteSourceSize"]["y"].toInt();h.RL=g["sourceSize"]["w"].toInt();h.XL=g["sourceSize"]["h"].toInt();h.eL=g["rotated"] as bool;i.iK.add(h);}var v=aH.JSON.parse(j.responseText);var k=v["frames"];var EB=v["meta"];if(k is List)for(var g in k)s(g["filename"],g);if(k is Map)for(String l in k.oH())s(l,k[l]);i.FK.on.load.add((gB)=>m.complete(i));i.FK.on.error.add((gB)=>m.completeException("Failed to load image."));i.FK.src=mG(o,EB["image"]);});j.on.error.add((oB)=>m.completeException("Failed to load json file."));j.send();break;}return m.future;} get yG=>FK; q( i){var g;for(int h=0;h<iK.length&&g==null;h++ )if(iK[h].name==i)g=new DB.zH(iK[h]);if(g==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return g;}static  lG( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,ignoreCase:true);var i=h.firstMatch(g);return i.group(1);}static  mG( i, h){var k=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,ignoreCase:true);var j=k.firstMatch(i);var g=j.group(1);return (g==null)?h:"${g}${h}";}}class UE{var EK;var WK;var jK;var pK;var xK;var DL;var KL;var OL;var RL;var XL;var eL;UE( h, g){EK=h;WK=g;} get WH=>WK; get name=>EK; get uG=>jK; get vG=>pK; get tG=>xK; get sG=>DL; get offsetX=>KL; get offsetY=>OL; get KH=>RL; get JH=>XL; get SH=>eL;}class xF{static const  LG="none";}class nD extends HD implements kB{static const  HG='TIME_OUT';var NL=false;var MK=0.0;var eK=0.0;var gL;var kL=true;nD( g, h,[ direction=HD.MD]):super(h,direction){if(g<=0)throw new ArgumentError('Time must be greater than zero');eK=g;zE();} BC( g){if(NL&&ratio>0.0){ratio=ratio-g/totalTime;if(ratio==0.0)pause();}return true;} start(){NL=true;} pause(){NL=false;} reset([ time=0.0]){pause();time=SB.max(time,0.0);if(time!=0.0){eK=time;zE();}ratio=1.0;} QD( h, g){gL[h]=g/totalTime;} zE(){gL=new Map<String,num>();QD(nD.HG,0);} get totalTime=>eK; get QH=>ratio*totalTime; set ratio( h){var i=ratio;super.ratio=h;if(kL){gL.forEach((j,g){if(g<i&&g>=ratio)KB(new CB(j));});}}}class DB implements XE{var SK;var ZK;var nK;var zK;var LK;var PL;var VL;var ZL;var jK;var pK;var xK;var DL;DB( g, i,[ transparent=true, fillColor=0xFFFFFFFF]){SK=g;ZK=i;nK=transparent;var h=new ZC.CanvasElement(width:SK,height:ZK);LK=h.context2d;LK.fillStyle=nK?aG(fillColor):uC(fillColor);LK.fillRect(0,0,g,i);zK=h;PL=0;}DB.yH( g){SK=g.naturalWidth;ZK=g.naturalHeight;nK=true;zK=g;PL=0;}DB.zH( g){SK=g.KH;ZK=g.JH;nK=true;zK=g.WH.yG;PL=g.SH?2:1;VL=g.offsetX.toDouble();ZL=g.offsetY.toDouble();jK=g.uG.toDouble();pK=g.vG.toDouble();xK=g.tG.toDouble();DL=g.sG.toDouble();}static  vE( i){var h=new Completer<DB>();var g=new ZC.ImageElement();g.on.load.add((j)=>h.complete(new DB.yH(g)));g.on.error.add((j)=>h.completeException("Failed to load image."));g.src=i;return h.future;} get width=>SK; get height=>ZK; nB( g){switch (PL){case 0:g.context.drawImage(zK,0.0,0.0);break;case 1:g.context.drawImage(zK,jK,pK,xK,DL,VL,ZL,xK,DL);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,VL,ZL+DL);g.context.drawImage(zK,jK,pK,DL,xK,0.0,0.0,DL,xK);break;}} RF( gB, g){if(g.width<=0.0||g.height<=0.0)return;switch (PL){case 0:gB.context.drawImage(zK,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=jK;double h=pK;double s=j+xK;double EB=h+DL;double m=jK-VL+g.x;double k=pK-ZL+g.y;double RB=m+g.width;double IB=k+g.height;double v=(j>m)?j:m;double l=(h>k)?h:k;double oB=(s<RB)?s:RB;double LE=(EB<IB)?EB:IB;double YC=VL-j+v;double ME=ZL-h+l;double o=oB-v;double i=LE-l;if(o>0.0&&i>0.0){gB.context.drawImage(zK,v,l,o,i,YC,ME,o,i);}break;case 2:double j=jK;double h=pK;double s=j+DL;double EB=h+xK;double m=jK+ZL-g.y+DL-g.height;double k=pK-VL+g.x;double RB=m+g.height;double IB=k+g.width;double v=(j>m)?j:m;double l=(h>k)?h:k;double oB=(s<RB)?s:RB;double LE=(EB<IB)?EB:IB;double YC=VL-h+l;double ME=ZL+s-oB;double o=LE-l;double i=oB-v;if(o>0.0&&i>0.0){gB.context.transform(0.0,-1.0,1.0,0.0,YC,ME+i);gB.context.drawImage(zK,v,l,i,o,0.0,0.0,i,o);}break;}}}typedef  lC(event); uC( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class jE{static var lE=false;static var yD=false;static var zD=0;static var dG=VE.LG;static var QG=new aB();static fG(){if(lE==false){lE=true;var g=ZC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){yD=true;zD=10;}if(g.contains("Android")){yD=true;zD=10;}if(g.contains("IEMobile")){yD=true;zD=10;}}}static  get kG{fG();return dG;}}class KC extends kB{var vL;var yL;var CM;var FM;var LM;var MM;var RM;var eK;var MK;var VM;var WM;var YM;KC( g, h, i,[ transitionType( ratio)]){vL=g;yL=h;CM=g;FM=(transitionType!=null)?transitionType:MB.LC;MK=0.0;eK=SB.max(0.0001,i);VM=0.0;WM=false;YM=false;} BC( h){if(MK<eK||YM==false){MK=MK+h;if(MK>eK)MK=eK;if(MK>=0.0){if(YM==false){YM=true;if(LM!=null)LM();}var g=MK/eK;var i=FM(g);CM=vL+i*(yL-vL);if(MM!=null)MM(WM?CM.round():CM);if(RM!=null&&MK==eK)RM();}}return MK<eK;} get vB=>vL; get HE=>yL; get totalTime=>eK; get currentTime=>MK; get isComplete=>MK>=eK;set delay( g){if(YM==false)MK=MK+VM-g;VM=g;} set OF( g()){LM=g;} set GC( g( value)){MM=g;} set onComplete( g()){RM=g;}}class TB{var QG;var IM;var OM;TB( g, h){QG=g;IM=h;OM=new List<sF>();} get FF=>QG; add( h,[ useCapture=false]){for(int g=0;g<OM.length;g++ )if(OM[g].TD==h&&OM[g].ZD==useCapture)return;if(IM==CB.vD&&OM.length==0)ID.pD.add(this);OM.add(new sF(h,useCapture));} remove( h,[ useCapture=false]){for(int g=0;g<OM.length;g++ ){if(OM[g].TD==h&&OM[g].ZD==useCapture){OM=new List<sF>.from(OM);OM.removeAt(g);if(IM==CB.vD&&OM.length==0)ID.pD.remove(this);break;}}} operator+( g){this.add(g,false);} operator-( g){this.remove(g,false);} KB( h){for(int g=0;g<OM.length;g++ )if(h.eventPhase!=dC.dE||OM[g].ZD)if(h.UH==false)OM[g].TD(h);}}class pE{static var cG=0;var YD=cG++ ;var target=null;var WD=false;pE(this.target,this.WD);} aG( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class MB{static  LC( g){return g;}static  uE( g){return g*g*g;}static  rB( g){g=1.0-g;return 1.0-g*g*g;}static  nG( g){if(g==0.0||g==1.0)return g;return SB.pow(2.0,-10.0*g)*SB.sin((g-0.3/4.0)*(2.0*SB.PI)/0.3)+1;}}class mB implements kB{var eM;var FM;var iM;var LM;var MM;var RM;var eK;var MK;var VM;var WM;var YM;mB( h, g,[ transitionType( ratio)]){eM=h;FM=(transitionType!=null)?transitionType:MB.LC;MK=0.0;eK=SB.max(0.0001,g);VM=0.0;WM=false;YM=false;iM=new List<rF>();} XB( g, i){var h=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(h.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(eM!=null&&YM==false)iM.add(new rF(g,0.0,i));} moveTo( h, g){XB('x',h);XB('y',g);} BC( k){if(MK<eK||YM==false){MK=MK+k;if(MK>eK)MK=eK;if(MK>=0.0){if(YM==false){YM=true;for(int i=0;i<iM.length;i++ ){var g=iM[i];switch (g.name){case 'x':g.vB=eM.x;break;case 'y':g.vB=eM.y;break;case 'pivotX':g.vB=eM.QC;break;case 'pivotY':g.vB=eM.RC;break;case 'scaleX':g.vB=eM.uB;break;case 'scaleY':g.vB=eM.DC;break;case 'rotation':g.vB=eM.YB;break;case 'alpha':g.vB=eM.alpha;break;}}if(LM!=null)LM();}var j=MK/eK;var l=FM(j);for(int i=0;i<iM.length;i++ ){var g=iM[i];var h=g.vB+l*(g.HE-g.vB);h=WM?h.round():h;switch (g.name){case 'x':eM.x=h;break;case 'y':eM.y=h;break;case 'pivotX':eM.QC=h;break;case 'pivotY':eM.RC=h;break;case 'scaleX':eM.uB=h;break;case 'scaleY':eM.DC=h;break;case 'rotation':eM.YB=h;break;case 'alpha':eM.alpha=h;break;}}if(MM!=null)MM();if(RM!=null&&MK==eK)RM();}}return MK<eK;} get totalTime=>eK; get currentTime=>MK; get isComplete=>MK>=eK;set delay( g){if(YM==false)MK=MK+VM-g;VM=g;} set OF( g()){LM=g;} set GC( g()){MM=g;} set onComplete( g()){RM=g;}}class nC extends jC{var dM;var LK;var oM;var qM;var uM;var wM;var zM;var CN;var EN;var HN;var IN;var JN;var KN;var NN;var ON;nC( h, g){EK=h;dM=g;dM.focus();LK=g.context2d;qM=new AC.BI(LK);uM=hC.oD;wM=pB.sD;kD.QG.addEventListener("mouseCursorChanged",UN);EN=[new ZE(t.LD,t.xD,t.TC,t.MG),new ZE(t.eG,t.gG,t.qE,t.qE),new ZE(t.hG,t.iG,t.rE,t.rE)];CN=null;zM=new NB(0,0);IN=new t(t.TC,true);NN=zL;dM.on..mouseDown.add(NN)..mouseUp.add(NN)..mouseMove.add(NN)..mouseOut.add(NN)..mouseWheel.add(NN);HN=new Map<int,pE>();KN=new zB(zB.eE,true);ON=XN;jE.QG.addEventListener("inputModeChanged",YN);YN(null);JN=new iC(iC.qD,true);dM.on.keyDown.add(aN);dM.on.keyUp.add(aN);dM.on.keyPress.add(bN);} get focus=>oM; set PH( g){uM=g;} cN(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){cN();} set y( g){cN();} set QC( g){cN();} set RC( g){cN();} set uB( g){cN();} set DC( g){cN();} set YB( g){cN();} set alpha( g){cN();} set width( g){cN();} set height( g){cN();} GH(){if(uM==hC.oD||uM==hC.uD){qM.reset();nB(qM);if(uM==hC.uD)uM=hC.IG;}} UN( g){dM.style.cursor=kD.tE(wM);} zL( j){j.preventDefault();var IB=dM.getBoundingClientRect();var o=new Date.now().millisecondsSinceEpoch;var s=j.button;var h=null;var i=new NB(j.clientX-IB.left,j.clientY-IB.top);var m=null;if(s<0||s>2)return;if(j.type=="mousemove"&&zM.equals(i))return;var g=EN[s];zM=i;if(j.type!="mouseout")h=PC(i.x,i.y) as lB;var k=pB.sD;if(h is AB)if(h.KE)k=pB.tD;if(h is sC)if(h.KE)k=pB.tD;if(wM!=k){wM=k;dM.style.cursor=kD.tE(k);}if(CN!=null&&CN!=h){CN.KB(IN..bM(t.ND,true)..SN=(CN.XD!=null)?CN.pC(i):new NB.xH()..TN=i..LN=g.MC);CN=null;}if(h!=null&&h!=CN){h.KB(IN..bM(t.oE,true)..SN=h.pC(i)..TN=i..LN=g.MC);CN=h;}var l=null;var v=false;var EB=false;if(j.type=="mousedown"){l=g.LF;if(h!=g.target||o>g.CE+500)g.yC=0;g.MC=true;g.target=h;g.CE=o;g.yC++ ;}if(j.type=="mouseup"){l=g.MF;g.MC=false;v=(g.target==h);EB=v&&g.yC.isEven&&(o<g.CE+500);}if(j.type=="mousemove"){l=t.nE;}if(l!=null&&h!=null){m=h.pC(i);h.KB(IN..bM(l,true)..SN=m..TN=i..LN=g.MC..PN=g.yC);if(v){if(EB&&h.rG){h.KB(IN..bM(g.KF,true)..SN=m..TN=i..LN=g.MC);}else{h.KB(IN..bM(g.JF,true)..SN=m..TN=i..LN=g.MC);}}}} YN( g){dM.on..touchStart.remove(ON)..touchEnd.remove(ON)..touchMove.remove(ON)..touchEnter.remove(ON)..touchLeave.remove(ON)..touchCancel.remove(ON);if(jE.kG==VE.RG){dM.on..touchStart.add(ON)..touchEnd.add(ON)..touchMove.add(ON)..touchEnter.add(ON)..touchLeave.add(ON)..touchCancel.add(ON);}} XN( k){k.preventDefault();var o=dM.getBoundingClientRect();for(var m in k.changedTouches){var l=m.identifier;var h=null;var i=new NB(m.clientX-o.left,m.clientY-o.top);var s=null;h=PC(i.x,i.y) as lB;var g=HN.containsKey(l)?HN[l]:new pE(h,HN.length==0);if(g.target!=null&&g.target!=h){g.target.KB(KN..bM(zB.YG,true)..SN=(g.target.XD!=null)?g.target.pC(i):new NB.xH()..TN=i..fM=g.YD..hM=g.WD);g.target=null;}if(h!=null&&h!=g.target){h.KB(KN..bM(zB.XG,true)..SN=h.pC(i)..TN=i..fM=g.YD..hM=g.WD);g.target=h;}var j=null;if(k.type=="touchstart"){HN[l]=g;j=zB.eE;}if(k.type=="touchend"){HN.remove(l);j=zB.gE;}if(k.type=="touchcancel"){HN.remove(l);j=zB.iE;}if(k.type=="touchmove"){j=zB.mE;}if(j!=null&&h!=null){h.KB(KN..bM(j,true)..SN=h.pC(i)..TN=i..fM=g.YD..hM=g.WD);}}} aN( g){g.preventDefault();var h=null;if(g.type=="keyup")h=iC.fE;if(g.type=="keydown")h=iC.qD;JN..bM(h,true)..sL=g.altKey..uL=g.ctrlKey..xL=g.shiftKey..NM=g.charCode..QM=g.keyCode..SM=kC.zF;if(g.keyLocation==ZC.KeyLocation.LEFT)JN.SM=kC.EG;if(g.keyLocation==ZC.KeyLocation.RIGHT)JN.SM=kC.NG;if(g.keyLocation==ZC.KeyLocation.NUMPAD)JN.SM=kC.SG;if(g.keyLocation==ZC.KeyLocation.JOYSTICK)JN.SM=kC.kE;if(g.keyLocation==ZC.KeyLocation.MOBILE)JN.SM=kC.kE;if(oM!=null)oM.KB(JN);} bN( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new TE(TE.KG,true);h.QK=new String.fromCharCodes([i]);if(oM!=null)oM.KB(h);}} AE( g, EB, o, l){var YC=0.0;var oB=0.0;var v=EB*g.a;var gB=EB*g.b;var IB=EB*g.a+o*g.c;var s=EB*g.b+o*g.d;var RB=o*g.c;var m=o*g.d;var h=YC;if(h>v)h=v;if(h>IB)h=IB;if(h>RB)h=RB;var i=oB;if(i>gB)i=gB;if(i>s)i=s;if(i>m)i=m;var j=YC;if(j<v)j=v;if(j<IB)j=IB;if(j<RB)j=RB;var k=oB;if(k<gB)k=gB;if(k<s)k=s;if(k<m)k=m;if(l==null)l=new QB.xH();l.x=g.WC+h;l.y=g.XC+i;l.width=j-h;l.height=k-i;return l;}
//@ sourceMappingURL=escape.dart.map