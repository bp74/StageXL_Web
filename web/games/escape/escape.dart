import "dart:math" as SB;import "dart:json" as YH;import "dart:html" as YC;class wB{static const  pC=1;static const  bD=2;static const  cD=3;}class LE extends AB{var FI;LE( j){var g=new HC();g.LC=new YE("Arial",30,0xFFFFFF,BC:true,align:qB.IC);g.width=110;g.height=36;g.wordWrap=false;g.x=646;g.y=130;g.TB=false;g.text=j.toString();g.x=-g.width/2;g.y=-g.height/2;FI=new AB();FI.n(g);n(FI);var i=new KC(0.0,1.0,1.5,LB.rB);i.FC=(h){FI.alpha=1-h;FI.y=-h*50;FI.uB=1.0+0.1*SB.sin(h*10);FI.CC=1.0+0.1*SB.cos(h*10);};i.onComplete=(){this.CE();};p.add(i);}}class u{static const  AD="None";static const  NB="Joker";static const  xB="Block";static const  OE="Double";static const  PE="Quint";}class fF extends AB{var II;var TI;var dI;var jI;var mI;fF(){dI=eB.KB.iB("Warning");jI=null;II=GB.pF();TI=new BB(II[0]);n(TI);} start(){jI=dI.play();p.remove(mI);mI=new KC(0,80,9.0,LB.JC);mI.FC=(h){var g=h.toInt()%8;TI.OB=II[(g<=4)?g+1:8-g];};p.add(mI);} stop(){if(jI!=null){jI.stop();jI=null;}p.remove(mI);TI.OB=II[0];}}class dF extends AB{var pI;var wI;var BJ;var FJ;var IJ;var JJ;var KJ;var LJ;var MJ;var OJ;var PJ;var QJ;var RJ;var SJ;var TJ;var VJ;var WJ;var XJ;var YJ;var aJ;dF( o, l, v, RB, DB, s, k){LJ=new SB.Random();MJ=wB.pC;OJ=k;pI=o;wI=l;BJ=v;FJ=RB;IJ=DB;JJ=s;KJ=k.length;SJ=new List<QB>();VJ=new AB();WJ=new AB();XJ=new AB();YJ=new AB();aJ=new AB();n(VJ);n(WJ);n(XJ);n(YJ);n(aJ);WJ.TB=false;XJ.TB=false;YJ.TB=false;aJ.TB=false;zG();AH();yG();TJ=true;var m=new oC();this.mask=new vF.xH(0.0,0.0,500.0,500.0);for(int g=0;g<10;g++ ){for(int h=0;h<10;h++ ){var i=QJ[g+h*10];i.x=g*50+25;i.y=h*50+25-550;i.jB(VJ,WJ,XJ);var j=new KC(i.y,h*50+25,0.4,LB.rB);j.delay=g*0.03;j.FC=(IB){i.y=IB;};j.onComplete=(){if(m.XD()==100){hJ();TJ=false;SJ.clear();this.mask=null;}};p.add(j);}}addEventListener(t.KD,iJ);} aF( g){if(g==wB.bD)MJ=g;if(g==wB.cD&&MJ==wB.pC){MJ=g;if(TJ==false)MB(new aB(aB.eD,null));}} EF(){this.mask=new vF.xH(0.0,0.0,500.0,500.0);for(int h=0;h<10;h++ ){for(int i=0;i<10;i++ ){var g=QJ[i+h*10];g.dB=false;g.EC=false;g.FB=u.AD;g.jB(VJ,WJ,XJ);var j=new KC(g.y,500+h*50+25,0.5,LB.rB);j.delay=i*0.1;j.FC=(k){g.y=k;};p.add(j);}}} zG(){RJ=new List<zC>();for(int h=0;h<wI;h++ ){var g=new zC(h);g.XB=(LJ.nextInt(30)-15)*SB.PI/180;g.x=300-(90*wI)/2+h*90+LJ.nextInt(20)-10;g.y=550;RJ.add(g);YJ.n(g);}} BF( g, h){var i=0;var j=QJ[g+h*10];if(j.direction==0){var o=(g>0)?QJ[g-1+h*10]:null;var l=(g<9)?QJ[g+1+h*10]:null;if(j.UC(o))i++ ;if(j.UC(l))i++ ;}else{var k=(h>0)?QJ[g+(h-1)*10]:null;var m=(h<9)?QJ[g+(h+1)*10]:null;if(j.dC(k))i++ ;if(j.dC(m))i++ ;}return i;} AF(){for(int h=0;h<10;h++ ){for(int g=0;g<10;g++ ){var i=QJ[g+h*10];var j=KJ*2;while (BF(g,h)==2&&j>0){if(j%2==0){i.direction=1-i.direction;j-- ;}else{var m=0;for(int k=0;k<OJ.length;k++ )if(i.color==OJ[k])m=k;i.color=OJ[(m+1)%OJ.length];j-- ;}}}}var l=false;for(int h=0;h<10;h++ )for(int g=0;g<10;g++ )l=l||(BF(g,h)==2);return l;} QF(){for(int g=0;g<10;g++ )for(int h=1;h<9;h++ )if(QJ[(h-1)+g*10].TD(QJ[h+g*10])&&QJ[h+g*10].TD(QJ[(h+1)+g*10]))return true;for(int h=0;h<10;h++ )for(int g=1;g<9;g++ )if(QJ[h+(g-1)*10].TD(QJ[h+g*10])&&QJ[h+g*10].TD(QJ[h+(g+1)*10]))return true;return false;} oJ( l, j, k){for(int h=0;h<20;h++ ){var g=pI~/k;var i=j*g+LJ.nextInt(g);if(PJ[i].FB==u.AD){PJ[i].FB=l;return;}}} AH(){PJ=new List<JB>();for(int g=0;g<pI;g++ ){var i=OJ[LJ.nextInt(OJ.length)];var h=LJ.nextInt(2);PJ.add(new JB(i,h));}for(int g=0;g<wI*2;g++ )oJ("Lock${(g%wI)+1}",g,wI*2);for(int g=0;g<BJ;g++ )oJ(u.NB,g,BJ);for(int g=0;g<FJ;g++ )oJ(u.xB,g,FJ);for(int g=0;g<IJ;g++ )oJ(u.OE,g,IJ);for(int g=0;g<JJ;g++ )oJ(u.PE,g,JJ);} yG(){QJ=new List<JB>();var g=true;while (g){QJ.clear();for(int h=0;h<100;h++ ){var i=OJ[LJ.nextInt(OJ.length)];var j=LJ.nextInt(2);QJ.add(new JB(i,j));}g=AF();}} VF(){if(TJ||MJ!=wB.pC)return false;var l=true;TJ=true;while (l){for(int k=0;k<QJ.length;k++ ){var g=QJ[k];g.dB=false;g.EC=false;g.jB(VJ,WJ,XJ);g.color=OJ[LJ.nextInt(OJ.length)];g.direction=LJ.nextInt(2);}l=AF()||(QF()==false);}var s=eB.KB.iB("BonusUniversal");s.play();var m=new oC();for(int i=0;i<10;i++ ){for(int j=0;j<10;j++ ){var g=QJ[i+j*10];g.WF=0.0;var h=new KC(0.0,1.0,0.2,LB.JC);h.delay=i*0.06;h.FC=(o){g.WF=o;};h.OF=(){g.jB(VJ,WJ,XJ);};h.onComplete=(){if(m.XD()==100){hJ();pJ();SJ.clear();}};p.add(h);}}return true;} hJ(){for(int i=0;i<10;i++ ){for(int h=0;h<10;h++ ){var g=QJ[h+i*10];var l=(h<9)?QJ[h+1+i*10]:null;var m=(i<9)?QJ[h+(i+1)*10]:null;var j=false;var k=false;if(g.UC(l)){j=true;k=(g.FB==u.NB||l.FB==u.NB);}if(g.dC(m)){j=true;k=(g.FB==u.NB||m.FB==u.NB);}if(g.dB!=j||g.EC!=k){g.dB=j;g.EC=k;g.jB(VJ,WJ,XJ);}}}} rJ( o, l, s, k, m, v){TJ=true;o.XD(k);var i=1;for(int h=0;h<k;h++ ){var g=QJ[l+h*m+(s+h*v)*10];if(g.FB==u.OE)i=i*2;if(g.FB==u.PE)i=i*5;var IB=l+h*m;var RB=s+h*v;p.fB((){g.empty=true;g.jB(VJ,WJ,XJ);var DB=eB.KB.iB("ChainBlast");DB.play();var j=new ME(g.color,g.direction);j.x=IB*50;j.y=RB*50;p.add(j);aJ.n(j);LH(g);if(o.CF()==0)tJ();},0.1+h*0.1);}MB(new aB(aB.ME,{"Length":k,"Factor":i}));} pJ(){TJ=false;var j=new oC();for(int h=0;h<10;h++ ){for(int i=0;i<10;){var g=1;while (i+g<10&&QJ[i+g-1+h*10].UC(QJ[i+g+h*10]))g++ ;if(g>=3)rJ(j,i,h,g,1,0);i=i+g;}}for(int i=0;i<10;i++ ){for(int h=0;h<10;){var g=1;while (h+g<10&&QJ[i+(h+g-1)*10].dC(QJ[i+(h+g)*10]))g++ ;if(g>=3)rJ(j,i,h,g,0,1);h=h+g;}}if(j.value==0){if(MJ==wB.bD)MB(new aB(aB.NE,null));if(MJ==wB.cD)MB(new aB(aB.eD,null));if(MJ==wB.pC&&QF()==false)VF();}} LH( h){if(h.FB.indexOf("Lock")==0){var k=int.parse(h.FB.substring(4,5))-1;var j=RJ[k];var g=GB.fD(h.FB);g.x=h.x;g.y=h.y;n(g);var i=new mB(g,0.5,LB.rB);i.WB("x",j.x);i.WB("y",j.y-10);i.onComplete=()=>tB(g);p.add(i);p.fB(()=>GH(k),0.5);}} GH( k){var h=RJ[k];var i;if(h.yC){i=new aB(aB.BD,{"Type":"SingleLocked","Position":new QB(h.x+20,h.y)});var l=eB.KB.iB("Unlock");l.play();}else{i=new aB(aB.BD,{"Type":"SingleUnlocked","Position":new QB(h.x+20,h.y)});}MB(i);h.yC=false;h.UF(false);var j=true;for(int g=0;g<RJ.length;g++ )j=j&&(RJ[g].yC==false);if(j){var m=eB.KB.iB("BonusAllUnlock");m.play();for(int g=0;g<RJ.length;g++ ){RJ[g].yC=true;p.fB(()=>RJ[(g+k)%RJ.length].RH(),g*0.2);}p.fB(()=>MB(new aB(aB.BD,{"Type":"All","Position":new QB(280,550)})),0.75);}} tJ(){var o=new oC();for(int i=0;i<10;i++ ){var k=9;var j=8;while (k>=0){while (k>=0&&QJ[i+k*10].empty==false){k-- ;j-- ;}while (j>=0&&QJ[i+j*10].empty==true){j-- ;}if(k>=0){var g,h,l;if(j>=0){h=QJ[i+j*10];if(i>0){l=QJ[i-1+j*10];if(h.UC(l)){l.dB=false;l.jB(VJ,WJ,XJ);}}h.dB=false;h.empty=true;h.jB(VJ,WJ,XJ);}else{if(PJ.length>0){h=PJ[0];PJ.removeRange(0,1);}else{h=new JB(OJ[LJ.nextInt(OJ.length)],LJ.nextInt(2));}}g=QJ[i+k*10];g.color=h.color;g.direction=h.direction;g.FB=h.FB;g.dB=false;g.empty=false;g.x=50*i+25;g.y=50*j+25;g.jB(VJ,WJ,XJ);o.XD();var m=new KC(g.y,50*k+25,0.1,LB.JC);m.FC=(s){g.y=s;};m.onComplete=(){if(o.CF()==0){hJ();pJ();vJ();}};p.add(m);}}}} iJ( g){if(g.target==VJ&&this.TB){var j=SB.min(g.HF/50,9).toInt();var h=SB.min(g.IF/50,9).toInt();var i=new QB(j,h);SJ.add(i);vJ();}} vJ(){while (MJ==wB.pC&&TJ==false&&SJ.length>0){var m=SJ[0];SJ.removeRange(0,1);var j=m.x.toInt();var k=m.y.toInt();var g=QJ[j+k*10];var i=(j>0)?QJ[j-1+k*10]:null;var o=(j<9)?QJ[j+1+k*10]:null;var h=(k>0)?QJ[j+(k-1)*10]:null;var s=(k<9)?QJ[j+(k+1)*10]:null;var l=false;if(g.FB==u.xB){var v=eB.KB.iB("ChainError");v.play();continue;}if(g.dC(h)){h.dB=false;h.jB(VJ,WJ,XJ);}if(g.UC(i)){i.dB=false;i.jB(VJ,WJ,XJ);}g.direction=1-g.direction;g.dB=false;g.EC=false;var IB=eB.KB.iB("ChainRotate");IB.play();if(g.UC(o)){g.dB=true;g.EC=(g.FB==u.NB||o.FB==u.NB);}if(g.dC(s)){g.dB=true;g.EC=(g.FB==u.NB||s.FB==u.NB);}g.jB(VJ,WJ,XJ);l=l||g.dB;if(g.dC(h)){h.dB=true;h.EC=(g.FB==u.NB||h.FB==u.NB);h.jB(VJ,WJ,XJ);l=true;}if(g.UC(i)){i.dB=true;i.EC=(g.FB==u.NB||i.FB==u.NB);i.jB(VJ,WJ,XJ);l=true;}if(l){var DB=eB.KB.iB("ChainLink");DB.play();}pJ();}}}class oC{var value=0; XD([ inc=1])=>(value+= inc); CF([ dec=1])=>(value-= dec);}class eF extends AB{var GI;var OI;var aI;var QI;eF(){var l=new BB(GB.KB.q("ExitBox"));n(l);var g=new HC();g.LC=new YE("Arial",24,0xFFFFFF,BC:true,align:qB.IC);g.width=240;g.height=100;g.wordWrap=true;g.text=ZC.KB.nC("GENexitquery");g.x=47;g.y=150-g.GE/2;g.TB=false;n(g);GI=new mD(7,GB.KB.q("ExitGauge"),FD.vD);GI.x=268;GI.y=25;GI.addEventListener("TimeOver",ZJ);n(GI);GI.RD("TimeOver",0);GI.start();var h=new BB(GB.KB.q("ExitYesButtonNormal"));var i=new BB(GB.KB.q("ExitYesButtonPressed"));OI=new qC(h,h,i,i);OI.x=68;OI.y=239;OI.addEventListener(t.RC,dJ);n(OI);var j=new BB(GB.KB.q("ExitNoButtonNormal"));var k=new BB(GB.KB.q("ExitNoButtonPressed"));aI=new qC(j,j,k,k);aI.x=173;aI.y=232;aI.addEventListener(t.RC,fJ);n(aI);this.addEventListener(EB.rC,(m)=>p.add(GI));this.addEventListener(EB.tC,(m)=>p.remove(GI));} gJ( g){if(QI!=null){QI(g);QI=null;}} dJ( g){gJ(true);} fJ( g){gJ(false);} ZJ( g){gJ(false);}show( g){QI=g;}}class JB{var BI;var CI;var LI;var SI;var XI;var ZI;var gI;var kI;var nI;var rI;var uI;JB( g, h){BI=g;CI=h;LI=u.AD;SI=-1000;XI=-1000;ZI=false;gI=false;kI=false;nI=null;rI=null;uI=null;} get color=>BI; set color( g){BI=g;} get direction=>CI; set direction( g){CI=g;} get FB=>LI; set FB( g){LI=g;} get dB=>ZI; set dB( g){ZI=g;} get EC=>gI; set EC( g){gI=g;} get empty=>kI; set empty( g){kI=g;} TD( g){var h=g!=null&&(g.color==BI||g.FB==u.NB||LI==u.NB)&&g.FB!=u.xB&&LI!=u.xB;return h;} UC( g){var h=g!=null&&(g.color==BI||g.FB==u.NB||LI==u.NB)&&g.direction==0&&CI==0&&g.FB!=u.xB&&LI!=u.xB;return h;} dC( g){var h=g!=null&&(g.color==BI||g.FB==u.NB||LI==u.NB)&&g.direction==1&&CI==1&&g.FB!=u.xB&&LI!=u.xB;return h;} get x=>SI; set x( g){SI=g;if(nI!=null)nI.x=g;if(rI!=null)rI.x=g;if(uI!=null)uI.x=g;} get y=>XI; set y( g){XI=g;if(nI!=null)nI.y=g;if(rI!=null)rI.y=g;if(uI!=null)uI.y=g;} set WF( h){if(nI!=null){var g=1+0.3*SB.sin(h*SB.PI);nI.uB=g;nI.CC=g;}} jB( g, h, i){if(nI!=null){nI.parent.tB(nI);nI=null;}if(rI!=null){rI.parent.tB(rI);rI=null;}if(uI!=null){uI.parent.tB(uI);uI=null;}if(empty==false){switch (LI){case u.NB:nI=new ZH(CI);nI.x=SI;nI.y=XI;g.n(nI);break;case u.xB:nI=GB.fD(u.xB);nI.x=SI;nI.y=XI;g.n(nI);break;default:nI=GB.dD(BI,CI);nI.x=SI;nI.y=XI;g.n(nI);break;}if(ZI){rI=gI?new bH(CI):GB.iF(BI,CI);rI.x=SI+((CI==0)?25:0);rI.y=XI+((CI==1)?25:0);h.n(rI);}switch (LI){case u.AD:break;case u.xB:break;case u.NB:break;default:uI=new aH(LI);uI.x=SI;uI.y=XI;i.n(uI);break;}}}}class hF extends AB{var EI;var NI;var YI;var hI;var GI;var lI;var oI;var qI;var tI;var DI;var xI;var yI;var zI;var AJ;var CJ;var DJ;var EJ;var GJ;var HJ;hF(){var j=new BB(GB.KB.q("ShuffleButtonNormal"));var h=new BB(GB.KB.q("ShuffleButtonPressed"));NI=new qC(j,j,h,h);NI.addEventListener(t.RC,UJ);NI.x=530;NI.y=525;n(NI);var g=new BB(GB.KB.q("ExitButtonNormal"));var i=new BB(GB.KB.q("ExitButtonPressed"));YI=new qC(g,g,i,i);YI.addEventListener(t.RC,cJ);YI.x=700;YI.y=500;n(YI);EI=new gF();EI.x=540;EI.y=-1000;n(EI);GI=new mD(10,GB.KB.q("TimeGauge"),FD.qD);GI.x=659;GI.y=244;GI.addEventListener("TimeShort",eJ);GI.addEventListener("TimeOver",ZJ);n(GI);p.add(GI);lI=new cF();lI.x=640;lI.y=230;n(lI);oI=new fF();oI.x=665;oI.y=160;n(oI);qI=new HC();qI.LC=new YE("Arial",30,0xD0D0D0,BC:true,align:qB.IC);qI.width=140;qI.height=36;qI.wordWrap=false;qI.x=646;qI.y=130;qI.TB=false;qI.text="0";qI.uB=0.9;n(qI);tI=new HC();tI.LC=new YE("Arial",20,0xFFFFFF,BC:true,align:qB.IC);tI.width=44;tI.height=30;tI.wordWrap=false;tI.x=610;tI.y=559;tI.TB=false;tI.text="3x";n(tI);CJ=new AB();n(CJ);DJ=new AB();n(DJ);EJ=new AB();n(EJ);GJ=eB.KB.iB("Intro");HJ=GJ.play();} start(){DI=1;xI=1;AJ=0;yI=3;var g=new ZD(ZC.KB.nC("ESCStartText"));DJ.n(g);p.fB(()=>lI.NF(21),1);g.show(()=>p.fB(()=>jJ(),0.5));} jJ(){if(hI!=null&&this.contains(hI))CJ.tB(hI);var m=DI;var g=0;var h=0;switch (DI){case 01:h=50;hI=new dF(g=40,3,0,0,0,0,[0,1,2]);break;case 02:h=45;hI=new dF(g=45,3,1,0,0,0,[2,3,4]);break;case 03:h=40;hI=new dF(g=50,4,2,2,1,0,[5,6,7]);break;case 04:h=35;hI=new dF(g=55,4,3,3,2,0,[0,2,6]);break;case 05:h=30;hI=new dF(g=60,5,4,4,2,1,[1,3,5]);break;case 06:h=34;hI=new dF(g=60,5,5,5,3,2,[1,2,4,7]);break;case 07:h=33;hI=new dF(g=65,5,5,6,3,2,[0,1,2,3]);break;case 08:h=32;hI=new dF(g=70,5,5,6,3,2,[0,2,5,6]);break;case 09:h=31;hI=new dF(g=75,5,5,6,3,2,[1,4,5,7]);break;default:h=30;hI=new dF(g=80+(DI-10)*5,5,5,6,3,2,[0,1,2,3]);break;}zI=g;if(yI<3){yI++ ;tI.text="${yI}x";}hI.addEventListener(aB.ME,kJ);hI.addEventListener(aB.BD,lJ);hI.addEventListener(aB.NE,mJ);hI.addEventListener(aB.eD,nJ);hI.x=20;hI.y=16;hI.TB=false;CJ.n(hI);GI.reset(h);GI.RD("TimeShort",9);GI.RD("TimeOver",0);GI.pause();EI.level=m;EI.yE=g;EI.y=-210;var k=new mB(EI,0.4,LB.rB);k.WB("y",-90);p.add(k);var j=new ZD(ZC.KB.nC("ESCLevelBoxText").replaceAll("{0}","${g}"));DJ.n(j);j.show((){hI.TB=true;GI.start();if(GJ!=null){var i=new KC(1.0,0.0,4.0,LB.JC);i.FC=(l){HJ.DC.volume=l;HJ.DC=HJ.DC;};i.onComplete=(){HJ.stop();lI.FH();};p.add(i);GJ=null;}});} eJ( g){oI.start();} ZJ( g){hI.aF(wB.cD);} lJ( j){var g=0;var k=j.info["Position"];var i=j.info["Type"];if(i=="SingleLocked")g=3000;if(i=="SingleUnlocked")g=1000;if(i=="All")g=10000;var h=new LE(g);h.x=k.x;h.y=k.y;CJ.n(h);AJ=AJ+g;qI.text="${AJ}";} kJ( j){var g=zI;var i=j.info["Length"];var k=j.info["Factor"];g=(g>i)?g-i:0;zI=g;EI.yE=g;if(g==0)hI.aF(wB.bD);var h=0;switch (i){case 3:h=1000;break;case 4:h=2000;break;case 5:h=5000;break;default:h=5000;}AJ=AJ+h*k;qI.text="${AJ}";} mJ( m){GI.pause();oI.stop();var l=eB.KB.iB("Laugh");var k=eB.KB.iB("LevelUp");l.play();lI.NF(3);var g=GB.jF();g.x=55;g.y=260;CJ.n(g);p.fB((){hI.EF();k.play();},2.0);p.fB((){var j=(GI.OH*1000).toInt();var h=new LE(j);h.x=704;h.y=360;CJ.n(h);AJ=AJ+j;qI.text="${AJ}";},2.5);var i=new mB(EI,0.5,LB.rB);i.WB("y",-210);i.delay=3.0;p.add(i);p.fB((){CJ.tB(g);},3.5);p.fB((){DI++ ;jJ();},4.0);} nJ( j){oI.stop();hI.EF();var g;var i;if(xI>0){xI-- ;g=new ZD(ZC.KB.nC("GEN2ndchancetime"));DJ.n(g);i=eB.KB.iB("LevelUp");i.play();g.show((){p.fB(()=>jJ(),0.5);var h=new mB(EI,0.5,LB.rB);h.WB("y",-210);p.add(h);});}else{g=new ZD(ZC.KB.nC("GENtimeup"));DJ.n(g);i=eB.KB.iB("GameOver");i.play();g.show((){p.fB(()=>qJ(),0.5);var h=new mB(EI,0.5,LB.rB);h.WB("y",-210);p.add(h);});}} UJ( h){if(hI!=null&&yI>0){var g=hI.VF();if(g){yI=yI-1;tI.text="${yI}x";}}} cJ( j){var h=new AB();h.n(new BB(new CB(800,600,false,0x000000)));h.alpha=0.6;EJ.n(h);var g=new eF();g.x=235;g.y=150;EJ.n(g);g.show(( i){EJ.tB(g);if(i==false)EJ.tB(h);else sJ(false);});}qJ(){var h=new AB();var j=new BB(GB.KB.q("ExitBox"));h.n(j);var g=new HC();g.LC=new YE("Arial",30,0xFFFFFF,BC:true,align:qB.IC);g.width=240;g.height=200;g.wordWrap=true;g.text=ZC.KB.nC("GENgameover");g.x=47;g.y=30+(g.height-g.GE)/2;g.TB=false;h.n(g);h.x=110;h.y=-h.height;DJ.n(h);var k=eB.KB.iB("Laugh");p.fB(()=>k.play(),0.3);var i=new mB(h,0.3,LB.rB);i.WB("y",150);p.add(i);p.fB(()=>sJ(true),5.0);h.addEventListener(t.RC,( l)=>sJ(true));}var uJ=false; sJ( g){GI.pause();if(uJ==false){uJ=true;}}}class cF extends AB{var HI;var RI;var eI;cF(){HI=GB.oF();RI=new BB(HI[0]);RI.x=-RI.width/2;RI.y=-RI.height/2;n(RI);eI=null;} NF( g){p.remove(eI);eI=new KC(0,g,0.5*g,LB.JC);eI.FC=(h){var i=((h*HI.length)%HI.length).toInt();RI.OB=HI[i];RI.y=SB.sin(h*2*SB.PI)*3-RI.height/2;};p.add(eI);} FH(){p.remove(eI);RI.OB=HI[0];}}class ZD extends AB{var JI;var QI;ZD( i){var h=new BB(GB.KB.q("MessageBox"));n(h);var g=new HC();g.LC=new YE("Arial",24,0xFFFFFF,BC:true,align:qB.IC);g.width=240;g.height=200;g.wordWrap=true;g.text=i;g.x=47;g.y=130-g.GE/2;g.TB=false;n(g);JI=null;addEventListener(t.RC,NJ);}void show( h){this.parent.n(this);this.x=-this.width;this.y=150;QI=h;var g=new mB(this,0.3,LB.rB);g.WB("x",110);g.onComplete=()=>JI=p.fB(bJ,10);p.add(g);} bJ(){if(JI!=null){p.remove(JI);JI=null;QI();var g=new mB(this,0.4,LB.uE);g.WB("x",800);g.onComplete=()=>this.parent.tB(this);p.add(g);}} NJ( g){bJ();}}class aD{var xE;var XF;var YF;var angle;var bF;var XB;}class eB{static var KB;}class bH extends AB implements kB{var KI;var bI;var WI;bH( h){this.TB=false;WI=0.0;bI=GB.mF(h);KI=new BB(bI[0]);KI.x=-25;KI.y=-25;n(KI);addEventListener(EB.rC,(g)=>p.add(this));addEventListener(EB.tC,(g)=>p.remove(this));} AC( g){WI+= g;var h=(WI*10).toInt()%bI.length;KI.OB=bI[h];return true;}}class ZH extends AB implements kB{var KI;var bI;var WI;ZH( h){this.TB=false;WI=0.0;bI=GB.lF(h);KI=new BB(bI[0]);KI.x=-25;KI.y=-25;n(KI);addEventListener(EB.rC,(g)=>p.add(this));addEventListener(EB.tC,(g)=>p.remove(this));} AC( g){WI+= g;var h=(WI*10).toInt()%bI.length;KI.OB=bI[h];return true;}}class aH extends AB implements kB{var KI;var WI;aH( h){this.TB=false;WI=0.0;KI=GB.fD(h);n(KI);addEventListener(EB.rC,(g)=>p.add(this));addEventListener(EB.tC,(g)=>p.remove(this));} AC( g){WI+= g;this.XB=SB.sin(WI*7)*10*SB.PI/180;return true;}}class gF extends AB{var DI;var MI;var UI;var cI;var iI;gF(){n(new BB(GB.KB.q("InfoBox")));MI=new HC();MI.LC=new YE("Arial",35,0xFFFFFF,BC:true,align:qB.IC);MI.width=220;MI.height=40;MI.wordWrap=false;MI.text="Level 1";MI.x=20;MI.y=115;MI.XB=-2*SB.PI/180;n(MI);cI=new HC();cI.LC=new YE("Arial",25,0xFFFFFF,BC:true,align:qB.IC);cI.width=220;cI.height=30;cI.wordWrap=false;cI.text="40";cI.x=-cI.width/2;cI.y=-cI.height/2;cI.XB=-2*SB.PI/180;iI=new AB();iI.n(cI);iI.x=150;iI.y=172;n(iI);var g=GB.dD(3,0);g.x=110;g.y=171;g.XB=-2*SB.PI/180;g.uB=g.CC=0.6;n(g);} set level( g){DI=g;MI.text="Level ${DI}";} set yE( g){UI=g;cI.text="${UI}";}}class zC extends AB{var BI;var KI;var VI;var fI;zC( g){BI=g;VI=GB.nF(g);fI=true;KI=new BB(VI[0]);KI.x=-34;KI.y=-50;n(KI);} get yC=>fI; set yC( g){fI=g;} UF( g){KI.OB=VI[g?0:4];} RH(){var i=new KC(0.0,1.0,2.0,LB.rB);i.FC=(j){uB=CC=1.0+0.2*SB.sin(j*4*SB.PI);};var g=new mB(this,0.2,LB.rB);g.WB("alpha",0.0);g.delay=2.0;g.onComplete=()=>UF(fI);var h=new mB(this,0.2,LB.uE);h.WB("alpha",1);h.delay=2.2;p.add(i);p.add(g);p.add(h);}}class aB extends EB{static const  ME="Explosion";static const  BD="Unlocked";static const  NE="Finalized";static const  eD="Timeouted";var vI;aB( h, g,[ bubbles=false]):super(h,bubbles){vI=g;} get info{return vI;}}class ZC{static var KB;}class GB{static var KB;static  dD( h, i){var g=new BB(KB.MC("Elements").q("Chain${h}${i}"));g.OC=25;g.PC=25;return g;}static  iF( h, i){var g=new BB(KB.MC("Elements").q("Link${h}${i}"));g.OC=25;g.PC=25;return g;}static  fD( h){var g=new BB(KB.MC("Elements").q(h));g.OC=25;g.PC=25;return g;}static  jF(){var m=new AB();var l=0;var o=KB.MC("Levelup");for(int k=0;k<7;k++ ){var h=new BB(o.q("LevelUp${k}"));h.x=-h.width/2;h.y=-h.height/2;var g=new AB();g.n(h);g.x=l+h.width/2;g.uB=0;g.CC=0;m.n(g);var i=new mB(g,2.0,LB.lG);i.WB("scaleX",1.0);i.WB("scaleY",1.0);i.delay=k*0.05;var j=new mB(g,0.4,LB.JC);j.WB("scaleX",0.0);j.WB("scaleY",0.0);j.delay=3.0;p.add(i);p.add(j);l=l+5+h.width;}return m;}static  lF( i){var h=KB.MC("Elements");var g=new List<CB>();g.add(h.q("JokerChain${i}0"));g.add(h.q("JokerChain${i}1"));g.add(h.q("JokerChain${i}2"));g.add(h.q("JokerChain${i}3"));g.add(h.q("JokerChain${i}4"));return g;}static  mF( i){var h=KB.MC("Elements");var g=new List<CB>();g.add(h.q("JokerLink${i}0"));g.add(h.q("JokerLink${i}1"));g.add(h.q("JokerLink${i}2"));g.add(h.q("JokerLink${i}3"));g.add(h.q("JokerLink${i}4"));return g;}static  nF( h){var i=KB.MC("Locks");var g=new List<CB>();g.add(i.q("Lock${h}0"));g.add(i.q("Lock${h}1"));g.add(i.q("Lock${h}2"));g.add(i.q("Lock${h}3"));g.add(i.q("Lock${h}4"));return g;}static  oF(){var h=KB.MC("Head");var g=new List<CB>();g.add(h.q("Head1"));g.add(h.q("Head2"));g.add(h.q("Head3"));g.add(h.q("Head2"));g.add(h.q("Head1"));return g;}static  pF(){var h=KB.MC("Alarm");var g=new List<CB>();g.add(h.q("Alarm0"));g.add(h.q("Alarm1"));g.add(h.q("Alarm2"));g.add(h.q("Alarm3"));g.add(h.q("Alarm4"));g.add(h.q("Alarm5"));return g;}}class ME extends AB implements kB{var sI;var WI;ME( o, v){sI=new List<aD>();WI=0.0;this.TB=false;var s=GB.dD(o,v);var m=new SB.Random();var i;var l;var DB;for(int h=0;h<=1;h++ ){for(int g=0;g<=1;g++ ){if(g==0&&h==0){i=SB.PI*1.15;XB=-SB.PI*2;}if(g==1&&h==0){i=SB.PI*1.85;XB=SB.PI*2;}if(g==1&&h==1){i=SB.PI*0.15;XB=SB.PI*2;}if(g==0&&h==1){i=SB.PI*0.85;XB=-SB.PI*2;}i=i+0.2*SB.PI*m.nextDouble();l=80.0+40.0*m.nextDouble();var j=new BB(s.OB);j.SD=new PB(g*25,h*25,25,25);j.OC=12.5+g*25;j.PC=12.5+h*25;j.x=g*25;j.y=h*25;n(j);var k=new aD();k.xE=j;k.XF=g*25+12.5;k.YF=h*25+12.5;k.angle=i;k.bF=l;k.XB=XB;sI.add(k);}}} AC( m){WI=SB.min(0.8,WI+m);var l=981.0;for(int i=0;i<sI.length;i++ ){var g=sI[i];var h=g.xE;var k=g.angle;var j=g.bF;var s=g.XB;var o=g.XF+WI*(SB.cos(k)*j);var v=g.YF+WI*(SB.sin(k)*j+WI*l*0.5);h.x=o;h.y=v;h.XB=WI*s;}if(WI>=0.6)this.alpha=(0.8-WI)/0.2;if(WI>=0.8)this.CE();return (WI<0.8);}}var CD;var aC;var DD;var p;var QC;var ED;var yB; main(){CD=new mC("StageBackground",YC.query('#stageBackground'));aC=new mC("StageForeground",YC.query('#stageForeground'));DD=new sF();DD.wE(CD);DD.wE(aC);p=DD.CH;var h=CB.vE("images/Loading.png");h.then((g){QC=new BB(g);QC.OC=20;QC.PC=20;QC.x=400;QC.y=270;aC.n(QC);ED=new mB(QC,100,LB.JC);ED.WB("rotation",100.0*2.0*SB.PI);p.add(ED);yB=new HC();yB.LC=new YE("Arial",20,0xA0A0A0,BC:true);yB.width=240;yB.height=40;yB.text="... loading ...";yB.x=400-yB.TH/2;yB.y=320;yB.TB=false;aC.n(yB);kF();});} kF(){var g=new jC();g.hB("Background","images/Background.jpg");g.hB("ExitBox","images/ExitBox.png");g.hB("ExitButtonNormal","images/ExitButtonNormal.png");g.hB("ExitButtonPressed","images/ExitButtonPressed.png");g.hB("ExitGauge","images/ExitGauge.png");g.hB("ExitNoButtonNormal","images/ExitNoButtonNormal.png");g.hB("ExitNoButtonPressed","images/ExitNoButtonPressed.png");g.hB("ExitYesButtonNormal","images/ExitYesButtonNormal.png");g.hB("ExitYesButtonPressed","images/ExitYesButtonPressed.png");g.hB("InfoBox","images/InfoBox.png");g.hB("MessageBox","images/MessageBox.png");g.hB("ShuffleButtonNormal","images/ShuffleButtonNormal.png");g.hB("ShuffleButtonPressed","images/ShuffleButtonPressed.png");g.hB("TimeGauge","images/TimeGauge.png");g.wC("Alarm","images/AlarmTextureAtlas.json",cC.lC);g.wC("Head","images/HeadTextureAtlas.json",cC.lC);g.wC("Elements","images/ElementsTextureAtlas.json",cC.lC);g.wC("Levelup","images/LevelupTextureAtlas.json",cC.lC);g.wC("Locks","images/LocksTextureAtlas.json",cC.lC);g.ZB("BonusAllUnlock","sounds/BonusAllUnlock.mp3");g.ZB("BonusUniversal","sounds/BonusUniversal.mp3");g.ZB("ChainBlast","sounds/ChainBlast.mp3");g.ZB("ChainBlastSpecial","sounds/ChainBlastSpecial.mp3");g.ZB("ChainError","sounds/ChainError.mp3");g.ZB("ChainFall","sounds/ChainFall.mp3");g.ZB("ChainHelp","sounds/ChainHelp.mp3");g.ZB("ChainLink","sounds/ChainLink.mp3");g.ZB("ChainRotate","sounds/ChainRotate.mp3");g.ZB("Click","sounds/Click.mp3");g.ZB("GameOver","sounds/GameOver.mp3");g.ZB("Laugh","sounds/Laugh.mp3");g.ZB("LevelUp","sounds/LevelUp.mp3");g.ZB("PointsCounter","sounds/PointsCounter.mp3");g.ZB("Unlock","sounds/Unlock.mp3");g.ZB("Warning","sounds/Warning.mp3");g.ZB("Intro","sounds/Intro.mp3");g.addText("ESCAPE_INS_AIM_0","Connect at least 3 chain links of the same colour to a horizontal or vertical chain.");g.addText("ESCAPE_INS_DES_0","You can change the direction of a chain link by touching it.");g.addText("ESCAPE_INS_TIP_0","Earn extra points for connecting chain links displaying a key symbol.");g.addText("ESCBlockErrorHint","Sorry but block chains canÂ´t be twisted!");g.addText("ESCLevelBoxText","Connect {0} chain links and help the crook to escape!");g.addText("ESCNoActionHint","Press on the chain links to twist them.");g.addText("ESCNoComboHint","You have to connect at least 3 chain links of the same colour.");g.addText("ESCStartText","Form horizontal or vertical same-colour chains and become an escape agent!");g.addText("ESCtogo","Chain links:");g.addText("GENexitquery","Do you really want to quit the game?");g.addText("GEN2ndchancetime","Time is up. Second chance!");g.addText("GENtimeup","Sorry! Your time is up.");g.addText("GENgameover","Game Over");g.load().then((j){aC.tB(QC);aC.tB(yB);p.remove(ED);GB.KB=g;eB.KB=g;ZC.KB=g;var i=new BB(GB.KB.q("Background"));CD.n(i);CD.NH=fC.tD;var h=new hF();aC.n(h);h.start();});}class qC extends lB{var HE;var PF;var DF;var WD;var IE=true;var enabled=true;var bL;qC([this.HE=null,this.PF=null,this.DF=null,this.WD=null]){addEventListener(t.nE,yL);addEventListener(t.MD,yL);addEventListener(t.KD,yL);addEventListener(t.wD,yL);bL=this.HE;} sB( g,[ returnRectangle=null]){if(bL!=null){NM.AE(bL.yM,g);return bL.sB(NM,returnRectangle);}return super.sB(g,returnRectangle);} NC( m, j){if(this.WD!=null){var g=this.WD.yM;var h=m-g.VC;var i=j-g.WC;var k=(g.d*h-g.c*i)/g.eC;var l=(g.a*i-g.b*h)/g.eC;if(this.WD.NC(k,l)!=null)return this;}return null;} nB( g){if(bL!=null)g.SF(bL);} yL( g){if(g.type==t.MD){bL=HE;}else{bL=g.TC?DF:PF;}}}class QB{var x;var y;QB(this.x,this.y);QB.AI():this(0,0); get length=>SB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new QB(this.x+g.x,this.y+g.y); equals( g)=>this.x==g.x&&this.y==g.y;}class HD{static final oD=new HD();var YL;HD(){YL=new List<cB>();} add( g){YL.add(g);} remove( h){var g=YL.indexOf(h);if(g!=-1)YL[g]=null;} MB( j){var k=YL.length;var i=0;for(int g=0;g<k;g++ ){var h=YL[g];if(h!=null){j.xM=h.FF;j.AN=h.FF;j.tM=bC.JD;h.MB(j);if(i!=g)YL[i]=h;i++ ;}}for(int g=k;g<YL.length;g++ )YL[i++ ]=YL[g];YL.length=i;}}abstract class kB{ AC( g);}class iD implements kB{var TK;var fK;var qK;iD(){qK=0.0;TK=new List<kB>();fK=0;} add( g){if(g==null)return;if(fK>=TK.length)TK.add(g);else TK[fK]=g;fK++ ;} remove( h){if(h==null)return;for(int g=0;g<fK;g++ )if(TK[g]==h)TK[g]=null;} fB( h, i){var g=new hD(h,i);add(g);return g;} AC( j){qK+= j;var k=fK;var h=0;for(int g=0;g<k;g++ ){var i=TK[g];if(i!=null&&i.AC(j)){if(h!=g)TK[h]=i;h++ ;}}for(int g=k;g<fK;g++ )TK[h++ ]=TK[g];for(int g=h;g<fK;g++ )TK[g]=null;fK=h;return true;}}class rF{rF();}class XE{var RG;XE( g){RG=g;} operator[]( g){return RG.aL(g);}}class t extends EB{static const  RC="click";static const  MG="doubleClick";static const  KD="mouseDown";static const  wD="mouseUp";static const  kE="mouseMove";static const  MD="mouseOut";static const  nE="mouseOver";static const  pE="mouseWheel";static const  qE="middleClick";static const  dG="middleMouseDown";static const  eG="middleMouseUp";static const  rE="rightClick";static const  fG="rightMouseDown";static const  gG="rightMouseUp";var XM,YM;var aM,bM;var JN;var qL;var DM;var sL;var uL;var LN;var MN;var NN;t( g,[ bubbles=false]):super(g,bubbles){PM(g,bubbles);} PM( g,[ bubbles=false]){super.PM(g,bubbles);XM=YM=0;aM=bM=0;JN=false;qL=false;DM=false;sL=false;uL=false;LN=0;MN=0;NN=0;} get HF=>XM; get IF=>YM; get TC=>JN; get altKey=>qL; get ctrlKey=>sL; get shiftKey=>uL; get xC=>LN; get deltaX=>MN; get deltaY=>NN;}class iC extends EB{static const  pD="keyDown";static const  cE="keyUp";var qL;var sL;var uL;var vL;var DM;var FM;var IM;var JM;iC( g,[ bubbles=false]):super(g,bubbles){PM(g,bubbles);} PM( g,[ bubbles=false]){super.PM(g,bubbles);qL=false;sL=false;uL=false;vL=false;DM=false;FM=0;IM=0;JM=0;} get altKey=>qL; get ctrlKey=>sL; get shiftKey=>uL; get charCode=>FM; get keyCode=>IM; get keyLocation=>JM;}class VE extends EB{static const  LG="textInput";var OK="";VE( g,[ bubbles=false]):super(g,bubbles){}}abstract class w extends bB implements TE{var lK=0.0;var rK=0.0;var zK=0.0;var EL=0.0;var KL=1.0;var QL=1.0;var VL=0.0;var dL;var fL;var mL=1.0;var oL=true;var CK="";var xL=null;var mask;var NM;var QM;w(){dL=new UB.yH();fL=true;NM=new UB.yH();QM=new UB.yH();} get x=>lK; get y=>rK; get OC=>zK; get PC=>EL; get uB=>KL; get CC=>QL; get XB=>VL; get alpha=>mL; get visible=>oL; get name=>CK; get parent=>xL;QE get on=>new QE(this); get root{var g=this;while (g.xL!=null)g=g.xL;return g;} get DE{var g=this.root;if(g is mC)return g;return null;} set x( g){lK=g;fL=true;} set y( g){rK=g;fL=true;} set OC( g){zK=g;fL=true;} set PC( g){EL=g;fL=true;} set uB( g){KL=g;fL=true;} set CC( g){QL=g;fL=true;} set XB( g){VL=g;fL=true;} set alpha( g){mL=g;fL=true;} get width=>sB(yM).width; get height=>sB(yM).height; set width( h){this.uB=1;var g=this.width;this.uB=(g!=0.0)?h/g:1.0;} set height( h){this.CC=1;var g=this.height;this.CC=(g!=0.0)?h/g:1.0;} CE(){if(xL!=null)xL.tB(this);} get yM{if(fL){fL=false;if(VL==0.0){dL.TF(KL,0.0,0.0,QL,lK-zK*KL,rK-EL*QL);}else{var g=SB.cos(VL);var h=SB.sin(VL);var i=KL*g;var l=KL*h;var k=-QL*h;var j=QL*g;var m=lK-zK*i-EL*k;var o=rK-zK*l-EL*j;dL.TF(i,l,k,j,m,o);}}return dL;} sB( g,[ returnRectangle=null]){if(returnRectangle==null)returnRectangle=new PB.AI();returnRectangle.x=g.VC;returnRectangle.y=g.WC;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} NC( g, h){if(sB(QM).contains(g,h))return this;return null;} VD( h){NM.vG();for(w g=this;g!=null;g=g.xL)NM.concat(g.yM);NM.BH();return NM.VH(h);} MB( h){var g=null;if(h.yD||h.bubbles)for(w j=xL;j!=null;j=j.xL)if(j.uG(h.type)){if(g==null)g=new List<w>();g.add(j);}if(h.yD&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.EE==false)g[i].dM(h,this,g[i],bC.bE);if(h.EE==false)dM(h,this,this,bC.JD);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.EE==false)g[i].dM(h,this,g[i],bC.OG);} PN( h){for(var g=h;g!=null;g=g.xL)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");xL=h;} nB( g);}abstract class lB extends w{var pG=false;var TB=true;var uH=true;var tabIndex=0;ZE get on=>new ZE(this);}abstract class hC extends lB{var mK;var sK=true;var DL=true;hC(){mK=new List<w>();}wF get on=>new wF(this); n( g){if(g.parent==this){var h=mK.indexOf(g);mK.removeAt(h);mK.add(g);}else{mG(g,mK.length);}} mG( g, h){if(h<0&&h>mK.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){mK.removeAt(mK.indexOf(g));if(h>mK.length)h-- ;mK.insertRange(h,1,g);}else{g.CE();g.PN(this);mK.insertRange(h,1,g);g.MB(new EB(EB.EG,true));if(this.DE!=null)QN(g,new EB(EB.rC));}} tB( h){var g=mK.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");MH(g);} MH( g){if(g<0&&g>=mK.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=mK[g];h.MB(new EB(EB.WG,true));if(this.DE!=null)QN(h,new EB(EB.tC));h.PN(null);mK.removeAt(g);} contains( g){for(;g!=null;g=g.xL)if(g==this)return true;return false;} sB( m,[ returnRectangle=null]){if(returnRectangle==null)returnRectangle=new PB.AI();if(mK.length==0)return super.sB(m,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var l=double.NEGATIVE_INFINITY;var k=double.NEGATIVE_INFINITY;var o=mK.length;for(int j=0;j<o;j++ ){NM.AE(mK[j].yM,m);var g=mK[j].sB(NM,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>l)l=g.right;if(g.bottom>k)k=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=l-h;returnRectangle.height=k-i;return returnRectangle;} NC( DB, o){var l=null;for(int j=mK.length-1;j>=0;j-- ){var i=mK[j];if(i.visible){var g=i.yM;var m=DB-g.VC;var k=o-g.WC;var s=(g.d*m-g.c*k)/g.eC;var v=(g.a*k-g.b*m)/g.eC;var h=i.NC(s,v);if(h!=null){if(h is lB)if(h.TB)return sK?h:this;l=this;}}}return l;} nB( i){for(int g=0;g<mK.length;g++ ){var h=mK[g];if(h.visible)i.SF(h);}} QN( h, i){h.MB(i);if(h is hC){var j=new List<w>.from(h.mK);var k=j.length;for(int g=0;g<k;g++ )QN(j[g],i);}}}class SE{var target=null;var TC=false;var zD=0;var xC=0;var LF,MF;var JF,KF;SE(this.LF,this.MF,this.JF,this.KF);}class UE extends EB{static const  DG="touchBegin";var SM;var UM;var XM,YM;var aM,bM;var qL;var DM;var sL;var uL;var iM;var lM;var nM;UE( g,[ bubbles=false]):super(g,bubbles){PM(g,bubbles);} PM( g,[ bubbles=false]){super.PM(g,bubbles);SM=0;UM=false;XM=YM=0;aM=bM=0;qL=false;DM=false;sL=false;uL=false;iM=1.00;lM=0;nM=0;} get ZF=>SM; get HF=>XM; get IF=>YM; get altKey=>qL; get ctrlKey=>sL; get shiftKey=>uL;}class WE{var CK;var SK;var hK;var nK;var vK;var BL;var IL;var ML;var PL;var WL;var cL;WE( h, g){CK=h;SK=g;} get UH=>SK; get name=>CK; get sG=>hK; get tG=>nK; get rG=>vK; get qG=>BL; get offsetX=>IL; get offsetY=>ML; get IH=>PL; get HH=>WL; get QH=>cL;}class AB extends hC{var hH=false;var IE=false;}class UB{var xJ,yJ,AK,BK,EK,GK;var NK;UB.yH():xJ=1.0,yJ=0.0,AK=0.0,BK=1.0,EK=0.0,GK=0.0,NK=1.0; get a=>xJ; get b=>yJ; get c=>AK; get d=>BK; get VC=>EK; get WC=>GK; get eC=>NK; VH( g){return new QB(g.x*xJ+g.y*AK+EK,g.x*yJ+g.y*BK+GK);} concat( g){var m=xJ;var v=yJ;var DB=AK;var s=BK;var l=EK;var o=GK;var RB=NK;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var gB=g.VC;var IB=g.WC;var oB=g.eC;xJ=(m*j+v*i);yJ=(m*k+v*h);AK=(DB*j+s*i);BK=(DB*k+s*h);EK=(l*j+o*i+gB);GK=(l*k+o*h+IB);NK=(RB*oB);} vG(){xJ=1.0;yJ=0.0;AK=0.0;BK=1.0;EK=0.0;GK=0.0;NK=1.0;} BH(){var j=xJ;var m=yJ;var l=AK;var k=BK;var h=EK;var i=GK;var g=NK;xJ=(k/g);yJ=-(m/g);AK=-(l/g);BK=(j/g);EK=-(xJ*h+AK*i);GK=-(yJ*h+BK*i);NK=(1.0/g);} TF( g, j, i, h, k, l){xJ=g;yJ=j;AK=i;BK=h;EK=k;GK=l;NK=(g*h-j*i);} AE( g, h){var o=g.a;var DB=g.b;var IB=g.c;var v=g.d;var m=g.VC;var s=g.WC;var gB=g.eC;var k=h.a;var l=h.b;var j=h.c;var i=h.d;var oB=h.VC;var RB=h.WC;var XC=h.eC;xJ=(o*k+DB*j);yJ=(o*l+DB*i);AK=(IB*k+v*j);BK=(IB*l+v*i);EK=(m*k+s*j+oB);GK=(m*l+s*i+RB);NK=(gB*XC);}}class bB{var UK; uG( g){return UK!=null&&UK.containsKey(g);} addEventListener( h, g,[ useCapture=false]){aL(h).add(g,useCapture);} MB( g){dM(g,this,this,bC.JD);}XE get on=>new XE(this); dM( g, i, k, j){if(UK!=null){var h=UK[g.type];if(h!=null){g.xM=i;g.AN=k;g.tM=j;g.CN=false;g.GN=false;h.MB(g);}}} aL( g){if(UK==null)UK=new Map<String,cB>();var h=UK[g];if(h==null)h=UK[g]=new cB(this,g);return h;}}abstract class TE{ nB( g);}class BB extends w{var OB;var KH;var SD;BB([this.OB=null,this.KH="auto"]){SD=null;} sB( h,[ returnRectangle=null]){var g=(OB!=null)?OB.width:0;var i=(OB!=null)?OB.height:0;return xD(h,g,i,returnRectangle);} NC( g, h){if(OB!=null&&g>=0.0&&h>=0.0&&g<OB.width&&h<OB.height)return this;return null;} nB( g){if(OB!=null){if(SD==null)OB.nB(g);else OB.RF(g,SD);}}}class cC{static const  CG="json";static const  lC="jsonarray";}class tF{var UD;var YD;tF(this.UD,this.YD);}class GD{static var PD;static  get QD{if(PD==null){try {PD=new YC.AudioContext();}catch (g){PD=null;}}return PD;}static var vC;static  get hG{if(vC==null){vC=(QD!=null)?"WebAudioApi":"AudioElement";var g=YC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))vC="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))vC="Mock";}return vC;}}class jC{var HK;var aK;var wK;var HL;var OL;var UL;var ZL;jC(){HK=new Map<String,CB>();aK=new Map<String,HB>();wK=new Map<String,YB>();HL=new Map<String,String>();OL=null;UL=0;ZL=0;} hB( i, j){var g=CB.vE(j);UL++ ;g.then(( h){HK[i]=h;UL-- ;vM();});g.handleException((k){ZL++ ;UL-- ;vM();});} ZB( h, i){var g=HB.BG(i);UL++ ;g.then(( j){aK[h]=j;UL-- ;vM();});g.handleException((k){ZL++ ;UL-- ;vM();});} wC( h, j, k){var g=YB.YG(j,k);UL++ ;g.then(( i){wK[h]=i;UL-- ;vM();});g.handleException((l){ZL++ ;UL-- ;vM();});} addText( h, g){HL[h]=g;} load(){OL=new Completer<jC>();vM();return OL.future;} q( g){if(HK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return HK[g];} iB( g){if(aK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return aK[g];} MC( g){if(wK.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return wK[g];} nC( g){if(HL.containsKey(g)==false)return "[[${g}]]";return HL[g];}vM(){if(OL!=null&&UL==0){if(ZL==0)OL.complete(this);else OL.completeException(this);}}}class hD implements kB{var KK=0.0;var cK=0.0;var oK=1;var AL;hD( g, h){AL=g;cK=SB.max(h,0.0001);} AC( h){var g=KK+h;while (g>=cK&&oK>0){KK=cK;oK-- ;AL();g-= cK;}if(oK==0)return false;KK=g;return true;} get totalTime=>cK; get currentTime=>KK;}class zB{var JK;var bK;var pK;var yK;zB.zH( h){JK=h;bK=new List<UB>();pK=new List<double>();yK=0;for(int g=0;g<100;g++ ){bK.add(new UB.yH());pK.add(1.0);}} get context=>JK; reset(){JK.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);JK.globalAlpha=1;JK.clearRect(0,0,JK.canvas.width,JK.canvas.height);yK=0;} SF( h){yK++ ;var g=bK[yK];g.AE(h.yM,bK[yK-1]);JK.setTransform(g.a,g.b,g.c,g.d,g.VC,g.WC);JK.globalAlpha=pK[yK]=pK[yK-1]*h.mL;if(h.mask==null){h.nB(this);}else{JK.save();h.mask.nB(this);h.nB(this);JK.restore();}yK-- ;}}class uF extends EB{var IK;uF( g):super(EB.uD,false){IK=g;} get yD=>false;}class vF{var wJ;var FK;var VK;var iK;vF.xH( i, g, h, j){wJ=0;FK=new PB(i,g,h,j);} nB( i){var g=i.context;g.beginPath();switch (wJ){case 0:g.rect(FK.x,FK.y,FK.width,FK.height);break;case 1:g.arc(VK.x,VK.y,VK.qH,0,SB.PI*2.0,false);break;case 2:g.moveTo(iK[0].x,iK[0].y);for(int h=1;h<iK.length;h++ )g.lineTo(iK[h].x,iK[h].y);break;}g.clip();}}class QE extends XE{QE( g):super(g);}class wF extends ZE{wF( g):super(g);}class ZE extends QE{ZE( g):super(g); get mouseOut=>this[t.MD]; get mouseMove=>this[t.kE]; get mouseDown=>this[t.KD]; get mouseUp=>this[t.wD]; get mouseWheel=>this[t.pE]; get keyUp=>this[iC.cE]; get keyDown=>this[iC.pD];}class FD extends w{static const  qD='DIRECTION_UP';static const  eE='DIRECTION_RIGHT';static const  vD='DIRECTION_DOWN';static const  LD='DIRECTION_LEFT';var hL;var kL;var nL;var rL;FD( g,[ direction=LD]){if(direction!=qD&&direction!=vD&&direction!=LD&&direction!=eE){throw new ArgumentError('Invalid Gauge direction!');}hL=direction;kL=1.0;nL=g;rL=new PB.AI();ZM();} get ratio=>kL;set ratio( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;kL=g;ZM();} get OB=>nL;set OB( g){nL=g;ZM();}ZM(){if(nL==null){rL.left=0;rL.top=0;rL.right=0;rL.bottom=0;}else{var g=nL.width;var h=nL.height;switch (hL){case LD:rL.left=((1.0-kL)*g).toInt();rL.top=0;rL.right=g;rL.bottom=h;break;case qD:rL.left=0;rL.top=((1.0-kL)*h).toInt();rL.right=g;rL.bottom=h;break;case eE:rL.left=0;rL.top=0;rL.right=(kL*g).toInt();rL.bottom=h;break;case vD:rL.left=0;rL.top=0;rL.right=g;rL.bottom=(kL*h).toInt();break;}}} sB( h,[ returnRectangle=null]){var g=(nL!=null)?nL.width:0;var i=(nL!=null)?nL.height:0;return xD(h,g,i,returnRectangle);} NC( g, h){if(nL!=null&&g>=0.0&&h>=0.0&&g<nL.width&&h<nL.height)return this;return null;} nB( g){if(nL!=null)nL.RF(g,rL);}}class pB{static const  nD="auto";static const  rD="arrow";static const  sD="button";static const  TG="hand";static const  VG="ibeam";static const  XG="wait";}class fC{static const  nD="auto";static const  JG="stop";static const  tD="once";}class EB{static const  EG="added";static const  rC="addedToStage";static const  uD="enterFrame";static const  WG="removed";static const  tC="removedFromStage";var wJ;var rM;var tM;var xM;var AN;var CN;var GN;EB( g,[ bubbles=false]){PM(g,bubbles);} PM( g,[ bubbles=false]){wJ=g;rM=bubbles;tM=bC.JD;xM=null;AN=null;CN=false;GN=false;} get EE=>CN; get SH=>GN; get type=>wJ; get eventPhase=>tM; get bubbles=>rM; get yD=>true; get target=>xM;}class bC{static const  bE=1;static const  JD=2;static const  OG=3;}class PB{var x;var y;var width;var height;PB(this.x,this.y,this.width,this.height);PB.AI():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new QB(this.width,this.height); set bottom( g){this.height=g-this.y;} set left( g){this.x=g;} set right( g){this.width=g-this.x;} set top( g){this.y=g;} contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0);}abstract class HB{static  BG( g){var h=GD.hG;if(h=="WebAudioApi")return kD.BG(g);if(h=="AudioElement")return lD.BG(g);return RE.BG(g);} get length; play([ loop=false, soundTransform=null]);static var SC;static  sE( g){if(SC==null){SC=new List<String>();var h=new YC.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)SC.add("ogg");if(i.indexOf(h.canPlayType("audio/mp3",""))!=-1)SC.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)SC.add("wav");}var l=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,ignoreCase:true);var j=l.firstMatch(g);if(j==null)throw new ArgumentError("Unsupported file extension.");var k=j.group(1).toLowerCase();if(SC.indexOf(k)==-1&&SC.length>0)g="${g.substring(0,g.length-3)}${SC[0]}";return g;}}abstract class GC extends bB{ get DC; set DC( g); stop();}class VB{var volume;var JH;var oH=1;var pH=0;var tH=1;var sH=0;VB([this.volume=1,this.JH=0]);}class sF{var zJ;var PK;var WK;var uK;var GL;sF(){zJ=new iD();PK=new List<mC>();WK=double.NAN;uK=HD.oD;GL=new uF(0);YC.window.requestAnimationFrame(BM);} get CH=>zJ; BM( g){YC.window.requestAnimationFrame(BM);if(WK.isNaN)WK=g;if(WK>g)WK=g;var i=g-WK;var j=i/1000.0;if(i>=1){WK=g;GL.IK=j;uK.MB(GL);zJ.AC(j);for(int h=0;h<PK.length;h++ ){var k=PK[h];k.EH();}}} wE( g){PK.add(g);}}class lD extends HB{var QK;var jK;var CL;lD(){CL=new List<ID>();QK=new YC.AudioElement();QK.on.ended.add(jL);jK=new List<YC.AudioElement>();jK.add(QK);YC.window.document.body.elements.add(QK);}static  BG( l){var h=new lD();var g=new Completer<HB>(); j(i){if(g.future.isComplete==false)g.complete(h);} k(i){if(g.future.isComplete==false)g.completeException("Failed to load audio.");}h.QK.src=HB.sE(l);h.QK.on.canPlayThrough.add(j);h.QK.on.error.add(k);h.QK.load();return g.future;} get length{return QK.duration;} play([ loop=false, soundTransform=null]){if(soundTransform==null)soundTransform=new VB();return new ID(this,loop,soundTransform);} zL( h){var g;if(jK.length==0){g=QK.clone(true);g.on.ended.add(jL);}else{g=jK[0];jK.removeAt(0);}CL.add(h);return g;} KN( g){var h=g.QK;var i=CL.indexOf(g);CL.removeAt(i);jK.add(h);if(QK.currentTime>0&&QK.ended==false)QK.currentTime=0;} jL(j){var i=j.target;var g=null;for(int h=0;h<CL.length&&g==null;h++ )if(CL[h].QK==i)g=CL[h];if(g!=null)g.stop();}}class ID extends GC{var dK;var QK;var MK;var gK;ID( h, i, g){dK=h;MK=i;gK=g;QK=h.zL(this);QK.loop=MK;this.DC=g;QK.play();} get DC=>gK; set DC( g){gK=g;if(QK!=null)QK.volume=(gK!=null)?gK.volume:1;} stop(){if(QK!=null){if(QK.ended==false)QK.pause();dK.KN(this);QK=null;}}}class kD extends HB{var LK;kD(){if(GD.QD==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  BG( m){var i=new kD();var g=new Completer<HB>();var h=new YC.HttpRequest(); o( k){i.LK=k;if(g.future.isComplete==false)g.complete(i);} j(IB){if(g.future.isComplete==false)g.completeException("Failed to decode audio.");} v(s){var DB=GD.QD;DB.decodeAudioData(h.response,o,j);} l(s){if(g.future.isComplete==false)g.completeException("Failed to load audio.");}h.open('GET',HB.sE(m),true);h.responseType='arraybuffer';h.on.load.add(v);h.on.error.add(l);h.send();return g.future;} get length{return LK.duration;} play([ loop=false, soundTransform=null]){if(soundTransform==null)soundTransform=new VB();return new cH(this,loop,soundTransform);}}class cH extends GC{var ZK;var gK;var MK;var JL;var RL;cH( j, h, i){ZK=j;MK=h;gK=i;var g=GD.QD;JL=g.createGain();JL.connect(g.destination,0,0);JL.gain.value=(gK!=null)?SB.pow(gK.volume,2):1;RL=g.createBufferSource();RL.buffer=ZK.LK;RL.loop=h;RL.connect(JL,0,0);RL.start(0);} get DC=>gK; set DC( g){gK=g;JL.gain.value=(gK!=null)?SB.pow(gK.volume,2):1;} stop(){RL.stop(0);}}class RE extends HB{RE(){}static  BG( i){var h=new RE();var g=new Completer<HB>();YC.window.setTimeout(()=>g.complete(h),1);return g.future;} get length{return double.NAN;} play([ loop=false, soundTransform=null]){if(soundTransform==null)soundTransform=new VB();return new dH(this,loop,soundTransform);}}class dH extends GC{var MK;var gK;dH( i, h, g){MK=h;gK=g;} get DC=>gK; set DC( g){gK=g;} stop(){}}class xF{static const  HG="pixel";}class HC extends lB{var OK="";var YK=0x000000;var tK=null;var FL=yF.QG;var SL=xF.HG;var wJ=qF.AG;var gL=false;var lL=false;var pL=0x000000;var tL=false;var wL=0x000000;var AM=0;var EM=0;var HM;var KM;var LM=true;var MM=100;var OM=100;var RM=null;var JK=null;HC(){tK=new YE("Arial",12,0x000000);HM=new List<String>();KM=new List<gD>();} get type=>wJ; get width=>MM; get height=>OM; set text( g){OK=g;LM=true;} set LC( g){tK=g;YK=tK.color;LM=true;} set wordWrap( g){gL=g;LM=true;} set width( g){MM=g;LM=true;} set height( g){OM=g;LM=true;} get TH{UN();return AM;} get GE{UN();return EM;} sB( g,[ returnRectangle=null]){return xD(g,MM,OM,returnRectangle);} NC( g, h){if(g>=0&&h>=0&&g<MM&&h<OM)return this;return null;} nB( g){UN();g.JK.drawImage(RM,0.0,0.0);} XN(){HM.clear();KM.clear();if(gL==false){HM.add(OK);}else{var g=new StringBuffer();var i;var h;for(String j in OK.split(" ")){i=g.length;g.add((i>0)?" ${j}":j);h=g.toString();if(JK.measureText(h).width>MM){if(i>0)h=h.substring(0,i);else j="";HM.add(h);g.clear();g.add(j);}}if(g.isEmpty==false)HM.add(g.toString());}AM=0;EM=0;for(String h in HM){var k=JK.measureText(h);var l=0;if(tK.align==qB.IC||tK.align==qB.PG)l=(MM-k.width)/2;if(tK.align==qB.NG||tK.align==qB.KG)l=MM-k.width;var m=new gD(l,k.width,tK.size,0,0,0);KM.add(m);AM=SB.max(AM,m.width);EM=EM+m.height;}} UN(){if(LM){LM=false;var j=MM.ceil().toInt();var i=OM.ceil().toInt();if(RM==null){RM=new YC.CanvasElement(width:j,height:i);JK=RM.context2d;}if(RM.width!=j)RM.width=j;if(RM.height!=i)RM.height=i;var g=new StringBuffer();g.add(tK.GF?"italic ":"normal ");g.add("normal ");g.add(tK.BC?"bold ":"normal ");g.add("${tK.size}px ");g.add("${tK.font},sans-serif");JK.font=g.toString();JK.textAlign="start";JK.textBaseline="top";JK.fillStyle=sC(YK);XN();if(lL){JK.fillStyle=sC(pL);JK.fillRect(0,0,MM,OM);}else{JK.clearRect(0,0,MM,OM);}var k=0;for(int h=0;h<HM.length;h++ ){var l=KM[h];JK.fillStyle=sC(YK);JK.fillText(HM[h],l.x,k);k+= l.height;}if(tL){JK.strokeStyle=sC(wL);JK.lineWidth=1;JK.strokeRect(0,0,MM,OM);}}}}class yF{static const  QG="none";}class qF{static const  AG="dynamic";}class YE{var font;var size;var color;var BC;var GF;var WH;var align;var DH;var PH;var xG;var BE;var letterSpacing=0;var fH=0;var gH=false;var nH=false;YE(this.font,this.size,this.color,{this.BC: false,this.GF: false,this.WH: false,this.align: "left",this.DH: 0,this.PH: 0,this.xG: 0,this.BE: 0});}class qB{static const  IC="center";static const  KG="end";static const  PG="justify";static const  NG="right";}class gD{var nG;var oG;var height;var BE;var width;var x;gD(this.x,this.width,this.height,this.nG,this.oG,this.BE);}class gC{static const  zF=0;static const  FG=1;static const  NG=2;static const  SG=3;static const  gE=4;}class jD{static var aE=pB.nD;static var GG=false;static var RG=new bB();static  tE( i){var h=i;var g="auto";if(aE!=pB.nD)h=aE;switch (h){case pB.nD:g="auto";break;case pB.rD:g="default";break;case pB.sD:g="pointer";break;case pB.TG:g="move";break;case pB.VG:g="text";break;case pB.XG:g="wait";break;}if(GG)g="none";return g;}}class YB{var DK;var eK;YB(){DK=new YC.ImageElement();eK=new List<WE>();}static  YG( o, RB){var m=new Completer<YB>();var i=new YB();switch (RB){case cC.CG:case cC.lC:var j=new YC.HttpRequest();j.open('GET',o,true);j.on.load.add((oB){ s( l, g){var IB=jG(l);var h=new WE(IB,i);h.hK=g["frame"]["x"].toInt();h.nK=g["frame"]["y"].toInt();h.vK=g["frame"]["w"].toInt();h.BL=g["frame"]["h"].toInt();h.IL=g["spriteSourceSize"]["x"].toInt();h.ML=g["spriteSourceSize"]["y"].toInt();h.PL=g["sourceSize"]["w"].toInt();h.WL=g["sourceSize"]["h"].toInt();h.cL=g["rotated"] as bool;i.eK.add(h);}var v=YH.JSON.parse(j.responseText);var k=v["frames"];var DB=v["meta"];if(k is List)for(var g in k)s(g["filename"],g);if(k is Map)for(String l in k.mH())s(l,k[l]);i.DK.on.load.add((gB)=>m.complete(i));i.DK.on.error.add((gB)=>m.completeException("Failed to load image."));i.DK.src=kG(o,DB["image"]);});j.on.error.add((oB)=>m.completeException("Failed to load json file."));j.send();break;}return m.future;} get wG=>DK; q( i){var g;for(int h=0;h<eK.length&&g==null;h++ )if(eK[h].name==i)g=new CB.wH(eK[h]);if(g==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return g;}static  jG( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,ignoreCase:true);var i=h.firstMatch(g);return i.group(1);}static  kG( i, h){var k=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,ignoreCase:true);var j=k.firstMatch(i);var g=j.group(1);return (g==null)?h:"${g}${h}";}}class CB implements TE{var RK;var XK;var kK;var xK;var JK;var NL;var TL;var XL;var hK;var nK;var vK;var BL;CB( g, i,[ transparent=true, fillColor=0xFFFFFFFF]){RK=g;XK=i;kK=transparent;var h=new YC.CanvasElement(width:RK,height:XK);JK=h.context2d;JK.fillStyle=kK?aG(fillColor):sC(fillColor);JK.fillRect(0,0,g,i);xK=h;NL=0;}CB.vH( g){RK=g.naturalWidth;XK=g.naturalHeight;kK=true;xK=g;NL=0;}CB.wH( g){RK=g.IH;XK=g.HH;kK=true;xK=g.UH.wG;NL=g.QH?2:1;TL=g.offsetX.toDouble();XL=g.offsetY.toDouble();hK=g.sG.toDouble();nK=g.tG.toDouble();vK=g.rG.toDouble();BL=g.qG.toDouble();}static  vE( i){var h=new Completer<CB>();var g=new YC.ImageElement();g.on.load.add((j)=>h.complete(new CB.vH(g)));g.on.error.add((j)=>h.completeException("Failed to load image."));g.src=i;return h.future;} get width=>RK; get height=>XK; nB( g){switch (NL){case 0:g.context.drawImage(xK,0.0,0.0);break;case 1:g.context.drawImage(xK,hK,nK,vK,BL,TL,XL,vK,BL);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,TL,XL+BL);g.context.drawImage(xK,hK,nK,BL,vK,0.0,0.0,BL,vK);break;}} RF( gB, g){if(g.width<=0.0||g.height<=0.0)return;switch (NL){case 0:gB.context.drawImage(xK,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=hK;double h=nK;double s=j+vK;double DB=h+BL;double m=hK-TL+g.x;double k=nK-XL+g.y;double RB=m+g.width;double IB=k+g.height;double v=(j>m)?j:m;double l=(h>k)?h:k;double oB=(s<RB)?s:RB;double JE=(DB<IB)?DB:IB;double XC=TL-j+v;double KE=XL-h+l;double o=oB-v;double i=JE-l;if(o>0.0&&i>0.0){gB.context.drawImage(xK,v,l,o,i,XC,KE,o,i);}break;case 2:double j=hK;double h=nK;double s=j+BL;double DB=h+vK;double m=hK+XL-g.y+BL-g.height;double k=nK-TL+g.x;double RB=m+g.height;double IB=k+g.width;double v=(j>m)?j:m;double l=(h>k)?h:k;double oB=(s<RB)?s:RB;double JE=(DB<IB)?DB:IB;double XC=TL-h+l;double KE=XL+s-oB;double o=JE-l;double i=oB-v;if(o>0.0&&i>0.0){gB.context.transform(0.0,-1.0,1.0,0.0,XC,KE+i);gB.context.drawImage(xK,v,l,i,o,0.0,0.0,i,o);}break;}}}class mD extends FD implements kB{static const  IG='TIME_OUT';var LL=false;var KK=0.0;var cK=0.0;var eL;var iL=true;mD( g, h,[ direction=FD.LD]):super(h,direction){if(g<=0)throw new ArgumentError('Time must be greater than zero');cK=g;zE();} AC( g){if(LL&&ratio>0.0){ratio=ratio-g/totalTime;if(ratio==0.0)pause();}return true;} start(){LL=true;} pause(){LL=false;} reset([ time=0.0]){pause();time=SB.max(time,0.0);if(time!=0.0){cK=time;zE();}ratio=1.0;} RD( h, g){eL[h]=g/totalTime;} zE(){eL=new Map<String,num>();RD(mD.IG,0);} get totalTime=>cK; get OH=>ratio*totalTime; set ratio( h){var i=ratio;super.ratio=h;if(iL){eL.forEach((j,g){if(g<i&&g>=ratio)MB(new EB(j));});}}}typedef  kC(event); sC( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}typedef  dE();typedef  fE();class UG{static var hE=false;static var uC=false;static var ND=0;static cG(){if(hE==false){hE=true;var g=YC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){uC=true;ND=10;}if(g.contains("Android")){uC=true;ND=10;}if(g.contains("IEMobile")){uC=true;ND=10;}}uC=false;ND=0;}static  get iG{cG();return uC;}}typedef  iE( value);typedef  jE();typedef  OD( ratio);typedef  lE();typedef  mE();class ZG{var name;var vB;var FE;ZG(this.name,this.vB,this.FE);}class cB{var RG;var CM;var GM;cB( g, h){RG=g;CM=h;GM=new List<tF>();} get FF=>RG; add( h,[ useCapture=false]){for(int g=0;g<GM.length;g++ )if(GM[g].UD==h&&GM[g].YD==useCapture)return;if(CM==EB.uD&&GM.length==0)HD.oD.add(this);GM.add(new tF(h,useCapture));} remove( h,[ useCapture=false]){for(int g=0;g<GM.length;g++ ){if(GM[g].UD==h&&GM[g].YD==useCapture){GM=new List<tF>.from(GM);GM.removeAt(g);if(CM==EB.uD&&GM.length==0)HD.oD.remove(this);break;}}} operator+( g){this.add(g,false);} operator-( g){this.remove(g,false);} MB( h){for(int g=0;g<GM.length;g++ )if(h.eventPhase!=bC.bE||GM[g].YD)if(h.SH==false)GM[g].UD(h);}}class oE{static var bG=0;var ZF=bG++ ;var target=null;} aG( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class LB{static  JC( g){return g;}static  uE( g){return g*g*g;}static  rB( g){g=1.0-g;return 1.0-g*g*g;}static  lG( g){if(g==0.0||g==1.0)return g;return SB.pow(2.0,-10.0*g)*SB.sin((g-0.3/4.0)*(2.0*SB.PI)/0.3)+1;}}class KC extends kB{var TM;var VM;var WM;var cM;var eM;var hM;var kM;var cK;var KK;var pM;var sM;var uM;KC( g, h, i,[ transitionFunction=null]){TM=g;VM=h;WM=g;cM=(transitionFunction!=null)?transitionFunction:LB.JC;KK=0.0;cK=SB.max(0.0001,i);pM=0.0;sM=false;uM=false;} AC( h){if(KK<cK||uM==false){KK=KK+h;if(KK>cK)KK=cK;if(KK>=0.0){if(uM==false){uM=true;if(eM!=null)eM();}var g=KK/cK;var i=cM(g);WM=TM+i*(VM-TM);if(hM!=null)hM(sM?WM.round():WM);if(kM!=null&&KK==cK)kM();}}return KK<cK;} get vB=>TM; get FE=>VM; get totalTime=>cK; get currentTime=>KK; get isComplete=>KK>=cK;set delay( g){if(uM==false)KK=KK+pM-g;pM=g;} set OF( g){eM=g;} set FC( g){hM=g;} set onComplete( g){kM=g;}}class mC extends hC{var RM;var JK;var fM;var gM;var jM;var mM;var oM;var qM;var wM;var zM;var BN;var EN;var HN;mC( h, g){CK=h;RM=g;RM.style.outline="none";RM.focus();JK=g.context2d;gM=new zB.zH(JK);jM=fC.nD;mM=pB.rD;jD.RG.addEventListener("mouseCursorChanged",ON);wM=[new SE(t.KD,t.wD,t.RC,t.MG),new SE(t.dG,t.eG,t.qE,t.qE),new SE(t.fG,t.gG,t.rE,t.rE)];qM=null;oM=new QB(0,0);BN=new t(t.RC,true);RM.on.mouseDown.add(yL);RM.on.mouseUp.add(yL);RM.on.mouseMove.add(yL);RM.on.mouseOut.add(yL);RM.on.mouseWheel.add(RN);zM=new Map<int,oE>();HN=new UE(UE.DG,true);if(UG.iG){RM.on.touchStart.add(SN);RM.on.touchEnd.add(SN);RM.on.touchMove.add(SN);RM.on.touchEnter.add(SN);RM.on.touchLeave.add(SN);}EN=new iC(iC.pD,true);RM.on.keyDown.add(TN);RM.on.keyUp.add(TN);RM.on.keyPress.add(VN);} get focus=>fM; set NH( g){jM=g;} WN(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){WN();} set y( g){WN();} set OC( g){WN();} set PC( g){WN();} set uB( g){WN();} set CC( g){WN();} set XB( g){WN();} set alpha( g){WN();} set width( g){WN();} set height( g){WN();} EH(){if(jM==fC.nD||jM==fC.tD){gM.reset();nB(gM);if(jM==fC.tD)jM=fC.JG;}} ON( g){RM.style.cursor=jD.tE(mM);} yL( k){k.preventDefault();var IB=RM.getBoundingClientRect();var o=new Date.now().millisecondsSinceEpoch;var s=k.button;var h=null;var i=new QB(k.clientX-IB.left,k.clientY-IB.top);var j=null;if(s<0||s>2)return;if(k.type=="mousemove"&&oM.equals(i))return;var g=wM[s];oM=i;if(k.type!="mouseout")h=NC(i.x,i.y) as lB;var m=pB.rD;if(h is AB)if(h.IE)m=pB.sD;if(h is qC)if(h.IE)m=pB.sD;if(mM!=m){mM=m;RM.style.cursor=jD.tE(m);}if(qM!=null&&qM!=h){if(qM.DE!=null)j=qM.VD(i);else j=new QB.AI();BN.PM(t.MD,true);BN.XM=j.x;BN.YM=j.y;BN.aM=i.x;BN.bM=i.y;BN.JN=g.TC;qM.MB(BN);qM=null;}if(h!=null&&h!=qM){j=h.VD(i);BN.PM(t.nE,true);BN.XM=j.x;BN.YM=j.y;BN.aM=i.x;BN.bM=i.y;BN.JN=g.TC;qM=h;qM.MB(BN);}var l=null;var v=false;var DB=false;if(k.type=="mousedown"){l=g.LF;if(h!=g.target||o>g.zD+500)g.xC=0;g.TC=true;g.target=h;g.zD=o;g.xC++ ;}if(k.type=="mouseup"){l=g.MF;g.TC=false;v=(g.target==h);DB=v&&g.xC.isEven&&(o<g.zD+500);}if(k.type=="mousemove"){l=t.kE;}if(l!=null&&h!=null){j=h.VD(i);BN.PM(l,true);BN.XM=j.x;BN.YM=j.y;BN.aM=i.x;BN.bM=i.y;BN.JN=g.TC;BN.LN=g.xC;h.MB(BN);if(v){l=g.JF;if(DB&&h.pG)l=g.KF;BN.PM(l,true);BN.XM=j.x;BN.YM=j.y;BN.aM=i.x;BN.bM=i.y;BN.JN=g.TC;h.MB(BN);}}} RN( g){var h=NC(g.offsetX,g.offsetY);if(h!=null){var i=new QB(g.offsetX,g.offsetY);var j=h.VD(i);BN.PM(t.pE,true);BN.XM=j.x;BN.YM=j.y;BN.aM=i.x;BN.bM=i.y;BN.MN=g.deltaX;BN.NN=g.deltaY;h.MB(BN);}} SN( h){h.preventDefault();print("event.type -> ${h.type}");var k=RM.getBoundingClientRect();for(var i in h.changedTouches){var g=i.identifier;var m=null;var j=new QB(i.clientX-k.left,i.clientY-k.top);var o=null;if(zM.containsKey(g)==false)zM[g]=new oE();var l=zM[g];print("  identifier:${g}, touchPointID:${l.ZF} - x:${j.x}, y:${j.y}");}} TN( g){g.preventDefault();var h=null;if(g.type=="keyup")h=iC.cE;if(g.type=="keydown")h=iC.pD;EN.PM(h,true);EN.qL=g.altKey;EN.sL=g.ctrlKey;EN.uL=g.shiftKey;EN.FM=g.charCode;EN.IM=g.keyCode;EN.JM=gC.zF;if(g.keyLocation==YC.KeyLocation.LEFT)EN.JM=gC.FG;if(g.keyLocation==YC.KeyLocation.RIGHT)EN.JM=gC.NG;if(g.keyLocation==YC.KeyLocation.NUMPAD)EN.JM=gC.SG;if(g.keyLocation==YC.KeyLocation.JOYSTICK)EN.JM=gC.gE;if(g.keyLocation==YC.KeyLocation.MOBILE)EN.JM=gC.gE;if(fM!=null)fM.MB(EN);} VN( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new VE(VE.LG,true);h.OK=new String.fromCharCodes([i]);if(fM!=null)fM.MB(h);}}class mB implements kB{var DN;var cM;var IN;var eM;var hM;var kM;var cK;var KK;var pM;var sM;var uM;mB( h, g,[ transitionFunction=null]){DN=h;cM=(transitionFunction!=null)?transitionFunction:LB.JC;KK=0.0;cK=SB.max(0.0001,g);pM=0.0;sM=false;uM=false;IN=new List<ZG>();} WB( g, i){var h=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(h.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(DN!=null&&uM==false)IN.add(new ZG(g,0.0,i));} moveTo( h, g){WB('x',h);WB('y',g);} AC( k){if(KK<cK||uM==false){KK=KK+k;if(KK>cK)KK=cK;if(KK>=0.0){if(uM==false){uM=true;for(int i=0;i<IN.length;i++ ){var g=IN[i];switch (g.name){case 'x':g.vB=DN.x;break;case 'y':g.vB=DN.y;break;case 'pivotX':g.vB=DN.OC;break;case 'pivotY':g.vB=DN.PC;break;case 'scaleX':g.vB=DN.uB;break;case 'scaleY':g.vB=DN.CC;break;case 'rotation':g.vB=DN.XB;break;case 'alpha':g.vB=DN.alpha;break;}}if(eM!=null)eM();}var j=KK/cK;var l=cM(j);for(int i=0;i<IN.length;i++ ){var g=IN[i];var h=g.vB+l*(g.FE-g.vB);h=sM?h.round():h;switch (g.name){case 'x':DN.x=h;break;case 'y':DN.y=h;break;case 'pivotX':DN.OC=h;break;case 'pivotY':DN.PC=h;break;case 'scaleX':DN.uB=h;break;case 'scaleY':DN.CC=h;break;case 'rotation':DN.XB=h;break;case 'alpha':DN.alpha=h;break;}}if(hM!=null)hM();if(kM!=null&&KK==cK)kM();}}return KK<cK;} get totalTime=>cK; get currentTime=>KK; get isComplete=>KK>=cK;set delay( g){if(uM==false)KK=KK+pM-g;pM=g;} set OF( g){eM=g;} set FC( g){hM=g;} set onComplete( g){kM=g;}} xD( g, DB, o, l){var XC=0.0;var oB=0.0;var v=DB*g.a;var gB=DB*g.b;var IB=DB*g.a+o*g.c;var s=DB*g.b+o*g.d;var RB=o*g.c;var m=o*g.d;var h=XC;if(h>v)h=v;if(h>IB)h=IB;if(h>RB)h=RB;var i=oB;if(i>gB)i=gB;if(i>s)i=s;if(i>m)i=m;var j=XC;if(j<v)j=v;if(j<IB)j=IB;if(j<RB)j=RB;var k=oB;if(k<gB)k=gB;if(k<s)k=s;if(k<m)k=m;if(l==null)l=new PB.AI();l.x=g.VC+h;l.y=g.WC+i;l.width=j-h;l.height=k-i;return l;}
//@ sourceMappingURL=escape.dart.map