import "dart:web_audio" as UH;import "dart:math" as ZB;import "dart:html" as mC;import "dart:json" as QK;class QC{var x;var y;QC(this.x,this.y);set length( g){this.normalize();this.WJ(g);} get length{return ZB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new QC(x,y);} add( g){if(g==null)return null;return new QC(x+g.x,y+g.y);}WJ( g){x*= g;y*= g;} get EF{var g=ZB.PI-ZB.atan2(this.x,this.y);if(g<0)g+= 2*ZB.PI;return g;}set EF( i){var h=this.length;var g=EB.aI(h,i-ZB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class aC{var x;var y;var z;aC(this.x,this.y,this.z); clone(){return new aC(x,y,z);} pG(){return ZB.sqrt(x*x+y*y+z*z);}CK( g){this.normalize();this.scale(g);} add( g){return new aC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=pG();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} equals( g){return (g.x==x&&g.y==y&&g.z==z);}}class VB extends aE implements dC{static var jD=588;static var TD=314;static var dH=10.0;var sC;var rB;var FL;var iF;var GC;VB( g,[ autoStart=true, fontName=tD]):super(g){this.GC=fontName;this.width=VB.jD;this.height=VB.TD;this.sC=new iB(m.KB("items").CB("menu_bg"));this.v(this.sC);this.rB=new cC();this.rB.xC=0x000000;this.rB.wordWrap=true;this.rB.UC=new zF(fontName,30,0x000000,zB:true,align:mB.yD);this.rB.width=476;this.rB.height=250;this.rB.x=60;this.rB.y=90;this.v(this.rB);this.addEventListener(p.eC,this.XF);if(autoStart){this.SH=0;this.iF=0;aB.add(this);}else{this.SH=1;}this.alpha=0;} ED( g){this.iF+= g;if(this.iF>dH){dD();NF();return false;}return true;}set text( g){if(g==null)return;var h=new zF(GC,30,0x000000,zB:true,align:mB.yD);if(g.length<=30)h.size=45;else h.size=30;this.rB.UC=h;this.rB.text=g;} XF( g){dD();NF();} NF(){this.u(new JB(JB.uB,this));}set SH( g){if(g<0)g=1;if(g>1)g=1;FL=g;var h=(255*FL).round().toInt();} dD(){aB.remove(this);}}class JB extends AB{static const  uB="MenuEvent.TYPE_OK";static const  kD="MenuEvent.TYPE_CANCEL";var ME;JB( h, g,[ bubbles=false]):super(h,bubbles){this.ME=g;}}class XH extends aE{var sC;var YC;var BC;var AC;var MC;var KC;var LC;var font;var kF=30;var UE;XH( h,[ fontName=tD]):super(h){this.font=fontName;this.tC();var g=new StringBuffer();g.add((this.s as sB).eB("GENlevel"));g.add(": 0");AC.text=g.toString();} tC(){this.sC=new iB(m.KB("items").CB("topbar"));this.sC.x=0;this.sC.y=0;this.v(this.sC);this.YC=new cC();this.YC.UC=new zF(font,24,0,zB:true,align:mB.TG);this.YC.xC=0x000000;this.YC.width=400;this.YC.height=100;this.YC.x=20;this.YC.y=kF;this.v(YC);this.BC=new cC();this.BC.UC=new zF(font,24,0,zB:true,align:mB.AE);this.BC.xC=0x000000;this.BC.width=200;this.BC.height=100;this.BC.x=(this.s.JE/2)-this.BC.width+60;this.BC.y=kF;this.v(BC);this.AC=new cC();this.AC.UC=new zF(font,24,0,zB:true,align:mB.AE);this.AC.xC=0x000000;this.AC.width=200;this.AC.height=100;this.AC.x=(this.s.JE)-(this.AC.width)-20;this.AC.y=kF;this.v(AC);this.MC=new cC();this.MC.UC=new zF(font,24,0,zB:true,align:mB.yD);this.MC.xC=0x000000;this.MC.width=200;this.MC.height=100;this.MC.x=20;this.MC.y=this.s.mG-this.MC.height-20;this.v(MC);this.MC.visible=false;this.KC=new iB(m.KB("items").CB("progressbar"));this.KC.x=25;this.KC.y=82;this.v(this.KC);this.LC=new iB(m.KB("items").CB("progressship"));this.LC.x=25;this.LC.y=this.KC.y+(this.KC.height-(this.KC.height-this.LC.height))-(this.LC.height);this.v(this.LC);this.UE=new List<iB>();for(var h=0;h<3;h++ ){var g=new iB(m.KB("items").CB("spaceship"));g.y=10;g.x=(this.s.JE/2)+70+(h*35);this.v(g);this.UE.add(g);}} bF( g){this.LC.x=25;this.LC.y=this.KC.y+(this.KC.height-((this.KC.height-this.LC.height)*g.s.progress))-(this.LC.height);} ZF( i){var h=i.s as sB;if(h.OD){this.BC.text=h.eB("DISPLAY_TRAINING");}else{this.BC.text=h.eB("DISPLAY_LIVES");}for(var g=0;g<this.UE.length;g++ ){this.UE[g].visible=(!h.OD)&&(g<i.s.LD);}} cF( h){var i=h.s as sB;var g=new StringBuffer();g.add(i.eB("GENscore"));g.add(": ${h.s.BK.toString()}");YC.text=g.toString();} hD( h){var i=h.s as sB;var g=new StringBuffer();g.add(i.eB("GENlevel"));g.add(": ${h.s.level.toString()}");AC.text=g.toString();}}class WH extends VB{var oB;var hC;var ZC;var OC;var dG=40;var eG=30;var GC;WH( g,[ fontName=tD]):super(g,true,fontName){this.GC=fontName;this.removeEventListener(p.qC,this.XF);this.removeEventListener(p.eC,this.XF);this.tC();} tC(){var g=this.s as sB;this.rB.wordWrap=true;this.text=g.eB("GENexitquery");this.oB=new xD(new iB(m.KB("items").CB("but_yes")),new iB(m.KB("items").CB("but_yes2")),new iB(m.KB("items").CB("but_yes2")),new iB(m.KB("items").CB("but_yes2")));this.oB.x=eG;this.oB.y=VB.TD-this.oB.height-dG;this.oB.addEventListener(p.qC,this.NK);this.v(this.oB);this.hC=new xD(new iB(m.KB("items").CB("but_no")),new iB(m.KB("items").CB("but_no2")),new iB(m.KB("items").CB("but_no2")),new iB(m.KB("items").CB("but_no2")));this.hC.x=VB.jD-this.hC.width-eG;this.hC.y=VB.TD-this.oB.height-dG;this.hC.addEventListener(p.qC,this.CH);this.v(this.hC);this.ZC=new cC();this.ZC.addEventListener(p.qC,this.oB.u);this.ZC.xC=0x000000;this.ZC.UC=new zF(GC,48,0,zB:true,align:mB.TG);this.ZC.height=60;this.ZC.x=this.oB.x+this.oB.width;this.ZC.y=this.oB.y+5;this.v(this.ZC);this.ZC.text=g.eB("GENyes");this.OC=new cC();this.OC.addEventListener(p.qC,this.hC.u);this.OC.xC=0x000000;this.OC.UC=new zF(GC,48,0,zB:true,align:mB.AE);this.OC.height=60;this.OC.x=this.hC.x-this.OC.width;this.OC.y=this.oB.y+5;this.v(this.OC);this.OC.text=g.eB("GENno");}NF(){CH(null);} NK( g){dD();this.u(new JB(JB.uB,this));} CH( g){dD();this.u(new JB(JB.kD,this));}}class n extends AB{static const  SD="GameEvent.TYPE_LIVES_CHANGED";static const  lD="GameEvent.TYPE_PROGRESS_CHANGED";static const  mD="GameEvent.TYPE_PAUSE_CHANGED";static const  nD="GameEvent.TYPE_LEVEL_CHANGED";static const  oD="GameEvent.TYPE_SCORE_CHANGED";static const  pD="GameEvent.TYPE_GAME_START";static const  qD="GameEvent.TYPE_GAME_OVER";static const  rD="GameEvent.TYPE_GAME_ABORT";static const  fE="GameEvent.TYPE_GAME_SIZE_CHANGED";var s;n( h, g,[ bubbles=false]):super(h,bubbles){this.s=g;}}class aE extends AD{var vK;aE( g){this.s=g;}set s( g){if(vK!=null){vK.removeEventListener(n.qD,this.QE);vK.removeEventListener(n.rD,this.PE);vK.removeEventListener(n.fE,this.YF);vK.removeEventListener(n.pD,this.RE);vK.removeEventListener(n.nD,this.hD);vK.removeEventListener(n.mD,this.DH);vK.removeEventListener(n.oD,this.cF);vK.removeEventListener(n.SD,this.ZF);vK.removeEventListener(n.lD,this.bF);}vK=g;if(vK!=null){vK.addEventListener(n.qD,this.QE);vK.addEventListener(n.rD,this.PE);vK.addEventListener(n.fE,this.YF);vK.addEventListener(n.pD,this.RE);vK.addEventListener(n.nD,this.hD);vK.addEventListener(n.mD,this.DH);vK.addEventListener(n.oD,this.cF);vK.addEventListener(n.SD,this.ZF);vK.addEventListener(n.lD,this.bF);}} get s{return vK;} QE( g){} PE( g){} YF( g){} RE( g){} hD( g){} DH( g){} cF( g){} ZF( g){} bF( g){}}class sB extends tB{static const  sF=1.0;static const  bH=100;static const  cH=0xFFFFFF;var GK=sF;var JJ=5;var ID;var tG=false;var JH=500;var bgColor=0xffffff;var pB;var IB;var KD;var GL=true;var NE=false;var nG=60.0;var eD;var GC=tD;var RF=false;var qJ="Web";sB( h, g):super(h,g){this.addEventListener(AB.MG,this.ZJ);}set OD( g){GL=g;this.u(new n(n.SD,this));} get OD{return GL;} ZJ( g){this.RJ();} gJ( g){NE=false;} fJ( g){NE=true;} RJ(){if(!tG){this.addEventListener(p.XD,this.gJ);this.addEventListener(p.eC,this.fJ);this.sJ();this.addEventListener(n.pD,this.RE);this.addEventListener(n.SD,this.eJ);this.addEventListener(n.lD,this.iJ);this.addEventListener(n.oD,this.jJ);this.addEventListener(n.nD,this.cJ);this.addEventListener(n.mD,this.hJ);this.addEventListener(n.qD,this.QE);this.addEventListener(n.rD,this.PE);this.tC();this.progress=0;this.MD=0;this.LD=3;this.start();tG=true;}} eB( i,[ params=null]){var h=m.NJ(i);if(params!=null)for(int g=0;g<params.length;g++ )h=h.replaceAll("{${g}}",params[g].toString());return h;} sJ(){this.GK=sF;this.bgColor=cH;this.JH=bH;this.JJ=5;this.nG=60000;} tC(){this.ID=new yC(this);this.v(this.ID);var h=m.KB("items").CB("button_exit");var g=m.KB("items").CB("button_exit_2");this.pB=new xD(new iB(h),new iB(g),new iB(h),new iB(g));this.pB.width=75;this.pB.height=66;this.pB.x=707;this.pB.y=525;this.pB.addEventListener(p.eC,aJ);this.v(this.pB);this.pB.visible=false;this.KD=new XH(this,GC);this.KD.x=0;this.KD.y=0;this.v(this.KD);} xI(){var g=this.GD();g.text=this.eB("MESSAGE_RESTART_LEVEL");g.addEventListener(JB.uB,this.EH);} tI( h){var g=this.GD();g.text=this.eB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.addEventListener(JB.uB,this.EH);} EH( g){this.wC(g.ME);this.ID.rI();} jG(){this.ID.PF();var g=this.GD();if(this.level==0){g.text=this.eB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.eB("MESSAGE_START_LEVEL",[(this.level+1)]);}g.addEventListener(JB.uB,this.lJ);} lJ( g){this.wC(g.ME);this.XJ();} uI(){var g=this.GD();g.text=this.eB("MESSAGE_GAME_OVER");g.addEventListener(JB.uB,this.bJ);} bJ( g){this.wC(g.ME);} GD([ menu=null, tweenDuration=1.0, autoStart=true]){if(this.IB!=null)this.wC(this.IB);this.pB.visible=false;this.KD.visible=true;if(menu==null)this.IB=new VB(this,autoStart,GC);else this.IB=menu;this.IB.width=VB.jD;this.IB.height=VB.TD;this.IB.x=(this.JE/2)-(VB.jD/2)+30;this.IB.y=(this.mG/2)-(VB.TD/2);this.IB.alpha=0;this.v(this.IB);var g=new eI(this.IB,tweenDuration,zE.AF);g.FE("alpha",1);aB.add(g);return this.IB;} wC( g){this.paused=false;this.KD.visible=true;this.pB.visible=true;if(g==null)return;g.dD();if(this.contains(g)){this.qB(g);}this.IB=null;} LJ(){aB.remove(eD);if(this.RF)this.dF(null);this.NE=true;this.OD=false;} kJ(){if(this.IB!=null)return;if(qJ.toLowerCase()=="web")return;aB.remove(eD);this.eD=new hE(this.LJ,this.nG);aB.add(this.eD);this.RF=true;this.paused=true;var g=this.GD(null,200,false);this.pB.visible=true;g.text=this.eB("MESSAGE_FIRST_LEVEL");g.addEventListener(JB.uB,this.dF);} dF( g){aB.remove(this.eD);this.RF=false;IB.removeEventListener(JB.uB,this.dF);this.wC(IB);} aJ( h){if(this.IB is WH)return;var g=new WH(this,GC);this.GD(g);this.paused=true;g.addEventListener(JB.uB,this.WF);g.addEventListener(JB.kD,this.VF);} WF( g){this.u(new n(n.rD,this));IB.removeEventListener(JB.uB,this.WF);IB.removeEventListener(JB.kD,this.VF);this.wC(IB);this.paused=true;} VF( g){IB.removeEventListener(JB.uB,this.WF);IB.removeEventListener(JB.kD,this.VF);this.wC(IB);} RE( g){this.ID.PF();aB.HE(this.jG,0.5);} DJ(){this.ID.PF();} iJ( g){} eJ( g){} jJ( g){} cJ( g){} hJ( g){} QE( g){aB.HE(this.uI,2.0);} PE( g){}}class yC extends aE{static var qF=0.025;static var cE=1.0;static var zC=600;static var dE=800;static var eE=600;static var tF=400;static var uF=300;static var UD=ZB.sqrt(dE*dE+eE*eE);static var fH=(UD*2/zC);static var vF=6;var OB;var QB;var IC;var VC;var hF=30.0*ZB.PI/180;var gF=1.0*ZB.PI/180;var PD=0.05;var eF=-1;var SE=1;var LB;var gC;var FF=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var GF;var HF;var gG;var sI;var QH;var fF=15;var vG;var HD=false;var GE=0;var OF;var EE;var CF=0.90;var KH=0;var HL;var UK;var XB;var IJ=0;var FC;var FD=false;var TF,UF;var qG;yC( g):super(g){HL=new wF.nK(80,60,690,524);this.mask=HL;this.GF=m.QF("speedalizer");this.HF=this.GF.play(true);this.XB=new BG();this.v(this.XB);qG=new tH(800,600);v(qG);TF=UF=0;EC.addEventListener(p.vE,this.aF);EC.addEventListener(p.eC,this.aF);EC.addEventListener(p.XD,this.aF);} aF( g){TF=g.MH;UF=g.NH;} rJ(){var g=this.s.MD;this.s.MD=g+(this.s as sB).JH*(this.s.level*this.s.LD);} YF( g){} hD( g){super.hD(g);this.HK();} HK(){FD=false;this.removeEventListener(AB.rC,this.OE);this.GE=0;this.s.progress=0;this.HD=false;var h=60;this.VC=new ZH(UD,vF*h);for(var g=this.VC.w.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.VC.HH(g);this.OB=new QC(tF,uF);this.QB=new aC(0,0,0);this.IC=new aC(0,0,cE);this.gF=(1+(0.1*this.s.level))*ZB.PI/180;this.PD=0.015+(0.004*this.s.level);this.SE=2+this.s.level;this.eF=-this.SE;this.KH=this.s.level*2;this.fF=15+(this.s.level);this.tC();this.vI();this.addEventListener(AB.rC,this.OE);} tC(){if(this.LB!=null)this.qB(this.LB);this.LB=new VH();this.v(this.LB);if(this.FC!=null)this.qB(this.FC);this.FC=new iB(m.KB("items").CB("crosshair"));this.FC.WC=0.5;this.FC.XC=0.5;this.FC.x=(dE/2)-this.FC.width/2;this.FC.y=(eE/2)-this.FC.height/2;this.v(this.FC);} PF(){this.FD=false;this.removeEventListener(AB.rC,this.OE);var h=60;this.VC=new ZH(UD,vF*h);for(var g=this.VC.w.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.VC.HH(g);this.OB=new QC(tF,uF);this.QB=new aC(0,0,0);this.IC=new aC(0,0,cE);this.gF=2*ZB.PI/180;this.SE=0;this.eF=0;if(this.LB!=null){this.qB(this.LB);this.LB=null;}this.LB=new VH();this.v(this.LB);if(this.gC!=null){this.qB(this.gC);this.gC=null;}this.iG();this.addEventListener(AB.rC,this.OE);} iG(){var g=new PC(null);g.TC=-1;g.CC=0;g.position=this.QB.clone();g.position.z=0.5;this.LB.DD(g);} hG(){var g=new PC(new iB(m.KB("items").CB("countdown01")));g.TC=0;g.CC=0;g.position=this.QB.clone();g.position.z=0.5;g.cD=0;g.fD=true;this.LB.DD(g);g=new PC(new iB(m.KB("items").CB("countdown02")));g.TC=0;g.CC=0;g.position=this.QB.clone();g.position.z=0;g.cD=1;g.fD=true;this.LB.DD(g);g=new PC(new iB(m.KB("items").CB("countdown03")));g.TC=0;g.CC=0;g.position=this.QB.clone();g.position.z=-0.5;g.cD=2;g.fD=true;this.LB.DD(g);g=new PC(new iB(m.KB("items").CB("countdown04")));g.TC=0;g.CC=0;g.position=this.QB.clone();g.position.z=-1;g.cD=3;g.fD=true;this.LB.DD(g);} wI(){var h=1+this.s.level;if(h>=this.FF.length)h=this.FF.length-1;var i=RD.rF(0,h);var j=this.FF[i];var g=new PC(new iB(m.CB(j)));g.kC=true;g.NC=RD.rF(0,359)*ZB.PI/180;g.CC=RD.eH(this.eF,this.SE)*ZB.PI/180;g.position=this.QB.clone();return g;} vI(){this.hG();this.iG();var h=0;for(var i=0;i<fF;i++ ){var g=null;if(i==fF-1){g=new PC(new iB(m.CB("finish")));g.NC=0;g.CC=5*ZB.PI/180;g.position=this.QB.clone();g.TC=0;g.kC=true;g.sG=true;this.OF=g;}else{h++ ;if(this.s.level==1&&h<=3){if(h==1){g=new PC(new iB(m.CB("training01")));g.kC=true;g.NC=0;g.CC=0;g.position=this.QB.clone();g.ND=1;}else if(h==2){g=new PC(new iB(m.CB("training02")));g.kC=true;g.NC=135*ZB.PI/180;g.CC=0;g.position=this.QB.clone();g.ND=2;}else if(h==3){g=new PC(new iB(m.CB("training02")));g.kC=true;g.NC=315*ZB.PI/180;g.CC=0;g.position=this.QB.clone();g.ND=3;}}else{g=this.wI();}}g.iD=-i*1-3;g.position.z=g.iD;g.TC=0;this.LB.DD(g);}} dJ(){this.HD=false;var g=s as sB;g.DJ();g.jG();} OE( h){if(this.s.paused==false){this.uJ();var g=this.s as sB;if(g.OD&&this.FD&&!g.NE)g.kJ();}else{gD=-1;}} KE( h){var g=new EB(this.OB.x,this.OB.y);g=this.wG(g);g=h.jC(g);return h.KE(g);} rI(){this.FD=false;for(var g=0;g<this.LB.JC.length;g++ )this.LB.JC[g].position.z-= (2.5+1-CF)+1;EE.position.z+= (1-CF);this.hG();this.HD=false;this.PD=this.vG;this.gC.visible=false;} YJ(){var g=this.s as sB;g.pB.visible=false;this.HD=false;this.FD=false;this.vG=this.PD;this.PD=0;if(this.gC!=null)this.qB(this.gC);this.gC=new iB(m.CB("broken"));this.v(this.gC);if(this.EE.ND>0&& ++this.IJ<=5){aB.HE((){g.tI(this.EE.ND);},2.0);}else{this.s.LD-- ;if(this.s.LD>0)aB.HE(g.xI,2.0);}this.HF.stop();this.HF=this.GF.play(true);this.gG=m.QF("crash");this.sI=this.gG.play();}var gD=-1; uJ(){var k=aB.elapsedTime;var h=1.0;if(gD==-1)gD=k;h=ZB.min(k-gD,1.0000)*40;gD=k;if(HD){this.GE-= (this.PD*h);var t=this.s.MD;this.s.MD=t+(this.KH*h);}this.LB.FK();this.hF+= (this.gF*h);this.IC.x=-(this.TF-this.OB.x)*3;this.IC.y=-(this.UF-this.OB.y)*3;if(this.IC.pG()>UD*0.7){this.IC.CK(UD*0.7);}this.IC.z=cE;this.QB=this.IC.clone();this.QB.z=qF;this.tJ();for(var o=0;o<this.LB.JC.length;o++ ){var g=this.LB.JC[o];g.position.z+= (PD*h);if(g.position.z>=1){if(g.fD&&g.cD==3)FD=true;if(g.aD!=null){this.QH=m.QF("swish");var BB=this.QH.play();}if(g.kC)HD=true;if(g.iD!=0)this.GE=g.iD;if(g.kC&&KE(g)){g.position.z=CF;EE=g;this.YJ();}else{if(g.ND==3)(this.s as sB).OD=false;if(g.kC)this.rJ();if(g.sG){this.dJ();}else if(g.TC==0){this.LB.xJ(g);}else{g.position.z+= g.TC;}}}var i=this.IC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.ZE(i);j=j.add(this.OB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.NC+= (g.CC*h);g.setScale(QD(g.position.z)*fH);}}if(this.OF!=null)this.s.progress=(this.GE+3)/(this.OF.iD+3);} ZE( g){var h=new QC(g.x,g.y);h.x*= QD(g.z);h.y*= QD(g.z);return h;} QD( g){var h=qF;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} tJ(){if(XB==null)return;var l=2;var j=this.IC.clone();j.scale(l);var h=this.VC.transform(QD(j.z)*l,this.hF,this.ZE(j));var i=this.VC.transform(QD(this.QB.z),this.hF,this.ZE(this.QB));var k=this.ZE(this.QB).add(this.OB);XB.PB.clear();XB.PB.beginPath();XB.PB.fG(k.x,k.y,this.VC.GH*QD(this.QB.z));XB.PB.closePath();XB.PB.OH(0xffcccccc,1);XB.PB.beginPath();for(var g=0;g<h.w.length;g+= 2){XB.PB.moveTo(h.w[g].x+this.OB.x,h.w[g].y+this.OB.y);XB.PB.lineTo(h.w[g+1].x+this.OB.x,h.w[g+1].y+this.OB.y);XB.PB.lineTo(i.w[g+1].x+this.OB.x,i.w[g+1].y+this.OB.y);XB.PB.lineTo(i.w[g].x+this.OB.x,i.w[g].y+this.OB.y);XB.PB.lineTo(h.w[g].x+this.OB.x,h.w[g].y+this.OB.y);}XB.PB.closePath();XB.PB.CJ(0xFF000000);}}class PC extends AD{var uK;var xK;var zK;var position;var TC=-1;var CC=0;var EK=1;var kC=false;var sG=false;var fD=false;var eK=false;var cD=0;var ND=0;var iD=0;PC( g){zK=new AD();v(zK);this.aD=g;if(this.aD==null)return;this.x=100000;}set aD( g){if(uK!=null)this.qB(uK);if(xK!=null)this.qB(xK);uK=null;xK=null;if(g!=null){uK=g;uK.uC=yC.zC/2;uK.vC=yC.zC/2;v(uK);}else{xK=new BG();v(xK);}v(zK);} get aD{return uK;} setScale( g){this.EK=g;if(xK!=null){xK.PB.clear();xK.PB.beginPath();xK.PB.fG(0,0,yC.zC/2*g);xK.PB.closePath();xK.PB.OH(0xff999999,1);}if(uK!=null)uK.WC=uK.XC=g;zK.WC=zK.XC=g;} KE( j){if(uK==null)return false;var g=this.wG(j);g=uK.jC(g);var k=this.aD.nB.MJ(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new iB(m.KB("items").CB("blood"));h.uC=50;h.vC=50;h.x=g.x-yC.zC/2;h.y=g.y-yC.zC/2;zK.v(h);}return i;}}class VH extends AD{var JC;VH(){JC=new List<PC>();} FK(){this.JC.sort(OK);} DD( g){if(this.contains(g))return;this.v(g);this.JC.add(g);} xJ( g){if(this.JC.length>0){var h=this.JC.indexOf(g);if(h>=0)this.JC.removeAt(h);}if(this.contains(g))this.qB(g);} OK( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.JD(g)<this.JD(h))this.PH(g,h);return 1;}if(g.position.z<h.position.z){if(this.JD(g)>this.JD(h))this.PH(g,h);return -1;}return 0;}}class RD{static var pF=new ZB.Random();static  rF( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=RD.pF.nextInt(h+1)+g;}return i;}static  eH( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=RD.pF.nextDouble()*(h-g)+g;}return i;}}class ZH extends bE{var sK;var wK;ZH( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.sK=h;this.wK=g;yI();} get GH{return sK;} yI(){var g=new List<QC>();var h=0.0;var k=2*ZB.PI/wK;for(var j=0;j<wK;j++ ){var i=new QC(0,-sK);i.EF=h;g.add(i);h+= k;}this.w=g;}}class bE implements aH,YH{var w;bE([ pointList]){this.w=(pointList!=null)?pointList:new List();}HH( g){if(g<w.length)this.w.removeAt(g);} KE( h){var k=this.w.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(w[g].y<h.y&&w[i].y>=h.y||w[i].y<h.y&&w[g].y>=h.y){if(w[g].x+(h.y-w[g].y)/(w[i].y-w[g].y)*(w[i].x-w[g].x)<h.x){j=!j;}}i=g;}return j;} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.w.length;var i=new List<QC>(j);for(var g=0;g<j;g++ ){var k=this.w[g].clone();k.scale(h);i[g]=k;}return new bE(i);} transform( l, k, o){var j=this.w.length;var i=new List<QC>(j);for(var g=0;g<j;g++ ){var h=this.w[g].clone();h.scale(l);h.EF+= k;i[g]=h.add(o);}return new bE(i);}}abstract class YH{}abstract class aH{}class tB extends AD{var tK=0;var yK=0;var AL=true;var BL=3;var CL=0.0;var DL;var EL;tB( h, g){DK(h,g);} DK( g, h){DL=g;EL=h;this.u(new n(n.fE,this));} get JE{return DL;} get mG{return EL;} start(){this.paused=false;this.u(new n(n.pD,this));} KJ(){this.u(new n(n.qD,this));}set progress( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;CL=g;this.u(new n(n.lD,this));} get progress{return CL;}set LD( g){if(g<0)g=0;BL=g;this.u(new n(n.SD,this));if(BL==0)this.KJ();} get LD{return BL;}set MD( g){if(g<0)g=0;tK=g;this.u(new n(n.oD,this));} get MD{return tK;} get BK{return tK.toDouble().round().toInt();}set level( g){if(g<0)g=0;yK=g;this.u(new n(n.nD,this));} get level{return yK;} XJ(){this.level+= 1;return this.level;}set paused( g){AL=g;this.u(new n(n.mD,this));} get paused{return AL;}}var EC;var m;var gE;var aB;var gH;var bC;var sD;var vB;const  tD="Russo One"; main(){EC=new ZD("Stage",mC.query('#stage'));gE=new lH();gE.nI(EC);aB=gE.TJ;gH=new ZB.Random();var g=WB.cG("images/Loading.png");g.then((h){bC=new iB(h);bC.uC=20;bC.vC=20;bC.x=400;bC.y=270;EC.v(bC);sD=new eI(bC,100,zE.AF);sD.FE("rotation",100.0*2.0*ZB.PI);aB.add(sD);vB=new cC();vB.UC=new zF("Arial",20,0xA0A0A0,zB:true);vB.width=240;vB.height=40;vB.text="... loading ...";vB.x=400-vB.KK/2;vB.y=320;vB.AH=false;EC.v(vB);hH();});} hH(){m=new pE();m.yB("barrier01","images/barrier01.png");m.yB("barrier02","images/barrier02.png");m.yB("barrier03","images/barrier03.png");m.yB("barrier04","images/barrier04.png");m.yB("barrier05","images/barrier05.png");m.yB("barrier06","images/barrier06.png");m.yB("barrier07","images/barrier07.png");m.yB("training01","images/training01.png");m.yB("training02","images/training02.png");m.yB("finish","images/finish.png");m.yB("broken","images/broken.png");m.oI("items","images/ItemTextureAtlas.json",nE.LG);m.DF("crash","sounds/crash.mp3");m.DF("swish","sounds/swish.mp3");m.DF("speedalizer","sounds/speedalizer.mp3");m.TB("DISPLAY_LEVEL","Level: {0}");m.TB("DISPLAY_LIVES","Ships:");m.TB("DISPLAY_SCORE","Score: {0}");m.TB("DISPLAY_TRAINING","Training");m.TB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");m.TB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");m.TB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");m.TB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");m.TB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");m.TB("MESSAGE_GAME_OVER","Game\nOver!");m.TB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");m.TB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");m.TB("GENscore","Score");m.TB("GENlevel","Level");m.TB("GENexitquery","Do you really want to quit the game?");m.TB("GENyes","Yes");m.TB("GENno","No");m.load().then((h){EC.qB(bC);EC.qB(vB);aB.remove(sD);var g=new sB(800,600);g.pI(EC);g.start();});}class BD extends AB{static const  sE="keyDown";static const  NG="keyUp";var yM;var zM;var BN;var DN;var LN;var NN;var QN;var RN;BD( g,[ bubbles=false]):super(g,bubbles){XN(g,bubbles);} XN( g,[ bubbles=false]){super.XN(g,bubbles);yM=false;zM=false;BN=false;DN=false;LN=false;NN=0;QN=0;RN=0;} get altKey=>yM; get ctrlKey=>zM; get shiftKey=>BN; get charCode=>NN; get keyCode=>QN; get keyLocation=>RN;}class EG{var KI;EG( g){KI=g;} operator[]( g){return KI.nM(g);}}class mH{var IE;var YE;mH(this.IE,this.YE);}class VD{static const  qE="auto";static const  DI="stop";static const  PG="once";}class lH{var ML;var cL;var kL;var IM;var TM;lH(){ML=new mE();cL=new List<ZD>();kL=double.NAN;IM=wD.rE;TM=new pH(0);mC.window.requestAnimationFrame(JN);} get TJ=>ML; JN( g){mC.window.requestAnimationFrame(JN);if(kL.isNaN)kL=g;if(kL>g)kL=g;var j=g-kL;var i=j/1000.0;if(j>=1){kL=g;TM.VL=i;IM.u(TM);ML.ED(i);for(int h=0;h<cL.length;h++ ){var k=cL[h];k.VJ();}}} nI( g){cL.add(g);}}class pH extends AB{var VL;pH( g):super(AB.rC,false){VL=g;} get IF=>false;}class wD{static final rE=new wD();var lM;wD(){lM=new List<NB>();} add( g){lM.add(g);} remove( h){var g=lM.indexOf(h);if(g!=-1)lM[g]=null;} u( j){var k=lM.length;var h=0;for(int g=0;g<k;g++ ){var i=lM[g];if(i!=null){j.CO=i.lG;j.DO=i.lG;j.xN=nC.zD;i.u(j);if(h!=g)lM[h]=i;h++ ;}}for(int g=k;g<lM.length;g++ )lM[h++ ]=lM[g];lM.length=h;}}class CD{static const  vH=0;static const  TG=1;static const  AE=2;static const  MI=3;static const  SG=4;}class p extends AB{static const  qC="click";static const  HI="doubleClick";static const  eC="mouseDown";static const  XD="mouseUp";static const  vE="mouseMove";static const  BE="mouseOut";static const  WG="mouseOver";static const  WI="mouseWheel";static const  YG="middleClick";static const  ZI="middleMouseDown";static const  cI="middleMouseUp";static const  ZG="rightClick";static const  dI="rightMouseDown";static const  gI="rightMouseUp";var gN,hN;var jN,kN;var MO;var yM;var LN;var zM;var BN;var QO;var RO;var SO;p( g,[ bubbles=false]):super(g,bubbles){XN(g,bubbles);} XN( g,[ bubbles=false]){super.XN(g,bubbles);gN=hN=0;jN=kN=0;MO=false;yM=false;LN=false;zM=false;BN=false;QO=0;RO=0;SO=0;}set TO( g){gN=g.x;hN=g.y;}set UO( g){jN=g.x;kN=g.y;} get MH=>jN; get NH=>kN; get SC=>MO; get altKey=>yM; get ctrlKey=>zM; get shiftKey=>BN; get bD=>QO;}class wB extends AB{static const  KG="touchBegin";static const  OG="touchEnd";static const  QG="touchCancel";static const  VG="touchMove";static const  TI="touchOver";static const  UI="touchOut";var cN;var dN;var gN,hN;var jN,kN;var yM;var LN;var zM;var BN;var pN;var sN;var tN;wB( g,[ bubbles=false]):super(g,bubbles){XN(g,bubbles);} XN( g,[ bubbles=false]){super.XN(g,bubbles);cN=0;dN=false;gN=hN=0;jN=kN=0;yM=false;LN=false;zM=false;BN=false;pN=1.00;sN=0;tN=0;}set TO( g){gN=g.x;hN=g.y;}set UO( g){jN=g.x;kN=g.y;} get XE=>cN; get MH=>jN; get NH=>kN; get altKey=>yM; get ctrlKey=>zM; get shiftKey=>BN;}class AG extends AB{static const  FI="textInput";var ZL="";AG( g,[ bubbles=false]):super(g,bubbles){}}class xF{static const  GI="none";static const  LI="touchPoint";}class iH{iH();}class GG{var OL;var iL;var vL;var BM;var JM;var PM;var VM;var ZM;var cM;var iM;var pM;GG( g, h){OL=g;iL=h;} get LK=>iL; get name=>OL; get GJ=>vL; get HJ=>BM; get FJ=>JM; get EJ=>PM; get offsetX=>VM; get offsetY=>ZM; get nJ=>cM; get mJ=>iM; get AK=>pM;}abstract class q extends RB implements lE{var yL=0.0;var FM=0.0;var NM=0.0;var SM=0.0;var YM=1.0;var dM=1.0;var jM=0.0;var qM;var rM;var vM=1.0;var wM=true;var OL="";var GN=null;var mask;var WN;var YN;q(){qM=new GB.pK();rM=true;WN=new GB.pK();YN=new GB.pK();} get x=>yL; get y=>FM; get uC=>NM; get vC=>SM; get WC=>YM; get XC=>dM; get NC=>jM; get alpha=>vM; get visible=>wM; get name=>OL; get parent=>GN;DG get on=>new DG(this); get root{var g=this;while (g.GN!=null)g=g.GN;return g;} get WE{var g=this.root;if(g is ZD)return g;return null;} set x( g){yL=g;rM=true;} set y( g){FM=g;rM=true;} set uC( g){NM=g;rM=true;} set vC( g){SM=g;rM=true;} set WC( g){YM=g;rM=true;} set XC( g){dM=g;rM=true;} set NC( g){jM=g;rM=true;} set alpha( g){vM=g;rM=true;} set visible( g){wM=g;rM=true;} get width=>jB(AO).width; get height=>jB(AO).height; set width( h){this.WC=1;var g=this.width;this.WC=(g!=0.0)?h/g:1.0;} set height( h){this.XC=1;var g=this.height;this.XC=(g!=0.0)?h/g:1.0;} pI( g){g.v(this);} wJ(){if(GN!=null)GN.qB(this);} get AO{if(rM){rM=false;if(jM==0.0){qM.LH(YM,0.0,0.0,dM,yL-NM*YM,FM-SM*dM);}else{var g=ZB.cos(jM);var h=ZB.sin(jM);var i=YM*g;var l=YM*h;var k=-dM*h;var j=dM*g;var o=yL-NM*i-SM*k;var t=FM-NM*l-SM*j;qM.LH(i,l,k,j,o,t);}}return qM;} jB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.mK();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} HC( g, h){if(jB(YN).contains(g,h))return this;return null;} wG( h){WN.rG();for(q g=this;g!=null;g=g.GN)WN.concat(g.AO);return WN.TH(h);} jC( h){WN.rG();for(q g=this;g!=null;g=g.GN)WN.concat(g.AO);WN.SJ();return WN.TH(h);} u( h){var g=null;if(h.IF||h.bubbles)for(q j=GN;j!=null;j=j.GN)if(j.OJ(h.type)){if(g==null)g=new List<q>();g.add(j);}if(h.IF&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.jF==false)g[i].fN(h,this,g[i],nC.JG);if(h.jF==false)fN(h,this,this,nC.zD);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.jF==false)g[i].fN(h,this,g[i],nC.II);} WO( h){for(var g=h;g!=null;g=g.GN)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");GN=h;} UB( g);}abstract class cB extends q{var AJ=false;var AH=true;var lK=true;var tabIndex=0;CG get on=>new CG(this);}abstract class oC extends cB{var AM;var GM=true;var RM=true;oC(){AM=new List<q>();}nH get on=>new nH(this); v( g){if(g.parent==this){var h=AM.indexOf(g);AM.removeAt(h);AM.add(g);}else{mI(g,AM.length);}} mI( g, h){if(h<0&&h>AM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){AM.removeAt(AM.indexOf(g));if(h>AM.length)h-- ;AM.insertRange(h,1,g);}else{g.wJ();g.WO(this);AM.insertRange(h,1,g);g.u(new AB(AB.zH,true));if(this.WE!=null)XO(g,new AB(AB.MG));}} qB( h){var g=AM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");vJ(g);} vJ( g){if(g<0&&g>=AM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=AM[g];h.u(new AB(AB.QI,true));if(this.WE!=null)XO(h,new AB(AB.SI));h.WO(null);AM.removeAt(g);} oG( g){if(g<0&&g>=AM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return AM[g];} JD( g){return AM.indexOf(g);} PH( j, i){var h=JD(j);var g=JD(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");JK(h,g);} JK( h, g){var j=oG(h);var i=oG(g);AM[h]=i;AM[g]=j;} contains( g){for(;g!=null;g=g.GN)if(g==this)return true;return false;} jB( o,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.mK();if(AM.length==0)return super.jB(o,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var l=double.NEGATIVE_INFINITY;var k=double.NEGATIVE_INFINITY;var t=AM.length;for(int j=0;j<t;j++ ){WN.MF(AM[j].AO,o);var g=AM[j].jB(WN,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>l)l=g.right;if(g.bottom>k)k=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=l-h;returnRectangle.height=k-i;return returnRectangle;} HC( BB, DB){var l=null;for(int j=AM.length-1;j>=0;j-- ){var i=AM[j];if(i.visible){var g=i.AO;var o=BB-g.fB;var k=DB-g.gB;var FB=(g.d*o-g.c*k)/g.iC;var t=(g.a*k-g.b*o)/g.iC;var h=i.HC(FB,t);if(h!=null){if(h is cB)if(h.AH)return GM?h:this;l=this;}}}return l;} UB( i){for(int g=0;g<AM.length;g++ ){var h=AM[g];if(h.visible)i.IH(h);}} XO( g, j){g.u(j);if(g is oC){var i=new List<q>.from(g.AM);var k=i.length;for(int h=0;h<k;h++ )XO(i[h],j);}}}class HG{var target=null;var SC=false;var JF=0;var bD=0;var zG,BH;var xG,yG;HG(this.zG,this.BH,this.xG,this.yG);}class xB{var PL;var tL;xB(){PL=new mC.ImageElement();tL=new List<GG>();}static  VI( t, YB){var o=new Completer<xB>();var i=new xB();switch (YB){case nE.yH:case nE.LG:var k=new mC.HttpRequest();k.open('GET',t,true);k.on.load.add((kB){ BB( l, g){var FB=kI(l);var h=new GG(FB,i);h.vL=g["frame"]["x"].toInt();h.BM=g["frame"]["y"].toInt();h.JM=g["frame"]["w"].toInt();h.PM=g["frame"]["h"].toInt();h.VM=g["spriteSourceSize"]["x"].toInt();h.ZM=g["spriteSourceSize"]["y"].toInt();h.cM=g["sourceSize"]["w"].toInt();h.iM=g["sourceSize"]["h"].toInt();h.pM=g["rotated"] as bool;i.tL.add(h);}var DB=QK.JSON.parse(k.responseText);var j=DB["frames"];var MB=DB["meta"];if(j is List)for(var g in j)BB(g["filename"],g);if(j is Map)for(String l in j.keys)BB(l,j[l]);i.PL.on.load.add((bB)=>o.complete(i));i.PL.on.error.add((bB)=>o.completeException("Failed to load image."));i.PL.src=lI(t,MB["image"]);});k.on.error.add((kB)=>o.completeException("Failed to load json file."));k.send();break;}return o.future;} get PJ=>PL; CB( i){var h;for(int g=0;g<tL.length&&h==null;g++ )if(tL[g].name==i)h=new WB.rK(tL[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;}static  kI( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,ignoreCase:true);var i=h.firstMatch(g);return i.group(1);}static  lI( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,ignoreCase:true);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";}}class pE{var UL;var pL;var KM;var WM;var bM;var hM;var mM;pE(){UL=new Map<String,WB>();pL=new Map<String,SB>();KM=new Map<String,xB>();WM=new Map<String,String>();bM=null;hM=0;mM=0;} yB( h, i){var g=WB.cG(i);hM++ ;g.then(( j){UL[h]=j;hM-- ;zN();});g.handleException((k){mM++ ;hM-- ;zN();});} DF( h, i){var g=SB.xH(i);hM++ ;g.then(( j){pL[h]=j;hM-- ;zN();});g.handleException((k){mM++ ;hM-- ;zN();});} oI( i, k, h){var g=xB.VI(k,h);hM++ ;g.then(( j){KM[i]=j;hM-- ;zN();});g.handleException((l){mM++ ;hM-- ;zN();});} TB( h, g){WM[h]=g;} load(){bM=new Completer<pE>();zN();return bM.future;} CB( g){if(UL.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return UL[g];} QF( g){if(pL.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return pL[g];} KB( g){if(KM.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return KM[g];} NJ( g){if(WM.containsKey(g)==false)return "[[${g}]]";return WM[g];}zN(){if(bM!=null&&hM==0){if(mM==0)bM.complete(this);else bM.completeException(this);}}}class AD extends oC{var XK=false;var mF=false;}class iB extends q{var nB;var pJ;var KF;iB([this.nB=null,this.pJ="auto"]){KF=null;} jB( h,[ returnRectangle]){var g=(nB!=null)?nB.width:0;var i=(nB!=null)?nB.height:0;return BF(h,g,i,returnRectangle);} HC( g, h){if(nB!=null&&g>=0.0&&h>=0.0&&g<nB.width&&h<nB.height)return this;return null;} UB( g){if(nB!=null){if(KF==null)nB.UB(g);else nB.yJ(g,KF);}}}class uH{static const  AI="round";}abstract class lE{ UB( g);}class hE implements dC{var YL=0.0;var qL=0.0;var CM=1;var OM;hE( g, h){OM=g;qL=ZB.max(h,0.0001);} ED( h){var g=YL+h;while (g>=qL&&CM>0){YL=qL;CM-- ;OM();g-= qL;}if(CM==0)return false;YL=g;return true;} get currentTime=>YL;}class BG extends q{var XL;BG(){XL=new FG();} get PB=>XL; jB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.mK();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} HC( g, h){return null;} UB( g){XL.UB(g);}}class HB{var x;var y;var width;var height;HB(this.x,this.y,this.width,this.height);HB.mK():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new EB(this.width,this.height); set size( g){this.width=g.x;this.height=g.y;} clone()=>new HB(this.x,this.y,this.width,this.height); contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); LF( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;}}class xD extends cB{var lF;var FH;var kG;var LE;var mF=true;var enabled=true;var oM;xD([this.lF,this.FH,this.kG,this.LE]){addEventListener(p.WG,CN);addEventListener(p.BE,CN);addEventListener(p.eC,CN);addEventListener(p.XD,CN);oM=this.lF;} jB( g,[ returnRectangle]){if(oM!=null){WN.MF(oM.AO,g);return oM.jB(WN,returnRectangle);}return super.jB(g,returnRectangle);} HC( k, l){if(this.LE!=null){var g=this.LE.AO;var h=k-g.fB;var i=l-g.gB;var o=(g.d*h-g.c*i)/g.iC;var j=(g.a*i-g.b*h)/g.iC;if(this.LE.HC(o,j)!=null)return this;}return null;} UB( g){if(oM!=null)g.IH(oM);} CN( g){if(g.type==p.BE){oM=lF;}else{oM=g.SC?kG:FH;}}}class FG{var TL;FG(){TL=new List<oH>();}clear()=>TL.clear();beginPath()=>TL.add(new oH("beginPath"));closePath()=>TL.add(new oH("closePath"));moveTo( h, g)=>TL.add(new oH("moveTo",[h,g]));lineTo( h, g)=>TL.add(new oH("lineTo",[h,g]));arcTo( k, i, g, h, j)=>TL.add(new oH("arcTo",[k,i,g,h,j]));quadraticCurveTo( j, i, g, h)=>TL.add(new oH("quadraticCurveTo",[j,i,g,h]));bezierCurveTo( g, h, l, j, i, k)=>TL.add(new oH("bezierCurveTo",[g,h,l,j,i,k]));arc( i, j, h, k, g, l)=>TL.add(new oH("arc",[i,j,h,k,g,l]));rect( i, g, h, j)=>TL.add(new oH("rect",[i,g,h,j]));OH( g,[ width=1, joints=jH.AI, caps=uH.AI])=>TL.add(new oH("strokeColor",[yE(g),width,joints,caps]));CJ( g)=>TL.add(new oH("fillColor",[yE(g)]));fG( i, g, h){TL.add(new oH("moveTo",[i+h,g]));TL.add(new oH("arc",[i,g,h,0,ZB.PI*2,false]));} UB( k){var h=k.context;h.save();for(var j in TL){var g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].gO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].hO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];GB i=g[0].iO;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].cK(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].dK(h);GB i=g[0].iO;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}class EB{var x;var y;EB(this.x,this.y);EB.mK():this(0,0);static  aI( g, h)=>new EB(g*ZB.cos(h),-g*ZB.sin(h)); get length=>ZB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new EB(this.x+g.x,this.y+g.y); clone()=>new EB(this.x,this.y); LF( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class mE implements dC{var gL;var uL;var EM;mE(){EM=0.0;gL=new List<dC>();uL=0;} get elapsedTime=>EM; add( g){if(g==null)return;if(uL>=gL.length)gL.add(g);else gL[uL]=g;uL++ ;} remove( h){if(h==null)return;for(int g=0;g<uL;g++ )if(gL[g]==h)gL[g]=null;} HE( h, i){var g=new hE(h,i);add(g);return g;} ED( j){EM+= j;var k=uL;var h=0;for(int g=0;g<k;g++ ){var i=gL[g];if(i!=null&&i.ED(j)){if(h!=g)gL[h]=i;h++ ;}}for(int g=k;g<uL;g++ )gL[h++ ]=gL[g];for(int g=h;g<uL;g++ )gL[g]=null;uL=h;return true;}}class oH{var name;var arguments;oH(this.name,[this.arguments]);}abstract class dC{ ED( g);}class GB{var JL,KL,LL,NL,QL,SL;var dL;GB( g, j, i, h, k, l):JL=g,KL=j,LL=i,NL=h,QL=k,SL=l,dL=g*h-j*i;GB.pK():JL=1.0,KL=0.0,LL=0.0,NL=1.0,QL=0.0,SL=0.0,dL=1.0; clone(){return new GB(JL,KL,LL,NL,QL,SL);} get a=>JL; get b=>KL; get c=>LL; get d=>NL; get fB=>QL; get gB=>SL; get iC=>dL; TH( g){return new EB(g.x*JL+g.y*LL+QL,g.x*KL+g.y*NL+SL);} concat( g){var o=JL;var DB=KL;var FB=LL;var BB=NL;var l=QL;var t=SL;var YB=dL;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var bB=g.fB;var MB=g.gB;var kB=g.iC;JL=(o*j+DB*i);KL=(o*k+DB*h);LL=(FB*j+BB*i);NL=(FB*k+BB*h);QL=(l*j+t*i+bB);SL=(l*k+t*h+MB);dL=(YB*kB);} rG(){JL=1.0;KL=0.0;LL=0.0;NL=1.0;QL=0.0;SL=0.0;dL=1.0;} SJ(){var j=JL;var o=KL;var l=LL;var k=NL;var h=QL;var i=SL;var g=dL;JL=(k/g);KL=-(o/g);LL=-(l/g);NL=(j/g);QL=-(JL*h+LL*i);SL=-(KL*h+NL*i);dL=(1.0/g);} LH( g, j, i, h, k, l){JL=g;KL=j;LL=i;NL=h;QL=k;SL=l;dL=(g*h-j*i);} LF( g){JL=g.a;KL=g.b;LL=g.c;NL=g.d;QL=g.fB;SL=g.gB;dL=g.iC;} MF( h, g){var t=h.a;var FB=h.b;var MB=h.c;var DB=h.d;var o=h.fB;var BB=h.gB;var bB=h.iC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var kB=g.fB;var YB=g.gB;var lC=g.iC;JL=(t*k+FB*j);KL=(t*l+FB*i);LL=(MB*k+DB*j);NL=(MB*l+DB*i);QL=(o*k+BB*j+kB);SL=(o*l+BB*i+YB);dL=(bB*lC);}}class wF{var IL;var RL;var jL;var wL;wF.nK( i, g, h, j){IL=0;RL=new HB(i,g,h,j);} UB( i){var g=i.context;g.beginPath();switch (IL){case 0:g.rect(RL.x,RL.y,RL.width,RL.height);break;case 1:g.arc(jL.x,jL.y,jL.GH,0,ZB.PI*2.0,false);break;case 2:g.moveTo(wL[0].x,wL[0].y);for(int h=1;h<wL.length;h++ )g.lineTo(wL[h].x,wL[h].y);break;}g.clip();}}class DG extends EG{DG( g):super(g);}class nH extends CG{nH( g):super(g);}class CG extends DG{CG( g):super(g); get mouseOut=>this[p.BE]; get mouseMove=>this[p.vE]; get mouseDown=>this[p.eC]; get mouseUp=>this[p.XD]; get mouseWheel=>this[p.WI]; get touchMove=>this[wB.VG]; get touchEnd=>this[wB.OG]; get touchCancel=>this[wB.QG]; get keyUp=>this[BD.NG]; get keyDown=>this[BD.sE];}class qH{var name;var DC;var RH;qH(this.name,this.DC,this.RH);}class AB{static const  zH="added";static const  MG="addedToStage";static const  rC="enterFrame";static const  QI="removed";static const  SI="removedFromStage";var IL;var uN;var xN;var CO;var DO;var FO;var HO;AB( g,[ bubbles=false]){XN(g,bubbles);} XN( g,[ bubbles=false]){IL=g;uN=bubbles;xN=nC.zD;CO=null;DO=null;FO=false;HO=false;} get jF=>FO; get IK=>HO; get type=>IL; get eventPhase=>xN; get bubbles=>uN; get IF=>true; get target=>CO;}class hB{var WL;var oL;var DM;var MM;hB.oK( j,[ matrix]){WL=j;oL=new List<GB>(100);DM=new List<double>(100);for(int h=0;h<100;h++ ){oL[h]=new GB.pK();DM[h]=1.0;}MM=0;if(matrix!=null)oL[0].LF(matrix);var g=oL[0];var i=DM[0];WL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);WL.globalAlpha=i;} get context=>WL; reset(){MM=0;var g=oL[0];var h=DM[0];WL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);WL.globalAlpha=h;WL.clearRect(0,0,WL.canvas.width,WL.canvas.height);} IH( h){var i=MM;var j=MM+1;var l=oL[i];var g=oL[j];var o=DM[i];var k=DM[j]=h.vM*o;g.MF(h.AO,l);WL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);WL.globalAlpha=k;MM=j;if(h.mask==null){h.UB(this);}else{WL.save();h.mask.UB(this);h.UB(this);WL.restore();}MM=i;}}class nE{static const  yH="json";static const  LG="jsonarray";}class jH{static const  AI="round";}class RB{var hL; OJ( g){return hL!=null&&hL.containsKey(g);} addEventListener( g, h,[ useCapture=false]){nM(g).add(h,useCapture);} removeEventListener( g, h,[ useCapture=false]){nM(g).remove(h,useCapture);} u( g){fN(g,this,this,nC.zD);}EG get on=>new EG(this); fN( g, i, k, j){if(hL!=null){var h=hL[g.type];if(h!=null){g.CO=i;g.DO=k;g.xN=j;g.FO=false;g.HO=false;h.u(g);}}} nM( h){if(hL==null)hL=new Map<String,NB>();var g=hL[h];if(g==null)g=hL[h]=new NB(this,h);return g;}}class nC{static const  JG=1;static const  zD=2;static const  II=3;}abstract class SB{static  xH( g){var h=uD.hI;if(h=="WebAudioApi")return iE.xH(g);if(h=="AudioElement")return kE.xH(g);return yF.xH(g);} get length; play([ loop=false, soundTransform]);static var fC;static  aG( g){if(fC==null){fC=new List<String>();var i=new mC.AudioElement();var h=["maybe","probably"];if(h.indexOf(i.canPlayType("audio/ogg",""))!=-1)fC.add("ogg");if(h.indexOf(i.canPlayType("audio/mp3",""))!=-1)fC.add("mp3");if(h.indexOf(i.canPlayType("audio/wav",""))!=-1)fC.add("wav");}var k=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,ignoreCase:true);var j=k.firstMatch(g);if(j==null)throw new ArgumentError("Unsupported file extension.");var l=j.group(1).toLowerCase();if(fC.indexOf(l)==-1&&fC.length>0)g="${g.substring(0,g.length-3)}${fC[0]}";return g;}}abstract class RC extends RB{ set VE( g); stop();}class dB{var volume;var oJ;var gK=1;var hK=0;var kK=1;var jK=0;dB([this.volume=1,this.oJ=0]);}class uD{static var CE;static  get DE{if(CE==null){try {CE=new UH.AudioContext();}catch (g){CE=null;}}return CE;}static var YD;static  get hI{if(YD==null){YD=(DE!=null)?"WebAudioApi":"AudioElement";var g=mC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))YD="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))YD="Mock";}return YD;}}class kE extends SB{var eL;var xL;var QM;kE(){QM=new List<vD>();eL=new mC.AudioElement();eL.on.ended.add(tM);xL=new List<mC.AudioElement>();xL.add(eL);mC.document.body.children.add(eL);}static  xH( l){var g=new kE();var j=new Completer<SB>();var i;var h;i=(k){g.eL.on.canPlayThrough.remove(i);g.eL.on.error.remove(h);j.complete(g);};h=(k){g.eL.on.canPlayThrough.remove(i);g.eL.on.error.remove(h);j.completeException("Failed to load audio.");};g.eL.src=SB.aG(l);g.eL.on.canPlayThrough.add(i);g.eL.on.error.add(h);g.eL.load();return j.future;} get length{return eL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new vD(this,loop,soundTransform);} HN( h){var g;if(xL.length==0){g=eL.clone(true);g.on.ended.add(tM);}else{g=xL.removeAt(0);}QM.add(h);return g;} NO( g){var h=g.eL;var i=QM.indexOf(g);QM.removeAt(i);xL.add(h);if(eL.currentTime>0&&eL.ended==false)eL.currentTime=0;} tM(j){var i=j.target;var g=null;for(int h=0;h<QM.length&&g==null;h++ )if(QM[h].eL==i)g=QM[h];if(g!=null)g.stop();}}class vD extends RC{var rL;var eL;var aL;var sL;vD( g, i, h){rL=g;aL=i;sL=h;eL=g.HN(this);eL.loop=aL;this.VE=h;eL.play();} set VE( g){sL=g;if(eL!=null)eL.volume=(sL!=null)?sL.volume:1;} stop(){if(eL!=null){if(eL.ended==false)eL.pause();rL.NO(this);eL=null;}}}class iE extends SB{var bL;iE(){if(uD.DE==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  xH( t){var i=new iE();var g=new Completer<SB>();var h=new mC.HttpRequest(); l( k){i.bL=k;if(g.future.isComplete==false)g.complete(i);} DB(MB){if(g.future.isComplete==false)g.completeException("Failed to decode audio.");} FB(BB){var o=uD.DE;o.decodeAudioData(h.response,l,DB);} j(BB){if(g.future.isComplete==false)g.completeException("Failed to load audio.");}h.open('GET',SB.aG(t),true);h.responseType='arraybuffer';h.on.load.add(FB);h.on.error.add(j);h.send();return g.future;} get length{return bL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new SK(this,loop,soundTransform);}}class SK extends RC{var nL;var sL;var aL;var XM;var eM;SK( j, h, i){nL=j;aL=h;sL=i;var g=uD.DE;XM=g.createGain();XM.connect(g.destination,0,0);XM.gain.value=(sL!=null)?ZB.pow(sL.volume,2):1;eM=g.createBufferSource();eM.buffer=nL.bL;eM.loop=h;eM.connect(XM,0,0);eM.start(0);} set VE( g){sL=g;XM.gain.value=(sL!=null)?ZB.pow(sL.volume,2):1;} stop(){eM.stop(0);}}class yF extends SB{yF(){}static  xH( i){var h=new yF();var g=new Completer<SB>();mC.window.setTimeout(()=>g.complete(h),1);return g.future;} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new RK(this,loop,soundTransform);}}class RK extends RC{var aL;var sL;RK( i, h, g){aL=h;sL=g;} set VE( g){sL=g;} stop(){}}class kH{static const  CI="pixel";}class cC extends cB{var ZL="";var mL=0x000000;var HM=null;var UM=sH.GI;var fM=kH.CI;var IL=rH.wH;var sM=false;var uM=false;var xM=0x000000;var AN=false;var EN=0x000000;var IN=0;var MN=0;var PN;var SN;var TN=true;var UN=100;var VN=100;var ZN=null;var WL=null;cC(){HM=new zF("Arial",12,0x000000);PN=new List<String>();SN=new List<jE>();} get type=>IL; get width=>UN; get height=>VN; set text( g){ZL=g;TN=true;} set xC( g){mL=g;TN=true;} set UC( g){HM=g;mL=HM.color;TN=true;} set wordWrap( g){sM=g;TN=true;} set width( g){UN=g;TN=true;} set height( g){VN=g;TN=true;} get KK{aO();return IN;} jB( g,[ returnRectangle]){return BF(g,UN,VN,returnRectangle);} HC( g, h){if(g>=0&&h>=0&&g<UN&&h<VN)return this;return null;} UB( g){aO();g.WL.drawImage(ZN,0.0,0.0);} eO(){PN.clear();SN.clear();if(sM==false){PN.add(ZL);}else{var g=new StringBuffer();var i;var h;for(String t in ZL.replaceAll('\r','').split('\n')){for(String j in t.split(' ')){i=g.length;g.add((i>0)?" ${j}":j);h=g.toString();if(WL.measureText(h).width>UN){if(i>0)h=h.substring(0,i);else j="";PN.add(h);g.clear();g.add(j);}}if(g.isEmpty==false){PN.add(g.toString());g.clear();}}}IN=0;MN=0;for(String h in PN){var l=WL.measureText(h);var o=0;if(HM.align==mB.yD||HM.align==mB.JI)o=(UN-l.width)/2;if(HM.align==mB.AE||HM.align==mB.EI)o=UN-l.width;var k=new jE(o,l.width,HM.size,0,0,0);SN.add(k);IN=ZB.max(IN,k.width);MN=MN+k.height;}} aO(){if(TN){TN=false;var i=UN.ceil().toInt();var j=VN.ceil().toInt();if(ZN==null){ZN=new mC.CanvasElement(width:i,height:j);WL=ZN.context2d;}if(ZN.width!=i)ZN.width=i;if(ZN.height!=j)ZN.height=j;var g=new StringBuffer();g.add(HM.uG?"italic ":"normal ");g.add("normal ");g.add(HM.zB?"bold ":"normal ");g.add("${HM.size}px ");g.add("${HM.font},sans-serif");WL.font=g.toString();WL.textAlign="start";WL.textBaseline="top";WL.fillStyle=WD(mL);eO();if(uM){WL.fillStyle=WD(xM);WL.fillRect(0,0,UN,VN);}else{WL.clearRect(0,0,UN,VN);}var k=0;for(int h=0;h<PN.length;h++ ){var l=SN[h];WL.fillStyle=WD(mL);WL.fillText(PN[h],l.x,k);k+= l.height;}if(AN){WL.strokeStyle=WD(EN);WL.lineWidth=1;WL.strokeRect(0,0,UN,VN);}}}}class sH{static const  GI="none";}class rH{static const  wH="dynamic";}class zF{var font;var size;var color;var zB;var uG;var MK;var align;var UJ;var zJ;var QJ;var SF;var letterSpacing=0;var VK=0;var WK=false;var fK=false;zF(this.font,this.size,this.color,{this.zB: false,this.uG: false,this.MK: false,this.align: "left",this.UJ: 0,this.zJ: 0,this.QJ: 0,this.SF: 0});}class mB{static const  yD="center";static const  EI="end";static const  JI="justify";static const  TG="left";static const  AE="right";}class jE{var qI;var zI;var height;var SF;var width;var x;jE(this.x,this.width,this.height,this.qI,this.zI,this.SF);}class lB{static const  qE="auto";static const  tE="arrow";static const  uE="button";static const  NI="hand";static const  OI="ibeam";static const  RI="wait";}class oE{static var IG=lB.qE;static var BI=false;static var KI=new RB();static  bG( i){var h=i;var g="auto";if(IG!=lB.qE)h=IG;switch (h){case lB.qE:g="auto";break;case lB.tE:g="default";break;case lB.uE:g="pointer";break;case lB.NI:g="move";break;case lB.OI:g="text";break;case lB.RI:g="wait";break;}if(BI)g="none";return g;}}class tH extends cB{var width;var height;tH(this.width,this.height); jB( g,[ returnRectangle]){return BF(g,width,height,returnRectangle);} HC( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} UB( g){}}class WB implements lE{var fL;var lL;var zL;var LM;var WL;var aM;var gM;var kM;var vL;var BM;var JM;var PM;WB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){fL=g;lL=h;zL=transparent;var i=new mC.CanvasElement(width:fL,height:lL);WL=i.context2d;WL.fillStyle=zL?yE(fillColor):WD(fillColor);WL.fillRect(0,0,g,h);LM=i;aM=0;}WB.qK( g){fL=g.naturalWidth;lL=g.naturalHeight;zL=true;LM=g;aM=0;}WB.rK( g){fL=g.nJ;lL=g.mJ;zL=true;LM=g.LK.PJ;aM=g.AK?2:1;gM=g.offsetX.toDouble();kM=g.offsetY.toDouble();vL=g.GJ.toDouble();BM=g.HJ.toDouble();JM=g.FJ.toDouble();PM=g.EJ.toDouble();}static  cG( i){var h=new Completer<WB>();var g=new mC.ImageElement();g.on.load.add((j)=>h.complete(new WB.qK(g)));g.on.error.add((j)=>h.completeException("Failed to load image."));g.src=i;return h.future;} get width=>fL; get height=>lL; clone(){var g=new WB(fL,lL,true,0);g.BJ(this);return g;} BJ( h,[ matrix=null]){var g=fO();var i=new hB.oK(g,matrix);h.UB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} MJ( i, h){var g=fO().getImageData(i,h,1,1).data;if(jI){return (g[0]<<16)+(g[1]<<8)+(g[2]<<0)+(g[3]<<24);}else{return (g[3]<<16)+(g[2]<<8)+(g[1]<<0)+(g[0]<<24);}} UB( g){switch (aM){case 0:g.context.drawImage(LM,0.0,0.0);break;case 1:g.context.drawImage(LM,vL,BM,JM,PM,gM,kM,JM,PM);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,gM,kM+PM);g.context.drawImage(LM,vL,BM,PM,JM,0.0,0.0,PM,JM);break;}} yJ( bB, g){if(g.width<=0.0||g.height<=0.0)return;switch (aM){case 0:bB.context.drawImage(LM,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=vL;double h=BM;double DB=j+JM;double FB=h+PM;double l=vL-gM+g.x;double o=BM-kM+g.y;double YB=l+g.width;double MB=o+g.height;double BB=(j>l)?j:l;double t=(h>o)?h:o;double kB=(DB<YB)?DB:YB;double nF=(FB<MB)?FB:MB;double oF=gM-j+BB;double lC=kM-h+t;double k=kB-BB;double i=nF-t;if(k>0.0&&i>0.0){bB.context.drawImage(LM,BB,t,k,i,oF,lC,k,i);}break;case 2:double j=vL;double h=BM;double DB=j+PM;double FB=h+JM;double l=vL+kM-g.y+PM-g.height;double o=BM-gM+g.x;double YB=l+g.height;double MB=o+g.width;double BB=(j>l)?j:l;double t=(h>o)?h:o;double kB=(DB<YB)?DB:YB;double nF=(FB<MB)?FB:MB;double oF=gM-h+t;double lC=kM+DB-kB;double k=nF-t;double i=kB-BB;if(k>0.0&&i>0.0){bB.context.transform(0.0,-1.0,1.0,0.0,oF,lC+i);bB.context.drawImage(LM,BB,t,i,k,0.0,0.0,i,k);}break;}} fO(){if(WL==null){var g=new mC.CanvasElement(width:fL,height:lL);WL=g.context2d;switch (aM){case 0:WL.drawImage(LM,0,0);break;case 1:WL.drawImage(LM,vL,BM,JM,PM,gM,kM,JM,PM);break;case 2:WL.setTransform(0.0,-1.0,1.0,0.0,gM,kM+PM);WL.drawImage(LM,vL,BM,PM,JM,0.0,0.0,PM,JM);WL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}LM=g;aM=0;}return WL;}}typedef  pC(event); WD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class RG{static var UG=false;static var wE=false;static var xE=0;static var YI=xF.GI;static var KI=new RB();static bI(){if(UG==false){UG=true;var g=mC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){wE=true;xE=10;}if(g.contains("Android")){wE=true;xE=10;}if(g.contains("IEMobile")){wE=true;xE=10;}}}static  get iI{bI();return YI;}}class NB{var KI;var KN;var ON;NB( h, g){KI=h;KN=g;ON=new List<mH>();} get lG=>KI; add( h,[ useCapture=false]){for(int g=0;g<ON.length;g++ )if(ON[g].IE==h&&ON[g].YE==useCapture)return;if(KN==AB.rC&&ON.length==0)wD.rE.add(this);ON.add(new mH(h,useCapture));} remove( h,[ useCapture=false]){for(int g=0;g<ON.length;g++ ){if(ON[g].IE==h&&ON[g].YE==useCapture){ON=new List<mH>.from(ON);ON.removeAt(g);if(KN==AB.rC&&ON.length==0)wD.rE.remove(this);break;}}} operator+( g){this.add(g,false);} operator-( g){this.remove(g,false);} u( h){for(int g=0;g<ON.length;g++ )if(h.eventPhase!=nC.JG||ON[g].YE)if(h.IK==false)ON[g].IE(h);}}class XG{static var XI=0;var XE=XI++ ;var target=null;var TE=false;XG(this.target,this.TE);} yE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class zE{static  AF( g){return g;}}class eI implements dC{var aN;var bN;var eN;var iN;var lN;var mN;var qL;var YL;var oN;var rN;var vN;eI( g, h,[ transitionType( ratio)]){aN=g;bN=(transitionType!=null)?transitionType:zE.AF;YL=0.0;qL=ZB.max(0.0001,h);oN=0.0;rN=false;vN=false;eN=new List<qH>();} FE( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(aN!=null&&vN==false)eN.add(new qH(g,0.0,h));} moveTo( h, g){FE('x',h);FE('y',g);} ED( l){if(YL<qL||vN==false){YL=YL+l;if(YL>qL)YL=qL;if(YL>=0.0){if(vN==false){vN=true;for(int i=0;i<eN.length;i++ ){var g=eN[i];switch (g.name){case 'x':g.DC=aN.x;break;case 'y':g.DC=aN.y;break;case 'pivotX':g.DC=aN.uC;break;case 'pivotY':g.DC=aN.vC;break;case 'scaleX':g.DC=aN.WC;break;case 'scaleY':g.DC=aN.XC;break;case 'rotation':g.DC=aN.NC;break;case 'alpha':g.DC=aN.alpha;break;}}if(iN!=null)iN();}var j=YL/qL;var k=bN(j);for(int i=0;i<eN.length;i++ ){var g=eN[i];var h=g.DC+k*(g.RH-g.DC);h=rN?h.round():h;switch (g.name){case 'x':aN.x=h;break;case 'y':aN.y=h;break;case 'pivotX':aN.uC=h;break;case 'pivotY':aN.vC=h;break;case 'scaleX':aN.WC=h;break;case 'scaleY':aN.XC=h;break;case 'rotation':aN.NC=h;break;case 'alpha':aN.alpha=h;break;}}if(lN!=null)lN();if(mN!=null&&YL==qL)mN();}}return YL<qL;} get currentTime=>YL; get isComplete=>YL>=qL;} fI(){var g=new mC.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;}class ZD extends oC{var ZN;var WL;var nN;var qN;var wN;var yN;var BO;var EO;var GO;var IO;var JO;var KO;var LO;var OO;var PO;ZD( h, g){OL=h;ZN=g;ZN.focus();WL=g.context2d;qN=new hB.oK(WL);wN=VD.qE;yN=lB.tE;oE.KI.addEventListener("mouseCursorChanged",VO);GO=[new HG(p.eC,p.XD,p.qC,p.HI),new HG(p.ZI,p.cI,p.YG,p.YG),new HG(p.dI,p.gI,p.ZG,p.ZG)];EO=null;BO=new EB(0,0);JO=new p(p.qC,true);OO=CN;ZN.on..mouseDown.add(OO)..mouseUp.add(OO)..mouseMove.add(OO)..mouseOut.add(OO)..mouseWheel.add(OO);IO=new Map<int,XG>();LO=new wB(wB.KG,true);PO=YO;RG.KI.addEventListener("inputModeChanged",ZO);ZO(null);KO=new BD(BD.sE,true);ZN.on.keyDown.add(bO);ZN.on.keyUp.add(bO);ZN.on.keyPress.add(cO);} get focus=>nN; dO(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){dO();} set y( g){dO();} set uC( g){dO();} set vC( g){dO();} set WC( g){dO();} set XC( g){dO();} set NC( g){dO();} set alpha( g){dO();} set width( g){dO();} set height( g){dO();} VJ(){if(wN==VD.qE||wN==VD.PG){qN.reset();UB(qN);if(wN==VD.PG)wN=VD.DI;}} VO( g){ZN.style.cursor=oE.bG(yN);} CN( j){j.preventDefault();var MB=ZN.getBoundingClientRect();var t=new Date.now().millisecondsSinceEpoch;var DB=j.button;var h=null;var i=new EB(j.clientX-MB.left,j.clientY-MB.top);var o=null;if(DB<0||DB>2)return;if(j.type=="mousemove"&&BO.equals(i))return;var g=GO[DB];BO=i;if(j.type!="mouseout")h=HC(i.x,i.y) as cB;var k=lB.tE;if(h is AD)if(h.mF)k=lB.uE;if(h is xD)if(h.mF)k=lB.uE;if(yN!=k){yN=k;ZN.style.cursor=oE.bG(k);}if(EO!=null&&EO!=h){EO.u(JO..XN(p.BE,true)..TO=(EO.WE!=null)?EO.jC(i):new EB.mK()..UO=i..MO=g.SC);EO=null;}if(h!=null&&h!=EO){h.u(JO..XN(p.WG,true)..TO=h.jC(i)..UO=i..MO=g.SC);EO=h;}var l=null;var BB=false;var FB=false;if(j.type=="mousedown"){l=g.zG;if(h!=g.target||t>g.JF+500)g.bD=0;g.SC=true;g.target=h;g.JF=t;g.bD++ ;}if(j.type=="mouseup"){l=g.BH;g.SC=false;BB=(g.target==h);FB=BB&&g.bD.isEven&&(t<g.JF+500);}if(j.type=="mousemove"){l=p.vE;}if(l!=null&&h!=null){o=h.jC(i);h.u(JO..XN(l,true)..TO=o..UO=i..MO=g.SC..QO=g.bD);if(BB){if(FB&&h.AJ){h.u(JO..XN(g.yG,true)..TO=o..UO=i..MO=g.SC);}else{h.u(JO..XN(g.xG,true)..TO=o..UO=i..MO=g.SC);}}}} ZO( g){ZN.on..touchStart.remove(PO)..touchEnd.remove(PO)..touchMove.remove(PO)..touchEnter.remove(PO)..touchLeave.remove(PO)..touchCancel.remove(PO);if(RG.iI==xF.LI){ZN.on..touchStart.add(PO)..touchEnd.add(PO)..touchMove.add(PO)..touchEnter.add(PO)..touchLeave.add(PO)..touchCancel.add(PO);}} YO( j){j.preventDefault();var t=ZN.getBoundingClientRect();for(var o in j.changedTouches){var l=o.identifier;var h=null;var i=new EB(o.clientX-t.left,o.clientY-t.top);var BB=null;h=HC(i.x,i.y) as cB;var g=IO.containsKey(l)?IO[l]:new XG(h,IO.length==0);if(g.target!=null&&g.target!=h){g.target.u(LO..XN(wB.UI,true)..TO=(g.target.WE!=null)?g.target.jC(i):new EB.mK()..UO=i..cN=g.XE..dN=g.TE);g.target=null;}if(h!=null&&h!=g.target){h.u(LO..XN(wB.TI,true)..TO=h.jC(i)..UO=i..cN=g.XE..dN=g.TE);g.target=h;}var k=null;if(j.type=="touchstart"){IO[l]=g;k=wB.KG;}if(j.type=="touchend"){IO.remove(l);k=wB.OG;}if(j.type=="touchcancel"){IO.remove(l);k=wB.QG;}if(j.type=="touchmove"){k=wB.VG;}if(k!=null&&h!=null){h.u(LO..XN(k,true)..TO=h.jC(i)..UO=i..cN=g.XE..dN=g.TE);}}} bO( g){g.preventDefault();var h=null;if(g.type=="keyup")h=BD.NG;if(g.type=="keydown")h=BD.sE;KO..XN(h,true)..yM=g.altKey..zM=g.ctrlKey..BN=g.shiftKey..NN=g.charCode..QN=g.keyCode..RN=CD.vH;if(g.keyLocation==mC.KeyLocation.LEFT)KO.RN=CD.TG;if(g.keyLocation==mC.KeyLocation.RIGHT)KO.RN=CD.AE;if(g.keyLocation==mC.KeyLocation.NUMPAD)KO.RN=CD.MI;if(g.keyLocation==mC.KeyLocation.JOYSTICK)KO.RN=CD.SG;if(g.keyLocation==mC.KeyLocation.MOBILE)KO.RN=CD.SG;if(nN!=null)nN.u(KO);} cO( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new AG(AG.FI,true);h.ZL=new String.fromCharCodes([i]);if(nN!=null)nN.u(h);}} BF( g, o, FB, j){var lC=0.0;var kB=0.0;var DB=o*g.a;var bB=o*g.b;var MB=o*g.a+FB*g.c;var BB=o*g.b+FB*g.d;var YB=FB*g.c;var t=FB*g.d;var h=lC;if(h>DB)h=DB;if(h>MB)h=MB;if(h>YB)h=YB;var i=kB;if(i>bB)i=bB;if(i>BB)i=BB;if(i>t)i=t;var l=lC;if(l<DB)l=DB;if(l<MB)l=MB;if(l<YB)l=YB;var k=kB;if(k<bB)k=bB;if(k<BB)k=BB;if(k<t)k=t;if(j==null)j=new HB.mK();j.x=g.fB+h;j.y=g.gB+i;j.width=l-h;j.height=k-i;return j;}var jI=fI();
//@ sourceMappingURL=supersonic.dart.map