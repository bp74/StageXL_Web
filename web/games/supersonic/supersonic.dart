import "dart:web_audio" as VG;import "dart:async" as dB;import "dart:math" as VB;import "dart:json" as cL;import "dart:html" as OB;class dL{static const  eL="Chrome";static const  fL="Firefox";static const  gL="Internet Explorer";static const  hL="Safari";final  IK;final  minimumVersion;const dL(this.IK,[this.minimumVersion]);}class iL{final  name;const iL(this.name);}class yB{var x;var y;yB(this.x,this.y);set length( g){this.normalize();this.iK(g);} get length{return VB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new yB(x,y);} add( g){if(g==null)return null;return new yB(x+g.x,y+g.y);} subtract( g){if(g==null)return null;return new yB(x-g.x,y-g.y);}iK( g){x*= g;y*= g;} get pE{var g=VB.PI-VB.atan2(this.x,this.y);if(g<0)g+= 2*VB.PI;return g;}set pE( i){var h=this.length;var g=FB.fJ(h,i-VB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class iC{var x;var y;var z;iC(this.x,this.y,this.z);reset( h, i, g){x=h;y=i;z=g;} clone(){return new iC(x,y,z);} aH(){return VB.sqrt(x*x+y*y+z*z);}PL( g){this.normalize();this.scale(g);} add( g){return new iC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=aH();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} tF( g){return (g.x==x&&g.y==y&&g.z==z);}}class YB extends JF implements mC{static var SE=588;static var pD=314;static var QI=10.0;var FD;var wB;var jM;var LG;var NC;YB( g,[ autoStart=true, fontName=cE]):super(g){this.NC=fontName;this.width=YB.SE;this.height=YB.pD;this.FD=new nB(n.MB("items").IB("menu_bg"));this.DB(this.FD);this.wB=new lC();this.wB.ND=0x000000;this.wB.wordWrap=true;this.wB.MC=new UF(fontName,30,0x000000,bold:true,align:qB.iE);this.wB.width=476;this.wB.height=250;this.wB.x=60;this.wB.y=90;this.DB(this.wB);this.u(s.oC,this.onClick);if(autoStart){this.GI=0;this.LG=0;eB.add(this);}else{this.GI=1;}this.alpha=0;} ED( g){this.LG+= g;if(this.LG>QI){GE();sF();return false;}return true;}set text( g){if(g==null)return;var h=new UF(NC,30,0x000000,bold:true,align:qB.iE);if(g.length<=30)h.size=45;else h.size=30;this.wB.MC=h;this.wB.text=g;} onClick( g){GE();sF();} sF(){this.dispatchEvent(new LB(LB.AC,this));}set GI( g){if(g<0)g=1;if(g>1)g=1;jM=g;var h=(255*jM).round().toInt();} GE(){eB.remove(this);}}class LB extends GB{static const  AC="MenuEvent.TYPE_OK";static const  TE="MenuEvent.TYPE_CANCEL";var xE;LB( h, g,[ bubbles=false]):super(h,bubbles){this.xE=g;}}class HI extends JF{var FD;var gC;var FC;var EC;var TC;var RC;var SC;var font;var RG=30;var EF;HI( h,[ fontName=cE]):super(h){this.font=fontName;this.GD();var g=new StringBuffer();g.write((this.v as xB).mB("GENlevel"));g.write(": 0");EC.text=g.toString();} GD(){this.FD=new nB(n.MB("items").IB("topbar"));this.FD.x=0;this.FD.y=0;this.DB(this.FD);this.gC=new lC();this.gC.MC=new UF(font,24,0,bold:true,align:qB.uG);this.gC.ND=0x000000;this.gC.width=400;this.gC.height=100;this.gC.x=20;this.gC.y=RG;this.DB(gC);this.FC=new lC();this.FC.MC=new UF(font,24,0,bold:true,align:qB.kE);this.FC.ND=0x000000;this.FC.width=200;this.FC.height=100;this.FC.x=(this.v.vE/2)-this.FC.width+60;this.FC.y=RG;this.DB(FC);this.EC=new lC();this.EC.MC=new UF(font,24,0,bold:true,align:qB.kE);this.EC.ND=0x000000;this.EC.width=200;this.EC.height=100;this.EC.x=(this.v.vE)-(this.EC.width)-20;this.EC.y=RG;this.DB(EC);this.TC=new lC();this.TC.MC=new UF(font,24,0,bold:true,align:qB.iE);this.TC.ND=0x000000;this.TC.width=200;this.TC.height=100;this.TC.x=20;this.TC.y=this.v.XH-this.TC.height-20;this.DB(TC);this.TC.visible=false;this.RC=new nB(n.MB("items").IB("progressbar"));this.RC.x=25;this.RC.y=82;this.DB(this.RC);this.SC=new nB(n.MB("items").IB("progressship"));this.SC.x=25;this.SC.y=this.RC.y+(this.RC.height-(this.RC.height-this.SC.height))-(this.SC.height);this.DB(this.SC);this.EF=new List<nB>();for(var h=0;h<3;h++ ){var g=new nB(n.MB("items").IB("spaceship"));g.y=10;g.x=(this.v.vE/2)+70+(h*35);this.DB(g);this.EF.add(g);}} rH( g){this.SC.x=25;this.SC.y=this.RC.y+(this.RC.height-((this.RC.height-this.SC.height)*g.v.OE))-(this.SC.height);} qH( i){var h=i.v as xB;if(h.jD){this.FC.text=h.mB("DISPLAY_TRAINING");}else{this.FC.text=h.mB("DISPLAY_LIVES");}for(var g=0;g<this.EF.length;g++ ){this.EF[g].visible=(!h.jD)&&(g<i.v.gD);}} tH( h){var i=h.v as xB;var g=new StringBuffer();g.write(i.mB("GENscore"));g.write(": ${h.v.OL.toString()}");gC.text=g.toString();} AF( h){var i=h.v as xB;var g=new StringBuffer();g.write(i.mB("GENlevel"));g.write(": ${h.v.level.toString()}");EC.text=g.toString();}}class II extends YB{var sB;var sC;var hC;var WC;var MH=40;var NH=30;var NC;II( g,[ fontName=cE]):super(g,true,fontName){this.NC=fontName;this.aB(s.DD);this.aB(s.oC);this.GD();} GD(){var g=this.v as xB;this.wB.wordWrap=true;this.text=g.mB("GENexitquery");this.sB=new tD(new nB(n.MB("items").IB("but_yes")),new nB(n.MB("items").IB("but_yes2")),new nB(n.MB("items").IB("but_yes2")),new nB(n.MB("items").IB("but_yes2")));this.sB.x=NH;this.sB.y=YB.pD-this.sB.height-MH;this.sB.u(s.DD,this.YL);this.DB(this.sB);this.sC=new tD(new nB(n.MB("items").IB("but_no")),new nB(n.MB("items").IB("but_no2")),new nB(n.MB("items").IB("but_no2")),new nB(n.MB("items").IB("but_no2")));this.sC.x=YB.SE-this.sC.width-NH;this.sC.y=YB.pD-this.sB.height-MH;this.sC.u(s.DD,this.oH);this.DB(this.sC);this.hC=new lC();this.hC.u(s.DD,this.sB.dispatchEvent);this.hC.ND=0x000000;this.hC.MC=new UF(NC,48,0,bold:true,align:qB.uG);this.hC.height=60;this.hC.x=this.sB.x+this.sB.width;this.hC.y=this.sB.y+5;this.DB(this.hC);this.hC.text=g.mB("GENyes");this.WC=new lC();this.WC.u(s.DD,this.sC.dispatchEvent);this.WC.ND=0x000000;this.WC.MC=new UF(NC,48,0,bold:true,align:qB.kE);this.WC.height=60;this.WC.x=this.sC.x-this.WC.width;this.WC.y=this.sB.y+5;this.DB(this.WC);this.WC.text=g.mB("GENno");}sF(){oH(null);} YL( g){GE();this.dispatchEvent(new LB(LB.AC,this));} oH( g){GE();this.dispatchEvent(new LB(LB.TE,this));}}class p extends GB{static const  oD="GameEvent.TYPE_LIVES_CHANGED";static const  UE="GameEvent.TYPE_PROGRESS_CHANGED";static const  VE="GameEvent.TYPE_PAUSE_CHANGED";static const  WE="GameEvent.TYPE_LEVEL_CHANGED";static const  XE="GameEvent.TYPE_SCORE_CHANGED";static const  YE="GameEvent.TYPE_GAME_START";static const  ZE="GameEvent.TYPE_GAME_OVER";static const  aE="GameEvent.TYPE_GAME_ABORT";static const  NF="GameEvent.TYPE_GAME_SIZE_CHANGED";var v;p( h, g,[ bubbles=false]):super(h,bubbles){this.v=g;}}class xB extends zB{static const  ZG=1.0;static const  NI=100;static const  OI=0xFFFFFF;var TL=ZG;var YK=5;var dD;var gH=false;var zH=500;var HK=0xffffff;var tB;var KB;var fD;var kM=true;var yE=false;var YH=60.0;var HE;var NC=cE;var yF=false;var BL="Web";xB( h, g):super(h,g){this.u(GB.nG,(i){this.fK();});}set jD( g){kM=g;this.dispatchEvent(new p(p.oD,this));} get jD{return kM;} fK(){if(!gH){this.u(s.yD,(g)=>this.yE=false);this.u(s.oC,(g)=>this.yE=true);this.EL();this.u(p.YE,this.DG);this.u(p.oD,this.rK);this.u(p.UE,this.uK);this.u(p.XE,this.vK);this.u(p.WE,this.onLevelChange);this.u(p.VE,this.sK);this.u(p.ZE,this.CG);this.u(p.aE,this.BG);this.GD();this.OE=0;this.hD=0;this.gD=3;this.start();gH=true;}} mB( i,[ params=null]){var h=n.dK(i);if(params!=null)for(int g=0;g<params.length;g++ )h=h.replaceAll("{${g}}",params[g].toString());return h;} EL(){this.TL=ZG;this.HK=OI;this.zH=NI;this.YK=5;this.YH=60000;} GD(){this.dD=new OD(this);this.DB(this.dD);var h=n.MB("items").IB("button_exit");var g=n.MB("items").IB("button_exit_2");this.tB=new tD(new nB(h),new nB(g),new nB(h),new nB(g));this.tB.width=75;this.tB.height=66;this.tB.x=707;this.tB.y=525;this.tB.u(s.oC,oK);this.DB(this.tB);this.tB.visible=false;this.fD=new HI(this,NC);this.fD.x=0;this.fD.y=0;this.DB(this.fD);} PK(){var g=this.bD();g.text=this.mB("MESSAGE_RESTART_LEVEL");g.u(LB.AC,this.sH);} LK( h){var g=this.bD();g.text=this.mB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.u(LB.AC,this.sH);} sH( g){this.LD(g.xE);this.dD.JK();} TH(){this.dD.vF();var g=this.bD();if(this.level==0){g.text=this.mB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.mB("MESSAGE_START_LEVEL",[(this.level+1)]);}g.u(LB.AC,this.xK);} xK( g){this.LD(g.xE);this.jK();} MK(){var g=this.bD();g.text=this.mB("MESSAGE_GAME_OVER");g.u(LB.AC,this.pK);} pK( g){this.LD(g.xE);} bD([ menu=null, tweenDuration=1.0, autoStart=true]){if(this.KB!=null)this.LD(this.KB);this.tB.visible=false;this.fD.visible=true;if(menu==null)this.KB=new YB(this,autoStart,NC);else this.KB=menu;this.KB.width=YB.SE;this.KB.height=YB.pD;this.KB.x=(this.vE/2)-(YB.SE/2)+30;this.KB.y=(this.XH/2)-(YB.pD/2);this.KB.alpha=0;this.DB(this.KB);var g=new nE(this.KB,tweenDuration,hF.iF);g.LH.alpha.OG(1);eB.add(g);return this.KB;} LD( g){this.paused=false;this.fD.visible=true;this.tB.visible=true;if(g==null)return;g.GE();if(this.contains(g)){this.uB(g);}this.KB=null;} aK(){eB.remove(HE);if(this.yF)this.uH(null);this.yE=true;this.jD=false;} wK(){if(this.KB!=null)return;if(BL.toLowerCase()=="web")return;eB.remove(HE);this.HE=new SF(this.aK,this.YH);eB.add(this.HE);this.yF=true;this.paused=true;var g=this.bD(null,200,false);this.tB.visible=true;g.text=this.mB("MESSAGE_FIRST_LEVEL");g.u(LB.AC,this.uH);} uH( g){eB.remove(this.HE);this.yF=false;this.KB.aB(LB.AC);this.LD(this.KB);} oK( h){if(this.KB is II)return;var g=new II(this,NC);this.bD(g);this.paused=true;g.u(LB.AC,this.lK);g.u(LB.TE,this.kK);} lK( g){this.dispatchEvent(new p(p.aE,this));this.KB.aB(LB.AC);this.KB.aB(LB.TE);this.LD(this.KB);this.paused=true;} kK( g){this.KB.aB(LB.AC);this.KB.aB(LB.TE);this.LD(KB);} DG( g){this.dD.vF();eB.tE(this.TH,0.5);} UK(){this.dD.vF();} uK( g){} rK( g){} vK( g){} onLevelChange( g){} sK( g){} CG( g){eB.tE(this.MK,2.0);} BG( g){}}class JF extends ZC{var ZM;JF( g){this.v=g;}set v( g){if(ZM!=null){ZM.aB(p.ZE);ZM.aB(p.aE);ZM.aB(p.NF);ZM.aB(p.YE);ZM.aB(p.WE);ZM.aB(p.VE);ZM.aB(p.XE);ZM.aB(p.oD);ZM.aB(p.UE);}ZM=g;if(ZM!=null){ZM.u(p.ZE,this.CG);ZM.u(p.aE,this.BG);ZM.u(p.NF,this.pH);ZM.u(p.YE,this.DG);ZM.u(p.WE,this.AF);ZM.u(p.VE,this.tK);ZM.u(p.XE,this.tH);ZM.u(p.oD,this.qH);ZM.u(p.UE,this.rH);}} get v{return ZM;} CG( g){} BG( g){} pH( g){} DG( g){} AF( g){} tK( g){} tH( g){} qH( g){} rH( g){}}class YC extends ZC{var XM;var bM;var dM;var position;var dC=-1;var GC=0;var RL=1;var tC=false;var fH=false;var IE=false;var HM=false;var DE=0;var iD=0;var NE=0;YC( g){dM=new ZC();DB(dM);this.BE=g;if(this.BE==null)return;this.x=100000;}set BE( g){if(XM!=null)this.uB(XM);if(bM!=null)this.uB(bM);XM=null;bM=null;if(g!=null){XM=g;XM.uC=OD.PD/2;XM.vC=OD.PD/2;DB(XM);}else{bM=new gG();DB(bM);}DB(dM);} get BE{return XM;} setScale( g){this.RL=g;if(bM!=null){bM.QB.clear();bM.QB.beginPath();bM.QB.OH(0,0,OD.PD/2*g);bM.QB.closePath();bM.QB.DI(0xff999999,1);}if(XM!=null)XM.UC=XM.VC=g;dM.UC=dM.VC=g;} wE( j){if(XM==null)return false;var g=this.iH(j);g=XM.OC(g);var k=this.BE.bitmapData.bK(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new nB(n.MB("items").IB("blood"));h.uC=50;h.vC=50;h.x=g.x-OD.PD/2;h.y=g.y-OD.PD/2;dM.DB(h);}return i;}}class OD extends JF{static var XG=0.025;static var KF=1.0;static var PD=600;static var LF=800;static var MF=600;static var aG=400;static var bG=300;static var qD=VB.sqrt(LF*LF+MF*MF);static var SI=(qD*2/PD);static var cG=6;var PB;var UB;var PC;var fC;var IG=30.0*VB.PI/180;var HG=1.0*VB.PI/180;var lD=0.05;var FG=-1;var BF=1;var NB;var rC;var mF=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var nF;var oF;var QH;var KK;var FI;var GG=15;var hH;var cD=false;var sE=0;var uF;var oE;var kF=0.90;var AI=0;var lM;var xL;var bB;var XK=0;var LC;var aD=false;var KE,LE;var bH;var ME;OD( g):super(g){lM=new dE.PM(80,60,690,524);this.mask=lM;this.nF=n.wF("speedalizer");this.oF=this.nF.play(true);this.bB=new gG();this.DB(this.bB);bH=new ZI(800,600);DB(bH);KE=LE=0;HC.u(s.fF,this.EG);HC.u(s.oC,this.EG);HC.u(s.yD,this.EG);ME=this.nK.listen(this.mM);} EG( g){KE=g.BI;LE=g.CI;} DL(){var g=this.v.hD;this.v.hD=g+(this.v as xB).zH*(this.v.level*this.v.gD);} pH( g){} AF( g){super.AF(g);this.UL();} UL(){aD=false;ME.pause();this.sE=0;this.v.OE=0;this.cD=false;var h=60;this.fC=new LI(qD,cG*h);for(var g=this.fC.BB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.fC.xH(g);this.PB=new yB(aG,bG);this.UB=new iC(0,0,0);this.PC=new iC(0,0,KF);this.HG=(1+(0.1*this.v.level))*VB.PI/180;this.lD=0.015+(0.004*this.v.level);this.BF=2+this.v.level;this.FG=-this.BF;this.AI=this.v.level*2;this.GG=15+(this.v.level);this.GD();this.NK();ME.resume();} GD(){if(this.NB!=null)this.uB(this.NB);this.NB=new JI();this.DB(this.NB);if(this.LC!=null)this.uB(this.LC);this.LC=new nB(n.MB("items").IB("crosshair"));this.LC.UC=0.5;this.LC.VC=0.5;this.LC.x=(LF/2)-this.LC.width/2;this.LC.y=(MF/2)-this.LC.height/2;this.DB(this.LC);} vF(){this.aD=false;this.ME.pause();var h=60;this.fC=new LI(qD,cG*h);for(var g=this.fC.BB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.fC.xH(g);this.PB=new yB(aG,bG);this.UB=new iC(0,0,0);this.PC=new iC(0,0,KF);this.HG=2*VB.PI/180;this.BF=0;this.FG=0;if(this.NB!=null){this.uB(this.NB);this.NB=null;}this.NB=new JI();this.DB(this.NB);if(this.rC!=null){this.uB(this.rC);this.rC=null;}this.SH();this.ME.resume();} SH(){var g=new YC(null);g.dC=-1;g.GC=0;g.position=this.UB.clone();g.position.z=0.5;this.NB.VD(g);} RH(){var g=new YC(new nB(n.MB("items").IB("countdown01")));g.dC=0;g.GC=0;g.position=this.UB.clone();g.position.z=0.5;g.DE=0;g.IE=true;this.NB.VD(g);g=new YC(new nB(n.MB("items").IB("countdown02")));g.dC=0;g.GC=0;g.position=this.UB.clone();g.position.z=0;g.DE=1;g.IE=true;this.NB.VD(g);g=new YC(new nB(n.MB("items").IB("countdown03")));g.dC=0;g.GC=0;g.position=this.UB.clone();g.position.z=-0.5;g.DE=2;g.IE=true;this.NB.VD(g);g=new YC(new nB(n.MB("items").IB("countdown04")));g.dC=0;g.GC=0;g.position=this.UB.clone();g.position.z=-1;g.DE=3;g.IE=true;this.NB.VD(g);} OK(){var h=1+this.v.level;if(h>=this.mF.length)h=this.mF.length-1;var i=nD.YG(0,h);var j=this.mF[i];var g=new YC(new nB(n.IB(j)));g.tC=true;g.vB=nD.YG(0,359)*VB.PI/180;g.GC=nD.RI(this.FG,this.BF)*VB.PI/180;g.position=this.UB.clone();return g;} NK(){this.RH();this.SH();var h=0;for(var i=0;i<GG;i++ ){var g=null;if(i==GG-1){g=new YC(new nB(n.IB("finish")));g.vB=0;g.GC=5*VB.PI/180;g.position=this.UB.clone();g.dC=0;g.tC=true;g.fH=true;this.uF=g;}else{h++ ;if(this.v.level==1&&h<=3){if(h==1){g=new YC(new nB(n.IB("training01")));g.tC=true;g.vB=0;g.GC=0;g.position=this.UB.clone();g.iD=1;}else if(h==2){g=new YC(new nB(n.IB("training02")));g.tC=true;g.vB=135*VB.PI/180;g.GC=0;g.position=this.UB.clone();g.iD=2;}else if(h==3){g=new YC(new nB(n.IB("training02")));g.tC=true;g.vB=315*VB.PI/180;g.GC=0;g.position=this.UB.clone();g.iD=3;}}else{g=this.OK();}}g.NE=-i*1-3;g.position.z=g.NE;g.dC=0;this.NB.VD(g);}} qK(){this.cD=false;var g=v as xB;g.UK();g.TH();} mM( h){if(this.v.paused==false){this.GL();var g=this.v as xB;if(g.jD&&this.aD&&!g.yE)g.wK();}else{JE=-1;}} wE( h){var g=new FB(this.PB.x,this.PB.y);g=this.iH(g);g=h.OC(g);return h.wE(g);} JK(){this.aD=false;for(var g=0;g<this.NB.QC.length;g++ )this.NB.QC[g].position.z-= (2.5+1-kF)+1;oE.position.z+= (1-kF);this.RH();this.cD=false;this.lD=this.hH;this.rC.visible=false;} mK(){var g=this.v as xB;g.tB.visible=false;this.cD=false;this.aD=false;this.hH=this.lD;this.lD=0;if(this.rC!=null)this.uB(this.rC);this.rC=new nB(n.IB("broken"));this.DB(this.rC);if(this.oE.iD>0&& ++this.XK<=5){eB.tE((){g.LK(this.oE.iD);},2.0);}else{this.v.gD-- ;if(this.v.gD>0)eB.tE(g.PK,2.0);}this.oF.stop();this.oF=this.nF.play(true);this.QH=n.wF("crash");this.KK=this.QH.play();}var JE=-1; GL(){var k=eB.elapsedTime;var h=1.0;if(JE==-1)JE=k;h=VB.min(k-JE,1.0000)*40;JE=k;if(cD){this.sE-= (this.lD*h);var o=this.v.hD;this.v.hD=o+(this.AI*h);}this.NB.SL();this.IG+= (this.HG*h);this.PC.x=-(this.KE-this.PB.x)*3;this.PC.y=-(this.LE-this.PB.y)*3;if(this.PC.aH()>qD*0.7){this.PC.PL(qD*0.7);}this.PC.z=KF;this.UB=this.PC.clone();this.UB.z=XG;this.FL();for(var m=0;m<this.NB.QC.length;m++ ){var g=this.NB.QC[m];g.position.z+= (lD*h);if(g.position.z>=1){if(g.IE&&g.DE==3)aD=true;if(g.BE!=null){this.FI=n.wF("swish");var t=this.FI.play();}if(g.tC)cD=true;if(g.NE!=0)this.sE=g.NE;if(g.tC&&wE(g)){g.position.z=kF;oE=g;this.mK();}else{if(g.iD==3)(this.v as xB).jD=false;if(g.tC)this.DL();if(g.fH){this.qK();}else if(g.dC==0){this.NB.JL(g);}else{g.position.z+= g.dC;}}}var i=this.PC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.IF(i);j=j.add(this.PB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.vB+= (g.GC*h);g.setScale(mD(g.position.z)*SI);}}if(this.uF!=null)this.v.OE=(this.sE+3)/(this.uF.NE+3);} IF( g){var h=new yB(g.x,g.y);h.x*= mD(g.z);h.y*= mD(g.z);return h;} mD( g){var h=XG;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} FL(){if(bB==null)return;var l=2;var j=this.PC.clone();j.scale(l);var h=this.fC.transform(mD(j.z)*l,this.IG,this.IF(j));var i=this.fC.transform(mD(this.UB.z),this.IG,this.IF(this.UB));var k=this.IF(this.UB).add(this.PB);bB.QB.clear();bB.QB.beginPath();bB.QB.OH(k.x,k.y,this.fC.CL*mD(this.UB.z));bB.QB.closePath();bB.QB.DI(0xffcccccc,1);bB.QB.beginPath();for(var g=0;g<h.BB.length;g+= 2){bB.QB.moveTo(h.BB[g].x+this.PB.x,h.BB[g].y+this.PB.y);bB.QB.lineTo(h.BB[g+1].x+this.PB.x,h.BB[g+1].y+this.PB.y);bB.QB.lineTo(i.BB[g+1].x+this.PB.x,i.BB[g+1].y+this.PB.y);bB.QB.lineTo(i.BB[g].x+this.PB.x,i.BB[g].y+this.PB.y);bB.QB.lineTo(h.BB[g].x+this.PB.x,h.BB[g].y+this.PB.y);}bB.QB.closePath();bB.QB.TK(0xFF000000);}}class JI extends ZC{var QC;JI(){QC=new List<YC>();} SL(){this.QC.sort(ZL);} VD( g){if(this.contains(g))return;this.DB(g);this.QC.add(g);} JL( g){if(this.QC.length>0){var h=this.QC.indexOf(g);if(h>=0)this.QC.removeAt(h);}if(this.contains(g))this.uB(g);} ZL( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.eD(g)<this.eD(h))this.EI(g,h);return 1;}if(g.position.z<h.position.z){if(this.eD(g)>this.eD(h))this.EI(g,h);return -1;}return 0;}}class nD{static var WG=new VB.Random();static  YG( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=nD.WG.nextInt(h+1)+g;}return i;}static  RI( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=nD.WG.nextDouble()*(h-g)+g;}return i;}}class LI extends RE{var WM;var aM;LI( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.WM=h;this.aM=g;QK();} get CL{return WM;} QK(){var g=new List<yB>();var h=0.0;var k=2*VB.PI/aM;for(var j=0;j<aM;j++ ){var i=new yB(0,-WM);i.pE=h;g.add(i);h+= k;}this.BB=g;}}class RE implements KI,MI{var BB;RE([ pointList]){this.BB=(pointList!=null)?pointList:new List();}xH( g){if(g<BB.length)this.BB.removeAt(g);} wE( h){var k=this.BB.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(BB[g].y<h.y&&BB[i].y>=h.y||BB[i].y<h.y&&BB[g].y>=h.y){if(BB[g].x+(h.y-BB[g].y)/(BB[i].y-BB[g].y)*(BB[i].x-BB[g].x)<h.x){j=!j;}}i=g;}return j;} rotate( k){var j=this.BB.length;var i=new List<yB>(j);for(var g=0;g<j;g++ ){var h=this.BB[g].clone();h.pE+= k;i[g]=h;}return new RE(i);} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.BB.length;var i=new List<yB>(j);for(var g=0;g<j;g++ ){var k=this.BB[g].clone();k.scale(h);i[g]=k;}return new RE(i);} transform( l, k, m){var j=this.BB.length;var i=new List<yB>(j);for(var g=0;g<j;g++ ){var h=this.BB[g].clone();h.scale(l);h.pE+= k;i[g]=h.add(m);}return new RE(i);}}abstract class MI{}abstract class KI{}class zB extends ZC{var YM=0;var cM=0;var eM=true;var fM=3;var gM=0.0;var hM;var iM;zB( h, g){QL(h,g);} QL( g, h){hM=g;iM=h;this.dispatchEvent(new p(p.NF,this));} get vE{return hM;} get XH{return iM;} start(){this.paused=false;this.dispatchEvent(new p(p.YE,this));} ZK(){this.dispatchEvent(new p(p.ZE,this));}set OE( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;gM=g;this.dispatchEvent(new p(p.UE,this));} get OE{return gM;}set gD( g){if(g<0)g=0;fM=g;this.dispatchEvent(new p(p.oD,this));if(fM==0)this.ZK();} get gD{return fM;}set hD( g){if(g<0)g=0;YM=g;this.dispatchEvent(new p(p.XE,this));} get hD{return YM;} get OL{return YM.toDouble().round().toInt();}set level( g){if(g<0)g=0;cM=g;this.dispatchEvent(new p(p.WE,this));} get level{return cM;} jK(){this.level+= 1;return this.level;}set paused( g){eM=g;this.dispatchEvent(new p(p.VE,this));} get paused{return eM;}}var HC;var OF;var n;var eB;var TI;var jC;var bE;var BC;const  cE="Russo One"; main(){HC=new UD("Stage",OB.query('#stage'));OF=new VF();OF.EK(HC);eB=OF.AG;TI=new VB.Random();TB.AH=new PF(png:true,jpg:true,webp:true);var g=TB.TD("images/Loading.png");g.then((h){jC=new nB(h);jC.uC=20;jC.vC=20;jC.x=400;jC.y=270;HC.DB(jC);bE=new nE(jC,100,hF.iF);bE.LH.vB.OG(100.0*2.0*VB.PI);eB.add(bE);BC=new lC();BC.MC=new UF("Arial",20,0xA0A0A0,bold:true);BC.width=240;BC.height=40;BC.text="... loading ...";BC.x=400-BC.WL/2;BC.y=320;BC.mH=false;HC.DB(BC);UI();});} UI(){n=new dG();n.DC("barrier01","images/barrier01.png");n.DC("barrier02","images/barrier02.png");n.DC("barrier03","images/barrier03.png");n.DC("barrier04","images/barrier04.png");n.DC("barrier05","images/barrier05.png");n.DC("barrier06","images/barrier06.png");n.DC("barrier07","images/barrier07.png");n.DC("training01","images/training01.png");n.DC("training02","images/training02.png");n.DC("finish","images/finish.png");n.DC("broken","images/broken.png");n.FK("items","images/ItemTextureAtlas.json",RF.mG);n.lF("crash","sounds/crash.mp3");n.lF("swish","sounds/swish.mp3");n.lF("speedalizer","sounds/speedalizer.mp3");n.WB("DISPLAY_LEVEL","Level: {0}");n.WB("DISPLAY_LIVES","Ships:");n.WB("DISPLAY_SCORE","Score: {0}");n.WB("DISPLAY_TRAINING","Training");n.WB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");n.WB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");n.WB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");n.WB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");n.WB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");n.WB("MESSAGE_GAME_OVER","Game\nOver!");n.WB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");n.WB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");n.WB("GENscore","Score");n.WB("GENlevel","Level");n.WB("GENexitquery","Do you really want to quit the game?");n.WB("GENyes","Yes");n.WB("GENno","No");n.load().then((j){HC.uB(jC);HC.uB(BC);eB.remove(bE);var h=new xB(800,600);h.GK(HC);h.start();}).catchError((i){for(var g in n.UH){print("Loading resouce failed: ${g.kind}.${g.name} - ${g.error}");}});}const jL=const kL();class kL{const kL();}class fG{final  AN;final  LN;final  hN;final  rN;final  DO;final  JO;final  RO;final  WO;final  cO;final  eO;final  iO;fG.SM( i, h, g):AN=i,LN=h,hN=gJ(g["rotated"]),rN=qC(g["sourceSize"]["w"]),DO=qC(g["sourceSize"]["h"]),JO=qC(g["spriteSourceSize"]["x"]),RO=qC(g["spriteSourceSize"]["y"]),WO=qC(g["frame"]["x"]),cO=qC(g["frame"]["y"]),eO=qC(g["frame"]["w"]),iO=qC(g["frame"]["h"]); get XL=>AN; get name=>LN; get NL=>hN; get VK=>WO; get WK=>cO; get WH=>eO; get VH=>iO; get offsetX=>JO; get offsetY=>RO; get zK=>rN; get yK=>DO;}class UF{var font;var size;var color;var bold;var italic;var underline;var align;var leftMargin;var rightMargin;var indent;var leading;var letterSpacing=0;var yL=0;var zL=false;var IM=false;UF(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.leftMargin: 0,this.rightMargin: 0,this.indent: 0,this.leading: 0});}class CD{var mp3;var mp4;var ogg;var wav;var ignoreErrors;CD({this.mp3: false,this.mp4: false,this.ogg: false,this.wav: false,this.ignoreErrors: true});}class dI{var AE;var uE;var height;var leading;var width;var x;dI(this.x,this.width,this.height,this.AE,this.uE,this.leading);}class SD{static const  gI=0;static const  uG=1;static const  kE=2;static const  xI=3;static const  tG=4;}class dE{var wC=null;dE();factory dE.PM( i, g, h, j){return new nL(i,g,h,j);} EB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);}}abstract class jB{static  TD( g,[ soundLoadOptions=null]){switch (RD.OJ){case "WebAudioApi":return WF.TD(g,soundLoadOptions);case "AudioElement":return TF.TD(g,soundLoadOptions);default:return BD.TD(g,soundLoadOptions);}}static var AH=new CD(mp3:true,mp4:true,ogg:true,wav:true); get length; play([ loop=false, soundTransform]);}abstract class bC extends aC{ set FF( g); stop();}class lL extends bC{var VN;var YN;var DN;var FO;var OO;lL( j, h, i){VN=j;DN=h;YN=i;var g=RD.mE;FO=g.createGain();FO.connect(g.destination,0,0);FO.gain.value=(YN!=null)?VB.pow(YN.volume,2):1;OO=g.createBufferSource();OO.buffer=VN.EN;OO.loop=h;OO.connect(FO,0,0);OO.start(0);} set FF( g){YN=g;FO.gain.value=(YN!=null)?VB.pow(YN.volume,2):1;} stop(){OO.stop(0);}}class uD{static const  hI="exactFit";static const  qI="noBorder";static const  yI="noScale";static const  vG="showAll";}class dG{var RN;dG(){RN=new Map<String,eE>();} gO( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(RN.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");RN[i]=g;} YP( i, g){var h="${i}.${g}";if(RN.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return RN[h];} DC( i, h,[ bitmapDataLoadOptions=null]){var g=new eE("BitmapData",i,h);g.dP(TB.TD(h,bitmapDataLoadOptions));gO(g);} lF( i, h,[ soundFileSupport=null]){var g=new eE("Sound",i,h);g.dP(jB.TD(h,soundFileSupport));gO(g);} FK( j, h, i){var g=new eE("TextureAtlas",j,h);g.dP(kC.TD(h,i));gO(g);} WB( i, h){var g=new eE("Text",i,"");g.dP(new dB.Future.immediate(h));gO(g);} load(){var h=this.AL.map((i)=>i.eN);return dB.Future.wait(h).then((j){var g=this.UH;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get AL{return RN.values.where((g)=>g.PE==null).toList();} get UH{return RN.values.where((g)=>g.error!=null).toList();} IB( g){return YP("BitmapData",g).PE;} wF( g){return YP("Sound",g).PE;} MB( g){return YP("TextureAtlas",g).PE;} dK( g){return YP("Text",g).PE;}}class eE{var wM;var LN;var WN;var eN;var oN;var tN;eE( g, h, i){wM=g;LN=h;WN=i;oN=null;tN=null;} get kind=>wM; get name=>LN; get PE=>tN; get error=>oN;dP( i){eN=i.then((g){tN=g;oN=null;},onError:( h){tN=null;oN=h.error;});}}class kC{final  GN=new List<fG>();var lN;static  TD( o, iB){var k=new dB.Completer<kC>();var g=new kC();switch (iB){case RF.jI:case RF.mG:OB.HttpRequest.getString(o).then((XB){var t=cL.parse(XB);var h=t["frames"];var w=t["meta"];var XC=rJ(o,w["image"]);if(h is List){for(var HB in h){var j=HB as Map;var i=j["filename"] as String;var l=JH(i);var m=new fG.SM(g,l,j);g.GN.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=JH(i);var m=new fG.SM(g,l,j);g.GN.add(m);}}TB.TD(XC).then(( pB){g.lN=pB;k.complete(g);}).catchError((cB){k.completeError(new StateError("Failed to load image."));});}).catchError((cB){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} IB( h){for(int g=0;g<GN.length;g++ )if(GN[g].name==h)return new TB.VM(GN[g]);throw new ArgumentError("TextureAtlasFrame not found: '${h}'");}}class RF{static const  jI="json";static const  mG="jsonarray";}class tD extends JB{var upState;var overState;var downState;var hitTestState;var SG=true;var enabled=true;var XO;tD([this.upState,this.overState,this.downState,this.hitTestState]){u(s.yG,uO);u(s.lE,uO);u(s.oC,uO);u(s.yD,uO);XO=this.upState;} ZB( g,[ returnRectangle]){if(XO!=null){uP.rF(XO.EQ,g);return XO.ZB(uP,returnRectangle);}return super.ZB(g,returnRectangle);} RB( k, l){if(this.hitTestState!=null){var g=this.hitTestState.EQ;var h=k-g.gB;var i=l-g.hB;var m=(g.d*h-g.c*i)/g.eC;var j=(g.a*i-g.b*h)/g.eC;if(this.hitTestState.RB(m,j)!=null)return this;}return null;} EB( g){if(XO!=null)g.yH(XO);} uO( g){if(g.type==s.lE){XO=upState;}else{XO=g.cC?downState:overState;}}}class bI<wD>{final  uM=new List<wD>();final  ZN;var jN=0;bI( g()):ZN=g; vH(){if(jN==0){return ZN();}else{jN-- ;return uM[jN];}}wH( g){if(jN==uM.length){uM.add(g);}else{uM[jN]=g;}jN++ ;}reset(){uM.clear();jN=0;}}class XI{XI();}class qB{static const  iE="center";static const  pI="end";static const  vI="justify";static const  uG="left";static const  kE="right";}class TF extends jB{var KN;var cN;var vN;TF(){vN=new List<fE>();KN=new OB.AudioElement();KN.onEnded.listen(jO);cN=new List<OB.AudioElement>();cN.add(KN);OB.document.body.children.add(KN);}static  TD( k,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=jB.AH;var m=new TF();var g=m.KN;var h=RD.KH(k,soundLoadOptions);var i=new dB.Completer<jB>();if(h.length==0){return BD.TD(k,soundLoadOptions);}var j;var l;HB(t){j.cancel();l.cancel();i.complete(m);}o(t){if(h.length>0){g.src=h.removeAt(0);g.load();}else{j.cancel();l.cancel();if(soundLoadOptions.ignoreErrors){BD.TD(k,soundLoadOptions).then((w)=>i.complete(w));}else{i.completeError(new StateError("Failed to load audio."));}}}j=g.onCanPlayThrough.listen(HB);l=g.onError.listen(o);g.src=h.removeAt(0);g.load();return i.future;} get length{return KN.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new kB();return new fE(this,loop,soundTransform);} zO( h){var g;if(cN.length==0){g=KN.clone(true);g.onEnded.listen(jO);}else{g=cN.removeAt(0);}vN.add(h);return g;} MQ( g){var h=g.KN;var i=vN.indexOf(g);vN.removeAt(i);cN.add(h);if(KN.currentTime>0&&KN.ended==false)KN.currentTime=0;} jO( j){var i=j.target;var g=null;for(int h=0;h<vN.length&&g==null;h++ )if(vN[h].KN==i)g=vN[h];if(g!=null)g.stop();}}class VI{static const  EH="none";}class cI{static const  iI="dynamic";}class mL extends bC{var DN;var YN;mL( i, h, g){DN=h;YN=g;}set FF( g){YN=g;} stop(){}}class ZI extends JB{var width;var height;ZI(this.width,this.height); ZB( g,[ returnRectangle]){return jF(g,width,height,returnRectangle);} RB( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} EB( g){}}class eI{static const  oI="pixel";}class zC{static var jG=rB.ZF;static var nI=false;static var qG=null;static var zI=null;static var CJ=null;static var JJ=new dB.StreamController<String>();static var QJ=JJ.stream.asBroadcastStream();static  IH( i){var h=i;var g="auto";if(jG!=rB.ZF){h=jG;}switch (h){case rB.ZF:g="auto";break;case rB.bF:g="default";break;case rB.cF:g="pointer";break;case rB.AJ:g="move";break;case rB.BJ:g="text";break;case rB.EJ:g="wait";break;}if(nI){g="none";}return g;}}class rB{static const  ZF="auto";static const  bF="arrow";static const  cF="button";static const  AJ="hand";static const  BJ="ibeam";static const  EJ="wait";}class eG{static const  EH="none";static const  wI="touchPoint";}class RD{static var OJ=hJ();static var mE=nJ();static var BH=oJ();static  hJ(){var h=(mE!=null)?"WebAudioApi":"AudioElement";var g=OB.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(BH.length==0)h="Mock";print("StageXL: supported audio engine is: ${h}");return h;}static  nJ(){if(VG.AudioContext.supported)return new VG.AudioContext();return null;}static  oJ(){var g=new List<String>();var h=new OB.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/mp4",""))!=-1)g.add("mp4");if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("StageXL: supported audio types are: ${g}");return g;}static  KH( i, h){var l=new RegExp(r"(mp3|mp4|ogg|wav)$",multiLine:false,caseSensitive:true);var g=BH.toList();var k=l.firstMatch(i);var j=new List<String>();if(k==null){throw new ArgumentError("Unsupported file extension.");}if(g.length==0){throw new UnsupportedError("This browser supports no known audio codec.");}if(!h.mp3)g.remove("mp3");if(!h.mp4)g.remove("mp4");if(!h.ogg)g.remove("ogg");if(!h.wav)g.remove("wav");var m=k.group(1);if(g.contains(m)){j.add(i);g.remove(m);}for(var o in g){j.add(i.replaceAll(l,o));}return j;}}final  YF=new Map<String,DH>();class gG extends q{var BN=new sD(); get QB=>BN; ZB( g,[ returnRectangle]){if(BN==null){return super.ZB(g,returnRectangle);}else{return BN.JP(g);}} RB( g, h){if(BN==null){return null;}else{return BN.kP(g,h)?this:null;}} EB( g){if(BN!=null)BN.EB(g);}}abstract class IC{EB( g); RB( g, h, i){EB(g);return false;}xC( g){}}abstract class QF{ EB( g);}class PF{var png;var jpg;var webp;PF({this.png: true,this.jpg: true,this.webp: false});}class ZC extends nC{var AM=false;var SG=false;var zF=null;var BN=null;var IO=null; get QB{return (BN!=null)?BN:BN=new sD();}JQ(){var i=this.zE;var j=this.MD;var m=this.visible;if(i!=null&&this.MD!=null){var h=zC.CJ;if(h!=null){var g=EQ.QE(i);if(g.x<h.left)g.x=h.left;if(g.x>h.right)g.x=h.right;if(g.y<h.top)g.y=h.top;if(g.y>h.bottom)g.y=h.bottom;i=EQ.PH().QE(g);}var l=new FB(tO,xO).add(i).subtract(zC.zI);var k=EQ.QE(l);this.visible=false;IO=j.RB(j.KE,j.LE);this.x=k.x;this.y=k.y;this.visible=m;}} ZB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new CB.QM();super.ZB(g,returnRectangle);if(BN!=null){returnRectangle=BN.JP(g).union(returnRectangle);}return returnRectangle;} RB( i, j){var h=null;if(this.zF!=null){var g=this.PG(this.zF);if(g!=null){var k=i*g.a+j*g.c+g.gB;var l=i*g.b+j*g.d+g.hB;if(this.zF.RB(k,l)!=null){h=this;}}}else{h=super.RB(i,j);if(h==null&&BN!=null){if(BN.kP(i,j)){h=this;}}}return h;}EB( g){if(BN!=null)BN.EB(g);super.EB(g);}}class fE extends bC{var XN;var KN;var DN;var YN;fE( g, i, h){XN=g;DN=i;YN=h;KN=g.zO(this);KN.loop=DN;this.FF=h;KN.play();} set FF( g){YN=g;if(KN!=null)KN.volume=(YN!=null)?YN.volume:1;} stop(){if(KN!=null){if(KN.ended==false)KN.pause();XN.MQ(this);KN=null;}}}class WF extends jB{var EN;WF(){if(RD.mE==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  TD( h,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=jB.AH;var l=new WF();var g=new dB.Completer<jB>();var i=RD.KH(h,soundLoadOptions);var w=RD.mE;if(i.length==0){return BD.TD(h,soundLoadOptions);}HB(m){w.decodeAudioData(m.response,( t){l.EN=t;g.complete(l);},(o){if(soundLoadOptions.ignoreErrors){BD.TD(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to decode audio."));}});}k(o){if(i.length>0){OB.HttpRequest.request(i.removeAt(0),responseType:'arraybuffer').then(HB).catchError(k);}else{if(soundLoadOptions.ignoreErrors){BD.TD(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to load audio."));}}}k(null);return g.future;} get length{return EN.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new kB();return new lL(this,loop,soundTransform);}}abstract class aI{}class gE<wD extends GB>{final  CN=new List<QD>();var qN=0;static var wG=new gE<rD>(); qO( g){for(int h=0;h<qN;h++ ){if(CN[h]==g)return;}if(qN==CN.length){CN.add(g);}else{CN[qN]=g;}qN++ ;} rP( j){j.vP=AD.jE;j.xP=false;j.DQ=false;var k=qN;var i=0;for(int g=0;g<k;g++ ){var h=CN[g];if(h==null)continue;if(h.bO==0){CN[g]=null;continue;}j.aN=h.aN;j.IQ=h.aN;h.rP(j);if(i!=g){CN[i]=h;CN[g]=null;}i++ ;}if(i!=k){for(int g=k;g<qN;g++ ){CN[i++ ]=CN[g];CN[g]=null;}qN=i;}}}abstract class nC extends JB{final  fN=new List<q>();var zN=true;var HO=true; DB( g){if(g.parent==this){var h=fN.indexOf(g);fN.removeAt(h);fN.add(g);}else{DK(g,fN.length);}} DK( g, h){if(h<0||h>fN.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){fN.removeAt(fN.indexOf(g));if(h>fN.length)h-- ;fN.insert(h,g);}else{g.IL();g.XQ(this);fN.insert(h,g);g.dispatchEvent(new GB(GB.lI,true));if(this.MD!=null)eQ(g,new GB(GB.nG));}} uB( h){var g=fN.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");HL(g);} HL( g){if(g<0||g>=fN.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=fN[g];h.dispatchEvent(new GB(GB.DJ,true));if(this.MD!=null)eQ(h,new GB(GB.HJ));h.XQ(null);fN.removeAt(g);} ZH( g){if(g<0||g>=fN.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return fN[g];} eD( g){return fN.indexOf(g);} EI( j, i){var h=eD(j);var g=eD(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");VL(h,g);} VL( h, g){var j=ZH(h);var i=ZH(g);fN[h]=i;fN[g]=j;} contains( g){for(;g!=null;g=g.tP)if(g==this)return true;return false;} ZB( o,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new CB.QM();if(fN.length==0)return super.ZB(o,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var t=fN.length;for(int l=0;l<fN.length;l++ ){var m=fN[l];uP.rF(m.EQ,o);var g=m.ZB(uP,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} RB( t, w){var l=null;for(int j=fN.length-1;j>=0;j-- ){var i=fN[j];if(i.visible){var g=i.EQ;var m=t-g.gB;var k=w-g.hB;var HB=(g.d*m-g.c*k)/g.eC;var o=(g.a*k-g.b*m)/g.eC;var h=i.RB(HB,o);if(h!=null){if(h is JB)if(h.mH)return zN?h:this;l=this;}}}return l;} EB( i){for(int h=0;h<fN.length;h++ ){var g=fN[h];if(!g.SP&&g.visible)i.yH(g);}}LR( g, i){i.add(g);if(g is nC){var k=g as nC;var j=k.fN;for(int h=0;h<j.length;h++ ){LR(j[h],i);}}}eQ( i, j){var g=hE.vH() as List<q>;LR(i,g);for(int h=0;h<g.length;h++ ){g[h].dispatchEvent(j);}g.clear();hE.wH(g);}}final  hE=new bI<List<q>>(()=>new List<q>());abstract class JB extends q{var RK=false;var mH=true;var OM=true;var tabIndex=0;static const  FJ=const CC<s>(s.lE);static const  VJ=const CC<s>(s.fF);static const  aJ=const CC<s>(s.oC);static const  jJ=const CC<s>(s.yD);static const  pJ=const CC<s>(s.zG); get onMouseOut=>JB.FJ.forTarget(this); get onMouseMove=>JB.VJ.forTarget(this); get onMouseDown=>JB.aJ.forTarget(this); get onMouseUp=>JB.jJ.forTarget(this); get onMouseWheel=>JB.pJ.forTarget(this);static const  uJ=const CC<SB>(SB.xG);static const  vJ=const CC<SB>(SB.pG);static const  wJ=const CC<SB>(SB.rG); get onTouchMove=>JB.uJ.forTarget(this); get onTouchEnd=>JB.vJ.forTarget(this); get onTouchCancel=>JB.wJ.forTarget(this);static const  zJ=const CC<JC>(JC.oG);static const  AK=const CC<JC>(JC.aF); get onKeyUp=>JB.zJ.forTarget(this); get onKeyDown=>JB.AK.forTarget(this);}class sD{static final  XJ=new OB.CanvasElement(width:16,height:16);static final  bJ=XJ.context2d;final  fP=new List<IC>();var jP=new CB.QM();var pP=true;clear(){fP.clear();pP=true;}AQ( g){fP.add(g);pP=true;}beginPath()=>AQ(new oL());closePath()=>AQ(new pL());moveTo( h, g)=>AQ(new qL(h,g));lineTo( h, g)=>AQ(new rL(h,g));arc( l, g, j, i, h, k)=>AQ(new sL(l,g,j,i,h,k));rect( i, g, h, j)=>AQ(new tL(i,g,h,j));DI( g,[ width=1.0, joints=YI.mI, caps=WI.mI])=>AQ(new uL(gF(g),width,joints,caps));TK( g)=>AQ(new vL(gF(g)));OH( i, g, h){AQ(new qL(i+h,g));AQ(new sL(i,g,h,0,VB.PI*2,false));} JP( i){var h=new pC(i);for(int g=0;g<fP.length;g++ ){fP[g].xC(h);}return h.cK();} kP( h, i){if(pP){pP=false;jP=JP(new AB.TM());}if(jP.contains(h,i)){var j=sD.bJ;j.beginPath();for(int g=0;g<fP.length;g++ ){if(fP[g].RB(j,h,i)){return true;}}}return false;} EB( i){var g=i.context;g.save();g.beginPath();for(int h=0;h<fP.length;h++ ){fP[h].EB(g);}g.restore();}}class WI{static const  mI="round";}class SF implements mC{final  MN;var UN=0.0;var iN=0.0;var sN=1;SF( g, h):MN=g{iN=VB.max(h,0.0001);} ED( h){var g=UN+h;while (g>=iN&&sN>0){UN=iN;sN-- ;MN();g-= iN;}UN=g;return (sN>0);} get currentTime=>UN;}abstract class mC{ ED( g);}class vD implements mC{final  QN=new List<mC>();var nN=0;var xN=0.0; get elapsedTime=>xN; add( g){if(g==null)return;if(this.contains(g))return;if(nN==QN.length){QN.add(g);}else{QN[nN]=g;}nN++ ;} remove( h){if(h==null)return;for(int g=0;g<nN;g++ ){if(identical(QN[g],h)){QN[g]=null;break;}}} contains( h){if(h==null)return false;for(int g=0;g<nN;g++ ){if(identical(QN[g],h)){return true;}}return false;} QG( h, i,[ transitionFunction]){var g=new nE(h,i,transitionFunction);add(g);return g;} tE( h, i){var g=new SF(h,i);add(g);return g;} ED( k){xN+= k;var j=nN;var h=0;for(int g=0;g<j;g++ ){var i=QN[g];if(i==null)continue;if(i.ED(k)==false){QN[g]=null;continue;}if(h!=g){QN[h]=i;QN[g]=null;}h++ ;}if(h!=j){for(int g=j;g<nN;g++ ){QN[h++ ]=QN[g];QN[g]=null;}nN=h;}return true;}}class fB{final  HN;final  bN=new List<AB>(100);final  AO=new List<double>(100);var KO=0;var UN=0.0;var VO=0.0;fB.RM( j,[ matrix]):HN=j{for(int h=0;h<100;h++ ){bN[h]=new AB.TM();AO[h]=1.0;}if(matrix!=null)bN[0].rE(matrix);var g=bN[0];var i=AO[0];HN.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);HN.globalAlpha=i;} get context=>HN; get currentTime=>UN; reset([ matrix, currentTime, deltaTime]){if(matrix!=null)bN[0].rE(matrix);KO=0;UN=?currentTime?currentTime:0.0;VO=?deltaTime?deltaTime:0.0;var g=bN[0];var h=AO[0];HN.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);HN.globalAlpha=h;HN.clearRect(0,0,HN.canvas.width,HN.canvas.height);} yH( i){var m=KO;var o=KO+1;var l=bN[m];var h=bN[o];var HB=AO[m];var w=AO[o]=i.OP*HB;var g=l;var k=i.XP;var t=i.bP;var j=i.mP;KO=o;h.rF(i.EQ,l);if(k!=null||j!=null){HN.save();}if(k!=null){if(k.wC==null){g=h;}else if(identical(k.wC,i)){g=h;}else if(identical(k.wC,i.parent)){g=l;}else{g=k.wC.PG(i);if(g==null)g=dF;else g.concat(h);}k.EB(this,g);}if(j!=null){if(j.wC==null){g=h;}else if(identical(j.wC,i)){g=h;}else if(identical(j.wC,i.parent)){g=l;}else{g=j.wC.PG(i);if(g==null)g=dF;else g.concat(h);}j.EB(this,g);}HN.setTransform(h.a,h.b,h.c,h.d,h.gB,h.hB);HN.globalAlpha=w;if(t!=null){t.EB(this);}else{i.EB(this);}if(k!=null||j!=null){HN.restore();}KO=m;}}class hG{final  QG;hG(this.QG);call( h, g){CO(h).OG(g);} get x=>CO("x"); get y=>CO("y"); get UC=>CO("scaleX"); get VC=>CO("scaleY"); get skewX=>CO("skewX"); get skewY=>CO("skewY"); get uC=>CO("pivotX"); get vC=>CO("pivotY"); get vB=>CO("rotation"); get alpha=>CO("alpha"); CO( h){var g=new oB(h);this.QG.CO(g);return g;}}class YI{static const  mI="round";}class kB{var volume;var pan;var JM=1;var KM=0;var NM=1;var MM=0;kB([this.volume=1,this.pan=0]);}class FB{var nM;var rM;FB( h, g):nM=h,rM=g;FB.QM():this(0,0); clone()=>new FB(nM,rM); toString()=>"Point [x=${nM}, y=${rM}]";static  fJ( g, h)=>new FB(g*VB.cos(h),-g*VB.sin(h)); get x=>nM; get y=>rM; get length=>VB.sqrt(nM*nM+rM*rM);set x( g){nM=g;}set y( g){rM=g;} add( g){return new FB(nM+g.x,rM+g.y);} subtract( g){return new FB(nM-g.x,rM-g.y);}rE( g){nM=g.x;rM=g.y;} tF( g){return nM==g.x&&rM==g.y;}}class CB{var nM;var rM;var yM;var NN;CB( i, g, h, j):nM=i,rM=g,yM=h,NN=j;CB.QM():this(0,0,0,0); clone()=>new CB(nM,rM,yM,NN); toString()=>"Rectangle [x=${nM}, y=${rM}, width=${yM}, height=${NN}]"; get x=>nM; get y=>rM; get width=>yM; get height=>NN; get left=>nM; get top=>rM; get right=>nM+yM; get bottom=>rM+NN; get PB=>new FB(nM+yM/2,rM+NN/2); get size=>new FB(yM,NN);set x( g){nM=g;}set y( g){rM=g;}set width( g){yM=g;}set height( g){NN=g;} set size( g){yM=g.x;NN=g.y;} contains( g, h){return nM<=g&&rM<=h&&nM+yM>=g&&rM+NN>=h;} tF( g){return nM==g.x&&rM==g.y&&yM==g.width&&NN==g.height;} get isEmpty{return yM==0&&NN==0;}rE( g){nM=g.x;rM=g.y;yM=g.width;NN=g.height;} union( g){var i=VB.min(this.left,g.left);var h=VB.min(this.top,g.top);var j=VB.max(this.right,g.right);var k=VB.max(this.bottom,g.bottom);return new CB(i,h,j-i,k-h);} align(){var h=this.left.floor();var g=this.top.floor();var i=this.right.ceil();var j=this.bottom.ceil();return new CB(h,g,i-h,j-g);}}class AB{var oM,pM,sM,tM,vM,zM;var ON;AB( h, i, g, j, k, l):oM=h.toDouble(),pM=i.toDouble(),sM=g.toDouble(),tM=j.toDouble(),vM=k.toDouble(),zM=l.toDouble(),ON=(h*j-i*g).toDouble();AB.TM():oM=1.0,pM=0.0,sM=0.0,tM=1.0,vM=0.0,zM=0.0,ON=1.0; clone(){return new AB(oM,pM,sM,tM,vM,zM);} PH(){var h=(tM/ON);var i=-(pM/ON);var g=-(sM/ON);var j=(oM/ON);var k=-(h*vM+g*zM);var l=-(i*vM+j*zM);return new AB(h,i,g,j,k,l);} get a=>oM; get b=>pM; get c=>sM; get d=>tM; get gB=>vM; get hB=>zM; get eC=>ON; QE( h){var i=h.x.toDouble();var g=h.y.toDouble();return new FB(i*oM+g*sM+vM,i*pM+g*tM+zM);} aQ( h){var i=h.x.toDouble();var g=h.y.toDouble();return new FB(i*oM+g*sM+vM,i*pM+g*tM+zM);} concat( g){var m=oM;var w=pM;var HB=sM;var t=tM;var l=vM;var o=zM;var cB=ON;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var iB=g.gB;var XB=g.hB;var pB=g.eC;oM=(m*j+w*i).toDouble();pM=(m*k+w*h).toDouble();sM=(HB*j+t*i).toDouble();tM=(HB*k+t*h).toDouble();vM=(l*j+o*i+iB).toDouble();zM=(l*k+o*h+XB).toDouble();ON=(cB*pB).toDouble();} dH(){oM=1.0;pM=0.0;sM=0.0;tM=1.0;vM=0.0;zM=0.0;ON=1.0;} eH(){var j=oM;var m=pM;var l=sM;var k=tM;var h=vM;var i=zM;var g=ON;oM=(k/g).toDouble();pM=-(m/g).toDouble();sM=-(l/g).toDouble();tM=(j/g).toDouble();vM=-(oM*h+sM*i).toDouble();zM=-(pM*h+tM*i).toDouble();ON=(1.0/g).toDouble();} rotate( i){var g=VB.cos(i);var h=VB.sin(i);var j=oM;var o=pM;var m=sM;var l=tM;var k=vM;var t=zM;oM=(j*g-o*h).toDouble();pM=(j*h+o*g).toDouble();sM=(m*g-l*h).toDouble();tM=(m*h+l*g).toDouble();vM=(k*g-t*h).toDouble();zM=(k*h+t*g).toDouble();} DF( h, i, g, k, j, l){oM=h.toDouble();pM=i.toDouble();sM=g.toDouble();tM=k.toDouble();vM=j.toDouble();zM=l.toDouble();ON=(oM*tM-pM*sM).toDouble();} rE( g){oM=g.a.toDouble();pM=g.b.toDouble();sM=g.c.toDouble();tM=g.d.toDouble();vM=g.gB.toDouble();zM=g.hB.toDouble();ON=g.eC.toDouble();} rF( h, g){var o=h.a;var HB=h.b;var XB=h.c;var w=h.d;var m=h.gB;var t=h.hB;var iB=h.eC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var pB=g.gB;var cB=g.hB;var XC=g.eC;oM=(o*k+HB*j).toDouble();pM=(o*l+HB*i).toDouble();sM=(XB*k+w*j).toDouble();tM=(XB*l+w*i).toDouble();vM=(m*k+t*j+pB).toDouble();zM=(m*l+t*i+cB).toDouble();ON=(iB*XC).toDouble();}}class lC extends JB{var IN="";var TN=0x000000;var mN=null;var BO=VI.EH;var PO=eI.oI;var ZO=cI.iI;var fO=false;var kO=false;var nO=0x000000;var rO=false;var vO=0x000000;var BP=0;var EP=0;var HP;var NP;var QP=true;var TP=100;var VP=100;var ZP=null;var HN=null;lC([ text, textFormat]){if(text!=null)IN=text;if(textFormat!=null)MC=textFormat;else mN=new UF("Arial",12,0x000000);HP=new List<String>();NP=new List<dI>();} get type=>ZO; get width=>TP; get height=>VP; set text( g){IN=g;QP=true;} set ND( g){TN=g;QP=true;} set MC( g){mN=g;TN=mN.color;QP=true;} set wordWrap( g){fO=g;QP=true;} set width( g){TP=g;QP=true;} set height( g){VP=g;QP=true;} get WL{tQ();return BP;} ZB( g,[ returnRectangle]){return jF(g,TP,VP,returnRectangle);} RB( g, h){if(g>=0&&h>=0&&g<TP&&h<VP)return this;return null;} EB( g){tQ();g.HN.drawImage(ZP,0.0,0.0);} HR( t){var o=tI(t);HP.clear();NP.clear();if(fO==false){for(String h in IN.replaceAll('\r','').split('\n'))HP.add(h);}else{for(String h in IN.replaceAll('\r','').split('\n')){var g='';for(String j in h.split(' ')){var m=g;g=(g.length==0)?j:g+' '+j;if(HN.measureText(g).width>TP){if(m.length==0){HP.add(g);g='';}else{HP.add(m);g=j;}}}if(g.isEmpty==false){HP.add(g);}}}BP=0;EP=0;for(String g in HP){var k=HN.measureText(g);var l=0.0;if(mN.align==qB.iE||mN.align==qB.vI)l=(TP-k.width)/2;if(mN.align==qB.kE||mN.align==qB.pI)l=TP-k.width;var i=new dI(l,k.width,mN.size,o.AE,o.uE,0);NP.add(i);BP=VB.max(BP,i.width);EP=EP+i.height;}} tQ(){if(QP){QP=false;var h=TP.ceil().toInt();var i=VP.ceil().toInt();if(ZP==null){ZP=new OB.CanvasElement(width:h,height:i);HN=ZP.context2d;}if(ZP.width!=h)ZP.width=h;if(ZP.height!=i)ZP.height=i;var m=new StringBuffer()..write(mN.italic?"italic ":"normal ")..write("normal ")..write(mN.bold?"bold ":"normal ")..write("${mN.size}px ")..write("${mN.font},sans-serif");var j=m.toString();HN.font=j;HN.textAlign="start";HN.textBaseline="alphabetic";HN.fillStyle=xD(TN);HR(j);if(kO){HN.fillStyle=xD(nO);HN.fillRect(0,0,TP,VP);}else{HN.clearRect(0,0,TP,VP);}var k=mN.size;for(int g=0;g<HP.length;g++ ){var l=NP[g];HN.fillStyle=xD(TN);HN.fillText(HP[g],l.x,k);k+= l.height;}if(rO){HN.strokeStyle=xD(vO);HN.lineWidth=1;HN.strokeRect(0,0,TP,VP);}}}}class SB extends GB{static const  lG="touchBegin";static const  pG="touchEnd";static const  rG="touchCancel";static const  xG="touchMove";static const  IJ="touchOver";static const  MJ="touchOut";var iP;var lP;var nP,oP;var qP,sP;var oO;var CP;var pO;var sO;var yP;var BQ;var CQ;SB( g,[ bubbles=false]):super(g,bubbles){WP(g,bubbles);} WP( g,[ bubbles=false]){super.WP(g,bubbles);iP=0;lP=false;nP=oP=0;qP=sP=0;oO=false;CP=false;pO=false;sO=false;yP=1.00;BQ=0;CQ=0;}set SQ( g){nP=g.x;oP=g.y;}set VQ( g){qP=g.x;sP=g.y;} get HF=>iP; get BI=>qP; get CI=>sP; get altKey=>oO; get ctrlKey=>pO; get shiftKey=>sO;}class BD extends jB{BD(){}static  TD( g,[ soundLoadOptions=null]){return new dB.Future<jB>.of(()=>new BD());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new kB();}return new mL(this,loop,soundTransform);}}class VF{var qM;var JN;var SN;var kN;var yN;VF(){qM=new vD();JN=new List<UD>();SN=double.NAN;kN=gE.wG;yN=new rD(0);OB.window.requestAnimationFrame(AP);} get AG=>qM; AP( g){OB.window.requestAnimationFrame(AP);if(SN.isNaN)SN=g;if(SN>g)SN=g;var k=g-SN;var h=k/1000.0;var l=g/1000.0;if(k>=1){SN=g;yN.xM=h;kN.rP(yN);qM.ED(h);for(int i=0;i<JN.length;i++ ){var j=JN[i];j.AG.ED(h);j.hK(l,h);}}} EK( g){if(g.KG!=null){g.KG.KL(g);}JN.add(g);g.cQ=this;} KL( g){if(g.KG==this){JN.remove(g);g.cQ=null;}}}class GB{static const  lI="added";static const  nG="addedToStage";static const  eF="enterFrame";static const  DJ="removed";static const  HJ="removedFromStage";static const  NJ="resize";var ZO;var GQ;var vP;var aN;var IQ;var xP;var DQ;GB( g,[ bubbles=false]){WP(g,bubbles);} WP( g,[ bubbles=false]){ZO=g;GQ=bubbles;vP=AD.jE;aN=null;IQ=null;xP=false;DQ=false;} get GF=>xP; get type=>ZO; get bubbles=>GQ; get qE=>true; get target=>aN;}class AD{static const  kG=1;static const  jE=2;static const  uI=3;}class aC{var CN;var gN; u( g, h(event),{ useCapture: false}){return TO(g,useCapture).listen(h);}aB( g,{ useCapture: false}){TO(g,useCapture).aP();}dispatchEvent( g){gP(g,this,this,AD.jE);} LQ( h, j, i){if(j&&gN!=null){var g=gN[h];if(g!=null&&g.RQ)return true;}if(i&&CN!=null){var g=CN[h];if(g!=null&&g.RQ)return true;}return false;} TO( h, g){if(g){if(gN==null)gN=new Map<String,QD>();}else{if(CN==null)CN=new Map<String,QD>();}var i=g?gN:CN;return i.putIfAbsent(h,(){return new QD(this,h,g);});}gP( g, k, l, j){var h=(j==AD.kG)?gN:CN;if(h==null)return;var i=h[g.type];if(i==null)return;g.aN=k;g.IQ=l;g.vP=j;g.xP=false;g.DQ=false;i.rP(g);}}class iG extends GB{static const  rI="textInput";var IN="";iG( g,[ bubbles=false]):super(g,bubbles);}class QD<wD extends GB> extends dB.Stream<wD>{final  aN;final  PN;final  uN;final  LO=new List<kI>();var bO=0;QD(this.aN,this.PN,this.uN); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new kI<wD>(this,h);if(bO==LO.length){LO.add(g);}else{LO[bO]=g;}bO++ ;if(PN==GB.eF&&uN==false)gE.wG.qO(this);return g;} PP( h){for(int g=0;g<bO;g++ ){if(identical(LO[g],h)){LO[g]=null;break;}}} get RQ{for(var g=0;g<bO;g++ )if(LO[g]!=null)return true;return false;} aP(){for(int g=0;g<bO;g++ )if(LO[g]!=null)LO[g].cancel();} rP( k){var j=bO;var h=0;for(int g=0;g<j;g++ ){var i=LO[g];if(i==null)continue;i.NO(k);if(h!=g){LO[h]=i;LO[g]=null;}h++ ;}if(h!=j){for(int g=j;g<bO;g++ ){LO[h++ ]=LO[g];LO[g]=null;}bO=h;}}}class CC<wD extends GB>{final  PN;const CC(this.PN); forTarget( g,{ useCapture: false}){return g.TO(PN,useCapture);}}class JC extends GB{static const  aF="keyDown";static const  oG="keyUp";var oO;var pO;var sO;var wO;var CP;var GP;var KP;var MP;JC( g,[ bubbles=false]):super(g,bubbles){WP(g,bubbles);} WP( g,[ bubbles=false]){super.WP(g,bubbles);oO=false;pO=false;sO=false;wO=false;CP=false;GP=0;KP=0;MP=0;} get altKey=>oO; get ctrlKey=>pO; get shiftKey=>sO; get charCode=>GP; get keyCode=>KP; get keyLocation=>MP;}class rD extends GB{var xM;rD( g):super(GB.eF,false){xM=g;} get qE=>false;}class s extends GB{static const  DD="click";static const  sI="doubleClick";static const  oC="mouseDown";static const  yD="mouseUp";static const  fF="mouseMove";static const  lE="mouseOut";static const  yG="mouseOver";static const  zG="mouseWheel";static const  CH="middleClick";static const  UJ="middleMouseDown";static const  ZJ="middleMouseUp";static const  FH="rightClick";static const  eJ="rightMouseDown";static const  iJ="rightMouseUp";var nP,oP;var qP,sP;var KQ;var oO;var CP;var pO;var sO;var OQ;var PQ;var QQ;s( g,[ bubbles=false]):super(g,bubbles){WP(g,bubbles);} WP( g,[ bubbles=false]){super.WP(g,bubbles);nP=oP=0;qP=sP=0;KQ=false;oO=false;CP=false;pO=false;sO=false;OQ=0;PQ=0;QQ=0;}set SQ( g){nP=g.x;oP=g.y;}set VQ( g){qP=g.x;sP=g.y;} get BI=>qP; get CI=>sP; get cC=>KQ; get altKey=>oO; get ctrlKey=>pO; get shiftKey=>sO; get CE=>OQ; get deltaX=>PQ; get deltaY=>QQ;}class nB extends q{var bitmapData;var pixelSnapping;var qF;nB([this.bitmapData=null,this.pixelSnapping="auto"]){qF=null;} ZB( h,[ returnRectangle]){var g=(bitmapData!=null)?bitmapData.width:0;var i=(bitmapData!=null)?bitmapData.height:0;return jF(h,g,i,returnRectangle);} RB( g, h){if(bitmapData!=null&&g>=0.0&&h>=0.0&&g<bitmapData.width&&h<bitmapData.height)return this;return null;} EB( g){if(bitmapData==null)return;if(qF==null){bitmapData.EB(g);}else{bitmapData.LL(g,qF);}}}class lB{final  nM;final  rM;lB( h, g):nM=h.toDouble(),rM=g.toDouble(); clone()=>new lB(nM,rM); get x=>nM; get y=>rM; toString()=>"Vector [x=${nM}, y=${rM}]"; operator+( g)=>new lB(nM+g.nM,rM+g.rM); operator-( g)=>new lB(nM-g.nM,rM-g.rM); operator*( g)=>new lB(nM*g.nM,rM*g.rM); operator/( g)=>new lB(nM/g.nM,rM/g.rM); operator-()=>new lB(-nM,-rM); operator==( g)=>nM==g.nM&&rM==g.rM; scale( g){return new lB(nM*g,rM*g);} normalize(){var g=1/length;return new lB(nM*g,rM*g);} get length=>VB.sqrt(nM*nM+rM*rM); rotate( g){var i=VB.sin(g);var h=VB.cos(g);return new lB(nM*h-rM*i,nM*i+rM*h);}}class TB implements QF{var yM;var NN;var dN;var pN;var wN;var GO;var MO;var SO;var YO;var aO;var dO;var hO;var mO;var HN;static var AH=new PF(png:true,jpg:true,webp:false);TB( h, i,[ transparent=true, fillColor=0xFFFFFFFF]){yM=h.toInt();NN=i.toInt();dN=transparent;pN=0;MO=YO=0;SO=aO=0;wN=dO=yM;GO=hO=NN;var g=new OB.CanvasElement(width:yM,height:NN);HN=g.context2d;HN.fillStyle=dN?gF(fillColor):xD(fillColor);HN.fillRect(0,0,yM,NN);mO=g;}TB.UM( g){if(g==null)throw new ArgumentError();yM=g.naturalWidth.toInt();NN=g.naturalHeight.toInt();dN=true;pN=0;MO=YO=0;SO=aO=0;wN=dO=yM;GO=hO=NN;mO=g;}TB.VM( g){yM=g.zK.toInt();NN=g.yK.toInt();dN=true;pN=g.NL?2:1;MO=g.offsetX;SO=g.offsetY;wN=g.WH;GO=g.VH;YO=g.VK;aO=g.WK;dO=g.WH;hO=g.VH;mO=g.XL.lN.mO;}static  TD( h,[ bitmapDataLoadOptions=null]){if(bitmapDataLoadOptions==null)bitmapDataLoadOptions=TB.AH;var i=new dB.Completer<TB>();var g=new OB.ImageElement();var j;var k;j=g.onLoad.listen((m){j.cancel();k.cancel();i.complete(new TB.UM(g));});k=g.onError.listen((m){j.cancel();k.cancel();i.completeError(new StateError("Error loading image."));});if(bitmapDataLoadOptions.webp==false){g.src=h;return i.future;}yJ.then(( t){var o=new RegExp(r"(png|jpg|jpeg)$",multiLine:false,caseSensitive:true);var l=o.firstMatch(h);if(t==false||l==null){g.src=h;}else{g.src=h.substring(0,h.length-l.group(1).length)+"webp";}});return i.future;} get width=>yM; get height=>NN; clone(){var g=new TB(yM,NN,true,0);g.SK(this);return g;} SK( h,[ matrix=null]){var g=KR();var i=new fB.RM(g,matrix);h.EB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} clear(){var g=KR();g.clearRect(0,0,yM,NN);} bK( j, h){var i=KR();var k=i.getImageData(j,h,1,1);var g=k.data;if(xJ){return (g[0]<<16)+(g[1]<<8)+(g[2]<<0)+(g[3]<<24);}else{return (g[3]<<16)+(g[2]<<8)+(g[1]<<0)+(g[0]<<24);}} EB( h){var g=h.context;switch (pN){case 0:g.drawImage(mO,MO,SO);break;case 1:g.drawImageScaledFromSource(mO,YO,aO,dO,hO,MO,SO,wN,GO);break;case 2:g.transform(0.0,-1.0,1.0,0.0,MO,SO+GO);g.drawImageScaledFromSource(mO,YO,aO,hO,dO,0.0,0.0,GO,wN);break;}} LL( bL, g){var iB=bL.context;if(g.width<=0.0||g.height<=0.0)return;switch (pN){case 0:iB.drawImageScaledFromSource(mO,g.x-MO,g.y-SO,g.width,g.height,g.x+MO,g.y+SO,g.width,g.height);break;case 1:var j=YO;var h=aO;var w=j+dO;var HB=h+hO;var l=YO-MO+g.x;var m=aO-SO+g.y;var cB=l+g.width;var XB=m+g.height;var t=(j>l)?j:l;var o=(h>m)?h:m;var pB=(w<cB)?w:cB;var TG=(HB<XB)?HB:XB;var k=pB-t;var i=TG-o;var UG=MO-j+t;var XC=SO-h+o;if(k>0.0&&i>0.0){iB.drawImageScaledFromSource(mO,t,o,k,i,UG,XC,k,i);}break;case 2:var j=YO;var h=aO;var w=j+hO;var HB=h+dO;var l=YO+SO-g.y+GO-g.height;var m=aO-MO+g.x;var cB=l+g.height;var XB=m+g.width;var t=(j>l)?j:l;var o=(h>m)?h:m;var pB=(w<cB)?w:cB;var TG=(HB<XB)?HB:XB;var k=TG-o;var i=pB-t;var UG=MO-h+o;var XC=SO+w-pB;if(k>0.0&&i>0.0){iB.transform(0.0,-1.0,1.0,0.0,UG,XC+i);iB.drawImageScaledFromSource(mO,t,o,i,k,0,0,i,k);}break;}} KR(){if(HN==null){var g=new OB.CanvasElement(width:yM,height:NN);HN=g.context2d;switch (pN){case 0:HN.drawImage(mO,MO,SO);break;case 1:HN.drawImageScaledFromSource(mO,YO,aO,dO,hO,MO,SO,wN,GO);break;case 2:HN.transform(0.0,-1.0,1.0,0.0,MO,SO+GO);HN.drawImageScaledFromSource(mO,YO,aO,hO,dO,0.0,0.0,GO,wN);HN.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}pN=0;MO=YO=0;SO=aO=0;wN=dO=yM;GO=hO=NN;mO=g;}return HN;}}typedef  XF( ratio);typedef  fI<wD extends GB>( event);class kI<wD extends GB> extends dB.StreamSubscription<wD>{var EO;var NO;var QO;var UO;kI(this.EO,this.NO){QO=0;UO=false;} cancel(){if(UO==false){EO.PP(this);UO=true;NO=null;}} onError( g( error)){} get HQ=>QO>0; pause([ resumeSignal]){QO++ ;if(resumeSignal!=null){resumeSignal.whenComplete(resume);}} resume(){if(HQ==false){throw new StateError("Subscription is not paused.");}QO-- ;}} xD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";} tI( g){if(YF.containsKey(g)==false){YF[g]=new DH(g);}return YF[g];}final  dF=new AB.TM();class sG{static var SJ=eG.EH;static var YJ=new dB.StreamController<String>();static var cJ=YJ.stream.asBroadcastStream();static  get kJ=>SJ;}abstract class q extends aC implements QF{static var LJ=0;var lO=LJ++ ;var nM=0.0;var rM=0.0;var tO=0.0;var xO=0.0;var yO=1.0;var DP=1.0;var FP=0.0;var IP=0.0;var LP=0.0;var OP=1.0;var RP=true;var SP=false;var XP=null;var bP=null;var cP=null;var eP=false;var hP=null;var mP=null;var LN="";var tP=null;final  uP=new AB.TM();final  zP=new AB.TM();var FQ=true;static const  qJ=const CC<rD>(GB.eF); get nK=>q.qJ.forTarget(this); get x=>nM; get y=>rM; get uC=>tO; get vC=>xO; get UC=>yO; get VC=>DP; get skewX=>FP; get skewY=>IP; get vB=>LP; get visible=>RP; get alpha=>OP; get name=>LN; get parent=>tP; get zE{var g=this.MD;return (g!=null)?this.OC(g.lQ):null;} get KE{var g=this.zE;return (g!=null)?g.x:0.0;} get LE{var g=this.zE;return (g!=null)?g.y:0.0;} get root{var g=this;while (g.tP!=null)g=g.tP;return g;} get MD{var g=this.root;if(g is UD)return g;return null;}set x( g){nM=g.toDouble();FQ=true;}set y( g){rM=g.toDouble();FQ=true;}set uC( g){tO=g.toDouble();FQ=true;}set vC( g){xO=g.toDouble();FQ=true;}set UC( g){yO=g.toDouble();FQ=true;}set VC( g){DP=g.toDouble();FQ=true;}set skewX( g){FP=g.toDouble();FQ=true;}set skewY( g){IP=g.toDouble();FQ=true;}set vB( g){LP=g.toDouble();FQ=true;}set visible( g){RP=g;}set alpha( g){OP=g.toDouble();}set mask( g){XP=g;} setTransform( h, g,[ scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY]){FQ=true;nM=h.toDouble();rM=g.toDouble();if(scaleX!=null){yO=scaleX.toDouble();if(scaleY!=null){DP=scaleY.toDouble();if(rotation!=null){LP=rotation.toDouble();if(skewX!=null){FP=skewX.toDouble();if(skewY!=null){IP=skewY.toDouble();if(pivotX!=null){tO=pivotX.toDouble();if(pivotY!=null)xO=pivotY.toDouble();}}}}}}} get width=>ZB(EQ).width; get height=>ZB(EQ).height; set width( h){this.UC=1;var g=this.width;this.UC=(g!=0.0)?h/g:1.0;} set height( h){this.VC=1;var g=this.height;this.VC=(g!=0.0)?h/g:1.0;} GK( g){g.DB(this);} IL(){if(tP!=null)tP.uB(this);} get EQ{if(FQ){FQ=false;var j=FP+LP;var i=IP+LP;if(j==0.0&&i==0.0){zP.DF(yO,0.0,0.0,DP,nM-tO*yO,rM-xO*DP);}else{var g,l,k,h;var m=VB.cos(j);var o=VB.sin(j);if(j==i){g=yO*m;l=yO*o;k=-DP*o;h=DP*m;}else{g=yO*VB.cos(i);l=yO*VB.sin(i);k=-DP*o;h=DP*m;}var w=nM-(tO*g+xO*k);var t=rM-(tO*l+xO*h);zP.DF(g,l,k,h,w,t);}}return zP;} PG( h){if(h==tP)return EQ.clone();if(h.tP==this)return h.EQ.PH();var j=new AB.TM();var g=this;while (g!=h&&g.tP!=null){j.concat(g.EQ);g=g.tP;}if(h==null&&g!=null){j.concat(g.EQ);g=null;}if(g==h)return j;var k=new AB.TM();var i=h;while (i!=this&&i.tP!=null){k.concat(i.EQ);i=i.tP;}k.eH();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} ZB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new CB.QM();returnRectangle.x=g.gB;returnRectangle.y=g.hB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} RB( g, h){if(ZB(dF).contains(g,h))return this;return null;} iH( h){uP.dH();for(q g=this;g!=null;g=g.tP)uP.concat(g.EQ);return uP.QE(h);} OC( h){uP.dH();for(q g=this;g!=null;g=g.tP)uP.concat(g.EQ);uP.eH();return uP.QE(h);} dispatchEvent( h){var g=null;if(h.qE||h.bubbles){for(q j=tP;j!=null;j=j.tP){if(j.LQ(h.type,h.qE,h.bubbles)){if(g==null)g=hE.vH() as List<q>;g.add(j);}}}if(h.qE&&g!=null){for(int i=g.length-1;i>=0&&h.GF==false;i-- ){g[i].gP(h,this,g[i],AD.kG);}}if(h.GF==false){gP(h,this,this,AD.jE);}if(h.bubbles&&g!=null){for(int i=0;i<g.length&&h.GF==false;i++ ){g[i].gP(h,this,g[i],AD.uI);}}if(g!=null){g.clear();hE.wH(g);}} XQ( h){for(var g=h;g!=null;g=g.tP)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");tP=h;} EB( g);}class KC{static const  GJ="B";static const  KJ="BL";static const  PJ="BR";static const  uG="L";static const  kE="R";static const  RJ="T";static const  TJ="TL";static const  WJ="TR";static const  EH="";} gF( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class DH{var fontStyle;var AE=0;var uE=0;var height=0;DH( j){this.fontStyle=j;var h=new OB.Element.tag("span");h.style.font=this.fontStyle;h.text="Hg";var g=new OB.Element.tag("div");g.style.display="inline-block";g.style.width="1px";g.style.height="0px";var i=new OB.Element.tag("div");i.append(g);i.append(h);OB.document.body.append(i);try {g.style.verticalAlign="baseline";this.AE=g.offsetTop-h.offsetTop;g.style.verticalAlign="bottom";this.height=g.offsetTop-h.offsetTop;this.uE=height-AE;}catch (k){}finally {i.remove();}}}class pC{var matrix;var ID=double.INFINITY;var JD=double.NEGATIVE_INFINITY;var KD=double.INFINITY;var HD=double.NEGATIVE_INFINITY;var XD=double.INFINITY;var YD=double.NEGATIVE_INFINITY;var ZD=double.INFINITY;var WD=double.NEGATIVE_INFINITY;var EE=double.NAN;var FE=double.NAN;pC(this.matrix); get xF=>!EE.isNaN&&!FE.isNaN; get cH=>!ID.isInfinite&&!JD.isInfinite&&!KD.isInfinite&&!HD.isInfinite; get eK=>!XD.isInfinite&&!YD.isInfinite&&!ZD.isInfinite&&!WD.isInfinite;ML(){EE=FE=double.NAN;ID=KD=double.INFINITY;JD=HD=double.NEGATIVE_INFINITY;}kD( h, g){EE=h;FE=g;}yC( h, g,[ transformed=false]){if(xF){h=h.toDouble();g=g.toDouble();var i=transformed?h:h*matrix.a+g*matrix.c+matrix.gB;var j=transformed?g:h*matrix.b+g*matrix.d+matrix.hB;if(ID>i)ID=i;if(JD<i)JD=i;if(KD>j)KD=j;if(HD<j)HD=j;}}stroke( l){if(cH){var g=VB.sqrt(matrix.eC)*l/2;var h=ID-g;var i=JD+g;var j=KD-g;var k=HD+g;if(XD>h)XD=h;if(YD<i)YD=i;if(ZD>j)ZD=j;if(WD<k)WD=k;}}fill(){if(cH){if(XD>ID)XD=ID;if(YD<JD)YD=JD;if(ZD>KD)ZD=KD;if(WD<HD)WD=HD;}} cK(){if(eK){var g=XD.floor();var i=YD.ceil();var h=ZD.floor();var j=WD.ceil();return new CB(g,h,i-g,j-h);}else{return new CB.QM();}}}class hF{static  iF( g){return g;}}class zD{static const  ZF="auto";static const  dJ="stop";static const  GH="once";} gJ( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}class HH{var target=null;var cC=false;var pF=0;var CE=0;var lH,nH;var jH,kH;HH(this.lH,this.nH,this.jH,this.kH);}class nL extends dE{final  wP;nL( i, g, h, j):wP=new CB(i,g,h,j); EB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);h.beginPath();h.rect(wP.x,wP.y,wP.width,wP.height);h.clip();}} qC( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class oB{final  JG;var MG=double.NAN;var NG=double.NAN;oB(this.JG); OG( g){this.NG=g.toDouble();} get gK=>!MG.isNaN&&!NG.isNaN; NQ( g){switch (JG){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.uC;case 'pivotY':return g.vC;case 'scaleX':return g.UC;case 'scaleY':return g.VC;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.vB;case 'alpha':return g.alpha;default:return 0.0;}} dQ( g, h){switch (JG){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.uC=h;break;case 'pivotY':g.vC=h;break;case 'scaleX':g.UC=h;break;case 'scaleY':g.VC=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.vB=h;break;case 'alpha':g.alpha=h;break;}}}class lJ{static var mJ=0;var HF=mJ++ ;var target=null;var CF=false;lJ(this.target,this.CF);}class UD extends nC{var ZP;var HN;var TQ,UQ;var TP,VP;var WQ,YQ;var ZQ;var bQ;var cQ;var qM;var BM=30;var fQ;var gQ;var hQ;var iQ;var jQ;var kQ;var lQ;var mQ;var nQ;var oQ;var pQ;var qQ;var rQ;UD( h, g){LN=h;ZP=g;ZP.focus();HN=g.context2d;TP=TQ=g.width;VP=UQ=g.height;WQ=g.clientWidth;YQ=g.clientHeight;ZQ=new AB.TM();bQ=new AB.TM();cQ=null;qM=new vD();gQ=new fB.RM(HN);hQ=zD.ZF;iQ=uD.vG;jQ=KC.EH;nQ=[new HH(s.oC,s.yD,s.DD,s.sI),new HH(s.UJ,s.ZJ,s.CH,s.CH),new HH(s.eJ,s.iJ,s.FH,s.FH)];kQ=rB.bF;mQ=null;lQ=new FB(0,0);pQ=new s(s.DD,true);zC.QJ.listen(QJ);ZP.onMouseDown.listen(uO);ZP.onMouseUp.listen(uO);ZP.onMouseMove.listen(uO);ZP.onMouseOut.listen(uO);ZP.onMouseWheel.listen(DR);oQ=new Map<int,lJ>();rQ=new SB(SB.lG,true);sG.cJ.listen(ER);ER(null);qQ=new JC(JC.aF,true);ZP.onKeyDown.listen(FR);ZP.onKeyUp.listen(FR);ZP.onKeyPress.listen(GR);} get KG=>cQ; get AG=>qM; get zE=>lQ; get focus=>fQ; get align=>jQ;IR(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){IR();}set y( g){IR();}set uC( g){IR();}set vC( g){IR();}set UC( g){IR();}set VC( g){IR();}set skewX( g){IR();}set skewY( g){IR();}set vB( g){IR();}set alpha( g){IR();}set width( g){IR();}set height( g){IR();}hK( g, h){if(hQ==zD.ZF||hQ==zD.GH){JR();gQ.reset(bQ,g,h);EB(gQ);if(hQ==zD.GH)hQ=zD.dJ;}}JR(){var m=ZP.getBoundingClientRect();var o=ZP.clientLeft+m.left;var t=ZP.clientTop+m.top;var k=ZP.clientWidth;var l=ZP.clientHeight;if(k==0||l==0)return;var g=TQ;var h=UQ;var i=0;var j=0;switch (iQ){case uD.hI:g=TQ;h=UQ;break;case uD.qI:if(k*UQ>l*TQ){h=(TQ*l)~/k;}else{g=(UQ*k)~/l;}break;case uD.yI:g=k;h=l;break;case uD.vG:if(k*UQ>l*TQ){g=(UQ*k)~/l;}else{h=(TQ*l)~/k;}break;}switch (jQ){case KC.GJ:i=(TQ-g+1)~/2;j=(UQ-h);break;case KC.KJ:i=0;j=(UQ-h);break;case KC.PJ:i=(TQ-g);j=(UQ-h);break;case KC.uG:i=0;j=(UQ-h+1)~/2;break;case KC.kE:i=(TQ-g);j=(UQ-h+1)~/2;break;case KC.RJ:i=(TQ-g+1)~/2;j=0;break;case KC.TJ:i=0;j=0;break;case KC.WJ:i=(TQ-g+1);j=0;break;case KC.EH:i=(TQ-g+1)~/2;j=(UQ-h+1)~/2;break;}bQ.DF(1.0,0.0,0.0,1.0,0-i,0-j);ZQ.DF(g/k,0.0,0.0,h/l,i-o,j-t);if(TP!=g||VP!=h){ZP.width=TP=g;ZP.height=VP=h;}if(WQ!=k||YQ!=l){WQ=k;YQ=l;dispatchEvent(new GB(GB.NJ));}}QJ( g){ZP.style.cursor=zC.IH(kQ);}uO( j){j.preventDefault();var o=new DateTime.now().millisecondsSinceEpoch;var w=j.button;var h=null;var i=ZQ.aQ(j.client);var m=null;if(w<0||w>2)return;if(j.type=="mousemove"&&lQ.tF(i))return;var g=nQ[w];lQ=i;if(zC.qG!=null)zC.qG.JQ();if(j.type!="mouseout")h=RB(i.x,i.y) as JB;var l=rB.bF;if(h is ZC&&(h as ZC).SG){l=rB.cF;}if(h is tD&&(h as tD).SG){l=rB.cF;}if(kQ!=l){kQ=l;ZP.style.cursor=zC.IH(l);}if(mQ!=null&&mQ!=h){mQ.dispatchEvent(pQ..WP(s.lE,true)..SQ=(mQ.MD!=null)?mQ.OC(i):new FB.QM()..VQ=i..KQ=g.cC);mQ=null;}if(h!=null&&h!=mQ){h.dispatchEvent(pQ..WP(s.yG,true)..SQ=h.OC(i)..VQ=i..KQ=g.cC);mQ=h;}var k=null;var t=false;var HB=false;if(j.type=="mousedown"){k=g.lH;if(h!=g.target||o>g.pF+500)g.CE=0;g.cC=true;g.target=h;g.pF=o;g.CE++ ;}if(j.type=="mouseup"){k=g.nH;g.cC=false;t=(g.target==h);HB=t&&g.CE.isEven&&(o<g.pF+500);}if(j.type=="mousemove"){k=s.fF;}if(k!=null&&h!=null){m=h.OC(i);h.dispatchEvent(pQ..WP(k,true)..SQ=m..VQ=i..KQ=g.cC..OQ=g.CE);if(t){if(HB&&h.RK){h.dispatchEvent(pQ..WP(g.kH,true)..SQ=m..VQ=i..KQ=g.cC);}else{h.dispatchEvent(pQ..WP(g.jH,true)..SQ=m..VQ=i..KQ=g.cC);}}}}DR( h){var g=ZQ.aQ(h.client);var i=RB(g.x,g.y) as JB;if(i!=null){i.dispatchEvent(pQ..WP(s.zG,true)..SQ=i.OC(g)..VQ=g..PQ=h.deltaX..QQ=h.deltaY);if(pQ.GF)h.preventDefault();}}var UR=[] ;ER( h){UR.forEach((g)=>g.cancel());if(sG.kJ==eG.wI){UR=[ZP.onTouchStart.listen(VR),ZP.onTouchEnd.listen(VR),ZP.onTouchMove.listen(VR),ZP.onTouchEnter.listen(VR),ZP.onTouchLeave.listen(VR),ZP.onTouchCancel.listen(VR)];}}VR( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=ZQ.aQ(m.client);var h=RB(i.x,i.y) as JB;var g=oQ.containsKey(l)?oQ[l]:new lJ(h,oQ.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(rQ..WP(SB.MJ,true)..SQ=(g.target.MD!=null)?g.target.OC(i):new FB.QM()..VQ=i..iP=g.HF..lP=g.CF);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(rQ..WP(SB.IJ,true)..SQ=h.OC(i)..VQ=i..iP=g.HF..lP=g.CF);g.target=h;}var k=null;if(j.type=="touchstart"){oQ[l]=g;k=SB.lG;}if(j.type=="touchend"){oQ.remove(l);k=SB.pG;}if(j.type=="touchcancel"){oQ.remove(l);k=SB.rG;}if(j.type=="touchmove"){k=SB.xG;}if(k!=null&&h!=null){h.dispatchEvent(rQ..WP(k,true)..SQ=h.OC(i)..VQ=i..iP=g.HF..lP=g.CF);}}}FR( g){g.preventDefault();var h=null;if(g.type=="keyup")h=JC.oG;if(g.type=="keydown")h=JC.aF;qQ..WP(h,true)..oO=g.altKey..pO=g.ctrlKey..sO=g.shiftKey..GP=g.charCode..KP=g.keyCode..MP=SD.gI;if(g.keyLocation==OB.KeyLocation.LEFT)qQ.MP=SD.uG;if(g.keyLocation==OB.KeyLocation.RIGHT)qQ.MP=SD.kE;if(g.keyLocation==OB.KeyLocation.NUMPAD)qQ.MP=SD.xI;if(g.keyLocation==OB.KeyLocation.JOYSTICK)qQ.MP=SD.tG;if(g.keyLocation==OB.KeyLocation.MOBILE)qQ.MP=SD.tG;if(fQ!=null)fQ.dispatchEvent(qQ);}GR( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new iG(iG.rI,true);h.IN=new String.fromCharCodes([i]);if(fQ!=null)fQ.dispatchEvent(h);}} JH( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);} rJ( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} sJ(){var g=new OB.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} tJ(){var i=new dB.Completer<bool>();var g=new OB.ImageElement(); h(){i.complete(g.width==2&&g.height==2);}g.onLoad.listen((j)=>h());g.onError.listen((j)=>h());g.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";return i.future;}class nE implements mC{final  sQ;final  uQ;final  vQ=new List<oB>();var wQ;var xQ;var yQ;var zQ;var iN;var UN;var AR;var BR;var CR;nE( g, h,[ transitionFunction]):sQ=g,uQ=(?transitionFunction)?transitionFunction:hF.iF{zQ=new hG(this);UN=0.0;iN=VB.max(0.0001,h);AR=0.0;BR=false;CR=false;} get LH=>zQ; CO( g){if(sQ!=null&&CR==false){vQ.add(g);}} ED( m){if(UN<iN||CR==false){UN=UN+m;if(UN>iN){UN=iN;}if(UN>=0.0){if(CR==false){CR=true;for(int h=0;h<vQ.length;h++ ){var g=vQ[h];g.MG=g.NQ(sQ);}if(wQ!=null){wQ();}}var k=UN/iN;var l=uQ(k).toDouble();for(int h=0;h<vQ.length;h++ ){var g=vQ[h];if(g.gK){var i=g.MG.toDouble();var o=g.NG.toDouble();var j=i+l*(o-i);g.dQ(sQ,BR?j.round():j);}}if(xQ!=null){xQ();}if(yQ!=null&&UN==iN){yQ();}}}return UN<iN;} get currentTime=>UN;}class oL extends IC{oL();EB( g){g.beginPath();}xC( g){g.ML();}}class pL extends IC{pL();EB( g){g.closePath();}}class qL extends IC{var nM,rM;qL( h, g){nM=h.toDouble();rM=g.toDouble();}EB( g){g.moveTo(nM,rM);}xC( g){g.kD(nM,rM);}}var xJ=sJ();var yJ=tJ();class rL extends IC{var nM,rM;rL( h, g){nM=h.toDouble();rM=g.toDouble();}EB( g){g.lineTo(nM,rM);}xC( g){if(g.xF==false){g.kD(nM,rM);}g.yC(g.EE,g.FE);g.yC(nM,rM);g.kD(nM,rM);}} jF( g, m, o, j){m=m.toDouble();o=o.toDouble();var XC=0.0;var pB=0.0;var HB=m*g.a;var iB=m*g.b;var XB=m*g.a+o*g.c;var w=m*g.b+o*g.d;var cB=o*g.c;var t=o*g.d;var h=XC;if(h>HB)h=HB;if(h>XB)h=XB;if(h>cB)h=cB;var i=pB;if(i>iB)i=iB;if(i>w)i=w;if(i>t)i=t;var l=XC;if(l<HB)l=HB;if(l<XB)l=XB;if(l<cB)l=cB;var k=pB;if(k<iB)k=iB;if(k<w)k=w;if(k<t)k=t;if(j==null)j=new CB.QM();j.x=g.gB+h;j.y=g.hB+i;j.width=l-h;j.height=k-i;return j;}class sL extends IC{var nM,rM,MR;var NR,OR;var PR;sL( l, g, j, i, h, k){nM=l.toDouble();rM=g.toDouble();MR=j.toDouble();NR=i.toDouble();OR=h.toDouble();PR=k;}EB( g){g.arc(nM,rM,MR,NR,OR,PR);}xC( g){var j=new lB(MR,0);var t=j.rotate(NR);var m=j.rotate(OR);if(g.xF==false){g.kD(nM+t.x,rM+t.y);}var h=NR;var i=OR;if(PR){if(h<i)h=h+2*VB.PI;}else{if(i<h)i=i+2*VB.PI;}var w=i-h;var l=(w*30).abs()~/VB.PI+1;g.yC(g.EE,g.FE);for(var k=0;k<=l;k++ ){var o=j.rotate(h+k*w/l);g.yC(nM+o.x,rM+o.y);}g.kD(nM+m.x,rM+m.y);}}class tL extends IC{var nM,rM;var yM,NN;tL( i, g, h, j){nM=i.toDouble();rM=g.toDouble();yM=h.toDouble();NN=j.toDouble();}EB( g){g.rect(nM,rM,yM,NN);}xC( g){g.kD(nM,rM);g.yC(nM,rM);g.yC(nM+yM,rM);g.yC(nM+yM,rM+NN);g.yC(nM,rM+NN);}}abstract class BK extends IC{var QR;var RR;var SR;BK( h, i, g){QR=h.toDouble();RR=i;SR=g;} RB( g, h, i){g.lineWidth=QR;g.lineJoin=RR;g.lineCap=SR;try {return g.isPointInStroke(h,i);}catch (j){return false;}}xC( g){g.stroke(QR);}}class uL extends BK{var TR;uL( g, i, j, h):super(i,j,h){TR=g;}EB( g){g.strokeStyle=TR;g.lineWidth=QR;g.lineJoin=RR;g.lineCap=SR;g.stroke();}}abstract class CK extends IC{ RB( g, h, i){return g.isPointInPath(h,i);}xC( g){g.fill();}}class vL extends CK{var TR;vL( g){TR=g;}EB( g){g.fillStyle=TR;g.fill();}}//@ sourceMappingURL=supersonic.dart.map
