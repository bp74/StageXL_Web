import "dart:html" as lC;import "dart:math" as XB;import "dart:web_audio" as MH;import "dart:async" as BC;import "dart:json" as KK;class LK{static const  MK="Chrome";static const  NK="Firefox";static const  OK="Internet Explorer";static const  PK="Safari";final  mI;final  SJ;const LK(this.mI,[this.SJ]);}class QK{final  name;const QK(this.name);}class PC{var x;var y;PC(this.x,this.y);set length( g){this.normalize();this.TJ(g);} get length{return XB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new PC(x,y);} add( g){if(g==null)return null;return new PC(x+g.x,y+g.y);}TJ( g){x*= g;y*= g;} get DF{var g=XB.PI-XB.atan2(this.x,this.y);if(g<0)g+= 2*XB.PI;return g;}set DF( i){var h=this.length;var g=DB.UI(h,i-XB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class aC{var x;var y;var z;aC(this.x,this.y,this.z); clone(){return new aC(x,y,z);} hG(){return XB.sqrt(x*x+y*y+z*z);}wJ( g){this.normalize();this.scale(g);} add( g){return new aC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=hG();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} equals( g){return (g.x==x&&g.y==y&&g.z==z);}}class TB extends aE implements dC{static var hD=588;static var SD=314;static var VH=10.0;var sC;var pB;var FL;var gF;var EC;TB( g,[ autoStart=true, fontName=rD]):super(g){this.EC=fontName;this.width=TB.hD;this.height=TB.SD;this.sC=new fB(m.KB("items").BB("menu_bg"));this.u(this.sC);this.pB=new cC();this.pB.xC=0x000000;this.pB.wordWrap=true;this.pB.UC=new tF(fontName,30,0x000000,wB:true,align:iB.xD);this.pB.width=476;this.pB.height=250;this.pB.x=60;this.pB.y=90;this.u(this.pB);this.addEventListener(s.qC,this.onClick);if(autoStart){this.KH=0;this.gF=0;YB.add(this);}else{this.KH=1;}this.alpha=0;} DD( g){this.gF+= g;if(this.gF>VH){bD();MF();return false;}return true;}set text( g){if(g==null)return;var h=new tF(EC,30,0x000000,wB:true,align:iB.xD);if(g.length<=30)h.size=45;else h.size=30;this.pB.UC=h;this.pB.text=g;} onClick( g){bD();MF();} MF(){this.dispatchEvent(new JB(JB.sB,this));}set KH( g){if(g<0)g=1;if(g>1)g=1;FL=g;var h=(255*FL).round().toInt();} bD(){YB.remove(this);}}class JB extends AB{static const  sB="MenuEvent.TYPE_OK";static const  iD="MenuEvent.TYPE_CANCEL";var LE;JB( h, g,[ bubbles=false]):super(h,bubbles){this.LE=g;}}class OH extends aE{var sC;var YC;var yB;var xB;var KC;var IC;var JC;var font;var iF=30;var TE;OH( h,[ fontName=rD]):super(h){this.font=fontName;this.tC();var g=new StringBuffer();g.add((this.t as qB).bB("GENlevel"));g.add(": 0");xB.text=g.toString();} tC(){this.sC=new fB(m.KB("items").BB("topbar"));this.sC.x=0;this.sC.y=0;this.u(this.sC);this.YC=new cC();this.YC.UC=new tF(font,24,0,wB:true,align:iB.LG);this.YC.xC=0x000000;this.YC.width=400;this.YC.height=100;this.YC.x=20;this.YC.y=iF;this.u(YC);this.yB=new cC();this.yB.UC=new tF(font,24,0,wB:true,align:iB.AE);this.yB.xC=0x000000;this.yB.width=200;this.yB.height=100;this.yB.x=(this.t.IE/2)-this.yB.width+60;this.yB.y=iF;this.u(yB);this.xB=new cC();this.xB.UC=new tF(font,24,0,wB:true,align:iB.AE);this.xB.xC=0x000000;this.xB.width=200;this.xB.height=100;this.xB.x=(this.t.IE)-(this.xB.width)-20;this.xB.y=iF;this.u(xB);this.KC=new cC();this.KC.UC=new tF(font,24,0,wB:true,align:iB.xD);this.KC.xC=0x000000;this.KC.width=200;this.KC.height=100;this.KC.x=20;this.KC.y=this.t.eG-this.KC.height-20;this.u(KC);this.KC.visible=false;this.IC=new fB(m.KB("items").BB("progressbar"));this.IC.x=25;this.IC.y=82;this.u(this.IC);this.JC=new fB(m.KB("items").BB("progressship"));this.JC.x=25;this.JC.y=this.IC.y+(this.IC.height-(this.IC.height-this.JC.height))-(this.JC.height);this.u(this.JC);this.TE=new List<fB>();for(var h=0;h<3;h++ ){var g=new fB(m.KB("items").BB("spaceship"));g.y=10;g.x=(this.t.IE/2)+70+(h*35);this.u(g);this.TE.add(g);}} ZF( g){this.JC.x=25;this.JC.y=this.IC.y+(this.IC.height-((this.IC.height-this.JC.height)*g.t.progress))-(this.JC.height);} XF( i){var h=i.t as qB;if(h.ND){this.yB.text=h.bB("DISPLAY_TRAINING");}else{this.yB.text=h.bB("DISPLAY_LIVES");}for(var g=0;g<this.TE.length;g++ ){this.TE[g].visible=(!h.ND)&&(g<i.t.KD);}} aF( h){var i=h.t as qB;var g=new StringBuffer();g.add(i.bB("GENscore"));g.add(": ${h.t.vJ.toString()}");YC.text=g.toString();} fD( h){var i=h.t as qB;var g=new StringBuffer();g.add(i.bB("GENlevel"));g.add(": ${h.t.level.toString()}");xB.text=g.toString();}}class PH extends TB{var mB;var hC;var ZC;var MC;var VG=40;var WG=30;var EC;PH( g,[ fontName=rD]):super(g,true,fontName){this.EC=fontName;this.removeEventListener(s.pC,this.onClick);this.removeEventListener(s.qC,this.onClick);this.tC();} tC(){var g=this.t as qB;this.pB.wordWrap=true;this.text=g.bB("GENexitquery");this.mB=new vD(new fB(m.KB("items").BB("but_yes")),new fB(m.KB("items").BB("but_yes2")),new fB(m.KB("items").BB("but_yes2")),new fB(m.KB("items").BB("but_yes2")));this.mB.x=WG;this.mB.y=TB.SD-this.mB.height-VG;this.mB.addEventListener(s.pC,this.HK);this.u(this.mB);this.hC=new vD(new fB(m.KB("items").BB("but_no")),new fB(m.KB("items").BB("but_no2")),new fB(m.KB("items").BB("but_no2")),new fB(m.KB("items").BB("but_no2")));this.hC.x=TB.hD-this.hC.width-WG;this.hC.y=TB.SD-this.mB.height-VG;this.hC.addEventListener(s.pC,this.uG);this.u(this.hC);this.ZC=new cC();this.ZC.addEventListener(s.pC,this.mB.dispatchEvent);this.ZC.xC=0x000000;this.ZC.UC=new tF(EC,48,0,wB:true,align:iB.LG);this.ZC.height=60;this.ZC.x=this.mB.x+this.mB.width;this.ZC.y=this.mB.y+5;this.u(this.ZC);this.ZC.text=g.bB("GENyes");this.MC=new cC();this.MC.addEventListener(s.pC,this.hC.dispatchEvent);this.MC.xC=0x000000;this.MC.UC=new tF(EC,48,0,wB:true,align:iB.AE);this.MC.height=60;this.MC.x=this.hC.x-this.MC.width;this.MC.y=this.mB.y+5;this.u(this.MC);this.MC.text=g.bB("GENno");}MF(){uG(null);} HK( g){bD();this.dispatchEvent(new JB(JB.sB,this));} uG( g){bD();this.dispatchEvent(new JB(JB.iD,this));}}class aE extends BD{var vK;aE( g){this.t=g;}set t( g){if(vK!=null){vK.removeEventListener(n.oD,this.PE);vK.removeEventListener(n.pD,this.OE);vK.removeEventListener(n.fE,this.WF);vK.removeEventListener(n.nD,this.QE);vK.removeEventListener(n.lD,this.fD);vK.removeEventListener(n.kD,this.vG);vK.removeEventListener(n.mD,this.aF);vK.removeEventListener(n.RD,this.XF);vK.removeEventListener(n.jD,this.ZF);}vK=g;if(vK!=null){vK.addEventListener(n.oD,this.PE);vK.addEventListener(n.pD,this.OE);vK.addEventListener(n.fE,this.WF);vK.addEventListener(n.nD,this.QE);vK.addEventListener(n.lD,this.fD);vK.addEventListener(n.kD,this.vG);vK.addEventListener(n.mD,this.aF);vK.addEventListener(n.RD,this.XF);vK.addEventListener(n.jD,this.ZF);}} get t{return vK;} PE( g){} OE( g){} WF( g){} QE( g){} fD( g){} vG( g){} aF( g){} XF( g){} ZF( g){}}class qB extends rB{static const  pF=1.0;static const  TH=100;static const  UH=0xFFFFFF;var AK=pF;var FJ=5;var HD;var lG=false;var BH=500;var lI=0xffffff;var nB;var HB;var JD;var GL=true;var ME=false;var fG=60.0;var cD;var EC=rD;var QF=false;var kJ="Web";qB( h, g):super(h,g){this.addEventListener(AB.HG,this.WJ);}set ND( g){GL=g;this.dispatchEvent(new n(n.RD,this));} get ND{return GL;} WJ( g){this.NJ();} onMouseUp( g){ME=false;} onMouseDown( g){ME=true;} NJ(){if(!lG){this.addEventListener(s.zD,this.onMouseUp);this.addEventListener(s.qC,this.onMouseDown);this.mJ();this.addEventListener(n.nD,this.QE);this.addEventListener(n.RD,this.aJ);this.addEventListener(n.jD,this.cJ);this.addEventListener(n.mD,this.dJ);this.addEventListener(n.lD,this.onLevelChange);this.addEventListener(n.kD,this.bJ);this.addEventListener(n.oD,this.PE);this.addEventListener(n.pD,this.OE);this.tC();this.progress=0;this.LD=0;this.KD=3;this.start();lG=true;}} bB( i,[ params=null]){var h=m.JJ(i);if(params!=null)for(int g=0;g<params.length;g++ )h=h.replaceAll("{${g}}",params[g].toString());return h;} mJ(){this.AK=pF;this.lI=UH;this.BH=TH;this.FJ=5;this.fG=60000;} tC(){this.HD=new yC(this);this.u(this.HD);var h=m.KB("items").BB("button_exit");var g=m.KB("items").BB("button_exit_2");this.nB=new vD(new fB(h),new fB(g),new fB(h),new fB(g));this.nB.width=75;this.nB.height=66;this.nB.x=707;this.nB.y=525;this.nB.addEventListener(s.qC,XJ);this.u(this.nB);this.nB.visible=false;this.JD=new OH(this,EC);this.JD.x=0;this.JD.y=0;this.u(this.JD);} tI(){var g=this.FD();g.text=this.bB("MESSAGE_RESTART_LEVEL");g.addEventListener(JB.sB,this.wG);} pI( h){var g=this.FD();g.text=this.bB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.addEventListener(JB.sB,this.wG);} wG( g){this.wC(g.LE);this.HD.nI();} bG(){this.HD.OF();var g=this.FD();if(this.level==0){g.text=this.bB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.bB("MESSAGE_START_LEVEL",[(this.level+1)]);}g.addEventListener(JB.sB,this.fJ);} fJ( g){this.wC(g.LE);this.UJ();} qI(){var g=this.FD();g.text=this.bB("MESSAGE_GAME_OVER");g.addEventListener(JB.sB,this.YJ);} YJ( g){this.wC(g.LE);} FD([ menu=null, tweenDuration=1.0, autoStart=true]){if(this.HB!=null)this.wC(this.HB);this.nB.visible=false;this.JD.visible=true;if(menu==null)this.HB=new TB(this,autoStart,EC);else this.HB=menu;this.HB.width=TB.hD;this.HB.height=TB.SD;this.HB.x=(this.IE/2)-(TB.hD/2)+30;this.HB.y=(this.eG/2)-(TB.SD/2);this.HB.alpha=0;this.u(this.HB);var g=new YI(this.HB,tweenDuration,yE.zE);g.EE("alpha",1);YB.add(g);return this.HB;} wC( g){this.paused=false;this.JD.visible=true;this.nB.visible=true;if(g==null)return;g.bD();if(this.contains(g)){this.oB(g);}this.HB=null;} HJ(){YB.remove(cD);if(this.QF)this.bF(null);this.ME=true;this.ND=false;} eJ(){if(this.HB!=null)return;if(kJ.toLowerCase()=="web")return;YB.remove(cD);this.cD=new pE(this.HJ,this.fG);YB.add(this.cD);this.QF=true;this.paused=true;var g=this.FD(null,200,false);this.nB.visible=true;g.text=this.bB("MESSAGE_FIRST_LEVEL");g.addEventListener(JB.sB,this.bF);} bF( g){YB.remove(this.cD);this.QF=false;HB.removeEventListener(JB.sB,this.bF);this.wC(HB);} XJ( h){if(this.HB is PH)return;var g=new PH(this,EC);this.FD(g);this.paused=true;g.addEventListener(JB.sB,this.VF);g.addEventListener(JB.iD,this.UF);} VF( g){this.dispatchEvent(new n(n.pD,this));HB.removeEventListener(JB.sB,this.VF);HB.removeEventListener(JB.iD,this.UF);this.wC(HB);this.paused=true;} UF( g){HB.removeEventListener(JB.sB,this.VF);HB.removeEventListener(JB.iD,this.UF);this.wC(HB);} QE( g){this.HD.OF();YB.GE(this.bG,0.5);} zI(){this.HD.OF();} cJ( g){} aJ( g){} dJ( g){} onLevelChange( g){} bJ( g){} PE( g){YB.GE(this.qI,2.0);} OE( g){}}class n extends AB{static const  RD="GameEvent.TYPE_LIVES_CHANGED";static const  jD="GameEvent.TYPE_PROGRESS_CHANGED";static const  kD="GameEvent.TYPE_PAUSE_CHANGED";static const  lD="GameEvent.TYPE_LEVEL_CHANGED";static const  mD="GameEvent.TYPE_SCORE_CHANGED";static const  nD="GameEvent.TYPE_GAME_START";static const  oD="GameEvent.TYPE_GAME_OVER";static const  pD="GameEvent.TYPE_GAME_ABORT";static const  fE="GameEvent.TYPE_GAME_SIZE_CHANGED";var t;n( h, g,[ bubbles=false]):super(h,bubbles){this.t=g;}}class OC extends BD{var tK;var xK;var zK;var position;var TC=-1;var zB=0;var yJ=1;var kC=false;var kG=false;var dD=false;var eK=false;var aD=0;var MD=0;var gD=0;OC( g){zK=new BD();u(zK);this.YD=g;if(this.YD==null)return;this.x=100000;}set YD( g){if(tK!=null)this.oB(tK);if(xK!=null)this.oB(xK);tK=null;xK=null;if(g!=null){tK=g;tK.uC=yC.zC/2;tK.vC=yC.zC/2;u(tK);}else{xK=new xF();u(xK);}u(zK);} get YD{return tK;} setScale( g){this.yJ=g;if(xK!=null){xK.NB.clear();xK.NB.beginPath();xK.NB.XG(0,0,yC.zC/2*g);xK.NB.closePath();xK.NB.GH(0xff999999,1);}if(tK!=null)tK.WC=tK.XC=g;zK.WC=zK.XC=g;} JE( j){if(tK==null)return false;var g=this.oG(j);g=tK.jC(g);var k=this.YD.lB.IJ(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new fB(m.KB("items").BB("blood"));h.uC=50;h.vC=50;h.x=g.x-yC.zC/2;h.y=g.y-yC.zC/2;zK.u(h);}return i;}}class NH extends BD{var HC;NH(){HC=new List<OC>();} zJ(){this.HC.sort(IK);} CD( g){if(this.contains(g))return;this.u(g);this.HC.add(g);} rJ( g){if(this.HC.length>0){var h=this.HC.indexOf(g);if(h>=0)this.HC.removeAt(h);}if(this.contains(g))this.oB(g);} IK( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.ID(g)<this.ID(h))this.HH(g,h);return 1;}if(g.position.z<h.position.z){if(this.ID(g)>this.ID(h))this.HH(g,h);return -1;}return 0;}}class yC extends aE{static var nF=0.025;static var cE=1.0;static var zC=600;static var dE=800;static var eE=600;static var qF=400;static var rF=300;static var TD=XB.sqrt(dE*dE+eE*eE);static var XH=(TD*2/zC);static var sF=6;var MB;var OB;var GC;var VC;var fF=30.0*XB.PI/180;var eF=1.0*XB.PI/180;var OD=0.05;var cF=-1;var RE=1;var LB;var gC;var EF=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var FF;var GF;var YG;var oI;var IH;var dF=15;var nG;var GD=false;var FE=0;var NF;var DE;var BF=0.90;var CH=0;var HL;var UK;var VB;var EJ=0;var DC;var ED=false;var SF,TF;var iG;yC( g):super(g){HL=new uF.nK(80,60,690,524);this.mask=HL;this.FF=m.PF("speedalizer");this.GF=this.FF.play(true);this.VB=new xF();this.u(this.VB);iG=new bH(800,600);u(iG);SF=TF=0;CC.addEventListener(s.NG,this.YF);CC.addEventListener(s.qC,this.YF);CC.addEventListener(s.zD,this.YF);} YF( g){SF=g.EH;TF=g.FH;} lJ(){var g=this.t.LD;this.t.LD=g+(this.t as qB).BH*(this.t.level*this.t.KD);} WF( g){} fD( g){super.fD(g);this.BK();} BK(){ED=false;this.removeEventListener(AB.rC,this.NE);this.FE=0;this.t.progress=0;this.GD=false;var h=60;this.VC=new SH(TD,sF*h);for(var g=this.VC.v.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.VC.zG(g);this.MB=new PC(qF,rF);this.OB=new aC(0,0,0);this.GC=new aC(0,0,cE);this.eF=(1+(0.1*this.t.level))*XB.PI/180;this.OD=0.015+(0.004*this.t.level);this.RE=2+this.t.level;this.cF=-this.RE;this.CH=this.t.level*2;this.dF=15+(this.t.level);this.tC();this.rI();this.addEventListener(AB.rC,this.NE);} tC(){if(this.LB!=null)this.oB(this.LB);this.LB=new NH();this.u(this.LB);if(this.DC!=null)this.oB(this.DC);this.DC=new fB(m.KB("items").BB("crosshair"));this.DC.WC=0.5;this.DC.XC=0.5;this.DC.x=(dE/2)-this.DC.width/2;this.DC.y=(eE/2)-this.DC.height/2;this.u(this.DC);} OF(){this.ED=false;this.removeEventListener(AB.rC,this.NE);var h=60;this.VC=new SH(TD,sF*h);for(var g=this.VC.v.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.VC.zG(g);this.MB=new PC(qF,rF);this.OB=new aC(0,0,0);this.GC=new aC(0,0,cE);this.eF=2*XB.PI/180;this.RE=0;this.cF=0;if(this.LB!=null){this.oB(this.LB);this.LB=null;}this.LB=new NH();this.u(this.LB);if(this.gC!=null){this.oB(this.gC);this.gC=null;}this.aG();this.addEventListener(AB.rC,this.NE);} aG(){var g=new OC(null);g.TC=-1;g.zB=0;g.position=this.OB.clone();g.position.z=0.5;this.LB.CD(g);} ZG(){var g=new OC(new fB(m.KB("items").BB("countdown01")));g.TC=0;g.zB=0;g.position=this.OB.clone();g.position.z=0.5;g.aD=0;g.dD=true;this.LB.CD(g);g=new OC(new fB(m.KB("items").BB("countdown02")));g.TC=0;g.zB=0;g.position=this.OB.clone();g.position.z=0;g.aD=1;g.dD=true;this.LB.CD(g);g=new OC(new fB(m.KB("items").BB("countdown03")));g.TC=0;g.zB=0;g.position=this.OB.clone();g.position.z=-0.5;g.aD=2;g.dD=true;this.LB.CD(g);g=new OC(new fB(m.KB("items").BB("countdown04")));g.TC=0;g.zB=0;g.position=this.OB.clone();g.position.z=-1;g.aD=3;g.dD=true;this.LB.CD(g);} sI(){var h=1+this.t.level;if(h>=this.EF.length)h=this.EF.length-1;var i=QD.oF(0,h);var j=this.EF[i];var g=new OC(new fB(m.BB(j)));g.kC=true;g.LC=QD.oF(0,359)*XB.PI/180;g.zB=QD.WH(this.cF,this.RE)*XB.PI/180;g.position=this.OB.clone();return g;} rI(){this.ZG();this.aG();var h=0;for(var i=0;i<dF;i++ ){var g=null;if(i==dF-1){g=new OC(new fB(m.BB("finish")));g.LC=0;g.zB=5*XB.PI/180;g.position=this.OB.clone();g.TC=0;g.kC=true;g.kG=true;this.NF=g;}else{h++ ;if(this.t.level==1&&h<=3){if(h==1){g=new OC(new fB(m.BB("training01")));g.kC=true;g.LC=0;g.zB=0;g.position=this.OB.clone();g.MD=1;}else if(h==2){g=new OC(new fB(m.BB("training02")));g.kC=true;g.LC=135*XB.PI/180;g.zB=0;g.position=this.OB.clone();g.MD=2;}else if(h==3){g=new OC(new fB(m.BB("training02")));g.kC=true;g.LC=315*XB.PI/180;g.zB=0;g.position=this.OB.clone();g.MD=3;}}else{g=this.sI();}}g.gD=-i*1-3;g.position.z=g.gD;g.TC=0;this.LB.CD(g);}} ZJ(){this.GD=false;var g=t as qB;g.zI();g.bG();} NE( h){if(this.t.paused==false){this.oJ();var g=this.t as qB;if(g.ND&&this.ED&&!g.ME)g.eJ();}else{eD=-1;}} JE( h){var g=new DB(this.MB.x,this.MB.y);g=this.oG(g);g=h.jC(g);return h.JE(g);} nI(){this.ED=false;for(var g=0;g<this.LB.HC.length;g++ )this.LB.HC[g].position.z-= (2.5+1-BF)+1;DE.position.z+= (1-BF);this.ZG();this.GD=false;this.OD=this.nG;this.gC.visible=false;} VJ(){var g=this.t as qB;g.nB.visible=false;this.GD=false;this.ED=false;this.nG=this.OD;this.OD=0;if(this.gC!=null)this.oB(this.gC);this.gC=new fB(m.BB("broken"));this.u(this.gC);if(this.DE.MD>0&& ++this.EJ<=5){YB.GE((){g.pI(this.DE.MD);},2.0);}else{this.t.KD-- ;if(this.t.KD>0)YB.GE(g.tI,2.0);}this.GF.stop();this.GF=this.FF.play(true);this.YG=m.PF("crash");this.oI=this.YG.play();}var eD=-1; oJ(){var k=YB.elapsedTime;var h=1.0;if(eD==-1)eD=k;h=XB.min(k-eD,1.0000)*40;eD=k;if(GD){this.FE-= (this.OD*h);var p=this.t.LD;this.t.LD=p+(this.CH*h);}this.LB.zJ();this.fF+= (this.eF*h);this.GC.x=-(this.SF-this.MB.x)*3;this.GC.y=-(this.TF-this.MB.y)*3;if(this.GC.hG()>TD*0.7){this.GC.wJ(TD*0.7);}this.GC.z=cE;this.OB=this.GC.clone();this.OB.z=nF;this.nJ();for(var o=0;o<this.LB.HC.length;o++ ){var g=this.LB.HC[o];g.position.z+= (OD*h);if(g.position.z>=1){if(g.dD&&g.aD==3)ED=true;if(g.YD!=null){this.IH=m.PF("swish");var w=this.IH.play();}if(g.kC)GD=true;if(g.gD!=0)this.FE=g.gD;if(g.kC&&JE(g)){g.position.z=BF;DE=g;this.VJ();}else{if(g.MD==3)(this.t as qB).ND=false;if(g.kC)this.lJ();if(g.kG){this.ZJ();}else if(g.TC==0){this.LB.rJ(g);}else{g.position.z+= g.TC;}}}var i=this.GC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.YE(i);j=j.add(this.MB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.LC+= (g.zB*h);g.setScale(PD(g.position.z)*XH);}}if(this.NF!=null)this.t.progress=(this.FE+3)/(this.NF.gD+3);} YE( g){var h=new PC(g.x,g.y);h.x*= PD(g.z);h.y*= PD(g.z);return h;} PD( g){var h=nF;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} nJ(){if(VB==null)return;var l=2;var j=this.GC.clone();j.scale(l);var h=this.VC.transform(PD(j.z)*l,this.fF,this.YE(j));var i=this.VC.transform(PD(this.OB.z),this.fF,this.YE(this.OB));var k=this.YE(this.OB).add(this.MB);VB.NB.clear();VB.NB.beginPath();VB.NB.XG(k.x,k.y,this.VC.yG*PD(this.OB.z));VB.NB.closePath();VB.NB.GH(0xffcccccc,1);VB.NB.beginPath();for(var g=0;g<h.v.length;g+= 2){VB.NB.moveTo(h.v[g].x+this.MB.x,h.v[g].y+this.MB.y);VB.NB.lineTo(h.v[g+1].x+this.MB.x,h.v[g+1].y+this.MB.y);VB.NB.lineTo(i.v[g+1].x+this.MB.x,i.v[g+1].y+this.MB.y);VB.NB.lineTo(i.v[g].x+this.MB.x,i.v[g].y+this.MB.y);VB.NB.lineTo(h.v[g].x+this.MB.x,h.v[g].y+this.MB.y);}VB.NB.closePath();VB.NB.yI(0xFF000000);}}class QD{static var mF=new XB.Random();static  oF( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=QD.mF.nextInt(h+1)+g;}return i;}static  WH( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=QD.mF.nextDouble()*(h-g)+g;}return i;}}abstract class QH{}class SH extends bE{var sK;var wK;SH( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.sK=h;this.wK=g;uI();} get yG{return sK;} uI(){var g=new List<PC>();var h=0.0;var k=2*XB.PI/wK;for(var j=0;j<wK;j++ ){var i=new PC(0,-sK);i.DF=h;g.add(i);h+= k;}this.v=g;}}abstract class RH{}class bE implements RH,QH{var v;bE([ pointList]){this.v=(pointList!=null)?pointList:new List();}zG( g){if(g<v.length)this.v.removeAt(g);} JE( h){var k=this.v.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(v[g].y<h.y&&v[i].y>=h.y||v[i].y<h.y&&v[g].y>=h.y){if(v[g].x+(h.y-v[g].y)/(v[i].y-v[g].y)*(v[i].x-v[g].x)<h.x){j=!j;}}i=g;}return j;} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.v.length;var i=new List<PC>(j);for(var g=0;g<j;g++ ){var k=this.v[g].clone();k.scale(h);i[g]=k;}return new bE(i);} transform( l, k, o){var j=this.v.length;var i=new List<PC>(j);for(var g=0;g<j;g++ ){var h=this.v[g].clone();h.scale(l);h.DF+= k;i[g]=h.add(o);}return new bE(i);}}class rB extends BD{var uK=0;var yK=0;var AL=true;var BL=3;var CL=0.0;var DL;var EL;rB( h, g){xJ(h,g);} xJ( g, h){DL=g;EL=h;this.dispatchEvent(new n(n.fE,this));} get IE{return DL;} get eG{return EL;} start(){this.paused=false;this.dispatchEvent(new n(n.nD,this));} GJ(){this.dispatchEvent(new n(n.oD,this));}set progress( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;CL=g;this.dispatchEvent(new n(n.jD,this));} get progress{return CL;}set KD( g){if(g<0)g=0;BL=g;this.dispatchEvent(new n(n.RD,this));if(BL==0)this.GJ();} get KD{return BL;}set LD( g){if(g<0)g=0;uK=g;this.dispatchEvent(new n(n.mD,this));} get LD{return uK;} get vJ{return uK.toDouble().round().toInt();}set level( g){if(g<0)g=0;yK=g;this.dispatchEvent(new n(n.lD,this));} get level{return yK;} UJ(){this.level+= 1;return this.level;}set paused( g){AL=g;this.dispatchEvent(new n(n.kD,this));} get paused{return AL;}}var CC;var m;var gE;var YB;var YH;var bC;var qD;var tB;const  rD="Russo One"; main(){CC=new XD("Stage",lC.query('#stage'));gE=new jH();gE.hI(CC);YB=gE.PJ;YH=new XB.Random();var g=UB.UG("images/Loading.png");g.then((h){bC=new fB(h);bC.uC=20;bC.vC=20;bC.x=400;bC.y=270;CC.u(bC);qD=new YI(bC,100,yE.zE);qD.EE("rotation",100.0*2.0*XB.PI);YB.add(qD);tB=new cC();tB.UC=new tF("Arial",20,0xA0A0A0,wB:true);tB.width=240;tB.height=40;tB.text="... loading ...";tB.x=400-tB.EK/2;tB.y=320;tB.sG=false;CC.u(tB);ZH();});} ZH(){m=new lE();m.vB("barrier01","images/barrier01.png");m.vB("barrier02","images/barrier02.png");m.vB("barrier03","images/barrier03.png");m.vB("barrier04","images/barrier04.png");m.vB("barrier05","images/barrier05.png");m.vB("barrier06","images/barrier06.png");m.vB("barrier07","images/barrier07.png");m.vB("training01","images/training01.png");m.vB("training02","images/training02.png");m.vB("finish","images/finish.png");m.vB("broken","images/broken.png");m.iI("items","images/ItemTextureAtlas.json",kE.GG);m.CF("crash","sounds/crash.mp3");m.CF("swish","sounds/swish.mp3");m.CF("speedalizer","sounds/speedalizer.mp3");m.RB("DISPLAY_LEVEL","Level: {0}");m.RB("DISPLAY_LIVES","Ships:");m.RB("DISPLAY_SCORE","Score: {0}");m.RB("DISPLAY_TRAINING","Training");m.RB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");m.RB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");m.RB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");m.RB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");m.RB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");m.RB("MESSAGE_GAME_OVER","Game\nOver!");m.RB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");m.RB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");m.RB("GENscore","Score");m.RB("GENlevel","Level");m.RB("GENexitquery","Do you really want to quit the game?");m.RB("GENyes","Yes");m.RB("GENno","No");m.load().then((h){CC.oB(bC);CC.oB(tB);YB.remove(qD);var g=new qB(800,600);g.jI(CC);g.start();});}class RK extends QC{var ZL;var sL;RK( i, h, g){ZL=h;sL=g;} set UE( g){sL=g;} stop(){}}class nE{static var CG=kB.qE;static var sH=false;static var DI=new jB();static  TG( i){var h=i;var g="auto";if(CG!=kB.qE)h=CG;switch (h){case kB.qE:g="auto";break;case kB.sE:g="default";break;case kB.tE:g="pointer";break;case kB.HI:g="move";break;case kB.II:g="text";break;case kB.LI:g="wait";break;}if(sH)g="none";return g;}}class hH{static const  xH="none";}class kE{static const  pH="json";static const  GG="jsonarray";}class tF{var font;var size;var color;var wB;var mG;var GK;var align;var QJ;var tJ;var MJ;var RF;var letterSpacing=0;var VK=0;var WK=false;var fK=false;tF(this.font,this.size,this.color,{this.wB: false,this.mG: false,this.GK: false,this.align: "left",this.QJ: 0,this.tJ: 0,this.MJ: 0,this.RF: 0});}class oE{var kI;var vI;var height;var RF;var width;var x;oE(this.x,this.width,this.height,this.kI,this.vI,this.RF);}class kB{static const  qE="auto";static const  sE="arrow";static const  tE="button";static const  HI="hand";static const  II="ibeam";static const  LI="wait";}class AG{static const  xH="none";static const  EI="touchPoint";}class vF{var OL;var gL;var vL;var BM;var JM;var PM;var VM;var ZM;var cM;var jM;var oM;vF( g, h){OL=g;gL=h;} get FK=>gL; get name=>OL; get CJ=>vL; get DJ=>BM; get BJ=>JM; get AJ=>PM; get offsetX=>VM; get offsetY=>ZM; get hJ=>cM; get gJ=>jM; get uJ=>oM;}class AD{static const  mH=0;static const  LG=1;static const  AE=2;static const  FI=3;static const  KG=4;}class cC extends ZB{var aL="";var mL=0x000000;var HM=null;var TM=hH.xH;var fM=lH.tH;var IL=gH.nH;var rM=false;var tM=false;var vM=0x000000;var zM=false;var DN=0x000000;var HN=0;var LN=0;var ON;var RN;var TN=true;var UN=100;var WN=100;var ZN=null;var WL=null;cC(){HM=new tF("Arial",12,0x000000);ON=new List<String>();RN=new List<oE>();} get type=>IL; get width=>UN; get height=>WN; set text( g){aL=g;TN=true;} set xC( g){mL=g;TN=true;} set UC( g){HM=g;mL=HM.color;TN=true;} set wordWrap( g){rM=g;TN=true;} set width( g){UN=g;TN=true;} set height( g){WN=g;TN=true;} get EK{aO();return HN;} gB( g,[ returnRectangle]){return AF(g,UN,WN,returnRectangle);} FC( g, h){if(g>=0&&h>=0&&g<UN&&h<WN)return this;return null;} SB( g){aO();g.WL.drawImage(ZN,0.0,0.0);} eO(){ON.clear();RN.clear();if(rM==false){ON.add(aL);}else{var g=new StringBuffer();var i;var h;for(String p in aL.replaceAll('\r','').split('\n')){for(String j in p.split(' ')){i=g.length;g.add((i>0)?" ${j}":j);h=g.toString();if(WL.measureText(h).width>UN){if(i>0)h=h.substring(0,i);else j="";ON.add(h);g.clear();g.add(j);}}if(g.isEmpty==false){ON.add(g.toString());g.clear();}}}HN=0;LN=0;for(String h in ON){var l=WL.measureText(h);var o=0;if(HM.align==iB.xD||HM.align==iB.CI)o=(UN-l.width)/2;if(HM.align==iB.AE||HM.align==iB.vH)o=UN-l.width;var k=new oE(o,l.width,HM.size,0,0,0);RN.add(k);HN=XB.max(HN,k.width);LN=LN+k.height;}} aO(){if(TN){TN=false;var i=UN.ceil().toInt();var j=WN.ceil().toInt();if(ZN==null){ZN=new lC.CanvasElement(width:i,height:j);WL=ZN.context2d;}if(ZN.width!=i)ZN.width=i;if(ZN.height!=j)ZN.height=j;var g=new StringBuffer();g.add(HM.mG?"italic ":"normal ");g.add("normal ");g.add(HM.wB?"bold ":"normal ");g.add("${HM.size}px ");g.add("${HM.font},sans-serif");WL.font=g.toString();WL.textAlign="start";WL.textBaseline="top";WL.fillStyle=VD(mL);eO();if(tM){WL.fillStyle=VD(vM);WL.fillRect(0,0,UN,WN);}else{WL.clearRect(0,0,UN,WN);}var k=0;for(int h=0;h<ON.length;h++ ){var l=RN[h];WL.fillStyle=VD(mL);WL.fillText(ON[h],l.x,k);k+= l.height;}if(zM){WL.strokeStyle=VD(DN);WL.lineWidth=1;WL.strokeRect(0,0,UN,WN);}}}}class lH{static const  tH="pixel";}class pE implements dC{var YL=0.0;var rL=0.0;var CM=1;var OM;pE( g, h){OM=g;rL=XB.max(h,0.0001);} DD( h){var g=YL+h;while (g>=rL&&CM>0){YL=rL;CM-- ;OM();g-= rL;}if(CM==0)return false;YL=g;return true;} get currentTime=>YL;}abstract class dC{ DD( g);}class iE implements dC{var hL;var tL;var EM;iE(){EM=0.0;hL=new List<dC>();tL=0;} get elapsedTime=>EM; add( g){if(g==null)return;if(tL>=hL.length)hL.add(g);else hL[tL]=g;tL++ ;} remove( h){if(h==null)return;for(int g=0;g<tL;g++ )if(hL[g]==h)hL[g]=null;} GE( h, i){var g=new pE(h,i);add(g);return g;} DD( j){EM+= j;var k=tL;var h=0;for(int g=0;g<k;g++ ){var i=hL[g];if(i!=null&&i.DD(j)){if(h!=g)hL[h]=i;h++ ;}}for(int g=k;g<tL;g++ )hL[h++ ]=hL[g];for(int g=h;g<tL;g++ )hL[g]=null;tL=h;return true;}}class uB{var PL;var uL;uB(){PL=new lC.ImageElement();uL=new List<vF>();}static  QI( o, PB){var l=new BC.Completer<uB>();var j=new uB();switch (PB){case kE.pH:case kE.GG: p( k, g){var EB=eI(k);var h=new vF(EB,j);h.vL=g["frame"]["x"].toInt();h.BM=g["frame"]["y"].toInt();h.JM=g["frame"]["w"].toInt();h.PM=g["frame"]["h"].toInt();h.VM=g["spriteSourceSize"]["x"].toInt();h.ZM=g["spriteSourceSize"]["y"].toInt();h.cM=g["sourceSize"]["w"].toInt();h.jM=g["sourceSize"]["h"].toInt();h.oM=g["rotated"] as bool;j.uL.add(h);} hB(CB){var w=KK.parse(CB.target.responseText);var i=w["frames"];var IB=w["meta"];if(i is List)for(var g in i)p(g["filename"],g);if(i is Map)for(String k in i.keys)p(k,i[k]);j.PL..onLoad.listen((WB)=>l.complete(j))..onError.listen((WB)=>l.completeError(new StateError("Failed to load image.")))..src=fI(o,IB["image"]);} NC(CB){l.completeError(new StateError("Failed to load json file."));}var ZE=new lC.HttpRequest()..onLoad.listen(hB)..onError.listen(NC)..open('GET',o,true)..send();break;}return l.future;} get LJ=>PL; BB( i){var h;for(int g=0;g<uL.length&&h==null;g++ )if(uL[g].name==i)h=new UB.rK(uL[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;}static  eI( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}static  fI( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";}}class aH{var name;var AC;var JH;aH(this.name,this.AC,this.JH);}class yF extends QB{yF(){}static  oH( i){var h=new yF();var g=new BC.Completer<QB>();lC.window.setTimeout(()=>g.complete(h),1);return g.future;} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new aB();return new RK(this,loop,soundTransform);}}class DB{var x;var y;DB(this.x,this.y);DB.mK():this(0,0);static  UI( g, h)=>new DB(g*XB.cos(h),-g*XB.sin(h)); get length=>XB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new DB(this.x+g.x,this.y+g.y); clone()=>new DB(this.x,this.y); KF( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class GB{var x;var y;var width;var height;GB(this.x,this.y,this.width,this.height);GB.mK():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new DB(this.width,this.height); set size( g){this.width=g.x;this.height=g.y;} clone()=>new GB(this.x,this.y,this.width,this.height); contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); KF( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;}}class SK extends QC{var nL;var sL;var ZL;var XM;var eM;SK( j, h, i){nL=j;ZL=h;sL=i;var g=sD.CE;XM=g.createGain();XM.connect(g.destination,0,0);XM.gain.value=(sL!=null)?XB.pow(sL.volume,2):1;eM=g.createBufferSource();eM.buffer=nL.bL;eM.loop=h;eM.connect(XM,0,0);eM.start(0);} set UE( g){sL=g;XM.gain.value=(sL!=null)?XB.pow(sL.volume,2):1;} stop(){eM.stop(0);}}class FB{var JL,KL,ML,NL,QL,TL;var dL;FB( g, j, i, h, k, l):JL=g,KL=j,ML=i,NL=h,QL=k,TL=l,dL=g*h-j*i;FB.pK():JL=1.0,KL=0.0,ML=0.0,NL=1.0,QL=0.0,TL=0.0,dL=1.0; clone(){return new FB(JL,KL,ML,NL,QL,TL);} get a=>JL; get b=>KL; get c=>ML; get d=>NL; get cB=>QL; get dB=>TL; get iC=>dL; LH( g){return new DB(g.x*JL+g.y*ML+QL,g.x*KL+g.y*NL+TL);} concat( g){var o=JL;var CB=KL;var EB=ML;var w=NL;var l=QL;var p=TL;var PB=dL;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var WB=g.cB;var IB=g.dB;var hB=g.iC;JL=(o*j+CB*i);KL=(o*k+CB*h);ML=(EB*j+w*i);NL=(EB*k+w*h);QL=(l*j+p*i+WB);TL=(l*k+p*h+IB);dL=(PB*hB);} jG(){JL=1.0;KL=0.0;ML=0.0;NL=1.0;QL=0.0;TL=0.0;dL=1.0;} OJ(){var j=JL;var o=KL;var l=ML;var k=NL;var h=QL;var i=TL;var g=dL;JL=(k/g);KL=-(o/g);ML=-(l/g);NL=(j/g);QL=-(JL*h+ML*i);TL=-(KL*h+NL*i);dL=(1.0/g);} DH( g, j, i, h, k, l){JL=g;KL=j;ML=i;NL=h;QL=k;TL=l;dL=(g*h-j*i);} KF( g){JL=g.a;KL=g.b;ML=g.c;NL=g.d;QL=g.cB;TL=g.dB;dL=g.iC;} LF( h, g){var p=h.a;var EB=h.b;var IB=h.c;var CB=h.d;var o=h.cB;var w=h.dB;var WB=h.iC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var hB=g.cB;var PB=g.dB;var NC=g.iC;JL=(p*k+EB*j);KL=(p*l+EB*i);ML=(IB*k+CB*j);NL=(IB*l+CB*i);QL=(o*k+w*j+hB);TL=(o*l+w*i+PB);dL=(WB*NC);}}class jH{var LL;var cL;var kL;var IM;var UM;jH(){LL=new iE();cL=new List<XD>();kL=double.NAN;IM=wD.rE;UM=new iH(0);lC.window.requestAnimationFrame(IN);} get PJ=>LL; IN( g){lC.window.requestAnimationFrame(IN);if(kL.isNaN)kL=g;if(kL>g)kL=g;var j=g-kL;var i=j/1000.0;if(j>=1){kL=g;UM.VL=i;IM.dispatchEvent(UM);LL.DD(i);for(int h=0;h<cL.length;h++ ){var k=cL[h];k.RJ();}}} hI( g){cL.add(g);}}class eB{var WL;var pL;var DM;var MM;eB.oK( j,[ matrix]){WL=j;pL=new List<FB>.fixedLength(100);DM=new List<double>.fixedLength(100);for(int h=0;h<100;h++ ){pL[h]=new FB.pK();DM[h]=1.0;}MM=0;if(matrix!=null)pL[0].KF(matrix);var g=pL[0];var i=DM[0];WL.setTransform(g.a,g.b,g.c,g.d,g.cB,g.dB);WL.globalAlpha=i;} get context=>WL; reset(){MM=0;var g=pL[0];var h=DM[0];WL.setTransform(g.a,g.b,g.c,g.d,g.cB,g.dB);WL.globalAlpha=h;WL.clearRect(0,0,WL.canvas.width,WL.canvas.height);} AH( h){var i=MM;var j=MM+1;var l=pL[i];var g=pL[j];var o=DM[i];var k=DM[j]=h.uM*o;g.LF(h.AO,l);WL.setTransform(g.a,g.b,g.c,g.d,g.cB,g.dB);WL.globalAlpha=k;MM=j;if(h.mask==null){h.SB(this);}else{WL.save();h.mask.SB(this);h.SB(this);WL.restore();}MM=i;}}class UD{static const  qE="auto";static const  uH="stop";static const  IG="once";}class AB{static const  qH="added";static const  HG="addedToStage";static const  rC="enterFrame";static const  KI="removed";static const  MI="removedFromStage";var IL;var uN;var xN;var CO;var DO;var FO;var HO;AB( g,[ bubbles=false]){XN(g,bubbles);} XN( g,[ bubbles=false]){IL=g;uN=bubbles;xN=mC.yD;CO=null;DO=null;FO=false;HO=false;} get hF=>FO; get CK=>HO; get type=>IL; get eventPhase=>xN; get bubbles=>uN; get HF=>true; get target=>CO;}class mC{static const  DG=1;static const  yD=2;static const  BI=3;}class jB{var iL; KJ( g){return iL!=null&&iL.containsKey(g);} addEventListener( g, h,[ useCapture=false]){SN(g).add(h,useCapture);} removeEventListener( g, h,[ useCapture=false]){SN(g).remove(h,useCapture);} dispatchEvent( g){eN(g,this,this,mC.yD);} eN( g, i, k, j){if(iL!=null){var h=iL[g.type];if(h!=null){g.CO=i;g.DO=k;g.xN=j;g.FO=false;g.HO=false;h.dispatchEvent(g);}}} SN( h){if(iL==null)iL=new Map<String,eC>();var g=iL[h];if(g==null)g=iL[h]=new eC(this,h);return g;}}class cH{var HE;var XE;cH(this.HE,this.XE);}class jE extends QB{var bL;jE(){if(sD.CE==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  oH( CB){var k=new jE();var h=new BC.Completer<QB>();var g=new lC.HttpRequest();var i=null;var j=null; PB(EB){i.cancel();j.cancel(); p( o){k.bL=o;h.complete(k);} IB(WB){h.completeError(new StateError("Failed to decode audio."));}var w=sD.CE;w.decodeAudioData(g.response,p,IB);} l(EB){i.cancel();j.cancel();h.completeError(new StateError("Failed to load audio."));}i=g.onLoad.listen(PB);j=g.onError.listen(l);g.open('GET',QB.SG(CB),true);g.responseType='arraybuffer';g.send();return h.future;} get length{return bL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new aB();return new SK(this,loop,soundTransform);}}class wD{static final rE=new wD();var lM;wD(){lM=new List<eC>();} add( g){lM.add(g);} remove( h){var g=lM.indexOf(h);if(g!=-1)lM[g]=null;} dispatchEvent( j){var k=lM.length;var h=0;for(int g=0;g<k;g++ ){var i=lM[g];if(i!=null){j.CO=i.dG;j.DO=i.dG;j.xN=mC.yD;i.dispatchEvent(j);if(h!=g)lM[h]=i;h++ ;}}for(int g=k;g<lM.length;g++ )lM[h++ ]=lM[g];lM.length=h;}}class iH extends AB{var VL;iH( g):super(AB.rC,false){VL=g;} get HF=>false;}class s extends AB{static const  pC="click";static const  yH="doubleClick";static const  qC="mouseDown";static const  zD="mouseUp";static const  NG="mouseMove";static const  vE="mouseOut";static const  OG="mouseOver";static const  QG="middleClick";static const  TI="middleMouseDown";static const  WI="middleMouseUp";static const  RG="rightClick";static const  XI="rightMouseDown";static const  aI="rightMouseUp";var fN,hN;var iN,kN;var MO;var xM;var KN;var yM;var AN;var QO;var RO;var SO;s( g,[ bubbles=false]):super(g,bubbles){XN(g,bubbles);} XN( g,[ bubbles=false]){super.XN(g,bubbles);fN=hN=0;iN=kN=0;MO=false;xM=false;KN=false;yM=false;AN=false;QO=0;RO=0;SO=0;}set TO( g){fN=g.x;hN=g.y;}set UO( g){iN=g.x;kN=g.y;} get EH=>iN; get FH=>kN; get SC=>MO; get altKey=>xM; get ctrlKey=>yM; get shiftKey=>AN; get ZD=>QO;}class uD extends AB{static const  FG="keyDown";static const  zH="keyUp";var xM;var yM;var AN;var CN;var KN;var MN;var PN;var QN;uD( g,[ bubbles=false]):super(g,bubbles){XN(g,bubbles);} XN( g,[ bubbles=false]){super.XN(g,bubbles);xM=false;yM=false;AN=false;CN=false;KN=false;MN=0;PN=0;QN=0;} get altKey=>xM; get ctrlKey=>yM; get shiftKey=>AN; get charCode=>MN; get keyCode=>PN; get keyLocation=>QN;}class wF extends AB{static const  wH="textInput";var aL="";wF( g,[ bubbles=false]):super(g,bubbles){}}class RC extends AB{static const  EG="touchBegin";static const  AI="touchEnd";static const  GI="touchCancel";static const  JI="touchMove";static const  NI="touchOver";static const  OI="touchOut";var bN;var dN;var fN,hN;var iN,kN;var xM;var KN;var yM;var AN;var oN;var rN;var tN;RC( g,[ bubbles=false]):super(g,bubbles){XN(g,bubbles);} XN( g,[ bubbles=false]){super.XN(g,bubbles);bN=0;dN=false;fN=hN=0;iN=kN=0;xM=false;KN=false;yM=false;AN=false;oN=1.00;rN=0;tN=0;}set TO( g){fN=g.x;hN=g.y;}set UO( g){iN=g.x;kN=g.y;} get WE=>bN; get EH=>iN; get FH=>kN; get altKey=>xM; get ctrlKey=>yM; get shiftKey=>AN;}class tD extends QC{var qL;var fL;var ZL;var sL;tD( g, i, h){qL=g;ZL=i;sL=h;fL=g.GN(this);fL.loop=ZL;this.UE=h;fL.play();} set UE( g){sL=g;if(fL!=null)fL.volume=(sL!=null)?sL.volume:1;} stop(){if(fL!=null){if(fL.ended==false)fL.pause();qL.NO(this);fL=null;}}}class bH extends ZB{var width;var height;bH(this.width,this.height); gB( g,[ returnRectangle]){return AF(g,width,height,returnRectangle);} FC( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} SB( g){}}class gH{static const  nH="dynamic";}abstract class q extends jB implements hE{var zL=0.0;var FM=0.0;var NM=0.0;var SM=0.0;var YM=1.0;var dM=1.0;var iM=0.0;var pM;var qM;var uM=1.0;var wM=true;var OL="";var EN=null;var mask;var VN;var YN;q(){pM=new FB.pK();qM=true;VN=new FB.pK();YN=new FB.pK();} get x=>zL; get y=>FM; get uC=>NM; get vC=>SM; get WC=>YM; get XC=>dM; get LC=>iM; get alpha=>uM; get visible=>wM; get name=>OL; get parent=>EN; get root{var g=this;while (g.EN!=null)g=g.EN;return g;} get VE{var g=this.root;if(g is XD)return g;return null;} set x( g){zL=g;qM=true;} set y( g){FM=g;qM=true;} set uC( g){NM=g;qM=true;} set vC( g){SM=g;qM=true;} set WC( g){YM=g;qM=true;} set XC( g){dM=g;qM=true;} set LC( g){iM=g;qM=true;} set alpha( g){uM=g;qM=true;} set visible( g){wM=g;qM=true;} get width=>gB(AO).width; get height=>gB(AO).height; set width( h){this.WC=1;var g=this.width;this.WC=(g!=0.0)?h/g:1.0;} set height( h){this.XC=1;var g=this.height;this.XC=(g!=0.0)?h/g:1.0;} jI( g){g.u(this);} qJ(){if(EN!=null)EN.oB(this);} get AO{if(qM){qM=false;if(iM==0.0){pM.DH(YM,0.0,0.0,dM,zL-NM*YM,FM-SM*dM);}else{var g=XB.cos(iM);var h=XB.sin(iM);var i=YM*g;var l=YM*h;var k=-dM*h;var j=dM*g;var o=zL-NM*i-SM*k;var p=FM-NM*l-SM*j;pM.DH(i,l,k,j,o,p);}}return pM;} gB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new GB.mK();returnRectangle.x=g.cB;returnRectangle.y=g.dB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} FC( g, h){if(gB(YN).contains(g,h))return this;return null;} oG( h){VN.jG();for(q g=this;g!=null;g=g.EN)VN.concat(g.AO);return VN.LH(h);} jC( h){VN.jG();for(q g=this;g!=null;g=g.EN)VN.concat(g.AO);VN.OJ();return VN.LH(h);} dispatchEvent( h){var g=null;if(h.HF||h.bubbles)for(q j=EN;j!=null;j=j.EN)if(j.KJ(h.type)){if(g==null)g=new List<q>();g.add(j);}if(h.HF&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.hF==false)g[i].eN(h,this,g[i],mC.DG);if(h.hF==false)eN(h,this,this,mC.yD);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.hF==false)g[i].eN(h,this,g[i],mC.BI);} WO( h){for(var g=h;g!=null;g=g.EN)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");EN=h;} SB( g);}abstract class ZB extends q{var wI=false;var sG=true;var lK=true;var tabIndex=0;}abstract class nC extends ZB{var AM;var GM=true;var RM=true;nC(){AM=new List<q>();} u( g){if(g.parent==this){var h=AM.indexOf(g);AM.removeAt(h);AM.add(g);}else{gI(g,AM.length);}} gI( g, h){if(h<0&&h>AM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){AM.removeAt(AM.indexOf(g));if(h>AM.length)h-- ;AM.insertRange(h,1,g);}else{g.qJ();g.WO(this);AM.insertRange(h,1,g);g.dispatchEvent(new AB(AB.qH,true));if(this.VE!=null)XO(g,new AB(AB.HG));}} oB( h){var g=AM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");pJ(g);} pJ( g){if(g<0&&g>=AM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=AM[g];h.dispatchEvent(new AB(AB.KI,true));if(this.VE!=null)XO(h,new AB(AB.MI));h.WO(null);AM.removeAt(g);} gG( g){if(g<0&&g>=AM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return AM[g];} ID( g){return AM.indexOf(g);} HH( j, i){var h=ID(j);var g=ID(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");DK(h,g);} DK( h, g){var j=gG(h);var i=gG(g);AM[h]=i;AM[g]=j;} contains( g){for(;g!=null;g=g.EN)if(g==this)return true;return false;} gB( o,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new GB.mK();if(AM.length==0)return super.gB(o,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var l=double.NEGATIVE_INFINITY;var k=double.NEGATIVE_INFINITY;var p=AM.length;for(int j=0;j<p;j++ ){VN.LF(AM[j].AO,o);var g=AM[j].gB(VN,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>l)l=g.right;if(g.bottom>k)k=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=l-h;returnRectangle.height=k-i;return returnRectangle;} FC( w, CB){var l=null;for(int j=AM.length-1;j>=0;j-- ){var i=AM[j];if(i.visible){var g=i.AO;var o=w-g.cB;var k=CB-g.dB;var EB=(g.d*o-g.c*k)/g.iC;var p=(g.a*k-g.b*o)/g.iC;var h=i.FC(EB,p);if(h!=null){if(h is ZB)if(h.sG)return GM?h:this;l=this;}}}return l;} SB( i){for(int g=0;g<AM.length;g++ ){var h=AM[g];if(h.visible)i.AH(h);}} XO( g, j){g.dispatchEvent(j);if(g is nC){var i=new List<q>.from(g.AM);var k=i.length;for(int h=0;h<k;h++ )XO(i[h],j);}}}class BG{var target=null;var SC=false;var IF=0;var ZD=0;var rG,tG;var pG,qG;BG(this.rG,this.tG,this.pG,this.qG);}class iB{static const  xD="center";static const  vH="end";static const  CI="justify";static const  LG="left";static const  AE="right";}class sD{static var BE;static  get CE{if(BE==null){try {BE=new MH.AudioContext();}catch (g){BE=null;}}return BE;}static var WD;static  get bI{if(WD==null){WD=(CE!=null)?"WebAudioApi":"AudioElement";var g=lC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))WD="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))WD="Mock";}return WD;}}class BD extends nC{var XK=false;var kF=false;}class lE{var UL;var oL;var KM;var WM;var bM;var hM;var mM;lE(){UL=new Map<String,UB>();oL=new Map<String,QB>();KM=new Map<String,uB>();WM=new Map<String,String>();bM=null;hM=0;mM=0;} vB( h, i){var g=UB.UG(i);hM++ ;g.then(( j){UL[h]=j;hM-- ;zN();});g.catchError(( k){mM++ ;hM-- ;zN();});} CF( h, i){var g=QB.oH(i);hM++ ;g.then(( j){oL[h]=j;hM-- ;zN();});g.catchError(( k){mM++ ;hM-- ;zN();});} iI( i, k, h){var g=uB.QI(k,h);hM++ ;g.then(( j){KM[i]=j;hM-- ;zN();});g.catchError(( l){mM++ ;hM-- ;zN();});} RB( h, g){WM[h]=g;} load(){bM=new BC.Completer<lE>();zN();return bM.future;} BB( g){if(UL.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return UL[g];} PF( g){if(oL.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return oL[g];} KB( g){if(KM.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return KM[g];} JJ( g){if(WM.containsKey(g)==false)return "[[${g}]]";return WM[g];}zN(){if(bM!=null&&hM==0){if(mM==0)bM.complete(this);else bM.completeError(new StateError("Error loading resources."));}}}class fB extends q{var lB;var jJ;var JF;fB([this.lB=null,this.jJ="auto"]){JF=null;} gB( h,[ returnRectangle]){var g=(lB!=null)?lB.width:0;var i=(lB!=null)?lB.height:0;return AF(h,g,i,returnRectangle);} FC( g, h){if(lB!=null&&g>=0.0&&h>=0.0&&g<lB.width&&h<lB.height)return this;return null;} SB( g){if(lB!=null){if(JF==null)lB.SB(g);else lB.sJ(g,JF);}}}abstract class hE{ SB( g);}class aB{var volume;var iJ;var gK=1;var hK=0;var kK=1;var jK=0;aB([this.volume=1,this.iJ=0]);}abstract class QC extends jB{ set UE( g); stop();}class xF extends q{var XL;xF(){XL=new zF();} get NB=>XL; gB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new GB.mK();returnRectangle.x=g.cB;returnRectangle.y=g.dB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} FC( g, h){return null;} SB( g){XL.SB(g);}}class vD extends ZB{var jF;var xG;var cG;var KE;var kF=true;var enabled=true;var nM;vD([this.jF,this.xG,this.cG,this.KE]){addEventListener(s.OG,BN);addEventListener(s.vE,BN);addEventListener(s.qC,BN);addEventListener(s.zD,BN);nM=this.jF;} gB( g,[ returnRectangle]){if(nM!=null){VN.LF(nM.AO,g);return nM.gB(VN,returnRectangle);}return super.gB(g,returnRectangle);} FC( k, l){if(this.KE!=null){var g=this.KE.AO;var h=k-g.cB;var i=l-g.dB;var o=(g.d*h-g.c*i)/g.iC;var j=(g.a*i-g.b*h)/g.iC;if(this.KE.FC(o,j)!=null)return this;}return null;} SB( g){if(nM!=null)g.AH(nM);} BN( g){if(g.type==s.vE){nM=jF;}else{nM=g.SC?cG:xG;}}}class zF{var SL;zF(){SL=new List<fH>();}clear()=>SL.clear();beginPath()=>SL.add(new fH("beginPath"));closePath()=>SL.add(new fH("closePath"));moveTo( h, g)=>SL.add(new fH("moveTo",[h,g]));lineTo( h, g)=>SL.add(new fH("lineTo",[h,g]));arcTo( k, i, g, h, j)=>SL.add(new fH("arcTo",[k,i,g,h,j]));quadraticCurveTo( j, i, g, h)=>SL.add(new fH("quadraticCurveTo",[j,i,g,h]));bezierCurveTo( g, h, l, j, i, k)=>SL.add(new fH("bezierCurveTo",[g,h,l,j,i,k]));arc( i, j, h, k, g, l)=>SL.add(new fH("arc",[i,j,h,k,g,l]));rect( i, g, h, j)=>SL.add(new fH("rect",[i,g,h,j]));GH( g,[ width=1, joints=dH.rH, caps=eH.rH])=>SL.add(new fH("strokeColor",[xE(g),width,joints,caps]));yI( g)=>SL.add(new fH("fillColor",[xE(g)]));XG( i, g, h){SL.add(new fH("moveTo",[i+h,g]));SL.add(new fH("arc",[i,g,h,0,XB.PI*2,false]));} SB( k){var h=k.context;h.save();for(var j in SL){var g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].gO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].hO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];FB i=g[0].iO;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.cB,i.dB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].cK(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].dK(h);FB i=g[0].iO;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.cB,i.dB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}class fH{var name;var arguments;fH(this.name,[this.arguments]);}class eH{static const  rH="round";}abstract class QB{static  oH( g){var h=sD.bI;if(h=="WebAudioApi")return jE.oH(g);if(h=="AudioElement")return mE.oH(g);return yF.oH(g);} get length; play([ loop=false, soundTransform]);static var fC;static  SG( g){if(fC==null){fC=new List<String>();var i=new lC.AudioElement();var h=["maybe","probably"];if(h.indexOf(i.canPlayType("audio/ogg",""))!=-1)fC.add("ogg");if(h.indexOf(i.canPlayType("audio/mp3",""))!=-1)fC.add("mp3");if(h.indexOf(i.canPlayType("audio/wav",""))!=-1)fC.add("wav");}var k=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var j=k.firstMatch(g);if(j==null)throw new ArgumentError("Unsupported file extension.");var l=j.group(1).toLowerCase();if(fC.indexOf(l)==-1&&fC.length>0)g="${g.substring(0,g.length-3)}${fC[0]}";return g;}}class uF{var IL;var RL;var jL;var wL;uF.nK( i, g, h, j){IL=0;RL=new GB(i,g,h,j);} SB( i){var g=i.context;g.beginPath();switch (IL){case 0:g.rect(RL.x,RL.y,RL.width,RL.height);break;case 1:g.arc(jL.x,jL.y,jL.yG,0,XB.PI*2.0,false);break;case 2:g.moveTo(wL[0].x,wL[0].y);for(int h=1;h<wL.length;h++ )g.lineTo(wL[h].x,wL[h].y);break;}g.clip();}}class kH{kH();}class mE extends QB{var fL;var xL;var QM;mE(){QM=new List<tD>();fL=new lC.AudioElement();fL.onEnded.listen(sM);xL=new List<lC.AudioElement>();xL.add(fL);lC.document.body.children.add(fL);}static  oH( w){var k=new mE();var g=k.fL;var i=new BC.Completer<QB>();var h;var j;p(o){h.cancel();j.cancel();i.complete(k);}l(o){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(p);j=g.onError.listen(l);g.src=QB.SG(w);g.load();return i.future;} get length{return fL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new aB();return new tD(this,loop,soundTransform);} GN( h){var g;if(xL.length==0){g=fL.clone(true);g.onEnded.listen(sM);}else{g=xL.removeAt(0);}QM.add(h);return g;} NO( g){var h=g.fL;var i=QM.indexOf(g);QM.removeAt(i);xL.add(h);if(fL.currentTime>0&&fL.ended==false)fL.currentTime=0;} sM(j){var i=j.target;var g=null;for(int h=0;h<QM.length&&g==null;h++ )if(QM[h].fL==i)g=QM[h];if(g!=null)g.stop();}}class dH{static const  rH="round";}class UB implements hE{var eL;var lL;var yL;var LM;var WL;var aM;var gM;var kM;var vL;var BM;var JM;var PM;UB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){eL=g;lL=h;yL=transparent;var i=new lC.CanvasElement(width:eL,height:lL);WL=i.context2d;WL.fillStyle=yL?xE(fillColor):VD(fillColor);WL.fillRect(0,0,g,h);LM=i;aM=0;}UB.qK( g){eL=g.naturalWidth;lL=g.naturalHeight;yL=true;LM=g;aM=0;}UB.rK( g){eL=g.hJ;lL=g.gJ;yL=true;LM=g.FK.LJ;aM=g.uJ?2:1;gM=g.offsetX.toDouble();kM=g.offsetY.toDouble();vL=g.CJ.toDouble();BM=g.DJ.toDouble();JM=g.BJ.toDouble();PM=g.AJ.toDouble();}static  UG( i){var h=new BC.Completer<UB>();var g=new lC.ImageElement();g.onLoad.listen((j)=>h.complete(new UB.qK(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>eL; get height=>lL; clone(){var g=new UB(eL,lL,true,0);g.xI(this);return g;} xI( h,[ matrix=null]){var g=fO();var i=new eB.oK(g,matrix);h.SB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} IJ( j, h){var i=fO();var k=i.getImageData(j,h,1,1);var g=k.data;if(dI){return (g[0]<<16)+(g[1]<<8)+(g[2]<<0)+(g[3]<<24);}else{return (g[3]<<16)+(g[2]<<8)+(g[1]<<0)+(g[0]<<24);}} SB( g){switch (aM){case 0:g.context.drawImage(LM,0.0,0.0);break;case 1:g.context.drawImage(LM,vL,BM,JM,PM,gM,kM,JM,PM);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,gM,kM+PM);g.context.drawImage(LM,vL,BM,PM,JM,0.0,0.0,PM,JM);break;}} sJ( WB, g){if(g.width<=0.0||g.height<=0.0)return;switch (aM){case 0:WB.context.drawImage(LM,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=vL;double h=BM;double CB=j+JM;double EB=h+PM;double l=vL-gM+g.x;double o=BM-kM+g.y;double PB=l+g.width;double IB=o+g.height;double w=(j>l)?j:l;double p=(h>o)?h:o;double hB=(CB<PB)?CB:PB;double lF=(EB<IB)?EB:IB;double ZE=gM-j+w;double NC=kM-h+p;double k=hB-w;double i=lF-p;if(k>0.0&&i>0.0){WB.context.drawImage(LM,w,p,k,i,ZE,NC,k,i);}break;case 2:double j=vL;double h=BM;double CB=j+PM;double EB=h+JM;double l=vL+kM-g.y+PM-g.height;double o=BM-gM+g.x;double PB=l+g.height;double IB=o+g.width;double w=(j>l)?j:l;double p=(h>o)?h:o;double hB=(CB<PB)?CB:PB;double lF=(EB<IB)?EB:IB;double ZE=gM-h+p;double NC=kM+CB-hB;double k=lF-p;double i=hB-w;if(k>0.0&&i>0.0){WB.context.transform(0.0,-1.0,1.0,0.0,ZE,NC+i);WB.context.drawImage(LM,w,p,i,k,0.0,0.0,i,k);}break;}} fO(){if(WL==null){var g=new lC.CanvasElement(width:eL,height:lL);WL=g.context2d;switch (aM){case 0:WL.drawImage(LM,0,0);break;case 1:WL.drawImage(LM,vL,BM,JM,PM,gM,kM,JM,PM);break;case 2:WL.setTransform(0.0,-1.0,1.0,0.0,gM,kM+PM);WL.drawImage(LM,vL,BM,PM,JM,0.0,0.0,PM,JM);WL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}LM=g;aM=0;}return WL;}}typedef  oC(event); VD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class JG{static var MG=false;static var uE=false;static var wE=0;static var SI=AG.xH;static var DI=new jB();static VI(){if(MG==false){MG=true;var g=lC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){uE=true;wE=10;}if(g.contains("Android")){uE=true;wE=10;}if(g.contains("IEMobile")){uE=true;wE=10;}}}static  get cI{VI();return SI;}}class eC{var DI;var JN;var NN;eC( h, g){DI=h;JN=g;NN=new List<cH>();} get dG=>DI; add( h,[ useCapture=false]){for(int g=0;g<NN.length;g++ )if(NN[g].HE==h&&NN[g].XE==useCapture)return;if(JN==AB.rC&&NN.length==0)wD.rE.add(this);NN.add(new cH(h,useCapture));} remove( h,[ useCapture=false]){for(int g=0;g<NN.length;g++ ){if(NN[g].HE==h&&NN[g].XE==useCapture){NN=new List<cH>.from(NN);NN.removeAt(g);if(JN==AB.rC&&NN.length==0)wD.rE.remove(this);break;}}} operator+( g){this.add(g,false);} operator-( g){this.remove(g,false);} dispatchEvent( h){for(int g=0;g<NN.length;g++ )if(h.eventPhase!=mC.DG||NN[g].XE)if(h.CK==false)NN[g].HE(h);}}class PG{static var RI=0;var WE=RI++ ;var target=null;var SE=false;PG(this.target,this.SE);} xE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class yE{static  zE( g){return g;}}class YI implements dC{var aN;var cN;var gN;var jN;var lN;var mN;var rL;var YL;var pN;var sN;var wN;YI( g, h,[ transitionFunction( ratio)]){aN=g;cN=(transitionFunction!=null)?transitionFunction:yE.zE;YL=0.0;rL=XB.max(0.0001,h);pN=0.0;sN=false;wN=false;gN=new List<aH>();} EE( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(aN!=null&&wN==false)gN.add(new aH(g,0.0,h));} moveTo( h, g){EE('x',h);EE('y',g);} DD( l){if(YL<rL||wN==false){YL=YL+l;if(YL>rL)YL=rL;if(YL>=0.0){if(wN==false){wN=true;for(int i=0;i<gN.length;i++ ){var g=gN[i];switch (g.name){case 'x':g.AC=aN.x;break;case 'y':g.AC=aN.y;break;case 'pivotX':g.AC=aN.uC;break;case 'pivotY':g.AC=aN.vC;break;case 'scaleX':g.AC=aN.WC;break;case 'scaleY':g.AC=aN.XC;break;case 'rotation':g.AC=aN.LC;break;case 'alpha':g.AC=aN.alpha;break;}}if(jN!=null)jN();}var j=YL/rL;var k=cN(j);for(int i=0;i<gN.length;i++ ){var g=gN[i];var h=g.AC+k*(g.JH-g.AC);h=sN?h.round():h;switch (g.name){case 'x':aN.x=h;break;case 'y':aN.y=h;break;case 'pivotX':aN.uC=h;break;case 'pivotY':aN.vC=h;break;case 'scaleX':aN.WC=h;break;case 'scaleY':aN.XC=h;break;case 'rotation':aN.LC=h;break;case 'alpha':aN.alpha=h;break;}}if(lN!=null)lN();if(mN!=null&&YL==rL)mN();}}return YL<rL;} get currentTime=>YL;} ZI(){var g=new lC.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;}class XD extends nC{var ZN;var WL;var nN;var qN;var vN;var yN;var BO;var EO;var GO;var IO;var JO;var KO;var LO;var OO;var PO;XD( h, g){OL=h;ZN=g;ZN.focus();WL=g.context2d;qN=new eB.oK(WL);vN=UD.qE;yN=kB.sE;nE.DI.addEventListener("mouseCursorChanged",VO);GO=[new BG(s.qC,s.zD,s.pC,s.yH),new BG(s.TI,s.WI,s.QG,s.QG),new BG(s.XI,s.aI,s.RG,s.RG)];EO=null;BO=new DB(0,0);JO=new s(s.pC,true);OO=BN;ZN.onMouseDown.listen(OO);ZN.onMouseUp.listen(OO);ZN.onMouseMove.listen(OO);ZN.onMouseOut.listen(OO);ZN.onMouseWheel.listen(OO);IO=new Map<int,PG>();LO=new RC(RC.EG,true);PO=YO;JG.DI.addEventListener("inputModeChanged",ZO);ZO(null);KO=new uD(uD.FG,true);ZN.onKeyDown.listen(bO);ZN.onKeyUp.listen(bO);ZN.onKeyPress.listen(cO);} get focus=>nN; dO(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){dO();} set y( g){dO();} set uC( g){dO();} set vC( g){dO();} set WC( g){dO();} set XC( g){dO();} set LC( g){dO();} set alpha( g){dO();} set width( g){dO();} set height( g){dO();} RJ(){if(vN==UD.qE||vN==UD.IG){qN.reset();SB(qN);if(vN==UD.IG)vN=UD.uH;}} VO( g){ZN.style.cursor=nE.TG(yN);} BN( j){j.preventDefault();var IB=ZN.getBoundingClientRect();var p=new Date.now().millisecondsSinceEpoch;var CB=j.button;var h=null;var i=new DB(j.clientX-IB.left,j.clientY-IB.top);var o=null;if(CB<0||CB>2)return;if(j.type=="mousemove"&&BO.equals(i))return;var g=GO[CB];BO=i;if(j.type!="mouseout")h=FC(i.x,i.y) as ZB;var k=kB.sE;if(h is BD)if(h.kF)k=kB.tE;if(h is vD)if(h.kF)k=kB.tE;if(yN!=k){yN=k;ZN.style.cursor=nE.TG(k);}if(EO!=null&&EO!=h){EO.dispatchEvent(JO..XN(s.vE,true)..TO=(EO.VE!=null)?EO.jC(i):new DB.mK()..UO=i..MO=g.SC);EO=null;}if(h!=null&&h!=EO){h.dispatchEvent(JO..XN(s.OG,true)..TO=h.jC(i)..UO=i..MO=g.SC);EO=h;}var l=null;var w=false;var EB=false;if(j.type=="mousedown"){l=g.rG;if(h!=g.target||p>g.IF+500)g.ZD=0;g.SC=true;g.target=h;g.IF=p;g.ZD++ ;}if(j.type=="mouseup"){l=g.tG;g.SC=false;w=(g.target==h);EB=w&&g.ZD.isEven&&(p<g.IF+500);}if(j.type=="mousemove"){l=s.NG;}if(l!=null&&h!=null){o=h.jC(i);h.dispatchEvent(JO..XN(l,true)..TO=o..UO=i..MO=g.SC..QO=g.ZD);if(w){if(EB&&h.wI){h.dispatchEvent(JO..XN(g.qG,true)..TO=o..UO=i..MO=g.SC);}else{h.dispatchEvent(JO..XN(g.pG,true)..TO=o..UO=i..MO=g.SC);}}}}var jO=[] ; ZO( h){jO.forEach((g)=>g.cancel());if(JG.cI==AG.EI){jO=[ZN.onTouchStart.listen(PO),ZN.onTouchEnd.listen(PO),ZN.onTouchMove.listen(PO),ZN.onTouchEnter.listen(PO),ZN.onTouchLeave.listen(PO),ZN.onTouchCancel.listen(PO)];}} YO( j){j.preventDefault();var p=ZN.getBoundingClientRect();for(var o in j.changedTouches){var l=o.identifier;var h=null;var i=new DB(o.clientX-p.left,o.clientY-p.top);var w=null;h=FC(i.x,i.y) as ZB;var g=IO.containsKey(l)?IO[l]:new PG(h,IO.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(LO..XN(RC.OI,true)..TO=(g.target.VE!=null)?g.target.jC(i):new DB.mK()..UO=i..bN=g.WE..dN=g.SE);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(LO..XN(RC.NI,true)..TO=h.jC(i)..UO=i..bN=g.WE..dN=g.SE);g.target=h;}var k=null;if(j.type=="touchstart"){IO[l]=g;k=RC.EG;}if(j.type=="touchend"){IO.remove(l);k=RC.AI;}if(j.type=="touchcancel"){IO.remove(l);k=RC.GI;}if(j.type=="touchmove"){k=RC.JI;}if(k!=null&&h!=null){h.dispatchEvent(LO..XN(k,true)..TO=h.jC(i)..UO=i..bN=g.WE..dN=g.SE);}}} bO( g){g.preventDefault();var h=null;if(g.type=="keyup")h=uD.zH;if(g.type=="keydown")h=uD.FG;KO..XN(h,true)..xM=g.altKey..yM=g.ctrlKey..AN=g.shiftKey..MN=g.charCode..PN=g.keyCode..QN=AD.mH;if(g.keyLocation==lC.KeyLocation.LEFT)KO.QN=AD.LG;if(g.keyLocation==lC.KeyLocation.RIGHT)KO.QN=AD.AE;if(g.keyLocation==lC.KeyLocation.NUMPAD)KO.QN=AD.FI;if(g.keyLocation==lC.KeyLocation.JOYSTICK)KO.QN=AD.KG;if(g.keyLocation==lC.KeyLocation.MOBILE)KO.QN=AD.KG;if(nN!=null)nN.dispatchEvent(KO);} cO( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new wF(wF.wH,true);h.aL=new String.fromCharCodes([i]);if(nN!=null)nN.dispatchEvent(h);}} AF( g, o, EB, j){var NC=0.0;var hB=0.0;var CB=o*g.a;var WB=o*g.b;var IB=o*g.a+EB*g.c;var w=o*g.b+EB*g.d;var PB=EB*g.c;var p=EB*g.d;var h=NC;if(h>CB)h=CB;if(h>IB)h=IB;if(h>PB)h=PB;var i=hB;if(i>WB)i=WB;if(i>w)i=w;if(i>p)i=p;var l=NC;if(l<CB)l=CB;if(l<IB)l=IB;if(l<PB)l=PB;var k=hB;if(k<WB)k=WB;if(k<w)k=w;if(k<p)k=p;if(j==null)j=new GB.mK();j.x=g.cB+h;j.y=g.dB+i;j.width=l-h;j.height=k-i;return j;}var dI=ZI();
//@ sourceMappingURL=supersonic.dart.map