import "dart:web_audio" as QH;import "dart:json" as dK;import "dart:async" as YB;import "dart:math" as ZB;import "dart:html" as xC;class eK{static const  fK="Chrome";static const  gK="Firefox";static const  hK="Internet Explorer";static const  iK="Safari";final  CJ;final  iJ;const eK(this.CJ,[this.iJ]);}class jK{final  name;const jK(this.name);}class o extends BB{static const  RD="GameEvent.TYPE_LIVES_CHANGED";static const  pD="GameEvent.TYPE_PROGRESS_CHANGED";static const  qD="GameEvent.TYPE_PAUSE_CHANGED";static const  rD="GameEvent.TYPE_LEVEL_CHANGED";static const  sD="GameEvent.TYPE_SCORE_CHANGED";static const  tD="GameEvent.TYPE_GAME_START";static const  uD="GameEvent.TYPE_GAME_OVER";static const  vD="GameEvent.TYPE_GAME_ABORT";static const  fE="GameEvent.TYPE_GAME_SIZE_CHANGED";var u;o( h, g,[ bubbles=false]):super(h,bubbles){this.u=g;}}class QC{var x;var y;QC(this.x,this.y);set length( g){this.normalize();this.jJ(g);} get length{return ZB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new QC(x,y);} add( g){if(g==null)return null;return new QC(x+g.x,y+g.y);}jJ( g){x*= g;y*= g;} get CF{var g=ZB.PI-ZB.atan2(this.x,this.y);if(g<0)g+= 2*ZB.PI;return g;}set CF( i){var h=this.length;var g=DB.YI(h,i-ZB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class dC{var x;var y;var z;dC(this.x,this.y,this.z); clone(){return new dC(x,y,z);} hG(){return ZB.sqrt(x*x+y*y+z*z);}QK( g){this.normalize();this.scale(g);} add( g){return new dC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=hG();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} equals( g){return (g.x==x&&g.y==y&&g.z==z);}}class UB extends aE implements pC{static var nD=588;static var SD=314;static var ZH=10.0;var rC;var rB;var YL;var bF;var IC;UB( g,[ autoStart=true, fontName=xD]):super(g){this.IC=fontName;this.width=UB.nD;this.height=UB.SD;this.rC=new iB(m.LB("items").CB("menu_bg"));this.v(this.rC);this.rB=new fC();this.rB.wC=0x000000;this.rB.wordWrap=true;this.rB.WC=new tF(fontName,30,0x000000,zB:true,align:lB.DE);this.rB.width=476;this.rB.height=250;this.rB.x=60;this.rB.y=90;this.v(this.rB);this.t(p.hC,this.onClick);if(autoStart){this.OH=0;this.bF=0;aB.add(this);}else{this.OH=1;}this.alpha=0;} DD( g){this.bF+= g;if(this.bF>ZH){fD();LF();return false;}return true;}set text( g){if(g==null)return;var h=new tF(IC,30,0x000000,zB:true,align:lB.DE);if(g.length<=30)h.size=45;else h.size=30;this.rB.WC=h;this.rB.text=g;} onClick( g){fD();LF();} LF(){this.dispatchEvent(new KB(KB.vB,this));}set OH( g){if(g<0)g=1;if(g>1)g=1;YL=g;var h=(255*YL).round().toInt();} fD(){aB.remove(this);}}class KB extends BB{static const  vB="MenuEvent.TYPE_OK";static const  oD="MenuEvent.TYPE_CANCEL";var PE;KB( h, g,[ bubbles=false]):super(h,bubbles){this.PE=g;}}class SH extends aE{var rC;var bC;var CC;var BC;var NC;var LC;var MC;var font;var cF=30;var UE;SH( h,[ fontName=xD]):super(h){this.font=fontName;this.sC();var g=new StringBuffer();g.write((this.u as tB).eB("GENlevel"));g.write(": 0");BC.text=g.toString();} sC(){this.rC=new iB(m.LB("items").CB("topbar"));this.rC.x=0;this.rC.y=0;this.v(this.rC);this.bC=new fC();this.bC.WC=new tF(font,24,0,zB:true,align:lB.JG);this.bC.wC=0x000000;this.bC.width=400;this.bC.height=100;this.bC.x=20;this.bC.y=cF;this.v(bC);this.CC=new fC();this.CC.WC=new tF(font,24,0,zB:true,align:lB.FE);this.CC.wC=0x000000;this.CC.width=200;this.CC.height=100;this.CC.x=(this.u.ME/2)-this.CC.width+60;this.CC.y=cF;this.v(CC);this.BC=new fC();this.BC.WC=new tF(font,24,0,zB:true,align:lB.FE);this.BC.wC=0x000000;this.BC.width=200;this.BC.height=100;this.BC.x=(this.u.ME)-(this.BC.width)-20;this.BC.y=cF;this.v(BC);this.NC=new fC();this.NC.WC=new tF(font,24,0,zB:true,align:lB.DE);this.NC.wC=0x000000;this.NC.width=200;this.NC.height=100;this.NC.x=20;this.NC.y=this.u.eG-this.NC.height-20;this.v(NC);this.NC.visible=false;this.LC=new iB(m.LB("items").CB("progressbar"));this.LC.x=25;this.LC.y=82;this.v(this.LC);this.MC=new iB(m.LB("items").CB("progressship"));this.MC.x=25;this.MC.y=this.LC.y+(this.LC.height-(this.LC.height-this.MC.height))-(this.MC.height);this.v(this.MC);this.UE=new List<iB>();for(var h=0;h<3;h++ ){var g=new iB(m.LB("items").CB("spaceship"));g.y=10;g.x=(this.u.ME/2)+70+(h*35);this.v(g);this.UE.add(g);}} xG( g){this.MC.x=25;this.MC.y=this.LC.y+(this.LC.height-((this.LC.height-this.MC.height)*g.u.lD))-(this.MC.height);} wG( i){var h=i.u as tB;if(h.ND){this.CC.text=h.eB("DISPLAY_TRAINING");}else{this.CC.text=h.eB("DISPLAY_LIVES");}for(var g=0;g<this.UE.length;g++ ){this.UE[g].visible=(!h.ND)&&(g<i.u.KD);}} zG( h){var i=h.u as tB;var g=new StringBuffer();g.write(i.eB("GENscore"));g.write(": ${h.u.PK.toString()}");bC.text=g.toString();} RE( h){var i=h.u as tB;var g=new StringBuffer();g.write(i.eB("GENlevel"));g.write(": ${h.u.level.toString()}");BC.text=g.toString();}}class RH extends UB{var oB;var jC;var cC;var PC;var VG=40;var WG=30;var IC;RH( g,[ fontName=xD]):super(g,true,fontName){this.IC=fontName;this.VB(p.qC);this.VB(p.hC);this.sC();} sC(){var g=this.u as tB;this.rB.wordWrap=true;this.text=g.eB("GENexitquery");this.oB=new zD(new iB(m.LB("items").CB("but_yes")),new iB(m.LB("items").CB("but_yes2")),new iB(m.LB("items").CB("but_yes2")),new iB(m.LB("items").CB("but_yes2")));this.oB.x=WG;this.oB.y=UB.SD-this.oB.height-VG;this.oB.t(p.qC,this.aK);this.v(this.oB);this.jC=new zD(new iB(m.LB("items").CB("but_no")),new iB(m.LB("items").CB("but_no2")),new iB(m.LB("items").CB("but_no2")),new iB(m.LB("items").CB("but_no2")));this.jC.x=UB.nD-this.jC.width-WG;this.jC.y=UB.SD-this.oB.height-VG;this.jC.t(p.qC,this.uG);this.v(this.jC);this.cC=new fC();this.cC.t(p.qC,this.oB.dispatchEvent);this.cC.wC=0x000000;this.cC.WC=new tF(IC,48,0,zB:true,align:lB.JG);this.cC.height=60;this.cC.x=this.oB.x+this.oB.width;this.cC.y=this.oB.y+5;this.v(this.cC);this.cC.text=g.eB("GENyes");this.PC=new fC();this.PC.t(p.qC,this.jC.dispatchEvent);this.PC.wC=0x000000;this.PC.WC=new tF(IC,48,0,zB:true,align:lB.FE);this.PC.height=60;this.PC.x=this.jC.x-this.PC.width;this.PC.y=this.oB.y+5;this.v(this.PC);this.PC.text=g.eB("GENno");}LF(){uG(null);} aK( g){fD();this.dispatchEvent(new KB(KB.vB,this));} uG( g){fD();this.dispatchEvent(new KB(KB.oD,this));}}class aE extends AD{var OL;aE( g){this.u=g;}set u( g){if(OL!=null){OL.VB(o.uD);OL.VB(o.vD);OL.VB(o.fE);OL.VB(o.tD);OL.VB(o.rD);OL.VB(o.qD);OL.VB(o.sD);OL.VB(o.RD);OL.VB(o.pD);}OL=g;if(OL!=null){OL.t(o.uD,this.UF);OL.t(o.vD,this.TF);OL.t(o.fE,this.vG);OL.t(o.tD,this.VF);OL.t(o.rD,this.RE);OL.t(o.qD,this.uJ);OL.t(o.sD,this.zG);OL.t(o.RD,this.wG);OL.t(o.pD,this.xG);}} get u{return OL;} UF( g){} TF( g){} vG( g){} VF( g){} RE( g){} uJ( g){} zG( g){} wG( g){} xG( g){}}class tB extends uB{static const  kF=1.0;static const  XH=100;static const  YH=0xFFFFFF;var UK=kF;var VJ=5;var HD;var lG=false;var FH=500;var BJ=0xffffff;var pB;var IB;var JD;var ZL=true;var QE=false;var fG=60.0;var gD;var IC=xD;var PF=false;var EK="Web";tB( h, g):super(h,g){this.t(BB.CG,(i){this.dJ();});}set ND( g){ZL=g;this.dispatchEvent(new o(o.RD,this));} get ND{return ZL;} dJ(){if(!lG){this.t(p.aD,(g)=>this.QE=false);this.t(p.hC,(g)=>this.QE=true);this.GK();this.t(o.tD,this.VF);this.t(o.RD,this.sJ);this.t(o.pD,this.vJ);this.t(o.sD,this.wJ);this.t(o.rD,this.onLevelChange);this.t(o.qD,this.tJ);this.t(o.uD,this.UF);this.t(o.vD,this.TF);this.sC();this.lD=0;this.LD=0;this.KD=3;this.start();lG=true;}} eB( i,[ params=null]){var h=m.ZJ(i);if(params!=null)for(int g=0;g<params.length;g++ )h=h.replaceAll("{${g}}",params[g].toString());return h;} GK(){this.UK=kF;this.BJ=YH;this.FH=XH;this.VJ=5;this.fG=60000;} sC(){this.HD=new yC(this);this.v(this.HD);var h=m.LB("items").CB("button_exit");var g=m.LB("items").CB("button_exit_2");this.pB=new zD(new iB(h),new iB(g),new iB(h),new iB(g));this.pB.width=75;this.pB.height=66;this.pB.x=707;this.pB.y=525;this.pB.t(p.hC,pJ);this.v(this.pB);this.pB.visible=false;this.JD=new SH(this,IC);this.JD.x=0;this.JD.y=0;this.v(this.JD);} JJ(){var g=this.FD();g.text=this.eB("MESSAGE_RESTART_LEVEL");g.t(KB.vB,this.yG);} FJ( h){var g=this.FD();g.text=this.eB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.t(KB.vB,this.yG);} yG( g){this.vC(g.PE);this.HD.DJ();} bG(){this.HD.NF();var g=this.FD();if(this.level==0){g.text=this.eB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.eB("MESSAGE_START_LEVEL",[(this.level+1)]);}g.t(KB.vB,this.yJ);} yJ( g){this.vC(g.PE);this.kJ();} GJ(){var g=this.FD();g.text=this.eB("MESSAGE_GAME_OVER");g.t(KB.vB,this.qJ);} qJ( g){this.vC(g.PE);} FD([ menu=null, tweenDuration=1.0, autoStart=true]){if(this.IB!=null)this.vC(this.IB);this.pB.visible=false;this.JD.visible=true;if(menu==null)this.IB=new UB(this,autoStart,IC);else this.IB=menu;this.IB.width=UB.nD;this.IB.height=UB.SD;this.IB.x=(this.ME/2)-(UB.nD/2)+30;this.IB.y=(this.eG/2)-(UB.SD/2);this.IB.alpha=0;this.v(this.IB);var g=new eI(this.IB,tweenDuration,xE.yE);g.JE("alpha",1);aB.add(g);return this.IB;} vC( g){this.paused=false;this.JD.visible=true;this.pB.visible=true;if(g==null)return;g.fD();if(this.contains(g)){this.qB(g);}this.IB=null;} XJ(){aB.remove(gD);if(this.PF)this.AH(null);this.QE=true;this.ND=false;} xJ(){if(this.IB!=null)return;if(EK.toLowerCase()=="web")return;aB.remove(gD);this.gD=new hE(this.XJ,this.fG);aB.add(this.gD);this.PF=true;this.paused=true;var g=this.FD(null,200,false);this.pB.visible=true;g.text=this.eB("MESSAGE_FIRST_LEVEL");g.t(KB.vB,this.AH);} AH( g){aB.remove(this.gD);this.PF=false;this.IB.VB(KB.vB);this.vC(this.IB);} pJ( h){if(this.IB is RH)return;var g=new RH(this,IC);this.FD(g);this.paused=true;g.t(KB.vB,this.mJ);g.t(KB.oD,this.lJ);} mJ( g){this.dispatchEvent(new o(o.vD,this));this.IB.VB(KB.vB);this.IB.VB(KB.oD);this.vC(this.IB);this.paused=true;} lJ( g){this.IB.VB(KB.vB);this.IB.VB(KB.oD);this.vC(IB);} VF( g){this.HD.NF();aB.LE(this.bG,0.5);} PJ(){this.HD.NF();} vJ( g){} sJ( g){} wJ( g){} onLevelChange( g){} tJ( g){} UF( g){aB.LE(this.GJ,2.0);} TF( g){}}class yC extends aE{static var iF=0.025;static var cE=1.0;static var zC=600;static var dE=800;static var eE=600;static var lF=400;static var mF=300;static var TD=ZB.sqrt(dE*dE+eE*eE);static var bH=(TD*2/zC);static var nF=6;var PB;var RB;var JC;var YC;var aF=30.0*ZB.PI/180;var ZF=1.0*ZB.PI/180;var OD=0.05;var XF=-1;var SE=1;var MB;var iC;var DF=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var EF;var FF;var YG;var EJ;var MH;var YF=15;var nG;var GD=false;var KE=0;var MF;var IE;var AF=0.90;var GH=0;var aL;var nK;var WB;var UJ=0;var HC;var ED=false;var RF,SF;var iG;var jD;yC( g):super(g){aL=new yD.GL(80,60,690,524);this.mask=aL;this.EF=m.OF("speedalizer");this.FF=this.EF.play(true);this.WB=new rF();this.v(this.WB);iG=new kH(800,600);v(iG);RF=SF=0;FC.t(p.tE,this.WF);FC.t(p.hC,this.WF);FC.t(p.aD,this.WF);jD=this.oJ.listen(this.bL);} WF( g){RF=g.IH;SF=g.JH;} FK(){var g=this.u.LD;this.u.LD=g+(this.u as tB).FH*(this.u.level*this.u.KD);} vG( g){} RE( g){super.RE(g);this.VK();} VK(){ED=false;jD.pause();this.KE=0;this.u.lD=0;this.GD=false;var h=60;this.YC=new UH(TD,nF*h);for(var g=this.YC.w.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.YC.DH(g);this.PB=new QC(lF,mF);this.RB=new dC(0,0,0);this.JC=new dC(0,0,cE);this.ZF=(1+(0.1*this.u.level))*ZB.PI/180;this.OD=0.015+(0.004*this.u.level);this.SE=2+this.u.level;this.XF=-this.SE;this.GH=this.u.level*2;this.YF=15+(this.u.level);this.sC();this.HJ();jD.resume();} sC(){if(this.MB!=null)this.qB(this.MB);this.MB=new TH();this.v(this.MB);if(this.HC!=null)this.qB(this.HC);this.HC=new iB(m.LB("items").CB("crosshair"));this.HC.ZC=0.5;this.HC.aC=0.5;this.HC.x=(dE/2)-this.HC.width/2;this.HC.y=(eE/2)-this.HC.height/2;this.v(this.HC);} NF(){this.ED=false;this.jD.pause();var h=60;this.YC=new UH(TD,nF*h);for(var g=this.YC.w.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.YC.DH(g);this.PB=new QC(lF,mF);this.RB=new dC(0,0,0);this.JC=new dC(0,0,cE);this.ZF=2*ZB.PI/180;this.SE=0;this.XF=0;if(this.MB!=null){this.qB(this.MB);this.MB=null;}this.MB=new TH();this.v(this.MB);if(this.iC!=null){this.qB(this.iC);this.iC=null;}this.aG();this.jD.resume();} aG(){var g=new RC(null);g.VC=-1;g.DC=0;g.position=this.RB.clone();g.position.z=0.5;this.MB.CD(g);} ZG(){var g=new RC(new iB(m.LB("items").CB("countdown01")));g.VC=0;g.DC=0;g.position=this.RB.clone();g.position.z=0.5;g.eD=0;g.hD=true;this.MB.CD(g);g=new RC(new iB(m.LB("items").CB("countdown02")));g.VC=0;g.DC=0;g.position=this.RB.clone();g.position.z=0;g.eD=1;g.hD=true;this.MB.CD(g);g=new RC(new iB(m.LB("items").CB("countdown03")));g.VC=0;g.DC=0;g.position=this.RB.clone();g.position.z=-0.5;g.eD=2;g.hD=true;this.MB.CD(g);g=new RC(new iB(m.LB("items").CB("countdown04")));g.VC=0;g.DC=0;g.position=this.RB.clone();g.position.z=-1;g.eD=3;g.hD=true;this.MB.CD(g);} IJ(){var h=1+this.u.level;if(h>=this.DF.length)h=this.DF.length-1;var i=QD.jF(0,h);var j=this.DF[i];var g=new RC(new iB(m.CB(j)));g.lC=true;g.OC=QD.jF(0,359)*ZB.PI/180;g.DC=QD.aH(this.XF,this.SE)*ZB.PI/180;g.position=this.RB.clone();return g;} HJ(){this.ZG();this.aG();var h=0;for(var i=0;i<YF;i++ ){var g=null;if(i==YF-1){g=new RC(new iB(m.CB("finish")));g.OC=0;g.DC=5*ZB.PI/180;g.position=this.RB.clone();g.VC=0;g.lC=true;g.kG=true;this.MF=g;}else{h++ ;if(this.u.level==1&&h<=3){if(h==1){g=new RC(new iB(m.CB("training01")));g.lC=true;g.OC=0;g.DC=0;g.position=this.RB.clone();g.MD=1;}else if(h==2){g=new RC(new iB(m.CB("training02")));g.lC=true;g.OC=135*ZB.PI/180;g.DC=0;g.position=this.RB.clone();g.MD=2;}else if(h==3){g=new RC(new iB(m.CB("training02")));g.lC=true;g.OC=315*ZB.PI/180;g.DC=0;g.position=this.RB.clone();g.MD=3;}}else{g=this.IJ();}}g.kD=-i*1-3;g.position.z=g.kD;g.VC=0;this.MB.CD(g);}} rJ(){this.GD=false;var g=u as tB;g.PJ();g.bG();} bL( h){if(this.u.paused==false){this.IK();var g=this.u as tB;if(g.ND&&this.ED&&!g.QE)g.xJ();}else{iD=-1;}} NE( h){var g=new DB(this.PB.x,this.PB.y);g=this.oG(g);g=h.XC(g);return h.NE(g);} DJ(){this.ED=false;for(var g=0;g<this.MB.KC.length;g++ )this.MB.KC[g].position.z-= (2.5+1-AF)+1;IE.position.z+= (1-AF);this.ZG();this.GD=false;this.OD=this.nG;this.iC.visible=false;} nJ(){var g=this.u as tB;g.pB.visible=false;this.GD=false;this.ED=false;this.nG=this.OD;this.OD=0;if(this.iC!=null)this.qB(this.iC);this.iC=new iB(m.CB("broken"));this.v(this.iC);if(this.IE.MD>0&& ++this.UJ<=5){aB.LE((){g.FJ(this.IE.MD);},2.0);}else{this.u.KD-- ;if(this.u.KD>0)aB.LE(g.JJ,2.0);}this.FF.stop();this.FF=this.EF.play(true);this.YG=m.OF("crash");this.EJ=this.YG.play();}var iD=-1; IK(){var k=aB.elapsedTime;var h=1.0;if(iD==-1)iD=k;h=ZB.min(k-iD,1.0000)*40;iD=k;if(GD){this.KE-= (this.OD*h);var q=this.u.LD;this.u.LD=q+(this.GH*h);}this.MB.TK();this.aF+= (this.ZF*h);this.JC.x=-(this.RF-this.PB.x)*3;this.JC.y=-(this.SF-this.PB.y)*3;if(this.JC.hG()>TD*0.7){this.JC.QK(TD*0.7);}this.JC.z=cE;this.RB=this.JC.clone();this.RB.z=iF;this.HK();for(var n=0;n<this.MB.KC.length;n++ ){var g=this.MB.KC[n];g.position.z+= (OD*h);if(g.position.z>=1){if(g.hD&&g.eD==3)ED=true;if(g.cD!=null){this.MH=m.OF("swish");var AB=this.MH.play();}if(g.lC)GD=true;if(g.kD!=0)this.KE=g.kD;if(g.lC&&NE(g)){g.position.z=AF;IE=g;this.nJ();}else{if(g.MD==3)(this.u as tB).ND=false;if(g.lC)this.FK();if(g.kG){this.rJ();}else if(g.VC==0){this.MB.LK(g);}else{g.position.z+= g.VC;}}}var i=this.JC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.ZE(i);j=j.add(this.PB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.OC+= (g.DC*h);g.setScale(PD(g.position.z)*bH);}}if(this.MF!=null)this.u.lD=(this.KE+3)/(this.MF.kD+3);} ZE( g){var h=new QC(g.x,g.y);h.x*= PD(g.z);h.y*= PD(g.z);return h;} PD( g){var h=iF;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} HK(){if(WB==null)return;var l=2;var j=this.JC.clone();j.scale(l);var h=this.YC.transform(PD(j.z)*l,this.aF,this.ZE(j));var i=this.YC.transform(PD(this.RB.z),this.aF,this.ZE(this.RB));var k=this.ZE(this.RB).add(this.PB);WB.QB.clear();WB.QB.beginPath();WB.QB.XG(k.x,k.y,this.YC.CH*PD(this.RB.z));WB.QB.closePath();WB.QB.KH(0xffcccccc,1);WB.QB.beginPath();for(var g=0;g<h.w.length;g+= 2){WB.QB.moveTo(h.w[g].x+this.PB.x,h.w[g].y+this.PB.y);WB.QB.lineTo(h.w[g+1].x+this.PB.x,h.w[g+1].y+this.PB.y);WB.QB.lineTo(i.w[g+1].x+this.PB.x,i.w[g+1].y+this.PB.y);WB.QB.lineTo(i.w[g].x+this.PB.x,i.w[g].y+this.PB.y);WB.QB.lineTo(h.w[g].x+this.PB.x,h.w[g].y+this.PB.y);}WB.QB.closePath();WB.QB.OJ(0xFF000000);}}class RC extends AD{var ML;var QL;var SL;var position;var VC=-1;var DC=0;var SK=1;var lC=false;var kG=false;var hD=false;var xK=false;var eD=0;var MD=0;var kD=0;RC( g){SL=new AD();v(SL);this.cD=g;if(this.cD==null)return;this.x=100000;}set cD( g){if(ML!=null)this.qB(ML);if(QL!=null)this.qB(QL);ML=null;QL=null;if(g!=null){ML=g;ML.tC=yC.zC/2;ML.uC=yC.zC/2;v(ML);}else{QL=new rF();v(QL);}v(SL);} get cD{return ML;} setScale( g){this.SK=g;if(QL!=null){QL.QB.clear();QL.QB.beginPath();QL.QB.XG(0,0,yC.zC/2*g);QL.QB.closePath();QL.QB.KH(0xff999999,1);}if(ML!=null)ML.ZC=ML.aC=g;SL.ZC=SL.aC=g;} NE( j){if(ML==null)return false;var g=this.oG(j);g=ML.XC(g);var k=this.cD.nB.YJ(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new iB(m.LB("items").CB("blood"));h.tC=50;h.uC=50;h.x=g.x-yC.zC/2;h.y=g.y-yC.zC/2;SL.v(h);}return i;}}class TH extends AD{var KC;TH(){KC=new List<RC>();} TK(){this.KC.sort(bK);} CD( g){if(this.contains(g))return;this.v(g);this.KC.add(g);} LK( g){if(this.KC.length>0){var h=this.KC.indexOf(g);if(h>=0)this.KC.removeAt(h);}if(this.contains(g))this.qB(g);} bK( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.ID(g)<this.ID(h))this.LH(g,h);return 1;}if(g.position.z<h.position.z){if(this.ID(g)>this.ID(h))this.LH(g,h);return -1;}return 0;}}class QD{static var hF=new ZB.Random();static  jF( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=QD.hF.nextInt(h+1)+g;}return i;}static  aH( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=QD.hF.nextDouble()*(h-g)+g;}return i;}}class UH extends bE{var LL;var PL;UH( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.LL=h;this.PL=g;KJ();} get CH{return LL;} KJ(){var g=new List<QC>();var h=0.0;var k=2*ZB.PI/PL;for(var j=0;j<PL;j++ ){var i=new QC(0,-LL);i.CF=h;g.add(i);h+= k;}this.w=g;}}class bE implements VH,WH{var w;bE([ pointList]){this.w=(pointList!=null)?pointList:new List();}DH( g){if(g<w.length)this.w.removeAt(g);} NE( h){var k=this.w.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(w[g].y<h.y&&w[i].y>=h.y||w[i].y<h.y&&w[g].y>=h.y){if(w[g].x+(h.y-w[g].y)/(w[i].y-w[g].y)*(w[i].x-w[g].x)<h.x){j=!j;}}i=g;}return j;} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.w.length;var i=new List<QC>(j);for(var g=0;g<j;g++ ){var k=this.w[g].clone();k.scale(h);i[g]=k;}return new bE(i);} transform( l, k, n){var j=this.w.length;var i=new List<QC>(j);for(var g=0;g<j;g++ ){var h=this.w[g].clone();h.scale(l);h.CF+= k;i[g]=h.add(n);}return new bE(i);}}abstract class WH{}abstract class VH{}class uB extends AD{var NL=0;var RL=0;var TL=true;var UL=3;var VL=0.0;var WL;var XL;uB( h, g){RK(h,g);} RK( g, h){WL=g;XL=h;this.dispatchEvent(new o(o.fE,this));} get ME{return WL;} get eG{return XL;} start(){this.paused=false;this.dispatchEvent(new o(o.tD,this));} WJ(){this.dispatchEvent(new o(o.uD,this));}set lD( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;VL=g;this.dispatchEvent(new o(o.pD,this));} get lD{return VL;}set KD( g){if(g<0)g=0;UL=g;this.dispatchEvent(new o(o.RD,this));if(UL==0)this.WJ();} get KD{return UL;}set LD( g){if(g<0)g=0;NL=g;this.dispatchEvent(new o(o.sD,this));} get LD{return NL;} get PK{return NL.toDouble().round().toInt();}set level( g){if(g<0)g=0;RL=g;this.dispatchEvent(new o(o.rD,this));} get level{return RL;} kJ(){this.level+= 1;return this.level;}set paused( g){TL=g;this.dispatchEvent(new o(o.qD,this));} get paused{return TL;}}var FC;var gE;var m;var aB;var cH;var eC;var wD;var wB;const  xD="Russo One"; main(){FC=new bD("Stage",xC.query('#stage'));gE=new gH();gE.xI(FC);aB=gE.fJ;cH=new ZB.Random();var g=jB.UG("images/Loading.png");g.then((h){eC=new iB(h);eC.tC=20;eC.uC=20;eC.x=400;eC.y=270;FC.v(eC);wD=new eI(eC,100,xE.yE);wD.JE("rotation",100.0*2.0*ZB.PI);aB.add(wD);wB=new fC();wB.WC=new tF("Arial",20,0xA0A0A0,zB:true);wB.width=240;wB.height=40;wB.text="... loading ...";wB.x=400-wB.XK/2;wB.y=320;wB.sG=false;FC.v(wB);dH();});} dH(){m=new AG();m.yB("barrier01","images/barrier01.png");m.yB("barrier02","images/barrier02.png");m.yB("barrier03","images/barrier03.png");m.yB("barrier04","images/barrier04.png");m.yB("barrier05","images/barrier05.png");m.yB("barrier06","images/barrier06.png");m.yB("barrier07","images/barrier07.png");m.yB("training01","images/training01.png");m.yB("training02","images/training02.png");m.yB("finish","images/finish.png");m.yB("broken","images/broken.png");m.yI("items","images/ItemTextureAtlas.json",mE.BG);m.BF("crash","sounds/crash.mp3");m.BF("swish","sounds/swish.mp3");m.BF("speedalizer","sounds/speedalizer.mp3");m.SB("DISPLAY_LEVEL","Level: {0}");m.SB("DISPLAY_LIVES","Ships:");m.SB("DISPLAY_SCORE","Score: {0}");m.SB("DISPLAY_TRAINING","Training");m.SB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");m.SB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");m.SB("MESSAGE_GAME_OVER","Game\nOver!");m.SB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");m.SB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");m.SB("GENscore","Score");m.SB("GENlevel","Level");m.SB("GENexitquery","Do you really want to quit the game?");m.SB("GENyes","Yes");m.SB("GENno","No");m.load().then((j){FC.qB(eC);FC.qB(wB);aB.remove(wD);var h=new tB(800,600);h.zI(FC);h.start();}).catchError((i){for(var g in m.dG){print("Loading resouce failed: ${g.kind}.${g.name} - ${g.error}");}});}class hE implements pC{final  CM;var LM=0.0;var XM=0.0;var jM=1;hE( g, h):CM=g{XM=ZB.max(h,0.0001);} DD( h){var g=LM+h;while (g>=XM&&jM>0){LM=XM;jM-- ;CM();g-= XM;}LM=g;return (jM>0);} get currentTime=>LM;}class oF{var iL;var AM;var NM;var VM;var aM;var lM;var uM;var yM;var CN;var LN;var RN;oF( g, h){iL=g;AM=h;} get YK=>AM; get name=>iL; get SJ=>NM; get TJ=>VM; get RJ=>aM; get QJ=>lM; get offsetX=>uM; get offsetY=>yM; get AK=>CN; get zJ=>LN; get OK=>RN;}class lB{static const  DE="center";static const  yH="end";static const  DI="justify";static const  JG="left";static const  FE="right";}class sF{var AJ;var LJ;var height;var QF;var width;var x;sF(this.x,this.width,this.height,this.AJ,this.LJ,this.QF);}class BD{static const  pH=0;static const  JG=1;static const  FE=2;static const  FI=3;static const  IG=4;}class BE extends SC{var JM;var xL;var sL;var MM;BE( g, i, h){JM=g;sL=i;MM=h;xL=g.lN(this);xL.loop=sL;this.VE=h;xL.play();} set VE( g){MM=g;if(xL!=null)xL.volume=(MM!=null)?MM.volume:1;} stop(){if(xL!=null){if(xL.ended==false)xL.pause();JM.uO(this);xL=null;}}}class kE{static var xF=mB.oE;static var vH=false;static var GI=new YB.StreamController<String>();static var KI=GI.stream.asBroadcastStream();static  TG( i){var h=i;var g="auto";if(xF!=mB.oE)h=xF;switch (h){case mB.oE:g="auto";break;case mB.qE:g="default";break;case mB.rE:g="pointer";break;case mB.HI:g="move";break;case mB.II:g="text";break;case mB.LI:g="wait";break;}if(vH)g="none";return g;}}class mB{static const  oE="auto";static const  qE="arrow";static const  rE="button";static const  HI="hand";static const  II="ibeam";static const  LI="wait";}class XD{static var RI=gI();static var HE=lI();static var PG=nI();static  gI(){var h=(HE!=null)?"WebAudioApi":"AudioElement";var g=xC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(PG.length==0)h="Mock";print("dartflash: supported audio engine is: ${h}");return h;}static  lI(){try {return new QH.AudioContext();}catch (g){return null;}}static  nI(){var g=new List<String>();var h=new xC.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("dartflash: supported audio types are: ${g}");return g;}}class dB{var volume;var BK;var zK=1;var AL=0;var DL=1;var CL=0;dB([this.volume=1,this.BK=0]);}abstract class SC extends TC{ set VE( g); stop();}class nE extends cB{var vL;nE(){if(XD.HE==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  UG( q){var h=new nE();var k=cB.SG(q);var g=new YB.Completer<cB>();xC.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var n=XD.HE;n.decodeAudioData(j,( l){h.vL=l;g.complete(h);},(AB){g.completeError(new StateError("Failed to decode audio."));});}).catchError((AB){g.completeError(new StateError("Failed to load audio."));});return g.future;} get length{return vL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new kK(this,loop,soundTransform);}}class lH{static const  uH="round";}class qF{static const  AI="none";static const  EI="touchPoint";}class mE{static const  rH="json";static const  BG="jsonarray";}abstract class pC{ DD( g);}class iE implements pC{final  EM=new List<pC>();var dM=0;var qM=0.0; get elapsedTime=>qM; add( g){if(g==null)return;if(dM==EM.length){EM.add(g);}else{EM[dM]=g;}dM++ ;} remove( h){if(h==null)return;for(int g=0;g<dM;g++ ){if(EM[g]==h){EM[g]=null;break;}}} LE( h, i){var g=new hE(h,i);add(g);return g;} DD( k){qM+= k;var j=dM;var h=0;for(int g=0;g<j;g++ ){var i=EM[g];if(i==null)continue;if(i.DD(k)==false){EM[g]=null;continue;}if(h!=g){EM[h]=i;EM[g]=null;}h++ ;}if(h!=j){for(int g=j;g<dM;g++ ){EM[h++ ]=EM[g];EM[g]=null;}dM=h;}return true;}}class kH extends GB{var width;var height;kH(this.width,this.height); kB( g,[ returnRectangle]){return zE(g,width,height,returnRectangle);} AC( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} TB( g){}}class jH{var name;var EC;var NH;jH(this.name,this.EC,this.NH);}class hH{static const  uH="round";}class DB{var x;var y;DB(this.x,this.y);DB.FL():this(0,0);static  YI( g, h)=>new DB(g*ZB.cos(h),-g*ZB.sin(h)); get length=>ZB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new DB(this.x+g.x,this.y+g.y); clone()=>new DB(this.x,this.y); JF( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class HB{var x;var y;var width;var height;HB(this.x,this.y,this.width,this.height);HB.FL():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new DB(this.width,this.height); set size( g){this.width=g.x;this.height=g.y;} clone()=>new HB(this.x,this.y,this.width,this.height); contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); JF( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;}}class fH{fH();}abstract class cB{static  UG( g){var h=XD.RI;if(h=="WebAudioApi")return nE.UG(g);if(h=="AudioElement")return jE.UG(g);return uF.UG(g);} get length; play([ loop=false, soundTransform]);static  SG( g){var n=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var i=n.firstMatch(g);var h=XD.PG;if(i==null)throw new ArgumentError("Unsupported file extension.");if(h.length==0)throw new UnsupportedError("This browser supports no known audio codec.");var j=i.group(1).toLowerCase();if(h.indexOf(j)==-1){var l=g.substring(0,g.length-j.length);var k=h[0];g="${l}${k}";}return g;}}class gH{var fL;var wL;var FM;var YM;var oM;gH(){fL=new iE();wL=new List<bD>();FM=double.NAN;YM=AE.KG;oM=new UD(0);xC.window.requestAnimationFrame(mN);} get fJ=>fL; mN( g){xC.window.requestAnimationFrame(mN);if(FM.isNaN)FM=g;if(FM>g)FM=g;var j=g-FM;var i=j/1000.0;if(j>=1){FM=g;oM.nL=i;YM.NO(oM);fL.DD(i);for(int h=0;h<wL.length;h++ ){var k=wL[h];k.hJ();}}} xI( g){wL.add(g);}}class hB{final  tL;final  QM=new List<FB>(100);final  pM=new List<double>(100);var BN=0;hB.HL( j,[ matrix]):tL=j{for(int h=0;h<100;h++ ){QM[h]=new FB.IL();pM[h]=1.0;}if(matrix!=null)QM[0].JF(matrix);var g=QM[0];var i=pM[0];tL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);tL.globalAlpha=i;} get context=>tL; reset(){BN=0;var g=QM[0];var h=pM[0];tL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);tL.globalAlpha=h;tL.clearRect(0,0,tL.canvas.width,tL.canvas.height);} EH( h){var i=BN;var j=BN+1;var l=QM[i];var g=QM[j];var n=pM[i];var k=pM[j]=h.SN*n;g.KF(h.fO,l);tL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);tL.globalAlpha=k;BN=j;if(h.mask==null){h.TB(this);}else{tL.save();h.mask.TB(this);h.TB(this);tL.restore();}BN=i;}}class VD{static const  oE="auto";static const  xH="stop";static const  FG="once";}class BB{static const  tH="added";static const  CG="addedToStage";static const  sE="enterFrame";static const  JI="removed";static const  NI="removedFromStage";var cL;var bO;var QO;var OM;var kO;var TO;var ZO;BB( g,[ bubbles=false]){CO(g,bubbles);} CO( g,[ bubbles=false]){cL=g;bO=bubbles;QO=nC.EE;OM=null;kO=null;TO=false;ZO=false;} get XE=>TO; get type=>cL; get bubbles=>bO; get GF=>true; get target=>OM;}class nC{static const  yF=1;static const  EE=2;static const  CI=3;}class TC{var rL; aJ( g){if(rL!=null)return rL.containsKey(g)||rL.containsKey("${g}_CAPTURE");else return false;} t( g, i(event),{ useCapture: false}){var h=NN(g,useCapture);var j=h.listen(i);return j;} VB( g,{ useCapture: false}){var i=useCapture?"${g}_CAPTURE":g;var h=rL[i];if(h!=null)h.lO();} dispatchEvent( g){oO(g,this,this,nC.EE);} oO( g, k, l, i){if(rL!=null){var j=(i==nC.yF)?"${g.type}_CAPTURE":g.type;var h=rL[j];if(h!=null){g.OM=k;g.kO=l;g.QO=i;g.TO=false;g.ZO=false;h.NO(g);}}} NN( g, j){if(rL==null)rL=new Map<String,WD>();var i=j?"${g}_CAPTURE":g;var h=rL[i];if(h==null)h=rL[i]=new WD(this,g,j);return h;}}class AE<YD extends BB>{final  rL=new List<WD>();var gM=0;static var KG=new AE<UD>(); eN( g){for(int h=0;h<gM;h++ )if(rL[h]==g)return;if(gM==rL.length)rL.add(g);else rL[gM]=g;gM++ ;} NO( j){j.QO=nC.EE;j.TO=false;j.ZO=false;var k=gM;var i=0;for(int g=0;g<k;g++ ){var h=rL[g];if(h==null)continue;if(h.TN==0){rL[g]=null;continue;}j.OM=h.OM;j.kO=h.OM;h.NO(j);if(i!=g){rL[i]=h;rL[g]=null;}i++ ;}if(i!=k){for(int g=k;g<gM;g++ ){rL[i++ ]=rL[g];rL[g]=null;}gM=i;}}}class WD<YD extends BB> extends YB.Stream<YD>{final  OM;final  DM;final  nM;final  DN=new List<sH>();var TN=0;WD(this.OM,this.DM,this.nM); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new sH<YD>(this,h);if(TN==DN.length)DN.add(g);else DN[TN]=g;TN++ ;if(DM==BB.sE&&nM==false)AE.KG.eN(this);return g;} xN( h){for(int g=0;g<TN;g++ ){if(DN[g]==h){DN[g]=null;break;}}} lO(){for(int g=0;g<TN;g++ )if(DN[g]!=null)DN[g].cancel();} NO( k){var j=TN;var h=0;for(int g=0;g<j;g++ ){var i=DN[g];if(i==null)continue;i.HN(k);if(h!=g){DN[h]=i;DN[g]=null;}h++ ;}if(h!=j){for(int g=j;g<TN;g++ ){DN[h++ ]=DN[g];DN[g]=null;}TN=h;}}}class xB<YD extends BB>{final  DM;const xB(this.DM); forTarget( g,{ useCapture: false}){return g.NN(DM,useCapture);}}class kK extends SC{var HM;var MM;var sL;var vM;var GN;kK( j, h, i){HM=j;sL=h;MM=i;var g=XD.HE;vM=g.createGain();vM.connect(g.destination,0,0);vM.gain.value=(MM!=null)?ZB.pow(MM.volume,2):1;GN=g.createBufferSource();GN.buffer=HM.vL;GN.loop=h;GN.connect(vM,0,0);GN.start(0);} set VE( g){MM=g;vM.gain.value=(MM!=null)?ZB.pow(MM.volume,2):1;} stop(){GN.stop(0);}}class UD extends BB{var nL;UD( g):super(BB.sE,false){nL=g;} get GF=>false;}class p extends BB{static const  qC="click";static const  BI="doubleClick";static const  hC="mouseDown";static const  aD="mouseUp";static const  tE="mouseMove";static const  GE="mouseOut";static const  NG="mouseOver";static const  OG="mouseWheel";static const  QG="middleClick";static const  WI="middleMouseDown";static const  ZI="middleMouseUp";static const  RG="rightClick";static const  dI="rightMouseDown";static const  hI="rightMouseUp";var KO,LO;var OO,PO;var tO;var aN;var oN;var dN;var gN;var vO;var wO;var xO;p( g,[ bubbles=false]):super(g,bubbles){CO(g,bubbles);} CO( g,[ bubbles=false]){super.CO(g,bubbles);KO=LO=0;OO=PO=0;tO=false;aN=false;oN=false;dN=false;gN=false;vO=0;wO=0;xO=0;}set yO( g){KO=g.x;LO=g.y;}set zO( g){OO=g.x;PO=g.y;} get IH=>OO; get JH=>PO; get UC=>tO; get altKey=>aN; get ctrlKey=>dN; get shiftKey=>gN; get dD=>vO; get deltaX=>wO; get deltaY=>xO;}class uF extends cB{uF(){}static  UG( g){return new YB.Future<cB>.of(()=>new uF());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new dB();}return new lK(this,loop,soundTransform);}}class wF extends BB{static const  zH="textInput";var zL="";wF( g,[ bubbles=false]):super(g,bubbles){}}class OB extends BB{static const  zF="touchBegin";static const  EG="touchEnd";static const  GG="touchCancel";static const  MG="touchMove";static const  OI="touchOver";static const  QI="touchOut";var HO;var JO;var KO,LO;var OO,PO;var aN;var oN;var dN;var gN;var VO;var YO;var aO;OB( g,[ bubbles=false]):super(g,bubbles){CO(g,bubbles);} CO( g,[ bubbles=false]){super.CO(g,bubbles);HO=0;JO=false;KO=LO=0;OO=PO=0;aN=false;oN=false;dN=false;gN=false;VO=1.00;YO=0;aO=0;}set yO( g){KO=g.x;LO=g.y;}set zO( g){OO=g.x;PO=g.y;} get YE=>HO; get IH=>OO; get JH=>PO; get altKey=>aN; get ctrlKey=>dN; get shiftKey=>gN;}class lK extends SC{var sL;var MM;lK( i, h, g){sL=h;MM=g;}set VE( g){MM=g;} stop(){}}class mH{static const  wH="pixel";}class jE extends cB{var xL;var RM;var mM;jE(){mM=new List<BE>();xL=new xC.AudioElement();xL.onEnded.listen(XN);RM=new List<xC.AudioElement>();RM.add(xL);xC.document.body.children.add(xL);}static  UG( AB){var k=new jE();var g=k.xL;var i=new YB.Completer<cB>();var h;var j;q(n){h.cancel();j.cancel();i.complete(k);}l(n){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(q);j=g.onError.listen(l);g.src=cB.SG(AB);g.load();return i.future;} get length{return xL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new BE(this,loop,soundTransform);} lN( h){var g;if(RM.length==0){g=xL.clone(true);g.onEnded.listen(XN);}else{g=RM.removeAt(0);}mM.add(h);return g;} uO( g){var h=g.xL;var i=mM.indexOf(g);mM.removeAt(i);RM.add(h);if(xL.currentTime>0&&xL.ended==false)xL.currentTime=0;} XN(j){var i=j.target;var g=null;for(int h=0;h<mM.length&&g==null;h++ )if(mM[h].xL==i)g=mM[h];if(g!=null)g.stop();}}class fC extends GB{var zL="";var KM=0x000000;var bM=null;var tM=nH.AI;var IN=mH.wH;var cL=iH.qH;var VN=false;var YN=false;var ZN=0x000000;var fN=false;var kN=0x000000;var nN=0;var qN=0;var sN;var wN;var yN=true;var AO=100;var BO=100;var DO=null;var tL=null;fC(){bM=new tF("Arial",12,0x000000);sN=new List<String>();wN=new List<sF>();} get type=>cL; get width=>AO; get height=>BO; set text( g){zL=g;yN=true;} set wC( g){KM=g;yN=true;} set WC( g){bM=g;KM=bM.color;yN=true;} set wordWrap( g){VN=g;yN=true;} set width( g){AO=g;yN=true;} set height( g){BO=g;yN=true;} get XK{GP();return nN;} kB( g,[ returnRectangle]){return zE(g,AO,BO,returnRectangle);} AC( g, h){if(g>=0&&h>=0&&g<AO&&h<BO)return this;return null;} TB( g){GP();g.tL.drawImage(DO,0.0,0.0);} IP(){sN.clear();wN.clear();if(VN==false){sN.add(zL);}else{for(String q in zL.replaceAll('\r','').split('\n')){var h=new StringBuffer();var i=0;var g="";for(String j in q.split(' ')){i=h.length;h.write((i>0)?" ${j}":j);g=h.toString();if(tL.measureText(g).width>AO){if(i>0){g=g.substring(0,i);}else{j="";}sN.add(g);h=new StringBuffer();h.write(j);}}if(h.isEmpty==false){sN.add(h.toString());}}}nN=0;qN=0;for(String g in sN){var l=tL.measureText(g);var n=0;if(bM.align==lB.DE||bM.align==lB.DI)n=(AO-l.width)/2;if(bM.align==lB.FE||bM.align==lB.yH)n=AO-l.width;var k=new sF(n,l.width,bM.size,0,0,0);wN.add(k);nN=ZB.max(nN,k.width);qN=qN+k.height;}} GP(){if(yN){yN=false;var j=AO.ceil().toInt();var i=BO.ceil().toInt();if(DO==null){DO=new xC.CanvasElement(width:j,height:i);tL=DO.context2d;}if(DO.width!=j)DO.width=j;if(DO.height!=i)DO.height=i;var g=new StringBuffer();g.write(bM.mG?"italic ":"normal ");g.write("normal ");g.write(bM.zB?"bold ":"normal ");g.write("${bM.size}px ");g.write("${bM.font},sans-serif");tL.font=g.toString();tL.textAlign="start";tL.textBaseline="top";tL.fillStyle=ZD(KM);IP();if(YN){tL.fillStyle=ZD(ZN);tL.fillRect(0,0,AO,BO);}else{tL.clearRect(0,0,AO,BO);}var k=0;for(int h=0;h<sN.length;h++ ){var l=wN[h];tL.fillStyle=ZD(KM);tL.fillText(sN[h],l.x,k);k+= l.height;}if(fN){tL.strokeStyle=ZD(kN);tL.lineWidth=1;tL.strokeRect(0,0,AO,BO);}}}}class nH{static const  AI="none";}abstract class s extends TC implements lE{var UM=0.0;var ZM=0.0;var hM=0.0;var sM=0.0;var xM=1.0;var EN=1.0;var MN=0.0;var SN=1.0;var UN=true;var WN=null;var iL="";var cN=null;final  hN=new FB.IL();final  pN=new FB.IL();final  uN=new FB.IL();var zN=true;static const  mI=const xB<UD>(BB.sE); get oJ=>s.mI.forTarget(this); get x=>UM; get y=>ZM; get tC=>hM; get uC=>sM; get ZC=>xM; get aC=>EN; get OC=>MN; get alpha=>SN; get visible=>UN; get mask=>WN; get name=>iL; get parent=>cN; get root{var g=this;while (g.cN!=null)g=g.cN;return g;} get WE{var g=this.root;if(g is bD)return g;return null;}set x( g){UM=g;zN=true;}set y( g){ZM=g;zN=true;}set tC( g){hM=g;zN=true;}set uC( g){sM=g;zN=true;}set ZC( g){xM=g;zN=true;}set aC( g){EN=g;zN=true;}set OC( g){MN=g;zN=true;}set alpha( g){SN=g;zN=true;}set visible( g){UN=g;zN=true;}set mask( g){WN=g;} get width=>kB(fO).width; get height=>kB(fO).height; set width( h){this.ZC=1;var g=this.width;this.ZC=(g!=0.0)?h/g:1.0;} set height( h){this.aC=1;var g=this.height;this.aC=(g!=0.0)?h/g:1.0;} zI( g){g.v(this);} KK(){if(cN!=null)cN.qB(this);} get fO{if(zN){zN=false;if(MN==0.0){uN.HH(xM,0.0,0.0,EN,UM-hM*xM,ZM-sM*EN);}else{var g=ZB.cos(MN);var h=ZB.sin(MN);var i=xM*g;var l=xM*h;var k=-EN*h;var j=EN*g;var n=UM-hM*i-sM*k;var q=ZM-hM*l-sM*j;uN.HH(i,l,k,j,n,q);}}return uN;} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.FL();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} AC( g, h){if(kB(pN).contains(g,h))return this;return null;} oG( h){hN.jG();for(s g=this;g!=null;g=g.cN)hN.concat(g.fO);return hN.PH(h);} XC( h){hN.jG();for(s g=this;g!=null;g=g.cN)hN.concat(g.fO);hN.eJ();return hN.PH(h);} dispatchEvent( h){var g=null;if(h.GF||h.bubbles)for(s j=cN;j!=null;j=j.cN)if(j.aJ(h.type)){if(g==null)g=new List<s>();g.add(j);}if(h.GF&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.XE==false)g[i].oO(h,this,g[i],nC.yF);if(h.XE==false)oO(h,this,this,nC.EE);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.XE==false)g[i].oO(h,this,g[i],nC.CI);} AP( h){for(var g=h;g!=null;g=g.cN)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");cN=h;} TB( g);}abstract class GB extends s{var MJ=false;var sG=true;var EL=true;var tabIndex=0;static const  MI=const xB<p>(p.GE);static const  XI=const xB<p>(p.tE);static const  bI=const xB<p>(p.hC);static const  iI=const xB<p>(p.aD);static const  pI=const xB<p>(p.OG); get onMouseOut=>GB.MI.forTarget(this); get onMouseMove=>GB.XI.forTarget(this); get onMouseDown=>GB.bI.forTarget(this); get onMouseUp=>GB.iI.forTarget(this); get onMouseWheel=>GB.pI.forTarget(this);static const  qI=const xB<OB>(OB.MG);static const  sI=const xB<OB>(OB.EG);static const  tI=const xB<OB>(OB.GG); get onTouchMove=>GB.qI.forTarget(this); get onTouchEnd=>GB.sI.forTarget(this); get onTouchCancel=>GB.tI.forTarget(this);static const  uI=const xB<GC>(GC.DG);static const  vI=const xB<GC>(GC.pE); get onKeyUp=>GB.uI.forTarget(this); get onKeyDown=>GB.vI.forTarget(this);}abstract class oC extends GB{final  WM=new List<s>();var rM=true;var AN=true; v( g){if(g.parent==this){var h=WM.indexOf(g);WM.removeAt(h);WM.add(g);}else{wI(g,WM.length);}} wI( g, h){if(h<0&&h>WM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){WM.removeAt(WM.indexOf(g));if(h>WM.length)h-- ;WM.insertRange(h,1,g);}else{g.KK();g.AP(this);WM.insertRange(h,1,g);g.dispatchEvent(new BB(BB.tH,true));if(this.WE!=null)BP(g,new BB(BB.CG));}} qB( h){var g=WM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");JK(g);} JK( g){if(g<0&&g>=WM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=WM[g];h.dispatchEvent(new BB(BB.JI,true));if(this.WE!=null)BP(h,new BB(BB.NI));h.AP(null);WM.removeAt(g);} gG( g){if(g<0&&g>=WM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return WM[g];} ID( g){return WM.indexOf(g);} LH( j, i){var h=ID(j);var g=ID(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");WK(h,g);} WK( h, g){var j=gG(h);var i=gG(g);WM[h]=i;WM[g]=j;} contains( g){for(;g!=null;g=g.cN)if(g==this)return true;return false;} kB( q,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.FL();if(WM.length==0)return super.kB(q,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var AB=WM.length;for(int l=0;l<WM.length;l++ ){var n=WM[l];hN.KF(n.fO,q);var g=n.kB(hN,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} AC( AB, EB){var l=null;for(int j=WM.length-1;j>=0;j-- ){var i=WM[j];if(i.visible){var g=i.fO;var n=AB-g.fB;var k=EB-g.gB;var JB=(g.d*n-g.c*k)/g.kC;var q=(g.a*k-g.b*n)/g.kC;var h=i.AC(JB,q);if(h!=null){if(h is GB)if(h.sG)return rM?h:this;l=this;}}}return l;} TB( i){for(int g=0;g<WM.length;g++ ){var h=WM[g];if(h.visible)i.EH(h);}} BP( g, j){g.dispatchEvent(j);if(g is oC){var i=new List<s>.from(g.WM,growable:false);for(int h=0;h<i.length;h++ )BP(i[h],j);}}}class vF{var target=null;var UC=false;var HF=0;var dD=0;var rG,tG;var pG,qG;vF(this.rG,this.tG,this.pG,this.qG);}class yD{var cL;var kL;var BM;var PM;yD.GL( i, g, h, j){cL=0;kL=new HB(i,g,h,j);} TB( i){var g=i.context;g.beginPath();switch (cL){case 0:g.rect(kL.x,kL.y,kL.width,kL.height);break;case 1:g.arc(BM.x,BM.y,BM.CH,0,ZB.PI*2.0,false);break;case 2:g.moveTo(PM[0].x,PM[0].y);for(int h=1;h<PM.length;h++ )g.lineTo(PM[h].x,PM[h].y);break;}g.clip();}}class GC extends BB{static const  pE="keyDown";static const  DG="keyUp";var aN;var dN;var gN;var jN;var oN;var rN;var tN;var vN;GC( g,[ bubbles=false]):super(g,bubbles){CO(g,bubbles);} CO( g,[ bubbles=false]){super.CO(g,bubbles);aN=false;dN=false;gN=false;jN=false;oN=false;rN=0;tN=0;vN=0;} get altKey=>aN; get ctrlKey=>dN; get shiftKey=>gN; get charCode=>rN; get keyCode=>tN; get keyLocation=>vN;}class AD extends oC{var qK=false;var eF=false;}class iB extends s{var nB;var DK;var IF;iB([this.nB=null,this.DK="auto"]){IF=null;} kB( h,[ returnRectangle]){var g=(nB!=null)?nB.width:0;var i=(nB!=null)?nB.height:0;return zE(h,g,i,returnRectangle);} AC( g, h){if(nB!=null&&g>=0.0&&h>=0.0&&g<nB.width&&h<nB.height)return this;return null;} TB( g){if(nB!=null){if(IF==null)nB.TB(g);else nB.MK(g,IF);}}}class CE{var lL;var iL;var IM;var TM;var cM;var kM;CE( g, h, i){lL=g;iL=h;IM=i;cM=null;kM=null;} get kind=>lL; get name=>iL; get mD=>kM; get error=>cM;EO( i){TM=i.then((g){kM=g;cM=null;},onError:( h){kM=null;cM=h.error;});}}abstract class lE{ TB( g);}class iH{static const  qH="dynamic";}class rF extends s{var pL;rF(){pL=new pF();} get QB=>pL; kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.FL();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} AC( g, h){return null;} TB( g){pL.TB(g);}}class gC{final  oL=new xC.ImageElement();final  eM=new List<oF>();static  UG( n, XB){var l=new YB.Completer<gC>();var j=new gC();switch (XB){case mE.rH:case mE.BG: q( k, g){var JB=fI(k);var h=new oF(JB,j);h.NM=g["frame"]["x"].toInt();h.VM=g["frame"]["y"].toInt();h.aM=g["frame"]["w"].toInt();h.lM=g["frame"]["h"].toInt();h.uM=g["spriteSourceSize"]["x"].toInt();h.yM=g["spriteSourceSize"]["y"].toInt();h.CN=g["sourceSize"]["w"].toInt();h.LN=g["sourceSize"]["h"].toInt();h.RN=g["rotated"] as bool;j.eM.add(h);}xC.HttpRequest.getString(n).then((NB){var AB=dK.parse(NB);var i=AB["frames"];var EB=AB["meta"];if(i is List)for(var g in i)q(g["filename"],g);if(i is Map)for(String k in i.keys)q(k,i[k]);j.oL..onLoad.listen((bB)=>l.complete(j))..onError.listen((bB)=>l.completeError(new StateError("Failed to load image.")))..src=jI(n,EB["image"]);}).catchError((sB){l.completeError(new StateError("Failed to load json file."));});break;}return l.future;} get bJ=>oL; CB( i){var h;for(int g=0;g<eM.length&&h==null;g++ )if(eM[g].name==i)h=new jB.KL(eM[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;}}class zD extends GB{var dF;var BH;var cG;var OE;var eF=true;var enabled=true;var QN;zD([this.dF,this.BH,this.cG,this.OE]){t(p.NG,iN);t(p.GE,iN);t(p.hC,iN);t(p.aD,iN);QN=this.dF;} kB( g,[ returnRectangle]){if(QN!=null){hN.KF(QN.fO,g);return QN.kB(hN,returnRectangle);}return super.kB(g,returnRectangle);} AC( k, l){if(this.OE!=null){var g=this.OE.fO;var h=k-g.fB;var i=l-g.gB;var n=(g.d*h-g.c*i)/g.kC;var j=(g.a*i-g.b*h)/g.kC;if(this.OE.AC(n,j)!=null)return this;}return null;} TB( g){if(QN!=null)g.EH(QN);} iN( g){if(g.type==p.GE){QN=dF;}else{QN=g.UC?cG:BH;}}}class pF{final  qL=new List<eH>();clear()=>qL.clear();beginPath()=>qL.add(new eH("beginPath"));closePath()=>qL.add(new eH("closePath"));moveTo( h, g)=>qL.add(new eH("moveTo",[h,g]));lineTo( h, g)=>qL.add(new eH("lineTo",[h,g]));arcTo( k, i, g, h, j)=>qL.add(new eH("arcTo",[k,i,g,h,j]));quadraticCurveTo( j, i, g, h)=>qL.add(new eH("quadraticCurveTo",[j,i,g,h]));bezierCurveTo( h, k, l, i, g, j)=>qL.add(new eH("bezierCurveTo",[h,k,l,i,g,j]));arc( l, g, j, i, h, k)=>qL.add(new eH("arc",[l,g,j,i,h,k]));rect( i, g, h, j)=>qL.add(new eH("rect",[i,g,h,j]));KH( g,[ width=1, joints=hH.uH, caps=lH.uH])=>qL.add(new eH("strokeColor",[wE(g),width,joints,caps]));OJ( g)=>qL.add(new eH("fillColor",[wE(g)]));XG( i, g, h){qL.add(new eH("moveTo",[i+h,g]));qL.add(new eH("arc",[i,g,h,0,ZB.PI*2,false]));} TB( k){var h=k.context;h.save();for(var j in qL){var g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].KP(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].LP(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];FB i=g[0].MP;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].vK(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].wK(h);FB i=g[0].MP;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}class eH{var name;var arguments;eH(this.name,[this.arguments]);}class tF{var font;var size;var color;var zB;var mG;var ZK;var align;var gJ;var NK;var cJ;var QF;var letterSpacing=0;var oK=0;var pK=false;var yK=false;tF(this.font,this.size,this.color,{this.zB: false,this.mG: false,this.ZK: false,this.align: "left",this.gJ: 0,this.NK: 0,this.cJ: 0,this.QF: 0});}class FB{var dL,eL,gL,hL,jL,mL;var uL;FB( h, i, g, j, k, l):dL=h,eL=i,gL=g,hL=j,jL=k,mL=l,uL=h*j-i*g;FB.IL():dL=1.0,eL=0.0,gL=0.0,hL=1.0,jL=0.0,mL=0.0,uL=1.0; clone(){return new FB(dL,eL,gL,hL,jL,mL);} get a=>dL; get b=>eL; get c=>gL; get d=>hL; get fB=>jL; get gB=>mL; get kC=>uL; PH( g){return new DB(g.x*dL+g.y*gL+jL,g.x*eL+g.y*hL+mL);} concat( g){var n=dL;var EB=eL;var JB=gL;var AB=hL;var l=jL;var q=mL;var XB=uL;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var bB=g.fB;var NB=g.gB;var sB=g.kC;dL=(n*j+EB*i);eL=(n*k+EB*h);gL=(JB*j+AB*i);hL=(JB*k+AB*h);jL=(l*j+q*i+bB);mL=(l*k+q*h+NB);uL=(XB*sB);} jG(){dL=1.0;eL=0.0;gL=0.0;hL=1.0;jL=0.0;mL=0.0;uL=1.0;} eJ(){var j=dL;var n=eL;var l=gL;var k=hL;var h=jL;var i=mL;var g=uL;dL=(k/g);eL=-(n/g);gL=-(l/g);hL=(j/g);jL=-(dL*h+gL*i);mL=-(eL*h+hL*i);uL=(1.0/g);} HH( h, i, g, j, k, l){dL=h;eL=i;gL=g;hL=j;jL=k;mL=l;uL=(h*j-i*g);} JF( g){dL=g.a;eL=g.b;gL=g.c;hL=g.d;jL=g.fB;mL=g.gB;uL=g.kC;} KF( h, g){var q=h.a;var JB=h.b;var NB=h.c;var EB=h.d;var n=h.fB;var AB=h.gB;var bB=h.kC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var sB=g.fB;var XB=g.gB;var mC=g.kC;dL=(q*k+JB*j);eL=(q*l+JB*i);gL=(NB*k+EB*j);hL=(NB*l+EB*i);jL=(n*k+AB*j+sB);mL=(n*l+AB*i+XB);uL=(bB*mC);}}class jB implements lE{var yL;var GM;var SM;var fM;var tL;var zM;var JN;var ON;var NM;var VM;var aM;var lM;jB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){yL=g;GM=h;SM=transparent;var i=new xC.CanvasElement(width:yL,height:GM);tL=i.context2d;tL.fillStyle=SM?wE(fillColor):ZD(fillColor);tL.fillRect(0,0,g,h);fM=i;zM=0;}jB.JL( g){yL=g.naturalWidth;GM=g.naturalHeight;SM=true;fM=g;zM=0;}jB.KL( g){yL=g.AK;GM=g.zJ;SM=true;fM=g.YK.bJ;zM=g.OK?2:1;JN=g.offsetX.toDouble();ON=g.offsetY.toDouble();NM=g.SJ.toDouble();VM=g.TJ.toDouble();aM=g.RJ.toDouble();lM=g.QJ.toDouble();}static  UG( i){var h=new YB.Completer<jB>();var g=new xC.ImageElement();g.onLoad.listen((j)=>h.complete(new jB.JL(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>yL; get height=>GM; clone(){var g=new jB(yL,GM,true,0);g.NJ(this);return g;} NJ( h,[ matrix=null]){var g=JP();var i=new hB.HL(g,matrix);h.TB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} YJ( j, h){var i=JP();var k=i.getImageData(j,h,1,1);var g=k.data;if(rI){return (g[0]<<16)+(g[1]<<8)+(g[2]<<0)+(g[3]<<24);}else{return (g[3]<<16)+(g[2]<<8)+(g[1]<<0)+(g[0]<<24);}} TB( g){switch (zM){case 0:g.context.drawImage(fM,0.0,0.0);break;case 1:g.context.drawImage(fM,NM,VM,aM,lM,JN,ON,aM,lM);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,JN,ON+lM);g.context.drawImage(fM,NM,VM,lM,aM,0.0,0.0,lM,aM);break;}} MK( bB, g){if(g.width<=0.0||g.height<=0.0)return;switch (zM){case 0:bB.context.drawImage(fM,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=NM;double h=VM;double EB=j+aM;double JB=h+lM;double l=NM-JN+g.x;double n=VM-ON+g.y;double XB=l+g.width;double NB=n+g.height;double AB=(j>l)?j:l;double q=(h>n)?h:n;double sB=(EB<XB)?EB:XB;double fF=(JB<NB)?JB:NB;double gF=JN-j+AB;double mC=ON-h+q;double k=sB-AB;double i=fF-q;if(k>0.0&&i>0.0){bB.context.drawImage(fM,AB,q,k,i,gF,mC,k,i);}break;case 2:double j=NM;double h=VM;double EB=j+lM;double JB=h+aM;double l=NM+ON-g.y+lM-g.height;double n=VM-JN+g.x;double XB=l+g.height;double NB=n+g.width;double AB=(j>l)?j:l;double q=(h>n)?h:n;double sB=(EB<XB)?EB:XB;double fF=(JB<NB)?JB:NB;double gF=JN-h+q;double mC=ON+EB-sB;double k=fF-q;double i=sB-AB;if(k>0.0&&i>0.0){bB.context.transform(0.0,-1.0,1.0,0.0,gF,mC+i);bB.context.drawImage(fM,AB,q,i,k,0.0,0.0,i,k);}break;}} JP(){if(tL==null){var g=new xC.CanvasElement(width:yL,height:GM);tL=g.context2d;switch (zM){case 0:tL.drawImage(fM,0,0);break;case 1:tL.drawImage(fM,NM,VM,aM,lM,JN,ON,aM,lM);break;case 2:tL.setTransform(0.0,-1.0,1.0,0.0,JN,ON+lM);tL.drawImage(fM,NM,VM,lM,aM,0.0,0.0,lM,aM);tL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}fM=g;zM=0;}return tL;}}typedef  oH<YD extends BB>( event);class sH<YD extends BB> extends YB.StreamSubscription<YD>{var wM;var HN;var KN;var PN;sH(this.wM,this.HN){KN=0;PN=false;} cancel(){if(PN==false){wM.xN(this);PN=true;HN=null;}} onError( g( error)){} get iO=>KN>0; pause([ resumeSignal]){KN++ ;if(resumeSignal!=null)resumeSignal.whenComplete(resume);} resume(){if(iO==false)throw new StateError("Subscription is not paused.");KN-- ;}}class AG{var iM;AG(){iM=new Map<String,CE>();} bN( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(iM.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");iM[i]=g;} FO( i, g){var h="${i}.${g}";if(iM.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return iM[h];} yB( i, h){var g=new CE("BitmapData",i,h);g.EO(jB.UG(h));bN(g);} BF( i, h){var g=new CE("Sound",i,h);g.EO(cB.UG(h));bN(g);} yI( j, h, i){var g=new CE("TextureAtlas",j,h);g.EO(gC.UG(h,i));bN(g);} SB( i, h){var g=new CE("Text",i,"");g.EO(new YB.Future.immediate(h));bN(g);} load(){var h=this.CK.map((i)=>i.TM);return YB.Future.wait(h).then((j){var g=this.dG;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get CK{return iM.values.where((g)=>g.mD==null).toList();} get dG{return iM.values.where((g)=>g.error!=null).toList();} CB( g){return FO("BitmapData",g).mD;} OF( g){return FO("Sound",g).mD;} LB( g){return FO("TextureAtlas",g).mD;} ZJ( g){return FO("Text",g).mD;}} ZD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class HG{static var LG=false;static var uE=false;static var vE=0;static var UI=qF.AI;static var VI=new YB.StreamController<String>();static var aI=VI.stream.asBroadcastStream();static cI(){if(LG==false){LG=true;var g=xC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){uE=true;vE=10;}if(g.contains("Android")){uE=true;vE=10;}if(g.contains("IEMobile")){uE=true;vE=10;}}}static  get oI{cI();return UI;}}class SI{static var TI=0;var YE=TI++ ;var target=null;var TE=false;SI(this.target,this.TE);} wE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class xE{static  yE( g){return g;}}class eI implements pC{final  GO;final  IO;final  MO=new List<jH>();var RO;var SO;var WO;var XM;var LM;var dO;var gO;var jO;eI( g, h,[ transitionFunction( ratio)]):GO=g,IO=(transitionFunction!=null)?transitionFunction:xE.yE{LM=0.0;XM=ZB.max(0.0001,h);dO=0.0;gO=false;jO=false;} JE( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(GO!=null&&jO==false)MO.add(new jH(g,0.0,h));} moveTo( h, g){JE('x',h);JE('y',g);} DD( l){if(LM<XM||jO==false){LM=LM+l;if(LM>XM)LM=XM;if(LM>=0.0){if(jO==false){jO=true;for(int i=0;i<MO.length;i++ ){var g=MO[i];switch (g.name){case 'x':g.EC=GO.x;break;case 'y':g.EC=GO.y;break;case 'pivotX':g.EC=GO.tC;break;case 'pivotY':g.EC=GO.uC;break;case 'scaleX':g.EC=GO.ZC;break;case 'scaleY':g.EC=GO.aC;break;case 'rotation':g.EC=GO.OC;break;case 'alpha':g.EC=GO.alpha;break;}}if(RO!=null)RO();}var j=LM/XM;var k=IO(j);for(int i=0;i<MO.length;i++ ){var g=MO[i];var h=g.EC+k*(g.NH-g.EC);h=gO?h.round():h;switch (g.name){case 'x':GO.x=h;break;case 'y':GO.y=h;break;case 'pivotX':GO.tC=h;break;case 'pivotY':GO.uC=h;break;case 'scaleX':GO.ZC=h;break;case 'scaleY':GO.aC=h;break;case 'rotation':GO.OC=h;break;case 'alpha':GO.alpha=h;break;}}if(SO!=null)SO();if(WO!=null&&LM==XM)WO();}}return LM<XM;} get currentTime=>LM;} fI( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class bD extends oC{var DO;var tL;var UO;var XO;var cO;var eO;var hO;var mO;var nO;var pO;var qO;var rO;var sO;bD( h, g){iL=h;DO=g;DO.focus();tL=g.context2d;XO=new hB.HL(tL);cO=VD.oE;eO=mB.qE;kE.KI.listen(KI);nO=[new vF(p.hC,p.aD,p.qC,p.BI),new vF(p.WI,p.ZI,p.QG,p.QG),new vF(p.dI,p.hI,p.RG,p.RG)];mO=null;hO=new DB(0,0);qO=new p(p.qC,true);DO.onMouseDown.listen(iN);DO.onMouseUp.listen(iN);DO.onMouseMove.listen(iN);DO.onMouseOut.listen(iN);DO.onMouseWheel.listen(CP);pO=new Map<int,SI>();sO=new OB(OB.zF,true);HG.aI.listen(DP);DP(null);rO=new GC(GC.pE,true);DO.onKeyDown.listen(EP);DO.onKeyUp.listen(EP);DO.onKeyPress.listen(FP);} get focus=>UO;HP(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){HP();} set y( g){HP();} set tC( g){HP();} set uC( g){HP();} set ZC( g){HP();} set aC( g){HP();} set OC( g){HP();} set alpha( g){HP();} set width( g){HP();} set height( g){HP();}hJ(){if(cO==VD.oE||cO==VD.FG){XO.reset();TB(XO);if(cO==VD.FG)cO=VD.xH;}}KI( g){DO.style.cursor=kE.TG(eO);}iN( j){j.preventDefault();var JB=DO.getBoundingClientRect();var q=new DateTime.now().millisecondsSinceEpoch;var EB=j.button;var h=null;var i=new DB(j.client.x-JB.left,j.client.y-JB.top);var n=null;if(EB<0||EB>2)return;if(j.type=="mousemove"&&hO.equals(i))return;var g=nO[EB];hO=i;if(j.type!="mouseout")h=AC(i.x,i.y) as GB;var l=mB.qE;if(h is AD)if(h.eF)l=mB.rE;if(h is zD)if(h.eF)l=mB.rE;if(eO!=l){eO=l;DO.style.cursor=kE.TG(l);}if(mO!=null&&mO!=h){mO.dispatchEvent(qO..CO(p.GE,true)..yO=(mO.WE!=null)?mO.XC(i):new DB.FL()..zO=i..tO=g.UC);mO=null;}if(h!=null&&h!=mO){h.dispatchEvent(qO..CO(p.NG,true)..yO=h.XC(i)..zO=i..tO=g.UC);mO=h;}var k=null;var AB=false;var NB=false;if(j.type=="mousedown"){k=g.rG;if(h!=g.target||q>g.HF+500)g.dD=0;g.UC=true;g.target=h;g.HF=q;g.dD++ ;}if(j.type=="mouseup"){k=g.tG;g.UC=false;AB=(g.target==h);NB=AB&&g.dD.isEven&&(q<g.HF+500);}if(j.type=="mousemove"){k=p.tE;}if(k!=null&&h!=null){n=h.XC(i);h.dispatchEvent(qO..CO(k,true)..yO=n..zO=i..tO=g.UC..vO=g.dD);if(AB){if(NB&&h.MJ){h.dispatchEvent(qO..CO(g.qG,true)..yO=n..zO=i..tO=g.UC);}else{h.dispatchEvent(qO..CO(g.pG,true)..yO=n..zO=i..tO=g.UC);}}}}CP( g){var j=DO.getBoundingClientRect();var h=new DB(g.client.x-j.left,g.client.y-j.top);var i=AC(h.x,h.y) as GB;if(i!=null){i.dispatchEvent(qO..CO(p.OG,true)..yO=i.XC(h)..zO=h..wO=g.deltaX..xO=g.deltaY);if(qO.XE)g.preventDefault();}}var NP=[] ;DP( h){NP.forEach((g)=>g.cancel());if(HG.oI==qF.EI){NP=[DO.onTouchStart.listen(OP),DO.onTouchEnd.listen(OP),DO.onTouchMove.listen(OP),DO.onTouchEnter.listen(OP),DO.onTouchLeave.listen(OP),DO.onTouchCancel.listen(OP)];}}OP( j){j.preventDefault();var q=DO.getBoundingClientRect();for(var n in j.changedTouches){var l=n.identifier;var i=new DB(n.client.x-q.left,n.client.y-q.top);var h=AC(i.x,i.y) as GB;var g=pO.containsKey(l)?pO[l]:new SI(h,pO.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(sO..CO(OB.QI,true)..yO=(g.target.WE!=null)?g.target.XC(i):new DB.FL()..zO=i..HO=g.YE..JO=g.TE);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(sO..CO(OB.OI,true)..yO=h.XC(i)..zO=i..HO=g.YE..JO=g.TE);g.target=h;}var k=null;if(j.type=="touchstart"){pO[l]=g;k=OB.zF;}if(j.type=="touchend"){pO.remove(l);k=OB.EG;}if(j.type=="touchcancel"){pO.remove(l);k=OB.GG;}if(j.type=="touchmove"){k=OB.MG;}if(k!=null&&h!=null){h.dispatchEvent(sO..CO(k,true)..yO=h.XC(i)..zO=i..HO=g.YE..JO=g.TE);}}}EP( g){g.preventDefault();var h=null;if(g.type=="keyup")h=GC.DG;if(g.type=="keydown")h=GC.pE;rO..CO(h,true)..aN=g.altKey..dN=g.ctrlKey..gN=g.shiftKey..rN=g.charCode..tN=g.keyCode..vN=BD.pH;if(g.keyLocation==xC.KeyLocation.LEFT)rO.vN=BD.JG;if(g.keyLocation==xC.KeyLocation.RIGHT)rO.vN=BD.FE;if(g.keyLocation==xC.KeyLocation.NUMPAD)rO.vN=BD.FI;if(g.keyLocation==xC.KeyLocation.JOYSTICK)rO.vN=BD.IG;if(g.keyLocation==xC.KeyLocation.MOBILE)rO.vN=BD.IG;if(UO!=null)UO.dispatchEvent(rO);}FP( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new wF(wF.zH,true);h.zL=new String.fromCharCodes([i]);if(UO!=null)UO.dispatchEvent(h);}} jI( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} kI(){var g=new xC.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} zE( g, n, JB, j){var mC=0.0;var sB=0.0;var EB=n*g.a;var bB=n*g.b;var NB=n*g.a+JB*g.c;var AB=n*g.b+JB*g.d;var XB=JB*g.c;var q=JB*g.d;var h=mC;if(h>EB)h=EB;if(h>NB)h=NB;if(h>XB)h=XB;var i=sB;if(i>bB)i=bB;if(i>AB)i=AB;if(i>q)i=q;var l=mC;if(l<EB)l=EB;if(l<NB)l=NB;if(l<XB)l=XB;var k=sB;if(k<bB)k=bB;if(k<AB)k=AB;if(k<q)k=q;if(j==null)j=new HB.FL();j.x=g.fB+h;j.y=g.gB+i;j.width=l-h;j.height=k-i;return j;}var rI=kI();//@ sourceMappingURL=supersonic.dart.map
