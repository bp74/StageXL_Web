import "dart:json" as TK;import "dart:math" as ZB;import "dart:web_audio" as JH;import "dart:async" as YB;import "dart:html" as vC;class UK{static const  VK="Chrome";static const  WK="Firefox";static const  XK="Internet Explorer";static const  YK="Safari";final  wI;final  minimumVersion;const UK(this.wI,[this.minimumVersion]);}class ZK{final  name;const ZK(this.name);}class MH extends WE{var pC;var ZC;var BC;var AC;var LC;var JC;var KC;var font;var YF=30;var QE;MH( h,[ fontName=vD]):super(h){this.font=fontName;this.qC();var g=new StringBuffer();g.write((this.u as tB).fB("GENlevel"));g.write(": 0");AC.text=g.toString();} qC(){this.pC=new iB(m.LB("items").CB("topbar"));this.pC.x=0;this.pC.y=0;this.w(this.pC);this.ZC=new fC();this.ZC.UC=new oF(font,24,0,bold:true,align:nB.FG);this.ZC.uC=0x000000;this.ZC.width=400;this.ZC.height=100;this.ZC.x=20;this.ZC.y=YF;this.w(ZC);this.BC=new fC();this.BC.UC=new oF(font,24,0,bold:true,align:nB.CE);this.BC.uC=0x000000;this.BC.width=200;this.BC.height=100;this.BC.x=(this.u.JE/2)-this.BC.width+60;this.BC.y=YF;this.w(BC);this.AC=new fC();this.AC.UC=new oF(font,24,0,bold:true,align:nB.CE);this.AC.uC=0x000000;this.AC.width=200;this.AC.height=100;this.AC.x=(this.u.JE)-(this.AC.width)-20;this.AC.y=YF;this.w(AC);this.LC=new fC();this.LC.UC=new oF(font,24,0,bold:true,align:nB.AE);this.LC.uC=0x000000;this.LC.width=200;this.LC.height=100;this.LC.x=20;this.LC.y=this.u.ZG-this.LC.height-20;this.w(LC);this.LC.visible=false;this.JC=new iB(m.LB("items").CB("progressbar"));this.JC.x=25;this.JC.y=82;this.w(this.JC);this.KC=new iB(m.LB("items").CB("progressship"));this.KC.x=25;this.KC.y=this.JC.y+(this.JC.height-(this.JC.height-this.KC.height))-(this.KC.height);this.w(this.KC);this.QE=new List<iB>();for(var h=0;h<3;h++ ){var g=new iB(m.LB("items").CB("spaceship"));g.y=10;g.x=(this.u.JE/2)+70+(h*35);this.w(g);this.QE.add(g);}} rG( g){this.KC.x=25;this.KC.y=this.JC.y+(this.JC.height-((this.JC.height-this.KC.height)*g.u.jD))-(this.KC.height);} qG( i){var h=i.u as tB;if(h.LD){this.BC.text=h.fB("DISPLAY_TRAINING");}else{this.BC.text=h.fB("DISPLAY_LIVES");}for(var g=0;g<this.QE.length;g++ ){this.QE[g].visible=(!h.LD)&&(g<i.u.ID);}} tG( h){var i=h.u as tB;var g=new StringBuffer();g.write(i.fB("GENscore"));g.write(": ${h.u.FK.toString()}");ZC.text=g.toString();} NE( h){var i=h.u as tB;var g=new StringBuffer();g.write(i.fB("GENlevel"));g.write(": ${h.u.level.toString()}");AC.text=g.toString();}}class PC{var x;var y;PC(this.x,this.y);set length( g){this.normalize();this.aJ(g);} get length{return ZB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new PC(x,y);} add( g){if(g==null)return null;return new PC(x+g.x,y+g.y);}aJ( g){x*= g;y*= g;} get zE{var g=ZB.PI-ZB.atan2(this.x,this.y);if(g<0)g+= 2*ZB.PI;return g;}set zE( i){var h=this.length;var g=EB.SI(h,i-ZB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class bC{var x;var y;var z;bC(this.x,this.y,this.z); clone(){return new bC(x,y,z);} cG(){return ZB.sqrt(x*x+y*y+z*z);}GK( g){this.normalize();this.scale(g);} add( g){return new bC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=cG();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} equals( g){return (g.x==x&&g.y==y&&g.z==z);}}class UB extends WE implements dC{static var lD=588;static var QD=314;static var SH=10.0;var pC;var rB;var OL;var XF;var GC;UB( g,[ autoStart=true, fontName=vD]):super(g){this.GC=fontName;this.width=UB.lD;this.height=UB.QD;this.pC=new iB(m.LB("items").CB("menu_bg"));this.w(this.pC);this.rB=new fC();this.rB.uC=0x000000;this.rB.wordWrap=true;this.rB.UC=new oF(fontName,30,0x000000,bold:true,align:nB.AE);this.rB.width=476;this.rB.height=250;this.rB.x=60;this.rB.y=90;this.w(this.rB);this.t(p.gC,this.onClick);if(autoStart){this.HH=0;this.XF=0;aB.add(this);}else{this.HH=1;}this.alpha=0;} BD( g){this.XF+= g;if(this.XF>SH){dD();IF();return false;}return true;}set text( g){if(g==null)return;var h=new oF(GC,30,0x000000,bold:true,align:nB.AE);if(g.length<=30)h.size=45;else h.size=30;this.rB.UC=h;this.rB.text=g;} onClick( g){dD();IF();} IF(){this.dispatchEvent(new KB(KB.vB,this));}set HH( g){if(g<0)g=1;if(g>1)g=1;OL=g;var h=(255*OL).round().toInt();} dD(){aB.remove(this);}}class KB extends BB{static const  vB="MenuEvent.TYPE_OK";static const  mD="MenuEvent.TYPE_CANCEL";var LE;KB( h, g,[ bubbles=false]):super(h,bubbles){this.LE=g;}}class KH extends UB{var oB;var iC;var aC;var NC;var RG=40;var SG=30;var GC;KH( g,[ fontName=vD]):super(g,true,fontName){this.GC=fontName;this.VB(p.oC);this.VB(p.gC);this.qC();} qC(){var g=this.u as tB;this.rB.wordWrap=true;this.text=g.fB("GENexitquery");this.oB=new wD(new iB(m.LB("items").CB("but_yes")),new iB(m.LB("items").CB("but_yes2")),new iB(m.LB("items").CB("but_yes2")),new iB(m.LB("items").CB("but_yes2")));this.oB.x=SG;this.oB.y=UB.QD-this.oB.height-RG;this.oB.t(p.oC,this.PK);this.w(this.oB);this.iC=new wD(new iB(m.LB("items").CB("but_no")),new iB(m.LB("items").CB("but_no2")),new iB(m.LB("items").CB("but_no2")),new iB(m.LB("items").CB("but_no2")));this.iC.x=UB.lD-this.iC.width-SG;this.iC.y=UB.QD-this.oB.height-RG;this.iC.t(p.oC,this.oG);this.w(this.iC);this.aC=new fC();this.aC.t(p.oC,this.oB.dispatchEvent);this.aC.uC=0x000000;this.aC.UC=new oF(GC,48,0,bold:true,align:nB.FG);this.aC.height=60;this.aC.x=this.oB.x+this.oB.width;this.aC.y=this.oB.y+5;this.w(this.aC);this.aC.text=g.fB("GENyes");this.NC=new fC();this.NC.t(p.oC,this.iC.dispatchEvent);this.NC.uC=0x000000;this.NC.UC=new oF(GC,48,0,bold:true,align:nB.CE);this.NC.height=60;this.NC.x=this.iC.x-this.NC.width;this.NC.y=this.oB.y+5;this.w(this.NC);this.NC.text=g.fB("GENno");}IF(){oG(null);} PK( g){dD();this.dispatchEvent(new KB(KB.vB,this));} oG( g){dD();this.dispatchEvent(new KB(KB.mD,this));}}class o extends BB{static const  PD="GameEvent.TYPE_LIVES_CHANGED";static const  nD="GameEvent.TYPE_PROGRESS_CHANGED";static const  oD="GameEvent.TYPE_PAUSE_CHANGED";static const  pD="GameEvent.TYPE_LEVEL_CHANGED";static const  qD="GameEvent.TYPE_SCORE_CHANGED";static const  rD="GameEvent.TYPE_GAME_START";static const  sD="GameEvent.TYPE_GAME_OVER";static const  tD="GameEvent.TYPE_GAME_ABORT";static const  bE="GameEvent.TYPE_GAME_SIZE_CHANGED";var u;o( h, g,[ bubbles=false]):super(h,bubbles){this.u=g;}}class WE extends yC{var EL;WE( g){this.u=g;}set u( g){if(EL!=null){EL.VB(o.sD);EL.VB(o.tD);EL.VB(o.bE);EL.VB(o.rD);EL.VB(o.pD);EL.VB(o.oD);EL.VB(o.qD);EL.VB(o.PD);EL.VB(o.nD);}EL=g;if(EL!=null){EL.t(o.sD,this.QF);EL.t(o.tD,this.PF);EL.t(o.bE,this.pG);EL.t(o.rD,this.RF);EL.t(o.pD,this.NE);EL.t(o.oD,this.lJ);EL.t(o.qD,this.tG);EL.t(o.PD,this.qG);EL.t(o.nD,this.rG);}} get u{return EL;} QF( g){} PF( g){} pG( g){} RF( g){} NE( g){} lJ( g){} tG( g){} qG( g){} rG( g){}}class tB extends uB{static const  fF=1.0;static const  QH=100;static const  RH=0xFFFFFF;var KK=fF;var PJ=5;var FD;var gG=false;var yG=500;var vI=0xffffff;var pB;var IB;var HD;var PL=true;var ME=false;var aG=60.0;var eD;var GC=vD;var MF=false;var tJ="Web";tB( h, g):super(h,g){this.t(BB.yF,(i){print("Event.ADDED_TO_STAGE");this.WJ();});}set LD( g){PL=g;this.dispatchEvent(new o(o.PD,this));} get LD{return PL;} WJ(){if(!gG){this.t(p.YD,(g)=>this.ME=false);this.t(p.gC,(g)=>this.ME=true);this.xJ();this.t(o.rD,this.RF);this.t(o.PD,this.jJ);this.t(o.nD,this.mJ);this.t(o.qD,this.nJ);this.t(o.pD,this.onLevelChange);this.t(o.oD,this.kJ);this.t(o.sD,this.QF);this.t(o.tD,this.PF);this.qC();this.jD=0;this.JD=0;this.ID=3;this.start();gG=true;}} fB( i,[ params=null]){var h=m.TJ(i);if(params!=null)for(int g=0;g<params.length;g++ )h=h.replaceAll("{${g}}",params[g].toString());return h;} xJ(){this.KK=fF;this.vI=RH;this.yG=QH;this.PJ=5;this.aG=60000;} qC(){this.FD=new wC(this);this.w(this.FD);var h=m.LB("items").CB("button_exit");var g=m.LB("items").CB("button_exit_2");this.pB=new wD(new iB(h),new iB(g),new iB(h),new iB(g));this.pB.width=75;this.pB.height=66;this.pB.x=707;this.pB.y=525;this.pB.t(p.gC,gJ);this.w(this.pB);this.pB.visible=false;this.HD=new MH(this,GC);this.HD.x=0;this.HD.y=0;this.w(this.HD);} DJ(){var g=this.DD();g.text=this.fB("MESSAGE_RESTART_LEVEL");g.t(KB.vB,this.sG);} zI( h){var g=this.DD();g.text=this.fB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.t(KB.vB,this.sG);} sG( g){this.tC(g.LE);this.FD.xI();} XG(){this.FD.KF();var g=this.DD();if(this.level==0){g.text=this.fB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.fB("MESSAGE_START_LEVEL",[(this.level+1)]);}g.t(KB.vB,this.pJ);} pJ( g){this.tC(g.LE);this.bJ();} AJ(){var g=this.DD();g.text=this.fB("MESSAGE_GAME_OVER");g.t(KB.vB,this.hJ);} hJ( g){this.tC(g.LE);} DD([ menu=null, tweenDuration=1.0, autoStart=true]){if(this.IB!=null)this.tC(this.IB);this.pB.visible=false;this.HD.visible=true;if(menu==null)this.IB=new UB(this,autoStart,GC);else this.IB=menu;this.IB.width=UB.lD;this.IB.height=UB.QD;this.IB.x=(this.JE/2)-(UB.lD/2)+30;this.IB.y=(this.ZG/2)-(UB.QD/2);this.IB.alpha=0;this.w(this.IB);var g=new YI(this.IB,tweenDuration,uE.vE);g.GE("alpha",1);aB.add(g);return this.IB;} tC( g){this.paused=false;this.HD.visible=true;this.pB.visible=true;if(g==null)return;g.dD();if(this.contains(g)){this.qB(g);}this.IB=null;} RJ(){aB.remove(eD);if(this.MF)this.uG(null);this.ME=true;this.LD=false;} oJ(){if(this.IB!=null)return;if(tJ.toLowerCase()=="web")return;aB.remove(eD);this.eD=new fE(this.RJ,this.aG);aB.add(this.eD);this.MF=true;this.paused=true;var g=this.DD(null,200,false);this.pB.visible=true;g.text=this.fB("MESSAGE_FIRST_LEVEL");g.t(KB.vB,this.uG);} uG( g){aB.remove(this.eD);this.MF=false;this.IB.VB(KB.vB);this.tC(this.IB);} gJ( h){if(this.IB is KH)return;var g=new KH(this,GC);this.DD(g);this.paused=true;g.t(KB.vB,this.dJ);g.t(KB.mD,this.cJ);} dJ( g){this.dispatchEvent(new o(o.tD,this));this.IB.VB(KB.vB);this.IB.VB(KB.mD);this.tC(this.IB);this.paused=true;} cJ( g){this.IB.VB(KB.vB);this.IB.VB(KB.mD);this.tC(IB);} RF( g){this.FD.KF();aB.IE(this.XG,0.5);} JJ(){this.FD.KF();} mJ( g){} jJ( g){} nJ( g){} onLevelChange( g){} kJ( g){} QF( g){aB.IE(this.AJ,2.0);} PF( g){}}class wC extends WE{static var dF=0.025;static var YE=1.0;static var xC=600;static var ZE=800;static var aE=600;static var gF=400;static var hF=300;static var RD=ZB.sqrt(ZE*ZE+aE*aE);static var UH=(RD*2/xC);static var iF=6;var PB;var RB;var HC;var WC;var WF=30.0*ZB.PI/180;var VF=1.0*ZB.PI/180;var MD=0.05;var TF=-1;var OE=1;var MB;var hC;var AF=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var BF;var CF;var UG;var yI;var FH;var UF=15;var hG;var ED=false;var HE=0;var JF;var FE;var xE=0.90;var zG=0;var QL;var dK;var WB;var OJ=0;var FC;var CD=false;var NF,OF;var dG;var hD;wC( g):super(g){QL=new jE.wK(80,60,690,524);this.mask=QL;this.BF=m.LF("speedalizer");this.CF=this.BF.play(true);this.WB=new kF();this.w(this.WB);dG=new bH(800,600);w(dG);NF=OF=0;DC.t(p.qE,this.SF);DC.t(p.gC,this.SF);DC.t(p.YD,this.SF);hD=this.fJ.listen(this.RL);} SF( g){NF=g.BH;OF=g.CH;} wJ(){var g=this.u.JD;this.u.JD=g+(this.u as tB).yG*(this.u.level*this.u.ID);} pG( g){} NE( g){super.NE(g);this.LK();} LK(){CD=false;hD.pause();this.HE=0;this.u.jD=0;this.ED=false;var h=60;this.WC=new PH(RD,iF*h);for(var g=this.WC.AB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.WC.wG(g);this.PB=new PC(gF,hF);this.RB=new bC(0,0,0);this.HC=new bC(0,0,YE);this.VF=(1+(0.1*this.u.level))*ZB.PI/180;this.MD=0.015+(0.004*this.u.level);this.OE=2+this.u.level;this.TF=-this.OE;this.zG=this.u.level*2;this.UF=15+(this.u.level);this.qC();this.BJ();hD.resume();} qC(){if(this.MB!=null)this.qB(this.MB);this.MB=new LH();this.w(this.MB);if(this.FC!=null)this.qB(this.FC);this.FC=new iB(m.LB("items").CB("crosshair"));this.FC.XC=0.5;this.FC.YC=0.5;this.FC.x=(ZE/2)-this.FC.width/2;this.FC.y=(aE/2)-this.FC.height/2;this.w(this.FC);} KF(){this.CD=false;this.hD.pause();var h=60;this.WC=new PH(RD,iF*h);for(var g=this.WC.AB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.WC.wG(g);this.PB=new PC(gF,hF);this.RB=new bC(0,0,0);this.HC=new bC(0,0,YE);this.VF=2*ZB.PI/180;this.OE=0;this.TF=0;if(this.MB!=null){this.qB(this.MB);this.MB=null;}this.MB=new LH();this.w(this.MB);if(this.hC!=null){this.qB(this.hC);this.hC=null;}this.WG();this.hD.resume();} WG(){var g=new OC(null);g.TC=-1;g.CC=0;g.position=this.RB.clone();g.position.z=0.5;this.MB.AD(g);} VG(){var g=new OC(new iB(m.LB("items").CB("countdown01")));g.TC=0;g.CC=0;g.position=this.RB.clone();g.position.z=0.5;g.cD=0;g.fD=true;this.MB.AD(g);g=new OC(new iB(m.LB("items").CB("countdown02")));g.TC=0;g.CC=0;g.position=this.RB.clone();g.position.z=0;g.cD=1;g.fD=true;this.MB.AD(g);g=new OC(new iB(m.LB("items").CB("countdown03")));g.TC=0;g.CC=0;g.position=this.RB.clone();g.position.z=-0.5;g.cD=2;g.fD=true;this.MB.AD(g);g=new OC(new iB(m.LB("items").CB("countdown04")));g.TC=0;g.CC=0;g.position=this.RB.clone();g.position.z=-1;g.cD=3;g.fD=true;this.MB.AD(g);} CJ(){var h=1+this.u.level;if(h>=this.AF.length)h=this.AF.length-1;var i=OD.eF(0,h);var j=this.AF[i];var g=new OC(new iB(m.CB(j)));g.kC=true;g.MC=OD.eF(0,359)*ZB.PI/180;g.CC=OD.TH(this.TF,this.OE)*ZB.PI/180;g.position=this.RB.clone();return g;} BJ(){this.VG();this.WG();var h=0;for(var i=0;i<UF;i++ ){var g=null;if(i==UF-1){g=new OC(new iB(m.CB("finish")));g.MC=0;g.CC=5*ZB.PI/180;g.position=this.RB.clone();g.TC=0;g.kC=true;g.fG=true;this.JF=g;}else{h++ ;if(this.u.level==1&&h<=3){if(h==1){g=new OC(new iB(m.CB("training01")));g.kC=true;g.MC=0;g.CC=0;g.position=this.RB.clone();g.KD=1;}else if(h==2){g=new OC(new iB(m.CB("training02")));g.kC=true;g.MC=135*ZB.PI/180;g.CC=0;g.position=this.RB.clone();g.KD=2;}else if(h==3){g=new OC(new iB(m.CB("training02")));g.kC=true;g.MC=315*ZB.PI/180;g.CC=0;g.position=this.RB.clone();g.KD=3;}}else{g=this.CJ();}}g.iD=-i*1-3;g.position.z=g.iD;g.TC=0;this.MB.AD(g);}} iJ(){this.ED=false;var g=u as tB;g.JJ();g.XG();} RL( h){if(this.u.paused==false){this.zJ();var g=this.u as tB;if(g.LD&&this.CD&&!g.ME)g.oJ();}else{gD=-1;}} KE( h){var g=new EB(this.PB.x,this.PB.y);g=this.iG(g);g=h.VC(g);return h.KE(g);} xI(){this.CD=false;for(var g=0;g<this.MB.IC.length;g++ )this.MB.IC[g].position.z-= (2.5+1-xE)+1;FE.position.z+= (1-xE);this.VG();this.ED=false;this.MD=this.hG;this.hC.visible=false;} eJ(){var g=this.u as tB;g.pB.visible=false;this.ED=false;this.CD=false;this.hG=this.MD;this.MD=0;if(this.hC!=null)this.qB(this.hC);this.hC=new iB(m.CB("broken"));this.w(this.hC);if(this.FE.KD>0&& ++this.OJ<=5){aB.IE((){g.zI(this.FE.KD);},2.0);}else{this.u.ID-- ;if(this.u.ID>0)aB.IE(g.DJ,2.0);}this.CF.stop();this.CF=this.BF.play(true);this.UG=m.LF("crash");this.yI=this.UG.play();}var gD=-1; zJ(){var k=aB.elapsedTime;var h=1.0;if(gD==-1)gD=k;h=ZB.min(k-gD,1.0000)*40;gD=k;if(ED){this.HE-= (this.MD*h);var q=this.u.JD;this.u.JD=q+(this.zG*h);}this.MB.JK();this.WF+= (this.VF*h);this.HC.x=-(this.NF-this.PB.x)*3;this.HC.y=-(this.OF-this.PB.y)*3;if(this.HC.cG()>RD*0.7){this.HC.GK(RD*0.7);}this.HC.z=YE;this.RB=this.HC.clone();this.RB.z=dF;this.yJ();for(var n=0;n<this.MB.IC.length;n++ ){var g=this.MB.IC[n];g.position.z+= (MD*h);if(g.position.z>=1){if(g.fD&&g.cD==3)CD=true;if(g.aD!=null){this.FH=m.LF("swish");var v=this.FH.play();}if(g.kC)ED=true;if(g.iD!=0)this.HE=g.iD;if(g.kC&&KE(g)){g.position.z=xE;FE=g;this.eJ();}else{if(g.KD==3)(this.u as tB).LD=false;if(g.kC)this.wJ();if(g.fG){this.iJ();}else if(g.TC==0){this.MB.CK(g);}else{g.position.z+= g.TC;}}}var i=this.HC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.VE(i);j=j.add(this.PB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.MC+= (g.CC*h);g.setScale(ND(g.position.z)*UH);}}if(this.JF!=null)this.u.jD=(this.HE+3)/(this.JF.iD+3);} VE( g){var h=new PC(g.x,g.y);h.x*= ND(g.z);h.y*= ND(g.z);return h;} ND( g){var h=dF;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} yJ(){if(WB==null)return;var l=2;var j=this.HC.clone();j.scale(l);var h=this.WC.transform(ND(j.z)*l,this.WF,this.VE(j));var i=this.WC.transform(ND(this.RB.z),this.WF,this.VE(this.RB));var k=this.VE(this.RB).add(this.PB);WB.QB.clear();WB.QB.beginPath();WB.QB.TG(k.x,k.y,this.WC.vG*ND(this.RB.z));WB.QB.closePath();WB.QB.DH(0xffcccccc,1);WB.QB.beginPath();for(var g=0;g<h.AB.length;g+= 2){WB.QB.moveTo(h.AB[g].x+this.PB.x,h.AB[g].y+this.PB.y);WB.QB.lineTo(h.AB[g+1].x+this.PB.x,h.AB[g+1].y+this.PB.y);WB.QB.lineTo(i.AB[g+1].x+this.PB.x,i.AB[g+1].y+this.PB.y);WB.QB.lineTo(i.AB[g].x+this.PB.x,i.AB[g].y+this.PB.y);WB.QB.lineTo(h.AB[g].x+this.PB.x,h.AB[g].y+this.PB.y);}WB.QB.closePath();WB.QB.IJ(0xFF000000);}}class OC extends yC{var CL;var GL;var IL;var position;var TC=-1;var CC=0;var IK=1;var kC=false;var fG=false;var fD=false;var nK=false;var cD=0;var KD=0;var iD=0;OC( g){IL=new yC();w(IL);this.aD=g;if(this.aD==null)return;this.x=100000;}set aD( g){if(CL!=null)this.qB(CL);if(GL!=null)this.qB(GL);CL=null;GL=null;if(g!=null){CL=g;CL.rC=wC.xC/2;CL.sC=wC.xC/2;w(CL);}else{GL=new kF();w(GL);}w(IL);} get aD{return CL;} setScale( g){this.IK=g;if(GL!=null){GL.QB.clear();GL.QB.beginPath();GL.QB.TG(0,0,wC.xC/2*g);GL.QB.closePath();GL.QB.DH(0xff999999,1);}if(CL!=null)CL.XC=CL.YC=g;IL.XC=IL.YC=g;} KE( j){if(CL==null)return false;var g=this.iG(j);g=CL.VC(g);var k=this.aD.bitmapData.SJ(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new iB(m.LB("items").CB("blood"));h.rC=50;h.sC=50;h.x=g.x-wC.xC/2;h.y=g.y-wC.xC/2;IL.w(h);}return i;}}class LH extends yC{var IC;LH(){IC=new List<OC>();} JK(){this.IC.sort(QK);} AD( g){if(this.contains(g))return;this.w(g);this.IC.add(g);} CK( g){if(this.IC.length>0){var h=this.IC.indexOf(g);if(h>=0)this.IC.removeAt(h);}if(this.contains(g))this.qB(g);} QK( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.GD(g)<this.GD(h))this.EH(g,h);return 1;}if(g.position.z<h.position.z){if(this.GD(g)>this.GD(h))this.EH(g,h);return -1;}return 0;}}class OD{static var cF=new ZB.Random();static  eF( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=OD.cF.nextInt(h+1)+g;}return i;}static  TH( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=OD.cF.nextDouble()*(h-g)+g;}return i;}}class PH extends XE{var BL;var FL;PH( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.BL=h;this.FL=g;EJ();} get vG{return BL;} EJ(){var g=new List<PC>();var h=0.0;var k=2*ZB.PI/FL;for(var j=0;j<FL;j++ ){var i=new PC(0,-BL);i.zE=h;g.add(i);h+= k;}this.AB=g;}}class XE implements NH,OH{var AB;XE([ pointList]){this.AB=(pointList!=null)?pointList:new List();}wG( g){if(g<AB.length)this.AB.removeAt(g);} KE( h){var k=this.AB.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(AB[g].y<h.y&&AB[i].y>=h.y||AB[i].y<h.y&&AB[g].y>=h.y){if(AB[g].x+(h.y-AB[g].y)/(AB[i].y-AB[g].y)*(AB[i].x-AB[g].x)<h.x){j=!j;}}i=g;}return j;} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.AB.length;var i=new List<PC>(j);for(var g=0;g<j;g++ ){var k=this.AB[g].clone();k.scale(h);i[g]=k;}return new XE(i);} transform( l, k, n){var j=this.AB.length;var i=new List<PC>(j);for(var g=0;g<j;g++ ){var h=this.AB[g].clone();h.scale(l);h.zE+= k;i[g]=h.add(n);}return new XE(i);}}abstract class OH{}abstract class NH{}class uB extends yC{var DL=0;var HL=0;var JL=true;var KL=3;var LL=0.0;var ML;var NL;uB( h, g){HK(h,g);} HK( g, h){ML=g;NL=h;this.dispatchEvent(new o(o.bE,this));} get JE{return ML;} get ZG{return NL;} start(){this.paused=false;this.dispatchEvent(new o(o.rD,this));} QJ(){this.dispatchEvent(new o(o.sD,this));}set jD( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;LL=g;this.dispatchEvent(new o(o.nD,this));} get jD{return LL;}set ID( g){if(g<0)g=0;KL=g;this.dispatchEvent(new o(o.PD,this));if(KL==0)this.QJ();} get ID{return KL;}set JD( g){if(g<0)g=0;DL=g;this.dispatchEvent(new o(o.qD,this));} get JD{return DL;} get FK{return DL.toDouble().round().toInt();}set level( g){if(g<0)g=0;HL=g;this.dispatchEvent(new o(o.pD,this));} get level{return HL;} bJ(){this.level+= 1;return this.level;}set paused( g){JL=g;this.dispatchEvent(new o(o.oD,this));} get paused{return JL;}}var DC;var cE;var m;var aB;var VH;var cC;var uD;var wB;const  vD="Russo One"; main(){DC=new ZD("Stage",vC.query('#stage'));cE=new aH();cE.rI(DC);aB=cE.YJ;VH=new ZB.Random();var g=eB.QG("images/Loading.png");g.then((h){cC=new iB(h);cC.rC=20;cC.sC=20;cC.x=400;cC.y=270;DC.w(cC);uD=new YI(cC,100,uE.vE);uD.GE("rotation",100.0*2.0*ZB.PI);aB.add(uD);wB=new fC();wB.UC=new oF("Arial",20,0xA0A0A0,bold:true);wB.width=240;wB.height=40;wB.text="... loading ...";wB.x=400-wB.NK/2;wB.y=320;wB.mG=false;DC.w(wB);WH();});} WH(){m=new wF();m.yB("barrier01","images/barrier01.png");m.yB("barrier02","images/barrier02.png");m.yB("barrier03","images/barrier03.png");m.yB("barrier04","images/barrier04.png");m.yB("barrier05","images/barrier05.png");m.yB("barrier06","images/barrier06.png");m.yB("barrier07","images/barrier07.png");m.yB("training01","images/training01.png");m.yB("training02","images/training02.png");m.yB("finish","images/finish.png");m.yB("broken","images/broken.png");m.sI("items","images/ItemTextureAtlas.json",dE.xF);m.yE("crash","sounds/crash.mp3");m.yE("swish","sounds/swish.mp3");m.yE("speedalizer","sounds/speedalizer.mp3");m.SB("DISPLAY_LEVEL","Level: {0}");m.SB("DISPLAY_LIVES","Ships:");m.SB("DISPLAY_SCORE","Score: {0}");m.SB("DISPLAY_TRAINING","Training");m.SB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");m.SB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");m.SB("MESSAGE_GAME_OVER","Game\nOver!");m.SB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");m.SB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");m.SB("GENscore","Score");m.SB("GENlevel","Level");m.SB("GENexitquery","Do you really want to quit the game?");m.SB("GENyes","Yes");m.SB("GENno","No");m.load().then((j){DC.qB(cC);DC.qB(wB);aB.remove(uD);var h=new tB(800,600);h.tI(DC);h.start();}).catchError((i){for(var g in m.YG){print("Loading resouce failed: ${g.kind}.${g.name} - ${g.error}");}});}class mB{static const  lE="auto";static const  nE="arrow";static const  oE="button";static const  BI="hand";static const  CI="ibeam";static const  FI="wait";}class aK extends QC{var mL;var DM;aK( i, h, g){mL=h;DM=g;}set RE( g){DM=g;} stop(){}}class YH{static const  qH="pixel";}class fC extends GB{var oL="";var BM=0x000000;var TM=null;var iM=fH.uH;var uM=YH.qH;var SL=hH.kH;var IN=false;var LN=false;var ON=0x000000;var VN=false;var aN=0x000000;var eN=0;var hN=0;var kN;var oN;var qN=true;var sN=100;var uN=100;var xN=null;var lL=null;fC(){TM=new oF("Arial",12,0x000000);kN=new List<String>();oN=new List<pF>();} get type=>SL; get width=>sN; get height=>uN; set text( g){oL=g;qN=true;} set uC( g){BM=g;qN=true;} set UC( g){TM=g;BM=TM.color;qN=true;} set wordWrap( g){IN=g;qN=true;} set width( g){sN=g;qN=true;} set height( g){uN=g;qN=true;} get NK{CP();return eN;} kB( g,[ returnRectangle]){return wE(g,sN,uN,returnRectangle);} zB( g, h){if(g>=0&&h>=0&&g<sN&&h<uN)return this;return null;} TB( g){CP();g.lL.drawImage(xN,0.0,0.0);} EP(){kN.clear();oN.clear();if(IN==false){kN.add(oL);}else{for(String q in oL.replaceAll('\r','').split('\n')){var h=new StringBuffer();var i=0;var g="";for(String j in q.split(' ')){i=h.length;h.write((i>0)?" ${j}":j);g=h.toString();if(lL.measureText(g).width>sN){if(i>0){g=g.substring(0,i);}else{j="";}kN.add(g);h=new StringBuffer();h.write(j);}}if(h.isEmpty==false){kN.add(h.toString());}}}eN=0;hN=0;for(String g in kN){var l=lL.measureText(g);var n=0;if(TM.align==nB.AE||TM.align==nB.xH)n=(sN-l.width)/2;if(TM.align==nB.CE||TM.align==nB.sH)n=sN-l.width;var k=new pF(n,l.width,TM.size,0,0,0);oN.add(k);eN=ZB.max(eN,k.width);hN=hN+k.height;}} CP(){if(qN){qN=false;var j=sN.ceil().toInt();var i=uN.ceil().toInt();if(xN==null){xN=new vC.CanvasElement(width:j,height:i);lL=xN.context2d;}if(xN.width!=j)xN.width=j;if(xN.height!=i)xN.height=i;var g=new StringBuffer();g.write(TM.italic?"italic ":"normal ");g.write("normal ");g.write(TM.bold?"bold ":"normal ");g.write("${TM.size}px ");g.write("${TM.font},sans-serif");lL.font=g.toString();lL.textAlign="start";lL.textBaseline="top";lL.fillStyle=XD(BM);EP();if(LN){lL.fillStyle=XD(ON);lL.fillRect(0,0,sN,uN);}else{lL.clearRect(0,0,sN,uN);}var k=0;for(int h=0;h<kN.length;h++ ){var l=oN[h];lL.fillStyle=XD(BM);lL.fillText(kN[h],l.x,k);k+= l.height;}if(VN){lL.strokeStyle=XD(aN);lL.lineWidth=1;lL.strokeRect(0,0,sN,uN);}}}}class fH{static const  uH="none";}class hH{static const  kH="dynamic";}abstract class QC extends RC{ set RE( g); stop();}class oF{var font;var size;var color;var bold;var italic;var underline;var align;var leftMargin;var rightMargin;var indent;var leading;var letterSpacing=0;var eK=0;var fK=false;var oK=false;oF(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.leftMargin: 0,this.rightMargin: 0,this.indent: 0,this.leading: 0});}class nB{static const  AE="center";static const  sH="end";static const  xH="justify";static const  FG="left";static const  CE="right";}class pF{var uI;var FJ;var height;var leading;var width;var x;pF(this.x,this.width,this.height,this.uI,this.FJ,this.leading);}class ZH{static const  oH="round";}class hE{static var sF=mB.lE;static var pH=false;static var AI=new YB.StreamController<String>();static var EI=AI.stream.asBroadcastStream();static  PG( i){var h=i;var g="auto";if(sF!=mB.lE)h=sF;switch (h){case mB.lE:g="auto";break;case mB.nE:g="default";break;case mB.oE:g="pointer";break;case mB.BI:g="move";break;case mB.CI:g="text";break;case mB.FI:g="wait";break;}if(pH)g="none";return g;}}class dB{var volume;var pan;var pK=1;var qK=0;var tK=1;var sK=0;dB([this.volume=1,this.pan=0]);}class dH{static const  oH="round";}class bH extends GB{var width;var height;bH(this.width,this.height); kB( g,[ returnRectangle]){return wE(g,width,height,returnRectangle);} zB( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} TB( g){}}class gE extends cB{var nL;var JM;var cM;gE(){cM=new List<xD>();nL=new vC.AudioElement();nL.onEnded.listen(KN);JM=new List<vC.AudioElement>();JM.add(nL);vC.document.body.children.add(nL);}static  QG( v){var k=new gE();var g=k.nL;var i=new YB.Completer<cB>();var h;var j;q(n){h.cancel();j.cancel();i.complete(k);}l(n){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(q);j=g.onError.listen(l);g.src=cB.OG(v);g.load();return i.future;} get length{return nL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new xD(this,loop,soundTransform);} cN( h){var g;if(JM.length==0){g=nL.clone(true);g.onEnded.listen(KN);}else{g=JM.removeAt(0);}cM.add(h);return g;} qO( g){var h=g.nL;var i=cM.indexOf(g);cM.removeAt(i);JM.add(h);if(nL.currentTime>0&&nL.ended==false)nL.currentTime=0;} KN(j){var i=j.target;var g=null;for(int h=0;h<cM.length&&g==null;h++ )if(cM[h].nL==i)g=cM[h];if(g!=null)g.stop();}}class jE{var SL;var ZL;var rL;var HM;jE.wK( i, g, h, j){SL=0;ZL=new HB(i,g,h,j);} TB( i){var g=i.context;g.beginPath();switch (SL){case 0:g.rect(ZL.x,ZL.y,ZL.width,ZL.height);break;case 1:g.arc(rL.x,rL.y,rL.vG,0,ZB.PI*2.0,false);break;case 2:g.moveTo(HM[0].x,HM[0].y);for(int h=1;h<HM.length;h++ )g.lineTo(HM[h].x,HM[h].y);break;}g.clip();}}class qF{static const  uH="none";static const  yH="touchPoint";}class UD{static var KI=aI();static var EE=fI();static var LG=gI();static  aI(){var h=(EE!=null)?"WebAudioApi":"AudioElement";var g=vC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(LG.length==0)h="Mock";print("dartflash: supported audio engine is: ${h}");return h;}static  fI(){try {return new JH.AudioContext();}catch (g){return null;}}static  gI(){var g=new List<String>();var h=new vC.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("dartflash: supported audio types are: ${g}");return g;}}class zC{static const  jH=0;static const  FG=1;static const  CE=2;static const  zH=3;static const  EG=4;}class eH{var name;var arguments;eH(this.name,[this.arguments]);}class xD extends QC{var AM;var nL;var mL;var DM;xD( g, i, h){AM=g;mL=i;DM=h;nL=g.cN(this);nL.loop=mL;this.RE=h;nL.play();} set RE( g){DM=g;if(nL!=null)nL.volume=(DM!=null)?DM.volume:1;} stop(){if(nL!=null){if(nL.ended==false)nL.pause();AM.qO(this);nL=null;}}}final  tF=new cH<List<s>>(()=>new List<s>());class fE implements dC{final  sL;var CM=0.0;var OM=0.0;var YM=1;fE( g, h):sL=g{OM=ZB.max(h,0.0001);} BD( h){var g=CM+h;while (g>=OM&&YM>0){CM=OM;YM-- ;sL();g-= OM;}CM=g;return (YM>0);} get currentTime=>CM;}abstract class dC{ BD( g);}class iE implements dC{final  vL=new List<dC>();var UM=0;var fM=0.0; get elapsedTime=>fM; add( g){if(g==null)return;if(this.contains(g))return;if(UM==vL.length){vL.add(g);}else{vL[UM]=g;}UM++ ;} remove( h){if(h==null)return;for(int g=0;g<UM;g++ ){if(vL[g]==h){vL[g]=null;break;}}} contains( h){if(h==null)return false;for(int g=0;g<UM;g++ ){if(vL[g]==h){return true;}}return false;} IE( h, i){var g=new fE(h,i);add(g);return g;} BD( k){fM+= k;var j=UM;var h=0;for(int g=0;g<j;g++ ){var i=vL[g];if(i==null)continue;if(i.BD(k)==false){vL[g]=null;continue;}if(h!=g){vL[h]=i;vL[g]=null;}h++ ;}if(h!=j){for(int g=j;g<UM;g++ ){vL[h++ ]=vL[g];vL[g]=null;}UM=h;}return true;}}class yD{var bL;var XL;var yL;var KM;var SM;var aM;yD( g, h, i){bL=g;XL=h;yL=i;SM=null;aM=null;} get kind=>bL; get name=>XL; get kD=>aM; get error=>SM;yN( i){KM=i.then((g){aM=g;SM=null;},onError:( h){aM=null;SM=h.error;});}}class gH{var name;var lB;var GH;gH(this.name,this.lB,this.GH);}class lF{final  hL=new List<eH>();clear()=>hL.clear();beginPath()=>hL.add(new eH("beginPath"));closePath()=>hL.add(new eH("closePath"));moveTo( h, g)=>hL.add(new eH("moveTo",[h,g]));lineTo( h, g)=>hL.add(new eH("lineTo",[h,g]));arcTo( k, i, g, h, j)=>hL.add(new eH("arcTo",[k,i,g,h,j]));quadraticCurveTo( j, i, g, h)=>hL.add(new eH("quadraticCurveTo",[j,i,g,h]));bezierCurveTo( h, k, l, i, g, j)=>hL.add(new eH("bezierCurveTo",[h,k,l,i,g,j]));arc( l, g, j, i, h, k)=>hL.add(new eH("arc",[l,g,j,i,h,k]));rect( i, g, h, j)=>hL.add(new eH("rect",[i,g,h,j]));DH( g,[ width=1, joints=dH.oH, caps=ZH.oH])=>hL.add(new eH("strokeColor",[tE(g),width,joints,caps]));IJ( g)=>hL.add(new eH("fillColor",[tE(g)]));TG( i, g, h){hL.add(new eH("moveTo",[i+h,g]));hL.add(new eH("arc",[i,g,h,0,ZB.PI*2,false]));} TB( k){var h=k.context;h.save();for(var j in hL){var g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].GP(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].HP(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];FB i=g[0].IP;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.gB,i.hB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].lK(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].mK(h);FB i=g[0].IP;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.gB,i.hB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}class EB{var x;var y;EB(this.x,this.y);EB.vK():this(0,0);static  SI( g, h)=>new EB(g*ZB.cos(h),-g*ZB.sin(h)); get length=>ZB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new EB(this.x+g.x,this.y+g.y); clone()=>new EB(this.x,this.y); GF( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class HB{var x;var y;var width;var height;HB(this.x,this.y,this.width,this.height);HB.vK():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new EB(this.width,this.height); set size( g){this.width=g.x;this.height=g.y;} clone()=>new HB(this.x,this.y,this.width,this.height); contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); GF( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;}}class XH{XH();}class FB{var TL,VL,WL,YL,cL,gL;var uL;FB( h, i, g, j, k, l):TL=h.toDouble(),VL=i.toDouble(),WL=g.toDouble(),YL=j.toDouble(),cL=k.toDouble(),gL=l.toDouble(),uL=(h*j-i*g).toDouble();FB.yK():TL=1.0,VL=0.0,WL=0.0,YL=1.0,cL=0.0,gL=0.0,uL=1.0; clone(){return new FB(TL,VL,WL,YL,cL,gL);} get a=>TL; get b=>VL; get c=>WL; get d=>YL; get gB=>cL; get hB=>gL; get jC=>uL; IH( g){return new EB(g.x*TL+g.y*WL+cL,g.x*VL+g.y*YL+gL);} concat( g){var n=TL;var DB=VL;var JB=WL;var v=YL;var l=cL;var q=gL;var XB=uL;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var bB=g.gB;var NB=g.hB;var sB=g.jC;TL=(n*j+DB*i).toDouble();VL=(n*k+DB*h).toDouble();WL=(JB*j+v*i).toDouble();YL=(JB*k+v*h).toDouble();cL=(l*j+q*i+bB).toDouble();gL=(l*k+q*h+NB).toDouble();uL=(XB*sB).toDouble();} eG(){TL=1.0;VL=0.0;WL=0.0;YL=1.0;cL=0.0;gL=0.0;uL=1.0;} XJ(){var j=TL;var n=VL;var l=WL;var k=YL;var h=cL;var i=gL;var g=uL;TL=(k/g).toDouble();VL=-(n/g).toDouble();WL=-(l/g).toDouble();YL=(j/g).toDouble();cL=-(TL*h+WL*i).toDouble();gL=-(VL*h+YL*i).toDouble();uL=(1.0/g).toDouble();} AH( h, i, g, k, j, l){TL=h.toDouble();VL=i.toDouble();WL=g.toDouble();YL=k.toDouble();cL=j.toDouble();gL=l.toDouble();uL=(TL*YL-VL*WL).toDouble();} GF( g){TL=g.a.toDouble();VL=g.b.toDouble();WL=g.c.toDouble();YL=g.d.toDouble();cL=g.gB.toDouble();gL=g.hB.toDouble();uL=g.jC.toDouble();} HF( h, g){var q=h.a;var JB=h.b;var NB=h.c;var DB=h.d;var n=h.gB;var v=h.hB;var bB=h.jC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var sB=g.gB;var XB=g.hB;var lC=g.jC;TL=(q*k+JB*j).toDouble();VL=(q*l+JB*i).toDouble();WL=(NB*k+DB*j).toDouble();YL=(NB*l+DB*i).toDouble();cL=(n*k+v*j+sB).toDouble();gL=(n*l+v*i+XB).toDouble();uL=(bB*lC).toDouble();}}class aH{var UL;var jL;var wL;var PM;var eM;aH(){UL=new iE();jL=new List<ZD>();wL=double.NAN;PM=zD.GG;eM=new TD(0);vC.window.requestAnimationFrame(dN);} get YJ=>UL; dN( g){vC.window.requestAnimationFrame(dN);if(wL.isNaN)wL=g;if(wL>g)wL=g;var j=g-wL;var i=j/1000.0;if(j>=1){wL=g;eM.dL=i;PM.JO(eM);UL.BD(i);for(int h=0;h<jL.length;h++ ){var k=jL[h];k.ZJ();}}} rI( g){jL.add(g);}}class jB{final  lL;final  IM=new List<FB>(100);final  gM=new List<double>(100);var oM=0;jB.xK( j,[ matrix]):lL=j{for(int h=0;h<100;h++ ){IM[h]=new FB.yK();gM[h]=1.0;}if(matrix!=null)IM[0].GF(matrix);var g=IM[0];var i=gM[0];lL.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);lL.globalAlpha=i;} get context=>lL; reset(){oM=0;var g=IM[0];var h=gM[0];lL.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);lL.globalAlpha=h;lL.clearRect(0,0,lL.canvas.width,lL.canvas.height);} xG( h){var i=oM;var j=oM+1;var q=IM[i];var g=IM[j];var v=gM[i];var n=gM[j]=h.bN*v;g.HF(h.bO,q);lL.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);lL.globalAlpha=n;oM=j;var k=h.iN;var l=h.lN;if(k!=null){lL.save();k.TB(this);}if(l!=null){l.TB(this);}else{h.TB(this);}if(k!=null){lL.restore();}oM=i;}}class VD{static const  lE="auto";static const  rH="stop";static const  BG="once";}class BB{static const  nH="added";static const  yF="addedToStage";static const  pE="enterFrame";static const  DI="removed";static const  HI="removedFromStage";var SL;var XO;var MO;var FM;var gO;var PO;var VO;BB( g,[ bubbles=false]){vN(g,bubbles);} vN( g,[ bubbles=false]){SL=g;XO=bubbles;MO=mC.BE;FM=null;gO=null;PO=false;VO=false;} get TE=>PO; get type=>SL; get bubbles=>XO; get DF=>true; get target=>FM;}class mC{static const  uF=1;static const  BE=2;static const  wH=3;}class RC{var iL; UJ( g){if(iL!=null)return iL.containsKey(g)||iL.containsKey("${g}_CAPTURE");else return false;} t( g, i(event),{ useCapture: false}){var h=yM(g,useCapture);var j=h.listen(i);return j;} VB( g,{ useCapture: false}){var i=useCapture?"${g}_CAPTURE":g;var h=iL[i];if(h!=null)h.hO();} dispatchEvent( g){kO(g,this,this,mC.BE);} kO( g, k, l, i){if(iL!=null){var j=(i==mC.uF)?"${g.type}_CAPTURE":g.type;var h=iL[j];if(h!=null){g.FM=k;g.gO=l;g.MO=i;g.PO=false;g.VO=false;h.JO(g);}}} yM( g, j){if(iL==null)iL=new Map<String,SD>();var i=j?"${g}_CAPTURE":g;var h=iL[i];if(h==null)h=iL[i]=new SD(this,g,j);return h;}}class zD<WD extends BB>{final  iL=new List<SD>();var WM=0;static var GG=new zD<TD>(); TN( g){for(int h=0;h<WM;h++ )if(iL[h]==g)return;if(WM==iL.length)iL.add(g);else iL[WM]=g;WM++ ;} JO( j){j.MO=mC.BE;j.PO=false;j.VO=false;var k=WM;var i=0;for(int g=0;g<k;g++ ){var h=iL[g];if(h==null)continue;if(h.GN==0){iL[g]=null;continue;}j.FM=h.FM;j.gO=h.FM;h.JO(j);if(i!=g){iL[i]=h;iL[g]=null;}i++ ;}if(i!=k){for(int g=k;g<WM;g++ ){iL[i++ ]=iL[g];iL[g]=null;}WM=i;}}}class SD<WD extends BB> extends YB.Stream<WD>{final  FM;final  tL;final  dM;final  qM=new List<mH>();var GN=0;SD(this.FM,this.tL,this.dM); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new mH<WD>(this,h);if(GN==qM.length)qM.add(g);else qM[GN]=g;GN++ ;if(tL==BB.pE&&dM==false)zD.GG.TN(this);return g;} pN( h){for(int g=0;g<GN;g++ ){if(qM[g]==h){qM[g]=null;break;}}} hO(){for(int g=0;g<GN;g++ )if(qM[g]!=null)qM[g].cancel();} JO( k){var j=GN;var h=0;for(int g=0;g<j;g++ ){var i=qM[g];if(i==null)continue;i.tM(k);if(h!=g){qM[h]=i;qM[g]=null;}h++ ;}if(h!=j){for(int g=j;g<GN;g++ ){qM[h++ ]=qM[g];qM[g]=null;}GN=h;}}}class xB<WD extends BB>{final  tL;const xB(this.tL); forTarget( g,{ useCapture: false}){return g.yM(tL,useCapture);}}abstract class cB{static  QG( g){var h=UD.KI;if(h=="WebAudioApi")return eE.QG(g);if(h=="AudioElement")return gE.QG(g);return mF.QG(g);} get length; play([ loop=false, soundTransform]);static  OG( g){var n=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var i=n.firstMatch(g);var h=UD.LG;if(i==null)throw new ArgumentError("Unsupported file extension.");if(h.length==0)throw new UnsupportedError("This browser supports no known audio codec.");var j=i.group(1).toLowerCase();if(h.indexOf(j)==-1){var l=g.substring(0,g.length-j.length);var k=h[0];g="${l}${k}";}return g;}}class TD extends BB{var dL;TD( g):super(BB.pE,false){dL=g;} get DF=>false;}class p extends BB{static const  oC="click";static const  vH="doubleClick";static const  gC="mouseDown";static const  YD="mouseUp";static const  qE="mouseMove";static const  DE="mouseOut";static const  JG="mouseOver";static const  KG="mouseWheel";static const  MG="middleClick";static const  QI="middleMouseDown";static const  TI="middleMouseUp";static const  NG="rightClick";static const  XI="rightMouseDown";static const  bI="rightMouseUp";var GO,HO;var KO,LO;var pO;var PN;var fN;var SN;var WN;var rO;var sO;var tO;p( g,[ bubbles=false]):super(g,bubbles){vN(g,bubbles);} vN( g,[ bubbles=false]){super.vN(g,bubbles);GO=HO=0;KO=LO=0;pO=false;PN=false;fN=false;SN=false;WN=false;rO=0;sO=0;tO=0;}set uO( g){GO=g.x;HO=g.y;}set vO( g){KO=g.x;LO=g.y;} get BH=>KO; get CH=>LO; get SC=>pO; get altKey=>PN; get ctrlKey=>SN; get shiftKey=>WN; get bD=>rO; get deltaX=>sO; get deltaY=>tO;}class EC extends BB{static const  mE="keyDown";static const  zF="keyUp";var PN;var SN;var WN;var ZN;var fN;var jN;var mN;var nN;EC( g,[ bubbles=false]):super(g,bubbles){vN(g,bubbles);} vN( g,[ bubbles=false]){super.vN(g,bubbles);PN=false;SN=false;WN=false;ZN=false;fN=false;jN=0;mN=0;nN=0;} get altKey=>PN; get ctrlKey=>SN; get shiftKey=>WN; get charCode=>jN; get keyCode=>mN; get keyLocation=>nN;}class jF extends BB{static const  tH="textInput";var oL="";jF( g,[ bubbles=false]):super(g,bubbles){}}class OB extends BB{static const  vF="touchBegin";static const  AG="touchEnd";static const  CG="touchCancel";static const  IG="touchMove";static const  II="touchOver";static const  JI="touchOut";var CO;var FO;var GO,HO;var KO,LO;var PN;var fN;var SN;var WN;var RO;var UO;var WO;OB( g,[ bubbles=false]):super(g,bubbles){vN(g,bubbles);} vN( g,[ bubbles=false]){super.vN(g,bubbles);CO=0;FO=false;GO=HO=0;KO=LO=0;PN=false;fN=false;SN=false;WN=false;RO=1.00;UO=0;WO=0;}set uO( g){GO=g.x;HO=g.y;}set vO( g){KO=g.x;LO=g.y;} get UE=>CO; get BH=>KO; get CH=>LO; get altKey=>PN; get ctrlKey=>SN; get shiftKey=>WN;}class eC{final  eL=new vC.ImageElement();final  VM=new List<rF>();static  QG( n, XB){var l=new YB.Completer<eC>();var j=new eC();switch (XB){case dE.lH:case dE.xF: q( k, g){var JB=ZI(k);var h=new rF(JB,j);h.EM=g["frame"]["x"].toInt();h.MM=g["frame"]["y"].toInt();h.RM=g["frame"]["w"].toInt();h.bM=g["frame"]["h"].toInt();h.jM=g["spriteSourceSize"]["x"].toInt();h.mM=g["spriteSourceSize"]["y"].toInt();h.pM=g["sourceSize"]["w"].toInt();h.xM=g["sourceSize"]["h"].toInt();h.DN=g["rotated"] as bool;j.VM.add(h);}vC.HttpRequest.getString(n).then((NB){var v=TK.parse(NB);var i=v["frames"];var DB=v["meta"];if(i is List)for(var g in i)q(g["filename"],g);if(i is Map)for(String k in i.keys)q(k,i[k]);j.eL..onLoad.listen((bB)=>l.complete(j))..onError.listen((bB)=>l.completeError(new StateError("Failed to load image.")))..src=dI(n,DB["image"]);}).catchError((sB){l.completeError(new StateError("Failed to load json file."));});break;}return l.future;} get VJ=>eL; CB( i){var h;for(int g=0;g<VM.length&&h==null;g++ )if(VM[g].name==i)h=new eB.AL(VM[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;}}class dE{static const  lH="json";static const  xF="jsonarray";}class rF{var XL;var pL;var EM;var MM;var RM;var bM;var jM;var mM;var pM;var xM;var DN;rF( g, h){XL=g;pL=h;} get OK=>pL; get name=>XL; get MJ=>EM; get NJ=>MM; get LJ=>RM; get KJ=>bM; get offsetX=>jM; get offsetY=>mM; get rJ=>pM; get qJ=>xM; get EK=>DN;}class cH<WD>{final  aL=new List<WD>();final  GM;var QM=0;cH( g()):GM=g; uJ(){if(QM==0){return GM();}else{QM-- ;return aL[QM];}}vJ( g){if(QM==aL.length){aL.add(g);}else{aL[QM]=g;}QM++ ;}reset(){aL.clear();QM=0;}}class wD extends GB{var upState;var overState;var downState;var hitTestState;var ZF=true;var enabled=true;var BN;wD([this.upState,this.overState,this.downState,this.hitTestState]){t(p.JG,XN);t(p.DE,XN);t(p.gC,XN);t(p.YD,XN);BN=this.upState;} kB( g,[ returnRectangle]){if(BN!=null){tN.HF(BN.bO,g);return BN.kB(tN,returnRectangle);}return super.kB(g,returnRectangle);} zB( k, l){if(this.hitTestState!=null){var g=this.hitTestState.bO;var h=k-g.gB;var i=l-g.hB;var n=(g.d*h-g.c*i)/g.jC;var j=(g.a*i-g.b*h)/g.jC;if(this.hitTestState.zB(n,j)!=null)return this;}return null;} TB( g){if(BN!=null)g.xG(BN);} XN( g){if(g.type==p.DE){BN=upState;}else{BN=g.SC?downState:overState;}}}abstract class GB extends s{var GJ=false;var mG=true;var uK=true;var tabIndex=0;static const  GI=const xB<p>(p.DE);static const  RI=const xB<p>(p.qE);static const  VI=const xB<p>(p.gC);static const  cI=const xB<p>(p.YD);static const  jI=const xB<p>(p.KG); get onMouseOut=>GB.GI.forTarget(this); get onMouseMove=>GB.RI.forTarget(this); get onMouseDown=>GB.VI.forTarget(this); get onMouseUp=>GB.cI.forTarget(this); get onMouseWheel=>GB.jI.forTarget(this);static const  kI=const xB<OB>(OB.IG);static const  lI=const xB<OB>(OB.AG);static const  nI=const xB<OB>(OB.CG); get onTouchMove=>GB.kI.forTarget(this); get onTouchEnd=>GB.lI.forTarget(this); get onTouchCancel=>GB.nI.forTarget(this);static const  oI=const xB<EC>(EC.zF);static const  pI=const xB<EC>(EC.mE); get onKeyUp=>GB.oI.forTarget(this); get onKeyDown=>GB.pI.forTarget(this);}abstract class nC extends GB{final  NM=new List<s>();var hM=true;var nM=true; w( g){if(g.parent==this){var h=NM.indexOf(g);NM.removeAt(h);NM.add(g);}else{qI(g,NM.length);}} qI( g, h){if(h<0||h>NM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){NM.removeAt(NM.indexOf(g));if(h>NM.length)h-- ;NM.insert(h,g);}else{g.BK();g.wO(this);NM.insert(h,g);g.dispatchEvent(new BB(BB.nH,true));if(this.SE!=null)xO(g,new BB(BB.yF));}} qB( h){var g=NM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");AK(g);} AK( g){if(g<0||g>=NM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=NM[g];h.dispatchEvent(new BB(BB.DI,true));if(this.SE!=null)xO(h,new BB(BB.HI));h.wO(null);NM.removeAt(g);} bG( g){if(g<0||g>=NM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return NM[g];} GD( g){return NM.indexOf(g);} EH( j, i){var h=GD(j);var g=GD(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");MK(h,g);} MK( h, g){var j=bG(h);var i=bG(g);NM[h]=i;NM[g]=j;} contains( g){for(;g!=null;g=g.rN)if(g==this)return true;return false;} kB( q,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.vK();if(NM.length==0)return super.kB(q,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var v=NM.length;for(int l=0;l<NM.length;l++ ){var n=NM[l];tN.HF(n.bO,q);var g=n.kB(tN,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} zB( v, DB){var l=null;for(int j=NM.length-1;j>=0;j-- ){var i=NM[j];if(i.visible){var g=i.bO;var n=v-g.gB;var k=DB-g.hB;var JB=(g.d*n-g.c*k)/g.jC;var q=(g.a*k-g.b*n)/g.jC;var h=i.zB(JB,q);if(h!=null){if(h is GB)if(h.mG)return hM?h:this;l=this;}}}return l;} TB( i){for(int g=0;g<NM.length;g++ ){var h=NM[g];if(h.visible)i.xG(h);}} xO( g, j){g.dispatchEvent(j);if(g is nC){var i=new List<s>.from(g.NM,growable:false);for(int h=0;h<i.length;h++ )xO(i[h],j);}}}class nF{var target=null;var SC=false;var EF=0;var bD=0;var lG,nG;var jG,kG;nF(this.lG,this.nG,this.jG,this.kG);}class eE extends cB{var kL;eE(){if(UD.EE==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  QG( q){var h=new eE();var k=cB.OG(q);var g=new YB.Completer<cB>();vC.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var n=UD.EE;n.decodeAudioData(j,( l){h.kL=l;g.complete(h);},(v){g.completeError(new StateError("Failed to decode audio."));});}).catchError((v){g.completeError(new StateError("Failed to load audio."));});return g.future;} get length{return kL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new bK(this,loop,soundTransform);}}class kF extends s{var fL;kF(){fL=new lF();} get QB=>fL; kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.vK();returnRectangle.x=g.gB;returnRectangle.y=g.hB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} zB( g, h){return null;} TB( g){fL.TB(g);}}class yC extends nC{var gK=false;var ZF=false;}class iB extends s{var bitmapData;var pixelSnapping;var FF;iB([this.bitmapData=null,this.pixelSnapping="auto"]){FF=null;} kB( h,[ returnRectangle]){var g=(bitmapData!=null)?bitmapData.width:0;var i=(bitmapData!=null)?bitmapData.height:0;return wE(h,g,i,returnRectangle);} zB( g, h){if(bitmapData!=null&&g>=0.0&&h>=0.0&&g<bitmapData.width&&h<bitmapData.height)return this;return null;} TB( g){if(bitmapData!=null){if(FF==null)bitmapData.TB(g);else bitmapData.DK(g,FF);}}}class bK extends QC{var xL;var DM;var mL;var kM;var sM;bK( j, h, i){xL=j;mL=h;DM=i;var g=UD.EE;kM=g.createGain();kM.connect(g.destination,0,0);kM.gain.value=(DM!=null)?ZB.pow(DM.volume,2):1;sM=g.createBufferSource();sM.buffer=xL.kL;sM.loop=h;sM.connect(kM,0,0);sM.start(0);} set RE( g){DM=g;kM.gain.value=(DM!=null)?ZB.pow(DM.volume,2):1;} stop(){sM.stop(0);}}class mF extends cB{mF(){}static  QG( g){return new YB.Future<cB>.of(()=>new mF());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new dB();}return new aK(this,loop,soundTransform);}}abstract class kE{ TB( g);}class eB implements kE{var qL;var zL;var LM;var ZM;var lL;var rM;var wM;var AN;var EM;var MM;var RM;var bM;eB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){qL=g;zL=h;LM=transparent;var i=new vC.CanvasElement(width:qL,height:zL);lL=i.context2d;lL.fillStyle=LM?tE(fillColor):XD(fillColor);lL.fillRect(0,0,g,h);ZM=i;rM=0;wM=0;AN=0;}eB.zK( g){if(g==null)throw new ArgumentError();qL=g.naturalWidth;zL=g.naturalHeight;LM=true;ZM=g;rM=0;wM=0;AN=0;}eB.AL( g){qL=g.rJ;zL=g.qJ;LM=true;ZM=g.OK.VJ;rM=g.EK?2:1;wM=g.offsetX;AN=g.offsetY;EM=g.MJ;MM=g.NJ;RM=g.LJ;bM=g.KJ;}static  QG( i){var h=new YB.Completer<eB>();var g=new vC.ImageElement();g.onLoad.listen((j)=>h.complete(new eB.zK(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>qL; get height=>zL; clone(){var g=new eB(qL,zL,true,0);g.HJ(this);return g;} HJ( h,[ matrix=null]){var g=FP();var i=new jB.xK(g,matrix);h.TB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} clear(){var g=FP();g.clearRect(0,0,qL,zL);} SJ( j, h){var i=FP();var k=i.getImageData(j,h,1,1);var g=k.data;if(mI){return (g[0]<<16)+(g[1]<<8)+(g[2]<<0)+(g[3]<<24);}else{return (g[3]<<16)+(g[2]<<8)+(g[1]<<0)+(g[0]<<24);}} TB( h){var g=h.context;switch (rM){case 0:g.drawImage(ZM,wM,AN);break;case 1:g.drawImageScaledFromSource(ZM,EM,MM,RM,bM,wM,AN,RM,bM);break;case 2:g.transform(0.0,-1.0,1.0,0.0,wM,AN+bM);g.drawImageScaledFromSource(ZM,EM,MM,bM,RM,0,0,bM,RM);break;}} DK( SK, g){var bB=SK.context;if(g.width<=0.0||g.height<=0.0)return;switch (rM){case 0:bB.drawImageScaledFromSource(ZM,g.x-wM,g.y-AN,g.width,g.height,g.x+wM,g.y+AN,g.width,g.height);break;case 1:var j=EM;var h=MM;var DB=j+RM;var JB=h+bM;var l=EM-wM+g.x;var n=MM-AN+g.y;var XB=l+g.width;var NB=n+g.height;var v=(j>l)?j:l;var q=(h>n)?h:n;var sB=(DB<XB)?DB:XB;var aF=(JB<NB)?JB:NB;var bF=wM-j+v;var lC=AN-h+q;var k=sB-v;var i=aF-q;if(k>0.0&&i>0.0){bB.drawImageScaledFromSource(ZM,v,q,k,i,bF,lC,k,i);}break;case 2:var j=EM;var h=MM;var DB=j+bM;var JB=h+RM;var l=EM+AN-g.y+bM-g.height;var n=MM-wM+g.x;var XB=l+g.height;var NB=n+g.width;var v=(j>l)?j:l;var q=(h>n)?h:n;var sB=(DB<XB)?DB:XB;var aF=(JB<NB)?JB:NB;var bF=wM-h+q;var lC=AN+DB-sB;var k=aF-q;var i=sB-v;if(k>0.0&&i>0.0){bB.transform(0.0,-1.0,1.0,0.0,bF,lC+i);bB.drawImageScaledFromSource(ZM,v,q,i,k,0,0,i,k);}break;}} FP(){if(lL==null){var g=new vC.CanvasElement(width:qL,height:zL);lL=g.context2d;switch (rM){case 0:lL.drawImage(ZM,wM,AN);break;case 1:lL.drawImageScaledFromSource(ZM,EM,MM,RM,bM,wM,AN,RM,bM);break;case 2:lL.setTransform(0.0,-1.0,1.0,0.0,wM,AN+bM);lL.drawImageScaledFromSource(ZM,EM,MM,bM,RM,0,0,bM,RM);lL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}ZM=g;rM=0;wM=0;AN=0;}return lL;}}typedef  iH<WD extends BB>( event);class mH<WD extends BB> extends YB.StreamSubscription<WD>{var lM;var tM;var vM;var zM;mH(this.lM,this.tM){vM=0;zM=false;} cancel(){if(zM==false){lM.pN(this);zM=true;tM=null;}} onError( g( error)){} get eO=>vM>0; pause([ resumeSignal]){vM++ ;if(resumeSignal!=null)resumeSignal.whenComplete(resume);} resume(){if(eO==false)throw new StateError("Subscription is not paused.");vM-- ;}}class wF{var XM;wF(){XM=new Map<String,yD>();} QN( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(XM.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");XM[i]=g;} zN( i, g){var h="${i}.${g}";if(XM.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return XM[h];} yB( i, h){var g=new yD("BitmapData",i,h);g.yN(eB.QG(h));QN(g);} yE( i, h){var g=new yD("Sound",i,h);g.yN(cB.QG(h));QN(g);} sI( j, h, i){var g=new yD("TextureAtlas",j,h);g.yN(eC.QG(h,i));QN(g);} SB( i, h){var g=new yD("Text",i,"");g.yN(new YB.Future.immediate(h));QN(g);} load(){var h=this.sJ.map((i)=>i.KM);return YB.Future.wait(h).then((j){var g=this.YG;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get sJ{return XM.values.where((g)=>g.kD==null).toList();} get YG{return XM.values.where((g)=>g.error!=null).toList();} CB( g){return zN("BitmapData",g).kD;} LF( g){return zN("Sound",g).kD;} LB( g){return zN("TextureAtlas",g).kD;} TJ( g){return zN("Text",g).kD;}} XD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}abstract class s extends RC implements kE{var CN=0.0;var EN=0.0;var HN=0.0;var JN=0.0;var MN=1.0;var NN=1.0;var RN=0.0;var UN=0.0;var YN=0.0;var bN=1.0;var gN=true;var iN=null;var lN=null;var XL="";var rN=null;final  tN=new FB.yK();final  wN=new FB.yK();final  AO=new FB.yK();var DO=true;static const  hI=const xB<TD>(BB.pE); get fJ=>s.hI.forTarget(this); get x=>CN; get y=>EN; get rC=>HN; get sC=>JN; get XC=>MN; get YC=>NN; get skewX=>RN; get skewY=>UN; get MC=>YN; get alpha=>bN; get visible=>gN; get name=>XL; get parent=>rN; get root{var g=this;while (g.rN!=null)g=g.rN;return g;} get SE{var g=this.root;if(g is ZD)return g;return null;}set x( g){CN=g.toDouble();DO=true;}set y( g){EN=g.toDouble();DO=true;}set rC( g){HN=g.toDouble();DO=true;}set sC( g){JN=g.toDouble();DO=true;}set XC( g){MN=g.toDouble();DO=true;}set YC( g){NN=g.toDouble();DO=true;}set skewX( g){RN=g.toDouble();DO=true;}set skewY( g){UN=g.toDouble();DO=true;}set MC( g){YN=g.toDouble();DO=true;}set alpha( g){bN=g.toDouble();DO=true;}set visible( g){gN=g;DO=true;}set mask( g){iN=g;} get width=>kB(bO).width; get height=>kB(bO).height; set width( h){this.XC=1;var g=this.width;this.XC=(g!=0.0)?h/g:1.0;} set height( h){this.YC=1;var g=this.height;this.YC=(g!=0.0)?h/g:1.0;} tI( g){g.w(this);} BK(){if(rN!=null)rN.qB(this);} get bO{if(DO){DO=false;var j=RN+YN;var i=UN+YN;if(j==0.0&&i==0.0){AO.AH(MN,0.0,0.0,NN,CN-HN*MN,EN-JN*NN);}else{var g,l,k,h;var n=ZB.cos(j);var q=ZB.sin(j);if(j==i){g=MN*n;l=MN*q;k=-NN*q;h=NN*n;}else{g=MN*ZB.cos(i);l=MN*ZB.sin(i);k=-NN*q;h=NN*n;}var DB=CN-(HN*g+JN*k);var v=EN-(HN*l+JN*h);AO.AH(g,l,k,h,DB,v);}}return AO;} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.vK();returnRectangle.x=g.gB;returnRectangle.y=g.hB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} zB( g, h){if(kB(wN).contains(g,h))return this;return null;} iG( h){tN.eG();for(s g=this;g!=null;g=g.rN)tN.concat(g.bO);return tN.IH(h);} VC( h){tN.eG();for(s g=this;g!=null;g=g.rN)tN.concat(g.bO);tN.XJ();return tN.IH(h);} dispatchEvent( h){var g=null;if(h.DF||h.bubbles)for(s j=rN;j!=null;j=j.rN)if(j.UJ(h.type)){if(g==null)g=tF.uJ() as List<s>;g.add(j);}if(h.DF&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.TE==false)g[i].kO(h,this,g[i],mC.uF);if(h.TE==false)kO(h,this,this,mC.BE);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.TE==false)g[i].kO(h,this,g[i],mC.wH);if(g!=null){g.clear();tF.vJ(g);}} wO( h){for(var g=h;g!=null;g=g.rN)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");rN=h;} TB( g);}class DG{static var HG=false;static var rE=false;static var sE=0;static var NI=qF.uH;static var OI=new YB.StreamController<String>();static var UI=OI.stream.asBroadcastStream();static WI(){if(HG==false){HG=true;var g=vC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){rE=true;sE=10;}if(g.contains("Android")){rE=true;sE=10;}if(g.contains("IEMobile")){rE=true;sE=10;}}}static  get iI{WI();return NI;}}class LI{static var MI=0;var UE=MI++ ;var target=null;var PE=false;LI(this.target,this.PE);} tE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class uE{static  vE( g){return g;}}class YI implements dC{final  BO;final  EO;final  IO=new List<gH>();var NO;var OO;var SO;var OM;var CM;var ZO;var cO;var fO;YI( g, h,[ transitionFunction( ratio)]):BO=g,EO=(transitionFunction!=null)?transitionFunction:uE.vE{CM=0.0;OM=ZB.max(0.0001,h);ZO=0.0;cO=false;fO=false;} GE( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','skewX','skewY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(BO!=null&&fO==false)IO.add(new gH(g,0.0,h));} moveTo( h, g){GE('x',h);GE('y',g);} BD( l){if(CM<OM||fO==false){CM=CM+l;if(CM>OM)CM=OM;if(CM>=0.0){if(fO==false){fO=true;for(int i=0;i<IO.length;i++ ){var g=IO[i];switch (g.name){case 'x':g.lB=BO.x;break;case 'y':g.lB=BO.y;break;case 'pivotX':g.lB=BO.rC;break;case 'pivotY':g.lB=BO.sC;break;case 'scaleX':g.lB=BO.XC;break;case 'scaleY':g.lB=BO.YC;break;case 'skewX':g.lB=BO.skewX;break;case 'skewY':g.lB=BO.skewY;break;case 'rotation':g.lB=BO.MC;break;case 'alpha':g.lB=BO.alpha;break;}}if(NO!=null)NO();}var j=CM/OM;var k=EO(j);for(int i=0;i<IO.length;i++ ){var g=IO[i];var h=g.lB+k*(g.GH-g.lB);h=cO?h.round():h;switch (g.name){case 'x':BO.x=h;break;case 'y':BO.y=h;break;case 'pivotX':BO.rC=h;break;case 'pivotY':BO.sC=h;break;case 'scaleX':BO.XC=h;break;case 'scaleY':BO.YC=h;break;case 'skewX':BO.skewX=h;break;case 'skewY':BO.skewY=h;break;case 'rotation':BO.MC=h;break;case 'alpha':BO.alpha=h;break;}}if(OO!=null)OO();if(SO!=null&&CM==OM)SO();}}return CM<OM;} get currentTime=>CM;} ZI( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class ZD extends nC{var xN;var lL;var QO;var TO;var YO;var aO;var dO;var iO;var jO;var lO;var mO;var nO;var oO;ZD( h, g){XL=h;xN=g;xN.focus();lL=g.context2d;TO=new jB.xK(lL);YO=VD.lE;aO=mB.nE;hE.EI.listen(EI);jO=[new nF(p.gC,p.YD,p.oC,p.vH),new nF(p.QI,p.TI,p.MG,p.MG),new nF(p.XI,p.bI,p.NG,p.NG)];iO=null;dO=new EB(0,0);mO=new p(p.oC,true);xN.onMouseDown.listen(XN);xN.onMouseUp.listen(XN);xN.onMouseMove.listen(XN);xN.onMouseOut.listen(XN);xN.onMouseWheel.listen(yO);lO=new Map<int,LI>();oO=new OB(OB.vF,true);DG.UI.listen(zO);zO(null);nO=new EC(EC.mE,true);xN.onKeyDown.listen(AP);xN.onKeyUp.listen(AP);xN.onKeyPress.listen(BP);} get focus=>QO;DP(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){DP();} set y( g){DP();} set rC( g){DP();} set sC( g){DP();} set XC( g){DP();} set YC( g){DP();} set MC( g){DP();} set alpha( g){DP();} set width( g){DP();} set height( g){DP();}ZJ(){if(YO==VD.lE||YO==VD.BG){TO.reset();TB(TO);if(YO==VD.BG)YO=VD.rH;}}EI( g){xN.style.cursor=hE.PG(aO);}XN( j){j.preventDefault();var JB=xN.getBoundingClientRect();var q=new DateTime.now().millisecondsSinceEpoch;var DB=j.button;var h=null;var i=new EB(j.client.x-JB.left,j.client.y-JB.top);var n=null;if(DB<0||DB>2)return;if(j.type=="mousemove"&&dO.equals(i))return;var g=jO[DB];dO=i;if(j.type!="mouseout")h=zB(i.x,i.y) as GB;var l=mB.nE;if(h is yC)if(h.ZF)l=mB.oE;if(h is wD)if(h.ZF)l=mB.oE;if(aO!=l){aO=l;xN.style.cursor=hE.PG(l);}if(iO!=null&&iO!=h){iO.dispatchEvent(mO..vN(p.DE,true)..uO=(iO.SE!=null)?iO.VC(i):new EB.vK()..vO=i..pO=g.SC);iO=null;}if(h!=null&&h!=iO){h.dispatchEvent(mO..vN(p.JG,true)..uO=h.VC(i)..vO=i..pO=g.SC);iO=h;}var k=null;var v=false;var NB=false;if(j.type=="mousedown"){k=g.lG;if(h!=g.target||q>g.EF+500)g.bD=0;g.SC=true;g.target=h;g.EF=q;g.bD++ ;}if(j.type=="mouseup"){k=g.nG;g.SC=false;v=(g.target==h);NB=v&&g.bD.isEven&&(q<g.EF+500);}if(j.type=="mousemove"){k=p.qE;}if(k!=null&&h!=null){n=h.VC(i);h.dispatchEvent(mO..vN(k,true)..uO=n..vO=i..pO=g.SC..rO=g.bD);if(v){if(NB&&h.GJ){h.dispatchEvent(mO..vN(g.kG,true)..uO=n..vO=i..pO=g.SC);}else{h.dispatchEvent(mO..vN(g.jG,true)..uO=n..vO=i..pO=g.SC);}}}}yO( g){var j=xN.getBoundingClientRect();var h=new EB(g.client.x-j.left,g.client.y-j.top);var i=zB(h.x,h.y) as GB;if(i!=null){i.dispatchEvent(mO..vN(p.KG,true)..uO=i.VC(h)..vO=h..sO=g.deltaX..tO=g.deltaY);if(mO.TE)g.preventDefault();}}var JP=[] ;zO( h){JP.forEach((g)=>g.cancel());if(DG.iI==qF.yH){JP=[xN.onTouchStart.listen(KP),xN.onTouchEnd.listen(KP),xN.onTouchMove.listen(KP),xN.onTouchEnter.listen(KP),xN.onTouchLeave.listen(KP),xN.onTouchCancel.listen(KP)];}}KP( j){j.preventDefault();var q=xN.getBoundingClientRect();for(var n in j.changedTouches){var l=n.identifier;var i=new EB(n.client.x-q.left,n.client.y-q.top);var h=zB(i.x,i.y) as GB;var g=lO.containsKey(l)?lO[l]:new LI(h,lO.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(oO..vN(OB.JI,true)..uO=(g.target.SE!=null)?g.target.VC(i):new EB.vK()..vO=i..CO=g.UE..FO=g.PE);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(oO..vN(OB.II,true)..uO=h.VC(i)..vO=i..CO=g.UE..FO=g.PE);g.target=h;}var k=null;if(j.type=="touchstart"){lO[l]=g;k=OB.vF;}if(j.type=="touchend"){lO.remove(l);k=OB.AG;}if(j.type=="touchcancel"){lO.remove(l);k=OB.CG;}if(j.type=="touchmove"){k=OB.IG;}if(k!=null&&h!=null){h.dispatchEvent(oO..vN(k,true)..uO=h.VC(i)..vO=i..CO=g.UE..FO=g.PE);}}}AP( g){g.preventDefault();var h=null;if(g.type=="keyup")h=EC.zF;if(g.type=="keydown")h=EC.mE;nO..vN(h,true)..PN=g.altKey..SN=g.ctrlKey..WN=g.shiftKey..jN=g.charCode..mN=g.keyCode..nN=zC.jH;if(g.keyLocation==vC.KeyLocation.LEFT)nO.nN=zC.FG;if(g.keyLocation==vC.KeyLocation.RIGHT)nO.nN=zC.CE;if(g.keyLocation==vC.KeyLocation.NUMPAD)nO.nN=zC.zH;if(g.keyLocation==vC.KeyLocation.JOYSTICK)nO.nN=zC.EG;if(g.keyLocation==vC.KeyLocation.MOBILE)nO.nN=zC.EG;if(QO!=null)QO.dispatchEvent(nO);}BP( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new jF(jF.tH,true);h.oL=new String.fromCharCodes([i]);if(QO!=null)QO.dispatchEvent(h);}} dI( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} eI(){var g=new vC.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} wE( g, n, q, j){n=n.toDouble();q=q.toDouble();var lC=0.0;var sB=0.0;var JB=n*g.a;var bB=n*g.b;var NB=n*g.a+q*g.c;var DB=n*g.b+q*g.d;var XB=q*g.c;var v=q*g.d;var h=lC;if(h>JB)h=JB;if(h>NB)h=NB;if(h>XB)h=XB;var i=sB;if(i>bB)i=bB;if(i>DB)i=DB;if(i>v)i=v;var l=lC;if(l<JB)l=JB;if(l<NB)l=NB;if(l<XB)l=XB;var k=sB;if(k<bB)k=bB;if(k<DB)k=DB;if(k<v)k=v;if(j==null)j=new HB.vK();j.x=g.gB+h;j.y=g.hB+i;j.width=l-h;j.height=k-i;return j;}var mI=eI();//@ sourceMappingURL=supersonic.dart.map
