import "dart:web_audio" as aG;import "dart:math" as XB;import "dart:json" as iL;import "dart:html" as PB;import "dart:async" as dB;class jL{static const  kL="Chrome";static const  lL="Firefox";static const  mL="Internet Explorer";static const  nL="Safari";final  NK;final  minimumVersion;const jL(this.NK,[this.minimumVersion]);}class oL{final  name;const oL(this.name);}class yB{var x;var y;yB(this.x,this.y);set length( g){this.normalize();this.nK(g);} get length{return XB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new yB(x,y);} add( g){if(g==null)return null;return new yB(x+g.x,y+g.y);} subtract( g){if(g==null)return null;return new yB(x-g.x,y-g.y);}nK( g){x*= g;y*= g;} get rE{var g=XB.PI-XB.atan2(this.x,this.y);if(g<0)g+= 2*XB.PI;return g;}set rE( i){var h=this.length;var g=FB.kJ(h,i-XB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class jC{var x;var y;var z;jC(this.x,this.y,this.z);reset( h, i, g){x=h;y=i;z=g;} clone(){return new jC(x,y,z);} fH(){return XB.sqrt(x*x+y*y+z*z);}VL( g){this.normalize();this.scale(g);} add( g){return new jC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=fH();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} yF( g){return (g.x==x&&g.y==y&&g.z==z);}}class ZB extends MF implements oC{static var UE=588;static var qD=314;static var VI=10.0;var GD;var xB;var pM;var QG;var OC;ZB( g,[ autoStart=true, fontName=eE]):super(g){this.OC=fontName;this.width=ZB.UE;this.height=ZB.qD;this.GD=new oB(n.MB("items").IB("menu_bg"));this.DB(this.GD);this.xB=new mC();this.xB.OD=0x000000;this.xB.wordWrap=true;this.xB.NC=new UF(fontName,30,0x000000,bold:true,align:sB.kE);this.xB.width=476;this.xB.height=250;this.xB.x=60;this.xB.y=90;this.DB(this.xB);this.u(s.pC,this.onClick);if(autoStart){this.LI=0;this.QG=0;eB.add(this);}else{this.LI=1;}this.alpha=0;} FD( g){this.QG+= g;if(this.QG>VI){IE();xF();return false;}return true;}set text( g){if(g==null)return;var h=new UF(OC,30,0x000000,bold:true,align:sB.kE);if(g.length<=30)h.size=45;else h.size=30;this.xB.NC=h;this.xB.text=g;} onClick( g){IE();xF();} xF(){this.dispatchEvent(new LB(LB.BC,this));}set LI( g){if(g<0)g=1;if(g>1)g=1;pM=g;var h=(255*pM).round().toInt();} IE(){eB.remove(this);}}class LB extends GB{static const  BC="MenuEvent.TYPE_OK";static const  VE="MenuEvent.TYPE_CANCEL";var AF;LB( h, g,[ bubbles=false]):super(h,bubbles){this.AF=g;}}class MI extends MF{var GD;var hC;var GC;var FC;var UC;var SC;var TC;var font;var WG=30;var HF;MI( h,[ fontName=eE]):super(h){this.font=fontName;this.HD();var g=new StringBuffer();g.write((this.v as zB).mB("GENlevel"));g.write(": 0");FC.text=g.toString();} HD(){this.GD=new oB(n.MB("items").IB("topbar"));this.GD.x=0;this.GD.y=0;this.DB(this.GD);this.hC=new mC();this.hC.NC=new UF(font,24,0,bold:true,align:sB.zG);this.hC.OD=0x000000;this.hC.width=400;this.hC.height=100;this.hC.x=20;this.hC.y=WG;this.DB(hC);this.GC=new mC();this.GC.NC=new UF(font,24,0,bold:true,align:sB.mE);this.GC.OD=0x000000;this.GC.width=200;this.GC.height=100;this.GC.x=(this.v.yE/2)-this.GC.width+60;this.GC.y=WG;this.DB(GC);this.FC=new mC();this.FC.NC=new UF(font,24,0,bold:true,align:sB.mE);this.FC.OD=0x000000;this.FC.width=200;this.FC.height=100;this.FC.x=(this.v.yE)-(this.FC.width)-20;this.FC.y=WG;this.DB(FC);this.UC=new mC();this.UC.NC=new UF(font,24,0,bold:true,align:sB.kE);this.UC.OD=0x000000;this.UC.width=200;this.UC.height=100;this.UC.x=20;this.UC.y=this.v.cH-this.UC.height-20;this.DB(UC);this.UC.visible=false;this.SC=new oB(n.MB("items").IB("progressbar"));this.SC.x=25;this.SC.y=82;this.DB(this.SC);this.TC=new oB(n.MB("items").IB("progressship"));this.TC.x=25;this.TC.y=this.SC.y+(this.SC.height-(this.SC.height-this.TC.height))-(this.TC.height);this.DB(this.TC);this.HF=new List<oB>();for(var h=0;h<3;h++ ){var g=new oB(n.MB("items").IB("spaceship"));g.y=10;g.x=(this.v.yE/2)+70+(h*35);this.DB(g);this.HF.add(g);}} wH( g){this.TC.x=25;this.TC.y=this.SC.y+(this.SC.height-((this.SC.height-this.TC.height)*g.v.QE))-(this.TC.height);} vH( i){var h=i.v as zB;if(h.kD){this.GC.text=h.mB("DISPLAY_TRAINING");}else{this.GC.text=h.mB("DISPLAY_LIVES");}for(var g=0;g<this.HF.length;g++ ){this.HF[g].visible=(!h.kD)&&(g<i.v.hD);}} yH( h){var i=h.v as zB;var g=new StringBuffer();g.write(i.mB("GENscore"));g.write(": ${h.v.UL.toString()}");hC.text=g.toString();} DF( h){var i=h.v as zB;var g=new StringBuffer();g.write(i.mB("GENlevel"));g.write(": ${h.v.nB.toString()}");FC.text=g.toString();}}class NI extends ZB{var tB;var tC;var iC;var XC;var RH=40;var SH=30;var OC;NI( g,[ fontName=eE]):super(g,true,fontName){this.OC=fontName;this.bB(s.ED);this.bB(s.pC);this.HD();} HD(){var g=this.v as zB;this.xB.wordWrap=true;this.text=g.mB("GENexitquery");this.tB=new sD(new oB(n.MB("items").IB("but_yes")),new oB(n.MB("items").IB("but_yes2")),new oB(n.MB("items").IB("but_yes2")),new oB(n.MB("items").IB("but_yes2")));this.tB.x=SH;this.tB.y=ZB.qD-this.tB.height-RH;this.tB.u(s.ED,this.eL);this.DB(this.tB);this.tC=new sD(new oB(n.MB("items").IB("but_no")),new oB(n.MB("items").IB("but_no2")),new oB(n.MB("items").IB("but_no2")),new oB(n.MB("items").IB("but_no2")));this.tC.x=ZB.UE-this.tC.width-SH;this.tC.y=ZB.qD-this.tB.height-RH;this.tC.u(s.ED,this.tH);this.DB(this.tC);this.iC=new mC();this.iC.u(s.ED,this.tB.dispatchEvent);this.iC.OD=0x000000;this.iC.NC=new UF(OC,48,0,bold:true,align:sB.zG);this.iC.height=60;this.iC.x=this.tB.x+this.tB.width;this.iC.y=this.tB.y+5;this.DB(this.iC);this.iC.text=g.mB("GENyes");this.XC=new mC();this.XC.u(s.ED,this.tC.dispatchEvent);this.XC.OD=0x000000;this.XC.NC=new UF(OC,48,0,bold:true,align:sB.mE);this.XC.height=60;this.XC.x=this.tC.x-this.XC.width;this.XC.y=this.tB.y+5;this.DB(this.XC);this.XC.text=g.mB("GENno");}xF(){tH(null);} eL( g){IE();this.dispatchEvent(new LB(LB.BC,this));} tH( g){IE();this.dispatchEvent(new LB(LB.VE,this));}}class p extends GB{static const  pD="GameEvent.TYPE_LIVES_CHANGED";static const  WE="GameEvent.TYPE_PROGRESS_CHANGED";static const  XE="GameEvent.TYPE_PAUSE_CHANGED";static const  YE="GameEvent.TYPE_LEVEL_CHANGED";static const  ZE="GameEvent.TYPE_SCORE_CHANGED";static const  aE="GameEvent.TYPE_GAME_START";static const  bE="GameEvent.TYPE_GAME_OVER";static const  cE="GameEvent.TYPE_GAME_ABORT";static const  QF="GameEvent.TYPE_GAME_SIZE_CHANGED";var v;p( h, g,[ bubbles=false]):super(h,bubbles){this.v=g;}}class MF extends aC{var fM;MF( g){this.v=g;}set v( g){if(fM!=null){fM.bB(p.bE);fM.bB(p.cE);fM.bB(p.QF);fM.bB(p.aE);fM.bB(p.YE);fM.bB(p.XE);fM.bB(p.ZE);fM.bB(p.pD);fM.bB(p.WE);}fM=g;if(fM!=null){fM.u(p.bE,this.HG);fM.u(p.cE,this.GG);fM.u(p.QF,this.uH);fM.u(p.aE,this.IG);fM.u(p.YE,this.DF);fM.u(p.XE,this.zK);fM.u(p.ZE,this.yH);fM.u(p.pD,this.vH);fM.u(p.WE,this.wH);}} get v{return fM;} HG( g){} GG( g){} uH( g){} IG( g){} DF( g){} zK( g){} yH( g){} vH( g){} wH( g){}}class zB extends AC{static const  eG=1.0;static const  TI=100;static const  UI=0xFFFFFF;var ZL=eG;var dK=5;var eD;var lH=false;var EI=500;var MK=0xffffff;var uB;var KB;var gD;var qM=true;var BF=false;var dH=60.0;var JE;var OC=eE;var DG=false;var HL="Web";zB( h, g):super(h,g){this.u(GB.sG,(i){this.kK();});}set kD( g){qM=g;this.dispatchEvent(new p(p.pD,this));} get kD{return qM;} kK(){if(!lH){this.u(s.AE,(g)=>this.BF=false);this.u(s.pC,(g)=>this.BF=true);this.KL();this.u(p.aE,this.IG);this.u(p.pD,this.xK);this.u(p.WE,this.AL);this.u(p.ZE,this.BL);this.u(p.YE,this.vK);this.u(p.XE,this.yK);this.u(p.bE,this.HG);this.u(p.cE,this.GG);this.HD();this.QE=0;this.iD=0;this.hD=3;this.start();lH=true;}} mB( i,[ params=null]){var h=n.iK(i);if(params!=null)for(int g=0;g<params.length;g++ )h=h.replaceAll("{${g}}",params[g].toString());return h;} KL(){this.ZL=eG;this.MK=UI;this.EI=TI;this.dK=5;this.dH=60000;} HD(){this.eD=new PD(this);this.DB(this.eD);var h=n.MB("items").IB("button_exit");var g=n.MB("items").IB("button_exit_2");this.uB=new sD(new oB(h),new oB(g),new oB(h),new oB(g));this.uB.width=75;this.uB.height=66;this.uB.x=707;this.uB.y=525;this.uB.u(s.pC,tK);this.DB(this.uB);this.uB.visible=false;this.gD=new MI(this,OC);this.gD.x=0;this.gD.y=0;this.DB(this.gD);} UK(){var g=this.cD();g.text=this.mB("MESSAGE_RESTART_LEVEL");g.u(LB.BC,this.xH);} QK( h){var g=this.cD();g.text=this.mB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.u(LB.BC,this.xH);} xH( g){this.MD(g.AF);this.eD.OK();} YH(){this.eD.AG();var g=this.cD();if(this.nB==0){g.text=this.mB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.mB("MESSAGE_START_LEVEL",[(this.nB+1)]);}g.u(LB.BC,this.DL);} DL( g){this.MD(g.AF);this.oK();} RK(){var g=this.cD();g.text=this.mB("MESSAGE_GAME_OVER");g.u(LB.BC,this.uK);} uK( g){this.MD(g.AF);} cD([ menu=null, tweenDuration=1.0, autoStart=true]){if(this.KB!=null)this.MD(this.KB);this.uB.visible=false;this.gD.visible=true;if(menu==null)this.KB=new ZB(this,autoStart,OC);else this.KB=menu;this.KB.width=ZB.UE;this.KB.height=ZB.qD;this.KB.x=(this.yE/2)-(ZB.UE/2)+30;this.KB.y=(this.cH/2)-(ZB.qD/2);this.KB.alpha=0;this.DB(this.KB);var g=new pE(this.KB,tweenDuration,mF.nF);g.QH.alpha.TG(1);eB.add(g);return this.KB;} MD( g){this.paused=false;this.gD.visible=true;this.uB.visible=true;if(g==null)return;g.IE();if(this.contains(g)){this.vB(g);}this.KB=null;} fK(){eB.remove(JE);if(this.DG)this.zH(null);this.BF=true;this.kD=false;} CL(){if(this.KB!=null)return;if(HL.toLowerCase()=="web")return;eB.remove(JE);this.JE=new VF(this.fK,this.dH);eB.add(this.JE);this.DG=true;this.paused=true;var g=this.cD(null,200,false);this.uB.visible=true;g.text=this.mB("MESSAGE_FIRST_LEVEL");g.u(LB.BC,this.zH);} zH( g){eB.remove(this.JE);this.DG=false;this.KB.bB(LB.BC);this.MD(this.KB);} tK( h){if(this.KB is NI)return;var g=new NI(this,OC);this.cD(g);this.paused=true;g.u(LB.BC,this.qK);g.u(LB.VE,this.pK);} qK( g){this.dispatchEvent(new p(p.cE,this));this.KB.bB(LB.BC);this.KB.bB(LB.VE);this.MD(this.KB);this.paused=true;} pK( g){this.KB.bB(LB.BC);this.KB.bB(LB.VE);this.MD(KB);} IG( g){this.eD.AG();eB.wE(this.YH,0.5);} ZK(){this.eD.AG();} AL( g){} xK( g){} BL( g){} vK( g){} yK( g){} HG( g){eB.wE(this.RK,2.0);} GG( g){}}class PD extends MF{static var cG=0.025;static var NF=1.0;static var QD=600;static var OF=800;static var PF=600;static var fG=400;static var gG=300;static var rD=XB.sqrt(OF*OF+PF*PF);static var XI=(rD*2/QD);static var hG=6;var QB;var VB;var QC;var gC;var NG=30.0*XB.PI/180;var MG=1.0*XB.PI/180;var mD=0.05;var KG=-1;var EF=1;var NB;var sC;var rF=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var sF;var tF;var VH;var PK;var KI;var LG=15;var mH;var dD=false;var vE=0;var zF;var qE;var pF=0.90;var FI=0;var rM;var DM;var cB;var cK=0;var MC;var bD=false;var ME,NE;var gH;var OE;PD( g):super(g){rM=new gE.VM(80,60,690,524);this.mask=rM;this.sF=n.BG("speedalizer");this.tF=this.sF.play(true);this.cB=new lG();this.DB(this.cB);gH=new dI(800,600);DB(gH);ME=NE=0;IC.u(s.kF,this.JG);IC.u(s.pC,this.JG);IC.u(s.AE,this.JG);OE=this.sK.listen(this.sM);} JG( g){ME=g.GI;NE=g.HI;} JL(){var g=this.v.iD;this.v.iD=g+(this.v as zB).EI*(this.v.nB*this.v.hD);} uH( g){} DF( g){super.DF(g);this.aL();} aL(){bD=false;OE.pause();this.vE=0;this.v.QE=0;this.dD=false;var h=60;this.gC=new QI(rD,hG*h);for(var g=this.gC.BB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.gC.CI(g);this.QB=new yB(fG,gG);this.VB=new jC(0,0,0);this.QC=new jC(0,0,NF);this.MG=(1+(0.1*this.v.nB))*XB.PI/180;this.mD=0.015+(0.004*this.v.nB);this.EF=2+this.v.nB;this.KG=-this.EF;this.FI=this.v.nB*2;this.LG=15+(this.v.nB);this.HD();this.SK();OE.resume();} HD(){if(this.NB!=null)this.vB(this.NB);this.NB=new OI();this.DB(this.NB);if(this.MC!=null)this.vB(this.MC);this.MC=new oB(n.MB("items").IB("crosshair"));this.MC.VC=0.5;this.MC.WC=0.5;this.MC.x=(OF/2)-this.MC.width/2;this.MC.y=(PF/2)-this.MC.height/2;this.DB(this.MC);} AG(){this.bD=false;this.OE.pause();var h=60;this.gC=new QI(rD,hG*h);for(var g=this.gC.BB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.gC.CI(g);this.QB=new yB(fG,gG);this.VB=new jC(0,0,0);this.QC=new jC(0,0,NF);this.MG=2*XB.PI/180;this.EF=0;this.KG=0;if(this.NB!=null){this.vB(this.NB);this.NB=null;}this.NB=new OI();this.DB(this.NB);if(this.sC!=null){this.vB(this.sC);this.sC=null;}this.XH();this.OE.resume();} XH(){var g=new ZC(null);g.eC=-1;g.HC=0;g.position=this.VB.clone();g.position.z=0.5;this.NB.WD(g);} WH(){var g=new ZC(new oB(n.MB("items").IB("countdown01")));g.eC=0;g.HC=0;g.position=this.VB.clone();g.position.z=0.5;g.FE=0;g.KE=true;this.NB.WD(g);g=new ZC(new oB(n.MB("items").IB("countdown02")));g.eC=0;g.HC=0;g.position=this.VB.clone();g.position.z=0;g.FE=1;g.KE=true;this.NB.WD(g);g=new ZC(new oB(n.MB("items").IB("countdown03")));g.eC=0;g.HC=0;g.position=this.VB.clone();g.position.z=-0.5;g.FE=2;g.KE=true;this.NB.WD(g);g=new ZC(new oB(n.MB("items").IB("countdown04")));g.eC=0;g.HC=0;g.position=this.VB.clone();g.position.z=-1;g.FE=3;g.KE=true;this.NB.WD(g);} TK(){var h=1+this.v.nB;if(h>=this.rF.length)h=this.rF.length-1;var i=oD.dG(0,h);var j=this.rF[i];var g=new ZC(new oB(n.IB(j)));g.uC=true;g.wB=oD.dG(0,359)*XB.PI/180;g.HC=oD.WI(this.KG,this.EF)*XB.PI/180;g.position=this.VB.clone();return g;} SK(){this.WH();this.XH();var h=0;for(var i=0;i<LG;i++ ){var g=null;if(i==LG-1){g=new ZC(new oB(n.IB("finish")));g.wB=0;g.HC=5*XB.PI/180;g.position=this.VB.clone();g.eC=0;g.uC=true;g.kH=true;this.zF=g;}else{h++ ;if(this.v.nB==1&&h<=3){if(h==1){g=new ZC(new oB(n.IB("training01")));g.uC=true;g.wB=0;g.HC=0;g.position=this.VB.clone();g.jD=1;}else if(h==2){g=new ZC(new oB(n.IB("training02")));g.uC=true;g.wB=135*XB.PI/180;g.HC=0;g.position=this.VB.clone();g.jD=2;}else if(h==3){g=new ZC(new oB(n.IB("training02")));g.uC=true;g.wB=315*XB.PI/180;g.HC=0;g.position=this.VB.clone();g.jD=3;}}else{g=this.TK();}}g.PE=-i*1-3;g.position.z=g.PE;g.eC=0;this.NB.WD(g);}} wK(){this.dD=false;var g=v as zB;g.ZK();g.YH();} sM( h){if(this.v.paused==false){this.ML();var g=this.v as zB;if(g.kD&&this.bD&&!g.BF)g.CL();}else{LE=-1;}} zE( h){var g=new FB(this.QB.x,this.QB.y);g=this.nH(g);g=h.PC(g);return h.zE(g);} OK(){this.bD=false;for(var g=0;g<this.NB.RC.length;g++ )this.NB.RC[g].position.z-= (2.5+1-pF)+1;qE.position.z+= (1-pF);this.WH();this.dD=false;this.mD=this.mH;this.sC.visible=false;} rK(){var g=this.v as zB;g.uB.visible=false;this.dD=false;this.bD=false;this.mH=this.mD;this.mD=0;if(this.sC!=null)this.vB(this.sC);this.sC=new oB(n.IB("broken"));this.DB(this.sC);if(this.qE.jD>0&& ++this.cK<=5){eB.wE((){g.QK(this.qE.jD);},2.0);}else{this.v.hD-- ;if(this.v.hD>0)eB.wE(g.UK,2.0);}this.tF.stop();this.tF=this.sF.play(true);this.VH=n.BG("crash");this.PK=this.VH.play();}var LE=-1; ML(){var k=eB.elapsedTime;var h=1.0;if(LE==-1)LE=k;h=XB.min(k-LE,1.0000)*40;LE=k;if(dD){this.vE-= (this.mD*h);var o=this.v.iD;this.v.iD=o+(this.FI*h);}this.NB.YL();this.NG+= (this.MG*h);this.QC.x=-(this.ME-this.QB.x)*3;this.QC.y=-(this.NE-this.QB.y)*3;if(this.QC.fH()>rD*0.7){this.QC.VL(rD*0.7);}this.QC.z=NF;this.VB=this.QC.clone();this.VB.z=cG;this.LL();for(var m=0;m<this.NB.RC.length;m++ ){var g=this.NB.RC[m];g.position.z+= (mD*h);if(g.position.z>=1){if(g.KE&&g.FE==3)bD=true;if(g.DE!=null){this.KI=n.BG("swish");var t=this.KI.play();}if(g.uC)dD=true;if(g.PE!=0)this.vE=g.PE;if(g.uC&&zE(g)){g.position.z=pF;qE=g;this.rK();}else{if(g.jD==3)(this.v as zB).kD=false;if(g.uC)this.JL();if(g.kH){this.wK();}else if(g.eC==0){this.NB.PL(g);}else{g.position.z+= g.eC;}}}var i=this.QC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.LF(i);j=j.add(this.QB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.wB+= (g.HC*h);g.setScale(nD(g.position.z)*XI);}}if(this.zF!=null)this.v.QE=(this.vE+3)/(this.zF.PE+3);} LF( g){var h=new yB(g.x,g.y);h.x*= nD(g.z);h.y*= nD(g.z);return h;} nD( g){var h=cG;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} LL(){if(cB==null)return;var l=2;var j=this.QC.clone();j.scale(l);var h=this.gC.transform(nD(j.z)*l,this.NG,this.LF(j));var i=this.gC.transform(nD(this.VB.z),this.NG,this.LF(this.VB));var k=this.LF(this.VB).add(this.QB);cB.RB.clear();cB.RB.beginPath();cB.RB.TH(k.x,k.y,this.gC.IL*nD(this.VB.z));cB.RB.closePath();cB.RB.II(0xffcccccc,1);cB.RB.beginPath();for(var g=0;g<h.BB.length;g+= 2){cB.RB.moveTo(h.BB[g].x+this.QB.x,h.BB[g].y+this.QB.y);cB.RB.lineTo(h.BB[g+1].x+this.QB.x,h.BB[g+1].y+this.QB.y);cB.RB.lineTo(i.BB[g+1].x+this.QB.x,i.BB[g+1].y+this.QB.y);cB.RB.lineTo(i.BB[g].x+this.QB.x,i.BB[g].y+this.QB.y);cB.RB.lineTo(h.BB[g].x+this.QB.x,h.BB[g].y+this.QB.y);}cB.RB.closePath();cB.RB.YK(0xFF000000);}}class ZC extends aC{var eM;var hM;var jM;var position;var eC=-1;var HC=0;var XL=1;var uC=false;var kH=false;var KE=false;var NM=false;var FE=0;var jD=0;var PE=0;ZC( g){jM=new aC();DB(jM);this.DE=g;if(this.DE==null)return;this.x=100000;}set DE( g){if(eM!=null)this.vB(eM);if(hM!=null)this.vB(hM);eM=null;hM=null;if(g!=null){eM=g;eM.vC=PD.QD/2;eM.wC=PD.QD/2;DB(eM);}else{hM=new lG();DB(hM);}DB(jM);} get DE{return eM;} setScale( g){this.XL=g;if(hM!=null){hM.RB.clear();hM.RB.beginPath();hM.RB.TH(0,0,PD.QD/2*g);hM.RB.closePath();hM.RB.II(0xff999999,1);}if(eM!=null)eM.VC=eM.WC=g;jM.VC=jM.WC=g;} zE( j){if(eM==null)return false;var g=this.nH(j);g=eM.PC(g);var k=this.DE.bitmapData.gK(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new oB(n.MB("items").IB("blood"));h.vC=50;h.wC=50;h.x=g.x-PD.QD/2;h.y=g.y-PD.QD/2;jM.DB(h);}return i;}}class OI extends aC{var RC;OI(){RC=new List<ZC>();} YL(){this.RC.sort(fL);} WD( g){if(this.contains(g))return;this.DB(g);this.RC.add(g);} PL( g){if(this.RC.length>0){var h=this.RC.indexOf(g);if(h>=0)this.RC.removeAt(h);}if(this.contains(g))this.vB(g);} fL( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.fD(g)<this.fD(h))this.JI(g,h);return 1;}if(g.position.z<h.position.z){if(this.fD(g)>this.fD(h))this.JI(g,h);return -1;}return 0;}}class oD{static var bG=new XB.Random();static  dG( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=oD.bG.nextInt(h+1)+g;}return i;}static  WI( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=oD.bG.nextDouble()*(h-g)+g;}return i;}}class QI extends TE{var cM;var gM;QI( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.cM=h;this.gM=g;VK();} get IL{return cM;} VK(){var g=new List<yB>();var h=0.0;var k=2*XB.PI/gM;for(var j=0;j<gM;j++ ){var i=new yB(0,-cM);i.rE=h;g.add(i);h+= k;}this.BB=g;}}class TE implements SI,RI{var BB;TE([ pointList]){this.BB=(pointList!=null)?pointList:new List();}CI( g){if(g<BB.length)this.BB.removeAt(g);} zE( h){var k=this.BB.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(BB[g].y<h.y&&BB[i].y>=h.y||BB[i].y<h.y&&BB[g].y>=h.y){if(BB[g].x+(h.y-BB[g].y)/(BB[i].y-BB[g].y)*(BB[i].x-BB[g].x)<h.x){j=!j;}}i=g;}return j;} rotate( k){var j=this.BB.length;var i=new List<yB>(j);for(var g=0;g<j;g++ ){var h=this.BB[g].clone();h.rE+= k;i[g]=h;}return new TE(i);} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.BB.length;var i=new List<yB>(j);for(var g=0;g<j;g++ ){var k=this.BB[g].clone();k.scale(h);i[g]=k;}return new TE(i);} transform( l, k, m){var j=this.BB.length;var i=new List<yB>(j);for(var g=0;g<j;g++ ){var h=this.BB[g].clone();h.scale(l);h.rE+= k;i[g]=h.add(m);}return new TE(i);}}abstract class RI{}abstract class SI{}class AC extends aC{var dM=0;var iM=0;var kM=true;var lM=3;var mM=0.0;var nM;var oM;AC( h, g){WL(h,g);} WL( g, h){nM=g;oM=h;this.dispatchEvent(new p(p.QF,this));} get yE{return nM;} get cH{return oM;} start(){this.paused=false;this.dispatchEvent(new p(p.aE,this));} eK(){this.dispatchEvent(new p(p.bE,this));}set QE( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;mM=g;this.dispatchEvent(new p(p.WE,this));} get QE{return mM;}set hD( g){if(g<0)g=0;lM=g;this.dispatchEvent(new p(p.pD,this));if(lM==0)this.eK();} get hD{return lM;}set iD( g){if(g<0)g=0;dM=g;this.dispatchEvent(new p(p.ZE,this));} get iD{return dM;} get UL{return dM.toDouble().round().toInt();}set nB( g){if(g<0)g=0;iM=g;this.dispatchEvent(new p(p.YE,this));} get nB{return iM;} oK(){this.nB+= 1;return this.nB;}set paused( g){kM=g;this.dispatchEvent(new p(p.XE,this));} get paused{return kM;}}var IC;var RF;var n;var eB;var YI;var kC;var dE;var CC;const  eE="Russo One"; main(){IC=new VD("Stage",PB.query('#stage'));RF=new ZF();RF.JK(IC);eB=RF.FG;YI=new XB.Random();UB.FH.webp=true;var g=UB.UD("images/Loading.png");g.then((h){kC=new oB(h);kC.vC=20;kC.wC=20;kC.x=400;kC.y=270;IC.DB(kC);dE=new pE(kC,100,mF.nF);dE.QH.wB.TG(100.0*2.0*XB.PI);eB.add(dE);CC=new mC();CC.NC=new UF("Arial",20,0xA0A0A0,bold:true);CC.width=240;CC.height=40;CC.text="... loading ...";CC.x=400-CC.cL/2;CC.y=320;CC.rH=false;IC.DB(CC);ZI();});} ZI(){n=new jG();n.EC("barrier01","images/barrier01.png");n.EC("barrier02","images/barrier02.png");n.EC("barrier03","images/barrier03.png");n.EC("barrier04","images/barrier04.png");n.EC("barrier05","images/barrier05.png");n.EC("barrier06","images/barrier06.png");n.EC("barrier07","images/barrier07.png");n.EC("training01","images/training01.png");n.EC("training02","images/training02.png");n.EC("finish","images/finish.png");n.EC("broken","images/broken.png");n.KK("items","images/ItemTextureAtlas.json",SF.rG);n.qF("crash","sounds/crash.mp3");n.qF("swish","sounds/swish.mp3");n.qF("speedalizer","sounds/speedalizer.mp3");n.YB("DISPLAY_LEVEL","Level: {0}");n.YB("DISPLAY_LIVES","Ships:");n.YB("DISPLAY_SCORE","Score: {0}");n.YB("DISPLAY_TRAINING","Training");n.YB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");n.YB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");n.YB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");n.YB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");n.YB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");n.YB("MESSAGE_GAME_OVER","Game\nOver!");n.YB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");n.YB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");n.YB("GENscore","Score");n.YB("GENlevel","Level");n.YB("GENexitquery","Do you really want to quit the game?");n.YB("GENyes","Yes");n.YB("GENno","No");n.load().then((j){IC.vB(kC);IC.vB(CC);eB.remove(dE);var h=new zB(800,600);h.LK(IC);h.start();}).catchError((i){for(var g in n.ZH){print("Loading resouce failed: ${g.kind}.${g.name} - ${g.error}");}});}const pL=const qL();class qL{const qL();}class mC extends JB{var NN="";var YN=0x000000;var qN=null;var EO=gI.JH;var RO=fI.tI;var aO=hI.nI;var gO=false;var mO=false;var qO=0x000000;var vO=false;var zO=0x000000;var GP=0;var JP=0;var MP;var SP;var WP=true;var ZP=100;var aP=100;var eP=null;var hO=null;mC([ text, textFormat]){if(text!=null)NN=text;if(textFormat!=null)NC=textFormat;else qN=new UF("Arial",12,0x000000);MP=new List<String>();SP=new List<iI>();} get type=>aO; get width=>ZP; get height=>aP; set text( g){NN=g;WP=true;} set OD( g){YN=g;WP=true;} set NC( g){qN=g;YN=qN.color;WP=true;} set wordWrap( g){gO=g;WP=true;} set width( g){ZP=g;WP=true;} set height( g){aP=g;WP=true;} get cL{zQ();return GP;} aB( g,[ returnRectangle]){return oF(g,ZP,aP,returnRectangle);} SB( g, h){if(g>=0&&h>=0&&g<ZP&&h<aP)return this;return null;} EB( g){zQ();g.hO.drawImage(eP,0.0,0.0);} NR( t){var o=yI(t);MP.clear();SP.clear();if(gO==false){for(String h in NN.replaceAll('\r','').split('\n'))MP.add(h);}else{for(String h in NN.replaceAll('\r','').split('\n')){var g='';for(String j in h.split(' ')){var m=g;g=(g.length==0)?j:g+' '+j;if(hO.measureText(g).width>ZP){if(m.length==0){MP.add(g);g='';}else{MP.add(m);g=j;}}}if(g.isEmpty==false){MP.add(g);}}}GP=0;JP=0;for(String g in MP){var k=hO.measureText(g);var l=0.0;if(qN.align==sB.kE||qN.align==sB.AJ)l=(ZP-k.width)/2;if(qN.align==sB.mE||qN.align==sB.uI)l=ZP-k.width;var i=new iI(l,k.width,qN.size,o.CE,o.xE,0);SP.add(i);GP=XB.max(GP,i.width);JP=JP+i.height;}} zQ(){if(WP){WP=false;var h=ZP.ceil().toInt();var i=aP.ceil().toInt();if(eP==null){eP=new PB.CanvasElement(width:h,height:i);hO=eP.context2D;}if(eP.width!=h)eP.width=h;if(eP.height!=i)eP.height=i;var m=new StringBuffer()..write(qN.italic?"italic ":"normal ")..write("normal ")..write(qN.bold?"bold ":"normal ")..write("${qN.size}px ")..write("${qN.font},sans-serif");var j=m.toString();hO.font=j;hO.textAlign="start";hO.textBaseline="alphabetic";hO.fillStyle=zD(YN);NR(j);if(mO){hO.fillStyle=zD(qO);hO.fillRect(0,0,ZP,aP);}else{hO.clearRect(0,0,ZP,aP);}var k=qN.size;for(int g=0;g<MP.length;g++ ){var l=SP[g];hO.fillStyle=zD(YN);hO.fillText(MP[g],l.x,k);k+= l.height;}if(vO){hO.strokeStyle=zD(zO);hO.lineWidth=1;hO.strokeRect(0,0,ZP,aP);}}}}class lG extends q{var IN=new uD(); get RB=>IN; aB( g,[ returnRectangle]){if(IN==null){return super.aB(g,returnRectangle);}else{return IN.OP(g);}} SB( g, h){if(IN==null){return null;}else{return IN.pP(g,h)?this:null;}} EB( g){if(IN!=null)IN.EB(g);}}abstract class TF{ EB( g);}class gE{var xC=null;gE();factory gE.VM( i, g, h, j){return new tL(i,g,h,j);} EB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);}}abstract class JB extends q{var WK=false;var rH=true;var UM=true;var tabIndex=0;static const  KJ=const DC<s>(s.nE);static const  aJ=const DC<s>(s.kF);static const  fJ=const DC<s>(s.pC);static const  oJ=const DC<s>(s.AE);static const  uJ=const DC<s>(s.EH); get onMouseOut=>JB.KJ.forTarget(this); get onMouseMove=>JB.aJ.forTarget(this); get onMouseDown=>JB.fJ.forTarget(this); get onMouseUp=>JB.oJ.forTarget(this); get onMouseWheel=>JB.uJ.forTarget(this);static const  zJ=const DC<TB>(TB.CH);static const  AK=const DC<TB>(TB.uG);static const  BK=const DC<TB>(TB.wG); get onTouchMove=>JB.zJ.forTarget(this); get onTouchEnd=>JB.AK.forTarget(this); get onTouchCancel=>JB.BK.forTarget(this);static const  EK=const DC<KC>(KC.tG);static const  FK=const DC<KC>(KC.dF); get onKeyUp=>JB.EK.forTarget(this); get onKeyDown=>JB.FK.forTarget(this);}class WF{var png;var jpg;var webp;WF({this.png: true,this.jpg: true,this.webp: false});}class dI extends JB{var width;var height;dI(this.width,this.height); aB( g,[ returnRectangle]){return oF(g,width,height,returnRectangle);} SB( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} EB( g){}}final  jE=new jI<List<q>>(()=>new List<q>());abstract class jB{static  UD( g,[ soundLoadOptions=null]){switch (TD.TJ){case "WebAudioApi":return YF.UD(g,soundLoadOptions);case "AudioElement":return XF.UD(g,soundLoadOptions);default:return DD.UD(g,soundLoadOptions);}}static var FH=new BD(mp3:true,mp4:true,ogg:true,wav:true); get length; play([ loop=false, soundTransform]);}abstract class bC extends cC{ set IF( g); stop();}class BD{var mp3;var mp4;var ogg;var wav;var ignoreErrors;BD({this.mp3: false,this.mp4: false,this.ogg: false,this.wav: false,this.ignoreErrors: true});}class kB{var volume;var pan;var PM=1;var QM=0;var TM=1;var SM=0;kB([this.volume=1,this.pan=0]);}class TD{static var TJ=mJ();static var oE=sJ();static var GH=tJ();static  mJ(){var h=(oE!=null)?"WebAudioApi":"AudioElement";var g=PB.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(GH.length==0)h="Mock";print("StageXL: supported audio engine is: ${h}");return h;}static  sJ(){if(aG.AudioContext.supported)return new aG.AudioContext();return null;}static  tJ(){var g=new List<String>();var h=new PB.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/mp4",""))!=-1)g.add("mp4");if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("StageXL: supported audio types are: ${g}");return g;}static  PH( i, h){var l=new RegExp(r"(mp3|mp4|ogg|wav)$",multiLine:false,caseSensitive:true);var g=GH.toList();var k=l.firstMatch(i);var j=new List<String>();if(k==null){throw new ArgumentError("Unsupported file extension.");}if(g.length==0){throw new UnsupportedError("This browser supports no known audio codec.");}if(!h.mp3)g.remove("mp3");if(!h.mp4)g.remove("mp4");if(!h.ogg)g.remove("ogg");if(!h.wav)g.remove("wav");var m=k.group(1);if(g.contains(m)){j.add(i);g.remove(m);}for(var o in g){j.add(i.replaceAll(l,o));}return j;}}class XF extends jB{var PN;var gN;var yN;XF(){yN=new List<iE>();PN=new PB.AudioElement();PN.onEnded.listen(lO);gN=new List<PB.AudioElement>();gN.add(PN);PB.document.body.children.add(PN);}static  UD( k,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=jB.FH;var m=new XF();var g=m.PN;var h=TD.PH(k,soundLoadOptions);var i=new dB.Completer<jB>();if(h.length==0){return DD.UD(k,soundLoadOptions);}var j;var l;HB(t){j.cancel();l.cancel();i.complete(m);}o(t){if(h.length>0){g.src=h.removeAt(0);g.load();}else{j.cancel();l.cancel();if(soundLoadOptions.ignoreErrors){DD.UD(k,soundLoadOptions).then((w)=>i.complete(w));}else{i.completeError(new StateError("Failed to load audio."));}}}j=g.onCanPlayThrough.listen(HB);l=g.onError.listen(o);g.src=h.removeAt(0);g.load();return i.future;} get length{return PN.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new kB();return new iE(this,loop,soundTransform);} EP( h){var g;if(gN.length==0){g=PN.clone(true);g.onEnded.listen(lO);}else{g=gN.removeAt(0);}yN.add(h);return g;} RQ( g){var h=g.PN;var i=yN.indexOf(g);yN.removeAt(i);gN.add(h);if(PN.currentTime>0&&PN.ended==false)PN.currentTime=0;} lO( j){var i=j.target;var g=null;for(int h=0;h<yN.length&&g==null;h++ )if(yN[h].PN==i)g=yN[h];if(g!=null)g.stop();}}class iE extends bC{var cN;var PN;var KN;var dN;iE( g, i, h){cN=g;KN=i;dN=h;PN=g.EP(this);PN.loop=KN;this.IF=h;PN.play();} set IF( g){dN=g;if(PN!=null)PN.volume=(dN!=null)?dN.volume:1;} stop(){if(PN!=null){if(PN.ended==false)PN.pause();cN.RQ(this);PN=null;}}}class sD extends JB{var upState;var overState;var downState;var hitTestState;var XG=true;var enabled=true;var XO;sD([this.upState,this.overState,this.downState,this.hitTestState]){u(s.DH,yO);u(s.nE,yO);u(s.pC,yO);u(s.AE,yO);XO=this.upState;} aB( g,[ returnRectangle]){if(XO!=null){CQ.wF(XO.KQ,g);return XO.aB(CQ,returnRectangle);}return super.aB(g,returnRectangle);} SB( k, l){if(this.hitTestState!=null){var g=this.hitTestState.KQ;var h=k-g.gB;var i=l-g.hB;var m=(g.d*h-g.c*i)/g.fC;var j=(g.a*i-g.b*h)/g.fC;if(this.hitTestState.SB(m,j)!=null)return this;}return null;} EB( g){if(XO!=null)g.DI(XO);} yO( g){if(g.type==s.nE){XO=upState;}else{XO=g.dC?downState:overState;}}}class sL extends bC{var ZN;var dN;var KN;var HO;var QO;sL( j, h, i){ZN=j;KN=h;dN=i;var g=TD.oE;HO=g.createGain();HO.connect(g.destination,0,0);HO.gain.value=(dN!=null)?XB.pow(dN.volume,2):1;QO=g.createBufferSource();QO.buffer=ZN.ON;QO.loop=h;QO.connect(HO,0,0);QO.start(0);} set IF( g){dN=g;HO.gain.value=(dN!=null)?XB.pow(dN.volume,2):1;} stop(){QO.stop(0);}}class DD extends jB{DD(){}static  UD( g,[ soundLoadOptions=null]){return new dB.Future<jB>.value(new DD());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new kB();}return new rL(this,loop,soundTransform);}}class rL extends bC{var KN;var dN;rL( i, h, g){KN=h;dN=g;}set IF( g){dN=g;} stop(){}}class oB extends q{var bitmapData;var pixelSnapping;var vF;oB([this.bitmapData=null,this.pixelSnapping="auto"]){vF=null;} aB( h,[ returnRectangle]){var g=(bitmapData!=null)?bitmapData.width:0;var i=(bitmapData!=null)?bitmapData.height:0;return oF(h,g,i,returnRectangle);} SB( g, h){if(bitmapData!=null&&g>=0.0&&h>=0.0&&g<bitmapData.width&&h<bitmapData.height)return this;return null;} EB( g){if(bitmapData==null)return;if(vF==null){bitmapData.EB(g);}else{bitmapData.RL(g,vF);}}}class fI{static const  tI="pixel";}class aI{static const  rI="round";}class gI{static const  JH="none";}class hI{static const  nI="dynamic";}class UF{var font;var size;var color;var bold;var italic;var underline;var align;var leftMargin;var rightMargin;var indent;var leading;var letterSpacing=0;var EM=0;var FM=false;var OM=false;UF(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.leftMargin: 0,this.rightMargin: 0,this.indent: 0,this.leading: 0});}class sB{static const  kE="center";static const  uI="end";static const  AJ="justify";static const  zG="left";static const  mE="right";}class iI{var CE;var xE;var height;var leading;var width;var x;iI(this.x,this.width,this.height,this.CE,this.xE,this.leading);}class RD{static const  lI=0;static const  zG=1;static const  mE=2;static const  CJ=3;static const  yG=4;}class CD{static var oG=rB.cF;static var sI=false;static var vG=null;static var EJ=null;static var HJ=null;static var OJ=new dB.StreamController<String>();static var VJ=OJ.stream.asBroadcastStream();static  NH( i){var h=i;var g="auto";if(oG!=rB.cF){h=oG;}switch (h){case rB.cF:g="auto";break;case rB.eF:g="default";break;case rB.gF:g="pointer";break;case rB.FJ:g="move";break;case rB.GJ:g="text";break;case rB.JJ:g="wait";break;}if(sI){g="none";}return g;}}class rB{static const  cF="auto";static const  eF="arrow";static const  gF="button";static const  FJ="hand";static const  GJ="ibeam";static const  JJ="wait";}class kG{static const  JH="none";static const  BJ="touchPoint";}class aC extends nC{var GM=false;var XG=false;var EG=null;var IN=null;var LO=null; get RB{return (IN!=null)?IN:IN=new uD();}OQ(){var i=this.CF;var j=this.ND;var m=this.visible;if(i!=null&&this.ND!=null){var h=CD.HJ;if(h!=null){var g=KQ.SE(i);if(g.x<h.left)g.x=h.left;if(g.x>h.right)g.x=h.right;if(g.y<h.top)g.y=h.top;if(g.y>h.bottom)g.y=h.bottom;i=KQ.UH().SE(g);}var l=new FB(xO,BP).add(i).subtract(CD.EJ);var k=KQ.SE(l);this.visible=false;LO=j.SB(j.ME,j.NE);this.x=k.x;this.y=k.y;this.visible=m;}} aB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new CB.WM();super.aB(g,returnRectangle);if(IN!=null){returnRectangle=IN.OP(g).union(returnRectangle);}return returnRectangle;} SB( i, j){var h=null;if(this.EG!=null){var g=this.UG(this.EG);if(g!=null){var k=i*g.a+j*g.c+g.gB;var l=i*g.b+j*g.d+g.hB;if(this.EG.SB(k,l)!=null){h=this;}}}else{h=super.SB(i,j);if(h==null&&IN!=null){if(IN.pP(i,j)){h=this;}}}return h;}EB( g){if(IN!=null)IN.EB(g);super.EB(g);}}class jG{var VN;jG(){VN=new Map<String,fE>();} iO( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(VN.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");VN[i]=g;} dP( i, g){var h="${i}.${g}";if(VN.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return VN[h];} EC( i, h,[ bitmapDataLoadOptions=null]){var g=new fE("BitmapData",i,h);g.iP(UB.UD(h,bitmapDataLoadOptions));iO(g);} qF( i, h,[ soundFileSupport=null]){var g=new fE("Sound",i,h);g.iP(jB.UD(h,soundFileSupport));iO(g);} KK( j, h, i){var g=new fE("TextureAtlas",j,h);g.iP(lC.UD(h,i));iO(g);} YB( i, h){var g=new fE("Text",i,"");g.iP(new dB.Future.value(h));iO(g);} load(){var h=this.GL.map((i)=>i.iN);return dB.Future.wait(h).then((j){var g=this.ZH;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get GL{return VN.values.where((g)=>g.RE==null).toList();} get ZH{return VN.values.where((g)=>g.error!=null).toList();} IB( g){return dP("BitmapData",g).RE;} BG( g){return dP("Sound",g).RE;} MB( g){return dP("TextureAtlas",g).RE;} iK( g){return dP("Text",g).RE;}}class fE{var CN;var RN;var bN;var iN;var tN;var xN;fE( g, h, i){CN=g;RN=h;bN=i;tN=null;xN=null;} get kind=>CN; get name=>RN; get RE=>xN; get error=>tN;iP( i){iN=i.then((g){xN=g;tN=null;},onError:(h){xN=null;tN=h;});}}class lC{final  MN=new List<iG>();var pN;static  UD( o, iB){var k=new dB.Completer<lC>();var g=new lC();switch (iB){case SF.oI:case SF.rG:PB.HttpRequest.getString(o).then((OB){var t=iL.parse(OB);var h=t["frames"];var w=t["meta"];var YC=wJ(o,w["image"]);if(h is List){for(var HB in h){var j=HB as Map;var i=j["filename"] as String;var l=OH(i);var m=new iG.XM(g,l,j);g.MN.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=OH(i);var m=new iG.XM(g,l,j);g.MN.add(m);}}UB.UD(YC).then(( qB){g.pN=qB;k.complete(g);}).catchError((WB){k.completeError(new StateError("Failed to load image."));});}).catchError((WB){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} IB( h){for(int g=0;g<MN.length;g++ )if(MN[g].name==h)return new UB.bM(MN[g]);throw new ArgumentError("TextureAtlasFrame not found: '${h}'");}}class SF{static const  oI="json";static const  rG="jsonarray";}class iG{final  HN;final  RN;final  lN;final  wN;final  GO;final  MO;final  TO;final  YO;final  dO;final  fO;final  kO;iG.XM( i, h, g):HN=i,RN=h,lN=lJ(g["rotated"]),wN=rC(g["sourceSize"]["w"]),GO=rC(g["sourceSize"]["h"]),MO=rC(g["spriteSourceSize"]["x"]),TO=rC(g["spriteSourceSize"]["y"]),YO=rC(g["frame"]["x"]),dO=rC(g["frame"]["y"]),fO=rC(g["frame"]["w"]),kO=rC(g["frame"]["h"]); get dL=>HN; get name=>RN; get TL=>lN; get aK=>YO; get bK=>dO; get bH=>fO; get aH=>kO; get offsetX=>MO; get offsetY=>TO; get FL=>wN; get EL=>GO;}class jI<yD>{final  AN=new List<yD>();final  eN;var nN=0;jI( g()):eN=g; AI(){if(nN==0){return eN();}else{nN-- ;return AN[nN];}}BI( g){if(nN==AN.length){AN.add(g);}else{AN[nN]=g;}nN++ ;}reset(){AN.clear();nN=0;}}class YF extends jB{var ON;YF(){if(TD.oE==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  UD( h,[ soundLoadOptions=null]){if(soundLoadOptions==null)soundLoadOptions=jB.FH;var l=new YF();var g=new dB.Completer<jB>();var i=TD.PH(h,soundLoadOptions);var w=TD.oE;if(i.length==0){return DD.UD(h,soundLoadOptions);}HB(m){w.decodeAudioData(m.response,( t){l.ON=t;g.complete(l);},(o){if(soundLoadOptions.ignoreErrors){DD.UD(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to decode audio."));}});}k(o){if(i.length>0){PB.HttpRequest.request(i.removeAt(0),responseType:'arraybuffer').then(HB).catchError(k);}else{if(soundLoadOptions.ignoreErrors){DD.UD(h,soundLoadOptions).then((j)=>g.complete(j));}else{g.completeError(new StateError("Failed to load audio."));}}}k(null);return g.future;} get length{return ON.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new kB();return new sL(this,loop,soundTransform);}}class cI{cI();}class bI{static const  rI="round";}final  bF=new Map<String,IH>();abstract class JC{EB( g); SB( g, h, i){EB(g);return false;}yC( g){}}class AB{var uM,vM,yM,zM,BN,GN;var TN;AB( h, i, g, j, k, l):uM=h.toDouble(),vM=i.toDouble(),yM=g.toDouble(),zM=j.toDouble(),BN=k.toDouble(),GN=l.toDouble(),TN=(h*j-i*g).toDouble();AB.YM():uM=1.0,vM=0.0,yM=0.0,zM=1.0,BN=0.0,GN=0.0,TN=1.0; clone(){return new AB(uM,vM,yM,zM,BN,GN);} UH(){var h=(zM/TN);var i=-(vM/TN);var g=-(yM/TN);var j=(uM/TN);var k=-(h*BN+g*GN);var l=-(i*BN+j*GN);return new AB(h,i,g,j,k,l);} get a=>uM; get b=>vM; get c=>yM; get d=>zM; get gB=>BN; get hB=>GN; get fC=>TN; SE( h){var i=h.x.toDouble();var g=h.y.toDouble();return new FB(i*uM+g*yM+BN,i*vM+g*zM+GN);} gQ( h){var i=h.x.toDouble();var g=h.y.toDouble();return new FB(i*uM+g*yM+BN,i*vM+g*zM+GN);} concat( g){var m=uM;var w=vM;var HB=yM;var t=zM;var l=BN;var o=GN;var WB=TN;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var iB=g.gB;var OB=g.hB;var qB=g.fC;uM=(m*j+w*i).toDouble();vM=(m*k+w*h).toDouble();yM=(HB*j+t*i).toDouble();zM=(HB*k+t*h).toDouble();BN=(l*j+o*i+iB).toDouble();GN=(l*k+o*h+OB).toDouble();TN=(WB*qB).toDouble();} iH(){uM=1.0;vM=0.0;yM=0.0;zM=1.0;BN=0.0;GN=0.0;TN=1.0;} jH(){var j=uM;var m=vM;var l=yM;var k=zM;var h=BN;var i=GN;var g=TN;uM=(k/g).toDouble();vM=-(m/g).toDouble();yM=-(l/g).toDouble();zM=(j/g).toDouble();BN=-(uM*h+yM*i).toDouble();GN=-(vM*h+zM*i).toDouble();TN=(1.0/g).toDouble();} rotate( i){var g=XB.cos(i);var h=XB.sin(i);var j=uM;var o=vM;var m=yM;var l=zM;var k=BN;var t=GN;uM=(j*g-o*h).toDouble();vM=(j*h+o*g).toDouble();yM=(m*g-l*h).toDouble();zM=(m*h+l*g).toDouble();BN=(k*g-t*h).toDouble();GN=(k*h+t*g).toDouble();} GF( h, i, g, k, j, l){uM=h.toDouble();vM=i.toDouble();yM=g.toDouble();zM=k.toDouble();BN=j.toDouble();GN=l.toDouble();TN=(uM*zM-vM*yM).toDouble();} uE( g){uM=g.a.toDouble();vM=g.b.toDouble();yM=g.c.toDouble();zM=g.d.toDouble();BN=g.gB.toDouble();GN=g.hB.toDouble();TN=g.fC.toDouble();} wF( h, g){var o=h.a;var HB=h.b;var OB=h.c;var w=h.d;var m=h.gB;var t=h.hB;var iB=h.fC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var qB=g.gB;var WB=g.hB;var YC=g.fC;uM=(o*k+HB*j).toDouble();vM=(o*l+HB*i).toDouble();yM=(OB*k+w*j).toDouble();zM=(OB*l+w*i).toDouble();BN=(m*k+t*j+qB).toDouble();GN=(m*l+t*i+WB).toDouble();TN=(iB*YC).toDouble();}}class mG extends GB{static const  wI="textInput";var NN="";mG( g,[ bubbles=false]):super(g,bubbles);}class s extends GB{static const  ED="click";static const  xI="doubleClick";static const  pC="mouseDown";static const  AE="mouseUp";static const  kF="mouseMove";static const  nE="mouseOut";static const  DH="mouseOver";static const  EH="mouseWheel";static const  HH="middleClick";static const  ZJ="middleMouseDown";static const  eJ="middleMouseUp";static const  KH="rightClick";static const  jJ="rightMouseDown";static const  nJ="rightMouseUp";var tP,uP;var wP,yP;var PQ;var rO;var HP;var sO;var wO;var TQ;var UQ;var VQ;s( g,[ bubbles=false]):super(g,bubbles){bP(g,bubbles);} bP( g,[ bubbles=false]){super.bP(g,bubbles);tP=uP=0;wP=yP=0;PQ=false;rO=false;HP=false;sO=false;wO=false;TQ=0;UQ=0;VQ=0;}set YQ( g){tP=g.x;uP=g.y;}set bQ( g){wP=g.x;yP=g.y;} get GI=>wP; get HI=>yP; get dC=>PQ; get altKey=>rO; get ctrlKey=>sO; get shiftKey=>wO; get EE=>TQ; get deltaX=>UQ; get deltaY=>VQ;}class tD extends GB{var DN;tD( g):super(GB.jF,false){DN=g;} get sE=>false;}class DC<yD extends GB>{final  UN;const DC(this.UN); forTarget( g,{ useCapture: false}){return g.VO(UN,useCapture);}}class SD<yD extends GB> extends dB.Stream<yD>{final  fN;final  UN;final  zN;final  NO=new List<pI>();var cO=0;SD(this.fN,this.UN,this.zN); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError(error), onDone(), cancelOnError: false}){var g=new pI<yD>(this,h);if(cO==NO.length){NO.add(g);}else{NO[cO]=g;}cO++ ;if(UN==GB.jF&&zN==false)hE.BH.uO(this);return g;} VP( h){for(int g=0;g<cO;g++ ){if(identical(NO[g],h)){NO[g]=null;break;}}} get XQ{for(var g=0;g<cO;g++ )if(NO[g]!=null)return true;return false;} fP(){for(int g=0;g<cO;g++ )if(NO[g]!=null)NO[g].cancel();} xP( k){var j=cO;var h=0;for(int g=0;g<j;g++ ){var i=NO[g];if(i==null)continue;i.PO(k);if(h!=g){NO[h]=i;NO[g]=null;}h++ ;}if(h!=j){for(int g=j;g<cO;g++ ){NO[h++ ]=NO[g];NO[g]=null;}cO=h;}}}class hE<yD extends GB>{final  JN=new List<SD>();var uN=0;static var BH=new hE<tD>(); uO( g){for(int h=0;h<uN;h++ ){if(JN[h]==g)return;}if(uN==JN.length){JN.add(g);}else{JN[uN]=g;}uN++ ;} xP( j){j.zP=AD.lE;j.DQ=false;j.IQ=false;var k=uN;var i=0;for(int g=0;g<k;g++ ){var h=JN[g];if(h==null)continue;if(h.cO==0){JN[g]=null;continue;}j.fN=h.fN;j.NQ=h.fN;h.xP(j);if(i!=g){JN[i]=h;JN[g]=null;}i++ ;}if(i!=k){for(int g=k;g<uN;g++ ){JN[i++ ]=JN[g];JN[g]=null;}uN=i;}}}class cC{var JN;var kN; u( g, h(event),{ useCapture: false}){return VO(g,useCapture).listen(h);}bB( g,{ useCapture: false}){VO(g,useCapture).fP();}dispatchEvent( g){lP(g,this,this,AD.lE);} QQ( h, j, i){if(j&&kN!=null){var g=kN[h];if(g!=null&&g.XQ)return true;}if(i&&JN!=null){var g=JN[h];if(g!=null&&g.XQ)return true;}return false;} VO( h, g){if(g){if(kN==null)kN=new Map<String,SD>();}else{if(JN==null)JN=new Map<String,SD>();}var i=g?kN:JN;return i.putIfAbsent(h,(){return new SD(this,h,g);});}lP( g, k, l, j){var h=(j==AD.pG)?kN:JN;if(h==null)return;var i=h[g.type];if(i==null)return;g.fN=k;g.NQ=l;g.zP=j;g.DQ=false;g.IQ=false;i.xP(g);}}class uD{static final  cJ=new PB.CanvasElement(width:16,height:16);static final  gJ=cJ.context2D;final  kP=new List<JC>();var oP=new CB.WM();var vP=true;clear(){kP.clear();vP=true;}FQ( g){kP.add(g);vP=true;}beginPath()=>FQ(new uL());closePath()=>FQ(new vL());moveTo( h, g)=>FQ(new wL(h,g));lineTo( h, g)=>FQ(new xL(h,g));arc( l, g, j, i, h, k)=>FQ(new yL(l,g,j,i,h,k));rect( i, g, h, j)=>FQ(new zL(i,g,h,j));II( g,[ width=1.0, joints=bI.rI, caps=aI.rI])=>FQ(new AM(lF(g),width,joints,caps));YK( g)=>FQ(new BM(lF(g)));TH( i, g, h){FQ(new wL(i+h,g));FQ(new yL(i,g,h,0,XB.PI*2,false));} OP( i){var h=new qC(i);for(int g=0;g<kP.length;g++ ){kP[g].yC(h);}return h.hK();} pP( h, i){if(vP){vP=false;oP=OP(new AB.YM());}if(oP.contains(h,i)){var j=uD.gJ;j.beginPath();for(int g=0;g<kP.length;g++ ){if(kP[g].SB(j,h,i)){return true;}}}return false;} EB( i){var g=i.context;g.save();g.beginPath();for(int h=0;h<kP.length;h++ ){kP[h].EB(g);}g.restore();}}class GB{static const  qI="added";static const  sG="addedToStage";static const  jF="enterFrame";static const  IJ="removed";static const  MJ="removedFromStage";static const  SJ="resize";var aO;var LQ;var zP;var fN;var NQ;var DQ;var IQ;GB( g,[ bubbles=false]){bP(g,bubbles);} bP( g,[ bubbles=false]){aO=g;LQ=bubbles;zP=AD.lE;fN=null;NQ=null;DQ=false;IQ=false;} get JF=>DQ; get type=>aO; get bubbles=>LQ; get sE=>true; get target=>fN;}class AD{static const  pG=1;static const  lE=2;static const  zI=3;}class wD{final  matrix=new AB.YM();final  next;var alpha=1.0;var tE=fF.iF;wD(this.next);}class ZF{var wM;var LN;var XN;var oN;var CO;ZF(){wM=new vD();LN=new List<VD>();XN=double.NAN;oN=hE.BH;CO=new tD(0);PB.window.requestAnimationFrame(FP);} get FG=>wM; FP( g){PB.window.requestAnimationFrame(FP);if(XN.isNaN)XN=g;if(XN>g)XN=g;var k=g-XN;var h=k/1000.0;var l=g/1000.0;if(k>=1){XN=g;CO.DN=h;oN.xP(CO);wM.FD(h);for(int i=0;i<LN.length;i++ ){var j=LN[i];j.FG.FD(h);j.mK(l,h);}}} JK( g){if(g.PG!=null){g.PG.QL(g);}LN.add(g);g.iQ=this;} QL( g){if(g.PG==this){LN.remove(g);g.iQ=null;}}}class VF implements oC{final  QN;var aN=0.0;var mN=0.0;var vN=1;VF( g, h):QN=g{mN=XB.max(h,0.0001);} FD( h){var g=aN+h;while (g>=mN&&vN>0){aN=mN;vN-- ;QN();g-= mN;}aN=g;return (vN>0);} get currentTime=>aN;}abstract class oC{ FD( g);}class vD implements oC{final  WN=new List<oC>();var rN=0;var BO=0.0; get elapsedTime=>BO; add( g){if(g==null)return;if(this.contains(g))return;if(rN==WN.length){WN.add(g);}else{WN[rN]=g;}rN++ ;} remove( h){if(h==null)return;for(int g=0;g<rN;g++ ){if(identical(WN[g],h)){WN[g]=null;break;}}} contains( h){if(h==null)return false;for(int g=0;g<rN;g++ ){if(identical(WN[g],h)){return true;}}return false;} VG( h, i,[ transitionFunction]){var g=new pE(h,i,transitionFunction);add(g);return g;} wE( h, i){var g=new VF(h,i);add(g);return g;} FD( k){BO+= k;var j=rN;var h=0;for(int g=0;g<j;g++ ){var i=WN[g];if(i==null)continue;if(i.FD(k)==false){WN[g]=null;continue;}if(h!=g){WN[h]=i;WN[g]=null;}h++ ;}if(h!=j){for(int g=j;g<rN;g++ ){WN[h++ ]=WN[g];WN[g]=null;}rN=h;}return true;}}abstract class eI{}class nG{final  VG;nG(this.VG);call( h, g){FO(h).TG(g);} get x=>FO("x"); get y=>FO("y"); get VC=>FO("scaleX"); get WC=>FO("scaleY"); get skewX=>FO("skewX"); get skewY=>FO("skewY"); get vC=>FO("pivotX"); get wC=>FO("pivotY"); get wB=>FO("rotation"); get alpha=>FO("alpha"); FO( h){var g=new pB(h);this.VG.FO(g);return g;}}class xD{static const  mI="exactFit";static const  vI="noBorder";static const  DJ="noScale";static const  AH="showAll";}abstract class nC extends JB{final  jN=new List<q>();var DO=true;var KO=true; DB( g){if(g.parent==this){var h=jN.indexOf(g);jN.removeAt(h);jN.add(g);}else{IK(g,jN.length);}} IK( g, h){if(h<0||h>jN.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){jN.removeAt(jN.indexOf(g));if(h>jN.length)h-- ;jN.insert(h,g);}else{g.OL();g.dQ(this);jN.insert(h,g);g.dispatchEvent(new GB(GB.qI,true));if(this.ND!=null)kQ(g,new GB(GB.sG));}} vB( h){var g=jN.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");NL(g);} NL( g){if(g<0||g>=jN.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=jN[g];h.dispatchEvent(new GB(GB.IJ,true));if(this.ND!=null)kQ(h,new GB(GB.MJ));h.dQ(null);jN.removeAt(g);} eH( g){if(g<0||g>=jN.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return jN[g];} fD( g){return jN.indexOf(g);} JI( j, i){var h=fD(j);var g=fD(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");bL(h,g);} bL( h, g){var j=eH(h);var i=eH(g);jN[h]=i;jN[g]=j;} contains( g){for(;g!=null;g=g.AQ)if(g==this)return true;return false;} aB( o,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new CB.WM();if(jN.length==0)return super.aB(o,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var t=jN.length;for(int l=0;l<jN.length;l++ ){var m=jN[l];CQ.wF(m.KQ,o);var g=m.aB(CQ,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} SB( t, w){var l=null;for(int j=jN.length-1;j>=0;j-- ){var i=jN[j];if(i.visible){var g=i.KQ;var m=t-g.gB;var k=w-g.hB;var HB=(g.d*m-g.c*k)/g.fC;var o=(g.a*k-g.b*m)/g.fC;var h=i.SB(HB,o);if(h!=null){if(h is JB)if(h.rH)return DO?h:this;l=this;}}}return l;} EB( i){for(int h=0;h<jN.length;h++ ){var g=jN[h];if(!g.YP&&g.visible)i.DI(g);}}RR( g, i){i.add(g);if(g is nC){var k=g as nC;var j=k.jN;for(int h=0;h<j.length;h++ ){RR(j[h],i);}}}kQ( i, j){var g=jE.AI() as List<q>;RR(i,g);for(int h=0;h<g.length;h++ ){g[h].dispatchEvent(j);}g.clear();jE.BI(g);}}class FB{var tM;var xM;FB( h, g):tM=h,xM=g;FB.WM():this(0,0); clone()=>new FB(tM,xM); toString()=>"Point [x=${tM}, y=${xM}]";static  kJ( g, h)=>new FB(g*XB.cos(h),-g*XB.sin(h)); get x=>tM; get y=>xM; get length=>XB.sqrt(tM*tM+xM*xM);set x( g){tM=g;}set y( g){xM=g;} add( g){return new FB(tM+g.x,xM+g.y);} subtract( g){return new FB(tM-g.x,xM-g.y);}uE( g){tM=g.x;xM=g.y;} yF( g){return tM==g.x&&xM==g.y;}}class CB{var tM;var xM;var EN;var SN;CB( i, g, h, j):tM=i,xM=g,EN=h,SN=j;CB.WM():this(0,0,0,0); clone()=>new CB(tM,xM,EN,SN); toString()=>"Rectangle [x=${tM}, y=${xM}, width=${EN}, height=${SN}]"; get x=>tM; get y=>xM; get width=>EN; get height=>SN; get left=>tM; get top=>xM; get right=>tM+EN; get bottom=>xM+SN; get QB=>new FB(tM+EN/2,xM+SN/2); get size=>new FB(EN,SN);set x( g){tM=g;}set y( g){xM=g;}set width( g){EN=g;}set height( g){SN=g;} set size( g){EN=g.x;SN=g.y;} contains( g, h){return tM<=g&&xM<=h&&tM+EN>=g&&xM+SN>=h;} yF( g){return tM==g.x&&xM==g.y&&EN==g.width&&SN==g.height;} get isEmpty{return EN==0&&SN==0;}uE( g){tM=g.x;xM=g.y;EN=g.width;SN=g.height;} union( g){var i=XB.min(this.left,g.left);var h=XB.min(this.top,g.top);var j=XB.max(this.right,g.right);var k=XB.max(this.bottom,g.bottom);return new CB(i,h,j-i,k-h);} align(){var h=this.left.floor();var g=this.top.floor();var i=this.right.ceil();var j=this.bottom.ceil();return new CB(h,g,i-h,j-g);}}class TB extends GB{static const  qG="touchBegin";static const  uG="touchEnd";static const  wG="touchCancel";static const  CH="touchMove";static const  NJ="touchOver";static const  RJ="touchOut";var nP;var qP;var tP,uP;var wP,yP;var rO;var HP;var sO;var wO;var EQ;var GQ;var HQ;TB( g,[ bubbles=false]):super(g,bubbles){bP(g,bubbles);} bP( g,[ bubbles=false]){super.bP(g,bubbles);nP=0;qP=false;tP=uP=0;wP=yP=0;rO=false;HP=false;sO=false;wO=false;EQ=1.00;GQ=0;HQ=0;}set YQ( g){tP=g.x;uP=g.y;}set bQ( g){wP=g.x;yP=g.y;} get KF=>nP; get GI=>wP; get HI=>yP; get altKey=>rO; get ctrlKey=>sO; get shiftKey=>wO;}class KC extends GB{static const  dF="keyDown";static const  tG="keyUp";var rO;var sO;var wO;var AP;var HP;var LP;var PP;var RP;KC( g,[ bubbles=false]):super(g,bubbles){bP(g,bubbles);} bP( g,[ bubbles=false]){super.bP(g,bubbles);rO=false;sO=false;wO=false;AP=false;HP=false;LP=0;PP=0;RP=0;} get altKey=>rO; get ctrlKey=>sO; get shiftKey=>wO; get charCode=>LP; get keyCode=>PP; get keyLocation=>RP;}class lB{final  tM;final  xM;lB( h, g):tM=h.toDouble(),xM=g.toDouble(); clone()=>new lB(tM,xM); get x=>tM; get y=>xM; toString()=>"Vector [x=${tM}, y=${xM}]"; operator+( g)=>new lB(tM+g.tM,xM+g.xM); operator-( g)=>new lB(tM-g.tM,xM-g.xM); operator*( g)=>new lB(tM*g.tM,xM*g.xM); operator/( g)=>new lB(tM/g.tM,xM/g.xM); operator-()=>new lB(-tM,-xM); operator==( g)=>tM==g.tM&&xM==g.xM; scale( g){return new lB(tM*g,xM*g);} normalize(){var g=1/length;return new lB(tM*g,xM*g);} get length=>XB.sqrt(tM*tM+xM*xM); rotate( g){var i=XB.sin(g);var h=XB.cos(g);return new lB(tM*h-xM*i,tM*i+xM*h);}}class UB implements TF{var EN;var SN;var hN;var sN;var AO;var JO;var OO;var UO;var ZO;var bO;var eO;var jO;var pO;var hO;static var FH=new WF(png:true,jpg:true,webp:false);UB( h, i,[ transparent=true, fillColor=0xFFFFFFFF]){EN=h.toInt();SN=i.toInt();hN=transparent;sN=0;OO=ZO=0;UO=bO=0;AO=eO=EN;JO=jO=SN;var g=new PB.CanvasElement(width:EN,height:SN);hO=g.context2D;hO.fillStyle=hN?lF(fillColor):zD(fillColor);hO.fillRect(0,0,EN,SN);pO=g;}UB.aM( g){if(g==null)throw new ArgumentError();EN=g.naturalWidth.toInt();SN=g.naturalHeight.toInt();hN=true;sN=0;OO=ZO=0;UO=bO=0;AO=eO=EN;JO=jO=SN;pO=g;}UB.bM( g){EN=g.FL.toInt();SN=g.EL.toInt();hN=true;sN=g.TL?2:1;OO=g.offsetX;UO=g.offsetY;AO=g.bH;JO=g.aH;ZO=g.aK;bO=g.bK;eO=g.bH;jO=g.aH;pO=g.dL.pN.pO;}static  UD( h,[ bitmapDataLoadOptions=null]){if(bitmapDataLoadOptions==null)bitmapDataLoadOptions=UB.FH;var i=new dB.Completer<UB>();var g=new PB.ImageElement();var j;var k;j=g.onLoad.listen((m){j.cancel();k.cancel();i.complete(new UB.aM(g));});k=g.onError.listen((m){j.cancel();k.cancel();i.completeError(new StateError("Error loading image."));});if(bitmapDataLoadOptions.webp==false){g.src=h;return i.future;}DK.then(( t){var o=new RegExp(r"(png|jpg|jpeg)$",multiLine:false,caseSensitive:true);var l=o.firstMatch(h);if(t==false||l==null){g.src=h;}else{g.src=h.substring(0,h.length-l.group(1).length)+"webp";}});return i.future;} get width=>EN; get height=>SN; clone(){var g=new UB(EN,SN,true,0);g.XK(this);return g;} XK( h,[ matrix=null]){var g=QR();var i=new fB.ZM(g,matrix);h.EB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} clear(){var g=QR();g.clearRect(0,0,EN,SN);} gK( j, h){var i=QR();var k=i.getImageData(j,h,1,1);var g=k.data;if(CK){return (g[0]<<16)+(g[1]<<8)+(g[2]<<0)+(g[3]<<24);}else{return (g[3]<<16)+(g[2]<<8)+(g[1]<<0)+(g[0]<<24);}} EB( h){var g=h.context;switch (sN){case 0:g.drawImage(pO,OO,UO);break;case 1:g.drawImageScaledFromSource(pO,ZO,bO,eO,jO,OO,UO,AO,JO);break;case 2:g.transform(0.0,-1.0,1.0,0.0,OO,UO+JO);g.drawImageScaledFromSource(pO,ZO,bO,jO,eO,0.0,0.0,JO,AO);break;}} RL( hL, g){var iB=hL.context;if(g.width<=0.0||g.height<=0.0)return;switch (sN){case 0:iB.drawImageScaledFromSource(pO,g.x-OO,g.y-UO,g.width,g.height,g.x+OO,g.y+UO,g.width,g.height);break;case 1:var j=ZO;var h=bO;var w=j+eO;var HB=h+jO;var l=ZO-OO+g.x;var m=bO-UO+g.y;var WB=l+g.width;var OB=m+g.height;var t=(j>l)?j:l;var o=(h>m)?h:m;var qB=(w<WB)?w:WB;var YG=(HB<OB)?HB:OB;var k=qB-t;var i=YG-o;var ZG=OO-j+t;var YC=UO-h+o;if(k>0.0&&i>0.0){iB.drawImageScaledFromSource(pO,t,o,k,i,ZG,YC,k,i);}break;case 2:var j=ZO;var h=bO;var w=j+jO;var HB=h+eO;var l=ZO+UO-g.y+JO-g.height;var m=bO-OO+g.x;var WB=l+g.height;var OB=m+g.width;var t=(j>l)?j:l;var o=(h>m)?h:m;var qB=(w<WB)?w:WB;var YG=(HB<OB)?HB:OB;var k=YG-o;var i=qB-t;var ZG=OO-h+o;var YC=UO+w-qB;if(k>0.0&&i>0.0){iB.transform(0.0,-1.0,1.0,0.0,ZG,YC+i);iB.drawImageScaledFromSource(pO,t,o,i,k,0,0,i,k);}break;}} QR(){if(hO==null){var g=new PB.CanvasElement(width:EN,height:SN);hO=g.context2D;switch (sN){case 0:hO.drawImage(pO,OO,UO);break;case 1:hO.drawImageScaledFromSource(pO,ZO,bO,eO,jO,OO,UO,AO,JO);break;case 2:hO.transform(0.0,-1.0,1.0,0.0,OO,UO+JO);hO.drawImageScaledFromSource(pO,ZO,bO,jO,eO,0.0,0.0,JO,AO);hO.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}sN=0;OO=ZO=0;UO=bO=0;AO=eO=EN;JO=jO=SN;pO=g;}return hO;}}typedef  aF( ratio);typedef  kI<yD extends GB>( event);class pI<yD extends GB> extends dB.StreamSubscription<yD>{var IO;var PO;var SO;var WO;pI(this.IO,this.PO){SO=0;WO=false;} cancel(){if(WO==false){IO.VP(this);WO=true;PO=null;}} onError( g(error)){} get WQ=>SO>0; pause([ resumeSignal]){SO++ ;if(resumeSignal!=null){resumeSignal.whenComplete(resume);}} resume(){if(WQ==false){throw new StateError("Subscription is not paused.");}SO-- ;}}class fF{static const  iF="source-over";} zD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";} yI( g){if(bF.containsKey(g)==false){bF[g]=new IH(g);}return bF[g];}final  hF=new AB.YM();class xG{static var XJ=kG.JH;static var dJ=new dB.StreamController<String>();static var hJ=dJ.stream.asBroadcastStream();static  get pJ=>XJ;}abstract class q extends cC implements TF{static var QJ=0;var nO=QJ++ ;var tM=0.0;var xM=0.0;var xO=0.0;var BP=0.0;var DP=1.0;var IP=1.0;var KP=0.0;var NP=0.0;var QP=0.0;var TP=1.0;var XP=true;var YP=false;var cP=null;var gP=null;var hP=null;var jP=false;var mP=null;var rP=null;var sP=null;var RN="";var AQ=null;final  CQ=new AB.YM();final  JQ=new AB.YM();var MQ=true;static const  vJ=const DC<tD>(GB.jF); get sK=>q.vJ.forTarget(this); get x=>tM; get y=>xM; get vC=>xO; get wC=>BP; get VC=>DP; get WC=>IP; get skewX=>KP; get skewY=>NP; get wB=>QP; get visible=>XP; get alpha=>TP; get tE=>sP; get name=>RN; get parent=>AQ; get CF{var g=this.ND;return (g!=null)?this.PC(g.rQ):null;} get ME{var g=this.CF;return (g!=null)?g.x:0.0;} get NE{var g=this.CF;return (g!=null)?g.y:0.0;} get root{var g=this;while (g.AQ!=null)g=g.AQ;return g;} get ND{var g=this.root;if(g is VD)return g;return null;}set x( g){tM=g.toDouble();MQ=true;}set y( g){xM=g.toDouble();MQ=true;}set vC( g){xO=g.toDouble();MQ=true;}set wC( g){BP=g.toDouble();MQ=true;}set VC( g){DP=g.toDouble();MQ=true;}set WC( g){IP=g.toDouble();MQ=true;}set skewX( g){KP=g.toDouble();MQ=true;}set skewY( g){NP=g.toDouble();MQ=true;}set wB( g){QP=g.toDouble();MQ=true;}set visible( g){XP=g;}set alpha( g){TP=g.toDouble();}set mask( g){cP=g;}set tE( g){sP=g;} setTransform( h, g,[ scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY]){MQ=true;tM=h.toDouble();xM=g.toDouble();if(scaleX!=null){DP=scaleX.toDouble();if(scaleY!=null){IP=scaleY.toDouble();if(rotation!=null){QP=rotation.toDouble();if(skewX!=null){KP=skewX.toDouble();if(skewY!=null){NP=skewY.toDouble();if(pivotX!=null){xO=pivotX.toDouble();if(pivotY!=null)BP=pivotY.toDouble();}}}}}}} get width=>aB(KQ).width; get height=>aB(KQ).height; set width( h){this.VC=1;var g=this.width;this.VC=(g!=0.0)?h/g:1.0;} set height( h){this.WC=1;var g=this.height;this.WC=(g!=0.0)?h/g:1.0;} LK( g){g.DB(this);} OL(){if(AQ!=null)AQ.vB(this);} get KQ{if(MQ){MQ=false;var j=KP+QP;var i=NP+QP;if(j==0.0&&i==0.0){JQ.GF(DP,0.0,0.0,IP,tM-xO*DP,xM-BP*IP);}else{var g,l,k,h;var m=XB.cos(j);var o=XB.sin(j);if(j==i){g=DP*m;l=DP*o;k=-IP*o;h=IP*m;}else{g=DP*XB.cos(i);l=DP*XB.sin(i);k=-IP*o;h=IP*m;}var w=tM-(xO*g+BP*k);var t=xM-(xO*l+BP*h);JQ.GF(g,l,k,h,w,t);}}return JQ;} UG( h){if(h==AQ)return KQ.clone();if(h.AQ==this)return h.KQ.UH();var j=new AB.YM();var g=this;while (g!=h&&g.AQ!=null){j.concat(g.KQ);g=g.AQ;}if(h==null&&g!=null){j.concat(g.KQ);g=null;}if(g==h)return j;var k=new AB.YM();var i=h;while (i!=this&&i.AQ!=null){k.concat(i.KQ);i=i.AQ;}k.jH();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} aB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new CB.WM();returnRectangle.x=g.gB;returnRectangle.y=g.hB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} SB( g, h){if(aB(hF).contains(g,h))return this;return null;} nH( h){CQ.iH();for(q g=this;g!=null;g=g.AQ)CQ.concat(g.KQ);return CQ.SE(h);} PC( h){CQ.iH();for(q g=this;g!=null;g=g.AQ)CQ.concat(g.KQ);CQ.jH();return CQ.SE(h);} dispatchEvent( h){var g=null;if(h.sE||h.bubbles){for(q j=AQ;j!=null;j=j.AQ){if(j.QQ(h.type,h.sE,h.bubbles)){if(g==null)g=jE.AI() as List<q>;g.add(j);}}}if(h.sE&&g!=null){for(int i=g.length-1;i>=0&&h.JF==false;i-- ){g[i].lP(h,this,g[i],AD.pG);}}if(h.JF==false){lP(h,this,this,AD.lE);}if(h.bubbles&&g!=null){for(int i=0;i<g.length&&h.JF==false;i++ ){g[i].lP(h,this,g[i],AD.zI);}}if(g!=null){g.clear();jE.BI(g);}} dQ( h){for(var g=h;g!=null;g=g.AQ)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");AQ=h;} EB( g);}class LC{static const  LJ="B";static const  PJ="BL";static const  UJ="BR";static const  zG="L";static const  mE="R";static const  WJ="T";static const  YJ="TL";static const  bJ="TR";static const  JH="";}class fB{final  hO;var aN=0.0;var oO=0.0;var tO;var CP;fB.ZM( i,[ matrix]):hO=i{CP=null;for(int h=0;h<100;h++ ){CP=new wD(CP);}tO=CP;if(matrix!=null){tO.matrix.uE(matrix);}var g=tO.matrix;hO.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);hO.globalAlpha=1.0;hO.globalCompositeOperation=fF.iF;} get context=>hO; get currentTime=>aN; reset([ matrix, currentTime, deltaTime]){aN=?currentTime?currentTime:0.0;oO=?deltaTime?deltaTime:0.0;tO=CP;if(matrix!=null){tO.matrix.uE(matrix);}var g=tO.matrix;hO.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);hO.globalAlpha=1.0;hO.globalCompositeOperation=fF.iF;hO.clearRect(0,0,hO.canvas.width,hO.canvas.height);} DI( h){var g=h.KQ;var WB=h.TP;var j=h.cP;var k=h.rP;var o=h.sP;var OB=h.gP;var l=tO as wD;var i=tO.next as wD;tO=i;var w=i.matrix;var t=l.alpha*WB;var HB=(o!=null)?o:l.tE;w.wF(g,l.matrix);i.alpha=t;i.tE=HB;if(j!=null||k!=null){hO.save();if(j!=null){if(j.xC==null){g=i.matrix;}else if(identical(j.xC,h)){g=i.matrix;}else if(identical(j.xC,h.parent)){g=l.matrix;}else{g=j.xC.UG(h);if(g==null)g=hF;else g.concat(i.matrix);}j.EB(this,g);}if(k!=null){if(k.xC==null){g=i.matrix;}else if(identical(k.xC,h)){g=i.matrix;}else if(identical(k.xC,h.parent)){g=l.matrix;}else{g=k.xC.UG(h);if(g==null)g=hF;else g.concat(i.matrix);}k.EB(this,g);}}var m=w;hO.setTransform(m.a,m.b,m.c,m.d,m.gB,m.hB);hO.globalCompositeOperation=HB;hO.globalAlpha=t;if(OB!=null){OB.EB(this);}else{h.EB(this);}if(j!=null||k!=null){hO.restore();}tO=l;}} lF( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class IH{var fontStyle;var CE=0;var xE=0;var height=0;IH( j){this.fontStyle=j;var h=new PB.Element.tag("span");h.style.font=this.fontStyle;h.text="Hg";var g=new PB.Element.tag("div");g.style.display="inline-block";g.style.width="1px";g.style.height="0px";var i=new PB.Element.tag("div");i.append(g);i.append(h);PB.document.body.append(i);try {g.style.verticalAlign="baseline";this.CE=g.offsetTop-h.offsetTop;g.style.verticalAlign="bottom";this.height=g.offsetTop-h.offsetTop;this.xE=height-CE;}catch (k){}finally {i.remove();}}}class qC{var matrix;var JD=double.INFINITY;var KD=double.NEGATIVE_INFINITY;var LD=double.INFINITY;var ID=double.NEGATIVE_INFINITY;var YD=double.INFINITY;var ZD=double.NEGATIVE_INFINITY;var aD=double.INFINITY;var XD=double.NEGATIVE_INFINITY;var GE=double.NAN;var HE=double.NAN;qC(this.matrix); get CG=>!GE.isNaN&&!HE.isNaN; get hH=>!JD.isInfinite&&!KD.isInfinite&&!LD.isInfinite&&!ID.isInfinite; get jK=>!YD.isInfinite&&!ZD.isInfinite&&!aD.isInfinite&&!XD.isInfinite;SL(){GE=HE=double.NAN;JD=LD=double.INFINITY;KD=ID=double.NEGATIVE_INFINITY;}lD( h, g){GE=h;HE=g;}zC( h, g,[ transformed=false]){if(CG){h=h.toDouble();g=g.toDouble();var i=transformed?h:h*matrix.a+g*matrix.c+matrix.gB;var j=transformed?g:h*matrix.b+g*matrix.d+matrix.hB;if(JD>i)JD=i;if(KD<i)KD=i;if(LD>j)LD=j;if(ID<j)ID=j;}}stroke( l){if(hH){var g=XB.sqrt(matrix.fC)*l/2;var h=JD-g;var i=KD+g;var j=LD-g;var k=ID+g;if(YD>h)YD=h;if(ZD<i)ZD=i;if(aD>j)aD=j;if(XD<k)XD=k;}}fill(){if(hH){if(YD>JD)YD=JD;if(ZD<KD)ZD=KD;if(aD>LD)aD=LD;if(XD<ID)XD=ID;}} hK(){if(jK){var g=YD.floor();var i=ZD.ceil();var h=aD.floor();var j=XD.ceil();return new CB(g,h,i-g,j-h);}else{return new CB.WM();}}}class mF{static  nF( g){return g;}}class BE{static const  cF="auto";static const  iJ="stop";static const  LH="once";} lJ( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}class MH{var target=null;var dC=false;var uF=0;var EE=0;var qH,sH;var oH,pH;MH(this.qH,this.sH,this.oH,this.pH);}class tL extends gE{final  BQ;tL( i, g, h, j):BQ=new CB(i,g,h,j); EB( i, g){var h=i.context;h.setTransform(g.a,g.b,g.c,g.d,g.gB,g.hB);h.beginPath();h.rect(BQ.x,BQ.y,BQ.width,BQ.height);h.clip();}} rC( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class pB{final  OG;var RG=double.NAN;var SG=double.NAN;pB(this.OG); TG( g){this.SG=g.toDouble();} get lK=>!RG.isNaN&&!SG.isNaN; SQ( g){switch (OG){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.vC;case 'pivotY':return g.wC;case 'scaleX':return g.VC;case 'scaleY':return g.WC;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.wB;case 'alpha':return g.alpha;default:return 0.0;}} jQ( g, h){switch (OG){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.vC=h;break;case 'pivotY':g.wC=h;break;case 'scaleX':g.VC=h;break;case 'scaleY':g.WC=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.wB=h;break;case 'alpha':g.alpha=h;break;}}}class qJ{static var rJ=0;var KF=rJ++ ;var target=null;var FF=false;qJ(this.target,this.FF);}class VD extends nC{var eP;var hO;var ZQ,aQ;var ZP,aP;var cQ,eQ;var fQ;var hQ;var iQ;var wM;var HM=30;var lQ;var mQ;var nQ;var oQ;var pQ;var qQ;var rQ;var sQ;var tQ;var uQ;var vQ;var wQ;var xQ;VD( h, g){RN=h;eP=g;eP.focus();hO=g.context2D;ZP=ZQ=g.width;aP=aQ=g.height;cQ=g.clientWidth;eQ=g.clientHeight;fQ=new AB.YM();hQ=new AB.YM();iQ=null;wM=new vD();mQ=new fB.ZM(hO);nQ=BE.cF;oQ=xD.AH;pQ=LC.JH;tQ=[new MH(s.pC,s.AE,s.ED,s.xI),new MH(s.ZJ,s.eJ,s.HH,s.HH),new MH(s.jJ,s.nJ,s.KH,s.KH)];qQ=rB.eF;sQ=null;rQ=new FB(0,0);vQ=new s(s.ED,true);CD.VJ.listen(VJ);eP.onMouseDown.listen(yO);eP.onMouseUp.listen(yO);eP.onMouseMove.listen(yO);eP.onMouseOut.listen(yO);eP.onMouseWheel.listen(JR);uQ=new Map<int,qJ>();xQ=new TB(TB.qG,true);xG.hJ.listen(KR);KR(null);wQ=new KC(KC.dF,true);eP.onKeyDown.listen(LR);eP.onKeyUp.listen(LR);eP.onKeyPress.listen(MR);} get PG=>iQ; get FG=>wM; get CF=>rQ; get focus=>lQ; get align=>pQ;OR(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){OR();}set y( g){OR();}set vC( g){OR();}set wC( g){OR();}set VC( g){OR();}set WC( g){OR();}set skewX( g){OR();}set skewY( g){OR();}set wB( g){OR();}set alpha( g){OR();}set width( g){OR();}set height( g){OR();}mK( g, h){if(nQ==BE.cF||nQ==BE.LH){PR();mQ.reset(hQ,g,h);EB(mQ);if(nQ==BE.LH)nQ=BE.iJ;}}PR(){var m=eP.getBoundingClientRect();var o=eP.clientLeft+m.left;var t=eP.clientTop+m.top;var k=eP.clientWidth;var l=eP.clientHeight;if(k==0||l==0)return;var g=ZQ;var h=aQ;var i=0;var j=0;switch (oQ){case xD.mI:g=ZQ;h=aQ;break;case xD.vI:if(k*aQ>l*ZQ){h=(ZQ*l)~/k;}else{g=(aQ*k)~/l;}break;case xD.DJ:g=k;h=l;break;case xD.AH:if(k*aQ>l*ZQ){g=(aQ*k)~/l;}else{h=(ZQ*l)~/k;}break;}switch (pQ){case LC.LJ:i=(ZQ-g+1)~/2;j=(aQ-h);break;case LC.PJ:i=0;j=(aQ-h);break;case LC.UJ:i=(ZQ-g);j=(aQ-h);break;case LC.zG:i=0;j=(aQ-h+1)~/2;break;case LC.mE:i=(ZQ-g);j=(aQ-h+1)~/2;break;case LC.WJ:i=(ZQ-g+1)~/2;j=0;break;case LC.YJ:i=0;j=0;break;case LC.bJ:i=(ZQ-g+1);j=0;break;case LC.JH:i=(ZQ-g+1)~/2;j=(aQ-h+1)~/2;break;}hQ.GF(1.0,0.0,0.0,1.0,0-i,0-j);fQ.GF(g/k,0.0,0.0,h/l,i-o,j-t);if(ZP!=g||aP!=h){eP.width=ZP=g;eP.height=aP=h;}if(cQ!=k||eQ!=l){cQ=k;eQ=l;dispatchEvent(new GB(GB.SJ));}}VJ( g){eP.style.cursor=CD.NH(qQ);}yO( j){j.preventDefault();var o=new DateTime.now().millisecondsSinceEpoch;var w=j.button;var h=null;var i=fQ.gQ(j.client);var m=null;if(w<0||w>2)return;if(j.type=="mousemove"&&rQ.yF(i))return;var g=tQ[w];rQ=i;if(CD.vG!=null)CD.vG.OQ();if(j.type!="mouseout")h=SB(i.x,i.y) as JB;var l=rB.eF;if(h is aC&&(h as aC).XG){l=rB.gF;}if(h is sD&&(h as sD).XG){l=rB.gF;}if(qQ!=l){qQ=l;eP.style.cursor=CD.NH(l);}if(sQ!=null&&sQ!=h){sQ.dispatchEvent(vQ..bP(s.nE,true)..YQ=(sQ.ND!=null)?sQ.PC(i):new FB.WM()..bQ=i..PQ=g.dC);sQ=null;}if(h!=null&&h!=sQ){h.dispatchEvent(vQ..bP(s.DH,true)..YQ=h.PC(i)..bQ=i..PQ=g.dC);sQ=h;}var k=null;var t=false;var HB=false;if(j.type=="mousedown"){k=g.qH;if(h!=g.target||o>g.uF+500)g.EE=0;g.dC=true;g.target=h;g.uF=o;g.EE++ ;}if(j.type=="mouseup"){k=g.sH;g.dC=false;t=(g.target==h);HB=t&&g.EE.isEven&&(o<g.uF+500);}if(j.type=="mousemove"){k=s.kF;}if(k!=null&&h!=null){m=h.PC(i);h.dispatchEvent(vQ..bP(k,true)..YQ=m..bQ=i..PQ=g.dC..TQ=g.EE);if(t){if(HB&&h.WK){h.dispatchEvent(vQ..bP(g.pH,true)..YQ=m..bQ=i..PQ=g.dC);}else{h.dispatchEvent(vQ..bP(g.oH,true)..YQ=m..bQ=i..PQ=g.dC);}}}}JR( h){var g=fQ.gQ(h.client);var i=SB(g.x,g.y) as JB;if(i!=null){i.dispatchEvent(vQ..bP(s.EH,true)..YQ=i.PC(g)..bQ=g..UQ=h.deltaX..VQ=h.deltaY);if(vQ.JF)h.preventDefault();}}var aR=[] ;KR( h){aR.forEach((g)=>g.cancel());if(xG.pJ==kG.BJ){aR=[eP.onTouchStart.listen(bR),eP.onTouchEnd.listen(bR),eP.onTouchMove.listen(bR),eP.onTouchEnter.listen(bR),eP.onTouchLeave.listen(bR),eP.onTouchCancel.listen(bR)];}}bR( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=fQ.gQ(m.client);var h=SB(i.x,i.y) as JB;var g=uQ.containsKey(l)?uQ[l]:new qJ(h,uQ.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(xQ..bP(TB.RJ,true)..YQ=(g.target.ND!=null)?g.target.PC(i):new FB.WM()..bQ=i..nP=g.KF..qP=g.FF);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(xQ..bP(TB.NJ,true)..YQ=h.PC(i)..bQ=i..nP=g.KF..qP=g.FF);g.target=h;}var k=null;if(j.type=="touchstart"){uQ[l]=g;k=TB.qG;}if(j.type=="touchend"){uQ.remove(l);k=TB.uG;}if(j.type=="touchcancel"){uQ.remove(l);k=TB.wG;}if(j.type=="touchmove"){k=TB.CH;}if(k!=null&&h!=null){h.dispatchEvent(xQ..bP(k,true)..YQ=h.PC(i)..bQ=i..nP=g.KF..qP=g.FF);}}}LR( g){g.preventDefault();var h=null;if(g.type=="keyup")h=KC.tG;if(g.type=="keydown")h=KC.dF;wQ..bP(h,true)..rO=g.altKey..sO=g.ctrlKey..wO=g.shiftKey..LP=g.charCode..PP=g.keyCode..RP=RD.lI;if(g.keyLocation==PB.KeyLocation.LEFT)wQ.RP=RD.zG;if(g.keyLocation==PB.KeyLocation.RIGHT)wQ.RP=RD.mE;if(g.keyLocation==PB.KeyLocation.NUMPAD)wQ.RP=RD.CJ;if(g.keyLocation==PB.KeyLocation.JOYSTICK)wQ.RP=RD.yG;if(g.keyLocation==PB.KeyLocation.MOBILE)wQ.RP=RD.yG;if(lQ!=null)lQ.dispatchEvent(wQ);}MR( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new mG(mG.wI,true);h.NN=new String.fromCharCodes([i]);if(lQ!=null)lQ.dispatchEvent(h);}} OH( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);} wJ( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} xJ(){var g=new PB.CanvasElement(width:1,height:1);g.context2D.fillStyle="#000000";g.context2D.fillRect(0,0,1,1);var i=g.context2D.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} yJ(){var i=new dB.Completer<bool>();var g=new PB.ImageElement(); h(){i.complete(g.width==2&&g.height==2);}g.onLoad.listen((j)=>h());g.onError.listen((j)=>h());g.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";return i.future;}class pE implements oC{final  yQ;final  AR;final  BR=new List<pB>();var CR;var DR;var ER;var FR;var mN;var aN;var GR;var HR;var IR;pE( g, h,[ transitionFunction]):yQ=g,AR=(?transitionFunction)?transitionFunction:mF.nF{FR=new nG(this);aN=0.0;mN=XB.max(0.0001,h);GR=0.0;HR=false;IR=false;} get QH=>FR; FO( g){if(yQ!=null&&IR==false){BR.add(g);}} FD( m){if(aN<mN||IR==false){aN=aN+m;if(aN>mN){aN=mN;}if(aN>=0.0){if(IR==false){IR=true;for(int h=0;h<BR.length;h++ ){var g=BR[h];g.RG=g.SQ(yQ);}if(CR!=null){CR();}}var k=aN/mN;var l=AR(k).toDouble();for(int h=0;h<BR.length;h++ ){var g=BR[h];if(g.lK){var i=g.RG.toDouble();var o=g.SG.toDouble();var j=i+l*(o-i);g.jQ(yQ,HR?j.round():j);}}if(DR!=null){DR();}if(ER!=null&&aN==mN){ER();}}}return aN<mN;} get currentTime=>aN;}class uL extends JC{uL();EB( g){g.beginPath();}yC( g){g.SL();}}class vL extends JC{vL();EB( g){g.closePath();}}class wL extends JC{var tM,xM;wL( h, g){tM=h.toDouble();xM=g.toDouble();}EB( g){g.moveTo(tM,xM);}yC( g){g.lD(tM,xM);}}var CK=xJ();var DK=yJ();class xL extends JC{var tM,xM;xL( h, g){tM=h.toDouble();xM=g.toDouble();}EB( g){g.lineTo(tM,xM);}yC( g){if(g.CG==false){g.lD(tM,xM);}g.zC(g.GE,g.HE);g.zC(tM,xM);g.lD(tM,xM);}} oF( g, m, o, j){m=m.toDouble();o=o.toDouble();var YC=0.0;var qB=0.0;var HB=m*g.a;var iB=m*g.b;var OB=m*g.a+o*g.c;var w=m*g.b+o*g.d;var WB=o*g.c;var t=o*g.d;var h=YC;if(h>HB)h=HB;if(h>OB)h=OB;if(h>WB)h=WB;var i=qB;if(i>iB)i=iB;if(i>w)i=w;if(i>t)i=t;var l=YC;if(l<HB)l=HB;if(l<OB)l=OB;if(l<WB)l=WB;var k=qB;if(k<iB)k=iB;if(k<w)k=w;if(k<t)k=t;if(j==null)j=new CB.WM();j.x=g.gB+h;j.y=g.hB+i;j.width=l-h;j.height=k-i;return j;}class yL extends JC{var tM,xM,SR;var TR,UR;var VR;yL( l, g, j, i, h, k){tM=l.toDouble();xM=g.toDouble();SR=j.toDouble();TR=i.toDouble();UR=h.toDouble();VR=k;}EB( g){g.arc(tM,xM,SR,TR,UR,VR);}yC( g){var j=new lB(SR,0);var t=j.rotate(TR);var m=j.rotate(UR);if(g.CG==false){g.lD(tM+t.x,xM+t.y);}var h=TR;var i=UR;if(VR){if(h<i)h=h+2*XB.PI;}else{if(i<h)i=i+2*XB.PI;}var w=i-h;var l=(w*30).abs()~/XB.PI+1;g.zC(g.GE,g.HE);for(var k=0;k<=l;k++ ){var o=j.rotate(h+k*w/l);g.zC(tM+o.x,xM+o.y);}g.lD(tM+m.x,xM+m.y);}}class zL extends JC{var tM,xM;var EN,SN;zL( i, g, h, j){tM=i.toDouble();xM=g.toDouble();EN=h.toDouble();SN=j.toDouble();}EB( g){g.rect(tM,xM,EN,SN);}yC( g){g.lD(tM,xM);g.zC(tM,xM);g.zC(tM+EN,xM);g.zC(tM+EN,xM+SN);g.zC(tM,xM+SN);}}abstract class GK extends JC{var WR;var XR;var YR;GK( h, i, g){WR=h.toDouble();XR=i;YR=g;} SB( g, h, i){g.lineWidth=WR;g.lineJoin=XR;g.lineCap=YR;try {return g.isPointInStroke(h,i);}catch (j){return false;}}yC( g){g.stroke(WR);}}class AM extends GK{var ZR;AM( g, i, j, h):super(i,j,h){ZR=g;}EB( g){g.strokeStyle=ZR;g.lineWidth=WR;g.lineJoin=XR;g.lineCap=YR;g.stroke();}}abstract class HK extends JC{ SB( g, h, i){return g.isPointInPath(h,i);}yC( g){g.fill();}}class BM extends HK{var ZR;BM( g){ZR=g;}EB( g){g.fillStyle=ZR;g.fill();}}//@ sourceMappingURL=supersonic.dart.map
