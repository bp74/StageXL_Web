import "dart:math" as bB;import "dart:async" as aB;import "dart:json" as XM;import "dart:web_audio" as rG;import "dart:html" as SB;class YM{static const  ZM="Chrome";static const  aM="Firefox";static const  bM="Internet Explorer";static const  cM="Safari";final  sK;final  minimumVersion;const YM(this.sK,[this.minimumVersion]);}class dM{const dM();}class eM{final  name;const eM(this.name);}class fM{const fM();}class gM{const gM();}class AJ extends bF{var LD;var oC;var KC;var JC;var YC;var WC;var XC;var font;var oG=30;var WF;AJ( h,[ i=lE]):super(h){this.font=i;this.MD();var g=new StringBuffer();g.write((this.CB as DC).nB("GENlevel"));g.write(": 0");JC.text=g.toString();} MD(){this.LD=new sB(o.QB("items").LB("topbar"));this.LD.x=0;this.LD.y=0;this.HB(this.LD);this.oC=new NC();this.oC.RC=new qE(font,24,0,bold:true,align:wB.RH);this.oC.TD=0x000000;this.oC.width=400;this.oC.height=100;this.oC.x=20;this.oC.y=oG;this.HB(oC);this.KC=new NC();this.KC.RC=new qE(font,24,0,bold:true,align:wB.xE);this.KC.TD=0x000000;this.KC.width=200;this.KC.height=100;this.KC.x=(this.CB.NF/2)-this.KC.width+60;this.KC.y=oG;this.HB(KC);this.JC=new NC();this.JC.RC=new qE(font,24,0,bold:true,align:wB.xE);this.JC.TD=0x000000;this.JC.width=200;this.JC.height=100;this.JC.x=(this.CB.NF)-(this.JC.width)-20;this.JC.y=oG;this.HB(JC);this.YC=new NC();this.YC.RC=new qE(font,24,0,bold:true,align:wB.tE);this.YC.TD=0x000000;this.YC.width=200;this.YC.height=100;this.YC.x=20;this.YC.y=this.CB.DI-this.YC.height-20;this.HB(YC);this.YC.visible=false;this.WC=new sB(o.QB("items").LB("progressbar"));this.WC.x=25;this.WC.y=82;this.HB(this.WC);this.XC=new sB(o.QB("items").LB("progressship"));this.XC.x=25;this.XC.y=this.WC.y+(this.WC.height-(this.WC.height-this.XC.height))-(this.XC.height);this.HB(this.XC);this.WF=new List<sB>();for(var h=0;h<3;h++ ){var g=new sB(o.QB("items").LB("spaceship"));g.y=10;g.x=(this.CB.NF/2)+70+(h*35);this.HB(g);this.WF.add(g);}} aI( g){this.XC.x=25;this.XC.y=this.WC.y+(this.WC.height-((this.WC.height-this.XC.height)*g.CB.YE))-(this.XC.height);} ZI( i){var h=i.CB as DC;if(h.qD){this.KC.text=h.nB("DISPLAY_TRAINING");}else{this.KC.text=h.nB("DISPLAY_LIVES");}for(var g=0;g<this.WF.length;g++ ){this.WF[g].visible=(!h.qD)&&(g<i.CB.nD);}} cI( h){var i=h.CB as DC;var g=new StringBuffer();g.write(i.nB("GENscore"));g.write(": ${h.CB.GM.toString()}");oC.text=g.toString();} SF( h){var i=h.CB as DC;var g=new StringBuffer();g.write(i.nB("GENlevel"));g.write(": ${h.CB.oB.toString()}");JC.text=g.toString();}}class dC extends gC{var UN;var YN;var aN;var position;var lC=-1;var LC=0;var JM=1;var zC=false;var LI=false;var SE=false;var DN=false;var NE=0;var pD=0;var XE=0;dC( g){aN=new gC();HB(aN);this.LE=g;if(this.LE==null)return;this.x=100000;}set LE( g){if(UN!=null)this.AC(UN);if(YN!=null)this.AC(YN);UN=null;YN=null;if(g!=null){UN=g;UN.AD=UD.VD/2;UN.BD=UD.VD/2;HB(UN);}else{YN=new BH();HB(YN);}HB(aN);} get LE{return UN;} setScale( g){this.JM=g;if(YN!=null){YN.UB.clear();YN.UB.beginPath();YN.UB.uH(0,0,UD.VD/2*g);YN.UB.closePath();YN.UB.nI(0xff999999,1);}if(UN!=null)UN.ZC=UN.aC=g;aN.ZC=aN.aC=g;} OF( j){if(UN==null)return false;var g=this.OI(j);g=UN.TC(g);var k=this.LE.KG.QL(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new sB(o.QB("items").LB("blood"));h.AD=50;h.BD=50;h.x=g.x-UD.VD/2;h.y=g.y-UD.VD/2;aN.HB(h);}return i;}}class yI extends gC{var VC;yI(){VC=new List<dC>();} KM(){this.VC.sort(RM);} cD( g){if(this.contains(g))return;this.HB(g);this.VC.add(g);} BM( g){if(this.VC.length>0){var h=this.VC.indexOf(g);if(h>=0)this.VC.removeAt(h);}if(this.contains(g))this.AC(g);} RM( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.lD(g)<this.lD(h))this.oI(g,h);return 1;}if(g.position.z<h.position.z){if(this.lD(g)>this.lD(h))this.oI(g,h);return -1;}return 0;}}class s extends DB{static const  vD="GameEvent.TYPE_LIVES_CHANGED";static const  dE="GameEvent.TYPE_PROGRESS_CHANGED";static const  eE="GameEvent.TYPE_PAUSE_CHANGED";static const  fE="GameEvent.TYPE_LEVEL_CHANGED";static const  gE="GameEvent.TYPE_SCORE_CHANGED";static const  hE="GameEvent.TYPE_GAME_START";static const  iE="GameEvent.TYPE_GAME_OVER";static const  jE="GameEvent.TYPE_GAME_ABORT";static const  fF="GameEvent.TYPE_GAME_SIZE_CHANGED";var CB;s( h, g,[ i=false]):super(h,i){this.CB=g;}}class UD extends bF{static var tG=0.025;static var cF=1.0;static var VD=600;static var dF=800;static var eF=600;static var wG=400;static var xG=300;static var xD=bB.sqrt(dF*dF+eF*eF);static var IJ=(xD*2/VD);static var yG=6;var TB;var YB;var UC;var nC;var fG=30.0*bB.PI/180;var eG=1.0*bB.PI/180;var sD=0.05;var cG=-1;var TF=1;var RB;var xC;var HG=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var IG;var JG;var wH;var xK;var pI;var dG=15;var NI;var jD=false;var LF=0;var RG;var FF;var EG=0.90;var kI=0;var iN;var vM;var gB;var ML=0;var QC;var hD=false;var UE,VE;var HI;var WE;UD( g):super(g){iN=new sE.NN(80,60,690,524);this.mask=iN;this.IG=o.TG("speedalizer");this.JG=this.IG.play(true);this.gB=new BH();this.HB(this.gB);HI=new PJ(800,600);HB(HI);UE=VE=0;MC.BB(u.wF,this.bG);MC.BB(u.tC,this.bG);MC.BB(u.HE,this.bG);WE=this.dL.listen(this.jN);} bG( g){UE=g.lI;VE=g.mI;} vL(){var g=this.CB.oD;this.CB.oD=g+(this.CB as DC).jI*(this.CB.oB*this.CB.nD);} YI( g){} SF( g){super.SF(g);this.MM();} MM(){hD=false;WE.pause();this.LF=0;this.CB.YE=0;this.jD=false;var h=60;this.nC=new DJ(xD,yG*h);for(var g=this.nC.GB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.nC.hI(g);this.TB=new EC(wG,xG);this.YB=new qC(0,0,0);this.UC=new qC(0,0,cF);this.eG=(1+(0.1*this.CB.oB))*bB.PI/180;this.sD=0.015+(0.004*this.CB.oB);this.TF=2+this.CB.oB;this.cG=-this.TF;this.kI=this.CB.oB*2;this.dG=15+(this.CB.oB);this.MD();this.AL();WE.resume();} MD(){if(this.RB!=null)this.AC(this.RB);this.RB=new yI();this.HB(this.RB);if(this.QC!=null)this.AC(this.QC);this.QC=new sB(o.QB("items").LB("crosshair"));this.QC.ZC=0.5;this.QC.aC=0.5;this.QC.x=(dF/2)-this.QC.width/2;this.QC.y=(eF/2)-this.QC.height/2;this.HB(this.QC);} SG(){this.hD=false;this.WE.pause();var h=60;this.nC=new DJ(xD,yG*h);for(var g=this.nC.GB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.nC.hI(g);this.TB=new EC(wG,xG);this.YB=new qC(0,0,0);this.UC=new qC(0,0,cF);this.eG=2*bB.PI/180;this.TF=0;this.cG=0;if(this.RB!=null){this.AC(this.RB);this.RB=null;}this.RB=new yI();this.HB(this.RB);if(this.xC!=null){this.AC(this.xC);this.xC=null;}this.yH();this.WE.resume();} yH(){var g=new dC(null);g.lC=-1;g.LC=0;g.position=this.YB.clone();g.position.z=0.5;this.RB.cD(g);} xH(){var g=new dC(new sB(o.QB("items").LB("countdown01")));g.lC=0;g.LC=0;g.position=this.YB.clone();g.position.z=0.5;g.NE=0;g.SE=true;this.RB.cD(g);g=new dC(new sB(o.QB("items").LB("countdown02")));g.lC=0;g.LC=0;g.position=this.YB.clone();g.position.z=0;g.NE=1;g.SE=true;this.RB.cD(g);g=new dC(new sB(o.QB("items").LB("countdown03")));g.lC=0;g.LC=0;g.position=this.YB.clone();g.position.z=-0.5;g.NE=2;g.SE=true;this.RB.cD(g);g=new dC(new sB(o.QB("items").LB("countdown04")));g.lC=0;g.LC=0;g.position=this.YB.clone();g.position.z=-1;g.NE=3;g.SE=true;this.RB.cD(g);} BL(){var h=1+this.CB.oB;if(h>=this.HG.length)h=this.HG.length-1;var i=uD.uG(0,h);var j=this.HG[i];var g=new dC(new sB(o.LB(j)));g.zC=true;g.BC=uD.uG(0,359)*bB.PI/180;g.LC=uD.HJ(this.cG,this.TF)*bB.PI/180;g.position=this.YB.clone();return g;} AL(){this.xH();this.yH();var h=0;for(var i=0;i<dG;i++ ){var g=null;if(i==dG-1){g=new dC(new sB(o.LB("finish")));g.BC=0;g.LC=5*bB.PI/180;g.position=this.YB.clone();g.lC=0;g.zC=true;g.LI=true;this.RG=g;}else{h++ ;if(this.CB.oB==1&&h<=3){if(h==1){g=new dC(new sB(o.LB("training01")));g.zC=true;g.BC=0;g.LC=0;g.position=this.YB.clone();g.pD=1;}else if(h==2){g=new dC(new sB(o.LB("training02")));g.zC=true;g.BC=135*bB.PI/180;g.LC=0;g.position=this.YB.clone();g.pD=2;}else if(h==3){g=new dC(new sB(o.LB("training02")));g.zC=true;g.BC=315*bB.PI/180;g.LC=0;g.position=this.YB.clone();g.pD=3;}}else{g=this.BL();}}g.XE=-i*1-3;g.position.z=g.XE;g.lC=0;this.RB.cD(g);}} hL(){this.jD=false;var g=CB as DC;g.JL();g.zH();} jN( h){if(this.CB.paused==false){this.yL();var g=this.CB as DC;if(g.qD&&this.hD&&!g.QF)g.nL();}else{TE=-1;}} OF( h){var g=new IB(this.TB.x,this.TB.y);g=this.OI(g);g=h.TC(g);return h.OF(g);} wK(){this.hD=false;for(var g=0;g<this.RB.VC.length;g++ )this.RB.VC[g].position.z-= (2.5+1-EG)+1;FF.position.z+= (1-EG);this.xH();this.jD=false;this.sD=this.NI;this.xC.visible=false;} cL(){var g=this.CB as DC;g.zB.visible=false;this.jD=false;this.hD=false;this.NI=this.sD;this.sD=0;if(this.xC!=null)this.AC(this.xC);this.xC=new sB(o.LB("broken"));this.HB(this.xC);if(this.FF.pD>0&& ++this.ML<=5){iB.MF((){g.yK(this.FF.pD);},2.0);}else{this.CB.nD-- ;if(this.CB.nD>0)iB.MF(g.CL,2.0);}this.JG.stop();this.JG=this.IG.play(true);this.wH=o.TG("crash");this.xK=this.wH.play();}var TE=-1; yL(){var k=iB.elapsedTime;var h=1.0;if(TE==-1)TE=k;h=bB.min(k-TE,1.0000)*40;TE=k;if(jD){this.LF-= (this.sD*h);var n=this.CB.oD;this.CB.oD=n+(this.kI*h);}this.RB.KM();this.fG+= (this.eG*h);this.UC.x=-(this.UE-this.TB.x)*3;this.UC.y=-(this.VE-this.TB.y)*3;if(this.UC.GI()>xD*0.7){this.UC.HM(xD*0.7);}this.UC.z=cF;this.YB=this.UC.clone();this.YB.z=tG;this.xL();for(var m=0;m<this.RB.VC.length;m++ ){var g=this.RB.VC[m];g.position.z+= (sD*h);if(g.position.z>=1){if(g.SE&&g.NE==3)hD=true;if(g.LE!=null){this.pI=o.TG("swish");var q=this.pI.play();}if(g.zC)jD=true;if(g.XE!=0)this.LF=g.XE;if(g.zC&&OF(g)){g.position.z=EG;FF=g;this.cL();}else{if(g.pD==3)(this.CB as DC).qD=false;if(g.zC)this.vL();if(g.LI){this.hL();}else if(g.lC==0){this.RB.BM(g);}else{g.position.z+= g.lC;}}}var i=this.UC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.aF(i);j=j.add(this.TB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.BC+= (g.LC*h);g.setScale(tD(g.position.z)*IJ);}}if(this.RG!=null)this.CB.YE=(this.LF+3)/(this.RG.XE+3);} aF( g){var h=new EC(g.x,g.y);h.x*= tD(g.z);h.y*= tD(g.z);return h;} tD( g){var h=tG;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} xL(){if(gB==null)return;var l=2;var j=this.UC.clone();j.scale(l);var h=this.nC.transform(tD(j.z)*l,this.fG,this.aF(j));var i=this.nC.transform(tD(this.YB.z),this.fG,this.aF(this.YB));var k=this.aF(this.YB).add(this.TB);gB.UB.clear();gB.UB.beginPath();gB.UB.uH(k.x,k.y,this.nC.uL*tD(this.YB.z));gB.UB.closePath();gB.UB.nI(0xffcccccc,1);gB.UB.beginPath();for(var g=0;g<h.GB.length;g+= 2){gB.UB.moveTo(h.GB[g].x+this.TB.x,h.GB[g].y+this.TB.y);gB.UB.lineTo(h.GB[g+1].x+this.TB.x,h.GB[g+1].y+this.TB.y);gB.UB.lineTo(i.GB[g+1].x+this.TB.x,i.GB[g+1].y+this.TB.y);gB.UB.lineTo(i.GB[g].x+this.TB.x,i.GB[g].y+this.TB.y);gB.UB.lineTo(h.GB[g].x+this.TB.x,h.GB[g].y+this.TB.y);}gB.UB.closePath();gB.UB.HL(0xFF000000);}}class DC extends FC{static const  vG=1.0;static const  EJ=100;static const  FJ=0xFFFFFF;var LM=vG;var NL=5;var kD;var MI=false;var jI=500;var rK=0xffffff;var zB;var NB;var mD;var hN=true;var QF=false;var EI=60.0;var RE;var SC=lE;var VG=false;var tL="Web";DC( h, g):super(h,g){this.BB(DB.LH,(i){this.UL();});}set qD( g){hN=g;this.dispatchEvent(new s(s.vD,this));} get qD{return hN;} UL(){if(!MI){this.BB(u.HE,(g)=>this.QF=false);this.BB(u.tC,(g)=>this.QF=true);this.wL();this.BB(s.hE,this.aG);this.BB(s.vD,this.iL);this.BB(s.dE,this.lL);this.BB(s.gE,this.mL);this.BB(s.fE,this.gL);this.BB(s.eE,this.jL);this.BB(s.iE,this.ZG);this.BB(s.jE,this.YG);this.MD();this.YE=0;this.oD=0;this.nD=3;this.start();MI=true;}} nB( j,[ h=null]){var i=o.SL(j);if(h!=null)for(int g=0;g<h.length;g++ )i=i.replaceAll("{${g}}",h[g].toString());return i;} wL(){this.LM=vG;this.rK=FJ;this.jI=EJ;this.NL=5;this.EI=60000;} MD(){this.kD=new UD(this);this.HB(this.kD);var h=o.QB("items").LB("button_exit");var g=o.QB("items").LB("button_exit_2");this.zB=new yD(new sB(h),new sB(g),new sB(h),new sB(g));this.zB.width=75;this.zB.height=66;this.zB.x=707;this.zB.y=525;this.zB.BB(u.tC,eL);this.HB(this.zB);this.zB.visible=false;this.mD=new AJ(this,SC);this.mD.x=0;this.mD.y=0;this.HB(this.mD);} CL(){var g=this.iD();g.text=this.nB("MESSAGE_RESTART_LEVEL");g.BB(PB.GC,this.bI);} yK( h){var g=this.iD();g.text=this.nB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.BB(PB.GC,this.bI);} bI( g){this.SD(g.PF);this.kD.wK();} zH(){this.kD.SG();var g=this.iD();if(this.oB==0){g.text=this.nB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.nB("MESSAGE_START_LEVEL",[(this.oB+1)]);}g.BB(PB.GC,this.oL);} oL( g){this.SD(g.PF);this.ZL();} zK(){var g=this.iD();g.text=this.nB("MESSAGE_GAME_OVER");g.BB(PB.GC,this.fL);} fL( g){this.SD(g.PF);} iD([ g=null, j=1.0, i=true]){if(this.NB!=null)this.SD(this.NB);this.zB.visible=false;this.mD.visible=true;if(g==null)this.NB=new dB(this,i,SC);else this.NB=g;this.NB.width=dB.bE;this.NB.height=dB.wD;this.NB.x=(this.NF/2)-(dB.bE/2)+30;this.NB.y=(this.DI/2)-(dB.wD/2);this.NB.alpha=0;this.HB(this.NB);var h=new BF(this.NB,j,xF.zF);h.rH.alpha.lG(1);iB.add(h);return this.NB;} SD( g){this.paused=false;this.mD.visible=true;this.zB.visible=true;if(g==null)return;g.QE();if(this.contains(g)){this.AC(g);}this.NB=null;} PL(){iB.remove(RE);if(this.VG)this.dI(null);this.QF=true;this.qD=false;} nL(){if(this.NB!=null)return;if(tL.toLowerCase()=="web")return;iB.remove(RE);this.RE=new kF(this.PL,this.EI);iB.add(this.RE);this.VG=true;this.paused=true;var g=this.iD(null,200,false);this.zB.visible=true;g.text=this.nB("MESSAGE_FIRST_LEVEL");g.BB(PB.GC,this.dI);} dI( g){iB.remove(this.RE);this.VG=false;this.NB.fB(PB.GC);this.SD(this.NB);} eL( h){if(this.NB is zI)return;var g=new zI(this,SC);this.iD(g);this.paused=true;g.BB(PB.GC,this.bL);g.BB(PB.cE,this.aL);} bL( g){this.dispatchEvent(new s(s.jE,this));this.NB.fB(PB.GC);this.NB.fB(PB.cE);this.SD(this.NB);this.paused=true;} aL( g){this.NB.fB(PB.GC);this.NB.fB(PB.cE);this.SD(NB);} aG( g){this.kD.SG();iB.MF(this.zH,0.5);} JL(){this.kD.SG();} lL( g){} iL( g){} mL( g){} gL( g){} jL( g){} ZG( g){iB.MF(this.zK,2.0);} YG( g){}}class uD{static var sG=new bB.Random();static  uG( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=uD.sG.nextInt(h+1)+g;}return i;}static  HJ( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=uD.sG.nextDouble()*(h-g)+g;}return i;}}class bF extends gC{var WN;bF( g){this.CB=g;}set CB( g){if(WN!=null){WN.fB(s.iE);WN.fB(s.jE);WN.fB(s.fF);WN.fB(s.hE);WN.fB(s.fE);WN.fB(s.eE);WN.fB(s.gE);WN.fB(s.vD);WN.fB(s.dE);}WN=g;if(WN!=null){WN.BB(s.iE,this.ZG);WN.BB(s.jE,this.YG);WN.BB(s.fF,this.YI);WN.BB(s.hE,this.aG);WN.BB(s.fE,this.SF);WN.BB(s.eE,this.kL);WN.BB(s.gE,this.cI);WN.BB(s.vD,this.ZI);WN.BB(s.dE,this.aI);}} get CB{return WN;} ZG( g){} YG( g){} YI( g){} aG( g){} SF( g){} kL( g){} cI( g){} ZI( g){} aI( g){}}class qC{var x;var y;var z;qC(this.x,this.y,this.z);reset( h, i, g){x=h;y=i;z=g;} clone(){return new qC(x,y,z);} GI(){return bB.sqrt(x*x+y*y+z*z);}HM( g){this.normalize();this.scale(g);} add( g){return new qC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=GI();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} PG( g){return (g.x==x&&g.y==y&&g.z==z);}}class EC{var x;var y;EC(this.x,this.y);set length( g){this.normalize();this.XL(g);} get length{return bB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new EC(x,y);} add( g){if(g==null)return null;return new EC(x+g.x,y+g.y);} subtract( g){if(g==null)return null;return new EC(x-g.x,y-g.y);}XL( g){x*= g;y*= g;} get GF{var g=bB.PI-bB.atan2(this.x,this.y);if(g<0)g+= 2*bB.PI;return g;}set GF( i){var h=this.length;var g=IB.KK(h,i-bB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class dB extends bF implements hC{static var bE=588;static var wD=314;static var GJ=10.0;var LD;var CC;var gN;var iG;var SC;dB( i,[ h=true, g=lE]):super(i){this.SC=g;this.width=dB.bE;this.height=dB.wD;this.LD=new sB(o.QB("items").LB("menu_bg"));this.HB(this.LD);this.CC=new NC();this.CC.TD=0x000000;this.CC.wordWrap=true;this.CC.RC=new qE(g,30,0x000000,bold:true,align:wB.tE);this.CC.width=476;this.CC.height=250;this.CC.x=60;this.CC.y=90;this.HB(this.CC);this.BB(u.tC,this.onClick);if(h){this.qI=0;this.iG=0;iB.add(this);}else{this.qI=1;}this.alpha=0;} vC( g){this.iG+= g;if(this.iG>GJ){QE();NG();return false;}return true;}set text( g){if(g==null)return;var h=new qE(SC,30,0x000000,bold:true,align:wB.tE);if(g.length<=30)h.size=45;else h.size=30;this.CC.RC=h;this.CC.text=g;} onClick( g){QE();NG();} NG(){this.dispatchEvent(new PB(PB.GC,this));}set qI( g){if(g<0)g=1;if(g>1)g=1;gN=g;var h=(255*gN).round().toInt();} QE(){iB.remove(this);}}class zI extends dB{var yB;var yC;var pC;var bC;var sH=40;var tH=30;var SC;zI( h,[ g=lE]):super(h,true,g){this.SC=g;this.fB(u.KD);this.fB(u.tC);this.MD();} MD(){var g=this.CB as DC;this.CC.wordWrap=true;this.text=g.nB("GENexitquery");this.yB=new yD(new sB(o.QB("items").LB("but_yes")),new sB(o.QB("items").LB("but_yes2")),new sB(o.QB("items").LB("but_yes2")),new sB(o.QB("items").LB("but_yes2")));this.yB.x=tH;this.yB.y=dB.wD-this.yB.height-sH;this.yB.BB(u.KD,this.QM);this.HB(this.yB);this.yC=new yD(new sB(o.QB("items").LB("but_no")),new sB(o.QB("items").LB("but_no2")),new sB(o.QB("items").LB("but_no2")),new sB(o.QB("items").LB("but_no2")));this.yC.x=dB.bE-this.yC.width-tH;this.yC.y=dB.wD-this.yB.height-sH;this.yC.BB(u.KD,this.XI);this.HB(this.yC);this.pC=new NC();this.pC.BB(u.KD,this.yB.dispatchEvent);this.pC.TD=0x000000;this.pC.RC=new qE(SC,48,0,bold:true,align:wB.RH);this.pC.height=60;this.pC.x=this.yB.x+this.yB.width;this.pC.y=this.yB.y+5;this.HB(this.pC);this.pC.text=g.nB("GENyes");this.bC=new NC();this.bC.BB(u.KD,this.yC.dispatchEvent);this.bC.TD=0x000000;this.bC.RC=new qE(SC,48,0,bold:true,align:wB.xE);this.bC.height=60;this.bC.x=this.yC.x-this.bC.width;this.bC.y=this.yB.y+5;this.HB(this.bC);this.bC.text=g.nB("GENno");}NG(){XI(null);} QM( g){QE();this.dispatchEvent(new PB(PB.GC,this));} XI( g){QE();this.dispatchEvent(new PB(PB.cE,this));}}class PB extends DB{static const  GC="MenuEvent.TYPE_OK";static const  cE="MenuEvent.TYPE_CANCEL";var PF;PB( h, g,[ i=false]):super(h,i){this.PF=g;}}abstract class CJ{}class aE implements BJ,CJ{var GB;aE([ g]){this.GB=(g!=null)?g:new List();}hI( g){if(g<GB.length)this.GB.removeAt(g);} OF( h){var k=this.GB.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(GB[g].y<h.y&&GB[i].y>=h.y||GB[i].y<h.y&&GB[g].y>=h.y){if(GB[g].x+(h.y-GB[g].y)/(GB[i].y-GB[g].y)*(GB[i].x-GB[g].x)<h.x){j=!j;}}i=g;}return j;} rotate( k){var j=this.GB.length;var i=new List<EC>(j);for(var g=0;g<j;g++ ){var h=this.GB[g].clone();h.GF+= k;i[g]=h;}return new aE(i);} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.GB.length;var i=new List<EC>(j);for(var g=0;g<j;g++ ){var k=this.GB[g].clone();k.scale(h);i[g]=k;}return new aE(i);} transform( l, k, m){var j=this.GB.length;var i=new List<EC>(j);for(var g=0;g<j;g++ ){var h=this.GB[g].clone();h.scale(l);h.GF+= k;i[g]=h.add(m);}return new aE(i);}}abstract class BJ{}class DJ extends aE{var TN;var XN;DJ( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.TN=h;this.XN=g;EL();} get uL{return TN;} EL(){var g=new List<EC>();var h=0.0;var k=2*bB.PI/XN;for(var j=0;j<XN;j++ ){var i=new EC(0,-TN);i.GF=h;g.add(i);h+= k;}this.GB=g;}}class FC extends gC{var VN=0;var ZN=0;var bN=true;var cN=3;var dN=0.0;var eN;var fN;FC( h, g){IM(h,g);} IM( g, h){eN=g;fN=h;this.dispatchEvent(new s(s.fF,this));} get NF{return eN;} get DI{return fN;} start(){this.paused=false;this.dispatchEvent(new s(s.hE,this));} OL(){this.dispatchEvent(new s(s.iE,this));}set YE( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;dN=g;this.dispatchEvent(new s(s.dE,this));} get YE{return dN;}set nD( g){if(g<0)g=0;cN=g;this.dispatchEvent(new s(s.vD,this));if(cN==0)this.OL();} get nD{return cN;}set oD( g){if(g<0)g=0;VN=g;this.dispatchEvent(new s(s.gE,this));} get oD{return VN;} get GM{return VN.toDouble().round().toInt();}set oB( g){if(g<0)g=0;ZN=g;this.dispatchEvent(new s(s.fE,this));} get oB{return ZN;} ZL(){this.oB+= 1;return this.oB;}set paused( g){bN=g;this.dispatchEvent(new s(s.eE,this));} get paused{return bN;}}var MC;var gF;var o;var iB;var JJ;var rC;var kE;var HC;const  lE="Russo One"; main(){MC=new jC("Stage",SB.query('#stage'),800,600);gF=new iF();gF.nK(MC);iB=gF.XG;JJ=new bB.Random();OB.dH.webp=true;var g=OB.bD("images/Loading.png");g.then((h){rC=new sB(h);rC.AD=20;rC.BD=20;rC.x=400;rC.y=270;MC.HB(rC);kE=new BF(rC,100,xF.zF);kE.rH.BC.lG(100.0*2.0*bB.PI);iB.add(kE);HC=new NC();HC.RC=new qE("Arial",20,0xA0A0A0,bold:true);HC.width=240;HC.height=40;HC.text="... loading ...";HC.x=400-HC.OM/2;HC.y=320;HC.VI=false;MC.HB(HC);KJ();});} KJ(){o=new nF();o.onProgress.listen((l){var k=o.IL;var i=o.eI;var j=o.QG;print("Resource Progress -> finished: ${k.length}, pending:${i.length}, failed:${j.length}");});o.IC("barrier01","images/barrier01.png");o.IC("barrier02","images/barrier02.png");o.IC("barrier03","images/barrier03.png");o.IC("barrier04","images/barrier04.png");o.IC("barrier05","images/barrier05.png");o.IC("barrier06","images/barrier06.png");o.IC("barrier07","images/barrier07.png");o.IC("training01","images/training01.png");o.IC("training02","images/training02.png");o.IC("finish","images/finish.png");o.IC("broken","images/broken.png");o.oK("items","images/ItemTextureAtlas.json",jF.IH);o.GG("crash","sounds/crash.mp3");o.GG("swish","sounds/swish.mp3");o.GG("speedalizer","sounds/speedalizer.mp3");o.cB("DISPLAY_LEVEL","Level: {0}");o.cB("DISPLAY_LIVES","Ships:");o.cB("DISPLAY_SCORE","Score: {0}");o.cB("DISPLAY_TRAINING","Training");o.cB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");o.cB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");o.cB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");o.cB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");o.cB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");o.cB("MESSAGE_GAME_OVER","Game\nOver!");o.cB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");o.cB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");o.cB("GENscore","Score");o.cB("GENlevel","Level");o.cB("GENexitquery","Do you really want to quit the game?");o.cB("GENyes","Yes");o.cB("GENno","No");o.load().then((m){MC.AC(rC);MC.AC(HC);iB.remove(kE);var h=new DC(800,600);h.pK(MC);h.start();}).catchError((n){for(var g in o.QG){print("Loading resouce failed: ${g.kind}.${g.name} - ${g.error}");}});}const hM=const iM();class iM{const iM();}class jM extends eC{var FO;var UO;jM( i, h, g){FO=h;UO=g;}set XF( g){UO=g;} stop(){}}class PC{var BO;var cO; BB( g, h(event),{ useCapture: false}){return YP(g,useCapture).listen(h);}fB( g,{ useCapture: false}){YP(g,useCapture).vK();}dispatchEvent( g){qQ(g,this,this,HD.uE);} TR( h, j, i){if(j&&cO!=null){var g=cO[h];if(g!=null&&g.eQ)return true;}if(i&&BO!=null){var g=BO[h];if(g!=null&&g.eQ)return true;}return false;} YP( h, g){if(g){if(cO==null)cO=new Map<String,YD>();}else{if(BO==null)BO=new Map<String,YD>();}var i=g?cO:BO;return i.putIfAbsent(h,(){return new YD(this,h,g);});}qQ( g, k, l, j){var h=(j==HD.EH)?cO:BO;if(h==null)return;var i=h[g.type];if(i==null)return;g.VO=k;g.QR=l;g.OR=j;g.RR=false;g.VR=false;i.dispatchEvent(g);}}class u extends DB{static const  KD="click";static const  cJ="doubleClick";static const  tC="mouseDown";static const  HE="mouseUp";static const  wF="mouseMove";static const  zE="mouseOut";static const  ZH="mouseOver";static const  aH="mouseWheel";static const  fH="middleClick";static const  AK="middleMouseDown";static const  EK="middleMouseUp";static const  hH="rightClick";static const  JK="rightMouseDown";static const  MK="rightMouseUp";var yQ,zQ;var BR,DR;var SR;var dP;var EQ;var lP;var qP;var ZR;var aR;var bR;u( g,[ h=false]):super(g,h){MR(g,h);} MR( g,[ h=false]){super.MR(g,h);yQ=zQ=0;BR=DR=0;SR=false;dP=false;EQ=false;lP=false;qP=false;ZR=0;aR=0;bR=0;}set fR( g){yQ=g.x;zQ=g.y;}set gR( g){BR=g.x;DR=g.y;} get QI=>yQ; get RI=>zQ; get lI=>BR; get mI=>DR; get kC=>SR; get altKey=>dP; get ctrlKey=>lP; get shiftKey=>qP; get ME=>ZR; get deltaX=>aR; get deltaY=>bR;}abstract class QJ{}class CH{final  nG;CH(this.nG);call( h, g){uO(h).lG(g);} get x=>uO("x"); get y=>uO("y"); get ZC=>uO("scaleX"); get aC=>uO("scaleY"); get skewX=>uO("skewX"); get skewY=>uO("skewY"); get AD=>uO("pivotX"); get BD=>uO("pivotY"); get BC=>uO("rotation"); get alpha=>uO("alpha"); uO( h){var g=new vB(h);this.nG.uO(g);return g;}}class kF implements hC{final  IO;var QO=0.0;var gO=0.0;var mO=1;kF( g, h):IO=g{gO=bB.max(h,0.0001);} vC( h){var g=QO+h;while (g>=gO&&mO>0){QO=gO;mO-- ;IO();g-= gO;}QO=g;return (mO>0);} get currentTime=>QO;}class YD<CE extends DB> extends aB.Stream<CE>{final  VO;final  LO;final  oO;var GP=[] ;YD(this.VO,this.LO,this.oO); get isBroadcast=>true; asBroadcastStream({ onListen( subscription), onCancel( subscription)})=>this; get eQ=>GP.length>0; listen( i( event),{ onError(error), onDone(), cancelOnError: false}){var h=new FH<CE>(this,i);GP.add(h);if(oO==false){var g=this;switch (LO){case DB.vF:iH.FG(g);break;case DB.VH:kH.FG(g);break;case DB.bH:nH.FG(g);break;}}return h;}uK( j){if(j.BP)return;var i=[] ;for(var g=0;g<GP.length;g++ ){var h=GP[g];if(identical(h,j)){h.BP=true;}else{i.add(h);}}GP=i;}vK(){for(var g=0;g<GP.length;g++ ){var h=GP[g];h.BP=true;}GP=[] ;}dispatchEvent( j){var k=GP;var i=GP.length;for(var g=0;g<i;g++ ){var h=k[g];if(h.BP==false){h.fP(j);}}}}class tB<CE extends DB>{final  LO;const tB(this.LO); forTarget( g,{ useCapture: false}){return g.YP(LO,useCapture);}}abstract class hC{ vC( g);}class DB{static const  WJ="added";static const  LH="addedToStage";static const  vF="enterFrame";static const  VH="exitFrame";static const  qJ="removed";static const  tJ="removedFromStage";static const  xJ="resize";static const  bH="render";static const  mH="progress";var yO;var NR;var OR;var VO;var QR;var RR;var VR;DB( g,[ h=false]){MR(g,h);} MR( g,[ h=false]){yO=g;NR=h;OR=HD.uE;VO=null;QR=null;RR=false;VR=false;} get YF=>RR; get type=>yO; get bubbles=>NR; get IF=>true; get target=>VO;}class IB{var kN;var oN;IB( h, g):kN=h,oN=g;IB.LN():this(0,0); clone()=>new IB(kN,oN); toString()=>"Point [x=${kN}, y=${oN}]";static  KK( g, h)=>new IB(g*bB.cos(h),-g*bB.sin(h)); get x=>kN; get y=>oN; get length=>bB.sqrt(kN*kN+oN*oN);set x( g){kN=g;}set y( g){oN=g;} add( g){return new IB(kN+g.x,oN+g.y);} subtract( g){return new IB(kN-g.x,oN-g.y);}KF( g){kN=g.x;oN=g.y;} PG( g){return kN==g.x&&oN==g.y;}}abstract class sC extends MB{final  bO=new List<t>();var qO=true;var DP=true; HB( g){if(g.parent==this){var h=bO.indexOf(g);bO.removeAt(h);bO.add(g);}else{mK(g,bO.length);}} mK( g, h){if(h<0||h>bO.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){bO.removeAt(bO.indexOf(g));if(h>bO.length)h-- ;bO.insert(h,g);}else{g.AM();g.hR(this);bO.insert(h,g);g.dispatchEvent(new DB(DB.WJ,true));if(this.CD!=null)oR(g,new DB(DB.LH));}} AC( h){var g=bO.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");zL(g);} zL( g){if(g<0||g>=bO.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=bO[g];h.dispatchEvent(new DB(DB.qJ,true));if(this.CD!=null)oR(h,new DB(DB.tJ));h.hR(null);bO.removeAt(g);} FI( g){if(g<0||g>=bO.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return bO[g];} lD( g){return bO.indexOf(g);} oI( j, i){var h=lD(j);var g=lD(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");NM(h,g);} NM( h, g){var j=FI(h);var i=FI(g);bO[h]=i;bO[g]=j;} contains( g){for(;g!=null;g=g.oQ)if(g==this)return true;return false;} eB( q,[ g]){if(g==null)g=new FB.LN();if(bO.length==0)return super.eB(q,g);var i=double.INFINITY;var j=double.INFINITY;var l=double.NEGATIVE_INFINITY;var k=double.NEGATIVE_INFINITY;var v=bO.length;for(int m=0;m<bO.length;m++ ){var n=bO[m];rQ.MG(n.KR,q);var h=n.eB(rQ,g);if(h.left<i)i=h.left;if(h.top<j)j=h.top;if(h.right>l)l=h.right;if(h.bottom>k)k=h.bottom;}g.x=i;g.y=j;g.width=l-i;g.height=k-j;return g;} VB( i, k){i=i.toDouble();k=k.toDouble();var n=null;for(int l=bO.length-1;l>=0;l-- ){var j=bO[l];if(j.aS){var g=j.KR;var q=i-g.pB;var m=k-g.qB;var AB=(g.d*q-g.c*m)/g.mC;var v=(g.a*m-g.b*q)/g.mC;var h=j.VB(AB,v);if(h!=null){if(h is MB)if(h.VI)return qO?h:this;n=this;}}}return n;} JB( i){for(int g=0;g<bO.length;g++ ){var h=bO[g];if(h.aS)i.iI(h);}}cS( g, i){i.add(g);if(g is sC){var k=g as sC;var j=k.bO;for(int h=0;h<j.length;h++ ){cS(j[h],i);}}}oR( i, j){var g=DF.fI() as List<t>;cS(i,g);for(int h=0;h<g.length;h++ ){g[h].dispatchEvent(j);}g.clear();DF.gI(g);}}abstract class t extends PC implements lF{static var bJ=0;var iO=bJ++ ;var kN=0.0;var oN=0.0;var CP=0.0;var OP=0.0;var VP=1.0;var eP=1.0;var kP=0.0;var oP=0.0;var uP=0.0;var AQ=1.0;var DQ=true;var FQ=false;var LQ=null;var PQ=null;var UQ=null;var YQ=false;var dQ=null;var fQ=null;var iQ=null;var HO="";var oQ=null;final  rQ=new EB.PN();final  vQ=new EB.PN();var AR=true;static const  VK=const tB<GE>(DB.vF); get dL=>t.VK.forTarget(this); get x=>kN; get y=>oN; get AD=>CP; get BD=>OP; get ZC=>VP; get aC=>eP; get skewX=>kP; get skewY=>oP; get BC=>uP; get visible=>DQ; get alpha=>AQ; get tK=>PQ!=null; get JF=>iQ; get name=>HO; get parent=>oQ; get RF{var g=this.CD;return (g!=null)?this.TC(g.AS):null;} get UE{var g=this.RF;return (g!=null)?g.x:0.0;} get VE{var g=this.RF;return (g!=null)?g.y:0.0;} get root{var g=this;while (g.oQ!=null)g=g.oQ;return g;} get CD{var g=this.root;return (g is jC)?g:null;}set x( g){if(g is num)kN=g;AR=true;}set y( g){if(g is num)oN=g;AR=true;}set AD( g){if(g is num)CP=g;AR=true;}set BD( g){if(g is num)OP=g;AR=true;}set ZC( g){if(g is num)VP=g;AR=true;}set aC( g){if(g is num)eP=g;AR=true;}set skewX( g){if(g is num)kP=g;AR=true;}set skewY( g){if(g is num)oP=g;AR=true;}set BC( g){if(g is num)uP=g;AR=true;}set visible( g){if(g is bool)DQ=g;}set alpha( g){if(g is num)AQ=g;}set mask( g){LQ=g;}set JF( g){iQ=g;} setTransform( k, l,[ n, g, h, q, j, i, m]){if(k is num)kN=k;if(l is num)oN=l;if(n is num)VP=n;if(g is num)eP=g;if(h is num)uP=h;if(q is num)kP=q;if(j is num)oP=j;if(i is num)CP=i;if(m is num)OP=m;AR=true;} get width=>eB(KR).width; get height=>eB(KR).height; set width( h){this.ZC=1;var g=this.width;this.ZC=(g!=0.0)?h/g:1.0;} set height( h){this.aC=1;var g=this.height;this.aC=(g!=0.0)?h/g:1.0;} pK( g){g.HB(this);} AM(){if(oQ!=null)oQ.AC(this);} get aS=>DQ&&!FQ; get KR{if(AR){AR=false;var j=kP+uP;var i=oP+uP;if(j==0.0&&i==0.0){vQ.VF(VP,0.0,0.0,eP,kN-CP*VP,oN-OP*eP);}else{var g,l,k,h;var m=bB.cos(j);var n=bB.sin(j);if(j==i){g=VP*m;l=VP*n;k=-eP*n;h=eP*m;}else{g=VP*bB.cos(i);l=VP*bB.sin(i);k=-eP*n;h=eP*m;}var v=kN-(CP*g+OP*k);var q=oN-(CP*l+OP*h);vQ.VF(g,l,k,h,v,q);}}return vQ;} mG( h){if(h==oQ)return KR.clone();if(h.oQ==this)return h.KR.vH();var j=new EB.PN();var g=this;while (g!=h&&g.oQ!=null){j.concat(g.KR);g=g.oQ;}if(h==null&&g!=null){j.concat(g.KR);g=null;}if(g==h)return j;var k=new EB.PN();var i=h;while (i!=this&&i.oQ!=null){k.concat(i.KR);i=i.oQ;}k.KI();if(i==this)return k;if(i!=g)return null;j.concat(k);return j;} eB( h,[ g]){if(g==null)g=new FB.LN();g.x=h.pB;g.y=h.qB;g.width=0;g.height=0;return g;} VB( g, h){if(eB(CG).contains(g,h))return this;return null;} OI( h){rQ.JI();for(t g=this;g!=null;g=g.oQ)rQ.concat(g.KR);return rQ.ZE(h);} TC( h){rQ.JI();for(t g=this;g!=null;g=g.oQ)rQ.concat(g.KR);rQ.KI();return rQ.ZE(h);} TS( g){g.context.translate(UQ.x,UQ.y);PQ.JB(g);} dispatchEvent( h){var g=null;if(h.IF||h.bubbles){for(t j=oQ;j!=null;j=j.oQ){if(j.TR(h.type,h.IF,h.bubbles)){if(g==null)g=DF.fI() as List<t>;g.add(j);}}}if(h.IF&&g!=null){for(int i=g.length-1;i>=0&&h.YF==false;i-- ){g[i].qQ(h,this,g[i],HD.EH);}}if(h.YF==false){qQ(h,this,this,HD.uE);}if(h.bubbles&&g!=null){for(int i=0;i<g.length&&h.YF==false;i++ ){g[i].qQ(h,this,g[i],HD.dJ);}}if(g!=null){g.clear();DF.gI(g);}} hR( h){for(var g=h;g!=null;g=g.oQ)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");oQ=h;} JB( g);}class FB{var kN;var oN;var wN;var JO;FB( i, g, h, j):kN=i,oN=g,wN=h,JO=j;FB.LN():this(0,0,0,0); clone()=>new FB(kN,oN,wN,JO); toString()=>"Rectangle [x=${kN}, y=${oN}, width=${wN}, height=${JO}]"; get x=>kN; get y=>oN; get width=>wN; get height=>JO; get left=>kN; get top=>oN; get right=>kN+wN; get bottom=>oN+JO; get TB=>new IB(kN+wN/2,oN+JO/2); get size=>new IB(wN,JO);set x( g){kN=g;}set y( g){oN=g;}set width( g){wN=g;}set height( g){JO=g;} set size( g){wN=g.x;JO=g.y;} contains( g, h){return kN<=g&&oN<=h&&kN+wN>=g&&oN+JO>=h;} PG( g){return kN==g.x&&oN==g.y&&wN==g.width&&JO==g.height;} get isEmpty{return wN==0&&JO==0;}KF( g){kN=g.x;oN=g.y;wN=g.width;JO=g.height;} union( g){var i=bB.min(this.left,g.left);var h=bB.min(this.top,g.top);var j=bB.max(this.right,g.right);var k=bB.max(this.bottom,g.bottom);return new FB(i,h,j-i,k-h);} align(){var h=this.left.floor();var g=this.top.floor();var i=this.right.ceil();var j=this.bottom.ceil();return new FB(h,g,i-h,j-g);}}class EB{var lN,nN,qN,rN,uN,xN;var KO;EB( h, i, g, j, k, l):lN=h.toDouble(),nN=i.toDouble(),qN=g.toDouble(),rN=j.toDouble(),uN=k.toDouble(),xN=l.toDouble(),KO=(h*j-i*g).toDouble();EB.PN():lN=1.0,nN=0.0,qN=0.0,rN=1.0,uN=0.0,xN=0.0,KO=1.0; clone(){return new EB(lN,nN,qN,rN,uN,xN);} vH(){var h=(rN/KO);var i=-(nN/KO);var g=-(qN/KO);var j=(lN/KO);var k=-(h*uN+g*xN);var l=-(i*uN+j*xN);return new EB(h,i,g,j,k,l);} get a=>lN; get b=>nN; get c=>qN; get d=>rN; get pB=>uN; get qB=>xN; get mC=>KO; ZE( h){var i=h.x.toDouble();var g=h.y.toDouble();return new IB(i*lN+g*qN+uN,i*nN+g*rN+xN);} jR( h){var i=h.x.toDouble();var g=h.y.toDouble();return new IB(i*lN+g*qN+uN,i*nN+g*rN+xN);} concat( g){var m=lN;var v=nN;var AB=qN;var q=rN;var l=uN;var n=xN;var WB=KO;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var ZB=g.pB;var KB=g.qB;var hB=g.mC;lN=(m*j+v*i).toDouble();nN=(m*k+v*h).toDouble();qN=(AB*j+q*i).toDouble();rN=(AB*k+q*h).toDouble();uN=(l*j+n*i+ZB).toDouble();xN=(l*k+n*h+KB).toDouble();KO=(WB*hB).toDouble();} JI(){lN=1.0;nN=0.0;qN=0.0;rN=1.0;uN=0.0;xN=0.0;KO=1.0;} KI(){var j=lN;var m=nN;var l=qN;var k=rN;var h=uN;var i=xN;var g=KO;lN=(k/g).toDouble();nN=-(m/g).toDouble();qN=-(l/g).toDouble();rN=(j/g).toDouble();uN=-(lN*h+qN*i).toDouble();xN=-(nN*h+rN*i).toDouble();KO=(1.0/g).toDouble();} rotate( i){var g=bB.cos(i);var h=bB.sin(i);var j=lN;var n=nN;var m=qN;var l=rN;var k=uN;var q=xN;lN=(j*g-n*h).toDouble();nN=(j*h+n*g).toDouble();qN=(m*g-l*h).toDouble();rN=(m*h+l*g).toDouble();uN=(k*g-q*h).toDouble();xN=(k*h+q*g).toDouble();} scale( h, g){lN=(lN*h).toDouble();nN=(nN*g).toDouble();qN=(qN*h).toDouble();rN=(rN*g).toDouble();uN=(uN*h).toDouble();xN=(xN*g).toDouble();KO=(KO*h*g).toDouble();} translate( g, h){uN=(uN+g).toDouble();xN=(xN+h).toDouble();} VF( h, i, g, k, j, l){lN=h.toDouble();nN=i.toDouble();qN=g.toDouble();rN=k.toDouble();uN=j.toDouble();xN=l.toDouble();KO=(lN*rN-nN*qN).toDouble();} KF( g){lN=g.a.toDouble();nN=g.b.toDouble();qN=g.c.toDouble();rN=g.d.toDouble();uN=g.pB.toDouble();xN=g.qB.toDouble();KO=g.mC.toDouble();} MG( h, g){var n=h.a;var AB=h.b;var KB=h.c;var v=h.d;var m=h.pB;var q=h.qB;var ZB=h.mC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var hB=g.pB;var WB=g.qB;var cC=g.mC;lN=(n*k+AB*j).toDouble();nN=(n*l+AB*i).toDouble();qN=(KB*k+v*j).toDouble();rN=(KB*l+v*i).toDouble();uN=(m*k+q*j+hB).toDouble();xN=(m*l+q*i+WB).toDouble();KO=(ZB*cC).toDouble();}}class lB{final  kN;final  oN;lB( h, g):kN=h.toDouble(),oN=g.toDouble(); clone()=>new lB(kN,oN); get x=>kN; get y=>oN; toString()=>"Vector [x=${kN}, y=${oN}]"; operator+( g)=>new lB(kN+g.kN,oN+g.oN); operator-( g)=>new lB(kN-g.kN,oN-g.oN); operator*( g)=>new lB(kN*g.kN,oN*g.oN); operator/( g)=>new lB(kN/g.kN,oN/g.oN); operator-()=>new lB(-kN,-oN); operator==( g)=>kN==g.kN&&oN==g.oN; get hashCode=>kN.hashCode+oN.hashCode*7; scale( g){return new lB(kN*g,oN*g);} normalize(){var g=1/length;return new lB(kN*g,oN*g);} get length=>bB.sqrt(kN*kN+oN*oN); rotate( g){var i=bB.sin(g);var h=bB.cos(g);return new lB(kN*h-oN*i,kN*i+oN*h);}}class iF{var mN;var CO;var MO;var ZO;var KP;var XP;var iP;var rP;iF(){mN=new EE();CO=new List<jC>();MO=-1;KP=false;XP=new GE(0);iP=new XH();rP=new cH();ZO=jQ;lQ();} get XG=>mN;lQ(){SB.window.requestAnimationFrame(ZO);}jQ( g){lQ();g=g.toDouble();if(MO==-1)MO=g;if(MO>g)MO=g;var j=g-MO;var i=j/1000.0;var k=g/1000.0;var l=false;if(j>=1){MO=g;XP.EP=i;iH.dispatchEvent(XP);mN.vC(i);for(int h=0;h<CO.length;h++ ){CO[h].XG.vC(i);}if(KP){KP=false;nH.dispatchEvent(rP);}for(int h=0;h<CO.length;h++ ){CO[h].WL(k,i);}kH.dispatchEvent(iP);}} nK( g){if(g.hG!=null){g.hG.CM(g);}CO.add(g);g.tR=this;} CM( g){if(g.hG==this){CO.remove(g);g.tR=null;}}}class kM extends eC{var NO;var UO;var FO;var vO;var NP;kM( j, h, i){NO=j;FO=h;UO=i;var g=aD.AF;vO=g.createGain();vO.connectNode(g.destination,0,0);vO.gain.value=(UO!=null)?bB.pow(UO.volume,2):1;NP=g.createBufferSource();NP.buffer=NO.EO;NP.loop=h;NP.connectNode(vO,0,0);NP.start(0);} set XF( g){UO=g;vO.gain.value=(UO!=null)?bB.pow(UO.volume,2):1;} stop(){NP.stop(0);}}class gC extends sC{var wM=false;var pG=false;var WG=null;var zN=null;var IP=null; get UB{return (zN!=null)?zN:zN=new nE();}PR(){var i=this.RF;var j=this.CD;var m=this.visible;if(i!=null&&this.CD!=null){var h=GD.mJ;if(h!=null){var g=KR.ZE(i);if(g.x<h.left)g.x=h.left;if(g.x>h.right)g.x=h.right;if(g.y<h.top)g.y=h.top;if(g.y>h.bottom)g.y=h.bottom;i=KR.vH().ZE(g);}var l=new IB(CP,OP).add(i).subtract(GD.jJ);var k=KR.ZE(l);this.visible=false;IP=j.VB(j.UE,j.VE);this.x=k.x;this.y=k.y;this.visible=m;}} eB( h,[ g]){if(g==null)g=new FB.LN();super.eB(h,g);if(zN!=null){g=zN.XQ(h).union(g);}return g;} VB( i, j){var h=null;if(this.WG!=null){var g=this.mG(this.WG);if(g!=null){var k=i*g.a+j*g.c+g.pB;var l=i*g.b+j*g.d+g.qB;if(this.WG.VB(k,l)!=null){h=this;}}}else{h=super.VB(i,j);if(h==null&&zN!=null){if(zN.wQ(i,j)){h=this;}}}return h;}JB( g){if(zN!=null)zN.JB(g);super.JB(g);}}abstract class lF{ JB( g);}class LJ<CE>{final  sN=new List<CE>();final  SO;var fO=0;LJ( g()):SO=g; fI(){if(fO==0){return SO();}else{fO-- ;return sN[fO];}}gI( g){if(fO==sN.length){sN.add(g);}else{sN[fO]=g;}fO++ ;}reset(){sN.clear();fO=0;}}class pE extends DB{pE( g):super(g,false); get IF=>false;}class AH{final  yN;final  HO;final  dO;final  lO;final  wO;final  JP;final  RP;final  bP;final  hP;final  nP;final  vP;AH.ON( i, h, g):yN=i,HO=h,dO=FK(g["rotated"]),lO=xB(g["sourceSize"]["w"]),wO=xB(g["sourceSize"]["h"]),JP=xB(g["spriteSourceSize"]["x"]),RP=xB(g["spriteSourceSize"]["y"]),bP=xB(g["frame"]["x"]),hP=xB(g["frame"]["y"]),nP=xB(g["frame"]["w"]),vP=xB(g["frame"]["h"]); get PM=>yN; get name=>HO; get FM=>dO; get KL=>bP; get LL=>hP; get CI=>nP; get BI=>vP; get offsetX=>JP; get offsetY=>RP; get rL=>lO; get qL=>wO;}class pF extends jB{var EO;pF(){if(aD.AF==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  bD( i,[ g=null]){if(g==null)g=jB.dH;var m=new pF();var h=new aB.Completer<jB>();var j=aD.qH(i,g);var AB=aD.AF;if(j.length==0){return ID.bD(i,g);}KB(n){AB.decodeAudioData(n.response).then(( v){m.EO=v;h.complete(m);}).catchError((q){if(g.ignoreErrors){ID.bD(i,g).then((k)=>h.complete(k));}else{h.completeError(new StateError("Failed to decode audio."));}});}l(q){if(j.length>0){SB.HttpRequest.request(j.removeAt(0),responseType:'arraybuffer').then(KB).catchError(l);}else{if(g.ignoreErrors){ID.bD(i,g).then((k)=>h.complete(k));}else{h.completeError(new StateError("Failed to load audio."));}}}l(null);return h.future;} get length{return EO.duration;} play([ h=false, g]){if(g==null)g=new mB();return new kM(this,h,g);}}class jF{static const  VJ="json";static const  IH="jsonarray";}class AE extends DB{static const  JH="textInput";var pN="";AE( g,[ h=false]):super(g,h); get text=>pN;}class XB extends DB{static const  GH="touchBegin";static const  MH="touchEnd";static const  OH="touchCancel";static const  UH="touchMove";static const  pJ="touchOver";static const  uJ="touchOut";var tQ;var xQ;var yQ,zQ;var BR,DR;var dP;var EQ;var lP;var qP;var HR;var IR;var JR;XB( g,[ h=false]):super(g,h){MR(g,h);} MR( g,[ h=false]){super.MR(g,h);tQ=0;xQ=false;yQ=zQ=0;BR=DR=0;dP=false;EQ=false;lP=false;qP=false;HR=1.00;IR=0;JR=0;}set fR( g){yQ=g.x;zQ=g.y;}set gR( g){BR=g.x;DR=g.y;} get ZF=>tQ; get QI=>yQ; get RI=>zQ; get lI=>BR; get mI=>DR; get altKey=>dP; get ctrlKey=>lP; get shiftKey=>qP;}class BH extends t{var zN=new nE(); get UB=>zN; eB( g,[ h]){if(zN==null){return super.eB(g,h);}else{return zN.XQ(g);}} VB( g, h){if(zN==null){return null;}else{return zN.wQ(g,h)?this:null;}} JB( g){if(zN!=null)zN.JB(g);}}class hF{var png;var jpg;var webp;var autoHiDpi;hF({this.png: true,this.jpg: true,this.webp: false,this.autoHiDpi: true});}class yD extends MB{var upState;var overState;var downState;var hitTestState;var pG=true;var enabled=true;var aP;yD([this.upState,this.overState,this.downState,this.hitTestState]){BB(u.ZH,IQ);BB(u.zE,IQ);BB(u.tC,IQ);BB(u.HE,IQ);aP=this.upState;} eB( h,[ g]){if(aP!=null){rQ.MG(aP.KR,h);return aP.eB(rQ,g);}return super.eB(h,g);} VB( k, l){if(this.hitTestState!=null){var g=this.hitTestState.KR;var h=k-g.pB;var i=l-g.qB;var m=(g.d*h-g.c*i)/g.mC;var j=(g.a*i-g.b*h)/g.mC;if(this.hitTestState.VB(m,j)!=null)return this;}return null;} JB( g){if(aP!=null)g.iI(aP);} IQ( g){if(g.type==u.zE){aP=upState;}else{aP=g.kC?downState:overState;}}}class nE{final  bQ=new List<OC>();var hQ=new FB.LN();var mQ=true;clear(){bQ.clear();mQ=true;}uQ( g){bQ.add(g);mQ=true;}beginPath()=>uQ(new mM());closePath()=>uQ(new nM());moveTo( h, g)=>uQ(new oM(h,g));lineTo( h, g)=>uQ(new pM(h,g));arc( l, g, j, i, h, k)=>uQ(new qM(l,g,j,i,h,k));rect( i, g, h, j)=>uQ(new rM(i,g,h,j));nI( h,[ g=1.0, i=OJ.XJ, j=MJ.XJ])=>uQ(new sM(yE(h),g,i,j));HL( g)=>uQ(new tM(yE(g)));uH( i, g, h){uQ(new oM(i+h,g));uQ(new qM(i,g,h,0,bB.PI*2,false));} XQ( i){var h=new uC(i);for(int g=0;g<bQ.length;g++ ){bQ[g].ED(h);}return h.RL();} wQ( h, i){if(mQ){mQ=false;hQ=XQ(new EB.PN());}if(hQ.contains(h,i)){var j=JE;j.beginPath();for(int g=0;g<bQ.length;g++ ){if(bQ[g].VB(j,h,i)){return true;}}}return false;} JB( i){var g=i.context;g.save();g.beginPath();for(int h=0;h<bQ.length;h++ ){bQ[h].JB(g);}g.restore();}}class sB extends t{var AO;var OO;var eO;sB([ h=null, g="auto"]){this.KG=h;this.sL=g;eO=null;} get KG=>AO;set KG( g){if(g==null)AO=null;if(g is OB)AO=g;}set sL( g){if(g is String)OO=g;} eB( k,[ j]){var g=AO;var h=0,i=0;if(g!=null){h=g.width;i=g.height;}return DG(k,h,i,j);} VB( h, i){var g=AO;if(g==null)return null;if(h<0.0||i<0)return null;if(h>=g.width||i>=g.height)return null;return this;} JB( h){var g=AO;if(g==null)return;if(eO==null){g.JB(h);}else{g.DM(h,eO);}}}class rE extends eC{var RO;var GO;var FO;var UO;rE( g, i, h){RO=g;FO=i;UO=h;GO=g.MQ(this);GO.loop=FO;this.XF=h;GO.play();} set XF( g){UO=g;if(GO!=null)GO.volume=(UO!=null)?UO.volume:1;} stop(){if(GO!=null){if(GO.ended==false)GO.pause();RO.WR(this);GO=null;}}}class iC extends DB{static const  HH="keyDown";static const  KH="keyUp";var dP=false;var lP=false;var qP=false;var xP=false;var EQ=false;var KQ=0;var OQ=0;var SQ=0;iC( g,[ h=false]):super(g,h); get altKey=>dP; get ctrlKey=>lP; get shiftKey=>qP; get charCode=>KQ; get keyCode=>OQ; get keyLocation=>SQ;}class fC{final  DO=new List<AH>();var AO;static  bD( n, ZB){var k=new aB.Completer<fC>();var g=new fC();switch (ZB){case jF.VJ:case jF.IH:SB.HttpRequest.getString(n).then((KB){var q=XM.parse(KB);var h=q["frames"];var v=q["meta"];var cC=TK(n,v["image"]);if(h is List){for(var AB in h){var j=AB as Map;var i=j["filename"] as String;var l=pH(i);var m=new AH.ON(g,l,j);g.DO.add(m);}}if(h is Map){for(String i in h.keys){var j=h[i] as Map;var l=pH(i);var m=new AH.ON(g,l,j);g.DO.add(m);}}OB.bD(cC).then(( hB){g.AO=hB;k.complete(g);}).catchError((WB){k.completeError(new StateError("Failed to load image."));});}).catchError((WB){k.completeError(new StateError("Failed to load json file."));});break;}return k.future;} LB( h){for(int g=0;g<DO.length;g++ ){var i=DO[g];if(i.name==h){return new OB.SN(i);}}throw new ArgumentError("TextureAtlasFrame not found: '${h}'");}}class oE{var tN;var HO;var PO;var YO=null;var jO=null;var rO=new aB.Completer();oE( h, i, j, k):tN=h,HO=i,PO=j{k.then((g){YO=g;}).catchError((l){jO=l;}).whenComplete((){rO.complete(this);});} toString()=>"ResourceManagerResource [kind=${tN}, name=${HO}, url = ${PO}]"; get kind=>tN; get name=>HO; get value=>YO; get error=>jO; get complete=>rO.future;}class nF extends PC{final  aO=new Map<String,oE>();static const  lJ=const tB<DB>(DB.mH); get onProgress=>nF.lJ.forTarget(this);RQ( i, g, k, l){var j="${i}.${g}";var h=new oE(i,g,k,l);if(aO.containsKey(j)){throw new StateError("ResourceManager already contains a resource called '${g}'");}else{aO[j]=h;}h.complete.then((CR){this.dispatchEvent(new DB(DB.mH));});} GR( i, h){var j="${i}.${h}";var g=aO[j];if(g==null){throw new StateError("Resource '${h}' does not exist.");}else if(g.value!=null){return g.value;}else if(g.error!=null){throw g.error;}else{throw new StateError("Resource '${h}' has not finished loading yet.");}} load(){var i=this.eI.map((h)=>h.complete);return aB.Future.wait(i).then((j){var g=this.QG.length;if(g>0){throw new StateError("Failed to load ${g} resource(s).");}else{return this;}});} get IL{return aO.values.where((g)=>g.value!=null).toList();} get eI{return aO.values.where((g)=>g.value==null&&g.error==null).toList();} get QG{return aO.values.where((g)=>g.error!=null).toList();} IC( h, g,[ i=null]){RQ("BitmapData",h,g,OB.bD(g,i));} GG( i, g,[ h=null]){RQ("Sound",i,g,jB.bD(g,h));} oK( i, g, h){RQ("TextureAtlas",i,g,fC.bD(g,h));} cB( h, g){RQ("Text",h,"",new aB.Future.value(g));} LB( h){var g=GR("BitmapData",h);if(g is !OB)throw "dart2js_hint";return g;} TG( h){var g=GR("Sound",h);if(g is !jB)throw "dart2js_hint";return g;} QB( h){var g=GR("TextureAtlas",h);if(g is !fC)throw "dart2js_hint";return g;} SL( h){var g=GR("Text",h);if(g is !String)throw "dart2js_hint";return g;}}final  rF=new Map<String,gH>();class WD{final  matrix=new EB.PN();var alpha=1.0;var JF=vE.wE;var FP; get YL{if(FP==null)FP=new WD();return FP;}}class zG{static const  yF="none";static const  gJ="touchPoint";}class mF{var wC;var ND;}class rB{static const  sF="auto";static const  tF="arrow";static const  uF="button";static const  kJ="hand";static const  TH="ibeam";static const  nJ="wait";}class GD{static var DH=rB.sF;static var YJ=false;static var NH=null;static var jJ=null;static var mJ=null;static var rJ=new aB.StreamController<String>();static var wJ=rJ.stream.asBroadcastStream();static  oH( i){var h=i;var g="auto";if(DH!=rB.sF){h=DH;}switch (h){case rB.sF:g="auto";break;case rB.tF:g="default";break;case rB.uF:g="pointer";break;case rB.kJ:g="move";break;case rB.TH:g="text";break;case rB.nJ:g="wait";break;}if(YJ){g="none";}return g;}}abstract class MB extends t{var FL=false;var VI=true;var KN=true;var tabIndex=0;static const  oJ=const tB<u>(u.zE);static const  BK=const tB<u>(u.wF);static const  GK=const tB<u>(u.tC);static const  NK=const tB<u>(u.HE);static const  WK=const tB<u>(u.aH); get onMouseOut=>MB.oJ.forTarget(this); get onMouseMove=>MB.BK.forTarget(this); get onMouseDown=>MB.GK.forTarget(this); get onMouseUp=>MB.NK.forTarget(this); get onMouseWheel=>MB.WK.forTarget(this);static const  ZK=const tB<XB>(XB.UH);static const  aK=const tB<XB>(XB.MH);static const  bK=const tB<XB>(XB.OH); get onTouchMove=>MB.ZK.forTarget(this); get onTouchEnd=>MB.aK.forTarget(this); get onTouchCancel=>MB.bK.forTarget(this);static const  eK=const tB<iC>(iC.KH);static const  gK=const tB<iC>(iC.HH); get onKeyUp=>MB.eK.forTarget(this); get onKeyDown=>MB.gK.forTarget(this);static const  iK=const tB<AE>(AE.JH); get pL=>MB.iK.forTarget(this);}class ZD{static const  SJ=0;static const  RH=1;static const  xE=2;static const  hJ=3;static const  QH=4;}class ID extends jB{ID(){}static  bD( g,[ h=null]){return new aB.Future<jB>.value(new ID());} get length{return double.NAN;} play([ h=false, g]){if(g==null){g=new mB();}return new jM(this,h,g);}}class zD{var pN;var vN;var kN=0.0;var oN=0.0;var wN=0.0;var JO=0.0;var AP=0.0;var LP=0.0;var TP=0.0;zD.MN(this.pN,this.vN); get x=>kN; get y=>oN; get width=>wN; get height=>JO; get HF=>AP; get OG=>LP; get leading=>TP;}class wB{static const  tE="center";static const  ZJ="end";static const  fJ="justify";static const  RH="left";static const  xE="right";}class qE{var font;var size;var color;var bold;var italic;var underline;var align;var topMargin;var bottomMargin;var leftMargin;var rightMargin;var indent;var leading;qE(this.font,this.size,this.color,{this.bold: false,this.italic: false,this.underline: false,this.align: "left",this.topMargin: 0.0,this.bottomMargin: 0.0,this.leftMargin: 0.0,this.rightMargin: 0.0,this.indent: 0.0,this.leading: 0.0}); clone(){return new qE(font,size,color,bold:bold,italic:italic,underline:underline,align:align,topMargin:topMargin,bottomMargin:bottomMargin,leftMargin:leftMargin,rightMargin:rightMargin,indent:indent,leading:leading);} get UR{var g="${size}px ${font}, sans-serif";if(bold)g="bold ${g}";if(italic)g="italic ${g}";return g;}}class MJ{static const  XJ="round";}class HD{static const  EH=1;static const  uE=2;static const  dJ=3;}abstract class sE{var DD=null;var border=false;var borderColor=0xFF000000;var borderWidth=1;var zO;sE();factory sE.NN( i, g, h, j){return new lM(i,g,h,j);}qK( h, g){zO=h.context;zO.setTransform(g.a,g.b,g.c,g.d,g.pB,g.qB);zO.beginPath();LR();zO.save();zO.clip();}GL(){zO.restore();if(border){zO.strokeStyle=yE(borderColor);zO.lineWidth=borderWidth;zO.lineCap="round";zO.lineJoin="round";zO.stroke();}}LR();}class XD{static const  UJ="dynamic";static const  DE="input";}class OJ{static const  XJ="round";}class mE{static const  tE="center";static const  RH="left";static const  yF="none";static const  xE="right";}class NJ{}class NC extends MB{var pN="";var TO=null;var kO=mE.yF;var yO=XD.UJ;var PP=0;var ZP=0;var gP=0.0;var mP=0.0;var sP=0.0;var zP=0.0;var CQ=0.0;var GQ=false;var JQ=false;var NQ=false;var TQ=false;var WQ=false;var ZQ="";var cQ=0xFFFFFF;var gQ=0x000000;var kQ=0;var wN=100;var JO=100;var nQ=0.0;var pQ=0.0;final  sQ=new List<zD>();var ER=3;var FR=null;var zO=null;NC([ h, g]){this.text=(h!=null)?h:"";this.RC=(g!=null)?g:new qE("Arial",12,0x000000);this.onKeyDown.listen(YR);this.pL.listen(cR);this.onMouseDown.listen(dR);} get text=>pN; get type=>yO; get border=>WQ; get borderColor=>gQ; set width( g){wN=g.toDouble();ER|= 3;} set height( g){JO=g.toDouble();ER|= 3;} set text( g){pN=g.replaceAll('\r\n','\n').replaceAll('\r','\n');PP=pN.length;ER|= 3;} set TD( g){TO.color=g;ER|= 2;} set RC( g){TO=g.clone();ER|= 3;} set wordWrap( g){GQ=g;ER|= 3;} get x{SS();return super.x;} get width{SS();return wN;} get height{SS();return JO;} get OM{SS();return nQ;} eB( h,[ g]){return DG(h,wN,JO,g);} VB( g, h){if(g>=0&&h>=0&&g<wN&&h<JO)return this;return null;} JB( i){SS();XS();gP+= i.DL;var g=i.zO;g.drawImageScaled(FR,0.0,0.0,wN,JO);if(yO==XD.DE){var h=this.CD;if(h!=null&&h.focus==this&&gP.remainder(0.8)<0.4){g.fillStyle=FE(TO.color);g.fillRect(mP,sP,zP,CQ);}}}SS(){if((ER&1)==0){return;}else{ER&= 255-1;}sQ.clear();var j=0;var i='';var q='';var rI=0;var k=TO.size.toDouble();var hB=TO.leftMargin.toDouble();var sI=TO.rightMargin.toDouble();var tI=TO.topMargin.toDouble();var SM=TO.bottomMargin.toDouble();var TM=TO.align.toString();var cC=wN-hB-sI;var uI=TO.UR;var vI=eJ(uI);var wI=vI.HF.toDouble();var xI=vI.OG.toDouble();var l=JE;l.font=uI;l.textAlign="start";l.textBaseline="alphabetic";l.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);for(var qG in pN.split('\n')){if(GQ==false){sQ.add(new zD.MN(qG,j));j+= qG.length+1;}else{i=null;for(var ZB in qG.split(' ')){q=i;i=(q==null)?ZB:"${q} ${ZB}";i=bS(i);rI=l.measureText(i).width.toDouble();if(rI>=cC){if(q==null){sQ.add(new zD.MN(i,j));j+= i.length+1;i=null;}else{sQ.add(new zD.MN(q,j));j+= q.length+1;i=bS(ZB);}}}if(i!=null){sQ.add(new zD.MN(i,j));j+= i.length+1;}}}nQ=0.0;pQ=0.0;for(int h=0;h<sQ.length;h++ ){var g=sQ[h];if(g is !zD)continue;var WB=hB;var UM=tI+h*k+k;var KB=l.measureText(g.pN).width.toDouble();switch (TM){case wB.tE:case wB.fJ:WB+= (cC-KB)/2;break;case wB.xE:case wB.ZJ:WB+= (cC-KB);break;}g.kN=WB;g.oN=UM;g.wN=KB;g.JO=k;g.AP=wI;g.LP=xI;g.TP=0.0;nQ=bB.max(nQ,KB);pQ=pQ+k;}if(sQ.length>0){pQ+= tI+SM+xI;nQ+= hB+sI;}if(yO==XD.DE){for(int h=sQ.length-1;h>=0;h-- ){var g=sQ[h];if(g is !zD)continue;if(PP>=g.vN){var VM=PP-g.vN;var WM=g.pN.substring(0,VM);ZP=h;mP=g.kN+l.measureText(WM).width.toDouble();sP=g.oN-wI*0.9;zP=1.0;CQ=k;break;}}var m=0.0;var v=0.0;while (m+mP>wN)m-= wN*0.2;while (m+mP<0)m+= wN*0.2;while (v+sP+CQ>JO)v-= k;while (v+sP<0)v+= k;mP+= m;sP+= v;for(int h=0;h<sQ.length;h++ ){var g=sQ[h];if(g is !zD)continue;g.kN+= m;g.oN+= v;}}var n=GQ?wN:nQ.ceil();var AB=pQ.ceil();if(wN!=n||JO!=AB){switch (kO){case mE.RH:this.width=n;this.height=AB;break;case mE.xE:this.x=this.x-(n-wN);this.width=n;this.height=AB;break;case mE.tE:this.x=this.x-(n-wN)/2;this.width=n;this.height=AB;break;}}}XS(){if((ER&2)==0){return;}else{ER&= 255-2;}var g=(jC.BG?EF:1.0)/KE;var j=(wN*g).ceil();var h=(JO*g).ceil();if(FR==null){FR=new SB.CanvasElement(width:j,height:h);zO=FR.context2D;}if(FR.width!=j)FR.width=j;if(FR.height!=h)FR.height=h;zO.font=TO.UR;zO.textAlign="start";zO.textBaseline="alphabetic";zO.setTransform(g,0.0,0.0,g,0.0,0.0);if(TQ){zO.fillStyle=FE(cQ);zO.fillRect(0,0,wN,JO);}else{zO.clearRect(0,0,wN,JO);}zO.fillStyle=FE(TO.color);for(int k=0;k<sQ.length;k++ ){var i=sQ[k];zO.fillText(i.pN,i.kN,i.oN);}if(WQ){zO.strokeStyle=FE(gQ);zO.lineWidth=1;zO.strokeRect(0,0,wN,JO);}} bS( g){if(g is !String)return g;if(NQ==false)return g;var h="";for(int i=0;i<g.length;i++ ){h="${h}${ZQ}";}return h;}YR( AB){if(yO==XD.DE){SS();var l=pN;var n=l.length;var j=sQ;var g=PP;var i=ZP;var h=-1;switch (AB.keyCode){case SB.KeyCode.BACKSPACE:if(g>0){pN=l.substring(0,g-1)+l.substring(g);h=g-1;}break;case SB.KeyCode.END:var m=j[i];h=m.vN+m.pN.length;break;case SB.KeyCode.HOME:var m=j[i];h=m.vN;break;case SB.KeyCode.LEFT:if(g>0){h=g-1;}break;case SB.KeyCode.UP:if(i>0&&i<j.length){var q=j[i];var k=j[i-1];var v=bB.min(g-q.vN,k.pN.length);h=k.vN+v;}else{h=0;}break;case SB.KeyCode.RIGHT:if(g<n){h=g+1;}break;case SB.KeyCode.DOWN:if(i>=0&&i<j.length-1){var q=j[i];var k=j[i+1];var v=bB.min(g-q.vN,k.pN.length);h=k.vN+v;}else{h=n;}break;case SB.KeyCode.DELETE:if(g<n){pN=l.substring(0,g)+l.substring(g+1);h=g;}break;}if(h!=-1){PP=h;gP=0.0;ER|= 3;}}}cR( j){if(yO==XD.DE){var i=pN.length;var h=PP;var g=j.text;if(g=='\r')g='\n';if(g=='\n'&&JQ==false)g='';if(g=='')return;if(kQ!=0&&i>=kQ)return;pN=pN.substring(0,h)+g+pN.substring(h);PP=PP+g.length;gP=0.0;ER|= 3;}}dR( q){var hB=q.QI.toDouble();var l=q.RI.toDouble();var n=JE;n.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);for(int i=0;i<sQ.length;i++ ){var g=sQ[i];if(g is !zD)continue;var m=g.pN;var ZB=g.kN;var KB=g.oN-g.AP;var WB=g.oN+g.LP;if(KB<=l&&WB>=l){var v=double.INFINITY;var j=0;for(var h=0;h<=m.length;h++ ){var AB=n.measureText(m.substring(0,h)).width.toDouble();var k=(ZB+AB-hB).abs();if(k<v){v=k;j=h;}}PP=g.vN+j;gP=0.0;ER|= 3;}}}}abstract class OC{JB( g); VB( g, h, i){JB(g);return false;}ED( g){}}class PJ extends MB{var width;var height;PJ(this.width,this.height); eB( h,[ g]){return DG(h,width,height,g);} VB( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} JB( g){}}abstract class jB{static  bD( g,[ h=null]){switch (aD.vJ){case "WebAudioApi":return pF.bD(g,h);case "AudioElement":return oF.bD(g,h);default:return ID.bD(g,h);}}static var dH=new JD(mp3:true,mp4:true,ogg:true,wav:true); get length; play([ h=false, g]);}abstract class eC extends PC{ set XF( g); stop();}class JD{var mp3;var mp4;var ogg;var wav;var ignoreErrors;JD({this.mp3: false,this.mp4: false,this.ogg: false,this.wav: false,this.ignoreErrors: true});}class mB{var volume;var pan;var EN=1;var GN=0;var JN=1;var IN=0;mB([this.volume=1,this.pan=0]);}class aD{static var vJ=LK();static var AF=SK();static var eH=UK();static  LK(){var h=(AF!=null)?"WebAudioApi":"AudioElement";var g=SB.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0")||g.contains("10.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(eH.length==0)h="Mock";print("StageXL: supported audio engine is: ${h}");return h;}static  SK(){if(rG.AudioContext.supported)return new rG.AudioContext();return null;}static  UK(){var g=new List<String>();var h=new SB.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/mp4",""))!=-1)g.add("mp4");if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("StageXL: supported audio types are: ${g}");return g;}static  qH( i, h){var l=new RegExp(r"(mp3|mp4|ogg|wav)$",multiLine:false,caseSensitive:true);var g=eH.toList();var k=l.firstMatch(i);var j=new List<String>();if(k==null){throw new ArgumentError("Unsupported file extension.");}if(g.length==0){throw new UnsupportedError("This browser supports no known audio codec.");}if(!h.mp3)g.remove("mp3");if(!h.mp4)g.remove("mp4");if(!h.ogg)g.remove("ogg");if(!h.wav)g.remove("wav");var m=k.group(1);if(g.contains(m)){j.add(i);g.remove(m);}for(var n in g){j.add(i.replaceAll(l,n));}return j;}}class oF extends jB{var GO;var WO;var pO;oF(){pO=new List<rE>();GO=new SB.AudioElement();GO.onEnded.listen(wP);WO=new List<SB.AudioElement>();WO.add(GO);SB.document.body.children.add(GO);}static  bD( l,[ g=null]){if(g==null)g=jB.dH;var n=new oF();var h=n.GO;var i=aD.qH(l,g);var j=new aB.Completer<jB>();if(i.length==0){return ID.bD(l,g);}var k;var m;KB(v){k.cancel();m.cancel();j.complete(n);}q(v){if(i.length>0){h.src=i.removeAt(0);h.load();}else{k.cancel();m.cancel();if(g.ignoreErrors){ID.bD(l,g).then((AB)=>j.complete(AB));}else{j.completeError(new StateError("Failed to load audio."));}}}k=h.onCanPlayThrough.listen(KB);m=h.onError.listen(q);h.src=i.removeAt(0);h.load();return j.future;} get length{return GO.duration;} play([ h=false, g]){if(g==null)g=new mB();return new rE(this,h,g);} MQ( h){var g;if(WO.length==0){g=GO.clone(true);g.onEnded.listen(wP);}else{g=WO.removeAt(0);}pO.add(h);return g;} WR( g){var h=g.GO;var i=pO.indexOf(g);pO.removeAt(i);WO.add(h);if(GO.currentTime>0&&GO.ended==false)GO.currentTime=0;} wP( j){var i=j.target;var g=null;for(int h=0;h<pO.length&&g==null;h++ )if(pO[h].GO==i)g=pO[h];if(g!=null)g.stop();}}class BE{static const  TJ="exactFit";static const  aJ="noBorder";static const  iJ="noScale";static const  SH="showAll";}class OB implements lF{var wN;var JO;var XO;var hO;var nO;var xO;var HP;var QP;var cP;var jP;var pP;var tP;var yP;var BQ;var HQ;var zO;static var dH=new hF();OB( i, l,[ j=true, g=0xFFFFFFFF,k=1.0]){wN=xB(i);JO=xB(l);XO=j;hO=k.toDouble();nO=hO/KE;xO=((1.0-nO).abs()<0.001)?0:1;cP=0;jP=0;HP=wN;QP=JO;pP=0;tP=0;yP=(wN*nO).ceil();BQ=(JO*nO).ceil();var h=new SB.CanvasElement(width:yP,height:BQ);HQ=h;zO=h.context2D;zO.fillStyle=XO?yE(g):FE(g);zO.fillRect(0,0,yP,BQ);}OB.RN( g,[ j=1.0]){var h=xB(g.naturalWidth);var i=xB(g.naturalHeight);XO=true;hO=OK(j);nO=hO;wN=(h/hO).round();JO=(i/hO).round();xO=((1.0-nO).abs()<0.001)?0:1;cP=0;jP=0;HP=wN;QP=JO;pP=0;tP=0;yP=h;BQ=i;HQ=g;}OB.SN( g){var h=g.PM.AO;wN=g.rL.toInt();JO=g.qL.toInt();XO=true;hO=h.hO;nO=h.nO;xO=g.FM?3:2;cP=g.offsetX;jP=g.offsetY;HP=g.CI;QP=g.BI;pP=(g.KL*nO).floor();tP=(g.LL*nO).floor();yP=(g.CI*nO).ceil();BQ=(g.BI*nO).ceil();HQ=h.HQ;}static  bD( g,[ i=null, l=1.0]){if(i==null){i=OB.dH;}if(jC.BG&&i.autoHiDpi){if(g.contains("@1x.")&&EF>=1.5){l=l*2.0;g=g.replaceAll("@1x.","@2x.");}}var j=new aB.Completer<OB>();var h=new SB.ImageElement();var k;var m;k=h.onLoad.listen((AB){k.cancel();m.cancel();j.complete(new OB.RN(h,l));});m=h.onError.listen((AB){k.cancel();m.cancel();j.completeError(new StateError("Failed to load image."));});if(i.webp==false){h.src=g;return j.future;}cK.then(( q){var v=new RegExp(r"(png|jpg|jpeg)$",multiLine:false,caseSensitive:true);var n=v.firstMatch(g);if(q==false||n==null){h.src=g;}else{h.src=g.substring(0,g.length-n.group(1).length)+"webp";}});return j.future;} get width=>wN; get height=>JO; getImageData( h, j, g, i,[ m]){if(m!=null&&m!=hO){var n=new OB(g,i,true,0,m);n.AI(this,new EB(1.0,0.0,0.0,1.0,-h,-j));return n.getImageData(h,j,g,i);}YS();var l=hO;var k=nO;if(KE>1.0){return zO.getImageDataHD(h*l,j*l,g*l,i*l);}else{return zO.getImageData(h*k,j*k,g*k,i*k);}} clone([ g]){g=(g!=null)?g:hO;var h=new OB(wN,JO,true,0,g);h.AI(this);return h;} AI( h,[ g=null]){YS();g=(g==null)?new EB.PN():g.clone();g.scale(nO,nO);var i=new kB.QN(zO,g);h.JB(i);zO.globalAlpha=1.0;zO.globalCompositeOperation=vE.wE;} clear(){YS();zO.setTransform(nO,0.0,0.0,nO,0.0,0.0);zO.clearRect(0,0,wN,JO);} QL( q, v){var j=getImageData(q,v,1,1);var i=j.width*j.height;var h=j.data;var k=0,m=0,n=0,l=0;for(int g=0;g<i;g++ ){k+= CF?h[g*4+0]:h[g*4+3];m+= CF?h[g*4+1]:h[g*4+2];n+= CF?h[g*4+2]:h[g*4+1];l+= CF?h[g*4+3]:h[g*4+0];}return ((l~/i)<<24)+((k~/i)<<16)+((m~/i)<<8)+((n~/i)<<0);} JB( h){var g=h.context;switch (xO){case 0:g.drawImage(HQ,cP,jP);break;case 1:g.drawImageScaled(HQ,cP,jP,HP,QP);break;case 2:g.drawImageScaledFromSource(HQ,pP,tP,yP,BQ,cP,jP,HP,QP);break;case 3:g.transform(0.0,-1.0,1.0,0.0,cP,jP+QP);g.drawImageScaledFromSource(HQ,pP,tP,BQ,yP,0.0,0.0,QP,HP);break;}} DM( q, g){if(g.width==0||g.height==0)return;var i=q.context;if(xO!=0){YS();}var h=(g.x-cP)*nO;var n=(g.y-jP)*nO;var v=g.width*nO;var k=g.height*nO;var l=g.x+cP;var j=g.y+jP;var AB=g.width;var m=g.height;i.drawImageScaledFromSource(HQ,h,n,v,k,l,j,AB,m);} YS(){if(zO==null){var g=hO/KE;var j=(wN*g).ceil();var i=(JO*g).ceil();var h=new SB.CanvasElement(width:j,height:i);var k=new EB(g,0.0,0.0,g,0.0,0.0);var l=new kB.QN(h.context2D,k);this.JB(l);hO=hO;nO=g;xO=((1.0-nO).abs()<0.001)?0:1;cP=0;jP=0;HP=wN;QP=JO;pP=0;tP=0;yP=j;BQ=i;HQ=h;zO=h.context2D;}}}typedef  qF( ratio);typedef  RJ<CE extends DB>( event);class FH<CE extends DB> extends aB.StreamSubscription<CE>{var sO=0;var BP=false;var SP;var fP;FH(this.SP,this.fP); get isPaused=>sO>0; onError( g(error)){} cancel(){SP.uK(this);} pause([ g]){sO++ ;if(g!=null){g.whenComplete(resume);}} resume(){if(sO==0){throw new StateError("Subscription is not paused.");}sO-- ;}}class EE implements hC{var tO;var MP;var WP=0.0;EE(){tO=new mF();MP=tO;} get elapsedTime=>WP; add( g){if(g is !hC){throw new ArgumentError("The supplied animatable does not extend type Animatable.");}if(this.contains(g)==false){var h=new mF();MP.wC=g;MP.ND=h;MP=h;}} remove( h){if(h!=null){var g=tO;while (identical(g,MP)==false){if(identical(g.wC,h)){g.wC=null;break;}g=g.ND;}}} contains( h){if(h!=null){var g=tO;while (identical(g,MP)==false){if(identical(g.wC,h))return true;g=g.ND;}}return false;} nG( g, i,[ h]){var j=h!=null?new BF(g,i,h):new BF(g,i);add(j);return j;} MF( h, i){var g=new kF(h,i);add(g);return g;} vC( j){WP+= j;var g=tO;var i=MP;while (identical(g,i)==false){var k=g.wC;if(k==null){var h=g.ND;g.wC=h.wC;g.ND=h.ND;if(identical(h,i))i=g;if(identical(h,MP))MP=g;}else if(k.vC(j)==false){g.wC=null;}else{g=g.ND;}}return true;}}class vE{static const  wE="source-over";} FE( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";} eJ( g){if(rF.containsKey(g)==false){rF[g]=new gH(g);}return rF[g];}class GE extends pE{var EP;GE( g):super(DB.vF),EP=g;}class PH{static var zJ=zG.yF;static var DK=new aB.StreamController<String>();static var HK=DK.stream.asBroadcastStream();static  get PK=>zJ;}class uB{static const  WH="B";static const  sJ="BL";static const  YH="BR";static const  RH="L";static const  xE="R";static const  yJ="T";static const  CK="TR";static const  yF="";} yE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class XH extends pE{XH():super(DB.VH);}class kB{final  zO;var QO=0.0;var QQ=0.0;var VQ;var aQ;kB.QN( i,[ h]):zO=i{VQ=new WD();aQ=VQ;var g=VQ.matrix;if(h is EB){g.KF(h);}zO.setTransform(g.a,g.b,g.c,g.d,g.pB,g.qB);zO.globalAlpha=1.0;zO.globalCompositeOperation=vE.wE;} get context=>zO; get currentTime=>QO; get DL=>QQ; reset([ i, h, j]){QO=(h is num)?h:0.0;QQ=(j is num)?j:0.0;aQ=VQ;var g=VQ.matrix;if(i is EB){g.KF(i);}zO.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);zO.clearRect(0,0,zO.canvas.width,zO.canvas.height);zO.setTransform(g.a,g.b,g.c,g.d,g.pB,g.qB);zO.globalAlpha=1.0;zO.globalCompositeOperation=vE.wE;} iI( h){var g=h.KR;var KB=h.AQ;var k=h.LQ;var j=h.fQ;var q=h.iQ;var m=aQ as WD;var i=aQ.YL as WD;aQ=i;var n=i.matrix;var AB=m.alpha.toDouble()*KB;var v=(q!=null)?q:m.JF;n.MG(g,m.matrix);i.alpha=AB;i.JF=v;if(k!=null){if(k.DD==null){g=i.matrix;}else if(identical(k.DD,h)){g=i.matrix;}else if(identical(k.DD,h.parent)){g=m.matrix;}else{g=k.DD.mG(h);if(g==null)g=CG;else g.concat(i.matrix);}k.qK(this,g);}if(j!=null){if(j.DD==null){g=i.matrix;}else if(identical(j.DD,h)){g=i.matrix;}else if(identical(j.DD,h.parent)){g=m.matrix;}else{g=j.DD.mG(h);if(g==null)g=CG;else g.concat(i.matrix);}j.uM(this,g);}var l=n;zO.setTransform(l.a,l.b,l.c,l.d,l.pB,l.qB);zO.globalCompositeOperation=v;zO.globalAlpha=AB;if(h.tK){h.TS(this);}else{h.JB(this);}if(j!=null){j.xM();}if(k!=null){k.GL();}aQ=m;}}class cH extends pE{cH():super(DB.bH);}class gH{var fontStyle;var HF=0;var OG=0;var height=0;gH( j){this.fontStyle=j;var h=new SB.Element.tag("span");h.style.font=this.fontStyle;h.text="Hg";var g=new SB.Element.tag("div");g.style.display="inline-block";g.style.width="1px";g.style.height="0px";var i=new SB.Element.tag("div");i.append(g);i.append(h);SB.document.body.append(i);try {g.style.verticalAlign="baseline";this.HF=g.offsetTop-h.offsetTop;g.style.verticalAlign="bottom";this.height=g.offsetTop-h.offsetTop;this.OG=height-HF;}catch (k){}finally {i.remove();}}}class uC{var matrix;var PD=double.INFINITY;var QD=double.NEGATIVE_INFINITY;var RD=double.INFINITY;var OD=double.NEGATIVE_INFINITY;var eD=double.INFINITY;var fD=double.NEGATIVE_INFINITY;var gD=double.INFINITY;var dD=double.NEGATIVE_INFINITY;var OE=double.NAN;var PE=double.NAN;uC(this.matrix); get UG=>!OE.isNaN&&!PE.isNaN; get II=>!PD.isInfinite&&!QD.isInfinite&&!RD.isInfinite&&!OD.isInfinite; get TL=>!eD.isInfinite&&!fD.isInfinite&&!gD.isInfinite&&!dD.isInfinite;EM(){OE=PE=double.NAN;PD=RD=double.INFINITY;QD=OD=double.NEGATIVE_INFINITY;}rD( h, g){OE=h;PE=g;}FD( h, g,[ k=false]){if(UG){h=h.toDouble();g=g.toDouble();var i=k?h:h*matrix.a+g*matrix.c+matrix.pB;var j=k?g:h*matrix.b+g*matrix.d+matrix.qB;if(PD>i)PD=i;if(QD<i)QD=i;if(RD>j)RD=j;if(OD<j)OD=j;}}stroke( l){if(II){var g=bB.sqrt(matrix.mC)*l/2;var h=PD-g;var i=QD+g;var j=RD-g;var k=OD+g;if(eD>h)eD=h;if(fD<i)fD=i;if(gD>j)gD=j;if(dD<k)dD=k;}}fill(){if(II){if(eD>PD)eD=PD;if(fD<QD)fD=QD;if(gD>RD)gD=RD;if(dD<OD)dD=OD;}} RL(){if(TL){var g=eD.floor();var i=fD.ceil();var h=gD.floor();var j=dD.ceil();return new FB(g,h,i-g,j-h);}else{return new FB.LN();}}}class xF{static  zF( g){return g;}}class IE{static const  sF="auto";static const  IK="stop";static const  jH="once";} FK( g){if(g is bool){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a bool.");}}final  iH=new AG<GE>();final  kH=new AG<XH>(); xB( g){if(g is int){return g;}else{throw new ArgumentError("The supplied value (${g}) is not an int.");}}class lH{var target=null;var kC=false;var LG=0;var ME=0;var UI,WI;var SI,TI;lH(this.UI,this.WI,this.SI,this.TI);}final  nH=new AG<cH>(); OK( g){if(g is num){return g;}else{throw new ArgumentError("The supplied value (${g}) is not a number.");}}class AG<CE extends pE>{final  BO=[] ;FG( g){BO.add(g);}dispatchEvent( g){var j=BO;var k=BO.length;for(int h=0;h<k;h++ ){var i=j[h];if(i.eQ){g.VO=i.VO;g.QR=i.VO;g.OR=HD.uE;g.RR=false;g.VR=false;i.dispatchEvent(g);}else{j.removeAt(h);k-- ;h-- ;}}}}class vB{final  gG;var jG=double.NAN;var kG=double.NAN;vB(this.gG); lG( g){this.kG=g.toDouble();} get VL=>!jG.isNaN&&!kG.isNaN; XR( g){switch (gG){case 'x':return g.x;case 'y':return g.y;case 'pivotX':return g.AD;case 'pivotY':return g.BD;case 'scaleX':return g.ZC;case 'scaleY':return g.aC;case 'skewX':return g.skewX;case 'skewY':return g.skewY;case 'rotation':return g.BC;case 'alpha':return g.alpha;default:return 0.0;}} mR( g, h){switch (gG){case 'x':g.x=h;break;case 'y':g.y=h;break;case 'pivotX':g.AD=h;break;case 'pivotY':g.BD=h;break;case 'scaleX':g.ZC=h;break;case 'scaleY':g.aC=h;break;case 'skewX':g.skewX=h;break;case 'skewY':g.skewY=h;break;case 'rotation':g.BC=h;break;case 'alpha':g.alpha=h;break;}}}class QK{static var RK=0;var ZF=RK++ ;var target=null;var UF=false;QK(this.target,this.UF);} pH( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class lM extends sE{final  eR;lM( i, g, h, j):eR=new FB(i,g,h,j);LR(){zO.rect(eR.x,eR.y,eR.width,eR.height);}}class jC extends sC{static var BG=jK;var FR;var zO;var iR,kR;var lR;var nR,pR;var qR;var rR;var sR;var tR;var mN;var uR;var vR;var wR;var xR;var yR;var zR;var AS;var BS;var CS;var DS;var ES;var FS;jC( k, g,[ j, i, h]){if(g is !SB.CanvasElement){throw new ArgumentError("The canvas argument is not a CanvasElement");}if(g.tabIndex==-1)g.tabIndex=0;if(g.style.outline=="")g.style.outline="none";HO=k;FR=g;zO=g.context2D;iR=(j!=null)?j:g.width;kR=(i!=null)?i:g.height;lR=(h!=null)?h:30;nR=-1;pR=-1;qR=new FB.LN();rR=new EB.PN();sR=new EB.PN();RS();tR=null;mN=new EE();vR=new kB.QN(zO);wR=IE.sF;xR=BE.SH;yR=uB.yF;CS=[new lH(u.tC,u.HE,u.KD,u.cJ),new lH(u.AK,u.EK,u.fH,u.fH),new lH(u.JK,u.MK,u.hH,u.hH)];zR=rB.tF;BS=null;AS=new IB(0,0);ES=new u(u.KD,true);GD.wJ.listen(wJ);FR.onMouseDown.listen(IQ);FR.onMouseUp.listen(IQ);FR.onMouseMove.listen(IQ);FR.onMouseOut.listen(IQ);FR.onMouseWheel.listen(US);DS=new Map<int,QK>();FS=new XB(XB.GH,true);PH.HK.listen(VS);VS(null);FR.onKeyDown.listen(WS);FR.onKeyUp.listen(WS);FR.onKeyPress.listen(WS);} get hG=>tR; get XG=>mN; get RF=>AS; get focus=>uR; get align=>yR;ZS(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");}set x( g){ZS();}set y( g){ZS();}set AD( g){ZS();}set BD( g){ZS();}set ZC( g){ZS();}set aC( g){ZS();}set skewX( g){ZS();}set skewY( g){ZS();}set BC( g){ZS();}set alpha( g){ZS();}set width( g){ZS();}set height( g){ZS();}WL( g, h){if(wR==IE.sF||wR==IE.jH){RS();vR.reset(sR,g,h);JB(vR);if(wR==IE.jH)wR=IE.IK;}}RS(){var WB=FR.getBoundingClientRect();var hB=FR.clientLeft+WB.left;var ZB=FR.clientTop+WB.top;var h=FR.clientWidth;var j=FR.clientHeight;var q=iR;var KB=kR;if(h is !num)throw "dart2js_hint";if(j is !num)throw "dart2js_hint";if(q is !num)throw "dart2js_hint";if(KB is !num)throw "dart2js_hint";if(h==0||j==0)return;var i=1.0;var g=1.0;var k=0.0;var m=0.0;var n=h/q;var l=j/KB;switch (xR){case BE.TJ:i=n;g=l;break;case BE.aJ:i=g=(n>l)?n:l;break;case BE.iJ:i=g=1.0;break;case BE.SH:i=g=(n<l)?n:l;break;}switch (yR){case uB.CK:case uB.xE:case uB.YH:k=(h-q*i);break;case uB.yJ:case uB.yF:case uB.WH:k=(h-q*i)/2;break;}switch (yR){case uB.sJ:case uB.WH:case uB.YH:m=(j-KB*g);break;case uB.RH:case uB.yF:case uB.xE:m=(j-KB*g)/2;break;}var v=qR;v.x=-k/i;v.y=-m/g;v.width=h/i;v.height=j/g;var AB=(jC.BG?EF:1.0)/KE;sR.VF(i,0.0,0.0,g,k,m);sR.scale(AB,AB);rR.VF(1.0,0.0,0.0,1.0,-hB-k,-ZB-m);rR.scale(1.0/i,1.0/g);if(nR!=h||pR!=j){nR=h;pR=j;FR.width=(nR*AB).round();FR.height=(pR*AB).round();if(FR.clientWidth!=h||FR.clientHeight!=j){FR.style.width="${h}px";FR.style.height="${j}px";}dispatchEvent(new DB(DB.xJ));}}wJ( g){FR.style.cursor=GD.oH(zR);}IQ( j){j.preventDefault();var n=new DateTime.now().millisecondsSinceEpoch;var v=j.button;var g=null;var i=rR.jR(j.client);var m=null;if(v<0||v>2)return;if(j.type=="mousemove"&&AS.PG(i))return;var h=CS[v];AS=i;if(GD.NH!=null)GD.NH.PR();if(j.type!="mouseout")g=VB(i.x,i.y) as MB;var k=rB.tF;if(g is gC&&(g as gC).pG){k=rB.uF;}if(g is yD&&(g as yD).pG){k=rB.uF;}if(g is NC&&(g as NC).type==XD.DE){k=rB.TH;}if(zR!=k){zR=k;FR.style.cursor=GD.oH(k);}if(BS!=null&&BS!=g){BS.dispatchEvent(ES..MR(u.zE,true)..fR=(BS.CD!=null)?BS.TC(i):new IB.LN()..gR=i..SR=h.kC);BS=null;}if(g!=null&&g!=BS){g.dispatchEvent(ES..MR(u.ZH,true)..fR=g.TC(i)..gR=i..SR=h.kC);BS=g;}var l=null;var q=false;var AB=false;if(j.type=="mousedown"){FR.focus();l=h.UI;if(g!=h.target||n>h.LG+500)h.ME=0;h.kC=true;h.target=g;h.LG=n;h.ME++ ;}if(j.type=="mouseup"){l=h.WI;h.kC=false;q=(h.target==g);AB=q&&h.ME.isEven&&(n<h.LG+500);}if(j.type=="mousemove"){l=u.wF;}if(l!=null&&g!=null){m=g.TC(i);g.dispatchEvent(ES..MR(l,true)..fR=m..gR=i..SR=h.kC..ZR=h.ME);if(q){if(AB&&g.FL){g.dispatchEvent(ES..MR(h.TI,true)..fR=m..gR=i..SR=h.kC);}else{g.dispatchEvent(ES..MR(h.SI,true)..fR=m..gR=i..SR=h.kC);}}}}US( h){var g=rR.jR(h.client);var i=VB(g.x,g.y) as MB;if(i!=null){i.dispatchEvent(ES..MR(u.aH,true)..fR=i.TC(g)..gR=g..aR=h.deltaX..bR=h.deltaY);if(ES.YF)h.preventDefault();}}var lS=[] ;VS( h){lS.forEach((g)=>g.cancel());if(PH.PK==zG.gJ){lS=[FR.onTouchStart.listen(mS),FR.onTouchEnd.listen(mS),FR.onTouchMove.listen(mS),FR.onTouchEnter.listen(mS),FR.onTouchLeave.listen(mS),FR.onTouchCancel.listen(mS)];}}mS( j){j.preventDefault();for(var m in j.changedTouches){var l=m.identifier;var i=rR.jR(m.client);var h=VB(i.x,i.y) as MB;var g=DS.containsKey(l)?DS[l]:new QK(h,DS.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(FS..MR(XB.uJ,true)..fR=(g.target.CD!=null)?g.target.TC(i):new IB.LN()..gR=i..tQ=g.ZF..xQ=g.UF);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(FS..MR(XB.pJ,true)..fR=h.TC(i)..gR=i..tQ=g.ZF..xQ=g.UF);g.target=h;}var k=null;if(j.type=="touchstart"){FR.focus();DS[l]=g;k=XB.GH;}if(j.type=="touchend"){DS.remove(l);k=XB.MH;}if(j.type=="touchcancel"){DS.remove(l);k=XB.OH;}if(j.type=="touchmove"){k=XB.UH;}if(k!=null&&h!=null){h.dispatchEvent(FS..MR(k,true)..fR=h.TC(i)..gR=i..tQ=g.ZF..xQ=g.UF);}}}WS( g){if(g.keyCode==8){g.preventDefault();}if(uR==null){return;}if(g.type=="keypress"){var j=g.charCode;var k=g.keyCode;if(k==13)j=13;if(j==0)return;var l=new AE(AE.JH,true)..pN=new String.fromCharCodes([j]);uR.dispatchEvent(l);}else{var h=ZD.SJ;var i="";if(g.type=="keyup")i=iC.KH;if(g.type=="keydown")i=iC.HH;if(g.keyLocation==SB.KeyLocation.LEFT)h=ZD.RH;if(g.keyLocation==SB.KeyLocation.RIGHT)h=ZD.xE;if(g.keyLocation==SB.KeyLocation.NUMPAD)h=ZD.hJ;if(g.keyLocation==SB.KeyLocation.JOYSTICK)h=ZD.QH;if(g.keyLocation==SB.KeyLocation.MOBILE)h=ZD.QH;var m=new iC(i,true)..dP=g.altKey..lP=g.ctrlKey..qP=g.shiftKey..KQ=g.charCode..OQ=g.keyCode..SQ=h;uR.dispatchEvent(m);}}} TK( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} XK(){var g=new SB.CanvasElement(width:1,height:1);g.context2D.fillStyle="#000000";g.context2D.fillRect(0,0,1,1);var i=g.context2D.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} YK(){var i=new aB.Completer<bool>();var g=new SB.ImageElement(); h(){i.complete(g.width==2&&g.height==2);}g.onLoad.listen((j)=>h());g.onError.listen((j)=>h());g.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";return i.future;}class BF implements hC{final  GS;final  HS;final  IS=new List<vB>();var KS;var LS;var MS;var NS;var gO;var QO;var OS;var PS;var QS;BF( g, i,[ h=xF.zF]):GS=g,HS=h{NS=new CH(this);QO=0.0;gO=bB.max(0.0001,i);OS=0.0;PS=false;QS=false;} get rH=>NS; uO( g){if(GS!=null&&QS==false){IS.add(g);}} complete(){if(gO>=QO)vC(gO-QO);} vC( m){if(QO<gO||QS==false){QO=QO+m;if(QO>gO){QO=gO;}if(QO>=0.0){if(QS==false){QS=true;for(int h=0;h<IS.length;h++ ){var g=IS[h];g.jG=g.XR(GS);}if(KS!=null){KS();}}var k=QO/gO;var l=HS(k).toDouble();for(int h=0;h<IS.length;h++ ){var g=IS[h];if(g.VL){var i=g.jG.toDouble();var n=g.kG.toDouble();var j=i+l*(n-i);g.mR(GS,PS?j.round():j);}}if(LS!=null){LS();}if(MS!=null&&QO==gO){MS();}}}return QO<gO;} get currentTime=>QO;}class mM extends OC{mM();JB( g){g.beginPath();}ED( g){g.EM();}}class nM extends OC{nM();JB( g){g.closePath();}}class oM extends OC{var kN,oN;oM( h, g){kN=h.toDouble();oN=g.toDouble();}JB( g){g.moveTo(kN,oN);}ED( g){g.rD(kN,oN);}}final  CF=XK();final  cK=YK();final  DF=new LJ<List<t>>(()=>new List<t>());final  CG=new EB.PN();class pM extends OC{var kN,oN;pM( h, g){kN=h.toDouble();oN=g.toDouble();}JB( g){g.lineTo(kN,oN);}ED( g){if(g.UG==false){g.rD(kN,oN);}g.FD(g.OE,g.PE);g.FD(kN,oN);g.rD(kN,oN);}}final  dK=new SB.CanvasElement(width:16,height:16); DG( g, m, n, j){m=m.toDouble();n=n.toDouble();var cC=0.0;var hB=0.0;var AB=m*g.a;var ZB=m*g.b;var KB=m*g.a+n*g.c;var v=m*g.b+n*g.d;var WB=n*g.c;var q=n*g.d;var h=cC;if(h>AB)h=AB;if(h>KB)h=KB;if(h>WB)h=WB;var i=hB;if(i>ZB)i=ZB;if(i>v)i=v;if(i>q)i=q;var l=cC;if(l<AB)l=AB;if(l<KB)l=KB;if(l<WB)l=WB;var k=hB;if(k<ZB)k=ZB;if(k<v)k=v;if(k<q)k=q;if(j==null)j=new FB.LN();j.x=g.pB+h;j.y=g.qB+i;j.width=l-h;j.height=k-i;return j;}final  JE=dK.context2D;final  KE=JE.backingStorePixelRatio==null?1.0:JE.backingStorePixelRatio.toDouble();final  EF=SB.window.devicePixelRatio==null?1.0:SB.window.devicePixelRatio;final  fK=((){var g=SB.window.navigator.userAgent.toLowerCase();return g.indexOf("iphone")>=0||g.indexOf("ipad")>=0||g.indexOf("ipod")>=0||g.indexOf("android")>=0||g.indexOf("webos")>=0||g.indexOf("windows phone")>=0;})();final  hK=SB.window.screen==null?1024:bB.max(SB.window.screen.width,SB.window.screen.height);final  jK=EF>1.0&&(!fK||hK>480);class qM extends OC{var kN,oN,dS;var eS,fS;var gS;qM( l, g, j, i, h, k){kN=l.toDouble();oN=g.toDouble();dS=j.toDouble();eS=i.toDouble();fS=h.toDouble();gS=k;}JB( g){g.arc(kN,oN,dS,eS,fS,gS);}ED( g){var j=new lB(dS,0);var q=j.rotate(eS);var m=j.rotate(fS);if(g.UG==false){g.rD(kN+q.x,oN+q.y);}var h=eS;var i=fS;if(gS){if(h<i)h=h+2*bB.PI;}else{if(i<h)i=i+2*bB.PI;}var v=i-h;var l=(v*30).abs()~/bB.PI+1;g.FD(g.OE,g.PE);for(var k=0;k<=l;k++ ){var n=j.rotate(h+k*v/l);g.FD(kN+n.x,oN+n.y);}g.rD(kN+m.x,oN+m.y);}}class rM extends OC{var kN,oN;var wN,JO;rM( i, g, h, j){kN=i.toDouble();oN=g.toDouble();wN=h.toDouble();JO=j.toDouble();}JB( g){g.rect(kN,oN,wN,JO);}ED( g){g.rD(kN,oN);g.FD(kN,oN);g.FD(kN+wN,oN);g.FD(kN+wN,oN+JO);g.FD(kN,oN+JO);}}abstract class kK extends OC{var hS;var iS;var jS;kK( h, i, g){hS=h.toDouble();iS=i;jS=g;} VB( g, h, i){g.lineWidth=hS;g.lineJoin=iS;g.lineCap=jS;try {return g.isPointInStroke(h,i);}catch (j){return false;}}ED( g){g.stroke(hS);}}class sM extends kK{var kS;sM( g, i, j, h):super(i,j,h){kS=g;}JB( g){g.strokeStyle=kS;g.lineWidth=hS;g.lineJoin=iS;g.lineCap=jS;g.stroke();}}abstract class lK extends OC{ VB( g, h, i){return g.isPointInPath(h,i);}ED( g){g.fill();}}class tM extends lK{var kS;tM( g){kS=g;}JB( g){g.fillStyle=kS;g.fill();}}
//# sourceMappingURL=supersonic.dart.map
//@ sourceMappingURL=supersonic.dart.map
