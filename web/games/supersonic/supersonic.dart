import "dart:math" as ZB;import "dart:json" as RK;import "dart:html" as mC;import "dart:web_audio" as VH;class WH extends AD{var JC;WH(){JC=new List<PC>();} GK(){this.JC.sort(PK);} DD( g){if(this.contains(g))return;this.v(g);this.JC.add(g);} yJ( g){if(this.JC.length>0){var h=this.JC.indexOf(g);if(h>=0)this.JC.removeAt(h);}if(this.contains(g))this.qB(g);} PK( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.JD(g)<this.JD(h))this.QH(g,h);return 1;}if(g.position.z<h.position.z){if(this.JD(g)>this.JD(h))this.QH(g,h);return -1;}return 0;}}class PC extends AD{var uK;var yK;var AL;var position;var TC=-1;var CC=0;var FK=1;var kC=false;var tG=false;var fD=false;var fK=false;var cD=0;var ND=0;var iD=0;PC( g){AL=new AD();v(AL);this.aD=g;if(this.aD==null)return;this.x=100000;}set aD( g){if(uK!=null)this.qB(uK);if(yK!=null)this.qB(yK);uK=null;yK=null;if(g!=null){uK=g;uK.uC=yC.zC/2;uK.vC=yC.zC/2;v(uK);}else{yK=new IG();v(yK);}v(AL);} get aD{return uK;} setScale( g){this.FK=g;if(yK!=null){yK.PB.clear();yK.PB.beginPath();yK.PB.gG(0,0,yC.zC/2*g);yK.PB.closePath();yK.PB.PH(0xff999999,1);}if(uK!=null)uK.WC=uK.XC=g;AL.WC=AL.XC=g;} LE( j){if(uK==null)return false;var g=this.xG(j);g=uK.jC(g);var k=this.aD.nB.NJ(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new iB(m.KB("items").CB("blood"));h.uC=50;h.vC=50;h.x=g.x-yC.zC/2;h.y=g.y-yC.zC/2;AL.v(h);}return i;}}class RD{static var qF=new ZB.Random();static  sF( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=RD.qF.nextInt(h+1)+g;}return i;}static  fH( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=RD.qF.nextDouble()*(h-g)+g;}return i;}}class QC{var x;var y;QC(this.x,this.y);set length( g){this.normalize();this.XJ(g);} get length{return ZB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new QC(x,y);} add( g){if(g==null)return null;return new QC(x+g.x,y+g.y);}XJ( g){x*= g;y*= g;} get FF{var g=ZB.PI-ZB.atan2(this.x,this.y);if(g<0)g+= 2*ZB.PI;return g;}set FF( i){var h=this.length;var g=EB.bI(h,i-ZB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class aC{var x;var y;var z;aC(this.x,this.y,this.z); clone(){return new aC(x,y,z);} qG(){return ZB.sqrt(x*x+y*y+z*z);}DK( g){this.normalize();this.scale(g);} add( g){return new aC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=qG();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} equals( g){return (g.x==x&&g.y==y&&g.z==z);}}class VB extends bE implements dC{static var jD=588;static var TD=314;static var eH=10.0;var sC;var rB;var GL;var jF;var GC;VB( g,[ autoStart=true, fontName=tD]):super(g){this.GC=fontName;this.width=VB.jD;this.height=VB.TD;this.sC=new iB(m.KB("items").CB("menu_bg"));this.v(this.sC);this.rB=new cC();this.rB.xC=0x000000;this.rB.wordWrap=true;this.rB.UC=new EG(fontName,30,0x000000,zB:true,align:mB.yD);this.rB.width=476;this.rB.height=250;this.rB.x=60;this.rB.y=90;this.v(this.rB);this.addEventListener(p.eC,this.YF);if(autoStart){this.TH=0;this.jF=0;aB.add(this);}else{this.TH=1;}this.alpha=0;} ED( g){this.jF+= g;if(this.jF>eH){dD();OF();return false;}return true;}set text( g){if(g==null)return;var h=new EG(GC,30,0x000000,zB:true,align:mB.yD);if(g.length<=30)h.size=45;else h.size=30;this.rB.UC=h;this.rB.text=g;} YF( g){dD();OF();} OF(){this.u(new JB(JB.uB,this));}set TH( g){if(g<0)g=1;if(g>1)g=1;GL=g;var h=(255*GL).round().toInt();} dD(){aB.remove(this);}}class JB extends AB{static const  uB="MenuEvent.TYPE_OK";static const  kD="MenuEvent.TYPE_CANCEL";var NE;JB( h, g,[ bubbles=false]):super(h,bubbles){this.NE=g;}}class YH extends bE{var sC;var YC;var BC;var AC;var MC;var KC;var LC;var font;var lF=30;var VE;YH( h,[ fontName=tD]):super(h){this.font=fontName;this.tC();var g=new StringBuffer();g.add((this.s as sB).eB("GENlevel"));g.add(": 0");AC.text=g.toString();} tC(){this.sC=new iB(m.KB("items").CB("topbar"));this.sC.x=0;this.sC.y=0;this.v(this.sC);this.YC=new cC();this.YC.UC=new EG(font,24,0,zB:true,align:mB.UG);this.YC.xC=0x000000;this.YC.width=400;this.YC.height=100;this.YC.x=20;this.YC.y=lF;this.v(YC);this.BC=new cC();this.BC.UC=new EG(font,24,0,zB:true,align:mB.AE);this.BC.xC=0x000000;this.BC.width=200;this.BC.height=100;this.BC.x=(this.s.KE/2)-this.BC.width+60;this.BC.y=lF;this.v(BC);this.AC=new cC();this.AC.UC=new EG(font,24,0,zB:true,align:mB.AE);this.AC.xC=0x000000;this.AC.width=200;this.AC.height=100;this.AC.x=(this.s.KE)-(this.AC.width)-20;this.AC.y=lF;this.v(AC);this.MC=new cC();this.MC.UC=new EG(font,24,0,zB:true,align:mB.yD);this.MC.xC=0x000000;this.MC.width=200;this.MC.height=100;this.MC.x=20;this.MC.y=this.s.nG-this.MC.height-20;this.v(MC);this.MC.visible=false;this.KC=new iB(m.KB("items").CB("progressbar"));this.KC.x=25;this.KC.y=82;this.v(this.KC);this.LC=new iB(m.KB("items").CB("progressship"));this.LC.x=25;this.LC.y=this.KC.y+(this.KC.height-(this.KC.height-this.LC.height))-(this.LC.height);this.v(this.LC);this.VE=new List<iB>();for(var h=0;h<3;h++ ){var g=new iB(m.KB("items").CB("spaceship"));g.y=10;g.x=(this.s.KE/2)+70+(h*35);this.v(g);this.VE.add(g);}} cF( g){this.LC.x=25;this.LC.y=this.KC.y+(this.KC.height-((this.KC.height-this.LC.height)*g.s.progress))-(this.LC.height);} aF( i){var h=i.s as sB;if(h.OD){this.BC.text=h.eB("DISPLAY_TRAINING");}else{this.BC.text=h.eB("DISPLAY_LIVES");}for(var g=0;g<this.VE.length;g++ ){this.VE[g].visible=(!h.OD)&&(g<i.s.LD);}} dF( h){var i=h.s as sB;var g=new StringBuffer();g.add(i.eB("GENscore"));g.add(": ${h.s.CK.toString()}");YC.text=g.toString();} hD( h){var i=h.s as sB;var g=new StringBuffer();g.add(i.eB("GENlevel"));g.add(": ${h.s.level.toString()}");AC.text=g.toString();}}class XH extends VB{var oB;var hC;var ZC;var OC;var eG=40;var fG=30;var GC;XH( g,[ fontName=tD]):super(g,true,fontName){this.GC=fontName;this.removeEventListener(p.qC,this.YF);this.removeEventListener(p.eC,this.YF);this.tC();} tC(){var g=this.s as sB;this.rB.wordWrap=true;this.text=g.eB("GENexitquery");this.oB=new wD(new iB(m.KB("items").CB("but_yes")),new iB(m.KB("items").CB("but_yes2")),new iB(m.KB("items").CB("but_yes2")),new iB(m.KB("items").CB("but_yes2")));this.oB.x=fG;this.oB.y=VB.TD-this.oB.height-eG;this.oB.addEventListener(p.qC,this.OK);this.v(this.oB);this.hC=new wD(new iB(m.KB("items").CB("but_no")),new iB(m.KB("items").CB("but_no2")),new iB(m.KB("items").CB("but_no2")),new iB(m.KB("items").CB("but_no2")));this.hC.x=VB.jD-this.hC.width-fG;this.hC.y=VB.TD-this.oB.height-eG;this.hC.addEventListener(p.qC,this.DH);this.v(this.hC);this.ZC=new cC();this.ZC.addEventListener(p.qC,this.oB.u);this.ZC.xC=0x000000;this.ZC.UC=new EG(GC,48,0,zB:true,align:mB.UG);this.ZC.height=60;this.ZC.x=this.oB.x+this.oB.width;this.ZC.y=this.oB.y+5;this.v(this.ZC);this.ZC.text=g.eB("GENyes");this.OC=new cC();this.OC.addEventListener(p.qC,this.hC.u);this.OC.xC=0x000000;this.OC.UC=new EG(GC,48,0,zB:true,align:mB.AE);this.OC.height=60;this.OC.x=this.hC.x-this.OC.width;this.OC.y=this.oB.y+5;this.v(this.OC);this.OC.text=g.eB("GENno");}OF(){DH(null);} OK( g){dD();this.u(new JB(JB.uB,this));} DH( g){dD();this.u(new JB(JB.kD,this));}}class bE extends AD{var wK;bE( g){this.s=g;}set s( g){if(wK!=null){wK.removeEventListener(n.qD,this.RE);wK.removeEventListener(n.rD,this.QE);wK.removeEventListener(n.gE,this.ZF);wK.removeEventListener(n.pD,this.SE);wK.removeEventListener(n.nD,this.hD);wK.removeEventListener(n.mD,this.EH);wK.removeEventListener(n.oD,this.dF);wK.removeEventListener(n.SD,this.aF);wK.removeEventListener(n.lD,this.cF);}wK=g;if(wK!=null){wK.addEventListener(n.qD,this.RE);wK.addEventListener(n.rD,this.QE);wK.addEventListener(n.gE,this.ZF);wK.addEventListener(n.pD,this.SE);wK.addEventListener(n.nD,this.hD);wK.addEventListener(n.mD,this.EH);wK.addEventListener(n.oD,this.dF);wK.addEventListener(n.SD,this.aF);wK.addEventListener(n.lD,this.cF);}} get s{return wK;} RE( g){} QE( g){} ZF( g){} SE( g){} hD( g){} EH( g){} dF( g){} aF( g){} cF( g){}}class sB extends tB{static const  tF=1.0;static const  cH=100;static const  dH=0xFFFFFF;var HK=tF;var KJ=5;var ID;var uG=false;var KH=500;var bgColor=0xffffff;var pB;var IB;var KD;var HL=true;var OE=false;var oG=60.0;var eD;var GC=tD;var SF=false;var rJ="Web";sB( h, g):super(h,g){this.addEventListener(AB.NG,this.aJ);}set OD( g){HL=g;this.u(new n(n.SD,this));} get OD{return HL;} aJ( g){this.SJ();} hJ( g){OE=false;} gJ( g){OE=true;} SJ(){if(!uG){this.addEventListener(p.XD,this.hJ);this.addEventListener(p.eC,this.gJ);this.tJ();this.addEventListener(n.pD,this.SE);this.addEventListener(n.SD,this.fJ);this.addEventListener(n.lD,this.jJ);this.addEventListener(n.oD,this.kJ);this.addEventListener(n.nD,this.dJ);this.addEventListener(n.mD,this.iJ);this.addEventListener(n.qD,this.RE);this.addEventListener(n.rD,this.QE);this.tC();this.progress=0;this.MD=0;this.LD=3;this.start();uG=true;}} eB( i,[ params=null]){var h=m.OJ(i);if(params!=null)for(int g=0;g<params.length;g++ )h=h.replaceAll("{${g}}",params[g].toString());return h;} tJ(){this.HK=tF;this.bgColor=dH;this.KH=cH;this.KJ=5;this.oG=60000;} tC(){this.ID=new yC(this);this.v(this.ID);var h=m.KB("items").CB("button_exit");var g=m.KB("items").CB("button_exit_2");this.pB=new wD(new iB(h),new iB(g),new iB(h),new iB(g));this.pB.width=75;this.pB.height=66;this.pB.x=707;this.pB.y=525;this.pB.addEventListener(p.eC,bJ);this.v(this.pB);this.pB.visible=false;this.KD=new YH(this,GC);this.KD.x=0;this.KD.y=0;this.v(this.KD);} yI(){var g=this.GD();g.text=this.eB("MESSAGE_RESTART_LEVEL");g.addEventListener(JB.uB,this.FH);} uI( h){var g=this.GD();g.text=this.eB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.addEventListener(JB.uB,this.FH);} FH( g){this.wC(g.NE);this.ID.sI();} kG(){this.ID.QF();var g=this.GD();if(this.level==0){g.text=this.eB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.eB("MESSAGE_START_LEVEL",[(this.level+1)]);}g.addEventListener(JB.uB,this.mJ);} mJ( g){this.wC(g.NE);this.YJ();} vI(){var g=this.GD();g.text=this.eB("MESSAGE_GAME_OVER");g.addEventListener(JB.uB,this.cJ);} cJ( g){this.wC(g.NE);} GD([ menu=null, tweenDuration=1.0, autoStart=true]){if(this.IB!=null)this.wC(this.IB);this.pB.visible=false;this.KD.visible=true;if(menu==null)this.IB=new VB(this,autoStart,GC);else this.IB=menu;this.IB.width=VB.jD;this.IB.height=VB.TD;this.IB.x=(this.KE/2)-(VB.jD/2)+30;this.IB.y=(this.nG/2)-(VB.TD/2);this.IB.alpha=0;this.v(this.IB);var g=new gI(this.IB,tweenDuration,AF.BF);g.FE("alpha",1);aB.add(g);return this.IB;} wC( g){this.paused=false;this.KD.visible=true;this.pB.visible=true;if(g==null)return;g.dD();if(this.contains(g)){this.qB(g);}this.IB=null;} MJ(){aB.remove(eD);if(this.SF)this.eF(null);this.OE=true;this.OD=false;} lJ(){if(this.IB!=null)return;if(rJ.toLowerCase()=="web")return;aB.remove(eD);this.eD=new pE(this.MJ,this.oG);aB.add(this.eD);this.SF=true;this.paused=true;var g=this.GD(null,200,false);this.pB.visible=true;g.text=this.eB("MESSAGE_FIRST_LEVEL");g.addEventListener(JB.uB,this.eF);} eF( g){aB.remove(this.eD);this.SF=false;IB.removeEventListener(JB.uB,this.eF);this.wC(IB);} bJ( h){if(this.IB is XH)return;var g=new XH(this,GC);this.GD(g);this.paused=true;g.addEventListener(JB.uB,this.XF);g.addEventListener(JB.kD,this.WF);} XF( g){this.u(new n(n.rD,this));IB.removeEventListener(JB.uB,this.XF);IB.removeEventListener(JB.kD,this.WF);this.wC(IB);this.paused=true;} WF( g){IB.removeEventListener(JB.uB,this.XF);IB.removeEventListener(JB.kD,this.WF);this.wC(IB);} SE( g){this.ID.QF();aB.HE(this.kG,0.5);} EJ(){this.ID.QF();} jJ( g){} fJ( g){} kJ( g){} dJ( g){} iJ( g){} RE( g){aB.HE(this.vI,2.0);} QE( g){}}class n extends AB{static const  SD="GameEvent.TYPE_LIVES_CHANGED";static const  lD="GameEvent.TYPE_PROGRESS_CHANGED";static const  mD="GameEvent.TYPE_PAUSE_CHANGED";static const  nD="GameEvent.TYPE_LEVEL_CHANGED";static const  oD="GameEvent.TYPE_SCORE_CHANGED";static const  pD="GameEvent.TYPE_GAME_START";static const  qD="GameEvent.TYPE_GAME_OVER";static const  rD="GameEvent.TYPE_GAME_ABORT";static const  gE="GameEvent.TYPE_GAME_SIZE_CHANGED";var s;n( h, g,[ bubbles=false]):super(h,bubbles){this.s=g;}}class yC extends bE{static var rF=0.025;static var dE=1.0;static var zC=600;static var eE=800;static var fE=600;static var uF=400;static var vF=300;static var UD=ZB.sqrt(eE*eE+fE*fE);static var gH=(UD*2/zC);static var wF=6;var OB;var QB;var IC;var VC;var iF=30.0*ZB.PI/180;var hF=1.0*ZB.PI/180;var PD=0.05;var fF=-1;var TE=1;var LB;var gC;var GF=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var HF;var IF;var hG;var tI;var RH;var gF=15;var wG;var HD=false;var GE=0;var PF;var EE;var DF=0.90;var LH=0;var IL;var VK;var XB;var JJ=0;var FC;var FD=false;var UF,VF;var rG;yC( g):super(g){IL=new GG.oK(80,60,690,524);this.mask=IL;this.HF=m.RF("speedalizer");this.IF=this.HF.play(true);this.XB=new IG();this.v(this.XB);rG=new tH(800,600);v(rG);UF=VF=0;EC.addEventListener(p.wE,this.bF);EC.addEventListener(p.eC,this.bF);EC.addEventListener(p.XD,this.bF);} bF( g){UF=g.NH;VF=g.OH;} sJ(){var g=this.s.MD;this.s.MD=g+(this.s as sB).KH*(this.s.level*this.s.LD);} ZF( g){} hD( g){super.hD(g);this.IK();} IK(){FD=false;this.removeEventListener(AB.rC,this.PE);this.GE=0;this.s.progress=0;this.HD=false;var h=60;this.VC=new bH(UD,wF*h);for(var g=this.VC.w.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.VC.IH(g);this.OB=new QC(uF,vF);this.QB=new aC(0,0,0);this.IC=new aC(0,0,dE);this.hF=(1+(0.1*this.s.level))*ZB.PI/180;this.PD=0.015+(0.004*this.s.level);this.TE=2+this.s.level;this.fF=-this.TE;this.LH=this.s.level*2;this.gF=15+(this.s.level);this.tC();this.wI();this.addEventListener(AB.rC,this.PE);} tC(){if(this.LB!=null)this.qB(this.LB);this.LB=new WH();this.v(this.LB);if(this.FC!=null)this.qB(this.FC);this.FC=new iB(m.KB("items").CB("crosshair"));this.FC.WC=0.5;this.FC.XC=0.5;this.FC.x=(eE/2)-this.FC.width/2;this.FC.y=(fE/2)-this.FC.height/2;this.v(this.FC);} QF(){this.FD=false;this.removeEventListener(AB.rC,this.PE);var h=60;this.VC=new bH(UD,wF*h);for(var g=this.VC.w.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.VC.IH(g);this.OB=new QC(uF,vF);this.QB=new aC(0,0,0);this.IC=new aC(0,0,dE);this.hF=2*ZB.PI/180;this.TE=0;this.fF=0;if(this.LB!=null){this.qB(this.LB);this.LB=null;}this.LB=new WH();this.v(this.LB);if(this.gC!=null){this.qB(this.gC);this.gC=null;}this.jG();this.addEventListener(AB.rC,this.PE);} jG(){var g=new PC(null);g.TC=-1;g.CC=0;g.position=this.QB.clone();g.position.z=0.5;this.LB.DD(g);} iG(){var g=new PC(new iB(m.KB("items").CB("countdown01")));g.TC=0;g.CC=0;g.position=this.QB.clone();g.position.z=0.5;g.cD=0;g.fD=true;this.LB.DD(g);g=new PC(new iB(m.KB("items").CB("countdown02")));g.TC=0;g.CC=0;g.position=this.QB.clone();g.position.z=0;g.cD=1;g.fD=true;this.LB.DD(g);g=new PC(new iB(m.KB("items").CB("countdown03")));g.TC=0;g.CC=0;g.position=this.QB.clone();g.position.z=-0.5;g.cD=2;g.fD=true;this.LB.DD(g);g=new PC(new iB(m.KB("items").CB("countdown04")));g.TC=0;g.CC=0;g.position=this.QB.clone();g.position.z=-1;g.cD=3;g.fD=true;this.LB.DD(g);} xI(){var h=1+this.s.level;if(h>=this.GF.length)h=this.GF.length-1;var i=RD.sF(0,h);var j=this.GF[i];var g=new PC(new iB(m.CB(j)));g.kC=true;g.NC=RD.sF(0,359)*ZB.PI/180;g.CC=RD.fH(this.fF,this.TE)*ZB.PI/180;g.position=this.QB.clone();return g;} wI(){this.iG();this.jG();var h=0;for(var i=0;i<gF;i++ ){var g=null;if(i==gF-1){g=new PC(new iB(m.CB("finish")));g.NC=0;g.CC=5*ZB.PI/180;g.position=this.QB.clone();g.TC=0;g.kC=true;g.tG=true;this.PF=g;}else{h++ ;if(this.s.level==1&&h<=3){if(h==1){g=new PC(new iB(m.CB("training01")));g.kC=true;g.NC=0;g.CC=0;g.position=this.QB.clone();g.ND=1;}else if(h==2){g=new PC(new iB(m.CB("training02")));g.kC=true;g.NC=135*ZB.PI/180;g.CC=0;g.position=this.QB.clone();g.ND=2;}else if(h==3){g=new PC(new iB(m.CB("training02")));g.kC=true;g.NC=315*ZB.PI/180;g.CC=0;g.position=this.QB.clone();g.ND=3;}}else{g=this.xI();}}g.iD=-i*1-3;g.position.z=g.iD;g.TC=0;this.LB.DD(g);}} eJ(){this.HD=false;var g=s as sB;g.EJ();g.kG();} PE( h){if(this.s.paused==false){this.vJ();var g=this.s as sB;if(g.OD&&this.FD&&!g.OE)g.lJ();}else{gD=-1;}} LE( h){var g=new EB(this.OB.x,this.OB.y);g=this.xG(g);g=h.jC(g);return h.LE(g);} sI(){this.FD=false;for(var g=0;g<this.LB.JC.length;g++ )this.LB.JC[g].position.z-= (2.5+1-DF)+1;EE.position.z+= (1-DF);this.iG();this.HD=false;this.PD=this.wG;this.gC.visible=false;} ZJ(){var g=this.s as sB;g.pB.visible=false;this.HD=false;this.FD=false;this.wG=this.PD;this.PD=0;if(this.gC!=null)this.qB(this.gC);this.gC=new iB(m.CB("broken"));this.v(this.gC);if(this.EE.ND>0&& ++this.JJ<=5){aB.HE((){g.uI(this.EE.ND);},2.0);}else{this.s.LD-- ;if(this.s.LD>0)aB.HE(g.yI,2.0);}this.IF.stop();this.IF=this.HF.play(true);this.hG=m.RF("crash");this.tI=this.hG.play();}var gD=-1; vJ(){var k=aB.elapsedTime;var h=1.0;if(gD==-1)gD=k;h=ZB.min(k-gD,1.0000)*40;gD=k;if(HD){this.GE-= (this.PD*h);var t=this.s.MD;this.s.MD=t+(this.LH*h);}this.LB.GK();this.iF+= (this.hF*h);this.IC.x=-(this.UF-this.OB.x)*3;this.IC.y=-(this.VF-this.OB.y)*3;if(this.IC.qG()>UD*0.7){this.IC.DK(UD*0.7);}this.IC.z=dE;this.QB=this.IC.clone();this.QB.z=rF;this.uJ();for(var o=0;o<this.LB.JC.length;o++ ){var g=this.LB.JC[o];g.position.z+= (PD*h);if(g.position.z>=1){if(g.fD&&g.cD==3)FD=true;if(g.aD!=null){this.RH=m.RF("swish");var BB=this.RH.play();}if(g.kC)HD=true;if(g.iD!=0)this.GE=g.iD;if(g.kC&&LE(g)){g.position.z=DF;EE=g;this.ZJ();}else{if(g.ND==3)(this.s as sB).OD=false;if(g.kC)this.sJ();if(g.tG){this.eJ();}else if(g.TC==0){this.LB.yJ(g);}else{g.position.z+= g.TC;}}}var i=this.IC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.aE(i);j=j.add(this.OB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.NC+= (g.CC*h);g.setScale(QD(g.position.z)*gH);}}if(this.PF!=null)this.s.progress=(this.GE+3)/(this.PF.iD+3);} aE( g){var h=new QC(g.x,g.y);h.x*= QD(g.z);h.y*= QD(g.z);return h;} QD( g){var h=rF;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} uJ(){if(XB==null)return;var l=2;var j=this.IC.clone();j.scale(l);var h=this.VC.transform(QD(j.z)*l,this.iF,this.aE(j));var i=this.VC.transform(QD(this.QB.z),this.iF,this.aE(this.QB));var k=this.aE(this.QB).add(this.OB);XB.PB.clear();XB.PB.beginPath();XB.PB.gG(k.x,k.y,this.VC.HH*QD(this.QB.z));XB.PB.closePath();XB.PB.PH(0xffcccccc,1);XB.PB.beginPath();for(var g=0;g<h.w.length;g+= 2){XB.PB.moveTo(h.w[g].x+this.OB.x,h.w[g].y+this.OB.y);XB.PB.lineTo(h.w[g+1].x+this.OB.x,h.w[g+1].y+this.OB.y);XB.PB.lineTo(i.w[g+1].x+this.OB.x,i.w[g+1].y+this.OB.y);XB.PB.lineTo(i.w[g].x+this.OB.x,i.w[g].y+this.OB.y);XB.PB.lineTo(h.w[g].x+this.OB.x,h.w[g].y+this.OB.y);}XB.PB.closePath();XB.PB.DJ(0xFF000000);}}class cE implements aH,ZH{var w;cE([ pointList]){this.w=(pointList!=null)?pointList:new List();}IH( g){if(g<w.length)this.w.removeAt(g);} LE( h){var k=this.w.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(w[g].y<h.y&&w[i].y>=h.y||w[i].y<h.y&&w[g].y>=h.y){if(w[g].x+(h.y-w[g].y)/(w[i].y-w[g].y)*(w[i].x-w[g].x)<h.x){j=!j;}}i=g;}return j;} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.w.length;var i=new List<QC>(j);for(var g=0;g<j;g++ ){var k=this.w[g].clone();k.scale(h);i[g]=k;}return new cE(i);} transform( l, k, o){var j=this.w.length;var i=new List<QC>(j);for(var g=0;g<j;g++ ){var h=this.w[g].clone();h.scale(l);h.FF+= k;i[g]=h.add(o);}return new cE(i);}}class bH extends cE{var tK;var xK;bH( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.tK=h;this.xK=g;zI();} get HH{return tK;} zI(){var g=new List<QC>();var h=0.0;var k=2*ZB.PI/xK;for(var j=0;j<xK;j++ ){var i=new QC(0,-tK);i.FF=h;g.add(i);h+= k;}this.w=g;}}abstract class aH{}abstract class ZH{}class tB extends AD{var vK=0;var zK=0;var BL=true;var CL=3;var DL=0.0;var EL;var FL;tB( h, g){EK(h,g);} EK( g, h){EL=g;FL=h;this.u(new n(n.gE,this));} get KE{return EL;} get nG{return FL;} start(){this.paused=false;this.u(new n(n.pD,this));} LJ(){this.u(new n(n.qD,this));}set progress( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;DL=g;this.u(new n(n.lD,this));} get progress{return DL;}set LD( g){if(g<0)g=0;CL=g;this.u(new n(n.SD,this));if(CL==0)this.LJ();} get LD{return CL;}set MD( g){if(g<0)g=0;vK=g;this.u(new n(n.oD,this));} get MD{return vK;} get CK{return vK.toDouble().round().toInt();}set level( g){if(g<0)g=0;zK=g;this.u(new n(n.nD,this));} get level{return zK;} YJ(){this.level+= 1;return this.level;}set paused( g){BL=g;this.u(new n(n.mD,this));} get paused{return BL;}}var EC;var m;var hE;var aB;var hH;var bC;var sD;var vB;const  tD="Russo One"; main(){EC=new ZD("Stage",mC.query('#stage'));hE=new nH();hE.oI(EC);aB=hE.UJ;hH=new ZB.Random();var g=WB.dG("images/Loading.png");g.then((h){bC=new iB(h);bC.uC=20;bC.vC=20;bC.x=400;bC.y=270;EC.v(bC);sD=new gI(bC,100,AF.BF);sD.FE("rotation",100.0*2.0*ZB.PI);aB.add(sD);vB=new cC();vB.UC=new EG("Arial",20,0xA0A0A0,zB:true);vB.width=240;vB.height=40;vB.text="... loading ...";vB.x=400-vB.LK/2;vB.y=320;vB.BH=false;EC.v(vB);iH();});} iH(){m=new qE();m.yB("barrier01","images/barrier01.png");m.yB("barrier02","images/barrier02.png");m.yB("barrier03","images/barrier03.png");m.yB("barrier04","images/barrier04.png");m.yB("barrier05","images/barrier05.png");m.yB("barrier06","images/barrier06.png");m.yB("barrier07","images/barrier07.png");m.yB("training01","images/training01.png");m.yB("training02","images/training02.png");m.yB("finish","images/finish.png");m.yB("broken","images/broken.png");m.pI("items","images/ItemTextureAtlas.json",nE.MG);m.EF("crash","sounds/crash.mp3");m.EF("swish","sounds/swish.mp3");m.EF("speedalizer","sounds/speedalizer.mp3");m.TB("DISPLAY_LEVEL","Level: {0}");m.TB("DISPLAY_LIVES","Ships:");m.TB("DISPLAY_SCORE","Score: {0}");m.TB("DISPLAY_TRAINING","Training");m.TB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");m.TB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");m.TB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");m.TB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");m.TB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");m.TB("MESSAGE_GAME_OVER","Game\nOver!");m.TB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");m.TB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");m.TB("GENscore","Score");m.TB("GENlevel","Level");m.TB("GENexitquery","Do you really want to quit the game?");m.TB("GENyes","Yes");m.TB("GENno","No");m.load().then((h){EC.qB(bC);EC.qB(vB);aB.remove(sD);var g=new sB(800,600);g.qI(EC);g.start();});}class kH{var JE;var ZE;kH(this.JE,this.ZE);}class vD{static final sE=new vD();var mM;vD(){mM=new List<NB>();} add( g){mM.add(g);} remove( h){var g=mM.indexOf(h);if(g!=-1)mM[g]=null;} u( j){var k=mM.length;var h=0;for(int g=0;g<k;g++ ){var i=mM[g];if(i!=null){j.DO=i.mG;j.EO=i.mG;j.yN=nC.zD;i.u(j);if(h!=g)mM[h]=i;h++ ;}}for(int g=k;g<mM.length;g++ )mM[h++ ]=mM[g];mM.length=h;}}class vH extends AB{var WL;vH( g):super(AB.rC,false){WL=g;} get JF=>false;}class p extends AB{static const  qC="click";static const  II="doubleClick";static const  eC="mouseDown";static const  XD="mouseUp";static const  wE="mouseMove";static const  BE="mouseOut";static const  XG="mouseOver";static const  XI="mouseWheel";static const  ZG="middleClick";static const  aI="middleMouseDown";static const  dI="middleMouseUp";static const  aG="rightClick";static const  eI="rightMouseDown";static const  hI="rightMouseUp";var gN,iN;var jN,lN;var NO;var zM;var MN;var AN;var CN;var RO;var SO;var TO;p( g,[ bubbles=false]):super(g,bubbles){YN(g,bubbles);} YN( g,[ bubbles=false]){super.YN(g,bubbles);gN=iN=0;jN=lN=0;NO=false;zM=false;MN=false;AN=false;CN=false;RO=0;SO=0;TO=0;}set UO( g){gN=g.x;iN=g.y;}set VO( g){jN=g.x;lN=g.y;} get NH=>jN; get OH=>lN; get SC=>NO; get altKey=>zM; get ctrlKey=>AN; get shiftKey=>CN; get bD=>RO;}class BD extends AB{static const  tE="keyDown";static const  OG="keyUp";var zM;var AN;var CN;var EN;var MN;var ON;var RN;var SN;BD( g,[ bubbles=false]):super(g,bubbles){YN(g,bubbles);} YN( g,[ bubbles=false]){super.YN(g,bubbles);zM=false;AN=false;CN=false;EN=false;MN=false;ON=0;RN=0;SN=0;} get altKey=>zM; get ctrlKey=>AN; get shiftKey=>CN; get charCode=>ON; get keyCode=>RN; get keyLocation=>SN;}class xF extends AB{static const  GI="textInput";var eL="";xF( g,[ bubbles=false]):super(g,bubbles){}}class xB extends AB{static const  LG="touchBegin";static const  PG="touchEnd";static const  RG="touchCancel";static const  WG="touchMove";static const  UI="touchOver";static const  VI="touchOut";var cN;var eN;var gN,iN;var jN,lN;var zM;var MN;var AN;var CN;var pN;var sN;var uN;xB( g,[ bubbles=false]):super(g,bubbles){YN(g,bubbles);} YN( g,[ bubbles=false]){super.YN(g,bubbles);cN=0;eN=false;gN=iN=0;jN=lN=0;zM=false;MN=false;AN=false;CN=false;pN=1.00;sN=0;uN=0;}set UO( g){gN=g.x;iN=g.y;}set VO( g){jN=g.x;lN=g.y;} get YE=>cN; get NH=>jN; get OH=>lN; get altKey=>zM; get ctrlKey=>AN; get shiftKey=>CN;}class RB{var jL; PJ( g){return jL!=null&&jL.containsKey(g);} addEventListener( g, h,[ useCapture=false]){oM(g).add(h,useCapture);} removeEventListener( g, h,[ useCapture=false]){oM(g).remove(h,useCapture);} u( g){fN(g,this,this,nC.zD);}yF get on=>new yF(this); fN( g, i, k, j){if(jL!=null){var h=jL[g.type];if(h!=null){g.DO=i;g.EO=k;g.yN=j;g.GO=false;g.IO=false;h.u(g);}}} oM( h){if(jL==null)jL=new Map<String,NB>();var g=jL[h];if(g==null)g=jL[h]=new NB(this,h);return g;}}abstract class cB extends q{var BJ=false;var BH=true;var mK=true;var tabIndex=0;BG get on=>new BG(this);}abstract class oC extends cB{var BM;var HM=true;var SM=true;oC(){BM=new List<q>();}pH get on=>new pH(this); v( g){if(g.parent==this){var h=BM.indexOf(g);BM.removeAt(h);BM.add(g);}else{nI(g,BM.length);}} nI( g, h){if(h<0&&h>BM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){BM.removeAt(BM.indexOf(g));if(h>BM.length)h-- ;BM.insertRange(h,1,g);}else{g.xJ();g.XO(this);BM.insertRange(h,1,g);g.u(new AB(AB.AI,true));if(this.XE!=null)YO(g,new AB(AB.NG));}} qB( h){var g=BM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");wJ(g);} wJ( g){if(g<0&&g>=BM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=BM[g];h.u(new AB(AB.RI,true));if(this.XE!=null)YO(h,new AB(AB.TI));h.XO(null);BM.removeAt(g);} pG( g){if(g<0&&g>=BM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return BM[g];} JD( g){return BM.indexOf(g);} QH( j, i){var h=JD(j);var g=JD(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");KK(h,g);} KK( h, g){var j=pG(h);var i=pG(g);BM[h]=i;BM[g]=j;} contains( g){for(;g!=null;g=g.HN)if(g==this)return true;return false;} jB( o,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.nK();if(BM.length==0)return super.jB(o,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var l=double.NEGATIVE_INFINITY;var k=double.NEGATIVE_INFINITY;var t=BM.length;for(int j=0;j<t;j++ ){WN.NF(BM[j].BO,o);var g=BM[j].jB(WN,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>l)l=g.right;if(g.bottom>k)k=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=l-h;returnRectangle.height=k-i;return returnRectangle;} HC( BB, DB){var l=null;for(int j=BM.length-1;j>=0;j-- ){var i=BM[j];if(i.visible){var g=i.BO;var o=BB-g.fB;var k=DB-g.gB;var FB=(g.d*o-g.c*k)/g.iC;var t=(g.a*k-g.b*o)/g.iC;var h=i.HC(FB,t);if(h!=null){if(h is cB)if(h.BH)return HM?h:this;l=this;}}}return l;} UB( i){for(int g=0;g<BM.length;g++ ){var h=BM[g];if(h.visible)i.JH(h);}} YO( g, j){g.u(j);if(g is oC){var i=new List<q>.from(g.BM);var k=i.length;for(int h=0;h<k;h++ )YO(i[h],j);}}}class AG{var target=null;var SC=false;var KF=0;var bD=0;var AH,CH;var yG,zG;AG(this.AH,this.CH,this.yG,this.zG);}class iE{static var JG=lB.rE;static var CI=false;static var LI=new RB();static  cG( i){var h=i;var g="auto";if(JG!=lB.rE)h=JG;switch (h){case lB.rE:g="auto";break;case lB.uE:g="default";break;case lB.vE:g="pointer";break;case lB.OI:g="move";break;case lB.QI:g="text";break;case lB.SI:g="wait";break;}if(CI)g="none";return g;}}class CD{static const  wH=0;static const  UG=1;static const  AE=2;static const  NI=3;static const  TG=4;}class jE{var rI;var AJ;var height;var TF;var width;var x;jE(this.x,this.width,this.height,this.rI,this.AJ,this.TF);}class iB extends q{var nB;var qJ;var LF;iB([this.nB=null,this.qJ="auto"]){LF=null;} jB( h,[ returnRectangle]){var g=(nB!=null)?nB.width:0;var i=(nB!=null)?nB.height:0;return CF(h,g,i,returnRectangle);} HC( g, h){if(nB!=null&&g>=0.0&&h>=0.0&&g<nB.width&&h<nB.height)return this;return null;} UB( g){if(nB!=null){if(LF==null)nB.UB(g);else nB.zJ(g,LF);}}}class zF{var PL;var hL;var wL;var CM;var KM;var QM;var XM;var aM;var dM;var jM;var qM;zF( g, h){PL=g;hL=h;} get MK=>hL; get name=>PL; get HJ=>wL; get IJ=>CM; get GJ=>KM; get FJ=>QM; get offsetX=>XM; get offsetY=>aM; get oJ=>dM; get nJ=>jM; get BK=>qM;}abstract class kE{ UB( g);}class IG extends q{var YL;IG(){YL=new HG();} get PB=>YL; jB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.nK();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} HC( g, h){return null;} UB( g){YL.UB(g);}}class AD extends oC{var YK=false;var nF=false;}class wD extends cB{var mF;var GH;var lG;var ME;var nF=true;var enabled=true;var pM;wD([this.mF,this.GH,this.lG,this.ME]){addEventListener(p.XG,DN);addEventListener(p.BE,DN);addEventListener(p.eC,DN);addEventListener(p.XD,DN);pM=this.mF;} jB( g,[ returnRectangle]){if(pM!=null){WN.NF(pM.BO,g);return pM.jB(WN,returnRectangle);}return super.jB(g,returnRectangle);} HC( k, l){if(this.ME!=null){var g=this.ME.BO;var h=k-g.fB;var i=l-g.gB;var o=(g.d*h-g.c*i)/g.iC;var j=(g.a*i-g.b*h)/g.iC;if(this.ME.HC(o,j)!=null)return this;}return null;} UB( g){if(pM!=null)g.JH(pM);} DN( g){if(g.type==p.BE){pM=mF;}else{pM=g.SC?lG:GH;}}}class HG{var UL;HG(){UL=new List<sH>();}clear()=>UL.clear();beginPath()=>UL.add(new sH("beginPath"));closePath()=>UL.add(new sH("closePath"));moveTo( h, g)=>UL.add(new sH("moveTo",[h,g]));lineTo( h, g)=>UL.add(new sH("lineTo",[h,g]));arcTo( k, i, g, h, j)=>UL.add(new sH("arcTo",[k,i,g,h,j]));quadraticCurveTo( j, i, g, h)=>UL.add(new sH("quadraticCurveTo",[j,i,g,h]));bezierCurveTo( g, h, l, j, i, k)=>UL.add(new sH("bezierCurveTo",[g,h,l,j,i,k]));arc( i, j, h, k, g, l)=>UL.add(new sH("arc",[i,j,h,k,g,l]));rect( i, g, h, j)=>UL.add(new sH("rect",[i,g,h,j]));PH( g,[ width=1, joints=oH.BI, caps=rH.BI])=>UL.add(new sH("strokeColor",[zE(g),width,joints,caps]));DJ( g)=>UL.add(new sH("fillColor",[zE(g)]));gG( i, g, h){UL.add(new sH("moveTo",[i+h,g]));UL.add(new sH("arc",[i,g,h,0,ZB.PI*2,false]));} UB( k){var h=k.context;h.save();for(var j in UL){var g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].hO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].iO(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];GB i=g[0].jO;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].dK(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].eK(h);GB i=g[0].jO;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}class sH{var name;var arguments;sH(this.name,[this.arguments]);}class rH{static const  BI="round";}class oH{static const  BI="round";}class GG{var JL;var SL;var kL;var xL;GG.oK( i, g, h, j){JL=0;SL=new HB(i,g,h,j);} UB( i){var g=i.context;g.beginPath();switch (JL){case 0:g.rect(SL.x,SL.y,SL.width,SL.height);break;case 1:g.arc(kL.x,kL.y,kL.HH,0,ZB.PI*2.0,false);break;case 2:g.moveTo(xL[0].x,xL[0].y);for(int h=1;h<xL.length;h++ )g.lineTo(xL[h].x,xL[h].y);break;}g.clip();}}class FG extends yF{FG( g):super(g);}class pH extends BG{pH( g):super(g);}class BG extends FG{BG( g):super(g); get mouseOut=>this[p.BE]; get mouseMove=>this[p.wE]; get mouseDown=>this[p.eC]; get mouseUp=>this[p.XD]; get mouseWheel=>this[p.XI]; get touchMove=>this[xB.WG]; get touchEnd=>this[xB.PG]; get touchCancel=>this[xB.RG]; get keyUp=>this[BD.OG]; get keyDown=>this[BD.tE];}class tH extends cB{var width;var height;tH(this.width,this.height); jB( g,[ returnRectangle]){return CF(g,width,height,returnRectangle);} HC( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} UB( g){}}abstract class SB{static  yH( g){var h=xD.iI;if(h=="WebAudioApi")return mE.yH(g);if(h=="AudioElement")return lE.yH(g);return DG.yH(g);} get length; play([ loop=false, soundTransform]);static var fC;static  bG( g){if(fC==null){fC=new List<String>();var i=new mC.AudioElement();var h=["maybe","probably"];if(h.indexOf(i.canPlayType("audio/ogg",""))!=-1)fC.add("ogg");if(h.indexOf(i.canPlayType("audio/mp3",""))!=-1)fC.add("mp3");if(h.indexOf(i.canPlayType("audio/wav",""))!=-1)fC.add("wav");}var k=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,ignoreCase:true);var j=k.firstMatch(g);if(j==null)throw new ArgumentError("Unsupported file extension.");var l=j.group(1).toLowerCase();if(fC.indexOf(l)==-1&&fC.length>0)g="${g.substring(0,g.length-3)}${fC[0]}";return g;}}abstract class RC extends RB{ set WE( g); stop();}class dB{var volume;var pJ;var hK=1;var iK=0;var lK=1;var kK=0;dB([this.volume=1,this.pJ=0]);}class xD{static var CE;static  get DE{if(CE==null){try {CE=new VH.AudioContext();}catch (g){CE=null;}}return CE;}static var YD;static  get iI{if(YD==null){YD=(DE!=null)?"WebAudioApi":"AudioElement";var g=mC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))YD="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))YD="Mock";}return YD;}}class lE extends SB{var gL;var yL;var RM;lE(){RM=new List<uD>();gL=new mC.AudioElement();gL.on.ended.add(uM);yL=new List<mC.AudioElement>();yL.add(gL);mC.document.body.children.add(gL);}static  yH( l){var g=new lE();var j=new Completer<SB>();var i;var h;i=(k){g.gL.on.canPlayThrough.remove(i);g.gL.on.error.remove(h);j.complete(g);};h=(k){g.gL.on.canPlayThrough.remove(i);g.gL.on.error.remove(h);j.completeException("Failed to load audio.");};g.gL.src=SB.bG(l);g.gL.on.canPlayThrough.add(i);g.gL.on.error.add(h);g.gL.load();return j.future;} get length{return gL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new uD(this,loop,soundTransform);} IN( h){var g;if(yL.length==0){g=gL.clone(true);g.on.ended.add(uM);}else{g=yL.removeAt(0);}RM.add(h);return g;} OO( g){var h=g.gL;var i=RM.indexOf(g);RM.removeAt(i);yL.add(h);if(gL.currentTime>0&&gL.ended==false)gL.currentTime=0;} uM(j){var i=j.target;var g=null;for(int h=0;h<RM.length&&g==null;h++ )if(RM[h].gL==i)g=RM[h];if(g!=null)g.stop();}}class uD extends RC{var sL;var gL;var bL;var uL;uD( g, i, h){sL=g;bL=i;uL=h;gL=g.IN(this);gL.loop=bL;this.WE=h;gL.play();} set WE( g){uL=g;if(gL!=null)gL.volume=(uL!=null)?uL.volume:1;} stop(){if(gL!=null){if(gL.ended==false)gL.pause();sL.OO(this);gL=null;}}}class mE extends SB{var aL;mE(){if(xD.DE==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  yH( t){var i=new mE();var g=new Completer<SB>();var h=new mC.HttpRequest(); l( k){i.aL=k;if(g.future.isComplete==false)g.complete(i);} DB(MB){if(g.future.isComplete==false)g.completeException("Failed to decode audio.");} FB(BB){var o=xD.DE;o.decodeAudioData(h.response,l,DB);} j(BB){if(g.future.isComplete==false)g.completeException("Failed to load audio.");}h.open('GET',SB.bG(t),true);h.responseType='arraybuffer';h.on.load.add(FB);h.on.error.add(j);h.send();return g.future;} get length{return aL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new TK(this,loop,soundTransform);}}class TK extends RC{var oL;var uL;var bL;var YM;var fM;TK( j, h, i){oL=j;bL=h;uL=i;var g=xD.DE;YM=g.createGain();YM.connect(g.destination,0,0);YM.gain.value=(uL!=null)?ZB.pow(uL.volume,2):1;fM=g.createBufferSource();fM.buffer=oL.aL;fM.loop=h;fM.connect(YM,0,0);fM.start(0);} set WE( g){uL=g;YM.gain.value=(uL!=null)?ZB.pow(uL.volume,2):1;} stop(){fM.stop(0);}}class DG extends SB{DG(){}static  yH( i){var h=new DG();var g=new Completer<SB>();mC.window.setTimeout(()=>g.complete(h),1);return g.future;} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new SK(this,loop,soundTransform);}}class SK extends RC{var bL;var uL;SK( i, h, g){bL=h;uL=g;} set WE( g){uL=g;} stop(){}}class jH{static const  DI="pixel";}class cC extends cB{var eL="";var nL=0x000000;var IM=null;var VM=mH.HI;var gM=jH.DI;var JL=lH.xH;var tM=false;var vM=false;var xM=0x000000;var BN=false;var GN=0x000000;var JN=0;var NN=0;var QN;var TN;var UN=true;var VN=100;var XN=100;var aN=null;var XL=null;cC(){IM=new EG("Arial",12,0x000000);QN=new List<String>();TN=new List<jE>();} get type=>JL; get width=>VN; get height=>XN; set text( g){eL=g;UN=true;} set xC( g){nL=g;UN=true;} set UC( g){IM=g;nL=IM.color;UN=true;} set wordWrap( g){tM=g;UN=true;} set width( g){VN=g;UN=true;} set height( g){XN=g;UN=true;} get LK{bO();return JN;} jB( g,[ returnRectangle]){return CF(g,VN,XN,returnRectangle);} HC( g, h){if(g>=0&&h>=0&&g<VN&&h<XN)return this;return null;} UB( g){bO();g.XL.drawImage(aN,0.0,0.0);} fO(){QN.clear();TN.clear();if(tM==false){QN.add(eL);}else{var g=new StringBuffer();var i;var h;for(String t in eL.replaceAll('\r','').split('\n')){for(String j in t.split(' ')){i=g.length;g.add((i>0)?" ${j}":j);h=g.toString();if(XL.measureText(h).width>VN){if(i>0)h=h.substring(0,i);else j="";QN.add(h);g.clear();g.add(j);}}if(g.isEmpty==false){QN.add(g.toString());g.clear();}}}JN=0;NN=0;for(String h in QN){var l=XL.measureText(h);var o=0;if(IM.align==mB.yD||IM.align==mB.KI)o=(VN-l.width)/2;if(IM.align==mB.AE||IM.align==mB.FI)o=VN-l.width;var k=new jE(o,l.width,IM.size,0,0,0);TN.add(k);JN=ZB.max(JN,k.width);NN=NN+k.height;}} bO(){if(UN){UN=false;var i=VN.ceil().toInt();var j=XN.ceil().toInt();if(aN==null){aN=new mC.CanvasElement(width:i,height:j);XL=aN.context2d;}if(aN.width!=i)aN.width=i;if(aN.height!=j)aN.height=j;var g=new StringBuffer();g.add(IM.vG?"italic ":"normal ");g.add("normal ");g.add(IM.zB?"bold ":"normal ");g.add("${IM.size}px ");g.add("${IM.font},sans-serif");XL.font=g.toString();XL.textAlign="start";XL.textBaseline="top";XL.fillStyle=WD(nL);fO();if(vM){XL.fillStyle=WD(xM);XL.fillRect(0,0,VN,XN);}else{XL.clearRect(0,0,VN,XN);}var k=0;for(int h=0;h<QN.length;h++ ){var l=TN[h];XL.fillStyle=WD(nL);XL.fillText(QN[h],l.x,k);k+= l.height;}if(BN){XL.strokeStyle=WD(GN);XL.lineWidth=1;XL.strokeRect(0,0,VN,XN);}}}}class nC{static const  KG=1;static const  zD=2;static const  JI=3;}class lH{static const  xH="dynamic";}class EG{var font;var size;var color;var zB;var vG;var NK;var align;var VJ;var AK;var RJ;var TF;var letterSpacing=0;var WK=0;var XK=false;var gK=false;EG(this.font,this.size,this.color,{this.zB: false,this.vG: false,this.NK: false,this.align: "left",this.VJ: 0,this.AK: 0,this.RJ: 0,this.TF: 0});}class yF{var LI;yF( g){LI=g;} operator[]( g){return LI.oM(g);}}class AB{static const  AI="added";static const  NG="addedToStage";static const  rC="enterFrame";static const  RI="removed";static const  TI="removedFromStage";var JL;var vN;var yN;var DO;var EO;var GO;var IO;AB( g,[ bubbles=false]){YN(g,bubbles);} YN( g,[ bubbles=false]){JL=g;vN=bubbles;yN=nC.zD;DO=null;EO=null;GO=false;IO=false;} get kF=>GO; get JK=>IO; get type=>JL; get eventPhase=>yN; get bubbles=>vN; get JF=>true; get target=>DO;}class VD{static const  rE="auto";static const  EI="stop";static const  QG="once";}class hB{var XL;var pL;var EM;var NM;hB.pK( j,[ matrix]){XL=j;pL=new List<GB>(100);EM=new List<double>(100);for(int h=0;h<100;h++ ){pL[h]=new GB.qK();EM[h]=1.0;}NM=0;if(matrix!=null)pL[0].MF(matrix);var g=pL[0];var i=EM[0];XL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);XL.globalAlpha=i;} get context=>XL; reset(){NM=0;var g=pL[0];var h=EM[0];XL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);XL.globalAlpha=h;XL.clearRect(0,0,XL.canvas.width,XL.canvas.height);} JH( h){var i=NM;var j=NM+1;var l=pL[i];var g=pL[j];var o=EM[i];var k=EM[j]=h.wM*o;g.NF(h.BO,l);XL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);XL.globalAlpha=k;NM=j;if(h.mask==null){h.UB(this);}else{XL.save();h.mask.UB(this);h.UB(this);XL.restore();}NM=i;}}class nH{var NL;var cL;var lL;var JM;var UM;nH(){NL=new oE();cL=new List<ZD>();lL=double.NAN;JM=vD.sE;UM=new vH(0);mC.window.requestAnimationFrame(KN);} get UJ=>NL; KN( g){mC.window.requestAnimationFrame(KN);if(lL.isNaN)lL=g;if(lL>g)lL=g;var j=g-lL;var i=j/1000.0;if(j>=1){lL=g;UM.WL=i;JM.u(UM);NL.ED(i);for(int h=0;h<cL.length;h++ ){var k=cL[h];k.WJ();}}} oI( g){cL.add(g);}}class GB{var KL,LL,ML,OL,RL,TL;var dL;GB( g, j, i, h, k, l):KL=g,LL=j,ML=i,OL=h,RL=k,TL=l,dL=g*h-j*i;GB.qK():KL=1.0,LL=0.0,ML=0.0,OL=1.0,RL=0.0,TL=0.0,dL=1.0; clone(){return new GB(KL,LL,ML,OL,RL,TL);} get a=>KL; get b=>LL; get c=>ML; get d=>OL; get fB=>RL; get gB=>TL; get iC=>dL; UH( g){return new EB(g.x*KL+g.y*ML+RL,g.x*LL+g.y*OL+TL);} concat( g){var o=KL;var DB=LL;var FB=ML;var BB=OL;var l=RL;var t=TL;var YB=dL;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var bB=g.fB;var MB=g.gB;var kB=g.iC;KL=(o*j+DB*i);LL=(o*k+DB*h);ML=(FB*j+BB*i);OL=(FB*k+BB*h);RL=(l*j+t*i+bB);TL=(l*k+t*h+MB);dL=(YB*kB);} sG(){KL=1.0;LL=0.0;ML=0.0;OL=1.0;RL=0.0;TL=0.0;dL=1.0;} TJ(){var j=KL;var o=LL;var l=ML;var k=OL;var h=RL;var i=TL;var g=dL;KL=(k/g);LL=-(o/g);ML=-(l/g);OL=(j/g);RL=-(KL*h+ML*i);TL=-(LL*h+OL*i);dL=(1.0/g);} MH( g, j, i, h, k, l){KL=g;LL=j;ML=i;OL=h;RL=k;TL=l;dL=(g*h-j*i);} MF( g){KL=g.a;LL=g.b;ML=g.c;OL=g.d;RL=g.fB;TL=g.gB;dL=g.iC;} NF( h, g){var t=h.a;var FB=h.b;var MB=h.c;var DB=h.d;var o=h.fB;var BB=h.gB;var bB=h.iC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var kB=g.fB;var YB=g.gB;var lC=g.iC;KL=(t*k+FB*j);LL=(t*l+FB*i);ML=(MB*k+DB*j);OL=(MB*l+DB*i);RL=(o*k+BB*j+kB);TL=(o*l+BB*i+YB);dL=(bB*lC);}}class qH{qH();}class HB{var x;var y;var width;var height;HB(this.x,this.y,this.width,this.height);HB.nK():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new EB(this.width,this.height); set size( g){this.width=g.x;this.height=g.y;} clone()=>new HB(this.x,this.y,this.width,this.height); contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); MF( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;}}class CG{static const  HI="none";static const  MI="touchPoint";}class qE{var VL;var qL;var LM;var WM;var cM;var iM;var nM;qE(){VL=new Map<String,WB>();qL=new Map<String,SB>();LM=new Map<String,wB>();WM=new Map<String,String>();cM=null;iM=0;nM=0;} yB( h, i){var g=WB.dG(i);iM++ ;g.then(( j){VL[h]=j;iM-- ;AO();});g.handleException((k){nM++ ;iM-- ;AO();});} EF( h, i){var g=SB.yH(i);iM++ ;g.then(( j){qL[h]=j;iM-- ;AO();});g.handleException((k){nM++ ;iM-- ;AO();});} pI( i, k, h){var g=wB.WI(k,h);iM++ ;g.then(( j){LM[i]=j;iM-- ;AO();});g.handleException((l){nM++ ;iM-- ;AO();});} TB( h, g){WM[h]=g;} load(){cM=new Completer<qE>();AO();return cM.future;} CB( g){if(VL.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return VL[g];} RF( g){if(qL.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return qL[g];} KB( g){if(LM.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return LM[g];} OJ( g){if(WM.containsKey(g)==false)return "[[${g}]]";return WM[g];}AO(){if(cM!=null&&iM==0){if(nM==0)cM.complete(this);else cM.completeException(this);}}}class uH{var name;var DC;var SH;uH(this.name,this.DC,this.SH);}class nE{static const  zH="json";static const  MG="jsonarray";}class pE implements dC{var ZL=0.0;var rL=0.0;var DM=1;var PM;pE( g, h){PM=g;rL=ZB.max(h,0.0001);} ED( h){var g=ZL+h;while (g>=rL&&DM>0){ZL=rL;DM-- ;PM();g-= rL;}if(DM==0)return false;ZL=g;return true;} get currentTime=>ZL;}abstract class dC{ ED( g);}class mB{static const  yD="center";static const  FI="end";static const  KI="justify";static const  UG="left";static const  AE="right";}class wB{var QL;var tL;wB(){QL=new mC.ImageElement();tL=new List<zF>();}static  WI( t, YB){var o=new Completer<wB>();var i=new wB();switch (YB){case nE.zH:case nE.MG:var k=new mC.HttpRequest();k.open('GET',t,true);k.on.load.add((kB){ BB( l, g){var FB=lI(l);var h=new zF(FB,i);h.wL=g["frame"]["x"].toInt();h.CM=g["frame"]["y"].toInt();h.KM=g["frame"]["w"].toInt();h.QM=g["frame"]["h"].toInt();h.XM=g["spriteSourceSize"]["x"].toInt();h.aM=g["spriteSourceSize"]["y"].toInt();h.dM=g["sourceSize"]["w"].toInt();h.jM=g["sourceSize"]["h"].toInt();h.qM=g["rotated"] as bool;i.tL.add(h);}var DB=RK.JSON.parse(k.responseText);var j=DB["frames"];var MB=DB["meta"];if(j is List)for(var g in j)BB(g["filename"],g);if(j is Map)for(String l in j.keys)BB(l,j[l]);i.QL.on.load.add((bB)=>o.complete(i));i.QL.on.error.add((bB)=>o.completeException("Failed to load image."));i.QL.src=mI(t,MB["image"]);});k.on.error.add((kB)=>o.completeException("Failed to load json file."));k.send();break;}return o.future;} get QJ=>QL; CB( i){var h;for(int g=0;g<tL.length&&h==null;g++ )if(tL[g].name==i)h=new WB.sK(tL[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;}static  lI( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,ignoreCase:true);var i=h.firstMatch(g);return i.group(1);}static  mI( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,ignoreCase:true);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";}}abstract class q extends RB implements kE{var AM=0.0;var GM=0.0;var OM=0.0;var TM=0.0;var ZM=1.0;var eM=1.0;var kM=0.0;var rM;var sM;var wM=1.0;var yM=true;var PL="";var HN=null;var mask;var WN;var ZN;q(){rM=new GB.qK();sM=true;WN=new GB.qK();ZN=new GB.qK();} get x=>AM; get y=>GM; get uC=>OM; get vC=>TM; get WC=>ZM; get XC=>eM; get NC=>kM; get alpha=>wM; get visible=>yM; get name=>PL; get parent=>HN;FG get on=>new FG(this); get root{var g=this;while (g.HN!=null)g=g.HN;return g;} get XE{var g=this.root;if(g is ZD)return g;return null;} set x( g){AM=g;sM=true;} set y( g){GM=g;sM=true;} set uC( g){OM=g;sM=true;} set vC( g){TM=g;sM=true;} set WC( g){ZM=g;sM=true;} set XC( g){eM=g;sM=true;} set NC( g){kM=g;sM=true;} set alpha( g){wM=g;sM=true;} set visible( g){yM=g;sM=true;} get width=>jB(BO).width; get height=>jB(BO).height; set width( h){this.WC=1;var g=this.width;this.WC=(g!=0.0)?h/g:1.0;} set height( h){this.XC=1;var g=this.height;this.XC=(g!=0.0)?h/g:1.0;} qI( g){g.v(this);} xJ(){if(HN!=null)HN.qB(this);} get BO{if(sM){sM=false;if(kM==0.0){rM.MH(ZM,0.0,0.0,eM,AM-OM*ZM,GM-TM*eM);}else{var g=ZB.cos(kM);var h=ZB.sin(kM);var i=ZM*g;var l=ZM*h;var k=-eM*h;var j=eM*g;var o=AM-OM*i-TM*k;var t=GM-OM*l-TM*j;rM.MH(i,l,k,j,o,t);}}return rM;} jB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.nK();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} HC( g, h){if(jB(ZN).contains(g,h))return this;return null;} xG( h){WN.sG();for(q g=this;g!=null;g=g.HN)WN.concat(g.BO);return WN.UH(h);} jC( h){WN.sG();for(q g=this;g!=null;g=g.HN)WN.concat(g.BO);WN.TJ();return WN.UH(h);} u( h){var g=null;if(h.JF||h.bubbles)for(q j=HN;j!=null;j=j.HN)if(j.PJ(h.type)){if(g==null)g=new List<q>();g.add(j);}if(h.JF&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.kF==false)g[i].fN(h,this,g[i],nC.KG);if(h.kF==false)fN(h,this,this,nC.zD);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.kF==false)g[i].fN(h,this,g[i],nC.JI);} XO( h){for(var g=h;g!=null;g=g.HN)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");HN=h;} UB( g);}class oE implements dC{var iL;var vL;var FM;oE(){FM=0.0;iL=new List<dC>();vL=0;} get elapsedTime=>FM; add( g){if(g==null)return;if(vL>=iL.length)iL.add(g);else iL[vL]=g;vL++ ;} remove( h){if(h==null)return;for(int g=0;g<vL;g++ )if(iL[g]==h)iL[g]=null;} HE( h, i){var g=new pE(h,i);add(g);return g;} ED( j){FM+= j;var k=vL;var h=0;for(int g=0;g<k;g++ ){var i=iL[g];if(i!=null&&i.ED(j)){if(h!=g)iL[h]=i;h++ ;}}for(int g=k;g<vL;g++ )iL[h++ ]=iL[g];for(int g=h;g<vL;g++ )iL[g]=null;vL=h;return true;}}class mH{static const  HI="none";}class lB{static const  rE="auto";static const  uE="arrow";static const  vE="button";static const  OI="hand";static const  QI="ibeam";static const  SI="wait";}class EB{var x;var y;EB(this.x,this.y);EB.nK():this(0,0);static  bI( g, h)=>new EB(g*ZB.cos(h),-g*ZB.sin(h)); get length=>ZB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new EB(this.x+g.x,this.y+g.y); clone()=>new EB(this.x,this.y); MF( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class WB implements kE{var fL;var mL;var zL;var MM;var XL;var bM;var hM;var lM;var wL;var CM;var KM;var QM;WB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){fL=g;mL=h;zL=transparent;var i=new mC.CanvasElement(width:fL,height:mL);XL=i.context2d;XL.fillStyle=zL?zE(fillColor):WD(fillColor);XL.fillRect(0,0,g,h);MM=i;bM=0;}WB.rK( g){fL=g.naturalWidth;mL=g.naturalHeight;zL=true;MM=g;bM=0;}WB.sK( g){fL=g.oJ;mL=g.nJ;zL=true;MM=g.MK.QJ;bM=g.BK?2:1;hM=g.offsetX.toDouble();lM=g.offsetY.toDouble();wL=g.HJ.toDouble();CM=g.IJ.toDouble();KM=g.GJ.toDouble();QM=g.FJ.toDouble();}static  dG( i){var h=new Completer<WB>();var g=new mC.ImageElement();g.on.load.add((j)=>h.complete(new WB.rK(g)));g.on.error.add((j)=>h.completeException("Failed to load image."));g.src=i;return h.future;} get width=>fL; get height=>mL; clone(){var g=new WB(fL,mL,true,0);g.CJ(this);return g;} CJ( h,[ matrix=null]){var g=gO();var i=new hB.pK(g,matrix);h.UB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} NJ( i, h){var g=gO().getImageData(i,h,1,1).data;if(kI){return (g[0]<<16)+(g[1]<<8)+(g[2]<<0)+(g[3]<<24);}else{return (g[3]<<16)+(g[2]<<8)+(g[1]<<0)+(g[0]<<24);}} UB( g){switch (bM){case 0:g.context.drawImage(MM,0.0,0.0);break;case 1:g.context.drawImage(MM,wL,CM,KM,QM,hM,lM,KM,QM);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,hM,lM+QM);g.context.drawImage(MM,wL,CM,QM,KM,0.0,0.0,QM,KM);break;}} zJ( bB, g){if(g.width<=0.0||g.height<=0.0)return;switch (bM){case 0:bB.context.drawImage(MM,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=wL;double h=CM;double DB=j+KM;double FB=h+QM;double l=wL-hM+g.x;double o=CM-lM+g.y;double YB=l+g.width;double MB=o+g.height;double BB=(j>l)?j:l;double t=(h>o)?h:o;double kB=(DB<YB)?DB:YB;double oF=(FB<MB)?FB:MB;double pF=hM-j+BB;double lC=lM-h+t;double k=kB-BB;double i=oF-t;if(k>0.0&&i>0.0){bB.context.drawImage(MM,BB,t,k,i,pF,lC,k,i);}break;case 2:double j=wL;double h=CM;double DB=j+QM;double FB=h+KM;double l=wL+lM-g.y+QM-g.height;double o=CM-hM+g.x;double YB=l+g.height;double MB=o+g.width;double BB=(j>l)?j:l;double t=(h>o)?h:o;double kB=(DB<YB)?DB:YB;double oF=(FB<MB)?FB:MB;double pF=hM-h+t;double lC=lM+DB-kB;double k=oF-t;double i=kB-BB;if(k>0.0&&i>0.0){bB.context.transform(0.0,-1.0,1.0,0.0,pF,lC+i);bB.context.drawImage(MM,BB,t,i,k,0.0,0.0,i,k);}break;}} gO(){if(XL==null){var g=new mC.CanvasElement(width:fL,height:mL);XL=g.context2d;switch (bM){case 0:XL.drawImage(MM,0,0);break;case 1:XL.drawImage(MM,wL,CM,KM,QM,hM,lM,KM,QM);break;case 2:XL.setTransform(0.0,-1.0,1.0,0.0,hM,lM+QM);XL.drawImage(MM,wL,CM,QM,KM,0.0,0.0,QM,KM);XL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}MM=g;bM=0;}return XL;}}typedef  pC(event); WD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class SG{static var VG=false;static var xE=false;static var yE=0;static var ZI=CG.HI;static var LI=new RB();static cI(){if(VG==false){VG=true;var g=mC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){xE=true;yE=10;}if(g.contains("Android")){xE=true;yE=10;}if(g.contains("IEMobile")){xE=true;yE=10;}}}static  get jI{cI();return ZI;}}class NB{var LI;var LN;var PN;NB( h, g){LI=h;LN=g;PN=new List<kH>();} get mG=>LI; add( h,[ useCapture=false]){for(int g=0;g<PN.length;g++ )if(PN[g].JE==h&&PN[g].ZE==useCapture)return;if(LN==AB.rC&&PN.length==0)vD.sE.add(this);PN.add(new kH(h,useCapture));} remove( h,[ useCapture=false]){for(int g=0;g<PN.length;g++ ){if(PN[g].JE==h&&PN[g].ZE==useCapture){PN=new List<kH>.from(PN);PN.removeAt(g);if(LN==AB.rC&&PN.length==0)vD.sE.remove(this);break;}}} operator+( g){this.add(g,false);} operator-( g){this.remove(g,false);} u( h){for(int g=0;g<PN.length;g++ )if(h.eventPhase!=nC.KG||PN[g].ZE)if(h.JK==false)PN[g].JE(h);}}class YG{static var YI=0;var YE=YI++ ;var target=null;var UE=false;YG(this.target,this.UE);} zE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class AF{static  BF( g){return g;}}class gI implements dC{var bN;var dN;var hN;var kN;var mN;var nN;var rL;var ZL;var qN;var tN;var xN;gI( g, h,[ transitionFunction( ratio)]){bN=g;dN=(transitionFunction!=null)?transitionFunction:AF.BF;ZL=0.0;rL=ZB.max(0.0001,h);qN=0.0;tN=false;xN=false;hN=new List<uH>();} FE( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(bN!=null&&xN==false)hN.add(new uH(g,0.0,h));} moveTo( h, g){FE('x',h);FE('y',g);} ED( l){if(ZL<rL||xN==false){ZL=ZL+l;if(ZL>rL)ZL=rL;if(ZL>=0.0){if(xN==false){xN=true;for(int i=0;i<hN.length;i++ ){var g=hN[i];switch (g.name){case 'x':g.DC=bN.x;break;case 'y':g.DC=bN.y;break;case 'pivotX':g.DC=bN.uC;break;case 'pivotY':g.DC=bN.vC;break;case 'scaleX':g.DC=bN.WC;break;case 'scaleY':g.DC=bN.XC;break;case 'rotation':g.DC=bN.NC;break;case 'alpha':g.DC=bN.alpha;break;}}if(kN!=null)kN();}var j=ZL/rL;var k=dN(j);for(int i=0;i<hN.length;i++ ){var g=hN[i];var h=g.DC+k*(g.SH-g.DC);h=tN?h.round():h;switch (g.name){case 'x':bN.x=h;break;case 'y':bN.y=h;break;case 'pivotX':bN.uC=h;break;case 'pivotY':bN.vC=h;break;case 'scaleX':bN.WC=h;break;case 'scaleY':bN.XC=h;break;case 'rotation':bN.NC=h;break;case 'alpha':bN.alpha=h;break;}}if(mN!=null)mN();if(nN!=null&&ZL==rL)nN();}}return ZL<rL;} get currentTime=>ZL; get isComplete=>ZL>=rL;} fI(){var g=new mC.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;}class ZD extends oC{var aN;var XL;var oN;var rN;var wN;var zN;var CO;var FO;var HO;var JO;var KO;var LO;var MO;var PO;var QO;ZD( h, g){PL=h;aN=g;aN.focus();XL=g.context2d;rN=new hB.pK(XL);wN=VD.rE;zN=lB.uE;iE.LI.addEventListener("mouseCursorChanged",WO);HO=[new AG(p.eC,p.XD,p.qC,p.II),new AG(p.aI,p.dI,p.ZG,p.ZG),new AG(p.eI,p.hI,p.aG,p.aG)];FO=null;CO=new EB(0,0);KO=new p(p.qC,true);PO=DN;aN.on..mouseDown.add(PO)..mouseUp.add(PO)..mouseMove.add(PO)..mouseOut.add(PO)..mouseWheel.add(PO);JO=new Map<int,YG>();MO=new xB(xB.LG,true);QO=ZO;SG.LI.addEventListener("inputModeChanged",aO);aO(null);LO=new BD(BD.tE,true);aN.on.keyDown.add(cO);aN.on.keyUp.add(cO);aN.on.keyPress.add(dO);} get focus=>oN; eO(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){eO();} set y( g){eO();} set uC( g){eO();} set vC( g){eO();} set WC( g){eO();} set XC( g){eO();} set NC( g){eO();} set alpha( g){eO();} set width( g){eO();} set height( g){eO();} WJ(){if(wN==VD.rE||wN==VD.QG){rN.reset();UB(rN);if(wN==VD.QG)wN=VD.EI;}} WO( g){aN.style.cursor=iE.cG(zN);} DN( j){j.preventDefault();var MB=aN.getBoundingClientRect();var t=new Date.now().millisecondsSinceEpoch;var DB=j.button;var h=null;var i=new EB(j.clientX-MB.left,j.clientY-MB.top);var o=null;if(DB<0||DB>2)return;if(j.type=="mousemove"&&CO.equals(i))return;var g=HO[DB];CO=i;if(j.type!="mouseout")h=HC(i.x,i.y) as cB;var k=lB.uE;if(h is AD)if(h.nF)k=lB.vE;if(h is wD)if(h.nF)k=lB.vE;if(zN!=k){zN=k;aN.style.cursor=iE.cG(k);}if(FO!=null&&FO!=h){FO.u(KO..YN(p.BE,true)..UO=(FO.XE!=null)?FO.jC(i):new EB.nK()..VO=i..NO=g.SC);FO=null;}if(h!=null&&h!=FO){h.u(KO..YN(p.XG,true)..UO=h.jC(i)..VO=i..NO=g.SC);FO=h;}var l=null;var BB=false;var FB=false;if(j.type=="mousedown"){l=g.AH;if(h!=g.target||t>g.KF+500)g.bD=0;g.SC=true;g.target=h;g.KF=t;g.bD++ ;}if(j.type=="mouseup"){l=g.CH;g.SC=false;BB=(g.target==h);FB=BB&&g.bD.isEven&&(t<g.KF+500);}if(j.type=="mousemove"){l=p.wE;}if(l!=null&&h!=null){o=h.jC(i);h.u(KO..YN(l,true)..UO=o..VO=i..NO=g.SC..RO=g.bD);if(BB){if(FB&&h.BJ){h.u(KO..YN(g.zG,true)..UO=o..VO=i..NO=g.SC);}else{h.u(KO..YN(g.yG,true)..UO=o..VO=i..NO=g.SC);}}}} aO( g){aN.on..touchStart.remove(QO)..touchEnd.remove(QO)..touchMove.remove(QO)..touchEnter.remove(QO)..touchLeave.remove(QO)..touchCancel.remove(QO);if(SG.jI==CG.MI){aN.on..touchStart.add(QO)..touchEnd.add(QO)..touchMove.add(QO)..touchEnter.add(QO)..touchLeave.add(QO)..touchCancel.add(QO);}} ZO( j){j.preventDefault();var t=aN.getBoundingClientRect();for(var o in j.changedTouches){var l=o.identifier;var h=null;var i=new EB(o.clientX-t.left,o.clientY-t.top);var BB=null;h=HC(i.x,i.y) as cB;var g=JO.containsKey(l)?JO[l]:new YG(h,JO.length==0);if(g.target!=null&&g.target!=h){g.target.u(MO..YN(xB.VI,true)..UO=(g.target.XE!=null)?g.target.jC(i):new EB.nK()..VO=i..cN=g.YE..eN=g.UE);g.target=null;}if(h!=null&&h!=g.target){h.u(MO..YN(xB.UI,true)..UO=h.jC(i)..VO=i..cN=g.YE..eN=g.UE);g.target=h;}var k=null;if(j.type=="touchstart"){JO[l]=g;k=xB.LG;}if(j.type=="touchend"){JO.remove(l);k=xB.PG;}if(j.type=="touchcancel"){JO.remove(l);k=xB.RG;}if(j.type=="touchmove"){k=xB.WG;}if(k!=null&&h!=null){h.u(MO..YN(k,true)..UO=h.jC(i)..VO=i..cN=g.YE..eN=g.UE);}}} cO( g){g.preventDefault();var h=null;if(g.type=="keyup")h=BD.OG;if(g.type=="keydown")h=BD.tE;LO..YN(h,true)..zM=g.altKey..AN=g.ctrlKey..CN=g.shiftKey..ON=g.charCode..RN=g.keyCode..SN=CD.wH;if(g.keyLocation==mC.KeyLocation.LEFT)LO.SN=CD.UG;if(g.keyLocation==mC.KeyLocation.RIGHT)LO.SN=CD.AE;if(g.keyLocation==mC.KeyLocation.NUMPAD)LO.SN=CD.NI;if(g.keyLocation==mC.KeyLocation.JOYSTICK)LO.SN=CD.TG;if(g.keyLocation==mC.KeyLocation.MOBILE)LO.SN=CD.TG;if(oN!=null)oN.u(LO);} dO( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new xF(xF.GI,true);h.eL=new String.fromCharCodes([i]);if(oN!=null)oN.u(h);}} CF( g, o, FB, j){var lC=0.0;var kB=0.0;var DB=o*g.a;var bB=o*g.b;var MB=o*g.a+FB*g.c;var BB=o*g.b+FB*g.d;var YB=FB*g.c;var t=FB*g.d;var h=lC;if(h>DB)h=DB;if(h>MB)h=MB;if(h>YB)h=YB;var i=kB;if(i>bB)i=bB;if(i>BB)i=BB;if(i>t)i=t;var l=lC;if(l<DB)l=DB;if(l<MB)l=MB;if(l<YB)l=YB;var k=kB;if(k<bB)k=bB;if(k<BB)k=BB;if(k<t)k=t;if(j==null)j=new HB.nK();j.x=g.fB+h;j.y=g.gB+i;j.width=l-h;j.height=k-i;return j;}var kI=fI();
//@ sourceMappingURL=supersonic.dart.map