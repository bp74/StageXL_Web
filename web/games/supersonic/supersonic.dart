import "dart:html" as pC;import "dart:web_audio" as OH;import "dart:json" as VK;import "dart:async" as kB;import "dart:math" as ZB;class WK{static const  XK="Chrome";static const  YK="Firefox";static const  ZK="Internet Explorer";static const  aK="Safari";final  wI;final  cJ;const WK(this.wI,[this.cJ]);}class bK{final  name;const bK(this.name);}class TC{var x;var y;TC(this.x,this.y); get length{return ZB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new TC(x,y);} add( g){if(g==null)return null;return new TC(x+g.x,y+g.y);} get DF{var g=ZB.PI-ZB.atan2(this.x,this.y);if(g<0)g+= 2*ZB.PI;return g;}set DF( i){var h=this.length;var g=DB.VI(h,i-ZB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class dC{var x;var y;var z;dC(this.x,this.y,this.z); clone(){return new dC(x,y,z);} fG(){return ZB.sqrt(x*x+y*y+z*z);}IK( g){this.normalize();this.scale(g);} add( g){return new dC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=fG();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} equals( g){return (g.x==x&&g.y==y&&g.z==z);}}class UB extends ZE implements fC{static var lD=588;static var TD=314;static var XH=10.0;var tC;var rB;var QL;var cF;var JC;UB( g,[ autoStart=true, fontName=vD]):super(g){this.JC=fontName;this.width=UB.lD;this.height=UB.TD;this.tC=new hB(m.LB("items").CB("menu_bg"));this.v(this.tC);this.rB=new gC();this.rB.yC=0x000000;this.rB.wordWrap=true;this.rB.XC=new sF(fontName,30,0x000000,AC:true,align:mB.CE);this.rB.width=476;this.rB.height=250;this.rB.x=60;this.rB.y=90;this.v(this.rB);this.t(p.hC,this.onClick);if(autoStart){this.MH=0;this.cF=0;aB.add(this);}else{this.MH=1;}this.alpha=0;} ED( g){this.cF+= g;if(this.cF>XH){fD();MF();return false;}return true;}set text( g){if(g==null)return;var h=new sF(JC,30,0x000000,AC:true,align:mB.CE);if(g.length<=30)h.size=45;else h.size=30;this.rB.XC=h;this.rB.text=g;} onClick( g){fD();MF();} MF(){this.dispatchEvent(new KB(KB.vB,this));}set MH( g){if(g<0)g=1;if(g>1)g=1;QL=g;var h=(255*QL).round().toInt();} fD(){aB.remove(this);}}class PH extends ZE{var tC;var bC;var CC;var BC;var PC;var NC;var OC;var font;var eF=30;var UE;PH( h,[ fontName=vD]):super(h){this.font=fontName;this.uC();var g=new StringBuffer();g.add((this.u as tB).eB("GENlevel"));g.add(": 0");BC.text=g.toString();} uC(){this.tC=new hB(m.LB("items").CB("topbar"));this.tC.x=0;this.tC.y=0;this.v(this.tC);this.bC=new gC();this.bC.XC=new sF(font,24,0,AC:true,align:mB.KG);this.bC.yC=0x000000;this.bC.width=400;this.bC.height=100;this.bC.x=20;this.bC.y=eF;this.v(bC);this.CC=new gC();this.CC.XC=new sF(font,24,0,AC:true,align:mB.EE);this.CC.yC=0x000000;this.CC.width=200;this.CC.height=100;this.CC.x=(this.u.ME/2)-this.CC.width+60;this.CC.y=eF;this.v(CC);this.BC=new gC();this.BC.XC=new sF(font,24,0,AC:true,align:mB.EE);this.BC.yC=0x000000;this.BC.width=200;this.BC.height=100;this.BC.x=(this.u.ME)-(this.BC.width)-20;this.BC.y=eF;this.v(BC);this.PC=new gC();this.PC.XC=new sF(font,24,0,AC:true,align:mB.CE);this.PC.yC=0x000000;this.PC.width=200;this.PC.height=100;this.PC.x=20;this.PC.y=this.u.cG-this.PC.height-20;this.v(PC);this.PC.visible=false;this.NC=new hB(m.LB("items").CB("progressbar"));this.NC.x=25;this.NC.y=82;this.v(this.NC);this.OC=new hB(m.LB("items").CB("progressship"));this.OC.x=25;this.OC.y=this.NC.y+(this.NC.height-(this.NC.height-this.OC.height))-(this.OC.height);this.v(this.OC);this.UE=new List<hB>();for(var h=0;h<3;h++ ){var g=new hB(m.LB("items").CB("spaceship"));g.y=10;g.x=(this.u.ME/2)+70+(h*35);this.v(g);this.UE.add(g);}} vG( g){this.OC.x=25;this.OC.y=this.NC.y+(this.NC.height-((this.NC.height-this.OC.height)*g.u.progress))-(this.OC.height);} uG( i){var h=i.u as tB;if(h.OD){this.CC.text=h.eB("DISPLAY_TRAINING");}else{this.CC.text=h.eB("DISPLAY_LIVES");}for(var g=0;g<this.UE.length;g++ ){this.UE[g].visible=(!h.OD)&&(g<i.u.LD);}} xG( h){var i=h.u as tB;var g=new StringBuffer();g.add(i.eB("GENscore"));g.add(": ${h.u.HK.toString()}");bC.text=g.toString();} RE( h){var i=h.u as tB;var g=new StringBuffer();g.add(i.eB("GENlevel"));g.add(": ${h.u.level.toString()}");BC.text=g.toString();}}class QH extends UB{var oB;var kC;var cC;var RC;var UG=40;var VG=30;var JC;QH( g,[ fontName=vD]):super(g,true,fontName){this.JC=fontName;this.WB(p.sC);this.WB(p.hC);this.uC();} uC(){var g=this.u as tB;this.rB.wordWrap=true;this.text=g.eB("GENexitquery");this.oB=new xD(new hB(m.LB("items").CB("but_yes")),new hB(m.LB("items").CB("but_yes2")),new hB(m.LB("items").CB("but_yes2")),new hB(m.LB("items").CB("but_yes2")));this.oB.x=VG;this.oB.y=UB.TD-this.oB.height-UG;this.oB.t(p.sC,this.SK);this.v(this.oB);this.kC=new xD(new hB(m.LB("items").CB("but_no")),new hB(m.LB("items").CB("but_no2")),new hB(m.LB("items").CB("but_no2")),new hB(m.LB("items").CB("but_no2")));this.kC.x=UB.lD-this.kC.width-VG;this.kC.y=UB.TD-this.oB.height-UG;this.kC.t(p.sC,this.sG);this.v(this.kC);this.cC=new gC();this.cC.t(p.sC,this.oB.dispatchEvent);this.cC.yC=0x000000;this.cC.XC=new sF(JC,48,0,AC:true,align:mB.KG);this.cC.height=60;this.cC.x=this.oB.x+this.oB.width;this.cC.y=this.oB.y+5;this.v(this.cC);this.cC.text=g.eB("GENyes");this.RC=new gC();this.RC.t(p.sC,this.kC.dispatchEvent);this.RC.yC=0x000000;this.RC.XC=new sF(JC,48,0,AC:true,align:mB.EE);this.RC.height=60;this.RC.x=this.kC.x-this.RC.width;this.RC.y=this.oB.y+5;this.v(this.RC);this.RC.text=g.eB("GENno");}MF(){sG(null);} SK( g){fD();this.dispatchEvent(new KB(KB.vB,this));} sG( g){fD();this.dispatchEvent(new KB(KB.mD,this));}}class KB extends BB{static const  vB="MenuEvent.TYPE_OK";static const  mD="MenuEvent.TYPE_CANCEL";var PE;KB( h, g,[ bubbles=false]):super(h,bubbles){this.PE=g;}}class n extends BB{static const  SD="GameEvent.TYPE_LIVES_CHANGED";static const  nD="GameEvent.TYPE_PROGRESS_CHANGED";static const  oD="GameEvent.TYPE_PAUSE_CHANGED";static const  pD="GameEvent.TYPE_LEVEL_CHANGED";static const  qD="GameEvent.TYPE_SCORE_CHANGED";static const  rD="GameEvent.TYPE_GAME_START";static const  sD="GameEvent.TYPE_GAME_OVER";static const  tD="GameEvent.TYPE_GAME_ABORT";static const  eE="GameEvent.TYPE_GAME_SIZE_CHANGED";var u;n( h, g,[ bubbles=false]):super(h,bubbles){this.u=g;}}class ZE extends BD{var GL;ZE( g){this.u=g;}set u( g){if(GL!=null){GL.WB(n.sD);GL.WB(n.tD);GL.WB(n.eE);GL.WB(n.rD);GL.WB(n.pD);GL.WB(n.oD);GL.WB(n.qD);GL.WB(n.SD);GL.WB(n.nD);}GL=g;if(GL!=null){GL.t(n.sD,this.VF);GL.t(n.tD,this.UF);GL.t(n.eE,this.tG);GL.t(n.rD,this.WF);GL.t(n.pD,this.RE);GL.t(n.oD,this.nJ);GL.t(n.qD,this.xG);GL.t(n.SD,this.uG);GL.t(n.nD,this.vG);}} get u{return GL;} VF( g){} UF( g){} tG( g){} WF( g){} RE( g){} nJ( g){} xG( g){} uG( g){} vG( g){}}class zC extends ZE{static var kF=0.025;static var bE=1.0;static var AD=600;static var cE=800;static var dE=600;static var nF=400;static var oF=300;static var UD=ZB.sqrt(cE*cE+dE*dE);static var ZH=(UD*2/AD);static var pF=6;var PB;var RB;var LC;var YC;var bF=30.0*ZB.PI/180;var aF=1.0*ZB.PI/180;var PD=0.05;var YF=-1;var SE=1;var MB;var jC;var EF=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var FF;var GF;var XG;var yI;var KH;var ZF=15;var lG;var HD=false;var KE=0;var NF;var IE;var BF=0.90;var EH=0;var SL;var fK;var XB;var OJ=0;var IC;var FD=false;var SF,TF;var gG;var jD;zC( g):super(g){SL=new yD.yK(80,60,690,524);this.mask=SL;this.FF=m.PF("speedalizer");this.GF=this.FF.play(true);this.XB=new vF();this.v(this.XB);gG=new kH(800,600);v(gG);SF=TF=0;FC.t(p.uE,this.XF);FC.t(p.hC,this.XF);FC.t(p.ZD,this.XF);jD=this.hJ.listen(this.TL);} XF( g){SF=g.GH;TF=g.HH;} xJ(){var g=this.u.MD;this.u.MD=g+(this.u as tB).DH*(this.u.level*this.u.LD);} tG( g){} RE( g){super.RE(g);this.NK();} NK(){FD=false;jD.pause();this.KE=0;this.u.progress=0;this.HD=false;var h=60;this.YC=new UH(UD,pF*h);for(var g=this.YC.AB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.YC.BH(g);this.PB=new TC(nF,oF);this.RB=new dC(0,0,0);this.LC=new dC(0,0,bE);this.aF=(1+(0.1*this.u.level))*ZB.PI/180;this.PD=0.015+(0.004*this.u.level);this.SE=2+this.u.level;this.YF=-this.SE;this.EH=this.u.level*2;this.ZF=15+(this.u.level);this.uC();this.BJ();jD.resume();} uC(){if(this.MB!=null)this.qB(this.MB);this.MB=new RH();this.v(this.MB);if(this.IC!=null)this.qB(this.IC);this.IC=new hB(m.LB("items").CB("crosshair"));this.IC.ZC=0.5;this.IC.aC=0.5;this.IC.x=(cE/2)-this.IC.width/2;this.IC.y=(dE/2)-this.IC.height/2;this.v(this.IC);} OF(){this.FD=false;this.jD.pause();var h=60;this.YC=new UH(UD,pF*h);for(var g=this.YC.AB.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.YC.BH(g);this.PB=new TC(nF,oF);this.RB=new dC(0,0,0);this.LC=new dC(0,0,bE);this.aF=2*ZB.PI/180;this.SE=0;this.YF=0;if(this.MB!=null){this.qB(this.MB);this.MB=null;}this.MB=new RH();this.v(this.MB);if(this.jC!=null){this.qB(this.jC);this.jC=null;}this.ZG();this.jD.resume();} ZG(){var g=new SC(null);g.WC=-1;g.DC=0;g.position=this.RB.clone();g.position.z=0.5;this.MB.DD(g);} YG(){var g=new SC(new hB(m.LB("items").CB("countdown01")));g.WC=0;g.DC=0;g.position=this.RB.clone();g.position.z=0.5;g.eD=0;g.hD=true;this.MB.DD(g);g=new SC(new hB(m.LB("items").CB("countdown02")));g.WC=0;g.DC=0;g.position=this.RB.clone();g.position.z=0;g.eD=1;g.hD=true;this.MB.DD(g);g=new SC(new hB(m.LB("items").CB("countdown03")));g.WC=0;g.DC=0;g.position=this.RB.clone();g.position.z=-0.5;g.eD=2;g.hD=true;this.MB.DD(g);g=new SC(new hB(m.LB("items").CB("countdown04")));g.WC=0;g.DC=0;g.position=this.RB.clone();g.position.z=-1;g.eD=3;g.hD=true;this.MB.DD(g);} CJ(){var h=1+this.u.level;if(h>=this.EF.length)h=this.EF.length-1;var i=RD.lF(0,h);var j=this.EF[i];var g=new SC(new hB(m.CB(j)));g.nC=true;g.QC=RD.lF(0,359)*ZB.PI/180;g.DC=RD.YH(this.YF,this.SE)*ZB.PI/180;g.position=this.RB.clone();return g;} BJ(){this.YG();this.ZG();var h=0;for(var i=0;i<ZF;i++ ){var g=null;if(i==ZF-1){g=new SC(new hB(m.CB("finish")));g.QC=0;g.DC=5*ZB.PI/180;g.position=this.RB.clone();g.WC=0;g.nC=true;g.iG=true;this.NF=g;}else{h++ ;if(this.u.level==1&&h<=3){if(h==1){g=new SC(new hB(m.CB("training01")));g.nC=true;g.QC=0;g.DC=0;g.position=this.RB.clone();g.ND=1;}else if(h==2){g=new SC(new hB(m.CB("training02")));g.nC=true;g.QC=135*ZB.PI/180;g.DC=0;g.position=this.RB.clone();g.ND=2;}else if(h==3){g=new SC(new hB(m.CB("training02")));g.nC=true;g.QC=315*ZB.PI/180;g.DC=0;g.position=this.RB.clone();g.ND=3;}}else{g=this.CJ();}}g.kD=-i*1-3;g.position.z=g.kD;g.WC=0;this.MB.DD(g);}} kJ(){this.HD=false;var g=u as tB;g.JJ();g.aG();} TL( h){if(this.u.paused==false){this.AK();var g=this.u as tB;if(g.OD&&this.FD&&!g.QE)g.qJ();}else{iD=-1;}} NE( h){var g=new DB(this.PB.x,this.PB.y);g=this.mG(g);g=h.mC(g);return h.NE(g);} xI(){this.FD=false;for(var g=0;g<this.MB.MC.length;g++ )this.MB.MC[g].position.z-= (2.5+1-BF)+1;IE.position.z+= (1-BF);this.YG();this.HD=false;this.PD=this.lG;this.jC.visible=false;} gJ(){var g=this.u as tB;g.pB.visible=false;this.HD=false;this.FD=false;this.lG=this.PD;this.PD=0;if(this.jC!=null)this.qB(this.jC);this.jC=new hB(m.CB("broken"));this.v(this.jC);if(this.IE.ND>0&& ++this.OJ<=5){aB.LE((){g.zI(this.IE.ND);},2.0);}else{this.u.LD-- ;if(this.u.LD>0)aB.LE(g.DJ,2.0);}this.GF.stop();this.GF=this.FF.play(true);this.XG=m.PF("crash");this.yI=this.XG.play();}var iD=-1; AK(){var k=aB.elapsedTime;var h=1.0;if(iD==-1)iD=k;h=ZB.min(k-iD,1.0000)*40;iD=k;if(HD){this.KE-= (this.PD*h);var s=this.u.MD;this.u.MD=s+(this.EH*h);}this.MB.LK();this.bF+= (this.aF*h);this.LC.x=-(this.SF-this.PB.x)*3;this.LC.y=-(this.TF-this.PB.y)*3;if(this.LC.fG()>UD*0.7){this.LC.IK(UD*0.7);}this.LC.z=bE;this.RB=this.LC.clone();this.RB.z=kF;this.zJ();for(var o=0;o<this.MB.MC.length;o++ ){var g=this.MB.MC[o];g.position.z+= (PD*h);if(g.position.z>=1){if(g.hD&&g.eD==3)FD=true;if(g.cD!=null){this.KH=m.PF("swish");var w=this.KH.play();}if(g.nC)HD=true;if(g.kD!=0)this.KE=g.kD;if(g.nC&&NE(g)){g.position.z=BF;IE=g;this.gJ();}else{if(g.ND==3)(this.u as tB).OD=false;if(g.nC)this.xJ();if(g.iG){this.kJ();}else if(g.WC==0){this.MB.DK(g);}else{g.position.z+= g.WC;}}}var i=this.LC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.YE(i);j=j.add(this.PB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.QC+= (g.DC*h);g.setScale(QD(g.position.z)*ZH);}}if(this.NF!=null)this.u.progress=(this.KE+3)/(this.NF.kD+3);} YE( g){var h=new TC(g.x,g.y);h.x*= QD(g.z);h.y*= QD(g.z);return h;} QD( g){var h=kF;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} zJ(){if(XB==null)return;var l=2;var j=this.LC.clone();j.scale(l);var h=this.YC.transform(QD(j.z)*l,this.bF,this.YE(j));var i=this.YC.transform(QD(this.RB.z),this.bF,this.YE(this.RB));var k=this.YE(this.RB).add(this.PB);XB.QB.clear();XB.QB.beginPath();XB.QB.WG(k.x,k.y,this.YC.AH*QD(this.RB.z));XB.QB.closePath();XB.QB.IH(0xffcccccc,1);XB.QB.beginPath();for(var g=0;g<h.AB.length;g+= 2){XB.QB.moveTo(h.AB[g].x+this.PB.x,h.AB[g].y+this.PB.y);XB.QB.lineTo(h.AB[g+1].x+this.PB.x,h.AB[g+1].y+this.PB.y);XB.QB.lineTo(i.AB[g+1].x+this.PB.x,i.AB[g+1].y+this.PB.y);XB.QB.lineTo(i.AB[g].x+this.PB.x,i.AB[g].y+this.PB.y);XB.QB.lineTo(h.AB[g].x+this.PB.x,h.AB[g].y+this.PB.y);}XB.QB.closePath();XB.QB.IJ(0xFF000000);}}class SC extends BD{var FL;var IL;var KL;var position;var WC=-1;var DC=0;var KK=1;var nC=false;var iG=false;var hD=false;var pK=false;var eD=0;var ND=0;var kD=0;SC( g){KL=new BD();v(KL);this.cD=g;if(this.cD==null)return;this.x=100000;}set cD( g){if(FL!=null)this.qB(FL);if(IL!=null)this.qB(IL);FL=null;IL=null;if(g!=null){FL=g;FL.vC=zC.AD/2;FL.wC=zC.AD/2;v(FL);}else{IL=new vF();v(IL);}v(KL);} get cD{return FL;} setScale( g){this.KK=g;if(IL!=null){IL.QB.clear();IL.QB.beginPath();IL.QB.WG(0,0,zC.AD/2*g);IL.QB.closePath();IL.QB.IH(0xff999999,1);}if(FL!=null)FL.ZC=FL.aC=g;KL.ZC=KL.aC=g;} NE( j){if(FL==null)return false;var g=this.mG(j);g=FL.mC(g);var k=this.cD.nB.SJ(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new hB(m.LB("items").CB("blood"));h.vC=50;h.wC=50;h.x=g.x-zC.AD/2;h.y=g.y-zC.AD/2;KL.v(h);}return i;}}class RH extends BD{var MC;RH(){MC=new List<SC>();} LK(){this.MC.sort(TK);} DD( g){if(this.contains(g))return;this.v(g);this.MC.add(g);} DK( g){if(this.MC.length>0){var h=this.MC.indexOf(g);if(h>=0)this.MC.removeAt(h);}if(this.contains(g))this.qB(g);} TK( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.JD(g)<this.JD(h))this.JH(g,h);return 1;}if(g.position.z<h.position.z){if(this.JD(g)>this.JD(h))this.JH(g,h);return -1;}return 0;}}class tB extends uB{static const  mF=1.0;static const  VH=100;static const  WH=0xFFFFFF;var MK=mF;var PJ=5;var ID;var jG=false;var DH=500;var vI=0xffffff;var pB;var IB;var KD;var RL=true;var QE=false;var dG=60.0;var gD;var JC=vD;var QF=false;var wJ="Web";tB( h, g):super(h,g){this.t(BB.DG,(i){this.XJ();});}set OD( g){RL=g;this.dispatchEvent(new n(n.SD,this));} get OD{return RL;} XJ(){if(!jG){this.t(p.ZD,(g)=>this.QE=false);this.t(p.hC,(g)=>this.QE=true);this.yJ();this.t(n.rD,this.WF);this.t(n.SD,this.lJ);this.t(n.nD,this.oJ);this.t(n.qD,this.pJ);this.t(n.pD,this.onLevelChange);this.t(n.oD,this.mJ);this.t(n.sD,this.VF);this.t(n.tD,this.UF);this.uC();this.progress=0;this.MD=0;this.LD=3;this.start();jG=true;}} eB( i,[ params=null]){var h=m.TJ(i);if(params!=null)for(int g=0;g<params.length;g++ )h=h.replaceAll("{${g}}",params[g].toString());return h;} yJ(){this.MK=mF;this.vI=WH;this.DH=VH;this.PJ=5;this.dG=60000;} uC(){this.ID=new zC(this);this.v(this.ID);var h=m.LB("items").CB("button_exit");var g=m.LB("items").CB("button_exit_2");this.pB=new xD(new hB(h),new hB(g),new hB(h),new hB(g));this.pB.width=75;this.pB.height=66;this.pB.x=707;this.pB.y=525;this.pB.t(p.hC,iJ);this.v(this.pB);this.pB.visible=false;this.KD=new PH(this,JC);this.KD.x=0;this.KD.y=0;this.v(this.KD);} DJ(){var g=this.GD();g.text=this.eB("MESSAGE_RESTART_LEVEL");g.t(KB.vB,this.wG);} zI( h){var g=this.GD();g.text=this.eB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.t(KB.vB,this.wG);} wG( g){this.xC(g.PE);this.ID.xI();} aG(){this.ID.OF();var g=this.GD();if(this.level==0){g.text=this.eB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.eB("MESSAGE_START_LEVEL",[(this.level+1)]);}g.t(KB.vB,this.rJ);} rJ( g){this.xC(g.PE);this.dJ();} AJ(){var g=this.GD();g.text=this.eB("MESSAGE_GAME_OVER");g.t(KB.vB,this.jJ);} jJ( g){this.xC(g.PE);} GD([ menu=null, tweenDuration=1.0, autoStart=true]){if(this.IB!=null)this.xC(this.IB);this.pB.visible=false;this.KD.visible=true;if(menu==null)this.IB=new UB(this,autoStart,JC);else this.IB=menu;this.IB.width=UB.lD;this.IB.height=UB.TD;this.IB.x=(this.ME/2)-(UB.lD/2)+30;this.IB.y=(this.cG/2)-(UB.TD/2);this.IB.alpha=0;this.v(this.IB);var g=new aI(this.IB,tweenDuration,yE.zE);g.JE("alpha",1);aB.add(g);return this.IB;} xC( g){this.paused=false;this.KD.visible=true;this.pB.visible=true;if(g==null)return;g.fD();if(this.contains(g)){this.qB(g);}this.IB=null;} RJ(){aB.remove(gD);if(this.QF)this.yG(null);this.QE=true;this.OD=false;} qJ(){if(this.IB!=null)return;if(wJ.toLowerCase()=="web")return;aB.remove(gD);this.gD=new oE(this.RJ,this.dG);aB.add(this.gD);this.QF=true;this.paused=true;var g=this.GD(null,200,false);this.pB.visible=true;g.text=this.eB("MESSAGE_FIRST_LEVEL");g.t(KB.vB,this.yG);} yG( g){aB.remove(this.gD);this.QF=false;this.IB.WB(KB.vB);this.xC(this.IB);} iJ( h){if(this.IB is QH)return;var g=new QH(this,JC);this.GD(g);this.paused=true;g.t(KB.vB,this.fJ);g.t(KB.mD,this.eJ);} fJ( g){this.dispatchEvent(new n(n.tD,this));this.IB.WB(KB.vB);this.IB.WB(KB.mD);this.xC(this.IB);this.paused=true;} eJ( g){this.IB.WB(KB.vB);this.IB.WB(KB.mD);this.xC(IB);} WF( g){this.ID.OF();aB.LE(this.aG,0.5);} JJ(){this.ID.OF();} oJ( g){} lJ( g){} pJ( g){} onLevelChange( g){} mJ( g){} VF( g){aB.LE(this.AJ,2.0);} UF( g){}}class RD{static var jF=new ZB.Random();static  lF( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=RD.jF.nextInt(h+1)+g;}return i;}static  YH( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=RD.jF.nextDouble()*(h-g)+g;}return i;}}class UH extends aE{var DL;var HL;UH( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.DL=h;this.HL=g;EJ();} get AH{return DL;} EJ(){var g=new List<TC>();var h=0.0;var k=2*ZB.PI/HL;for(var j=0;j<HL;j++ ){var i=new TC(0,-DL);i.DF=h;g.add(i);h+= k;}this.AB=g;}}class aE implements TH,SH{var AB;aE([ pointList]){this.AB=(pointList!=null)?pointList:new List();}BH( g){if(g<AB.length)this.AB.removeAt(g);} NE( h){var k=this.AB.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(AB[g].y<h.y&&AB[i].y>=h.y||AB[i].y<h.y&&AB[g].y>=h.y){if(AB[g].x+(h.y-AB[g].y)/(AB[i].y-AB[g].y)*(AB[i].x-AB[g].x)<h.x){j=!j;}}i=g;}return j;} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.AB.length;var i=new List<TC>(j);for(var g=0;g<j;g++ ){var k=this.AB[g].clone();k.scale(h);i[g]=k;}return new aE(i);} transform( l, k, o){var j=this.AB.length;var i=new List<TC>(j);for(var g=0;g<j;g++ ){var h=this.AB[g].clone();h.scale(l);h.DF+= k;i[g]=h.add(o);}return new aE(i);}}abstract class SH{}abstract class TH{}class uB extends BD{var EL=0;var JL=0;var LL=true;var ML=3;var NL=0.0;var OL;var PL;uB( h, g){JK(h,g);} JK( g, h){OL=g;PL=h;this.dispatchEvent(new n(n.eE,this));} get ME{return OL;} get cG{return PL;} start(){this.paused=false;this.dispatchEvent(new n(n.rD,this));} QJ(){this.dispatchEvent(new n(n.sD,this));}set progress( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;NL=g;this.dispatchEvent(new n(n.nD,this));} get progress{return NL;}set LD( g){if(g<0)g=0;ML=g;this.dispatchEvent(new n(n.SD,this));if(ML==0)this.QJ();} get LD{return ML;}set MD( g){if(g<0)g=0;EL=g;this.dispatchEvent(new n(n.qD,this));} get MD{return EL;} get HK{return EL.toDouble().round().toInt();}set level( g){if(g<0)g=0;JL=g;this.dispatchEvent(new n(n.pD,this));} get level{return JL;} dJ(){this.level+= 1;return this.level;}set paused( g){LL=g;this.dispatchEvent(new n(n.oD,this));} get paused{return LL;}}var FC;var m;var fE;var aB;var aH;var eC;var uD;var wB;const  vD="Russo One"; main(){FC=new bD("Stage",pC.query('#stage'));fE=new cH();fE.rI(FC);aB=fE.ZJ;aH=new ZB.Random();var g=bB.TG("images/Loading.png");g.then((h){eC=new hB(h);eC.vC=20;eC.wC=20;eC.x=400;eC.y=270;FC.v(eC);uD=new aI(eC,100,yE.zE);uD.JE("rotation",100.0*2.0*ZB.PI);aB.add(uD);wB=new gC();wB.XC=new sF("Arial",20,0xA0A0A0,AC:true);wB.width=240;wB.height=40;wB.text="... loading ...";wB.x=400-wB.PK/2;wB.y=320;wB.qG=false;FC.v(wB);bH();});} bH(){m=new lE();m.zB("barrier01","images/barrier01.png");m.zB("barrier02","images/barrier02.png");m.zB("barrier03","images/barrier03.png");m.zB("barrier04","images/barrier04.png");m.zB("barrier05","images/barrier05.png");m.zB("barrier06","images/barrier06.png");m.zB("barrier07","images/barrier07.png");m.zB("training01","images/training01.png");m.zB("training02","images/training02.png");m.zB("finish","images/finish.png");m.zB("broken","images/broken.png");m.sI("items","images/ItemTextureAtlas.json",mE.BG);m.CF("crash","sounds/crash.mp3");m.CF("swish","sounds/swish.mp3");m.CF("speedalizer","sounds/speedalizer.mp3");m.SB("DISPLAY_LEVEL","Level: {0}");m.SB("DISPLAY_LIVES","Ships:");m.SB("DISPLAY_SCORE","Score: {0}");m.SB("DISPLAY_TRAINING","Training");m.SB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");m.SB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");m.SB("MESSAGE_GAME_OVER","Game\nOver!");m.SB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");m.SB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");m.SB("GENscore","Score");m.SB("GENlevel","Level");m.SB("GENexitquery","Do you really want to quit the game?");m.SB("GENyes","Yes");m.SB("GENno","No");m.load().then((h){FC.qB(eC);FC.qB(wB);aB.remove(uD);var g=new tB(800,600);g.tI(FC);g.start();});}class rF{static const  zH="none";static const  EI="touchPoint";}class dB{var volume;var uJ;var rK=1;var sK=0;var vK=1;var uK=0;dB([this.volume=1,this.uJ=0]);}class fH{static const  zH="none";}class gH{static const  oH="dynamic";}class zD extends UC{var DM;var sL;var oL;var FM;zD( g, i, h){DM=g;oL=i;FM=h;sL=g.cN(this);sL.loop=oL;this.VE=h;sL.play();} set VE( g){FM=g;if(sL!=null)sL.volume=(FM!=null)?FM.volume:1;} stop(){if(sL!=null){if(sL.ended==false)sL.pause();DM.lO(this);sL=null;}}}class mB{static const  CE="center";static const  xH="end";static const  CI="justify";static const  KG="left";static const  EE="right";}class lH{static const  vH="pixel";}class lB{static const  pE="auto";static const  rE="arrow";static const  sE="button";static const  GI="hand";static const  HI="ibeam";static const  JI="wait";}class gE{static var yF=lB.pE;static var uH=false;static var DI=new xB();static  SG( i){var h=i;var g="auto";if(yF!=lB.pE)h=yF;switch (h){case lB.pE:g="auto";break;case lB.rE:g="default";break;case lB.sE:g="pointer";break;case lB.GI:g="move";break;case lB.HI:g="text";break;case lB.JI:g="wait";break;}if(uH)g="none";return g;}}abstract class UC extends xB{ set VE( g); stop();}class dK extends UC{var AM;var FM;var oL;var mM;var xM;dK( j, h, i){AM=j;oL=h;FM=i;var g=AE.HE;mM=g.createGain();mM.connect(g.destination,0,0);mM.gain.value=(FM!=null)?ZB.pow(FM.volume,2):1;xM=g.createBufferSource();xM.buffer=AM.rL;xM.loop=h;xM.connect(mM,0,0);xM.start(0);} set VE( g){FM=g;mM.gain.value=(FM!=null)?ZB.pow(FM.volume,2):1;} stop(){xM.stop(0);}}class cK extends UC{var oL;var FM;cK( i, h, g){oL=h;FM=g;} set VE( g){FM=g;} stop(){}}class gC extends GB{var nL="";var zL=0x000000;var WM=null;var jM=fH.zH;var yM=lH.vH;var UL=gH.oH;var ON=false;var QN=false;var TN=0x000000;var XN=false;var aN=0x000000;var fN=0;var iN=0;var kN;var oN;var rN=true;var sN=100;var tN=100;var vN=null;var kL=null;gC(){WM=new sF("Arial",12,0x000000);kN=new List<String>();oN=new List<nE>();} get type=>UL; get width=>sN; get height=>tN; set text( g){nL=g;rN=true;} set yC( g){zL=g;rN=true;} set XC( g){WM=g;zL=WM.color;rN=true;} set wordWrap( g){ON=g;rN=true;} set width( g){sN=g;rN=true;} set height( g){tN=g;rN=true;} get PK{yO();return fN;} jB( g,[ returnRectangle]){return AF(g,sN,tN,returnRectangle);} KC( g, h){if(g>=0&&h>=0&&g<sN&&h<tN)return this;return null;} TB( g){yO();g.kL.drawImage(vN,0.0,0.0);} CP(){kN.clear();oN.clear();if(ON==false){kN.add(nL);}else{var g=new StringBuffer();var i;var h;for(String s in nL.replaceAll('\r','').split('\n')){for(String j in s.split(' ')){i=g.length;g.add((i>0)?" ${j}":j);h=g.toString();if(kL.measureText(h).width>sN){if(i>0)h=h.substring(0,i);else j="";kN.add(h);g.clear();g.add(j);}}if(g.isEmpty==false){kN.add(g.toString());g.clear();}}}fN=0;iN=0;for(String h in kN){var l=kL.measureText(h);var o=0;if(WM.align==mB.CE||WM.align==mB.CI)o=(sN-l.width)/2;if(WM.align==mB.EE||WM.align==mB.xH)o=sN-l.width;var k=new nE(o,l.width,WM.size,0,0,0);oN.add(k);fN=ZB.max(fN,k.width);iN=iN+k.height;}} yO(){if(rN){rN=false;var i=sN.ceil().toInt();var j=tN.ceil().toInt();if(vN==null){vN=new pC.CanvasElement(width:i,height:j);kL=vN.context2d;}if(vN.width!=i)vN.width=i;if(vN.height!=j)vN.height=j;var g=new StringBuffer();g.add(WM.kG?"italic ":"normal ");g.add("normal ");g.add(WM.AC?"bold ":"normal ");g.add("${WM.size}px ");g.add("${WM.font},sans-serif");kL.font=g.toString();kL.textAlign="start";kL.textBaseline="top";kL.fillStyle=YD(zL);CP();if(QN){kL.fillStyle=YD(TN);kL.fillRect(0,0,sN,tN);}else{kL.clearRect(0,0,sN,tN);}var k=0;for(int h=0;h<kN.length;h++ ){var l=oN[h];kL.fillStyle=YD(zL);kL.fillText(kN[h],l.x,k);k+= l.height;}if(XN){kL.strokeStyle=YD(aN);kL.lineWidth=1;kL.strokeRect(0,0,sN,tN);}}}}class qF{var aL;var uL;var HM;var PM;var XM;var dM;var kM;var pM;var tM;var EN;var LN;qF( g, h){aL=g;uL=h;} get QK=>uL; get name=>aL; get MJ=>HM; get NJ=>PM; get LJ=>XM; get KJ=>dM; get offsetX=>kM; get offsetY=>pM; get tJ=>tM; get sJ=>EN; get GK=>LN;}class mE{static const  qH="json";static const  BG="jsonarray";}class iE extends VB{var rL;iE(){if(AE.HE==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  pH( s){var h=new iE();var k=VB.RG(s);var g=new kB.Completer<VB>();pC.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var o=AE.HE;o.decodeAudioData(j,( l){h.rL=l;g.complete(h);},(w){g.completeError(new StateError("Failed to decode audio."));});}).catchError((w){g.completeError(new StateError("Failed to load audio."));});return g.future;} get length{return rL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new dK(this,loop,soundTransform);}}class sF{var font;var size;var color;var AC;var kG;var RK;var align;var aJ;var FK;var WJ;var RF;var letterSpacing=0;var gK=0;var hK=false;var qK=false;sF(this.font,this.size,this.color,{this.AC: false,this.kG: false,this.RK: false,this.align: "left",this.aJ: 0,this.FK: 0,this.WJ: 0,this.RF: 0});}class nE{var uI;var FJ;var height;var RF;var width;var x;nE(this.x,this.width,this.height,this.uI,this.FJ,this.RF);}class AE{static var GE;static  get HE{if(GE==null){try {GE=new OH.AudioContext();}catch (g){GE=null;}}return GE;}static var aD;static  get eI{if(aD==null){aD=(HE!=null)?"WebAudioApi":"AudioElement";var g=pC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))aD="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))aD="Mock";}return aD;}}class lE{var gL;var BM;var YM;var lM;var sM;var AN;var JN;lE(){gL=new Map<String,bB>();BM=new Map<String,VB>();YM=new Map<String,HC>();lM=new Map<String,String>();sM=null;AN=0;JN=0;} zB( g, h){AN++ ;bB.TG(h).then(( i){gL[g]=i;AN-- ;OO();}).catchError(( j){JN++ ;AN-- ;OO();});} CF( g, h){AN++ ;VB.pH(h).then(( i){BM[g]=i;AN-- ;OO();}).catchError(( j){JN++ ;AN-- ;OO();});} sI( h, i, g){AN++ ;HC.OI(i,g).then(( j){YM[h]=j;AN-- ;OO();}).catchError(( k){JN++ ;AN-- ;OO();});} SB( h, g){lM[h]=g;} load(){sM=new kB.Completer<lE>();OO();return sM.future;} CB( g){if(gL.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return gL[g];} PF( g){if(BM.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return BM[g];} LB( g){if(YM.containsKey(g)==false)throw new ArgumentError("Resource not found: '${g}'");return YM[g];} TJ( g){if(lM.containsKey(g)==false)return "[[${g}]]";return lM[g];}OO(){if(sM!=null&&AN==0){if(JN==0)sM.complete(this);else sM.completeError(new StateError("Error loading resources."));}}}class HC{var bL;var GM;HC(){bL=new pC.ImageElement();GM=new List<qF>();}static  OI( o, NB){var l=new kB.Completer<HC>();var j=new HC();switch (NB){case mE.qH:case mE.BG: s( k, g){var EB=bI(k);var h=new qF(EB,j);h.HM=g["frame"]["x"].toInt();h.PM=g["frame"]["y"].toInt();h.XM=g["frame"]["w"].toInt();h.dM=g["frame"]["h"].toInt();h.kM=g["spriteSourceSize"]["x"].toInt();h.pM=g["spriteSourceSize"]["y"].toInt();h.tM=g["sourceSize"]["w"].toInt();h.EN=g["sourceSize"]["h"].toInt();h.LN=g["rotated"] as bool;j.GM.add(h);}pC.HttpRequest.getString(o).then((JB){var w=VK.parse(JB);var i=w["frames"];var YB=w["meta"];if(i is List)for(var g in i)s(g["filename"],g);if(i is Map)for(String k in i.keys)s(k,i[k]);j.bL..onLoad.listen((cB)=>l.complete(j))..onError.listen((cB)=>l.completeError(new StateError("Failed to load image.")))..src=fI(o,YB["image"]);}).catchError((sB){l.completeError(new StateError("Failed to load json file."));});break;}return l.future;} get VJ=>bL; CB( i){var h;for(int g=0;g<GM.length&&h==null;g++ )if(GM[g].name==i)h=new bB.CL(GM[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;}}class oE implements fC{var lL=0.0;var EM=0.0;var QM=1;var cM;oE( g, h){cM=g;EM=ZB.max(h,0.0001);} ED( h){var g=lL+h;while (g>=EM&&QM>0){lL=EM;QM-- ;cM();g-= EM;}if(QM==0)return false;lL=g;return true;} get currentTime=>lL;}abstract class fC{ ED( g);}class kE implements fC{var iL;var IM;var SM;kE(){iL=0.0;IM=new List<fC>();SM=0;} get elapsedTime=>iL; add( g){if(g==null)return;if(SM==IM.length)IM.add(g);else IM[SM]=g;SM++ ;} remove( h){if(h==null)return;for(int g=0;g<SM;g++ ){if(IM[g]==h){IM[g]=null;break;}}} LE( h, i){var g=new oE(h,i);add(g);return g;} ED( k){iL+= k;var l=SM;var h=0;for(int i=0;i<l;i++ ){var j=IM[i];if(j!=null&&j.ED(k)){if(h!=i)IM[h]=j;h++ ;}}for(int g=l;g<SM;g++ )IM[h++ ]=IM[g];for(int g=h;g<SM;g++ )IM[g]=null;SM=h;return true;}}abstract class VB{static  pH( g){var h=AE.eI;if(h=="WebAudioApi")return iE.pH(g);if(h=="AudioElement")return hE.pH(g);return tF.pH(g);} get length; play([ loop=false, soundTransform]);static var iC;static  RG( g){if(iC==null){iC=new List<String>();var i=new pC.AudioElement();var h=["maybe","probably"];if(h.indexOf(i.canPlayType("audio/ogg",""))!=-1)iC.add("ogg");if(h.indexOf(i.canPlayType("audio/mp3",""))!=-1)iC.add("mp3");if(h.indexOf(i.canPlayType("audio/wav",""))!=-1)iC.add("wav");}var k=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var j=k.firstMatch(g);if(j==null)throw new ArgumentError("Unsupported file extension.");var l=j.group(1).toLowerCase();if(iC.indexOf(l)==-1&&iC.length>0)g="${g.substring(0,g.length-3)}${iC[0]}";return g;}}class jH{var name;var EC;var LH;jH(this.name,this.EC,this.LH);}class kH extends GB{var width;var height;kH(this.width,this.height); jB( g,[ returnRectangle]){return AF(g,width,height,returnRectangle);} KC( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} TB( g){}}class DB{var x;var y;DB(this.x,this.y);DB.xK():this(0,0);static  VI( g, h)=>new DB(g*ZB.cos(h),-g*ZB.sin(h)); get length=>ZB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new DB(this.x+g.x,this.y+g.y); clone()=>new DB(this.x,this.y); KF( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class HB{var x;var y;var width;var height;HB(this.x,this.y,this.width,this.height);HB.xK():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new DB(this.width,this.height); set size( g){this.width=g.x;this.height=g.y;} clone()=>new HB(this.x,this.y,this.width,this.height); contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); KF( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;}}class iH{iH();}class FB{var VL,WL,XL,ZL,cL,eL;var qL;FB( g, j, i, h, k, l):VL=g,WL=j,XL=i,ZL=h,cL=k,eL=l,qL=g*h-j*i;FB.AL():VL=1.0,WL=0.0,XL=0.0,ZL=1.0,cL=0.0,eL=0.0,qL=1.0; clone(){return new FB(VL,WL,XL,ZL,cL,eL);} get a=>VL; get b=>WL; get c=>XL; get d=>ZL; get fB=>cL; get gB=>eL; get lC=>qL; NH( g){return new DB(g.x*VL+g.y*XL+cL,g.x*WL+g.y*ZL+eL);} concat( g){var o=VL;var EB=WL;var JB=XL;var w=ZL;var l=cL;var s=eL;var YB=qL;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var cB=g.fB;var NB=g.gB;var sB=g.lC;VL=(o*j+EB*i);WL=(o*k+EB*h);XL=(JB*j+w*i);ZL=(JB*k+w*h);cL=(l*j+s*i+cB);eL=(l*k+s*h+NB);qL=(YB*sB);} hG(){VL=1.0;WL=0.0;XL=0.0;ZL=1.0;cL=0.0;eL=0.0;qL=1.0;} YJ(){var j=VL;var o=WL;var l=XL;var k=ZL;var h=cL;var i=eL;var g=qL;VL=(k/g);WL=-(o/g);XL=-(l/g);ZL=(j/g);cL=-(VL*h+XL*i);eL=-(WL*h+ZL*i);qL=(1.0/g);} FH( g, j, i, h, k, l){VL=g;WL=j;XL=i;ZL=h;cL=k;eL=l;qL=(g*h-j*i);} KF( g){VL=g.a;WL=g.b;XL=g.c;ZL=g.d;cL=g.fB;eL=g.gB;qL=g.lC;} LF( h, g){var s=h.a;var JB=h.b;var NB=h.c;var EB=h.d;var o=h.fB;var w=h.gB;var cB=h.lC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var sB=g.fB;var YB=g.gB;var oC=g.lC;VL=(s*k+JB*j);WL=(s*l+JB*i);XL=(NB*k+EB*j);ZL=(NB*l+EB*i);cL=(o*k+w*j+sB);eL=(o*l+w*i+YB);qL=(cB*oC);}}class cH{var YL;var pL;var xL;var TM;var hM;cH(){YL=new kE();pL=new List<bD>();xL=double.NAN;TM=wD.CG;hM=new VD(0);pC.window.requestAnimationFrame(dN);} get ZJ=>YL; dN( g){pC.window.requestAnimationFrame(dN);if(xL.isNaN)xL=g;if(xL>g)xL=g;var j=g-xL;var i=j/1000.0;if(j>=1){xL=g;hM.hL=i;TM.IO(hM);YL.ED(i);for(int h=0;h<pL.length;h++ ){var k=pL[h];k.bJ();}}} rI( g){pL.add(g);}}class iB{var kL;var CM;var RM;var aM;iB.zK( j,[ matrix]){kL=j;CM=new List<FB>.fixedLength(100);RM=new List<double>.fixedLength(100);for(int h=0;h<100;h++ ){CM[h]=new FB.AL();RM[h]=1.0;}aM=0;if(matrix!=null)CM[0].KF(matrix);var g=CM[0];var i=RM[0];kL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);kL.globalAlpha=i;} get context=>kL; reset(){aM=0;var g=CM[0];var h=RM[0];kL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);kL.globalAlpha=h;kL.clearRect(0,0,kL.canvas.width,kL.canvas.height);} CH( h){var i=aM;var j=aM+1;var l=CM[i];var g=CM[j];var o=RM[i];var k=RM[j]=h.RN*o;g.LF(h.WO,l);kL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);kL.globalAlpha=k;aM=j;if(h.mask==null){h.TB(this);}else{kL.save();h.mask.TB(this);h.TB(this);kL.restore();}aM=i;}}class WD{static const  pE="auto";static const  wH="stop";static const  GG="once";}class BB{static const  sH="added";static const  DG="addedToStage";static const  tE="enterFrame";static const  II="removed";static const  LI="removedFromStage";var UL;var RO;var UO;var JM;var ZO;var cO;var eO;BB( g,[ bubbles=false]){uN(g,bubbles);} uN( g,[ bubbles=false]){UL=g;RO=bubbles;UO=qC.DE;JM=null;ZO=null;cO=false;eO=false;} get dF=>cO; get type=>UL; get bubbles=>RO; get HF=>true; get target=>JM;}class qC{static const  zF=1;static const  DE=2;static const  BI=3;}class xB{var mL; UJ( g){if(mL!=null)return mL.containsKey(g)||mL.containsKey("${g}_CAPTURE");else return false;} t( g, i(event),{ useCapture: false}){var h=GN(g,useCapture);var j=h.listen(i);return j;} WB( g,{ useCapture: false}){var i=useCapture?"${g}_CAPTURE":g;var h=mL[i];if(h!=null)h.aO();} dispatchEvent( g){fO(g,this,this,qC.DE);} fO( g, l, k, i){if(mL!=null){var j=(i==qC.zF)?"${g.type}_CAPTURE":g.type;var h=mL[j];if(h!=null){g.JM=l;g.ZO=k;g.UO=i;g.cO=false;g.eO=false;h.IO(g);}}} GN( g, j){if(mL==null)mL=new Map<String,XD>();var i=j?"${g}_CAPTURE":g;var h=mL[i];if(h==null)h=mL[i]=new XD(this,g,j);return h;}}class wD<BE extends BB>{static var CG=new wD<VD>();var mL;var vM;wD(){mL=new List<XD>(50);vM=0;} hN( g){for(int h=0;h<vM;h++ )if(mL[h]==g)return;if(vM==mL.length)mL.add(g);else mL[vM]=g;vM++ ;} IO( i){var l=vM;var j=0;i.UO=qC.DE;i.cO=false;i.eO=false;for(int k=0;k<l;k++ ){var h=mL[k];if(h!=null&&h.CN>0){i.JM=h.JM;i.ZO=h.JM;h.IO(i);if(j!=k)mL[j]=h;j++ ;}}for(int g=l;g<vM;g++ )mL[j++ ]=mL[g];for(int g=j;g<vM;g++ )mL[g]=null;vM=j;}}class XD<BE extends BB> extends kB.Stream<BE>{final  JM;final  wL;final  fM;var rM;var CN;XD(this.JM,this.wL,this.fM){rM=new List<rH>(5);CN=0;} listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new rH<BE>(this,h);if(CN==rM.length)rM.add(g);else rM[CN]=g;CN++ ;if(wL==BB.tE&&fM==false)wD.CG.hN(this);return g;} qN( h){for(int g=0;g<CN;g++ ){if(rM[g]==h){rM[g]=null;break;}}} aO(){for(int g=0;g<CN;g++ )if(rM[g]!=null)rM[g].cancel();} IO( l){var k=CN;var h=0;for(int i=0;i<k;i++ ){var j=rM[i];if(j!=null){j.wM(l);if(h!=i)rM[h]=j;h++ ;}}for(int g=k;g<CN;g++ )rM[h++ ]=rM[g];for(int g=h;g<CN;g++ )rM[g]=null;CN=h;}}class yB<BE extends BB>{final  wL;const yB(this.wL); forTarget( g,{ useCapture: false}){return g.GN(wL,useCapture);}}class hE extends VB{var sL;var LM;var eM;hE(){eM=new List<zD>();sL=new pC.AudioElement();sL.onEnded.listen(PN);LM=new List<pC.AudioElement>();LM.add(sL);pC.document.body.children.add(sL);}static  pH( w){var k=new hE();var g=k.sL;var i=new kB.Completer<VB>();var h;var j;s(o){h.cancel();j.cancel();i.complete(k);}l(o){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(s);j=g.onError.listen(l);g.src=VB.RG(w);g.load();return i.future;} get length{return sL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new zD(this,loop,soundTransform);} cN( h){var g;if(LM.length==0){g=sL.clone(true);g.onEnded.listen(PN);}else{g=LM.removeAt(0);}eM.add(h);return g;} lO( g){var h=g.sL;var i=eM.indexOf(g);eM.removeAt(i);LM.add(h);if(sL.currentTime>0&&sL.ended==false)sL.currentTime=0;} PN(j){var i=j.target;var g=null;for(int h=0;h<eM.length&&g==null;h++ )if(eM[h].sL==i)g=eM[h];if(g!=null)g.stop();}}class VD extends BB{var hL;VD( g):super(BB.tE,false){hL=g;} get HF=>false;}class p extends BB{static const  sC="click";static const  AI="doubleClick";static const  hC="mouseDown";static const  ZD="mouseUp";static const  uE="mouseMove";static const  FE="mouseOut";static const  NG="mouseOver";static const  QI="mouseWheel";static const  PG="middleClick";static const  TI="middleMouseDown";static const  XI="middleMouseUp";static const  QG="rightClick";static const  ZI="rightMouseDown";static const  cI="rightMouseUp";var AO,CO;var DO,FO;var kO;var UN;var gN;var WN;var YN;var oO;var pO;var qO;p( g,[ bubbles=false]):super(g,bubbles){uN(g,bubbles);} uN( g,[ bubbles=false]){super.uN(g,bubbles);AO=CO=0;DO=FO=0;kO=false;UN=false;gN=false;WN=false;YN=false;oO=0;pO=0;qO=0;}set rO( g){AO=g.x;CO=g.y;}set sO( g){DO=g.x;FO=g.y;} get GH=>DO; get HH=>FO; get VC=>kO; get altKey=>UN; get ctrlKey=>WN; get shiftKey=>YN; get dD=>oO;}class GC extends BB{static const  qE="keyDown";static const  EG="keyUp";var UN;var WN;var YN;var bN;var gN;var jN;var lN;var nN;GC( g,[ bubbles=false]):super(g,bubbles){uN(g,bubbles);} uN( g,[ bubbles=false]){super.uN(g,bubbles);UN=false;WN=false;YN=false;bN=false;gN=false;jN=0;lN=0;nN=0;} get altKey=>UN; get ctrlKey=>WN; get shiftKey=>YN; get charCode=>jN; get keyCode=>lN; get keyLocation=>nN;}class xF extends BB{static const  yH="textInput";var nL="";xF( g,[ bubbles=false]):super(g,bubbles){}}class OB extends BB{static const  AG="touchBegin";static const  FG="touchEnd";static const  HG="touchCancel";static const  MG="touchMove";static const  MI="touchOver";static const  NI="touchOut";var xN;var zN;var AO,CO;var DO,FO;var UN;var gN;var WN;var YN;var KO;var NO;var QO;OB( g,[ bubbles=false]):super(g,bubbles){uN(g,bubbles);} uN( g,[ bubbles=false]){super.uN(g,bubbles);xN=0;zN=false;AO=CO=0;DO=FO=0;UN=false;gN=false;WN=false;YN=false;KO=1.00;NO=0;QO=0;}set rO( g){AO=g.x;CO=g.y;}set sO( g){DO=g.x;FO=g.y;} get XE=>xN; get GH=>DO; get HH=>FO; get altKey=>UN; get ctrlKey=>WN; get shiftKey=>YN;}class yD{var UL;var dL;var vL;var KM;yD.yK( i, g, h, j){UL=0;dL=new HB(i,g,h,j);} TB( i){var g=i.context;g.beginPath();switch (UL){case 0:g.rect(dL.x,dL.y,dL.width,dL.height);break;case 1:g.arc(vL.x,vL.y,vL.AH,0,ZB.PI*2.0,false);break;case 2:g.moveTo(KM[0].x,KM[0].y);for(int h=1;h<KM.length;h++ )g.lineTo(KM[h].x,KM[h].y);break;}g.clip();}}class hH{static const  tH="round";}class dH{static const  tH="round";}class eH{var name;var arguments;eH(this.name,[this.arguments]);}class uF{var fL;uF(){fL=new List<eH>();}clear()=>fL.clear();beginPath()=>fL.add(new eH("beginPath"));closePath()=>fL.add(new eH("closePath"));moveTo( h, g)=>fL.add(new eH("moveTo",[h,g]));lineTo( h, g)=>fL.add(new eH("lineTo",[h,g]));arcTo( k, i, g, h, j)=>fL.add(new eH("arcTo",[k,i,g,h,j]));quadraticCurveTo( j, i, g, h)=>fL.add(new eH("quadraticCurveTo",[j,i,g,h]));bezierCurveTo( g, h, l, j, i, k)=>fL.add(new eH("bezierCurveTo",[g,h,l,j,i,k]));arc( i, j, h, k, g, l)=>fL.add(new eH("arc",[i,j,h,k,g,l]));rect( i, g, h, j)=>fL.add(new eH("rect",[i,g,h,j]));IH( g,[ width=1, joints=hH.tH, caps=dH.tH])=>fL.add(new eH("strokeColor",[xE(g),width,joints,caps]));IJ( g)=>fL.add(new eH("fillColor",[xE(g)]));WG( i, g, h){fL.add(new eH("moveTo",[i+h,g]));fL.add(new eH("arc",[i,g,h,0,ZB.PI*2,false]));} TB( k){var h=k.context;h.save();for(var j in fL){var g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].EP(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].FP(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];FB i=g[0].GP;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].nK(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].oK(h);FB i=g[0].GP;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}abstract class q extends xB implements jE{var NM=0.0;var UM=0.0;var bM=0.0;var iM=0.0;var oM=1.0;var uM=1.0;var DN=0.0;var MN;var NN;var RN=1.0;var SN=true;var VN=null;var aL="";var eN=null;var mN;var pN;q(){MN=new FB.AL();NN=true;mN=new FB.AL();pN=new FB.AL();}static const  iI=const yB<VD>(BB.tE); get hJ=>q.iI.forTarget(this); get x=>NM; get y=>UM; get vC=>bM; get wC=>iM; get ZC=>oM; get aC=>uM; get QC=>DN; get alpha=>RN; get visible=>SN; get mask=>VN; get name=>aL; get parent=>eN; get root{var g=this;while (g.eN!=null)g=g.eN;return g;} get WE{var g=this.root;if(g is bD)return g;return null;}set x( g){NM=g;NN=true;}set y( g){UM=g;NN=true;}set vC( g){bM=g;NN=true;}set wC( g){iM=g;NN=true;}set ZC( g){oM=g;NN=true;}set aC( g){uM=g;NN=true;}set QC( g){DN=g;NN=true;}set alpha( g){RN=g;NN=true;}set visible( g){SN=g;NN=true;}set mask( g){VN=g;} get width=>jB(WO).width; get height=>jB(WO).height; set width( h){this.ZC=1;var g=this.width;this.ZC=(g!=0.0)?h/g:1.0;} set height( h){this.aC=1;var g=this.height;this.aC=(g!=0.0)?h/g:1.0;} tI( g){g.v(this);} CK(){if(eN!=null)eN.qB(this);} get WO{if(NN){NN=false;if(DN==0.0){MN.FH(oM,0.0,0.0,uM,NM-bM*oM,UM-iM*uM);}else{var g=ZB.cos(DN);var h=ZB.sin(DN);var i=oM*g;var l=oM*h;var k=-uM*h;var j=uM*g;var o=NM-bM*i-iM*k;var s=UM-bM*l-iM*j;MN.FH(i,l,k,j,o,s);}}return MN;} jB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.xK();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} KC( g, h){if(jB(pN).contains(g,h))return this;return null;} mG( h){mN.hG();for(q g=this;g!=null;g=g.eN)mN.concat(g.WO);return mN.NH(h);} mC( h){mN.hG();for(q g=this;g!=null;g=g.eN)mN.concat(g.WO);mN.YJ();return mN.NH(h);} dispatchEvent( h){var g=null;if(h.HF||h.bubbles)for(q j=eN;j!=null;j=j.eN)if(j.UJ(h.type)){if(g==null)g=new List<q>();g.add(j);}if(h.HF&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.dF==false)g[i].fO(h,this,g[i],qC.zF);if(h.dF==false)fO(h,this,this,qC.DE);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.dF==false)g[i].fO(h,this,g[i],qC.BI);} uO( h){for(var g=h;g!=null;g=g.eN)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");eN=h;} TB( g);}abstract class GB extends q{var GJ=false;var qG=true;var wK=true;var tabIndex=0;static const  KI=const yB<p>(p.FE);static const  UI=const yB<p>(p.uE);static const  YI=const yB<p>(p.hC);static const  dI=const yB<p>(p.ZD);static const  jI=const yB<p>(p.QI); get onMouseOut=>GB.KI.forTarget(this); get onMouseMove=>GB.UI.forTarget(this); get onMouseDown=>GB.YI.forTarget(this); get onMouseUp=>GB.dI.forTarget(this); get onMouseWheel=>GB.jI.forTarget(this);static const  kI=const yB<OB>(OB.MG);static const  mI=const yB<OB>(OB.FG);static const  nI=const yB<OB>(OB.HG); get onTouchMove=>GB.kI.forTarget(this); get onTouchEnd=>GB.mI.forTarget(this); get onTouchCancel=>GB.nI.forTarget(this);static const  oI=const yB<GC>(GC.EG);static const  pI=const yB<GC>(GC.qE); get onKeyUp=>GB.oI.forTarget(this); get onKeyDown=>GB.pI.forTarget(this);}abstract class rC extends GB{var OM;var VM=true;var gM=true;rC(){OM=new List<q>();} v( g){if(g.parent==this){var h=OM.indexOf(g);OM.removeAt(h);OM.add(g);}else{qI(g,OM.length);}} qI( g, h){if(h<0&&h>OM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){OM.removeAt(OM.indexOf(g));if(h>OM.length)h-- ;OM.insertRange(h,1,g);}else{g.CK();g.uO(this);OM.insertRange(h,1,g);g.dispatchEvent(new BB(BB.sH,true));if(this.WE!=null)vO(g,new BB(BB.DG));}} qB( h){var g=OM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");BK(g);} BK( g){if(g<0&&g>=OM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=OM[g];h.dispatchEvent(new BB(BB.II,true));if(this.WE!=null)vO(h,new BB(BB.LI));h.uO(null);OM.removeAt(g);} eG( g){if(g<0&&g>=OM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return OM[g];} JD( g){return OM.indexOf(g);} JH( j, i){var h=JD(j);var g=JD(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");OK(h,g);} OK( h, g){var j=eG(h);var i=eG(g);OM[h]=i;OM[g]=j;} contains( g){for(;g!=null;g=g.eN)if(g==this)return true;return false;} jB( s,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.xK();if(OM.length==0)return super.jB(s,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var w=OM.length;for(int l=0;l<OM.length;l++ ){var o=OM[l];mN.LF(o.WO,s);var g=o.jB(mN,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} KC( w, EB){var l=null;for(int j=OM.length-1;j>=0;j-- ){var i=OM[j];if(i.visible){var g=i.WO;var o=w-g.fB;var k=EB-g.gB;var JB=(g.d*o-g.c*k)/g.lC;var s=(g.a*k-g.b*o)/g.lC;var h=i.KC(JB,s);if(h!=null){if(h is GB)if(h.qG)return VM?h:this;l=this;}}}return l;} TB( i){for(int g=0;g<OM.length;g++ ){var h=OM[g];if(h.visible)i.CH(h);}} vO( g, j){g.dispatchEvent(j);if(g is rC){var i=new List<q>.from(g.OM);for(int h=0;h<i.length;h++ )vO(i[h],j);}}}class wF{var target=null;var VC=false;var IF=0;var dD=0;var pG,rG;var nG,oG;wF(this.pG,this.rG,this.nG,this.oG);}class xD extends GB{var fF;var zG;var bG;var OE;var gF=true;var enabled=true;var KN;xD([this.fF,this.zG,this.bG,this.OE]){t(p.NG,ZN);t(p.FE,ZN);t(p.hC,ZN);t(p.ZD,ZN);KN=this.fF;} jB( g,[ returnRectangle]){if(KN!=null){mN.LF(KN.WO,g);return KN.jB(mN,returnRectangle);}return super.jB(g,returnRectangle);} KC( k, l){if(this.OE!=null){var g=this.OE.WO;var h=k-g.fB;var i=l-g.gB;var o=(g.d*h-g.c*i)/g.lC;var j=(g.a*i-g.b*h)/g.lC;if(this.OE.KC(o,j)!=null)return this;}return null;} TB( g){if(KN!=null)g.CH(KN);} ZN( g){if(g.type==p.FE){KN=fF;}else{KN=g.VC?bG:zG;}}}class vF extends q{var jL;vF(){jL=new uF();} get QB=>jL; jB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.xK();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} KC( g, h){return null;} TB( g){jL.TB(g);}}class BD extends rC{var iK=false;var gF=false;}class tF extends VB{tF(){}static  pH( i){var h=new tF();var g=new kB.Completer<VB>();pC.window.setTimeout(()=>g.complete(h),1);return g.future;} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new dB();return new cK(this,loop,soundTransform);}}class CD{static const  nH=0;static const  KG=1;static const  EE=2;static const  FI=3;static const  JG=4;}abstract class jE{ TB( g);}class hB extends q{var nB;var vJ;var JF;hB([this.nB=null,this.vJ="auto"]){JF=null;} jB( h,[ returnRectangle]){var g=(nB!=null)?nB.width:0;var i=(nB!=null)?nB.height:0;return AF(h,g,i,returnRectangle);} KC( g, h){if(nB!=null&&g>=0.0&&h>=0.0&&g<nB.width&&h<nB.height)return this;return null;} TB( g){if(nB!=null){if(JF==null)nB.TB(g);else nB.EK(g,JF);}}}class bB implements jE{var tL;var yL;var MM;var ZM;var kL;var qM;var zM;var HN;var HM;var PM;var XM;var dM;bB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){tL=g;yL=h;MM=transparent;var i=new pC.CanvasElement(width:tL,height:yL);kL=i.context2d;kL.fillStyle=MM?xE(fillColor):YD(fillColor);kL.fillRect(0,0,g,h);ZM=i;qM=0;}bB.BL( g){tL=g.naturalWidth;yL=g.naturalHeight;MM=true;ZM=g;qM=0;}bB.CL( g){tL=g.tJ;yL=g.sJ;MM=true;ZM=g.QK.VJ;qM=g.GK?2:1;zM=g.offsetX.toDouble();HN=g.offsetY.toDouble();HM=g.MJ.toDouble();PM=g.NJ.toDouble();XM=g.LJ.toDouble();dM=g.KJ.toDouble();}static  TG( i){var h=new kB.Completer<bB>();var g=new pC.ImageElement();g.onLoad.listen((j)=>h.complete(new bB.BL(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>tL; get height=>yL; clone(){var g=new bB(tL,yL,true,0);g.HJ(this);return g;} HJ( h,[ matrix=null]){var g=DP();var i=new iB.zK(g,matrix);h.TB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} SJ( j, h){var i=DP();var k=i.getImageData(j,h,1,1);var g=k.data;if(lI){return (g[0]<<16)+(g[1]<<8)+(g[2]<<0)+(g[3]<<24);}else{return (g[3]<<16)+(g[2]<<8)+(g[1]<<0)+(g[0]<<24);}} TB( g){switch (qM){case 0:g.context.drawImage(ZM,0.0,0.0);break;case 1:g.context.drawImage(ZM,HM,PM,XM,dM,zM,HN,XM,dM);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,zM,HN+dM);g.context.drawImage(ZM,HM,PM,dM,XM,0.0,0.0,dM,XM);break;}} EK( cB, g){if(g.width<=0.0||g.height<=0.0)return;switch (qM){case 0:cB.context.drawImage(ZM,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=HM;double h=PM;double EB=j+XM;double JB=h+dM;double l=HM-zM+g.x;double o=PM-HN+g.y;double YB=l+g.width;double NB=o+g.height;double w=(j>l)?j:l;double s=(h>o)?h:o;double sB=(EB<YB)?EB:YB;double hF=(JB<NB)?JB:NB;double iF=zM-j+w;double oC=HN-h+s;double k=sB-w;double i=hF-s;if(k>0.0&&i>0.0){cB.context.drawImage(ZM,w,s,k,i,iF,oC,k,i);}break;case 2:double j=HM;double h=PM;double EB=j+dM;double JB=h+XM;double l=HM+HN-g.y+dM-g.height;double o=PM-zM+g.x;double YB=l+g.height;double NB=o+g.width;double w=(j>l)?j:l;double s=(h>o)?h:o;double sB=(EB<YB)?EB:YB;double hF=(JB<NB)?JB:NB;double iF=zM-h+s;double oC=HN+EB-sB;double k=hF-s;double i=sB-w;if(k>0.0&&i>0.0){cB.context.transform(0.0,-1.0,1.0,0.0,iF,oC+i);cB.context.drawImage(ZM,w,s,i,k,0.0,0.0,i,k);}break;}} DP(){if(kL==null){var g=new pC.CanvasElement(width:tL,height:yL);kL=g.context2d;switch (qM){case 0:kL.drawImage(ZM,0,0);break;case 1:kL.drawImage(ZM,HM,PM,XM,dM,zM,HN,XM,dM);break;case 2:kL.setTransform(0.0,-1.0,1.0,0.0,zM,HN+dM);kL.drawImage(ZM,HM,PM,dM,XM,0.0,0.0,dM,XM);kL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}ZM=g;qM=0;}return kL;}}typedef  mH<BE extends BB>( event);class rH<BE extends BB> extends kB.StreamSubscription<BE>{var nM;var wM;var BN;var IN;rH(this.nM,this.wM){BN=0;IN=false;} cancel(){if(IN==false){nM.qN(this);IN=true;wM=null;}} onError( g( error)){} get YO=>BN>0; pause([ resumeSignal]){BN++ ;if(resumeSignal!=null)resumeSignal.whenComplete(resume);} resume(){if(YO==false)throw new StateError("Subscription is not paused.");BN-- ;}} YD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class IG{static var LG=false;static var vE=false;static var wE=0;static var SI=rF.zH;static var DI=new xB();static WI(){if(LG==false){LG=true;var g=pC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){vE=true;wE=10;}if(g.contains("Android")){vE=true;wE=10;}if(g.contains("IEMobile")){vE=true;wE=10;}}}static  get hI{WI();return SI;}}class OG{static var RI=0;var XE=RI++ ;var target=null;var TE=false;OG(this.target,this.TE);} xE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class yE{static  zE( g){return g;}}class aI implements fC{var wN;var yN;var BO;var EO;var GO;var HO;var EM;var lL;var LO;var PO;var TO;aI( g, h,[ transitionFunction( ratio)]){wN=g;yN=(transitionFunction!=null)?transitionFunction:yE.zE;lL=0.0;EM=ZB.max(0.0001,h);LO=0.0;PO=false;TO=false;BO=new List<jH>();} JE( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(wN!=null&&TO==false)BO.add(new jH(g,0.0,h));} moveTo( h, g){JE('x',h);JE('y',g);} ED( l){if(lL<EM||TO==false){lL=lL+l;if(lL>EM)lL=EM;if(lL>=0.0){if(TO==false){TO=true;for(int i=0;i<BO.length;i++ ){var g=BO[i];switch (g.name){case 'x':g.EC=wN.x;break;case 'y':g.EC=wN.y;break;case 'pivotX':g.EC=wN.vC;break;case 'pivotY':g.EC=wN.wC;break;case 'scaleX':g.EC=wN.ZC;break;case 'scaleY':g.EC=wN.aC;break;case 'rotation':g.EC=wN.QC;break;case 'alpha':g.EC=wN.alpha;break;}}if(EO!=null)EO();}var j=lL/EM;var k=yN(j);for(int i=0;i<BO.length;i++ ){var g=BO[i];var h=g.EC+k*(g.LH-g.EC);h=PO?h.round():h;switch (g.name){case 'x':wN.x=h;break;case 'y':wN.y=h;break;case 'pivotX':wN.vC=h;break;case 'pivotY':wN.wC=h;break;case 'scaleX':wN.ZC=h;break;case 'scaleY':wN.aC=h;break;case 'rotation':wN.QC=h;break;case 'alpha':wN.alpha=h;break;}}if(GO!=null)GO();if(HO!=null&&lL==EM)HO();}}return lL<EM;} get currentTime=>lL;} bI( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class bD extends rC{var vN;var kL;var JO;var MO;var SO;var VO;var XO;var bO;var dO;var gO;var hO;var iO;var jO;var mO;var nO;bD( h, g){aL=h;vN=g;vN.focus();kL=g.context2d;MO=new iB.zK(kL);SO=WD.pE;VO=lB.rE;gE.DI.t("mouseCursorChanged",tO);dO=[new wF(p.hC,p.ZD,p.sC,p.AI),new wF(p.TI,p.XI,p.PG,p.PG),new wF(p.ZI,p.cI,p.QG,p.QG)];bO=null;XO=new DB(0,0);hO=new p(p.sC,true);mO=ZN;vN.onMouseDown.listen(mO);vN.onMouseUp.listen(mO);vN.onMouseMove.listen(mO);vN.onMouseOut.listen(mO);vN.onMouseWheel.listen(mO);gO=new Map<int,OG>();jO=new OB(OB.AG,true);nO=wO;IG.DI.t("inputModeChanged",xO);xO(null);iO=new GC(GC.qE,true);vN.onKeyDown.listen(zO);vN.onKeyUp.listen(zO);vN.onKeyPress.listen(AP);} get focus=>JO; BP(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){BP();} set y( g){BP();} set vC( g){BP();} set wC( g){BP();} set ZC( g){BP();} set aC( g){BP();} set QC( g){BP();} set alpha( g){BP();} set width( g){BP();} set height( g){BP();} bJ(){if(SO==WD.pE||SO==WD.GG){MO.reset();TB(MO);if(SO==WD.GG)SO=WD.wH;}} tO( g){vN.style.cursor=gE.SG(VO);} ZN( j){j.preventDefault();var NB=vN.getBoundingClientRect();var s=new DateTime.now().millisecondsSinceEpoch;var EB=j.button;var h=null;var i=new DB(j.clientX-NB.left,j.clientY-NB.top);var o=null;if(EB<0||EB>2)return;if(j.type=="mousemove"&&XO.equals(i))return;var g=dO[EB];XO=i;if(j.type!="mouseout")h=KC(i.x,i.y) as GB;var k=lB.rE;if(h is BD)if(h.gF)k=lB.sE;if(h is xD)if(h.gF)k=lB.sE;if(VO!=k){VO=k;vN.style.cursor=gE.SG(k);}if(bO!=null&&bO!=h){bO.dispatchEvent(hO..uN(p.FE,true)..rO=(bO.WE!=null)?bO.mC(i):new DB.xK()..sO=i..kO=g.VC);bO=null;}if(h!=null&&h!=bO){h.dispatchEvent(hO..uN(p.NG,true)..rO=h.mC(i)..sO=i..kO=g.VC);bO=h;}var l=null;var w=false;var JB=false;if(j.type=="mousedown"){l=g.pG;if(h!=g.target||s>g.IF+500)g.dD=0;g.VC=true;g.target=h;g.IF=s;g.dD++ ;}if(j.type=="mouseup"){l=g.rG;g.VC=false;w=(g.target==h);JB=w&&g.dD.isEven&&(s<g.IF+500);}if(j.type=="mousemove"){l=p.uE;}if(l!=null&&h!=null){o=h.mC(i);h.dispatchEvent(hO..uN(l,true)..rO=o..sO=i..kO=g.VC..oO=g.dD);if(w){if(JB&&h.GJ){h.dispatchEvent(hO..uN(g.oG,true)..rO=o..sO=i..kO=g.VC);}else{h.dispatchEvent(hO..uN(g.nG,true)..rO=o..sO=i..kO=g.VC);}}}}var HP=[] ; xO( h){HP.forEach((g)=>g.cancel());if(IG.hI==rF.EI){HP=[vN.onTouchStart.listen(nO),vN.onTouchEnd.listen(nO),vN.onTouchMove.listen(nO),vN.onTouchEnter.listen(nO),vN.onTouchLeave.listen(nO),vN.onTouchCancel.listen(nO)];}} wO( j){j.preventDefault();var s=vN.getBoundingClientRect();for(var o in j.changedTouches){var l=o.identifier;var h=null;var i=new DB(o.clientX-s.left,o.clientY-s.top);var w=null;h=KC(i.x,i.y) as GB;var g=gO.containsKey(l)?gO[l]:new OG(h,gO.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(jO..uN(OB.NI,true)..rO=(g.target.WE!=null)?g.target.mC(i):new DB.xK()..sO=i..xN=g.XE..zN=g.TE);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(jO..uN(OB.MI,true)..rO=h.mC(i)..sO=i..xN=g.XE..zN=g.TE);g.target=h;}var k=null;if(j.type=="touchstart"){gO[l]=g;k=OB.AG;}if(j.type=="touchend"){gO.remove(l);k=OB.FG;}if(j.type=="touchcancel"){gO.remove(l);k=OB.HG;}if(j.type=="touchmove"){k=OB.MG;}if(k!=null&&h!=null){h.dispatchEvent(jO..uN(k,true)..rO=h.mC(i)..sO=i..xN=g.XE..zN=g.TE);}}} zO( g){g.preventDefault();var h=null;if(g.type=="keyup")h=GC.EG;if(g.type=="keydown")h=GC.qE;iO..uN(h,true)..UN=g.altKey..WN=g.ctrlKey..YN=g.shiftKey..jN=g.charCode..lN=g.keyCode..nN=CD.nH;if(g.keyLocation==pC.KeyLocation.LEFT)iO.nN=CD.KG;if(g.keyLocation==pC.KeyLocation.RIGHT)iO.nN=CD.EE;if(g.keyLocation==pC.KeyLocation.NUMPAD)iO.nN=CD.FI;if(g.keyLocation==pC.KeyLocation.JOYSTICK)iO.nN=CD.JG;if(g.keyLocation==pC.KeyLocation.MOBILE)iO.nN=CD.JG;if(JO!=null)JO.dispatchEvent(iO);} AP( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new xF(xF.yH,true);h.nL=new String.fromCharCodes([i]);if(JO!=null)JO.dispatchEvent(h);}} fI( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} gI(){var g=new pC.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} AF( g, o, JB, j){var oC=0.0;var sB=0.0;var EB=o*g.a;var cB=o*g.b;var NB=o*g.a+JB*g.c;var w=o*g.b+JB*g.d;var YB=JB*g.c;var s=JB*g.d;var h=oC;if(h>EB)h=EB;if(h>NB)h=NB;if(h>YB)h=YB;var i=sB;if(i>cB)i=cB;if(i>w)i=w;if(i>s)i=s;var l=oC;if(l<EB)l=EB;if(l<NB)l=NB;if(l<YB)l=YB;var k=sB;if(k<cB)k=cB;if(k<w)k=w;if(k<s)k=s;if(j==null)j=new HB.xK();j.x=g.fB+h;j.y=g.gB+i;j.width=l-h;j.height=k-i;return j;}var lI=gI();//@ sourceMappingURL=supersonic.dart.map
