import "dart:html" as xC;import "dart:async" as YB;import "dart:json" as dK;import "dart:math" as ZB;import "dart:web_audio" as PH;class eK{static const  fK="Chrome";static const  gK="Firefox";static const  hK="Internet Explorer";static const  iK="Safari";final  CJ;final  iJ;const eK(this.CJ,[this.iJ]);}class jK{final  name;const jK(this.name);}class RC{var x;var y;RC(this.x,this.y);set length( g){this.normalize();this.jJ(g);} get length{return ZB.sqrt(x*x+y*y);}normalize(){var g=this.length;if(g==0)throw new UnsupportedError("divided by 0");if(g==1)return;x/= g;y/= g;}scale( g){x*= g;y*= g;} clone(){return new RC(x,y);} add( g){if(g==null)return null;return new RC(x+g.x,y+g.y);}jJ( g){x*= g;y*= g;} get BF{var g=ZB.PI-ZB.atan2(this.x,this.y);if(g<0)g+= 2*ZB.PI;return g;}set BF( i){var h=this.length;var g=DB.YI(h,i-ZB.PI/2);this.x=g.x;this.y=g.y;} toString(){return ("V(${x},${y})");}}class cC{var x;var y;var z;cC(this.x,this.y,this.z); clone(){return new cC(x,y,z);} gG(){return ZB.sqrt(x*x+y*y+z*z);}QK( g){this.normalize();this.scale(g);} add( g){return new cC(x+g.x,y+g.y,z+g.z);}scale( g){x*= g;y*= g;z*= g;} normalize(){var g=gG();if(g==0||g==1)return;x/= g;y/= g;z/= g;} toString(){return "V(x: ${x}, y: ${y}, z: ${z})";} equals( g){return (g.x==x&&g.y==y&&g.z==z);}}class UB extends ZE implements pC{static var nD=588;static var SD=314;static var YH=10.0;var rC;var rB;var YL;var aF;var HC;UB( g,[ autoStart=true, fontName=xD]):super(g){this.HC=fontName;this.width=UB.nD;this.height=UB.SD;this.rC=new hB(m.LB("items").CB("menu_bg"));this.v(this.rC);this.rB=new fC();this.rB.wC=0x000000;this.rB.wordWrap=true;this.rB.WC=new vF(fontName,30,0x000000,zB:true,align:lB.DE);this.rB.width=476;this.rB.height=250;this.rB.x=60;this.rB.y=90;this.v(this.rB);this.t(p.gC,this.onClick);if(autoStart){this.NH=0;this.aF=0;aB.add(this);}else{this.NH=1;}this.alpha=0;} DD( g){this.aF+= g;if(this.aF>YH){fD();KF();return false;}return true;}set text( g){if(g==null)return;var h=new vF(HC,30,0x000000,zB:true,align:lB.DE);if(g.length<=30)h.size=45;else h.size=30;this.rB.WC=h;this.rB.text=g;} onClick( g){fD();KF();} KF(){this.dispatchEvent(new KB(KB.vB,this));}set NH( g){if(g<0)g=1;if(g>1)g=1;YL=g;var h=(255*YL).round().toInt();} fD(){aB.remove(this);}}class KB extends BB{static const  vB="MenuEvent.TYPE_OK";static const  oD="MenuEvent.TYPE_CANCEL";var PE;KB( h, g,[ bubbles=false]):super(h,bubbles){this.PE=g;}}class RH extends ZE{var rC;var aC;var BC;var AC;var NC;var LC;var MC;var font;var cF=30;var UE;RH( h,[ fontName=xD]):super(h){this.font=fontName;this.sC();var g=new StringBuffer();g.write((this.u as tB).eB("GENlevel"));g.write(": 0");AC.text=g.toString();} sC(){this.rC=new hB(m.LB("items").CB("topbar"));this.rC.x=0;this.rC.y=0;this.v(this.rC);this.aC=new fC();this.aC.WC=new vF(font,24,0,zB:true,align:lB.JG);this.aC.wC=0x000000;this.aC.width=400;this.aC.height=100;this.aC.x=20;this.aC.y=cF;this.v(aC);this.BC=new fC();this.BC.WC=new vF(font,24,0,zB:true,align:lB.FE);this.BC.wC=0x000000;this.BC.width=200;this.BC.height=100;this.BC.x=(this.u.ME/2)-this.BC.width+60;this.BC.y=cF;this.v(BC);this.AC=new fC();this.AC.WC=new vF(font,24,0,zB:true,align:lB.FE);this.AC.wC=0x000000;this.AC.width=200;this.AC.height=100;this.AC.x=(this.u.ME)-(this.AC.width)-20;this.AC.y=cF;this.v(AC);this.NC=new fC();this.NC.WC=new vF(font,24,0,zB:true,align:lB.DE);this.NC.wC=0x000000;this.NC.width=200;this.NC.height=100;this.NC.x=20;this.NC.y=this.u.dG-this.NC.height-20;this.v(NC);this.NC.visible=false;this.LC=new hB(m.LB("items").CB("progressbar"));this.LC.x=25;this.LC.y=82;this.v(this.LC);this.MC=new hB(m.LB("items").CB("progressship"));this.MC.x=25;this.MC.y=this.LC.y+(this.LC.height-(this.LC.height-this.MC.height))-(this.MC.height);this.v(this.MC);this.UE=new List<hB>();for(var h=0;h<3;h++ ){var g=new hB(m.LB("items").CB("spaceship"));g.y=10;g.x=(this.u.ME/2)+70+(h*35);this.v(g);this.UE.add(g);}} wG( g){this.MC.x=25;this.MC.y=this.LC.y+(this.LC.height-((this.LC.height-this.MC.height)*g.u.lD))-(this.MC.height);} vG( i){var h=i.u as tB;if(h.ND){this.BC.text=h.eB("DISPLAY_TRAINING");}else{this.BC.text=h.eB("DISPLAY_LIVES");}for(var g=0;g<this.UE.length;g++ ){this.UE[g].visible=(!h.ND)&&(g<i.u.KD);}} yG( h){var i=h.u as tB;var g=new StringBuffer();g.write(i.eB("GENscore"));g.write(": ${h.u.PK.toString()}");aC.text=g.toString();} RE( h){var i=h.u as tB;var g=new StringBuffer();g.write(i.eB("GENlevel"));g.write(": ${h.u.level.toString()}");AC.text=g.toString();}}class SH extends UB{var oB;var iC;var bC;var PC;var UG=40;var VG=30;var HC;SH( g,[ fontName=xD]):super(g,true,fontName){this.HC=fontName;this.VB(p.qC);this.VB(p.gC);this.sC();} sC(){var g=this.u as tB;this.rB.wordWrap=true;this.text=g.eB("GENexitquery");this.oB=new AE(new hB(m.LB("items").CB("but_yes")),new hB(m.LB("items").CB("but_yes2")),new hB(m.LB("items").CB("but_yes2")),new hB(m.LB("items").CB("but_yes2")));this.oB.x=VG;this.oB.y=UB.SD-this.oB.height-UG;this.oB.t(p.qC,this.aK);this.v(this.oB);this.iC=new AE(new hB(m.LB("items").CB("but_no")),new hB(m.LB("items").CB("but_no2")),new hB(m.LB("items").CB("but_no2")),new hB(m.LB("items").CB("but_no2")));this.iC.x=UB.nD-this.iC.width-VG;this.iC.y=UB.SD-this.oB.height-UG;this.iC.t(p.qC,this.tG);this.v(this.iC);this.bC=new fC();this.bC.t(p.qC,this.oB.dispatchEvent);this.bC.wC=0x000000;this.bC.WC=new vF(HC,48,0,zB:true,align:lB.JG);this.bC.height=60;this.bC.x=this.oB.x+this.oB.width;this.bC.y=this.oB.y+5;this.v(this.bC);this.bC.text=g.eB("GENyes");this.PC=new fC();this.PC.t(p.qC,this.iC.dispatchEvent);this.PC.wC=0x000000;this.PC.WC=new vF(HC,48,0,zB:true,align:lB.FE);this.PC.height=60;this.PC.x=this.iC.x-this.PC.width;this.PC.y=this.oB.y+5;this.v(this.PC);this.PC.text=g.eB("GENno");}KF(){tG(null);} aK( g){fD();this.dispatchEvent(new KB(KB.vB,this));} tG( g){fD();this.dispatchEvent(new KB(KB.oD,this));}}class o extends BB{static const  RD="GameEvent.TYPE_LIVES_CHANGED";static const  pD="GameEvent.TYPE_PROGRESS_CHANGED";static const  qD="GameEvent.TYPE_PAUSE_CHANGED";static const  rD="GameEvent.TYPE_LEVEL_CHANGED";static const  sD="GameEvent.TYPE_SCORE_CHANGED";static const  tD="GameEvent.TYPE_GAME_START";static const  uD="GameEvent.TYPE_GAME_OVER";static const  vD="GameEvent.TYPE_GAME_ABORT";static const  eE="GameEvent.TYPE_GAME_SIZE_CHANGED";var u;o( h, g,[ bubbles=false]):super(h,bubbles){this.u=g;}}class ZE extends AD{var OL;ZE( g){this.u=g;}set u( g){if(OL!=null){OL.VB(o.uD);OL.VB(o.vD);OL.VB(o.eE);OL.VB(o.tD);OL.VB(o.rD);OL.VB(o.qD);OL.VB(o.sD);OL.VB(o.RD);OL.VB(o.pD);}OL=g;if(OL!=null){OL.t(o.uD,this.TF);OL.t(o.vD,this.SF);OL.t(o.eE,this.uG);OL.t(o.tD,this.UF);OL.t(o.rD,this.RE);OL.t(o.qD,this.uJ);OL.t(o.sD,this.yG);OL.t(o.RD,this.vG);OL.t(o.pD,this.wG);}} get u{return OL;} TF( g){} SF( g){} uG( g){} UF( g){} RE( g){} uJ( g){} yG( g){} vG( g){} wG( g){}}class tB extends uB{static const  kF=1.0;static const  WH=100;static const  XH=0xFFFFFF;var UK=kF;var VJ=5;var HD;var kG=false;var EH=500;var BJ=0xffffff;var pB;var IB;var JD;var ZL=true;var QE=false;var eG=60.0;var gD;var HC=xD;var OF=false;var EK="Web";tB( h, g):super(h,g){this.t(BB.CG,(i){this.dJ();});}set ND( g){ZL=g;this.dispatchEvent(new o(o.RD,this));} get ND{return ZL;} dJ(){if(!kG){this.t(p.aD,(g)=>this.QE=false);this.t(p.gC,(g)=>this.QE=true);this.GK();this.t(o.tD,this.UF);this.t(o.RD,this.sJ);this.t(o.pD,this.vJ);this.t(o.sD,this.wJ);this.t(o.rD,this.onLevelChange);this.t(o.qD,this.tJ);this.t(o.uD,this.TF);this.t(o.vD,this.SF);this.sC();this.lD=0;this.LD=0;this.KD=3;this.start();kG=true;}} eB( i,[ params=null]){var h=m.ZJ(i);if(params!=null)for(int g=0;g<params.length;g++ )h=h.replaceAll("{${g}}",params[g].toString());return h;} GK(){this.UK=kF;this.BJ=XH;this.EH=WH;this.VJ=5;this.eG=60000;} sC(){this.HD=new yC(this);this.v(this.HD);var h=m.LB("items").CB("button_exit");var g=m.LB("items").CB("button_exit_2");this.pB=new AE(new hB(h),new hB(g),new hB(h),new hB(g));this.pB.width=75;this.pB.height=66;this.pB.x=707;this.pB.y=525;this.pB.t(p.gC,pJ);this.v(this.pB);this.pB.visible=false;this.JD=new RH(this,HC);this.JD.x=0;this.JD.y=0;this.v(this.JD);} JJ(){var g=this.FD();g.text=this.eB("MESSAGE_RESTART_LEVEL");g.t(KB.vB,this.xG);} FJ( h){var g=this.FD();g.text=this.eB("MESSAGE_FREE_LEVEL_BARRIER_${h}");g.t(KB.vB,this.xG);} xG( g){this.vC(g.PE);this.HD.DJ();} aG(){this.HD.MF();var g=this.FD();if(this.level==0){g.text=this.eB("MESSAGE_FIRST_LEVEL_WEB");}else{g.text=this.eB("MESSAGE_START_LEVEL",[(this.level+1)]);}g.t(KB.vB,this.yJ);} yJ( g){this.vC(g.PE);this.kJ();} GJ(){var g=this.FD();g.text=this.eB("MESSAGE_GAME_OVER");g.t(KB.vB,this.qJ);} qJ( g){this.vC(g.PE);} FD([ menu=null, tweenDuration=1.0, autoStart=true]){if(this.IB!=null)this.vC(this.IB);this.pB.visible=false;this.JD.visible=true;if(menu==null)this.IB=new UB(this,autoStart,HC);else this.IB=menu;this.IB.width=UB.nD;this.IB.height=UB.SD;this.IB.x=(this.ME/2)-(UB.nD/2)+30;this.IB.y=(this.dG/2)-(UB.SD/2);this.IB.alpha=0;this.v(this.IB);var g=new eI(this.IB,tweenDuration,wE.xE);g.JE("alpha",1);aB.add(g);return this.IB;} vC( g){this.paused=false;this.JD.visible=true;this.pB.visible=true;if(g==null)return;g.fD();if(this.contains(g)){this.qB(g);}this.IB=null;} XJ(){aB.remove(gD);if(this.OF)this.zG(null);this.QE=true;this.ND=false;} xJ(){if(this.IB!=null)return;if(EK.toLowerCase()=="web")return;aB.remove(gD);this.gD=new gE(this.XJ,this.eG);aB.add(this.gD);this.OF=true;this.paused=true;var g=this.FD(null,200,false);this.pB.visible=true;g.text=this.eB("MESSAGE_FIRST_LEVEL");g.t(KB.vB,this.zG);} zG( g){aB.remove(this.gD);this.OF=false;this.IB.VB(KB.vB);this.vC(this.IB);} pJ( h){if(this.IB is SH)return;var g=new SH(this,HC);this.FD(g);this.paused=true;g.t(KB.vB,this.mJ);g.t(KB.oD,this.lJ);} mJ( g){this.dispatchEvent(new o(o.vD,this));this.IB.VB(KB.vB);this.IB.VB(KB.oD);this.vC(this.IB);this.paused=true;} lJ( g){this.IB.VB(KB.vB);this.IB.VB(KB.oD);this.vC(IB);} UF( g){this.HD.MF();aB.LE(this.aG,0.5);} PJ(){this.HD.MF();} vJ( g){} sJ( g){} wJ( g){} onLevelChange( g){} tJ( g){} TF( g){aB.LE(this.GJ,2.0);} SF( g){}}class yC extends ZE{static var iF=0.025;static var bE=1.0;static var zC=600;static var cE=800;static var dE=600;static var lF=400;static var mF=300;static var TD=ZB.sqrt(cE*cE+dE*dE);static var aH=(TD*2/zC);static var nF=6;var PB;var RB;var JC;var XC;var ZF=30.0*ZB.PI/180;var YF=1.0*ZB.PI/180;var OD=0.05;var WF=-1;var SE=1;var MB;var hC;var CF=["barrier01","barrier02","barrier03","barrier04","barrier05","barrier06","barrier07"];var DF;var EF;var XG;var EJ;var LH;var XF=15;var mG;var GD=false;var KE=0;var LF;var IE;var zE=0.90;var FH=0;var aL;var nK;var WB;var UJ=0;var GC;var ED=false;var QF,RF;var hG;var jD;yC( g):super(g){aL=new CE.GL(80,60,690,524);this.mask=aL;this.DF=m.NF("speedalizer");this.EF=this.DF.play(true);this.WB=new qF();this.v(this.WB);hG=new eH(800,600);v(hG);QF=RF=0;EC.t(p.sE,this.VF);EC.t(p.gC,this.VF);EC.t(p.aD,this.VF);jD=this.oJ.listen(this.bL);} VF( g){QF=g.HH;RF=g.IH;} FK(){var g=this.u.LD;this.u.LD=g+(this.u as tB).EH*(this.u.level*this.u.KD);} uG( g){} RE( g){super.RE(g);this.VK();} VK(){ED=false;jD.pause();this.KE=0;this.u.lD=0;this.GD=false;var h=60;this.XC=new VH(TD,nF*h);for(var g=this.XC.w.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.XC.CH(g);this.PB=new RC(lF,mF);this.RB=new cC(0,0,0);this.JC=new cC(0,0,bE);this.YF=(1+(0.1*this.u.level))*ZB.PI/180;this.OD=0.015+(0.004*this.u.level);this.SE=2+this.u.level;this.WF=-this.SE;this.FH=this.u.level*2;this.XF=15+(this.u.level);this.sC();this.HJ();jD.resume();} sC(){if(this.MB!=null)this.qB(this.MB);this.MB=new QH();this.v(this.MB);if(this.GC!=null)this.qB(this.GC);this.GC=new hB(m.LB("items").CB("crosshair"));this.GC.YC=0.5;this.GC.ZC=0.5;this.GC.x=(cE/2)-this.GC.width/2;this.GC.y=(dE/2)-this.GC.height/2;this.v(this.GC);} MF(){this.ED=false;this.jD.pause();var h=60;this.XC=new VH(TD,nF*h);for(var g=this.XC.w.length;g>=0;g-- )if(g%h!=0&&g%h!=1)this.XC.CH(g);this.PB=new RC(lF,mF);this.RB=new cC(0,0,0);this.JC=new cC(0,0,bE);this.YF=2*ZB.PI/180;this.SE=0;this.WF=0;if(this.MB!=null){this.qB(this.MB);this.MB=null;}this.MB=new QH();this.v(this.MB);if(this.hC!=null){this.qB(this.hC);this.hC=null;}this.ZG();this.jD.resume();} ZG(){var g=new QC(null);g.VC=-1;g.CC=0;g.position=this.RB.clone();g.position.z=0.5;this.MB.CD(g);} YG(){var g=new QC(new hB(m.LB("items").CB("countdown01")));g.VC=0;g.CC=0;g.position=this.RB.clone();g.position.z=0.5;g.eD=0;g.hD=true;this.MB.CD(g);g=new QC(new hB(m.LB("items").CB("countdown02")));g.VC=0;g.CC=0;g.position=this.RB.clone();g.position.z=0;g.eD=1;g.hD=true;this.MB.CD(g);g=new QC(new hB(m.LB("items").CB("countdown03")));g.VC=0;g.CC=0;g.position=this.RB.clone();g.position.z=-0.5;g.eD=2;g.hD=true;this.MB.CD(g);g=new QC(new hB(m.LB("items").CB("countdown04")));g.VC=0;g.CC=0;g.position=this.RB.clone();g.position.z=-1;g.eD=3;g.hD=true;this.MB.CD(g);} IJ(){var h=1+this.u.level;if(h>=this.CF.length)h=this.CF.length-1;var i=QD.jF(0,h);var j=this.CF[i];var g=new QC(new hB(m.CB(j)));g.lC=true;g.OC=QD.jF(0,359)*ZB.PI/180;g.CC=QD.ZH(this.WF,this.SE)*ZB.PI/180;g.position=this.RB.clone();return g;} HJ(){this.YG();this.ZG();var h=0;for(var i=0;i<XF;i++ ){var g=null;if(i==XF-1){g=new QC(new hB(m.CB("finish")));g.OC=0;g.CC=5*ZB.PI/180;g.position=this.RB.clone();g.VC=0;g.lC=true;g.jG=true;this.LF=g;}else{h++ ;if(this.u.level==1&&h<=3){if(h==1){g=new QC(new hB(m.CB("training01")));g.lC=true;g.OC=0;g.CC=0;g.position=this.RB.clone();g.MD=1;}else if(h==2){g=new QC(new hB(m.CB("training02")));g.lC=true;g.OC=135*ZB.PI/180;g.CC=0;g.position=this.RB.clone();g.MD=2;}else if(h==3){g=new QC(new hB(m.CB("training02")));g.lC=true;g.OC=315*ZB.PI/180;g.CC=0;g.position=this.RB.clone();g.MD=3;}}else{g=this.IJ();}}g.kD=-i*1-3;g.position.z=g.kD;g.VC=0;this.MB.CD(g);}} rJ(){this.GD=false;var g=u as tB;g.PJ();g.aG();} bL( h){if(this.u.paused==false){this.IK();var g=this.u as tB;if(g.ND&&this.ED&&!g.QE)g.xJ();}else{iD=-1;}} NE( h){var g=new DB(this.PB.x,this.PB.y);g=this.nG(g);g=h.kC(g);return h.NE(g);} DJ(){this.ED=false;for(var g=0;g<this.MB.KC.length;g++ )this.MB.KC[g].position.z-= (2.5+1-zE)+1;IE.position.z+= (1-zE);this.YG();this.GD=false;this.OD=this.mG;this.hC.visible=false;} nJ(){var g=this.u as tB;g.pB.visible=false;this.GD=false;this.ED=false;this.mG=this.OD;this.OD=0;if(this.hC!=null)this.qB(this.hC);this.hC=new hB(m.CB("broken"));this.v(this.hC);if(this.IE.MD>0&& ++this.UJ<=5){aB.LE((){g.FJ(this.IE.MD);},2.0);}else{this.u.KD-- ;if(this.u.KD>0)aB.LE(g.JJ,2.0);}this.EF.stop();this.EF=this.DF.play(true);this.XG=m.NF("crash");this.EJ=this.XG.play();}var iD=-1; IK(){var k=aB.elapsedTime;var h=1.0;if(iD==-1)iD=k;h=ZB.min(k-iD,1.0000)*40;iD=k;if(GD){this.KE-= (this.OD*h);var s=this.u.LD;this.u.LD=s+(this.FH*h);}this.MB.TK();this.ZF+= (this.YF*h);this.JC.x=-(this.QF-this.PB.x)*3;this.JC.y=-(this.RF-this.PB.y)*3;if(this.JC.gG()>TD*0.7){this.JC.QK(TD*0.7);}this.JC.z=bE;this.RB=this.JC.clone();this.RB.z=iF;this.HK();for(var n=0;n<this.MB.KC.length;n++ ){var g=this.MB.KC[n];g.position.z+= (OD*h);if(g.position.z>=1){if(g.hD&&g.eD==3)ED=true;if(g.cD!=null){this.LH=m.NF("swish");var AB=this.LH.play();}if(g.lC)GD=true;if(g.kD!=0)this.KE=g.kD;if(g.lC&&NE(g)){g.position.z=zE;IE=g;this.nJ();}else{if(g.MD==3)(this.u as tB).ND=false;if(g.lC)this.FK();if(g.jG){this.rJ();}else if(g.VC==0){this.MB.LK(g);}else{g.position.z+= g.VC;}}}var i=this.JC.clone();i.z=g.position.z;if(i.z<0||i.z>1){g.x=100000;}else{var j=this.YE(i);j=j.add(this.PB);var l=(20*(i.z*i.z));if(l>1)l=1;g.alpha=l;g.x=j.x;g.y=j.y;g.OC+= (g.CC*h);g.setScale(PD(g.position.z)*aH);}}if(this.LF!=null)this.u.lD=(this.KE+3)/(this.LF.kD+3);} YE( g){var h=new RC(g.x,g.y);h.x*= PD(g.z);h.y*= PD(g.z);return h;} PD( g){var h=iF;if(g<0)return 0;if(g>1)return 1;return h/(h+(1-g));} HK(){if(WB==null)return;var l=2;var j=this.JC.clone();j.scale(l);var h=this.XC.transform(PD(j.z)*l,this.ZF,this.YE(j));var i=this.XC.transform(PD(this.RB.z),this.ZF,this.YE(this.RB));var k=this.YE(this.RB).add(this.PB);WB.QB.clear();WB.QB.beginPath();WB.QB.WG(k.x,k.y,this.XC.BH*PD(this.RB.z));WB.QB.closePath();WB.QB.JH(0xffcccccc,1);WB.QB.beginPath();for(var g=0;g<h.w.length;g+= 2){WB.QB.moveTo(h.w[g].x+this.PB.x,h.w[g].y+this.PB.y);WB.QB.lineTo(h.w[g+1].x+this.PB.x,h.w[g+1].y+this.PB.y);WB.QB.lineTo(i.w[g+1].x+this.PB.x,i.w[g+1].y+this.PB.y);WB.QB.lineTo(i.w[g].x+this.PB.x,i.w[g].y+this.PB.y);WB.QB.lineTo(h.w[g].x+this.PB.x,h.w[g].y+this.PB.y);}WB.QB.closePath();WB.QB.OJ(0xFF000000);}}class QC extends AD{var NL;var QL;var SL;var position;var VC=-1;var CC=0;var SK=1;var lC=false;var jG=false;var hD=false;var xK=false;var eD=0;var MD=0;var kD=0;QC( g){SL=new AD();v(SL);this.cD=g;if(this.cD==null)return;this.x=100000;}set cD( g){if(NL!=null)this.qB(NL);if(QL!=null)this.qB(QL);NL=null;QL=null;if(g!=null){NL=g;NL.tC=yC.zC/2;NL.uC=yC.zC/2;v(NL);}else{QL=new qF();v(QL);}v(SL);} get cD{return NL;} setScale( g){this.SK=g;if(QL!=null){QL.QB.clear();QL.QB.beginPath();QL.QB.WG(0,0,yC.zC/2*g);QL.QB.closePath();QL.QB.JH(0xff999999,1);}if(NL!=null)NL.YC=NL.ZC=g;SL.YC=SL.ZC=g;} NE( j){if(NL==null)return false;var g=this.nG(j);g=NL.kC(g);var k=this.cD.nB.YJ(g.x.toInt(),g.y.toInt());var l=(k>>24)&0xFF;var i=false;if(l>0){i=true;var h=new hB(m.LB("items").CB("blood"));h.tC=50;h.uC=50;h.x=g.x-yC.zC/2;h.y=g.y-yC.zC/2;SL.v(h);}return i;}}class QH extends AD{var KC;QH(){KC=new List<QC>();} TK(){this.KC.sort(bK);} CD( g){if(this.contains(g))return;this.v(g);this.KC.add(g);} LK( g){if(this.KC.length>0){var h=this.KC.indexOf(g);if(h>=0)this.KC.removeAt(h);}if(this.contains(g))this.qB(g);} bK( g, h){if(!this.contains(g)){return (this.contains(h)?1:0);}if(!this.contains(h)){return (this.contains(g)?-1:0);}if(g.position.z>h.position.z){if(this.ID(g)<this.ID(h))this.KH(g,h);return 1;}if(g.position.z<h.position.z){if(this.ID(g)>this.ID(h))this.KH(g,h);return -1;}return 0;}}class QD{static var hF=new ZB.Random();static  jF( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=QD.hF.nextInt(h+1)+g;}return i;}static  ZH( g, h){var i;if(h<g){var j=g;g=h;h=j;}if(g==h){i=g;}else{i=QD.hF.nextDouble()*(h-g)+g;}return i;}}class VH extends aE{var LL;var PL;VH( h, g):super(){if(g<3)g=3;if(h==0)h=1;this.LL=h;this.PL=g;KJ();} get BH{return LL;} KJ(){var g=new List<RC>();var h=0.0;var k=2*ZB.PI/PL;for(var j=0;j<PL;j++ ){var i=new RC(0,-LL);i.BF=h;g.add(i);h+= k;}this.w=g;}}class aE implements TH,UH{var w;aE([ pointList]){this.w=(pointList!=null)?pointList:new List();}CH( g){if(g<w.length)this.w.removeAt(g);} NE( h){var k=this.w.length;var i=k-1;var j=false;for(var g=0;g<k;g++ ){if(w[g].y<h.y&&w[i].y>=h.y||w[i].y<h.y&&w[g].y>=h.y){if(w[g].x+(h.y-w[g].y)/(w[i].y-w[g].y)*(w[i].x-w[g].x)<h.x){j=!j;}}i=g;}return j;} scale( h){if(h==0)h=double.MIN_POSITIVE;var j=this.w.length;var i=new List<RC>(j);for(var g=0;g<j;g++ ){var k=this.w[g].clone();k.scale(h);i[g]=k;}return new aE(i);} transform( l, k, n){var j=this.w.length;var i=new List<RC>(j);for(var g=0;g<j;g++ ){var h=this.w[g].clone();h.scale(l);h.BF+= k;i[g]=h.add(n);}return new aE(i);}}abstract class UH{}abstract class TH{}class uB extends AD{var ML=0;var RL=0;var TL=true;var UL=3;var VL=0.0;var WL;var XL;uB( h, g){RK(h,g);} RK( g, h){WL=g;XL=h;this.dispatchEvent(new o(o.eE,this));} get ME{return WL;} get dG{return XL;} start(){this.paused=false;this.dispatchEvent(new o(o.tD,this));} WJ(){this.dispatchEvent(new o(o.uD,this));}set lD( g){if(g<0.0)g=0.0;if(g>1.0)g=1.0;VL=g;this.dispatchEvent(new o(o.pD,this));} get lD{return VL;}set KD( g){if(g<0)g=0;UL=g;this.dispatchEvent(new o(o.RD,this));if(UL==0)this.WJ();} get KD{return UL;}set LD( g){if(g<0)g=0;ML=g;this.dispatchEvent(new o(o.sD,this));} get LD{return ML;} get PK{return ML.toDouble().round().toInt();}set level( g){if(g<0)g=0;RL=g;this.dispatchEvent(new o(o.rD,this));} get level{return RL;} kJ(){this.level+= 1;return this.level;}set paused( g){TL=g;this.dispatchEvent(new o(o.qD,this));} get paused{return TL;}}var EC;var fE;var m;var aB;var bH;var dC;var wD;var wB;const  xD="Russo One"; main(){EC=new bD("Stage",xC.query('#stage'));fE=new hH();fE.xI(EC);aB=fE.fJ;bH=new ZB.Random();var g=jB.TG("images/Loading.png");g.then((h){dC=new hB(h);dC.tC=20;dC.uC=20;dC.x=400;dC.y=270;EC.v(dC);wD=new eI(dC,100,wE.xE);wD.JE("rotation",100.0*2.0*ZB.PI);aB.add(wD);wB=new fC();wB.WC=new vF("Arial",20,0xA0A0A0,zB:true);wB.width=240;wB.height=40;wB.text="... loading ...";wB.x=400-wB.XK/2;wB.y=320;wB.rG=false;EC.v(wB);cH();});} cH(){m=new AG();m.yB("barrier01","images/barrier01.png");m.yB("barrier02","images/barrier02.png");m.yB("barrier03","images/barrier03.png");m.yB("barrier04","images/barrier04.png");m.yB("barrier05","images/barrier05.png");m.yB("barrier06","images/barrier06.png");m.yB("barrier07","images/barrier07.png");m.yB("training01","images/training01.png");m.yB("training02","images/training02.png");m.yB("finish","images/finish.png");m.yB("broken","images/broken.png");m.yI("items","images/ItemTextureAtlas.json",iE.BG);m.AF("crash","sounds/crash.mp3");m.AF("swish","sounds/swish.mp3");m.AF("speedalizer","sounds/speedalizer.mp3");m.SB("DISPLAY_LEVEL","Level: {0}");m.SB("DISPLAY_LIVES","Ships:");m.SB("DISPLAY_SCORE","Score: {0}");m.SB("DISPLAY_TRAINING","Training");m.SB("MESSAGE_FIRST_LEVEL","Remain with your finger on the screen in order to fly through the tunnel!");m.SB("MESSAGE_FIRST_LEVEL_WEB","Move the mouse pointer to navigate through the obstacles!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_1","Navigate to the center to fly through the hole!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_2","Navigate to the upper left side to fly through the hole!");m.SB("MESSAGE_FREE_LEVEL_BARRIER_3","Navigate to the bottom right side to fly through the hole!");m.SB("MESSAGE_GAME_OVER","Game\nOver!");m.SB("MESSAGE_RESTART_LEVEL","Ooops!\nGet Ready\nFor Restart!");m.SB("MESSAGE_START_LEVEL","Get Ready\nFor Level {0}!");m.SB("GENscore","Score");m.SB("GENlevel","Level");m.SB("GENexitquery","Do you really want to quit the game?");m.SB("GENyes","Yes");m.SB("GENno","No");m.load().then((j){EC.qB(dC);EC.qB(wB);aB.remove(wD);var h=new tB(800,600);h.zI(EC);h.start();}).catchError((i){for(var g in m.cG){print("Loading resouce failed: ${g.kind}.${g.name} - ${g.error}");}});}class oC{static const  yF=1;static const  EE=2;static const  BI=3;}class jE{static var xF=mB.nE;static var uH=false;static var FI=new YB.StreamController<String>();static var JI=FI.stream.asBroadcastStream();static  SG( i){var h=i;var g="auto";if(xF!=mB.nE)h=xF;switch (h){case mB.nE:g="auto";break;case mB.pE:g="default";break;case mB.qE:g="pointer";break;case mB.GI:g="move";break;case mB.HI:g="text";break;case mB.KI:g="wait";break;}if(uH)g="none";return g;}}class lK extends TC{var wL;var MM;lK( i, h, g){wL=h;MM=g;}set VE( g){MM=g;} stop(){}}class rF extends dB{rF(){}static  TG( g){return new YB.Future<dB>.of(()=>new rF());} get length{return double.NAN;} play([ loop=false, soundTransform]){if(soundTransform==null){soundTransform=new cB();}return new lK(this,loop,soundTransform);}}class gE implements pC{final  CM;var LM=0.0;var XM=0.0;var jM=1;gE( g, h):CM=g{XM=ZB.max(h,0.0001);} DD( h){var g=LM+h;while (g>=XM&&jM>0){LM=XM;jM-- ;CM();g-= XM;}LM=g;return (jM>0);} get currentTime=>LM;}class vF{var font;var size;var color;var zB;var lG;var ZK;var align;var gJ;var NK;var cJ;var PF;var letterSpacing=0;var oK=0;var pK=false;var yK=false;vF(this.font,this.size,this.color,{this.zB: false,this.lG: false,this.ZK: false,this.align: "left",this.gJ: 0,this.NK: 0,this.cJ: 0,this.PF: 0});}class XD{static var QI=gI();static var HE=lI();static var OG=nI();static  gI(){var h=(HE!=null)?"WebAudioApi":"AudioElement";var g=xC.window.navigator.userAgent;if(g.contains("IEMobile"))if(g.contains("9.0"))h="Mock";if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod"))if(g.contains("OS 3")||g.contains("OS 4")||g.contains("OS 5"))h="Mock";if(OG.length==0)h="Mock";print("dartflash: supported audio engine is: ${h}");return h;}static  lI(){try {return new PH.AudioContext();}catch (g){return null;}}static  nI(){var g=new List<String>();var h=new xC.AudioElement();var i=["maybe","probably"];if(i.indexOf(h.canPlayType("audio/ogg",""))!=-1)g.add("ogg");if(i.indexOf(h.canPlayType("audio/mpeg",""))!=-1)g.add("mp3");if(i.indexOf(h.canPlayType("audio/wav",""))!=-1)g.add("wav");print("dartflash: supported audio types are: ${g}");return g;}}class kK extends TC{var HM;var MM;var wL;var uM;var EN;kK( j, h, i){HM=j;wL=h;MM=i;var g=XD.HE;uM=g.createGain();uM.connect(g.destination,0,0);uM.gain.value=(MM!=null)?ZB.pow(MM.volume,2):1;EN=g.createBufferSource();EN.buffer=HM.vL;EN.loop=h;EN.connect(uM,0,0);EN.start(0);} set VE( g){MM=g;uM.gain.value=(MM!=null)?ZB.pow(MM.volume,2):1;} stop(){EN.stop(0);}}class fH{var name;var DC;var MH;fH(this.name,this.DC,this.MH);}class lE extends dB{var vL;lE(){if(XD.HE==null)throw new UnsupportedError("This browser does not support Web Audio API.");}static  TG( s){var h=new lE();var k=dB.RG(s);var g=new YB.Completer<dB>();xC.HttpRequest.request(k,responseType:'arraybuffer').then((i){var j=i.response;var n=XD.HE;n.decodeAudioData(j,( l){h.vL=l;g.complete(h);},(AB){g.completeError(new StateError("Failed to decode audio."));});}).catchError((AB){g.completeError(new StateError("Failed to load audio."));});return g.future;} get length{return vL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new cB();return new kK(this,loop,soundTransform);}}class DB{var x;var y;DB(this.x,this.y);DB.FL():this(0,0);static  YI( g, h)=>new DB(g*ZB.cos(h),-g*ZB.sin(h)); get length=>ZB.sqrt(this.x*this.x+this.y*this.y); add( g)=>new DB(this.x+g.x,this.y+g.y); clone()=>new DB(this.x,this.y); IF( g){this.x=g.x;this.y=g.y;} equals( g)=>this.x==g.x&&this.y==g.y;}class HB{var x;var y;var width;var height;HB(this.x,this.y,this.width,this.height);HB.FL():this(0,0,0,0); get left=>this.x; get top=>this.y; get right=>this.x+this.width; get bottom=>this.y+this.height; get size=>new DB(this.width,this.height); set size( g){this.width=g.x;this.height=g.y;} clone()=>new HB(this.x,this.y,this.width,this.height); contains( g, h)=>(this.x<=g&&this.y<=h&&this.right>=g&&this.bottom>=h); equals( g)=>(this.x==g.x&&this.y==g.y&&this.width==g.width&&this.height==g.height); get isEmpty=>(this.width==0&&this.height==0); IF( g){this.x=g.x;this.y=g.y;this.width=g.width;this.height=g.height;}}class mH{mH();}class FB{var dL,eL,fL,hL,jL,mL;var tL;FB( h, i, g, j, k, l):dL=h,eL=i,fL=g,hL=j,jL=k,mL=l,tL=h*j-i*g;FB.HL():dL=1.0,eL=0.0,fL=0.0,hL=1.0,jL=0.0,mL=0.0,tL=1.0; clone(){return new FB(dL,eL,fL,hL,jL,mL);} get a=>dL; get b=>eL; get c=>fL; get d=>hL; get fB=>jL; get gB=>mL; get jC=>tL; OH( g){return new DB(g.x*dL+g.y*fL+jL,g.x*eL+g.y*hL+mL);} concat( g){var n=dL;var EB=eL;var JB=fL;var AB=hL;var l=jL;var s=mL;var XB=tL;var j=g.a;var k=g.b;var i=g.c;var h=g.d;var bB=g.fB;var NB=g.gB;var sB=g.jC;dL=(n*j+EB*i);eL=(n*k+EB*h);fL=(JB*j+AB*i);hL=(JB*k+AB*h);jL=(l*j+s*i+bB);mL=(l*k+s*h+NB);tL=(XB*sB);} iG(){dL=1.0;eL=0.0;fL=0.0;hL=1.0;jL=0.0;mL=0.0;tL=1.0;} eJ(){var j=dL;var n=eL;var l=fL;var k=hL;var h=jL;var i=mL;var g=tL;dL=(k/g);eL=-(n/g);fL=-(l/g);hL=(j/g);jL=-(dL*h+fL*i);mL=-(eL*h+hL*i);tL=(1.0/g);} GH( h, i, g, j, k, l){dL=h;eL=i;fL=g;hL=j;jL=k;mL=l;tL=(h*j-i*g);} IF( g){dL=g.a;eL=g.b;fL=g.c;hL=g.d;jL=g.fB;mL=g.gB;tL=g.jC;} JF( h, g){var s=h.a;var JB=h.b;var NB=h.c;var EB=h.d;var n=h.fB;var AB=h.gB;var bB=h.jC;var k=g.a;var l=g.b;var j=g.c;var i=g.d;var sB=g.fB;var XB=g.gB;var mC=g.jC;dL=(s*k+JB*j);eL=(s*l+JB*i);fL=(NB*k+EB*j);hL=(NB*l+EB*i);jL=(n*k+AB*j+sB);mL=(n*l+AB*i+XB);tL=(bB*mC);}}class hH{var gL;var uL;var FM;var YM;var oM;hH(){gL=new hE();uL=new List<bD>();FM=double.NAN;YM=BE.KG;oM=new VD(0);xC.window.requestAnimationFrame(lN);} get fJ=>gL; lN( g){xC.window.requestAnimationFrame(lN);if(FM.isNaN)FM=g;if(FM>g)FM=g;var j=g-FM;var i=j/1000.0;if(j>=1){FM=g;oM.nL=i;YM.MO(oM);gL.DD(i);for(int h=0;h<uL.length;h++ ){var k=uL[h];k.hJ();}}} xI( g){uL.add(g);}}class iB{final  sL;final  RM=new List<FB>.fixedLength(100);final  wM=new List<double>.fixedLength(100);var LN=0;iB.IL( j,[ matrix]):sL=j{for(int h=0;h<100;h++ ){RM[h]=new FB.HL();wM[h]=1.0;}if(matrix!=null)RM[0].IF(matrix);var g=RM[0];var i=wM[0];sL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);sL.globalAlpha=i;} get context=>sL; reset(){LN=0;var g=RM[0];var h=wM[0];sL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);sL.globalAlpha=h;sL.clearRect(0,0,sL.canvas.width,sL.canvas.height);} DH( h){var i=LN;var j=LN+1;var l=RM[i];var g=RM[j];var n=wM[i];var k=wM[j]=h.SN*n;g.JF(h.fO,l);sL.setTransform(g.a,g.b,g.c,g.d,g.fB,g.gB);sL.globalAlpha=k;LN=j;if(h.mask==null){h.TB(this);}else{sL.save();h.mask.TB(this);h.TB(this);sL.restore();}LN=i;}}class UD{static const  nE="auto";static const  wH="stop";static const  FG="once";}class BB{static const  sH="added";static const  CG="addedToStage";static const  rE="enterFrame";static const  II="removed";static const  MI="removedFromStage";var cL;var bO;var QO;var OM;var kO;var TO;var ZO;BB( g,[ bubbles=false]){CO(g,bubbles);} CO( g,[ bubbles=false]){cL=g;bO=bubbles;QO=oC.EE;OM=null;kO=null;TO=false;ZO=false;} get bF=>TO; get type=>cL; get bubbles=>bO; get FF=>true; get target=>OM;}class iH{static const  vH="pixel";}class SC{var rL; aJ( g){if(rL!=null)return rL.containsKey(g)||rL.containsKey("${g}_CAPTURE");else return false;} t( g, i(event),{ useCapture: false}){var h=NN(g,useCapture);var j=h.listen(i);return j;} VB( g,{ useCapture: false}){var i=useCapture?"${g}_CAPTURE":g;var h=rL[i];if(h!=null)h.lO();} dispatchEvent( g){oO(g,this,this,oC.EE);} oO( g, k, l, i){if(rL!=null){var j=(i==oC.yF)?"${g.type}_CAPTURE":g.type;var h=rL[j];if(h!=null){g.OM=k;g.kO=l;g.QO=i;g.TO=false;g.ZO=false;h.MO(g);}}} NN( g, j){if(rL==null)rL=new Map<String,WD>();var i=j?"${g}_CAPTURE":g;var h=rL[i];if(h==null)h=rL[i]=new WD(this,g,j);return h;}}class BE<YD extends BB>{final  rL=new List<WD>();var gM=0;static var KG=new BE<VD>(); eN( g){for(int h=0;h<gM;h++ )if(rL[h]==g)return;if(gM==rL.length)rL.add(g);else rL[gM]=g;gM++ ;} MO( j){j.QO=oC.EE;j.TO=false;j.ZO=false;var k=gM;var i=0;for(int g=0;g<k;g++ ){var h=rL[g];if(h==null)continue;if(h.TN==0){rL[g]=null;continue;}j.OM=h.OM;j.kO=h.OM;h.MO(j);if(i!=g){rL[i]=h;rL[g]=null;}i++ ;}if(i!=k){for(int g=k;g<gM;g++ ){rL[i++ ]=rL[g];rL[g]=null;}gM=i;}}}class WD<YD extends BB> extends YB.Stream<YD>{final  OM;final  DM;final  nM;final  CN=new List<rH>();var TN=0;WD(this.OM,this.DM,this.nM); get isBroadcast=>true; asBroadcastStream()=>this; listen( h( event),{ onError( error), onDone(), unsubscribeOnError}){var g=new rH<YD>(this,h);if(TN==CN.length)CN.add(g);else CN[TN]=g;TN++ ;if(DM==BB.rE&&nM==false)BE.KG.eN(this);return g;} xN( h){for(int g=0;g<TN;g++ ){if(CN[g]==h){CN[g]=null;break;}}} lO(){for(int g=0;g<TN;g++ )if(CN[g]!=null)CN[g].cancel();} MO( k){var j=TN;var h=0;for(int g=0;g<j;g++ ){var i=CN[g];if(i==null)continue;i.GN(k);if(h!=g){CN[h]=i;CN[g]=null;}h++ ;}if(h!=j){for(int g=j;g<TN;g++ ){CN[h++ ]=CN[g];CN[g]=null;}TN=h;}}}class xB<YD extends BB>{final  DM;const xB(this.DM); forTarget( g,{ useCapture: false}){return g.NN(DM,useCapture);}}abstract class pC{ DD( g);}class VD extends BB{var nL;VD( g):super(BB.rE,false){nL=g;} get FF=>false;}class p extends BB{static const  qC="click";static const  AI="doubleClick";static const  gC="mouseDown";static const  aD="mouseUp";static const  sE="mouseMove";static const  GE="mouseOut";static const  NG="mouseOver";static const  SI="mouseWheel";static const  PG="middleClick";static const  WI="middleMouseDown";static const  ZI="middleMouseUp";static const  QG="rightClick";static const  dI="rightMouseDown";static const  hI="rightMouseUp";var KO,LO;var OO,PO;var tO;var aN;var pN;var dN;var gN;var vO;var wO;var xO;p( g,[ bubbles=false]):super(g,bubbles){CO(g,bubbles);} CO( g,[ bubbles=false]){super.CO(g,bubbles);KO=LO=0;OO=PO=0;tO=false;aN=false;pN=false;dN=false;gN=false;vO=0;wO=0;xO=0;}set yO( g){KO=g.x;LO=g.y;}set zO( g){OO=g.x;PO=g.y;} get HH=>OO; get IH=>PO; get UC=>tO; get altKey=>aN; get ctrlKey=>dN; get shiftKey=>gN; get dD=>vO;}class FC extends BB{static const  oE="keyDown";static const  DG="keyUp";var aN;var dN;var gN;var jN;var pN;var rN;var tN;var vN;FC( g,[ bubbles=false]):super(g,bubbles){CO(g,bubbles);} CO( g,[ bubbles=false]){super.CO(g,bubbles);aN=false;dN=false;gN=false;jN=false;pN=false;rN=0;tN=0;vN=0;} get altKey=>aN; get ctrlKey=>dN; get shiftKey=>gN; get charCode=>rN; get keyCode=>tN; get keyLocation=>vN;}class pF extends BB{static const  yH="textInput";var zL="";pF( g,[ bubbles=false]):super(g,bubbles){}}class OB extends BB{static const  zF="touchBegin";static const  EG="touchEnd";static const  GG="touchCancel";static const  MG="touchMove";static const  NI="touchOver";static const  OI="touchOut";var HO;var IO;var KO,LO;var OO,PO;var aN;var pN;var dN;var gN;var VO;var YO;var aO;OB( g,[ bubbles=false]):super(g,bubbles){CO(g,bubbles);} CO( g,[ bubbles=false]){super.CO(g,bubbles);HO=0;IO=false;KO=LO=0;OO=PO=0;aN=false;pN=false;dN=false;gN=false;VO=1.00;YO=0;aO=0;}set yO( g){KO=g.x;LO=g.y;}set zO( g){OO=g.x;PO=g.y;} get XE=>HO; get HH=>OO; get IH=>PO; get altKey=>aN; get ctrlKey=>dN; get shiftKey=>gN;}class mB{static const  nE="auto";static const  pE="arrow";static const  qE="button";static const  GI="hand";static const  HI="ibeam";static const  KI="wait";}class oF{static const  zH="none";static const  DI="touchPoint";}class gH{static const  zH="none";}class fC extends GB{var zL="";var JM=0x000000;var cM=null;var sM=gH.zH;var HN=iH.vH;var cL=dH.pH;var VN=false;var YN=false;var ZN=0x000000;var fN=false;var kN=0x000000;var nN=0;var qN=0;var sN;var wN;var yN=true;var AO=100;var BO=100;var DO=null;var sL=null;fC(){cM=new vF("Arial",12,0x000000);sN=new List<String>();wN=new List<uF>();} get type=>cL; get width=>AO; get height=>BO; set text( g){zL=g;yN=true;} set wC( g){JM=g;yN=true;} set WC( g){cM=g;JM=cM.color;yN=true;} set wordWrap( g){VN=g;yN=true;} set width( g){AO=g;yN=true;} set height( g){BO=g;yN=true;} get XK{FP();return nN;} kB( g,[ returnRectangle]){return yE(g,AO,BO,returnRectangle);} IC( g, h){if(g>=0&&h>=0&&g<AO&&h<BO)return this;return null;} TB( g){FP();g.sL.drawImage(DO,0.0,0.0);} HP(){sN.clear();wN.clear();if(VN==false){sN.add(zL);}else{for(String s in zL.replaceAll('\r','').split('\n')){var h=new StringBuffer();var i=0;var g="";for(String j in s.split(' ')){i=h.length;h.write((i>0)?" ${j}":j);g=h.toString();if(sL.measureText(g).width>AO){if(i>0){g=g.substring(0,i);}else{j="";}sN.add(g);h=new StringBuffer();h.write(j);}}if(h.isEmpty==false){sN.add(h.toString());}}}nN=0;qN=0;for(String g in sN){var l=sL.measureText(g);var n=0;if(cM.align==lB.DE||cM.align==lB.CI)n=(AO-l.width)/2;if(cM.align==lB.FE||cM.align==lB.xH)n=AO-l.width;var k=new uF(n,l.width,cM.size,0,0,0);wN.add(k);nN=ZB.max(nN,k.width);qN=qN+k.height;}} FP(){if(yN){yN=false;var j=AO.ceil().toInt();var i=BO.ceil().toInt();if(DO==null){DO=new xC.CanvasElement(width:j,height:i);sL=DO.context2d;}if(DO.width!=j)DO.width=j;if(DO.height!=i)DO.height=i;var g=new StringBuffer();g.write(cM.lG?"italic ":"normal ");g.write("normal ");g.write(cM.zB?"bold ":"normal ");g.write("${cM.size}px ");g.write("${cM.font},sans-serif");sL.font=g.toString();sL.textAlign="start";sL.textBaseline="top";sL.fillStyle=ZD(JM);HP();if(YN){sL.fillStyle=ZD(ZN);sL.fillRect(0,0,AO,BO);}else{sL.clearRect(0,0,AO,BO);}var k=0;for(int h=0;h<sN.length;h++ ){var l=wN[h];sL.fillStyle=ZD(JM);sL.fillText(sN[h],l.x,k);k+= l.height;}if(fN){sL.strokeStyle=ZD(kN);sL.lineWidth=1;sL.strokeRect(0,0,AO,BO);}}}}class yD{var lL;var iL;var IM;var TM;var bM;var lM;yD( g, h, i){lL=g;iL=h;IM=i;bM=null;lM=null;} get kind=>lL; get name=>iL; get mD=>lM; get error=>bM;EO( i){TM=i.then((g){lM=g;bM=null;},onError:( h){lM=null;bM=h.error;});}}abstract class q extends SC implements mE{var UM=0.0;var ZM=0.0;var hM=0.0;var rM=0.0;var xM=1.0;var DN=1.0;var MN=0.0;var SN=1.0;var UN=true;var WN=null;var iL="";var cN=null;final  hN=new FB.HL();final  oN=new FB.HL();final  uN=new FB.HL();var zN=true;static const  mI=const xB<VD>(BB.rE); get oJ=>q.mI.forTarget(this); get x=>UM; get y=>ZM; get tC=>hM; get uC=>rM; get YC=>xM; get ZC=>DN; get OC=>MN; get alpha=>SN; get visible=>UN; get mask=>WN; get name=>iL; get parent=>cN; get root{var g=this;while (g.cN!=null)g=g.cN;return g;} get WE{var g=this.root;if(g is bD)return g;return null;}set x( g){UM=g;zN=true;}set y( g){ZM=g;zN=true;}set tC( g){hM=g;zN=true;}set uC( g){rM=g;zN=true;}set YC( g){xM=g;zN=true;}set ZC( g){DN=g;zN=true;}set OC( g){MN=g;zN=true;}set alpha( g){SN=g;zN=true;}set visible( g){UN=g;zN=true;}set mask( g){WN=g;} get width=>kB(fO).width; get height=>kB(fO).height; set width( h){this.YC=1;var g=this.width;this.YC=(g!=0.0)?h/g:1.0;} set height( h){this.ZC=1;var g=this.height;this.ZC=(g!=0.0)?h/g:1.0;} zI( g){g.v(this);} KK(){if(cN!=null)cN.qB(this);} get fO{if(zN){zN=false;if(MN==0.0){uN.GH(xM,0.0,0.0,DN,UM-hM*xM,ZM-rM*DN);}else{var g=ZB.cos(MN);var h=ZB.sin(MN);var i=xM*g;var l=xM*h;var k=-DN*h;var j=DN*g;var n=UM-hM*i-rM*k;var s=ZM-hM*l-rM*j;uN.GH(i,l,k,j,n,s);}}return uN;} kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.FL();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} IC( g, h){if(kB(oN).contains(g,h))return this;return null;} nG( h){hN.iG();for(q g=this;g!=null;g=g.cN)hN.concat(g.fO);return hN.OH(h);} kC( h){hN.iG();for(q g=this;g!=null;g=g.cN)hN.concat(g.fO);hN.eJ();return hN.OH(h);} dispatchEvent( h){var g=null;if(h.FF||h.bubbles)for(q j=cN;j!=null;j=j.cN)if(j.aJ(h.type)){if(g==null)g=new List<q>();g.add(j);}if(h.FF&&g!=null)for(int i=g.length-1;i>=0;i-- )if(h.bF==false)g[i].oO(h,this,g[i],oC.yF);if(h.bF==false)oO(h,this,this,oC.EE);if(h.bubbles&&g!=null)for(int i=0;i<g.length;i++ )if(h.bF==false)g[i].oO(h,this,g[i],oC.BI);} AP( h){for(var g=h;g!=null;g=g.cN)if(g==this)throw new ArgumentError("Error #2150: An object cannot be added as a child to one of it's children (or children's children, etc.).");cN=h;} TB( g);}abstract class GB extends q{var MJ=false;var rG=true;var EL=true;var tabIndex=0;static const  LI=const xB<p>(p.GE);static const  XI=const xB<p>(p.sE);static const  bI=const xB<p>(p.gC);static const  iI=const xB<p>(p.aD);static const  pI=const xB<p>(p.SI); get onMouseOut=>GB.LI.forTarget(this); get onMouseMove=>GB.XI.forTarget(this); get onMouseDown=>GB.bI.forTarget(this); get onMouseUp=>GB.iI.forTarget(this); get onMouseWheel=>GB.pI.forTarget(this);static const  qI=const xB<OB>(OB.MG);static const  sI=const xB<OB>(OB.EG);static const  tI=const xB<OB>(OB.GG); get onTouchMove=>GB.qI.forTarget(this); get onTouchEnd=>GB.sI.forTarget(this); get onTouchCancel=>GB.tI.forTarget(this);static const  uI=const xB<FC>(FC.DG);static const  vI=const xB<FC>(FC.oE); get onKeyUp=>GB.uI.forTarget(this); get onKeyDown=>GB.vI.forTarget(this);}abstract class nC extends GB{final  WM=new List<q>();var qM=true;var AN=true; v( g){if(g.parent==this){var h=WM.indexOf(g);WM.removeAt(h);WM.add(g);}else{wI(g,WM.length);}} wI( g, h){if(h<0&&h>WM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");if(g==this)throw new ArgumentError("Error #2024: An object cannot be added as a child of itself.");if(g.parent==this){WM.removeAt(WM.indexOf(g));if(h>WM.length)h-- ;WM.insertRange(h,1,g);}else{g.KK();g.AP(this);WM.insertRange(h,1,g);g.dispatchEvent(new BB(BB.sH,true));if(this.WE!=null)BP(g,new BB(BB.CG));}} qB( h){var g=WM.indexOf(h);if(g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");JK(g);} JK( g){if(g<0&&g>=WM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");var h=WM[g];h.dispatchEvent(new BB(BB.II,true));if(this.WE!=null)BP(h,new BB(BB.MI));h.AP(null);WM.removeAt(g);} fG( g){if(g<0&&g>=WM.length)throw new ArgumentError("Error #2006: The supplied index is out of bounds.");return WM[g];} ID( g){return WM.indexOf(g);} KH( j, i){var h=ID(j);var g=ID(i);if(h==-1||g==-1)throw new ArgumentError("Error #2025: The supplied DisplayObject must be a child of the caller.");WK(h,g);} WK( h, g){var j=fG(h);var i=fG(g);WM[h]=i;WM[g]=j;} contains( g){for(;g!=null;g=g.cN)if(g==this)return true;return false;} kB( s,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.FL();if(WM.length==0)return super.kB(s,returnRectangle);var h=double.INFINITY;var i=double.INFINITY;var k=double.NEGATIVE_INFINITY;var j=double.NEGATIVE_INFINITY;var AB=WM.length;for(int l=0;l<WM.length;l++ ){var n=WM[l];hN.JF(n.fO,s);var g=n.kB(hN,returnRectangle);if(g.left<h)h=g.left;if(g.top<i)i=g.top;if(g.right>k)k=g.right;if(g.bottom>j)j=g.bottom;}returnRectangle.x=h;returnRectangle.y=i;returnRectangle.width=k-h;returnRectangle.height=j-i;return returnRectangle;} IC( AB, EB){var l=null;for(int j=WM.length-1;j>=0;j-- ){var i=WM[j];if(i.visible){var g=i.fO;var n=AB-g.fB;var k=EB-g.gB;var JB=(g.d*n-g.c*k)/g.jC;var s=(g.a*k-g.b*n)/g.jC;var h=i.IC(JB,s);if(h!=null){if(h is GB)if(h.rG)return qM?h:this;l=this;}}}return l;} TB( i){for(int g=0;g<WM.length;g++ ){var h=WM[g];if(h.visible)i.DH(h);}} BP( g, j){g.dispatchEvent(j);if(g is nC){var i=new List<q>.from(g.WM);for(int h=0;h<i.length;h++ )BP(i[h],j);}}}class tF{var target=null;var UC=false;var GF=0;var dD=0;var qG,sG;var oG,pG;tF(this.qG,this.sG,this.oG,this.pG);}abstract class dB{static  TG( g){var h=XD.QI;if(h=="WebAudioApi")return lE.TG(g);if(h=="AudioElement")return kE.TG(g);return rF.TG(g);} get length; play([ loop=false, soundTransform]);static  RG( g){var n=new RegExp(r"\.(ogg|mp3|wav)$",multiLine:false,caseSensitive:false);var i=n.firstMatch(g);var h=XD.OG;if(i==null)throw new ArgumentError("Unsupported file extension.");if(h.length==0)throw new UnsupportedError("This browser supports no known audio codec.");var j=i.group(1).toLowerCase();if(h.indexOf(j)==-1){var l=g.substring(0,g.length-j.length);var k=h[0];g="${l}${k}";}return g;}}class kE extends dB{var yL;var QM;var mM;kE(){mM=new List<zD>();yL=new xC.AudioElement();yL.onEnded.listen(XN);QM=new List<xC.AudioElement>();QM.add(yL);xC.document.body.children.add(yL);}static  TG( AB){var k=new kE();var g=k.yL;var i=new YB.Completer<dB>();var h;var j;s(n){h.cancel();j.cancel();i.complete(k);}l(n){h.cancel();j.cancel();i.completeError(new StateError("Failed to load audio."));}h=g.onCanPlayThrough.listen(s);j=g.onError.listen(l);g.src=dB.RG(AB);g.load();return i.future;} get length{return yL.duration;} play([ loop=false, soundTransform]){if(soundTransform==null)soundTransform=new cB();return new zD(this,loop,soundTransform);} mN( h){var g;if(QM.length==0){g=yL.clone(true);g.onEnded.listen(XN);}else{g=QM.removeAt(0);}mM.add(h);return g;} uO( g){var h=g.yL;var i=mM.indexOf(g);mM.removeAt(i);QM.add(h);if(yL.currentTime>0&&yL.ended==false)yL.currentTime=0;} XN(j){var i=j.target;var g=null;for(int h=0;h<mM.length&&g==null;h++ )if(mM[h].yL==i)g=mM[h];if(g!=null)g.stop();}}class AD extends nC{var qK=false;var eF=false;}class dH{static const  pH="dynamic";}class eC{final  oL=new xC.ImageElement();final  eM=new List<wF>();static  TG( n, XB){var l=new YB.Completer<eC>();var j=new eC();switch (XB){case iE.qH:case iE.BG: s( k, g){var JB=fI(k);var h=new wF(JB,j);h.NM=g["frame"]["x"].toInt();h.VM=g["frame"]["y"].toInt();h.aM=g["frame"]["w"].toInt();h.kM=g["frame"]["h"].toInt();h.tM=g["spriteSourceSize"]["x"].toInt();h.yM=g["spriteSourceSize"]["y"].toInt();h.BN=g["sourceSize"]["w"].toInt();h.KN=g["sourceSize"]["h"].toInt();h.RN=g["rotated"] as bool;j.eM.add(h);}xC.HttpRequest.getString(n).then((NB){var AB=dK.parse(NB);var i=AB["frames"];var EB=AB["meta"];if(i is List)for(var g in i)s(g["filename"],g);if(i is Map)for(String k in i.keys)s(k,i[k]);j.oL..onLoad.listen((bB)=>l.complete(j))..onError.listen((bB)=>l.completeError(new StateError("Failed to load image.")))..src=jI(n,EB["image"]);}).catchError((sB){l.completeError(new StateError("Failed to load json file."));});break;}return l.future;} get bJ=>oL; CB( i){var h;for(int g=0;g<eM.length&&h==null;g++ )if(eM[g].name==i)h=new jB.KL(eM[g]);if(h==null)throw new ArgumentError("TextureAtlasFrame not found: '${i}'");return h;}}abstract class mE{ TB( g);}class lB{static const  DE="center";static const  xH="end";static const  CI="justify";static const  JG="left";static const  FE="right";}class qF extends q{var pL;qF(){pL=new sF();} get QB=>pL; kB( g,[ returnRectangle]){if(returnRectangle==null)returnRectangle=new HB.FL();returnRectangle.x=g.fB;returnRectangle.y=g.gB;returnRectangle.width=0;returnRectangle.height=0;return returnRectangle;} IC( g, h){return null;} TB( g){pL.TB(g);}}class iE{static const  qH="json";static const  BG="jsonarray";}class AE extends GB{var dF;var AH;var bG;var OE;var eF=true;var enabled=true;var QN;AE([this.dF,this.AH,this.bG,this.OE]){t(p.NG,iN);t(p.GE,iN);t(p.gC,iN);t(p.aD,iN);QN=this.dF;} kB( g,[ returnRectangle]){if(QN!=null){hN.JF(QN.fO,g);return QN.kB(hN,returnRectangle);}return super.kB(g,returnRectangle);} IC( k, l){if(this.OE!=null){var g=this.OE.fO;var h=k-g.fB;var i=l-g.gB;var n=(g.d*h-g.c*i)/g.jC;var j=(g.a*i-g.b*h)/g.jC;if(this.OE.IC(n,j)!=null)return this;}return null;} TB( g){if(QN!=null)g.DH(QN);} iN( g){if(g.type==p.GE){QN=dF;}else{QN=g.UC?bG:AH;}}}class sF{final  qL=new List<kH>();clear()=>qL.clear();beginPath()=>qL.add(new kH("beginPath"));closePath()=>qL.add(new kH("closePath"));moveTo( h, g)=>qL.add(new kH("moveTo",[h,g]));lineTo( h, g)=>qL.add(new kH("lineTo",[h,g]));arcTo( k, i, g, h, j)=>qL.add(new kH("arcTo",[k,i,g,h,j]));quadraticCurveTo( j, i, g, h)=>qL.add(new kH("quadraticCurveTo",[j,i,g,h]));bezierCurveTo( h, k, l, i, g, j)=>qL.add(new kH("bezierCurveTo",[h,k,l,i,g,j]));arc( l, g, j, i, h, k)=>qL.add(new kH("arc",[l,g,j,i,h,k]));rect( i, g, h, j)=>qL.add(new kH("rect",[i,g,h,j]));JH( g,[ width=1, joints=lH.tH, caps=jH.tH])=>qL.add(new kH("strokeColor",[vE(g),width,joints,caps]));OJ( g)=>qL.add(new kH("fillColor",[vE(g)]));WG( i, g, h){qL.add(new kH("moveTo",[i+h,g]));qL.add(new kH("arc",[i,g,h,0,ZB.PI*2,false]));} TB( k){var h=k.context;h.save();for(var j in qL){var g=j.arguments;switch (j.name){case "beginPath":h.beginPath();break;case "closePath":h.closePath();break;case "moveTo":h.moveTo(g[0],g[1]);break;case "lineTo":h.lineTo(g[0],g[1]);break;case "arcTo":h.arcTo(g[0],g[1],g[2],g[3],g[4]);break;case "quadraticCurveTo":h.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case "bezierCurveTo":h.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "arc":h.arc(g[0],g[1],g[2],g[3],g[4],g[5]);break;case "rect":h.rect(g[0],g[1],g[2],g[3]);break;case "strokeColor":h.strokeStyle=g[0];h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokeGradient":h.strokeStyle=g[0].JP(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];h.stroke();break;case "strokePattern":h.strokeStyle=g[0].KP(h);h.lineWidth=g[1];h.lineJoin=g[2];h.lineCap=g[3];FB i=g[0].LP;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.stroke();h.restore();}else{h.stroke();}break;case "fillColor":h.fillStyle=g[0];h.fill();break;case "fillGradient":h.fillStyle=g[0].vK(h);h.fill();break;case "fillPattern":h.fillStyle=g[0].wK(h);FB i=g[0].LP;if(i!=null){h.save();h.transform(i.a,i.b,i.c,i.d,i.fB,i.gB);h.fill();h.restore();}else{h.fill();}break;}}h.restore();}}class wF{var iL;var AM;var NM;var VM;var aM;var kM;var tM;var yM;var BN;var KN;var RN;wF( g, h){iL=g;AM=h;} get YK=>AM; get name=>iL; get SJ=>NM; get TJ=>VM; get RJ=>aM; get QJ=>kM; get offsetX=>tM; get offsetY=>yM; get AK=>BN; get zJ=>KN; get OK=>RN;}class zD extends TC{var KM;var yL;var wL;var MM;zD( g, i, h){KM=g;wL=i;MM=h;yL=g.mN(this);yL.loop=wL;this.VE=h;yL.play();} set VE( g){MM=g;if(yL!=null)yL.volume=(MM!=null)?MM.volume:1;} stop(){if(yL!=null){if(yL.ended==false)yL.pause();KM.uO(this);yL=null;}}}class kH{var name;var arguments;kH(this.name,[this.arguments]);}class cB{var volume;var BK;var zK=1;var AL=0;var DL=1;var CL=0;cB([this.volume=1,this.BK=0]);}class uF{var AJ;var LJ;var height;var PF;var width;var x;uF(this.x,this.width,this.height,this.AJ,this.LJ,this.PF);}class CE{var cL;var kL;var BM;var PM;CE.GL( i, g, h, j){cL=0;kL=new HB(i,g,h,j);} TB( i){var g=i.context;g.beginPath();switch (cL){case 0:g.rect(kL.x,kL.y,kL.width,kL.height);break;case 1:g.arc(BM.x,BM.y,BM.BH,0,ZB.PI*2.0,false);break;case 2:g.moveTo(PM[0].x,PM[0].y);for(int h=1;h<PM.length;h++ )g.lineTo(PM[h].x,PM[h].y);break;}g.clip();}}class jH{static const  tH="round";}class lH{static const  tH="round";}class eH extends GB{var width;var height;eH(this.width,this.height); kB( g,[ returnRectangle]){return yE(g,width,height,returnRectangle);} IC( g, h){if(g>=0.0&&h>=0.0&&g<width&&h<height)return this;return null;} TB( g){}}class BD{static const  oH=0;static const  JG=1;static const  FE=2;static const  EI=3;static const  IG=4;}abstract class TC extends SC{ set VE( g); stop();}class hE implements pC{final  EM=new List<pC>();var dM=0;var pM=0.0; get elapsedTime=>pM; add( g){if(g==null)return;if(dM==EM.length){EM.add(g);}else{EM[dM]=g;}dM++ ;} remove( h){if(h==null)return;for(int g=0;g<dM;g++ ){if(EM[g]==h){EM[g]=null;break;}}} LE( h, i){var g=new gE(h,i);add(g);return g;} DD( k){pM+= k;var j=dM;var h=0;for(int g=0;g<j;g++ ){var i=EM[g];if(i==null)continue;if(i.DD(k)==false){EM[g]=null;continue;}if(h!=g){EM[h]=i;EM[g]=null;}h++ ;}if(h!=j){for(int g=j;g<dM;g++ ){EM[h++ ]=EM[g];EM[g]=null;}dM=h;}return true;}}class hB extends q{var nB;var DK;var HF;hB([this.nB=null,this.DK="auto"]){HF=null;} kB( h,[ returnRectangle]){var g=(nB!=null)?nB.width:0;var i=(nB!=null)?nB.height:0;return yE(h,g,i,returnRectangle);} IC( g, h){if(nB!=null&&g>=0.0&&h>=0.0&&g<nB.width&&h<nB.height)return this;return null;} TB( g){if(nB!=null){if(HF==null)nB.TB(g);else nB.MK(g,HF);}}}class jB implements mE{var xL;var GM;var SM;var fM;var sL;var zM;var IN;var ON;var NM;var VM;var aM;var kM;jB( g, h,[ transparent=true, fillColor=0xFFFFFFFF]){xL=g;GM=h;SM=transparent;var i=new xC.CanvasElement(width:xL,height:GM);sL=i.context2d;sL.fillStyle=SM?vE(fillColor):ZD(fillColor);sL.fillRect(0,0,g,h);fM=i;zM=0;}jB.JL( g){xL=g.naturalWidth;GM=g.naturalHeight;SM=true;fM=g;zM=0;}jB.KL( g){xL=g.AK;GM=g.zJ;SM=true;fM=g.YK.bJ;zM=g.OK?2:1;IN=g.offsetX.toDouble();ON=g.offsetY.toDouble();NM=g.SJ.toDouble();VM=g.TJ.toDouble();aM=g.RJ.toDouble();kM=g.QJ.toDouble();}static  TG( i){var h=new YB.Completer<jB>();var g=new xC.ImageElement();g.onLoad.listen((j)=>h.complete(new jB.JL(g)));g.onError.listen((j)=>h.completeError(new StateError("Error loading image.")));g.src=i;return h.future;} get width=>xL; get height=>GM; clone(){var g=new jB(xL,GM,true,0);g.NJ(this);return g;} NJ( h,[ matrix=null]){var g=IP();var i=new iB.IL(g,matrix);h.TB(i);g.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);} YJ( j, h){var i=IP();var k=i.getImageData(j,h,1,1);var g=k.data;if(rI){return (g[0]<<16)+(g[1]<<8)+(g[2]<<0)+(g[3]<<24);}else{return (g[3]<<16)+(g[2]<<8)+(g[1]<<0)+(g[0]<<24);}} TB( g){switch (zM){case 0:g.context.drawImage(fM,0.0,0.0);break;case 1:g.context.drawImage(fM,NM,VM,aM,kM,IN,ON,aM,kM);break;case 2:g.context.transform(0.0,-1.0,1.0,0.0,IN,ON+kM);g.context.drawImage(fM,NM,VM,kM,aM,0.0,0.0,kM,aM);break;}} MK( bB, g){if(g.width<=0.0||g.height<=0.0)return;switch (zM){case 0:bB.context.drawImage(fM,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);break;case 1:double j=NM;double h=VM;double EB=j+aM;double JB=h+kM;double l=NM-IN+g.x;double n=VM-ON+g.y;double XB=l+g.width;double NB=n+g.height;double AB=(j>l)?j:l;double s=(h>n)?h:n;double sB=(EB<XB)?EB:XB;double fF=(JB<NB)?JB:NB;double gF=IN-j+AB;double mC=ON-h+s;double k=sB-AB;double i=fF-s;if(k>0.0&&i>0.0){bB.context.drawImage(fM,AB,s,k,i,gF,mC,k,i);}break;case 2:double j=NM;double h=VM;double EB=j+kM;double JB=h+aM;double l=NM+ON-g.y+kM-g.height;double n=VM-IN+g.x;double XB=l+g.height;double NB=n+g.width;double AB=(j>l)?j:l;double s=(h>n)?h:n;double sB=(EB<XB)?EB:XB;double fF=(JB<NB)?JB:NB;double gF=IN-h+s;double mC=ON+EB-sB;double k=fF-s;double i=sB-AB;if(k>0.0&&i>0.0){bB.context.transform(0.0,-1.0,1.0,0.0,gF,mC+i);bB.context.drawImage(fM,AB,s,i,k,0.0,0.0,i,k);}break;}} IP(){if(sL==null){var g=new xC.CanvasElement(width:xL,height:GM);sL=g.context2d;switch (zM){case 0:sL.drawImage(fM,0,0);break;case 1:sL.drawImage(fM,NM,VM,aM,kM,IN,ON,aM,kM);break;case 2:sL.setTransform(0.0,-1.0,1.0,0.0,IN,ON+kM);sL.drawImage(fM,NM,VM,kM,aM,0.0,0.0,kM,aM);sL.setTransform(1.0,0.0,0.0,1.0,0.0,0.0);break;}fM=g;zM=0;}return sL;}}typedef  nH<YD extends BB>( event);class rH<YD extends BB> extends YB.StreamSubscription<YD>{var vM;var GN;var JN;var PN;rH(this.vM,this.GN){JN=0;PN=false;} cancel(){if(PN==false){vM.xN(this);PN=true;GN=null;}} onError( g( error)){} get iO=>JN>0; pause([ resumeSignal]){JN++ ;if(resumeSignal!=null)resumeSignal.whenComplete(resume);} resume(){if(iO==false)throw new StateError("Subscription is not paused.");JN-- ;}}class AG{var iM;AG(){iM=new Map<String,yD>();} bN( g){var j=g.kind;var h=g.name;var i="${j}.${h}";if(iM.containsKey(i))throw new StateError("ResourceManager already contains a resource called '${h}'");iM[i]=g;} FO( i, g){var h="${i}.${g}";if(iM.containsKey(h)==false)throw new StateError("ResourceManager does not contains a resource called '${g}'");return iM[h];} yB( i, h){var g=new yD("BitmapData",i,h);g.EO(jB.TG(h));bN(g);} AF( i, h){var g=new yD("Sound",i,h);g.EO(dB.TG(h));bN(g);} yI( j, h, i){var g=new yD("TextureAtlas",j,h);g.EO(eC.TG(h,i));bN(g);} SB( i, h){var g=new yD("Text",i,"");g.EO(new YB.Future.immediate(h));bN(g);} load(){var h=this.CK.map((i)=>i.TM);return YB.Future.wait(h).then((j){var g=this.cG;if(g.length>0)throw new StateError("Failed to load ${g.length} resource(s).");return this;});} get CK{return iM.values.where((g)=>g.mD==null).toList();} get cG{return iM.values.where((g)=>g.error!=null).toList();} CB( g){return FO("BitmapData",g).mD;} NF( g){return FO("Sound",g).mD;} LB( g){return FO("TextureAtlas",g).mD;} ZJ( g){return FO("Text",g).mD;}} ZD( g){var h=(g>>16)&0xFF;var i=(g>>8)&0xFF;var j=(g>>0)&0xFF;return "rgb(${h},${i},${j})";}class HG{static var LG=false;static var tE=false;static var uE=0;static var UI=oF.zH;static var VI=new YB.StreamController<String>();static var aI=VI.stream.asBroadcastStream();static cI(){if(LG==false){LG=true;var g=xC.window.navigator.userAgent;if(g.contains("iPhone")||g.contains("iPad")||g.contains("iPod")){tE=true;uE=10;}if(g.contains("Android")){tE=true;uE=10;}if(g.contains("IEMobile")){tE=true;uE=10;}}}static  get oI{cI();return UI;}}class RI{static var TI=0;var XE=TI++ ;var target=null;var TE=false;RI(this.target,this.TE);} vE( g){var h=(g>>24)&0xFF;var i=(g>>16)&0xFF;var j=(g>>8)&0xFF;var k=(g>>0)&0xFF;return "rgba(${i},${j},${k},${h/255.0})";}class wE{static  xE( g){return g;}}class eI implements pC{final  GO;final  JO;final  NO=new List<fH>();var RO;var SO;var WO;var XM;var LM;var eO;var gO;var jO;eI( g, h,[ transitionFunction( ratio)]):GO=g,JO=(transitionFunction!=null)?transitionFunction:wE.xE{LM=0.0;XM=ZB.max(0.0001,h);eO=0.0;gO=false;jO=false;} JE( g, h){var i=['x','y','pivotX','pivotY','scaleX','scaleY','rotation','alpha'];if(i.indexOf(g)==-1)throw new ArgumentError("Error #9003: The supplied property ('${g}') is not supported at this time.");if(GO!=null&&jO==false)NO.add(new fH(g,0.0,h));} moveTo( h, g){JE('x',h);JE('y',g);} DD( l){if(LM<XM||jO==false){LM=LM+l;if(LM>XM)LM=XM;if(LM>=0.0){if(jO==false){jO=true;for(int i=0;i<NO.length;i++ ){var g=NO[i];switch (g.name){case 'x':g.DC=GO.x;break;case 'y':g.DC=GO.y;break;case 'pivotX':g.DC=GO.tC;break;case 'pivotY':g.DC=GO.uC;break;case 'scaleX':g.DC=GO.YC;break;case 'scaleY':g.DC=GO.ZC;break;case 'rotation':g.DC=GO.OC;break;case 'alpha':g.DC=GO.alpha;break;}}if(RO!=null)RO();}var j=LM/XM;var k=JO(j);for(int i=0;i<NO.length;i++ ){var g=NO[i];var h=g.DC+k*(g.MH-g.DC);h=gO?h.round():h;switch (g.name){case 'x':GO.x=h;break;case 'y':GO.y=h;break;case 'pivotX':GO.tC=h;break;case 'pivotY':GO.uC=h;break;case 'scaleX':GO.YC=h;break;case 'scaleY':GO.ZC=h;break;case 'rotation':GO.OC=h;break;case 'alpha':GO.alpha=h;break;}}if(SO!=null)SO();if(WO!=null&&LM==XM)WO();}}return LM<XM;} get currentTime=>LM;} fI( g){var h=new RegExp(r"(.+?)(\.[^.]*$|$)",multiLine:false,caseSensitive:false);var i=h.firstMatch(g);return i.group(1);}class bD extends nC{var DO;var sL;var UO;var XO;var cO;var dO;var hO;var mO;var nO;var pO;var qO;var rO;var sO;bD( h, g){iL=h;DO=g;DO.focus();sL=g.context2d;XO=new iB.IL(sL);cO=UD.nE;dO=mB.pE;jE.JI.listen(JI);nO=[new tF(p.gC,p.aD,p.qC,p.AI),new tF(p.WI,p.ZI,p.PG,p.PG),new tF(p.dI,p.hI,p.QG,p.QG)];mO=null;hO=new DB(0,0);qO=new p(p.qC,true);DO.onMouseDown.listen(iN);DO.onMouseUp.listen(iN);DO.onMouseMove.listen(iN);DO.onMouseOut.listen(iN);DO.onMouseWheel.listen(iN);pO=new Map<int,RI>();sO=new OB(OB.zF,true);HG.aI.listen(CP);CP(null);rO=new FC(FC.oE,true);DO.onKeyDown.listen(DP);DO.onKeyUp.listen(DP);DO.onKeyPress.listen(EP);} get focus=>UO; GP(){throw new UnsupportedError("Error #2071: The Stage class does not implement this property or method.");} set x( g){GP();} set y( g){GP();} set tC( g){GP();} set uC( g){GP();} set YC( g){GP();} set ZC( g){GP();} set OC( g){GP();} set alpha( g){GP();} set width( g){GP();} set height( g){GP();} hJ(){if(cO==UD.nE||cO==UD.FG){XO.reset();TB(XO);if(cO==UD.FG)cO=UD.wH;}} JI( g){DO.style.cursor=jE.SG(dO);} iN( j){j.preventDefault();var JB=DO.getBoundingClientRect();var s=new DateTime.now().millisecondsSinceEpoch;var EB=j.button;var h=null;var i=new DB(j.clientX-JB.left,j.clientY-JB.top);var n=null;if(EB<0||EB>2)return;if(j.type=="mousemove"&&hO.equals(i))return;var g=nO[EB];hO=i;if(j.type!="mouseout")h=IC(i.x,i.y) as GB;var l=mB.pE;if(h is AD)if(h.eF)l=mB.qE;if(h is AE)if(h.eF)l=mB.qE;if(dO!=l){dO=l;DO.style.cursor=jE.SG(l);}if(mO!=null&&mO!=h){mO.dispatchEvent(qO..CO(p.GE,true)..yO=(mO.WE!=null)?mO.kC(i):new DB.FL()..zO=i..tO=g.UC);mO=null;}if(h!=null&&h!=mO){h.dispatchEvent(qO..CO(p.NG,true)..yO=h.kC(i)..zO=i..tO=g.UC);mO=h;}var k=null;var AB=false;var NB=false;if(j.type=="mousedown"){k=g.qG;if(h!=g.target||s>g.GF+500)g.dD=0;g.UC=true;g.target=h;g.GF=s;g.dD++ ;}if(j.type=="mouseup"){k=g.sG;g.UC=false;AB=(g.target==h);NB=AB&&g.dD.isEven&&(s<g.GF+500);}if(j.type=="mousemove"){k=p.sE;}if(k!=null&&h!=null){n=h.kC(i);h.dispatchEvent(qO..CO(k,true)..yO=n..zO=i..tO=g.UC..vO=g.dD);if(AB){if(NB&&h.MJ){h.dispatchEvent(qO..CO(g.pG,true)..yO=n..zO=i..tO=g.UC);}else{h.dispatchEvent(qO..CO(g.oG,true)..yO=n..zO=i..tO=g.UC);}}}}var MP=[] ; CP( h){MP.forEach((g)=>g.cancel());if(HG.oI==oF.DI){MP=[DO.onTouchStart.listen(NP),DO.onTouchEnd.listen(NP),DO.onTouchMove.listen(NP),DO.onTouchEnter.listen(NP),DO.onTouchLeave.listen(NP),DO.onTouchCancel.listen(NP)];}} NP( j){j.preventDefault();var s=DO.getBoundingClientRect();for(var n in j.changedTouches){var l=n.identifier;var i=new DB(n.clientX-s.left,n.clientY-s.top);var h=IC(i.x,i.y) as GB;var g=pO.containsKey(l)?pO[l]:new RI(h,pO.length==0);if(g.target!=null&&g.target!=h){g.target.dispatchEvent(sO..CO(OB.OI,true)..yO=(g.target.WE!=null)?g.target.kC(i):new DB.FL()..zO=i..HO=g.XE..IO=g.TE);g.target=null;}if(h!=null&&h!=g.target){h.dispatchEvent(sO..CO(OB.NI,true)..yO=h.kC(i)..zO=i..HO=g.XE..IO=g.TE);g.target=h;}var k=null;if(j.type=="touchstart"){pO[l]=g;k=OB.zF;}if(j.type=="touchend"){pO.remove(l);k=OB.EG;}if(j.type=="touchcancel"){pO.remove(l);k=OB.GG;}if(j.type=="touchmove"){k=OB.MG;}if(k!=null&&h!=null){h.dispatchEvent(sO..CO(k,true)..yO=h.kC(i)..zO=i..HO=g.XE..IO=g.TE);}}} DP( g){g.preventDefault();var h=null;if(g.type=="keyup")h=FC.DG;if(g.type=="keydown")h=FC.oE;rO..CO(h,true)..aN=g.altKey..dN=g.ctrlKey..gN=g.shiftKey..rN=g.charCode..tN=g.keyCode..vN=BD.oH;if(g.keyLocation==xC.KeyLocation.LEFT)rO.vN=BD.JG;if(g.keyLocation==xC.KeyLocation.RIGHT)rO.vN=BD.FE;if(g.keyLocation==xC.KeyLocation.NUMPAD)rO.vN=BD.EI;if(g.keyLocation==xC.KeyLocation.JOYSTICK)rO.vN=BD.IG;if(g.keyLocation==xC.KeyLocation.MOBILE)rO.vN=BD.IG;if(UO!=null)UO.dispatchEvent(rO);} EP( g){var i=(g.charCode!=0)?g.charCode:g.keyCode;var h=new pF(pF.yH,true);h.zL=new String.fromCharCodes([i]);if(UO!=null)UO.dispatchEvent(h);}} jI( j, g){var i=new RegExp(r"^(.*/)?(?:$|(.+?)(?:(\.[^.]*$)|$))",multiLine:false,caseSensitive:false);var k=i.firstMatch(j);var h=k.group(1);return (h==null)?g:"${h}${g}";} kI(){var g=new xC.CanvasElement(width:1,height:1);g.context2d.fillStyle="#000000";g.context2d.fillRect(0,0,1,1);var i=g.context2d.getImageData(0,0,1,1).data;var h=(i[0]==0);return h;} yE( g, n, JB, j){var mC=0.0;var sB=0.0;var EB=n*g.a;var bB=n*g.b;var NB=n*g.a+JB*g.c;var AB=n*g.b+JB*g.d;var XB=JB*g.c;var s=JB*g.d;var h=mC;if(h>EB)h=EB;if(h>NB)h=NB;if(h>XB)h=XB;var i=sB;if(i>bB)i=bB;if(i>AB)i=AB;if(i>s)i=s;var l=mC;if(l<EB)l=EB;if(l<NB)l=NB;if(l<XB)l=XB;var k=sB;if(k<bB)k=bB;if(k<AB)k=AB;if(k<s)k=s;if(j==null)j=new HB.FL();j.x=g.fB+h;j.y=g.gB+i;j.width=l-h;j.height=k-i;return j;}var rI=kI();//@ sourceMappingURL=supersonic.dart.map
